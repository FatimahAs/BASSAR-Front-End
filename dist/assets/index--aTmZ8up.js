(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))s(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const T of y.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&s(T)}).observe(document,{childList:!0,subtree:!0});function i(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerPolicy&&(y.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?y.credentials="include":f.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function s(f){if(f.ep)return;f.ep=!0;const y=i(f);fetch(f.href,y)}})();var dg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var AS={exports:{}},J0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OR;function uH(){if(OR)return J0;OR=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,f,y){var T=null;if(y!==void 0&&(T=""+y),f.key!==void 0&&(T=""+f.key),"key"in f){y={};for(var o in f)o!=="key"&&(y[o]=f[o])}else y=f;return f=y.ref,{$$typeof:e,type:s,key:T,ref:f!==void 0?f:null,props:y}}return J0.Fragment=t,J0.jsx=i,J0.jsxs=i,J0}var IR;function hH(){return IR||(IR=1,AS.exports=uH()),AS.exports}var ie=hH(),PS={exports:{}},io={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DR;function dH(){if(DR)return io;DR=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),T=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),M=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),j=Symbol.iterator;function q($e){return $e===null||typeof $e!="object"?null:($e=j&&$e[j]||$e["@@iterator"],typeof $e=="function"?$e:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J=Object.assign,te={};function oe($e,Pt,$t){this.props=$e,this.context=Pt,this.refs=te,this.updater=$t||K}oe.prototype.isReactComponent={},oe.prototype.setState=function($e,Pt){if(typeof $e!="object"&&typeof $e!="function"&&$e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$e,Pt,"setState")},oe.prototype.forceUpdate=function($e){this.updater.enqueueForceUpdate(this,$e,"forceUpdate")};function ce(){}ce.prototype=oe.prototype;function de($e,Pt,$t){this.props=$e,this.context=Pt,this.refs=te,this.updater=$t||K}var ue=de.prototype=new ce;ue.constructor=de,J(ue,oe.prototype),ue.isPureReactComponent=!0;var Pe=Array.isArray,Oe={H:null,A:null,T:null,S:null,V:null},xe=Object.prototype.hasOwnProperty;function Qe($e,Pt,$t,on,An,ct){return $t=ct.ref,{$$typeof:e,type:$e,key:Pt,ref:$t!==void 0?$t:null,props:ct}}function tt($e,Pt){return Qe($e.type,Pt,void 0,void 0,void 0,$e.props)}function Ge($e){return typeof $e=="object"&&$e!==null&&$e.$$typeof===e}function Je($e){var Pt={"=":"=0",":":"=2"};return"$"+$e.replace(/[=:]/g,function($t){return Pt[$t]})}var Ve=/\/+/g;function xt($e,Pt){return typeof $e=="object"&&$e!==null&&$e.key!=null?Je(""+$e.key):Pt.toString(36)}function yt(){}function ot($e){switch($e.status){case"fulfilled":return $e.value;case"rejected":throw $e.reason;default:switch(typeof $e.status=="string"?$e.then(yt,yt):($e.status="pending",$e.then(function(Pt){$e.status==="pending"&&($e.status="fulfilled",$e.value=Pt)},function(Pt){$e.status==="pending"&&($e.status="rejected",$e.reason=Pt)})),$e.status){case"fulfilled":return $e.value;case"rejected":throw $e.reason}}throw $e}function zt($e,Pt,$t,on,An){var ct=typeof $e;(ct==="undefined"||ct==="boolean")&&($e=null);var kt=!1;if($e===null)kt=!0;else switch(ct){case"bigint":case"string":case"number":kt=!0;break;case"object":switch($e.$$typeof){case e:case t:kt=!0;break;case I:return kt=$e._init,zt(kt($e._payload),Pt,$t,on,An)}}if(kt)return An=An($e),kt=on===""?"."+xt($e,0):on,Pe(An)?($t="",kt!=null&&($t=kt.replace(Ve,"$&/")+"/"),zt(An,Pt,$t,"",function(Dt){return Dt})):An!=null&&(Ge(An)&&(An=tt(An,$t+(An.key==null||$e&&$e.key===An.key?"":(""+An.key).replace(Ve,"$&/")+"/")+kt)),Pt.push(An)),1;kt=0;var In=on===""?".":on+":";if(Pe($e))for(var ti=0;ti<$e.length;ti++)on=$e[ti],ct=In+xt(on,ti),kt+=zt(on,Pt,$t,ct,An);else if(ti=q($e),typeof ti=="function")for($e=ti.call($e),ti=0;!(on=$e.next()).done;)on=on.value,ct=In+xt(on,ti++),kt+=zt(on,Pt,$t,ct,An);else if(ct==="object"){if(typeof $e.then=="function")return zt(ot($e),Pt,$t,on,An);throw Pt=String($e),Error("Objects are not valid as a React child (found: "+(Pt==="[object Object]"?"object with keys {"+Object.keys($e).join(", ")+"}":Pt)+"). If you meant to render a collection of children, use an array instead.")}return kt}function rt($e,Pt,$t){if($e==null)return $e;var on=[],An=0;return zt($e,on,"","",function(ct){return Pt.call($t,ct,An++)}),on}function Bt($e){if($e._status===-1){var Pt=$e._result;Pt=Pt(),Pt.then(function($t){($e._status===0||$e._status===-1)&&($e._status=1,$e._result=$t)},function($t){($e._status===0||$e._status===-1)&&($e._status=2,$e._result=$t)}),$e._status===-1&&($e._status=0,$e._result=Pt)}if($e._status===1)return $e._result.default;throw $e._result}var Vt=typeof reportError=="function"?reportError:function($e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Pt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $e=="object"&&$e!==null&&typeof $e.message=="string"?String($e.message):String($e),error:$e});if(!window.dispatchEvent(Pt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$e);return}console.error($e)};function Ln(){}return io.Children={map:rt,forEach:function($e,Pt,$t){rt($e,function(){Pt.apply(this,arguments)},$t)},count:function($e){var Pt=0;return rt($e,function(){Pt++}),Pt},toArray:function($e){return rt($e,function(Pt){return Pt})||[]},only:function($e){if(!Ge($e))throw Error("React.Children.only expected to receive a single React element child.");return $e}},io.Component=oe,io.Fragment=i,io.Profiler=f,io.PureComponent=de,io.StrictMode=s,io.Suspense=C,io.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Oe,io.__COMPILER_RUNTIME={__proto__:null,c:function($e){return Oe.H.useMemoCache($e)}},io.cache=function($e){return function(){return $e.apply(null,arguments)}},io.cloneElement=function($e,Pt,$t){if($e==null)throw Error("The argument must be a React element, but you passed "+$e+".");var on=J({},$e.props),An=$e.key,ct=void 0;if(Pt!=null)for(kt in Pt.ref!==void 0&&(ct=void 0),Pt.key!==void 0&&(An=""+Pt.key),Pt)!xe.call(Pt,kt)||kt==="key"||kt==="__self"||kt==="__source"||kt==="ref"&&Pt.ref===void 0||(on[kt]=Pt[kt]);var kt=arguments.length-2;if(kt===1)on.children=$t;else if(1<kt){for(var In=Array(kt),ti=0;ti<kt;ti++)In[ti]=arguments[ti+2];on.children=In}return Qe($e.type,An,void 0,void 0,ct,on)},io.createContext=function($e){return $e={$$typeof:T,_currentValue:$e,_currentValue2:$e,_threadCount:0,Provider:null,Consumer:null},$e.Provider=$e,$e.Consumer={$$typeof:y,_context:$e},$e},io.createElement=function($e,Pt,$t){var on,An={},ct=null;if(Pt!=null)for(on in Pt.key!==void 0&&(ct=""+Pt.key),Pt)xe.call(Pt,on)&&on!=="key"&&on!=="__self"&&on!=="__source"&&(An[on]=Pt[on]);var kt=arguments.length-2;if(kt===1)An.children=$t;else if(1<kt){for(var In=Array(kt),ti=0;ti<kt;ti++)In[ti]=arguments[ti+2];An.children=In}if($e&&$e.defaultProps)for(on in kt=$e.defaultProps,kt)An[on]===void 0&&(An[on]=kt[on]);return Qe($e,ct,void 0,void 0,null,An)},io.createRef=function(){return{current:null}},io.forwardRef=function($e){return{$$typeof:o,render:$e}},io.isValidElement=Ge,io.lazy=function($e){return{$$typeof:I,_payload:{_status:-1,_result:$e},_init:Bt}},io.memo=function($e,Pt){return{$$typeof:M,type:$e,compare:Pt===void 0?null:Pt}},io.startTransition=function($e){var Pt=Oe.T,$t={};Oe.T=$t;try{var on=$e(),An=Oe.S;An!==null&&An($t,on),typeof on=="object"&&on!==null&&typeof on.then=="function"&&on.then(Ln,Vt)}catch(ct){Vt(ct)}finally{Oe.T=Pt}},io.unstable_useCacheRefresh=function(){return Oe.H.useCacheRefresh()},io.use=function($e){return Oe.H.use($e)},io.useActionState=function($e,Pt,$t){return Oe.H.useActionState($e,Pt,$t)},io.useCallback=function($e,Pt){return Oe.H.useCallback($e,Pt)},io.useContext=function($e){return Oe.H.useContext($e)},io.useDebugValue=function(){},io.useDeferredValue=function($e,Pt){return Oe.H.useDeferredValue($e,Pt)},io.useEffect=function($e,Pt,$t){var on=Oe.H;if(typeof $t=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return on.useEffect($e,Pt)},io.useId=function(){return Oe.H.useId()},io.useImperativeHandle=function($e,Pt,$t){return Oe.H.useImperativeHandle($e,Pt,$t)},io.useInsertionEffect=function($e,Pt){return Oe.H.useInsertionEffect($e,Pt)},io.useLayoutEffect=function($e,Pt){return Oe.H.useLayoutEffect($e,Pt)},io.useMemo=function($e,Pt){return Oe.H.useMemo($e,Pt)},io.useOptimistic=function($e,Pt){return Oe.H.useOptimistic($e,Pt)},io.useReducer=function($e,Pt,$t){return Oe.H.useReducer($e,Pt,$t)},io.useRef=function($e){return Oe.H.useRef($e)},io.useState=function($e){return Oe.H.useState($e)},io.useSyncExternalStore=function($e,Pt,$t){return Oe.H.useSyncExternalStore($e,Pt,$t)},io.useTransition=function(){return Oe.H.useTransition()},io.version="19.1.0",io}var RR;function Bv(){return RR||(RR=1,PS.exports=dH()),PS.exports}var me=Bv();const yd=Zu(me);var CS={exports:{}},Q0={},MS={exports:{}},OS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LR;function fH(){return LR||(LR=1,function(e){function t(rt,Bt){var Vt=rt.length;rt.push(Bt);e:for(;0<Vt;){var Ln=Vt-1>>>1,$e=rt[Ln];if(0<f($e,Bt))rt[Ln]=Bt,rt[Vt]=$e,Vt=Ln;else break e}}function i(rt){return rt.length===0?null:rt[0]}function s(rt){if(rt.length===0)return null;var Bt=rt[0],Vt=rt.pop();if(Vt!==Bt){rt[0]=Vt;e:for(var Ln=0,$e=rt.length,Pt=$e>>>1;Ln<Pt;){var $t=2*(Ln+1)-1,on=rt[$t],An=$t+1,ct=rt[An];if(0>f(on,Vt))An<$e&&0>f(ct,on)?(rt[Ln]=ct,rt[An]=Vt,Ln=An):(rt[Ln]=on,rt[$t]=Vt,Ln=$t);else if(An<$e&&0>f(ct,Vt))rt[Ln]=ct,rt[An]=Vt,Ln=An;else break e}}return Bt}function f(rt,Bt){var Vt=rt.sortIndex-Bt.sortIndex;return Vt!==0?Vt:rt.id-Bt.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var T=Date,o=T.now();e.unstable_now=function(){return T.now()-o}}var C=[],M=[],I=1,j=null,q=3,K=!1,J=!1,te=!1,oe=!1,ce=typeof setTimeout=="function"?setTimeout:null,de=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;function Pe(rt){for(var Bt=i(M);Bt!==null;){if(Bt.callback===null)s(M);else if(Bt.startTime<=rt)s(M),Bt.sortIndex=Bt.expirationTime,t(C,Bt);else break;Bt=i(M)}}function Oe(rt){if(te=!1,Pe(rt),!J)if(i(C)!==null)J=!0,xe||(xe=!0,xt());else{var Bt=i(M);Bt!==null&&zt(Oe,Bt.startTime-rt)}}var xe=!1,Qe=-1,tt=5,Ge=-1;function Je(){return oe?!0:!(e.unstable_now()-Ge<tt)}function Ve(){if(oe=!1,xe){var rt=e.unstable_now();Ge=rt;var Bt=!0;try{e:{J=!1,te&&(te=!1,de(Qe),Qe=-1),K=!0;var Vt=q;try{t:{for(Pe(rt),j=i(C);j!==null&&!(j.expirationTime>rt&&Je());){var Ln=j.callback;if(typeof Ln=="function"){j.callback=null,q=j.priorityLevel;var $e=Ln(j.expirationTime<=rt);if(rt=e.unstable_now(),typeof $e=="function"){j.callback=$e,Pe(rt),Bt=!0;break t}j===i(C)&&s(C),Pe(rt)}else s(C);j=i(C)}if(j!==null)Bt=!0;else{var Pt=i(M);Pt!==null&&zt(Oe,Pt.startTime-rt),Bt=!1}}break e}finally{j=null,q=Vt,K=!1}Bt=void 0}}finally{Bt?xt():xe=!1}}}var xt;if(typeof ue=="function")xt=function(){ue(Ve)};else if(typeof MessageChannel<"u"){var yt=new MessageChannel,ot=yt.port2;yt.port1.onmessage=Ve,xt=function(){ot.postMessage(null)}}else xt=function(){ce(Ve,0)};function zt(rt,Bt){Qe=ce(function(){rt(e.unstable_now())},Bt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(rt){rt.callback=null},e.unstable_forceFrameRate=function(rt){0>rt||125<rt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):tt=0<rt?Math.floor(1e3/rt):5},e.unstable_getCurrentPriorityLevel=function(){return q},e.unstable_next=function(rt){switch(q){case 1:case 2:case 3:var Bt=3;break;default:Bt=q}var Vt=q;q=Bt;try{return rt()}finally{q=Vt}},e.unstable_requestPaint=function(){oe=!0},e.unstable_runWithPriority=function(rt,Bt){switch(rt){case 1:case 2:case 3:case 4:case 5:break;default:rt=3}var Vt=q;q=rt;try{return Bt()}finally{q=Vt}},e.unstable_scheduleCallback=function(rt,Bt,Vt){var Ln=e.unstable_now();switch(typeof Vt=="object"&&Vt!==null?(Vt=Vt.delay,Vt=typeof Vt=="number"&&0<Vt?Ln+Vt:Ln):Vt=Ln,rt){case 1:var $e=-1;break;case 2:$e=250;break;case 5:$e=1073741823;break;case 4:$e=1e4;break;default:$e=5e3}return $e=Vt+$e,rt={id:I++,callback:Bt,priorityLevel:rt,startTime:Vt,expirationTime:$e,sortIndex:-1},Vt>Ln?(rt.sortIndex=Vt,t(M,rt),i(C)===null&&rt===i(M)&&(te?(de(Qe),Qe=-1):te=!0,zt(Oe,Vt-Ln))):(rt.sortIndex=$e,t(C,rt),J||K||(J=!0,xe||(xe=!0,xt()))),rt},e.unstable_shouldYield=Je,e.unstable_wrapCallback=function(rt){var Bt=q;return function(){var Vt=q;q=Bt;try{return rt.apply(this,arguments)}finally{q=Vt}}}}(OS)),OS}var zR;function pH(){return zR||(zR=1,MS.exports=fH()),MS.exports}var IS={exports:{}},Pc={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR;function mH(){if(kR)return Pc;kR=1;var e=Bv();function t(C){var M="https://react.dev/errors/"+C;if(1<arguments.length){M+="?args[]="+encodeURIComponent(arguments[1]);for(var I=2;I<arguments.length;I++)M+="&args[]="+encodeURIComponent(arguments[I])}return"Minified React error #"+C+"; visit "+M+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},f=Symbol.for("react.portal");function y(C,M,I){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:j==null?null:""+j,children:C,containerInfo:M,implementation:I}}var T=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(C,M){if(C==="font")return"";if(typeof M=="string")return M==="use-credentials"?M:""}return Pc.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Pc.createPortal=function(C,M){var I=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M||M.nodeType!==1&&M.nodeType!==9&&M.nodeType!==11)throw Error(t(299));return y(C,M,null,I)},Pc.flushSync=function(C){var M=T.T,I=s.p;try{if(T.T=null,s.p=2,C)return C()}finally{T.T=M,s.p=I,s.d.f()}},Pc.preconnect=function(C,M){typeof C=="string"&&(M?(M=M.crossOrigin,M=typeof M=="string"?M==="use-credentials"?M:"":void 0):M=null,s.d.C(C,M))},Pc.prefetchDNS=function(C){typeof C=="string"&&s.d.D(C)},Pc.preinit=function(C,M){if(typeof C=="string"&&M&&typeof M.as=="string"){var I=M.as,j=o(I,M.crossOrigin),q=typeof M.integrity=="string"?M.integrity:void 0,K=typeof M.fetchPriority=="string"?M.fetchPriority:void 0;I==="style"?s.d.S(C,typeof M.precedence=="string"?M.precedence:void 0,{crossOrigin:j,integrity:q,fetchPriority:K}):I==="script"&&s.d.X(C,{crossOrigin:j,integrity:q,fetchPriority:K,nonce:typeof M.nonce=="string"?M.nonce:void 0})}},Pc.preinitModule=function(C,M){if(typeof C=="string")if(typeof M=="object"&&M!==null){if(M.as==null||M.as==="script"){var I=o(M.as,M.crossOrigin);s.d.M(C,{crossOrigin:I,integrity:typeof M.integrity=="string"?M.integrity:void 0,nonce:typeof M.nonce=="string"?M.nonce:void 0})}}else M==null&&s.d.M(C)},Pc.preload=function(C,M){if(typeof C=="string"&&typeof M=="object"&&M!==null&&typeof M.as=="string"){var I=M.as,j=o(I,M.crossOrigin);s.d.L(C,I,{crossOrigin:j,integrity:typeof M.integrity=="string"?M.integrity:void 0,nonce:typeof M.nonce=="string"?M.nonce:void 0,type:typeof M.type=="string"?M.type:void 0,fetchPriority:typeof M.fetchPriority=="string"?M.fetchPriority:void 0,referrerPolicy:typeof M.referrerPolicy=="string"?M.referrerPolicy:void 0,imageSrcSet:typeof M.imageSrcSet=="string"?M.imageSrcSet:void 0,imageSizes:typeof M.imageSizes=="string"?M.imageSizes:void 0,media:typeof M.media=="string"?M.media:void 0})}},Pc.preloadModule=function(C,M){if(typeof C=="string")if(M){var I=o(M.as,M.crossOrigin);s.d.m(C,{as:typeof M.as=="string"&&M.as!=="script"?M.as:void 0,crossOrigin:I,integrity:typeof M.integrity=="string"?M.integrity:void 0})}else s.d.m(C)},Pc.requestFormReset=function(C){s.d.r(C)},Pc.unstable_batchedUpdates=function(C,M){return C(M)},Pc.useFormState=function(C,M,I){return T.H.useFormState(C,M,I)},Pc.useFormStatus=function(){return T.H.useHostTransitionStatus()},Pc.version="19.1.0",Pc}var NR;function YB(){if(NR)return IS.exports;NR=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),IS.exports=mH(),IS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BR;function gH(){if(BR)return Q0;BR=1;var e=pH(),t=Bv(),i=YB();function s(d){var _="https://react.dev/errors/"+d;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)_+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+d+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function y(d){var _=d,A=d;if(d.alternate)for(;_.return;)_=_.return;else{d=_;do _=d,(_.flags&4098)!==0&&(A=_.return),d=_.return;while(d)}return _.tag===3?A:null}function T(d){if(d.tag===13){var _=d.memoizedState;if(_===null&&(d=d.alternate,d!==null&&(_=d.memoizedState)),_!==null)return _.dehydrated}return null}function o(d){if(y(d)!==d)throw Error(s(188))}function C(d){var _=d.alternate;if(!_){if(_=y(d),_===null)throw Error(s(188));return _!==d?null:d}for(var A=d,k=_;;){var H=A.return;if(H===null)break;var ee=H.alternate;if(ee===null){if(k=H.return,k!==null){A=k;continue}break}if(H.child===ee.child){for(ee=H.child;ee;){if(ee===A)return o(H),d;if(ee===k)return o(H),_;ee=ee.sibling}throw Error(s(188))}if(A.return!==k.return)A=H,k=ee;else{for(var Ae=!1,He=H.child;He;){if(He===A){Ae=!0,A=H,k=ee;break}if(He===k){Ae=!0,k=H,A=ee;break}He=He.sibling}if(!Ae){for(He=ee.child;He;){if(He===A){Ae=!0,A=ee,k=H;break}if(He===k){Ae=!0,k=ee,A=H;break}He=He.sibling}if(!Ae)throw Error(s(189))}}if(A.alternate!==k)throw Error(s(190))}if(A.tag!==3)throw Error(s(188));return A.stateNode.current===A?d:_}function M(d){var _=d.tag;if(_===5||_===26||_===27||_===6)return d;for(d=d.child;d!==null;){if(_=M(d),_!==null)return _;d=d.sibling}return null}var I=Object.assign,j=Symbol.for("react.element"),q=Symbol.for("react.transitional.element"),K=Symbol.for("react.portal"),J=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),oe=Symbol.for("react.profiler"),ce=Symbol.for("react.provider"),de=Symbol.for("react.consumer"),ue=Symbol.for("react.context"),Pe=Symbol.for("react.forward_ref"),Oe=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),Qe=Symbol.for("react.memo"),tt=Symbol.for("react.lazy"),Ge=Symbol.for("react.activity"),Je=Symbol.for("react.memo_cache_sentinel"),Ve=Symbol.iterator;function xt(d){return d===null||typeof d!="object"?null:(d=Ve&&d[Ve]||d["@@iterator"],typeof d=="function"?d:null)}var yt=Symbol.for("react.client.reference");function ot(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===yt?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case J:return"Fragment";case oe:return"Profiler";case te:return"StrictMode";case Oe:return"Suspense";case xe:return"SuspenseList";case Ge:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case K:return"Portal";case ue:return(d.displayName||"Context")+".Provider";case de:return(d._context.displayName||"Context")+".Consumer";case Pe:var _=d.render;return d=d.displayName,d||(d=_.displayName||_.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case Qe:return _=d.displayName||null,_!==null?_:ot(d.type)||"Memo";case tt:_=d._payload,d=d._init;try{return ot(d(_))}catch{}}return null}var zt=Array.isArray,rt=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bt=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Vt={pending:!1,data:null,method:null,action:null},Ln=[],$e=-1;function Pt(d){return{current:d}}function $t(d){0>$e||(d.current=Ln[$e],Ln[$e]=null,$e--)}function on(d,_){$e++,Ln[$e]=d.current,d.current=_}var An=Pt(null),ct=Pt(null),kt=Pt(null),In=Pt(null);function ti(d,_){switch(on(kt,_),on(ct,d),on(An,null),_.nodeType){case 9:case 11:d=(d=_.documentElement)&&(d=d.namespaceURI)?Bb(d):0;break;default:if(d=_.tagName,_=_.namespaceURI)_=Bb(_),d=jb(_,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}$t(An),on(An,d)}function Dt(){$t(An),$t(ct),$t(kt)}function jn(d){d.memoizedState!==null&&on(In,d);var _=An.current,A=jb(_,d.type);_!==A&&(on(ct,d),on(An,A))}function ai(d){ct.current===d&&($t(An),$t(ct)),In.current===d&&($t(In),ig._currentValue=Vt)}var mn=Object.prototype.hasOwnProperty,ci=e.unstable_scheduleCallback,Ii=e.unstable_cancelCallback,Mi=e.unstable_shouldYield,Tr=e.unstable_requestPaint,kr=e.unstable_now,ja=e.unstable_getCurrentPriorityLevel,Xr=e.unstable_ImmediatePriority,Yr=e.unstable_UserBlockingPriority,go=e.unstable_NormalPriority,_a=e.unstable_LowPriority,ya=e.unstable_IdlePriority,aa=e.log,qs=e.unstable_setDisableYieldValue,Ho=null,Ar=null;function Fa(d){if(typeof aa=="function"&&qs(d),Ar&&typeof Ar.setStrictMode=="function")try{Ar.setStrictMode(Ho,d)}catch{}}var Po=Math.clz32?Math.clz32:Ea,bl=Math.log,ro=Math.LN2;function Ea(d){return d>>>=0,d===0?32:31-(bl(d)/ro|0)|0}var Ua=256,Co=4194304;function ea(d){var _=d&42;if(_!==0)return _;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Aa(d,_,A){var k=d.pendingLanes;if(k===0)return 0;var H=0,ee=d.suspendedLanes,Ae=d.pingedLanes;d=d.warmLanes;var He=k&134217727;return He!==0?(k=He&~ee,k!==0?H=ea(k):(Ae&=He,Ae!==0?H=ea(Ae):A||(A=He&~d,A!==0&&(H=ea(A))))):(He=k&~ee,He!==0?H=ea(He):Ae!==0?H=ea(Ae):A||(A=k&~d,A!==0&&(H=ea(A)))),H===0?0:_!==0&&_!==H&&(_&ee)===0&&(ee=H&-H,A=_&-_,ee>=A||ee===32&&(A&4194048)!==0)?_:H}function Go(d,_){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&_)===0}function tr(d,_){switch(d){case 1:case 2:case 4:case 8:case 64:return _+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pa(){var d=Ua;return Ua<<=1,(Ua&4194048)===0&&(Ua=256),d}function Is(){var d=Co;return Co<<=1,(Co&62914560)===0&&(Co=4194304),d}function ta(d){for(var _=[],A=0;31>A;A++)_.push(d);return _}function al(d,_){d.pendingLanes|=_,_!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function ls(d,_,A,k,H,ee){var Ae=d.pendingLanes;d.pendingLanes=A,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=A,d.entangledLanes&=A,d.errorRecoveryDisabledLanes&=A,d.shellSuspendCounter=0;var He=d.entanglements,vt=d.expirationTimes,Qt=d.hiddenUpdates;for(A=Ae&~A;0<A;){var Mn=31-Po(A),$n=1<<Mn;He[Mn]=0,vt[Mn]=-1;var nn=Qt[Mn];if(nn!==null)for(Qt[Mn]=null,Mn=0;Mn<nn.length;Mn++){var cn=nn[Mn];cn!==null&&(cn.lane&=-536870913)}A&=~$n}k!==0&&Ca(d,k,0),ee!==0&&H===0&&d.tag!==0&&(d.suspendedLanes|=ee&~(Ae&~_))}function Ca(d,_,A){d.pendingLanes|=_,d.suspendedLanes&=~_;var k=31-Po(_);d.entangledLanes|=_,d.entanglements[k]=d.entanglements[k]|1073741824|A&4194090}function hn(d,_){var A=d.entangledLanes|=_;for(d=d.entanglements;A;){var k=31-Po(A),H=1<<k;H&_|d[k]&_&&(d[k]|=_),A&=~H}}function vs(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Ja(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function bt(){var d=Bt.p;return d!==0?d:(d=window.event,d===void 0?32:v_(d.type))}function Tt(d,_){var A=Bt.p;try{return Bt.p=d,_()}finally{Bt.p=A}}var je=Math.random().toString(36).slice(2),ae="__reactFiber$"+je,ge="__reactProps$"+je,Ee="__reactContainer$"+je,Ne="__reactEvents$"+je,be="__reactListeners$"+je,We="__reactHandles$"+je,nt="__reactResources$"+je,Xe="__reactMarker$"+je;function lt(d){delete d[ae],delete d[ge],delete d[Ne],delete d[be],delete d[We]}function gt(d){var _=d[ae];if(_)return _;for(var A=d.parentNode;A;){if(_=A[Ee]||A[ae]){if(A=_.alternate,_.child!==null||A!==null&&A.child!==null)for(d=Vy(d);d!==null;){if(A=d[ae])return A;d=Vy(d)}return _}d=A,A=d.parentNode}return null}function ht(d){if(d=d[ae]||d[Ee]){var _=d.tag;if(_===5||_===6||_===13||_===26||_===27||_===3)return d}return null}function Zt(d){var _=d.tag;if(_===5||_===26||_===27||_===6)return d.stateNode;throw Error(s(33))}function vn(d){var _=d[nt];return _||(_=d[nt]={hoistableStyles:new Map,hoistableScripts:new Map}),_}function _n(d){d[Xe]=!0}var zn=new Set,ii={};function si(d,_){gi(d,_),gi(d+"Capture",_)}function gi(d,_){for(ii[d]=_,d=0;d<_.length;d++)zn.add(_[d])}var ui=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wi={},_r={};function ir(d){return mn.call(_r,d)?!0:mn.call(Wi,d)?!1:ui.test(d)?_r[d]=!0:(Wi[d]=!0,!1)}function ki(d,_,A){if(ir(_))if(A===null)d.removeAttribute(_);else{switch(typeof A){case"undefined":case"function":case"symbol":d.removeAttribute(_);return;case"boolean":var k=_.toLowerCase().slice(0,5);if(k!=="data-"&&k!=="aria-"){d.removeAttribute(_);return}}d.setAttribute(_,""+A)}}function Fi(d,_,A){if(A===null)d.removeAttribute(_);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(_);return}d.setAttribute(_,""+A)}}function vi(d,_,A,k){if(k===null)d.removeAttribute(A);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(A);return}d.setAttributeNS(_,A,""+k)}}var nr,rr;function Nr(d){if(nr===void 0)try{throw Error()}catch(A){var _=A.stack.trim().match(/\n( *(at )?)/);nr=_&&_[1]||"",rr=-1<A.stack.indexOf(`
    at`)?" (<anonymous>)":-1<A.stack.indexOf("@")?"@unknown:0:0":""}return`
`+nr+d+rr}var Zo=!1;function hr(d,_){if(!d||Zo)return"";Zo=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var k={DetermineComponentFrameRoot:function(){try{if(_){var $n=function(){throw Error()};if(Object.defineProperty($n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($n,[])}catch(cn){var nn=cn}Reflect.construct(d,[],$n)}else{try{$n.call()}catch(cn){nn=cn}d.call($n.prototype)}}else{try{throw Error()}catch(cn){nn=cn}($n=d())&&typeof $n.catch=="function"&&$n.catch(function(){})}}catch(cn){if(cn&&nn&&typeof cn.stack=="string")return[cn.stack,nn.stack]}return[null,null]}};k.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var H=Object.getOwnPropertyDescriptor(k.DetermineComponentFrameRoot,"name");H&&H.configurable&&Object.defineProperty(k.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ee=k.DetermineComponentFrameRoot(),Ae=ee[0],He=ee[1];if(Ae&&He){var vt=Ae.split(`
`),Qt=He.split(`
`);for(H=k=0;k<vt.length&&!vt[k].includes("DetermineComponentFrameRoot");)k++;for(;H<Qt.length&&!Qt[H].includes("DetermineComponentFrameRoot");)H++;if(k===vt.length||H===Qt.length)for(k=vt.length-1,H=Qt.length-1;1<=k&&0<=H&&vt[k]!==Qt[H];)H--;for(;1<=k&&0<=H;k--,H--)if(vt[k]!==Qt[H]){if(k!==1||H!==1)do if(k--,H--,0>H||vt[k]!==Qt[H]){var Mn=`
`+vt[k].replace(" at new "," at ");return d.displayName&&Mn.includes("<anonymous>")&&(Mn=Mn.replace("<anonymous>",d.displayName)),Mn}while(1<=k&&0<=H);break}}}finally{Zo=!1,Error.prepareStackTrace=A}return(A=d?d.displayName||d.name:"")?Nr(A):""}function Xi(d){switch(d.tag){case 26:case 27:case 5:return Nr(d.type);case 16:return Nr("Lazy");case 13:return Nr("Suspense");case 19:return Nr("SuspenseList");case 0:case 15:return hr(d.type,!1);case 11:return hr(d.type.render,!1);case 1:return hr(d.type,!0);case 31:return Nr("Activity");default:return""}}function or(d){try{var _="";do _+=Xi(d),d=d.return;while(d);return _}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function Lo(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Hs(d){var _=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function Ds(d){var _=Hs(d)?"checked":"value",A=Object.getOwnPropertyDescriptor(d.constructor.prototype,_),k=""+d[_];if(!d.hasOwnProperty(_)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var H=A.get,ee=A.set;return Object.defineProperty(d,_,{configurable:!0,get:function(){return H.call(this)},set:function(Ae){k=""+Ae,ee.call(this,Ae)}}),Object.defineProperty(d,_,{enumerable:A.enumerable}),{getValue:function(){return k},setValue:function(Ae){k=""+Ae},stopTracking:function(){d._valueTracker=null,delete d[_]}}}}function sl(d){d._valueTracker||(d._valueTracker=Ds(d))}function cr(d){if(!d)return!1;var _=d._valueTracker;if(!_)return!0;var A=_.getValue(),k="";return d&&(k=Hs(d)?d.checked?"true":"false":d.value),d=k,d!==A?(_.setValue(d),!0):!1}function Kr(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ll=/[\n"\\]/g;function So(d){return d.replace(ll,function(_){return"\\"+_.charCodeAt(0).toString(16)+" "})}function Bo(d,_,A,k,H,ee,Ae,He){d.name="",Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?d.type=Ae:d.removeAttribute("type"),_!=null?Ae==="number"?(_===0&&d.value===""||d.value!=_)&&(d.value=""+Lo(_)):d.value!==""+Lo(_)&&(d.value=""+Lo(_)):Ae!=="submit"&&Ae!=="reset"||d.removeAttribute("value"),_!=null?va(d,Ae,Lo(_)):A!=null?va(d,Ae,Lo(A)):k!=null&&d.removeAttribute("value"),H==null&&ee!=null&&(d.defaultChecked=!!ee),H!=null&&(d.checked=H&&typeof H!="function"&&typeof H!="symbol"),He!=null&&typeof He!="function"&&typeof He!="symbol"&&typeof He!="boolean"?d.name=""+Lo(He):d.removeAttribute("name")}function xs(d,_,A,k,H,ee,Ae,He){if(ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"&&(d.type=ee),_!=null||A!=null){if(!(ee!=="submit"&&ee!=="reset"||_!=null))return;A=A!=null?""+Lo(A):"",_=_!=null?""+Lo(_):A,He||_===d.value||(d.value=_),d.defaultValue=_}k=k??H,k=typeof k!="function"&&typeof k!="symbol"&&!!k,d.checked=He?d.checked:!!k,d.defaultChecked=!!k,Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"&&(d.name=Ae)}function va(d,_,A){_==="number"&&Kr(d.ownerDocument)===d||d.defaultValue===""+A||(d.defaultValue=""+A)}function jo(d,_,A,k){if(d=d.options,_){_={};for(var H=0;H<A.length;H++)_["$"+A[H]]=!0;for(A=0;A<d.length;A++)H=_.hasOwnProperty("$"+d[A].value),d[A].selected!==H&&(d[A].selected=H),H&&k&&(d[A].defaultSelected=!0)}else{for(A=""+Lo(A),_=null,H=0;H<d.length;H++){if(d[H].value===A){d[H].selected=!0,k&&(d[H].defaultSelected=!0);return}_!==null||d[H].disabled||(_=d[H])}_!==null&&(_.selected=!0)}}function uo(d,_,A){if(_!=null&&(_=""+Lo(_),_!==d.value&&(d.value=_),A==null)){d.defaultValue!==_&&(d.defaultValue=_);return}d.defaultValue=A!=null?""+Lo(A):""}function ha(d,_,A,k){if(_==null){if(k!=null){if(A!=null)throw Error(s(92));if(zt(k)){if(1<k.length)throw Error(s(93));k=k[0]}A=k}A==null&&(A=""),_=A}A=Lo(_),d.defaultValue=A,k=d.textContent,k===A&&k!==""&&k!==null&&(d.value=k)}function da(d,_){if(_){var A=d.firstChild;if(A&&A===d.lastChild&&A.nodeType===3){A.nodeValue=_;return}}d.textContent=_}var wl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bs(d,_,A){var k=_.indexOf("--")===0;A==null||typeof A=="boolean"||A===""?k?d.setProperty(_,""):_==="float"?d.cssFloat="":d[_]="":k?d.setProperty(_,A):typeof A!="number"||A===0||wl.has(_)?_==="float"?d.cssFloat=A:d[_]=(""+A).trim():d[_]=A+"px"}function Gs(d,_,A){if(_!=null&&typeof _!="object")throw Error(s(62));if(d=d.style,A!=null){for(var k in A)!A.hasOwnProperty(k)||_!=null&&_.hasOwnProperty(k)||(k.indexOf("--")===0?d.setProperty(k,""):k==="float"?d.cssFloat="":d[k]="");for(var H in _)k=_[H],_.hasOwnProperty(H)&&A[H]!==k&&bs(d,H,k)}else for(var ee in _)_.hasOwnProperty(ee)&&bs(d,ee,_[ee])}function cs(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var us=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ic=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function St(d){return ic.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var en=null;function Vn(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Zi=null,yr=null;function na(d){var _=ht(d);if(_&&(d=_.stateNode)){var A=d[ge]||null;e:switch(d=_.stateNode,_.type){case"input":if(Bo(d,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name),_=A.name,A.type==="radio"&&_!=null){for(A=d;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll('input[name="'+So(""+_)+'"][type="radio"]'),_=0;_<A.length;_++){var k=A[_];if(k!==d&&k.form===d.form){var H=k[ge]||null;if(!H)throw Error(s(90));Bo(k,H.value,H.defaultValue,H.defaultValue,H.checked,H.defaultChecked,H.type,H.name)}}for(_=0;_<A.length;_++)k=A[_],k.form===d.form&&cr(k)}break e;case"textarea":uo(d,A.value,A.defaultValue);break e;case"select":_=A.value,_!=null&&jo(d,!!A.multiple,_,!1)}}}var Ni=!1;function Sr(d,_,A){if(Ni)return d(_,A);Ni=!0;try{var k=d(_);return k}finally{if(Ni=!1,(Zi!==null||yr!==null)&&(ed(),Zi&&(_=Zi,d=yr,yr=Zi=null,na(_),d)))for(_=0;_<d.length;_++)na(d[_])}}function ri(d,_){var A=d.stateNode;if(A===null)return null;var k=A[ge]||null;if(k===null)return null;A=k[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(d=d.type,k=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!k;break e;default:d=!1}if(d)return null;if(A&&typeof A!="function")throw Error(s(231,_,typeof A));return A}var zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hs=!1;if(zo)try{var ko={};Object.defineProperty(ko,"passive",{get:function(){hs=!0}}),window.addEventListener("test",ko,ko),window.removeEventListener("test",ko,ko)}catch{hs=!1}var Rs=null,ws=null,Qa=null;function Ma(){if(Qa)return Qa;var d,_=ws,A=_.length,k,H="value"in Rs?Rs.value:Rs.textContent,ee=H.length;for(d=0;d<A&&_[d]===H[d];d++);var Ae=A-d;for(k=1;k<=Ae&&_[A-k]===H[ee-k];k++);return Qa=H.slice(d,1<k?1-k:void 0)}function No(d){var _=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&_===13&&(d=13)):d=_,d===10&&(d=13),32<=d||d===13?d:0}function Oa(){return!0}function Ts(){return!1}function Va(d){function _(A,k,H,ee,Ae){this._reactName=A,this._targetInst=H,this.type=k,this.nativeEvent=ee,this.target=Ae,this.currentTarget=null;for(var He in d)d.hasOwnProperty(He)&&(A=d[He],this[He]=A?A(ee):ee[He]);return this.isDefaultPrevented=(ee.defaultPrevented!=null?ee.defaultPrevented:ee.returnValue===!1)?Oa:Ts,this.isPropagationStopped=Ts,this}return I(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=Oa)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=Oa)},persist:function(){},isPersistent:Oa}),_}var $a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tl=Va($a),st=I({},$a,{view:0,detail:0}),Ut=Va(st),kn,qn,oo,Ui=I({},st,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oh,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==oo&&(oo&&d.type==="mousemove"?(kn=d.screenX-oo.screenX,qn=d.screenY-oo.screenY):qn=kn=0,oo=d),kn)},movementY:function(d){return"movementY"in d?d.movementY:qn}}),_o=Va(Ui),Fo=I({},Ui,{dataTransfer:0}),yo=Va(Fo),Mo=I({},st,{relatedTarget:0}),xa=Va(Mo),qa=I({},$a,{animationName:0,elapsedTime:0,pseudoElement:0}),Di=Va(qa),sa=I({},$a,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Ls=Va(sa),Rl=I({},$a,{data:0}),Xn=Va(Rl),Ll={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},es={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ts(d){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(d):(d=es[d])?!!_[d]:!1}function Oh(){return ts}var cu=I({},st,{key:function(d){if(d.key){var _=Ll[d.key]||d.key;if(_!=="Unidentified")return _}return d.type==="keypress"?(d=No(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?kc[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oh,charCode:function(d){return d.type==="keypress"?No(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?No(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Jn=Va(cu),Er=I({},Ui,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dr=Va(Er),cl=I({},st,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oh}),Nc=Va(cl),vr=I({},$a,{propertyName:0,elapsedTime:0,pseudoElement:0}),_f=Va(vr),Ih=I({},Ui,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Dh=Va(Ih),ns=I({},$a,{newState:0,oldState:0}),Eo=Va(ns),Fg=[9,13,27,32],zl=zo&&"CompositionEvent"in window,fa=null;zo&&"documentMode"in document&&(fa=document.documentMode);var Rh=zo&&"TextEvent"in window&&!fa,Lh=zo&&(!zl||fa&&8<fa&&11>=fa),zh=" ",Yu=!1;function is(d,_){switch(d){case"keyup":return Fg.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rc(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Ha=!1;function uu(d,_){switch(d){case"compositionend":return rc(_);case"keypress":return _.which!==32?null:(Yu=!0,zh);case"textInput":return d=_.data,d===zh&&Yu?null:d;default:return null}}function Ri(d,_){if(Ha)return d==="compositionend"||!zl&&is(d,_)?(d=Ma(),Qa=ws=Rs=null,Ha=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return Lh&&_.locale!=="ko"?null:_.data;default:return null}}var Tn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ds(d){var _=d&&d.nodeName&&d.nodeName.toLowerCase();return _==="input"?!!Tn[d.type]:_==="textarea"}function di(d,_,A,k){Zi?yr?yr.push(k):yr=[k]:Zi=k,_=Jm(_,"onChange"),0<_.length&&(A=new Tl("onChange","change",null,A,k),d.push({event:A,listeners:_}))}var Vr=null,Bc=null;function li(d){Lb(d,0)}function jc(d){var _=Zt(d);if(cr(_))return d}function Zl(d,_){if(d==="change")return _}var oc=!1;if(zo){var Ku;if(zo){var ul="oninput"in document;if(!ul){var la=document.createElement("div");la.setAttribute("oninput","return;"),ul=typeof la.oninput=="function"}Ku=ul}else Ku=!1;oc=Ku&&(!document.documentMode||9<document.documentMode)}function Fc(){Vr&&(Vr.detachEvent("onpropertychange",Ia),Bc=Vr=null)}function Ia(d){if(d.propertyName==="value"&&jc(Bc)){var _=[];di(_,Bc,d,Vn(d)),Sr(li,_)}}function Ad(d,_,A){d==="focusin"?(Fc(),Vr=_,Bc=A,Vr.attachEvent("onpropertychange",Ia)):d==="focusout"&&Fc()}function ac(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return jc(Bc)}function ia(d,_){if(d==="click")return jc(_)}function Pd(d,_){if(d==="input"||d==="change")return jc(_)}function kh(d,_){return d===_&&(d!==0||1/d===1/_)||d!==d&&_!==_}var Sl=typeof Object.is=="function"?Object.is:kh;function Ga(d,_){if(Sl(d,_))return!0;if(typeof d!="object"||d===null||typeof _!="object"||_===null)return!1;var A=Object.keys(d),k=Object.keys(_);if(A.length!==k.length)return!1;for(k=0;k<A.length;k++){var H=A[k];if(!mn.call(_,H)||!Sl(d[H],_[H]))return!1}return!0}function sc(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Uc(d,_){var A=sc(d);d=0;for(var k;A;){if(A.nodeType===3){if(k=d+A.textContent.length,d<=_&&k>=_)return{node:A,offset:_-d};d=k}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=sc(A)}}function Vc(d,_){return d&&_?d===_?!0:d&&d.nodeType===3?!1:_&&_.nodeType===3?Vc(d,_.parentNode):"contains"in d?d.contains(_):d.compareDocumentPosition?!!(d.compareDocumentPosition(_)&16):!1:!1}function Nh(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var _=Kr(d.document);_ instanceof d.HTMLIFrameElement;){try{var A=typeof _.contentWindow.location.href=="string"}catch{A=!1}if(A)d=_.contentWindow;else break;_=Kr(d.document)}return _}function hu(d){var _=d&&d.nodeName&&d.nodeName.toLowerCase();return _&&(_==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||_==="textarea"||d.contentEditable==="true")}var Bh=zo&&"documentMode"in document&&11>=document.documentMode,rs=null,jh=null,Ju=null,Cd=!1;function gp(d,_,A){var k=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;Cd||rs==null||rs!==Kr(k)||(k=rs,"selectionStart"in k&&hu(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Ju&&Ga(Ju,k)||(Ju=k,k=Jm(jh,"onSelect"),0<k.length&&(_=new Tl("onSelect","select",null,_,A),d.push({event:_,listeners:k}),_.target=rs)))}function zs(d,_){var A={};return A[d.toLowerCase()]=_.toLowerCase(),A["Webkit"+d]="webkit"+_,A["Moz"+d]="moz"+_,A}var du={animationend:zs("Animation","AnimationEnd"),animationiteration:zs("Animation","AnimationIteration"),animationstart:zs("Animation","AnimationStart"),transitionrun:zs("Transition","TransitionRun"),transitionstart:zs("Transition","TransitionStart"),transitioncancel:zs("Transition","TransitionCancel"),transitionend:zs("Transition","TransitionEnd")},Md={},Od={};zo&&(Od=document.createElement("div").style,"AnimationEvent"in window||(delete du.animationend.animation,delete du.animationiteration.animation,delete du.animationstart.animation),"TransitionEvent"in window||delete du.transitionend.transition);function lc(d){if(Md[d])return Md[d];if(!du[d])return d;var _=du[d],A;for(A in _)if(_.hasOwnProperty(A)&&A in Od)return Md[d]=_[A];return d}var yf=lc("animationend"),Uo=lc("animationiteration"),$c=lc("animationstart"),_p=lc("transitionrun"),Fh=lc("transitionstart"),Uh=lc("transitioncancel"),fu=lc("transitionend"),vf=new Map,cc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cc.push("scrollEnd");function pa(d,_){vf.set(d,_),si(_,[d])}var uc=new WeakMap;function fn(d,_){if(typeof d=="object"&&d!==null){var A=uc.get(d);return A!==void 0?A:(_={value:d,source:_,stack:or(_)},uc.set(d,_),_)}return{value:d,source:_,stack:or(_)}}var Zs=[],Wl=0,ks=0;function qc(){for(var d=Wl,_=ks=Wl=0;_<d;){var A=Zs[_];Zs[_++]=null;var k=Zs[_];Zs[_++]=null;var H=Zs[_];Zs[_++]=null;var ee=Zs[_];if(Zs[_++]=null,k!==null&&H!==null){var Ae=k.pending;Ae===null?H.next=H:(H.next=Ae.next,Ae.next=H),k.pending=H}ee!==0&&Bs(A,H,ee)}}function Hc(d,_,A,k){Zs[Wl++]=d,Zs[Wl++]=_,Zs[Wl++]=A,Zs[Wl++]=k,ks|=k,d.lanes|=k,d=d.alternate,d!==null&&(d.lanes|=k)}function Ns(d,_,A,k){return Hc(d,_,A,k),Oi(d)}function Gc(d,_){return Hc(d,null,null,_),Oi(d)}function Bs(d,_,A){d.lanes|=A;var k=d.alternate;k!==null&&(k.lanes|=A);for(var H=!1,ee=d.return;ee!==null;)ee.childLanes|=A,k=ee.alternate,k!==null&&(k.childLanes|=A),ee.tag===22&&(d=ee.stateNode,d===null||d._visibility&1||(H=!0)),d=ee,ee=ee.return;return d.tag===3?(ee=d.stateNode,H&&_!==null&&(H=31-Po(A),d=ee.hiddenUpdates,k=d[H],k===null?d[H]=[_]:k.push(_),_.lane=A|536870912),ee):null}function Oi(d){if(50<dl)throw dl=0,Ks=null,Error(s(185));for(var _=d.return;_!==null;)d=_,_=d.return;return d.tag===3?d.stateNode:null}var kl={};function bm(d,_,A,k){this.tag=d,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function El(d,_,A,k){return new bm(d,_,A,k)}function Qu(d){return d=d.prototype,!(!d||!d.isReactComponent)}function hc(d,_){var A=d.alternate;return A===null?(A=El(d.tag,_,d.key,d.mode),A.elementType=d.elementType,A.type=d.type,A.stateNode=d.stateNode,A.alternate=d,d.alternate=A):(A.pendingProps=_,A.type=d.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=d.flags&65011712,A.childLanes=d.childLanes,A.lanes=d.lanes,A.child=d.child,A.memoizedProps=d.memoizedProps,A.memoizedState=d.memoizedState,A.updateQueue=d.updateQueue,_=d.dependencies,A.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},A.sibling=d.sibling,A.index=d.index,A.ref=d.ref,A.refCleanup=d.refCleanup,A}function Jr(d,_){d.flags&=65011714;var A=d.alternate;return A===null?(d.childLanes=0,d.lanes=_,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=A.childLanes,d.lanes=A.lanes,d.child=A.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=A.memoizedProps,d.memoizedState=A.memoizedState,d.updateQueue=A.updateQueue,d.type=A.type,_=A.dependencies,d.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),d}function Vh(d,_,A,k,H,ee){var Ae=0;if(k=d,typeof d=="function")Qu(d)&&(Ae=1);else if(typeof d=="string")Ae=O2(d,A,An.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case Ge:return d=El(31,A,_,H),d.elementType=Ge,d.lanes=ee,d;case J:return dc(A.children,H,ee,_);case te:Ae=8,H|=24;break;case oe:return d=El(12,A,_,H|2),d.elementType=oe,d.lanes=ee,d;case Oe:return d=El(13,A,_,H),d.elementType=Oe,d.lanes=ee,d;case xe:return d=El(19,A,_,H),d.elementType=xe,d.lanes=ee,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case ce:case ue:Ae=10;break e;case de:Ae=9;break e;case Pe:Ae=11;break e;case Qe:Ae=14;break e;case tt:Ae=16,k=null;break e}Ae=29,A=Error(s(130,d===null?"null":typeof d,"")),k=null}return _=El(Ae,A,_,H),_.elementType=d,_.type=k,_.lanes=ee,_}function dc(d,_,A,k){return d=El(7,d,k,_),d.lanes=A,d}function yp(d,_,A){return d=El(6,d,null,_),d.lanes=A,d}function xf(d,_,A){return _=El(4,d.children!==null?d.children:[],d.key,_),_.lanes=A,_.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},_}var eh=[],$h=0,b=null,z=0,$=[],ne=0,ve=null,Be=1,_t="";function Wt(d,_){eh[$h++]=z,eh[$h++]=b,b=d,z=_}function ln(d,_,A){$[ne++]=Be,$[ne++]=_t,$[ne++]=ve,ve=d;var k=Be;d=_t;var H=32-Po(k)-1;k&=~(1<<H),A+=1;var ee=32-Po(_)+H;if(30<ee){var Ae=H-H%5;ee=(k&(1<<Ae)-1).toString(32),k>>=Ae,H-=Ae,Be=1<<32-Po(_)+H|A<<H|k,_t=ee+d}else Be=1<<ee|A<<H|k,_t=d}function Un(d){d.return!==null&&(Wt(d,1),ln(d,1,0))}function yi(d){for(;d===b;)b=eh[--$h],eh[$h]=null,z=eh[--$h],eh[$h]=null;for(;d===ve;)ve=$[--ne],$[ne]=null,_t=$[--ne],$[ne]=null,Be=$[--ne],$[ne]=null}var Ti=null,Ai=null,br=!1,Wo=null,ba=!1,Da=Error(s(519));function Ws(d){var _=Error(s(418,""));throw th(fn(_,d)),Da}function Id(d){var _=d.stateNode,A=d.type,k=d.memoizedProps;switch(_[ae]=d,_[ge]=k,A){case"dialog":ao("cancel",_),ao("close",_);break;case"iframe":case"object":case"embed":ao("load",_);break;case"video":case"audio":for(A=0;A<Ym.length;A++)ao(Ym[A],_);break;case"source":ao("error",_);break;case"img":case"image":case"link":ao("error",_),ao("load",_);break;case"details":ao("toggle",_);break;case"input":ao("invalid",_),xs(_,k.value,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name,!0),sl(_);break;case"select":ao("invalid",_);break;case"textarea":ao("invalid",_),ha(_,k.value,k.defaultValue,k.children),sl(_)}A=k.children,typeof A!="string"&&typeof A!="number"&&typeof A!="bigint"||_.textContent===""+A||k.suppressHydrationWarning===!0||Nb(_.textContent,A)?(k.popover!=null&&(ao("beforetoggle",_),ao("toggle",_)),k.onScroll!=null&&ao("scroll",_),k.onScrollEnd!=null&&ao("scrollend",_),k.onClick!=null&&(_.onclick=ky),_=!0):_=!1,_||Ws(d)}function bf(d){for(Ti=d.return;Ti;)switch(Ti.tag){case 5:case 13:ba=!1;return;case 27:case 3:ba=!0;return;default:Ti=Ti.return}}function pu(d){if(d!==Ti)return!1;if(!br)return bf(d),br=!0,!1;var _=d.tag,A;if((A=_!==3&&_!==27)&&((A=_===5)&&(A=d.type,A=!(A!=="form"&&A!=="button")||_0(d.type,d.memoizedProps)),A=!A),A&&Ai&&Ws(d),bf(d),_===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));e:{for(d=d.nextSibling,_=0;d;){if(d.nodeType===8)if(A=d.data,A==="/$"){if(_===0){Ai=ju(d.nextSibling);break e}_--}else A!=="$"&&A!=="$!"&&A!=="$?"||_++;d=d.nextSibling}Ai=null}}else _===27?(_=Ai,Yo(d.type)?(d=Jp,Jp=null,Ai=d):Ai=_):Ai=Ti?ju(d.stateNode.nextSibling):null;return!0}function fc(){Ai=Ti=null,br=!1}function vp(){var d=Wo;return d!==null&&(jr===null?jr=d:jr.push.apply(jr,d),Wo=null),d}function th(d){Wo===null?Wo=[d]:Wo.push(d)}var ma=Pt(null),Ss=null,pc=null;function Zc(d,_,A){on(ma,_._currentValue),_._currentValue=A}function Wc(d){d._currentValue=ma.current,$t(ma)}function Dd(d,_,A){for(;d!==null;){var k=d.alternate;if((d.childLanes&_)!==_?(d.childLanes|=_,k!==null&&(k.childLanes|=_)):k!==null&&(k.childLanes&_)!==_&&(k.childLanes|=_),d===A)break;d=d.return}}function qh(d,_,A,k){var H=d.child;for(H!==null&&(H.return=d);H!==null;){var ee=H.dependencies;if(ee!==null){var Ae=H.child;ee=ee.firstContext;e:for(;ee!==null;){var He=ee;ee=H;for(var vt=0;vt<_.length;vt++)if(He.context===_[vt]){ee.lanes|=A,He=ee.alternate,He!==null&&(He.lanes|=A),Dd(ee.return,A,d),k||(Ae=null);break e}ee=He.next}}else if(H.tag===18){if(Ae=H.return,Ae===null)throw Error(s(341));Ae.lanes|=A,ee=Ae.alternate,ee!==null&&(ee.lanes|=A),Dd(Ae,A,d),Ae=null}else Ae=H.child;if(Ae!==null)Ae.return=H;else for(Ae=H;Ae!==null;){if(Ae===d){Ae=null;break}if(H=Ae.sibling,H!==null){H.return=Ae.return,Ae=H;break}Ae=Ae.return}H=Ae}}function mu(d,_,A,k){d=null;for(var H=_,ee=!1;H!==null;){if(!ee){if((H.flags&524288)!==0)ee=!0;else if((H.flags&262144)!==0)break}if(H.tag===10){var Ae=H.alternate;if(Ae===null)throw Error(s(387));if(Ae=Ae.memoizedProps,Ae!==null){var He=H.type;Sl(H.pendingProps.value,Ae.value)||(d!==null?d.push(He):d=[He])}}else if(H===In.current){if(Ae=H.alternate,Ae===null)throw Error(s(387));Ae.memoizedState.memoizedState!==H.memoizedState.memoizedState&&(d!==null?d.push(ig):d=[ig])}H=H.return}d!==null&&qh(_,d,A,k),_.flags|=262144}function Rd(d){for(d=d.firstContext;d!==null;){if(!Sl(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function Nl(d){Ss=d,pc=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function js(d){return yy(Ss,d)}function wf(d,_){return Ss===null&&Nl(d),yy(d,_)}function yy(d,_){var A=_._currentValue;if(_={context:_,memoizedValue:A,next:null},pc===null){if(d===null)throw Error(s(308));pc=_,d.dependencies={lanes:0,firstContext:_},d.flags|=524288}else pc=pc.next=_;return A}var Ld=typeof AbortController<"u"?AbortController:function(){var d=[],_=this.signal={aborted:!1,addEventListener:function(A,k){d.push(k)}};this.abort=function(){_.aborted=!0,d.forEach(function(A){return A()})}},zd=e.unstable_scheduleCallback,vy=e.unstable_NormalPriority,Oo={$$typeof:ue,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tf(){return{controller:new Ld,data:new Map,refCount:0}}function nh(d){d.refCount--,d.refCount===0&&zd(vy,function(){d.controller.abort()})}var Hh=null,xp=0,Gh=0,ih=null;function bp(d,_){if(Hh===null){var A=Hh=[];xp=0,Gh=h_(),ih={status:"pending",value:void 0,then:function(k){A.push(k)}}}return xp++,_.then(kd,kd),_}function kd(){if(--xp===0&&Hh!==null){ih!==null&&(ih.status="fulfilled");var d=Hh;Hh=null,Gh=0,ih=null;for(var _=0;_<d.length;_++)(0,d[_])()}}function Ug(d,_){var A=[],k={status:"pending",value:null,reason:null,then:function(H){A.push(H)}};return d.then(function(){k.status="fulfilled",k.value=_;for(var H=0;H<A.length;H++)(0,A[H])(_)},function(H){for(k.status="rejected",k.reason=H,H=0;H<A.length;H++)(0,A[H])(void 0)}),k}var Sf=rt.S;rt.S=function(d,_){typeof _=="object"&&_!==null&&typeof _.then=="function"&&bp(d,_),Sf!==null&&Sf(d,_)};var Zh=Pt(null);function wm(){var d=Zh.current;return d!==null?d:Kn.pooledCache}function gu(d,_){_===null?on(Zh,Zh.current):on(Zh,_.pool)}function Vg(){var d=wm();return d===null?null:{parent:Oo._currentValue,pool:d}}var wp=Error(s(460)),xy=Error(s(474)),Tm=Error(s(542)),Ef={then:function(){}};function by(d){return d=d.status,d==="fulfilled"||d==="rejected"}function Nd(){}function Sm(d,_,A){switch(A=d[A],A===void 0?d.push(_):A!==_&&(_.then(Nd,Nd),_=A),_.status){case"fulfilled":return _.value;case"rejected":throw d=_.reason,Em(d),d;default:if(typeof _.status=="string")_.then(Nd,Nd);else{if(d=Kn,d!==null&&100<d.shellSuspendCounter)throw Error(s(482));d=_,d.status="pending",d.then(function(k){if(_.status==="pending"){var H=_;H.status="fulfilled",H.value=k}},function(k){if(_.status==="pending"){var H=_;H.status="rejected",H.reason=k}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw d=_.reason,Em(d),d}throw Af=_,wp}}var Af=null;function Wh(){if(Af===null)throw Error(s(459));var d=Af;return Af=null,d}function Em(d){if(d===wp||d===Tm)throw Error(s(483))}var _u=!1;function Am(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yu(d,_){d=d.updateQueue,_.updateQueue===d&&(_.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Bl(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function rh(d,_,A){var k=d.updateQueue;if(k===null)return null;if(k=k.shared,(Rn&2)!==0){var H=k.pending;return H===null?_.next=_:(_.next=H.next,H.next=_),k.pending=_,_=Oi(d),Bs(d,null,A),_}return Hc(d,k,_,A),Oi(d)}function mc(d,_,A){if(_=_.updateQueue,_!==null&&(_=_.shared,(A&4194048)!==0)){var k=_.lanes;k&=d.pendingLanes,A|=k,_.lanes=A,hn(d,A)}}function Pf(d,_){var A=d.updateQueue,k=d.alternate;if(k!==null&&(k=k.updateQueue,A===k)){var H=null,ee=null;if(A=A.firstBaseUpdate,A!==null){do{var Ae={lane:A.lane,tag:A.tag,payload:A.payload,callback:null,next:null};ee===null?H=ee=Ae:ee=ee.next=Ae,A=A.next}while(A!==null);ee===null?H=ee=_:ee=ee.next=_}else H=ee=_;A={baseState:k.baseState,firstBaseUpdate:H,lastBaseUpdate:ee,shared:k.shared,callbacks:k.callbacks},d.updateQueue=A;return}d=A.lastBaseUpdate,d===null?A.firstBaseUpdate=_:d.next=_,A.lastBaseUpdate=_}var Bd=!1;function jd(){if(Bd){var d=ih;if(d!==null)throw d}}function Fd(d,_,A,k){Bd=!1;var H=d.updateQueue;_u=!1;var ee=H.firstBaseUpdate,Ae=H.lastBaseUpdate,He=H.shared.pending;if(He!==null){H.shared.pending=null;var vt=He,Qt=vt.next;vt.next=null,Ae===null?ee=Qt:Ae.next=Qt,Ae=vt;var Mn=d.alternate;Mn!==null&&(Mn=Mn.updateQueue,He=Mn.lastBaseUpdate,He!==Ae&&(He===null?Mn.firstBaseUpdate=Qt:He.next=Qt,Mn.lastBaseUpdate=vt))}if(ee!==null){var $n=H.baseState;Ae=0,Mn=Qt=vt=null,He=ee;do{var nn=He.lane&-536870913,cn=nn!==He.lane;if(cn?(_i&nn)===nn:(k&nn)===nn){nn!==0&&nn===Gh&&(Bd=!0),Mn!==null&&(Mn=Mn.next={lane:0,tag:He.tag,payload:He.payload,callback:null,next:null});e:{var pr=d,ur=He;nn=_;var $o=A;switch(ur.tag){case 1:if(pr=ur.payload,typeof pr=="function"){$n=pr.call($o,$n,nn);break e}$n=pr;break e;case 3:pr.flags=pr.flags&-65537|128;case 0:if(pr=ur.payload,nn=typeof pr=="function"?pr.call($o,$n,nn):pr,nn==null)break e;$n=I({},$n,nn);break e;case 2:_u=!0}}nn=He.callback,nn!==null&&(d.flags|=64,cn&&(d.flags|=8192),cn=H.callbacks,cn===null?H.callbacks=[nn]:cn.push(nn))}else cn={lane:nn,tag:He.tag,payload:He.payload,callback:He.callback,next:null},Mn===null?(Qt=Mn=cn,vt=$n):Mn=Mn.next=cn,Ae|=nn;if(He=He.next,He===null){if(He=H.shared.pending,He===null)break;cn=He,He=cn.next,cn.next=null,H.lastBaseUpdate=cn,H.shared.pending=null}}while(!0);Mn===null&&(vt=$n),H.baseState=vt,H.firstBaseUpdate=Qt,H.lastBaseUpdate=Mn,ee===null&&(H.shared.lanes=0),Pr|=Ae,d.lanes=Ae,d.memoizedState=$n}}function Cf(d,_){if(typeof d!="function")throw Error(s(191,d));d.call(_)}function Mf(d,_){var A=d.callbacks;if(A!==null)for(d.callbacks=null,d=0;d<A.length;d++)Cf(A[d],_)}var Ud=Pt(null),Tp=Pt(0);function Xl(d,_){d=xi,on(Tp,d),on(Ud,_),xi=d|_.baseLanes}function $g(){on(Tp,xi),on(Ud,Ud.current)}function qg(){xi=Tp.current,$t(Ud),$t(Tp)}var vu=0,$r=null,xo=null,Ra=null,gc=!1,xu=!1,Xc=!1,Sp=0,bu=0,Yc=null,Pm=0;function La(){throw Error(s(321))}function Ep(d,_){if(_===null)return!1;for(var A=0;A<_.length&&A<d.length;A++)if(!Sl(d[A],_[A]))return!1;return!0}function Kc(d,_,A,k,H,ee){return vu=ee,$r=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,rt.H=d===null||d.memoizedState===null?Lm:Lp,Xc=!1,ee=A(k,H),Xc=!1,xu&&(ee=Nn(_,A,k,H)),wu(d),ee}function wu(d){rt.H=Jc;var _=xo!==null&&xo.next!==null;if(vu=0,Ra=xo=$r=null,gc=!1,bu=0,Yc=null,_)throw Error(s(300));d===null||As||(d=d.dependencies,d!==null&&Rd(d)&&(As=!0))}function Nn(d,_,A,k){$r=d;var H=0;do{if(xu&&(Yc=null),bu=0,xu=!1,25<=H)throw Error(s(301));if(H+=1,Ra=xo=null,d.updateQueue!=null){var ee=d.updateQueue;ee.lastEffect=null,ee.events=null,ee.stores=null,ee.memoCache!=null&&(ee.memoCache.index=0)}rt.H=Nf,ee=_(A,k)}while(xu);return ee}function wy(){var d=rt.H,_=d.useState()[0];return _=typeof _.then=="function"?Ap(_):_,d=d.useState()[0],(xo!==null?xo.memoizedState:null)!==d&&($r.flags|=1024),_}function Cm(){var d=Sp!==0;return Sp=0,d}function Tu(d,_,A){_.updateQueue=d.updateQueue,_.flags&=-2053,d.lanes&=~A}function Su(d){if(gc){for(d=d.memoizedState;d!==null;){var _=d.queue;_!==null&&(_.pending=null),d=d.next}gc=!1}vu=0,Ra=xo=$r=null,xu=!1,bu=Sp=0,Yc=null}function Qn(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ra===null?$r.memoizedState=Ra=d:Ra=Ra.next=d,Ra}function wa(){if(xo===null){var d=$r.alternate;d=d!==null?d.memoizedState:null}else d=xo.next;var _=Ra===null?$r.memoizedState:Ra.next;if(_!==null)Ra=_,xo=d;else{if(d===null)throw $r.alternate===null?Error(s(467)):Error(s(310));xo=d,d={memoizedState:xo.memoizedState,baseState:xo.baseState,baseQueue:xo.baseQueue,queue:xo.queue,next:null},Ra===null?$r.memoizedState=Ra=d:Ra=Ra.next=d}return Ra}function Hg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ap(d){var _=bu;return bu+=1,Yc===null&&(Yc=[]),d=Sm(Yc,d,_),_=$r,(Ra===null?_.memoizedState:Ra.next)===null&&(_=_.alternate,rt.H=_===null||_.memoizedState===null?Lm:Lp),d}function Of(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Ap(d);if(d.$$typeof===ue)return js(d)}throw Error(s(438,String(d)))}function Mm(d){var _=null,A=$r.updateQueue;if(A!==null&&(_=A.memoCache),_==null){var k=$r.alternate;k!==null&&(k=k.updateQueue,k!==null&&(k=k.memoCache,k!=null&&(_={data:k.data.map(function(H){return H.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),A===null&&(A=Hg(),$r.updateQueue=A),A.memoCache=_,A=_.data[_.index],A===void 0)for(A=_.data[_.index]=Array(d),k=0;k<d;k++)A[k]=Je;return _.index++,A}function oh(d,_){return typeof _=="function"?_(d):_}function Pp(d){var _=wa();return Gg(_,xo,d)}function Gg(d,_,A){var k=d.queue;if(k===null)throw Error(s(311));k.lastRenderedReducer=A;var H=d.baseQueue,ee=k.pending;if(ee!==null){if(H!==null){var Ae=H.next;H.next=ee.next,ee.next=Ae}_.baseQueue=H=ee,k.pending=null}if(ee=d.baseState,H===null)d.memoizedState=ee;else{_=H.next;var He=Ae=null,vt=null,Qt=_,Mn=!1;do{var $n=Qt.lane&-536870913;if($n!==Qt.lane?(_i&$n)===$n:(vu&$n)===$n){var nn=Qt.revertLane;if(nn===0)vt!==null&&(vt=vt.next={lane:0,revertLane:0,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null}),$n===Gh&&(Mn=!0);else if((vu&nn)===nn){Qt=Qt.next,nn===Gh&&(Mn=!0);continue}else $n={lane:0,revertLane:Qt.revertLane,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},vt===null?(He=vt=$n,Ae=ee):vt=vt.next=$n,$r.lanes|=nn,Pr|=nn;$n=Qt.action,Xc&&A(ee,$n),ee=Qt.hasEagerState?Qt.eagerState:A(ee,$n)}else nn={lane:$n,revertLane:Qt.revertLane,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},vt===null?(He=vt=nn,Ae=ee):vt=vt.next=nn,$r.lanes|=$n,Pr|=$n;Qt=Qt.next}while(Qt!==null&&Qt!==_);if(vt===null?Ae=ee:vt.next=He,!Sl(ee,d.memoizedState)&&(As=!0,Mn&&(A=ih,A!==null)))throw A;d.memoizedState=ee,d.baseState=Ae,d.baseQueue=vt,k.lastRenderedState=ee}return H===null&&(k.lanes=0),[d.memoizedState,k.dispatch]}function Zg(d){var _=wa(),A=_.queue;if(A===null)throw Error(s(311));A.lastRenderedReducer=d;var k=A.dispatch,H=A.pending,ee=_.memoizedState;if(H!==null){A.pending=null;var Ae=H=H.next;do ee=d(ee,Ae.action),Ae=Ae.next;while(Ae!==H);Sl(ee,_.memoizedState)||(As=!0),_.memoizedState=ee,_.baseQueue===null&&(_.baseState=ee),A.lastRenderedState=ee}return[ee,k]}function Al(d,_,A){var k=$r,H=wa(),ee=br;if(ee){if(A===void 0)throw Error(s(407));A=A()}else A=_();var Ae=!Sl((xo||H).memoizedState,A);Ae&&(H.memoizedState=A,As=!0),H=H.queue;var He=Eu.bind(null,k,H,d);if(Pl(2048,8,He,[d]),H.getSnapshot!==_||Ae||Ra!==null&&Ra.memoizedState.tag&1){if(k.flags|=2048,bn(9,Cu(),Xs.bind(null,k,H,A,_),null),Kn===null)throw Error(s(349));ee||(vu&124)!==0||Om(k,_,A)}return A}function Om(d,_,A){d.flags|=16384,d={getSnapshot:_,value:A},_=$r.updateQueue,_===null?(_=Hg(),$r.updateQueue=_,_.stores=[d]):(A=_.stores,A===null?_.stores=[d]:A.push(d))}function Xs(d,_,A,k){_.value=A,_.getSnapshot=k,Xh(_)&&Cp(d)}function Eu(d,_,A){return A(function(){Xh(_)&&Cp(d)})}function Xh(d){var _=d.getSnapshot;d=d.value;try{var A=_();return!Sl(d,A)}catch{return!0}}function Cp(d){var _=Gc(d,2);_!==null&&ps(_,d,2)}function If(d){var _=Qn();if(typeof d=="function"){var A=d;if(d=A(),Xc){Fa(!0);try{A()}finally{Fa(!1)}}}return _.memoizedState=_.baseState=d,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oh,lastRenderedState:d},_}function Vd(d,_,A,k){return d.baseState=A,Gg(d,xo,typeof k=="function"?k:oh)}function Ty(d,_,A,k,H){if(_c(d))throw Error(s(485));if(d=_.action,d!==null){var ee={payload:H,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Ae){ee.listeners.push(Ae)}};rt.T!==null?A(!0):ee.isTransition=!1,k(ee),A=_.pending,A===null?(ee.next=_.pending=ee,Au(_,ee)):(ee.next=A.next,_.pending=A.next=ee)}}function Au(d,_){var A=_.action,k=_.payload,H=d.state;if(_.isTransition){var ee=rt.T,Ae={};rt.T=Ae;try{var He=A(H,k),vt=rt.S;vt!==null&&vt(Ae,He),Mr(d,_,He)}catch(Qt){Pu(d,_,Qt)}finally{rt.T=ee}}else try{ee=A(H,k),Mr(d,_,ee)}catch(Qt){Pu(d,_,Qt)}}function Mr(d,_,A){A!==null&&typeof A=="object"&&typeof A.then=="function"?A.then(function(k){Df(d,_,k)},function(k){return Pu(d,_,k)}):Df(d,_,A)}function Df(d,_,A){_.status="fulfilled",_.value=A,Wg(_),d.state=A,_=d.pending,_!==null&&(A=_.next,A===_?d.pending=null:(A=A.next,_.next=A,Au(d,A)))}function Pu(d,_,A){var k=d.pending;if(d.pending=null,k!==null){k=k.next;do _.status="rejected",_.reason=A,Wg(_),_=_.next;while(_!==k)}d.action=null}function Wg(d){d=d.listeners;for(var _=0;_<d.length;_++)(0,d[_])()}function Xg(d,_){return _}function Yg(d,_){if(br){var A=Kn.formState;if(A!==null){e:{var k=$r;if(br){if(Ai){t:{for(var H=Ai,ee=ba;H.nodeType!==8;){if(!ee){H=null;break t}if(H=ju(H.nextSibling),H===null){H=null;break t}}ee=H.data,H=ee==="F!"||ee==="F"?H:null}if(H){Ai=ju(H.nextSibling),k=H.data==="F!";break e}}Ws(k)}k=!1}k&&(_=A[0])}}return A=Qn(),A.memoizedState=A.baseState=_,k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xg,lastRenderedState:_},A.queue=k,A=Qr.bind(null,$r,k),k.dispatch=A,k=If(!1),ee=Rp.bind(null,$r,!1,k.queue),k=Qn(),H={state:_,dispatch:null,action:d,pending:null},k.queue=H,A=Ty.bind(null,$r,H,ee,A),H.dispatch=A,k.memoizedState=d,[_,A,!1]}function Sy(d){var _=wa();return $d(_,xo,d)}function $d(d,_,A){if(_=Gg(d,_,Xg)[0],d=Pp(oh)[0],typeof _=="object"&&_!==null&&typeof _.then=="function")try{var k=Ap(_)}catch(Ae){throw Ae===wp?Tm:Ae}else k=_;_=wa();var H=_.queue,ee=H.dispatch;return A!==_.memoizedState&&($r.flags|=2048,bn(9,Cu(),qd.bind(null,H,A),null)),[k,ee,d]}function qd(d,_){d.action=_}function an(d){var _=wa(),A=xo;if(A!==null)return $d(_,A,d);wa(),_=_.memoizedState,A=wa();var k=A.queue.dispatch;return A.memoizedState=d,[_,k,!1]}function bn(d,_,A,k){return d={tag:d,create:A,deps:k,inst:_,next:null},_=$r.updateQueue,_===null&&(_=Hg(),$r.updateQueue=_),A=_.lastEffect,A===null?_.lastEffect=d.next=d:(k=A.next,A.next=d,d.next=k,_.lastEffect=d),d}function Cu(){return{destroy:void 0,resource:void 0}}function bo(){return wa().memoizedState}function ft(d,_,A,k){var H=Qn();k=k===void 0?null:k,$r.flags|=d,H.memoizedState=bn(1|_,Cu(),A,k)}function Pl(d,_,A,k){var H=wa();k=k===void 0?null:k;var ee=H.memoizedState.inst;xo!==null&&k!==null&&Ep(k,xo.memoizedState.deps)?H.memoizedState=bn(_,ee,A,k):($r.flags|=d,H.memoizedState=bn(1|_,ee,A,k))}function Mp(d,_){ft(8390656,8,d,_)}function Op(d,_){Pl(2048,8,d,_)}function Im(d,_){return Pl(4,2,d,_)}function Kg(d,_){return Pl(4,4,d,_)}function Jg(d,_){if(typeof _=="function"){d=d();var A=_(d);return function(){typeof A=="function"?A():_(null)}}if(_!=null)return d=d(),_.current=d,function(){_.current=null}}function Hd(d,_,A){A=A!=null?A.concat([d]):null,Pl(4,4,Jg.bind(null,_,d),A)}function Qg(){}function Ey(d,_){var A=wa();_=_===void 0?null:_;var k=A.memoizedState;return _!==null&&Ep(_,k[1])?k[0]:(A.memoizedState=[d,_],d)}function e_(d,_){var A=wa();_=_===void 0?null:_;var k=A.memoizedState;if(_!==null&&Ep(_,k[1]))return k[0];if(k=d(),Xc){Fa(!0);try{d()}finally{Fa(!1)}}return A.memoizedState=[k,_],k}function Rf(d,_,A){return A===void 0||(vu&1073741824)!==0?d.memoizedState=_:(d.memoizedState=A,d=Sc(),$r.lanes|=d,Pr|=d,A)}function Dm(d,_,A,k){return Sl(A,_)?A:Ud.current!==null?(d=Rf(d,A,k),Sl(d,_)||(As=!0),d):(vu&42)===0?(As=!0,d.memoizedState=A):(d=Sc(),$r.lanes|=d,Pr|=d,_)}function Rm(d,_,A,k,H){var ee=Bt.p;Bt.p=ee!==0&&8>ee?ee:8;var Ae=rt.T,He={};rt.T=He,Rp(d,!1,_,A);try{var vt=H(),Qt=rt.S;if(Qt!==null&&Qt(He,vt),vt!==null&&typeof vt=="object"&&typeof vt.then=="function"){var Mn=Ug(vt,k);ar(d,_,Mn,fs(d))}else ar(d,_,k,fs(d))}catch($n){ar(d,_,{then:function(){},status:"rejected",reason:$n},fs())}finally{Bt.p=ee,rt.T=Ae}}function Ay(){}function Lf(d,_,A,k){if(d.tag!==5)throw Error(s(476));var H=zf(d).queue;Rm(d,H,_,Vt,A===null?Ay:function(){return Yh(d),A(k)})}function zf(d){var _=d.memoizedState;if(_!==null)return _;_={memoizedState:Vt,baseState:Vt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oh,lastRenderedState:Vt},next:null};var A={};return _.next={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oh,lastRenderedState:A},next:null},d.memoizedState=_,d=d.alternate,d!==null&&(d.memoizedState=_),_}function Yh(d){var _=zf(d).next.queue;ar(d,_,{},fs())}function Ip(){return js(ig)}function ah(){return wa().memoizedState}function Fs(){return wa().memoizedState}function i0(d){for(var _=d.return;_!==null;){switch(_.tag){case 24:case 3:var A=fs();d=Bl(A);var k=rh(_,d,A);k!==null&&(ps(k,_,A),mc(k,_,A)),_={cache:Tf()},d.payload=_;return}_=_.return}}function Dp(d,_,A){var k=fs();A={lane:k,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null},_c(d)?kf(_,A):(A=Ns(d,_,A,k),A!==null&&(ps(A,d,k),Gd(A,_,k)))}function Qr(d,_,A){var k=fs();ar(d,_,A,k)}function ar(d,_,A,k){var H={lane:k,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null};if(_c(d))kf(_,H);else{var ee=d.alternate;if(d.lanes===0&&(ee===null||ee.lanes===0)&&(ee=_.lastRenderedReducer,ee!==null))try{var Ae=_.lastRenderedState,He=ee(Ae,A);if(H.hasEagerState=!0,H.eagerState=He,Sl(He,Ae))return Hc(d,_,H,0),Kn===null&&qc(),!1}catch{}finally{}if(A=Ns(d,_,H,k),A!==null)return ps(A,d,k),Gd(A,_,k),!0}return!1}function Rp(d,_,A,k){if(k={lane:2,revertLane:h_(),action:k,hasEagerState:!1,eagerState:null,next:null},_c(d)){if(_)throw Error(s(479))}else _=Ns(d,A,k,2),_!==null&&ps(_,d,2)}function _c(d){var _=d.alternate;return d===$r||_!==null&&_===$r}function kf(d,_){xu=gc=!0;var A=d.pending;A===null?_.next=_:(_.next=A.next,A.next=_),d.pending=_}function Gd(d,_,A){if((A&4194048)!==0){var k=_.lanes;k&=d.pendingLanes,A|=k,_.lanes=A,hn(d,A)}}var Jc={readContext:js,use:Of,useCallback:La,useContext:La,useEffect:La,useImperativeHandle:La,useLayoutEffect:La,useInsertionEffect:La,useMemo:La,useReducer:La,useRef:La,useState:La,useDebugValue:La,useDeferredValue:La,useTransition:La,useSyncExternalStore:La,useId:La,useHostTransitionStatus:La,useFormState:La,useActionState:La,useOptimistic:La,useMemoCache:La,useCacheRefresh:La},Lm={readContext:js,use:Of,useCallback:function(d,_){return Qn().memoizedState=[d,_===void 0?null:_],d},useContext:js,useEffect:Mp,useImperativeHandle:function(d,_,A){A=A!=null?A.concat([d]):null,ft(4194308,4,Jg.bind(null,_,d),A)},useLayoutEffect:function(d,_){return ft(4194308,4,d,_)},useInsertionEffect:function(d,_){ft(4,2,d,_)},useMemo:function(d,_){var A=Qn();_=_===void 0?null:_;var k=d();if(Xc){Fa(!0);try{d()}finally{Fa(!1)}}return A.memoizedState=[k,_],k},useReducer:function(d,_,A){var k=Qn();if(A!==void 0){var H=A(_);if(Xc){Fa(!0);try{A(_)}finally{Fa(!1)}}}else H=_;return k.memoizedState=k.baseState=H,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:H},k.queue=d,d=d.dispatch=Dp.bind(null,$r,d),[k.memoizedState,d]},useRef:function(d){var _=Qn();return d={current:d},_.memoizedState=d},useState:function(d){d=If(d);var _=d.queue,A=Qr.bind(null,$r,_);return _.dispatch=A,[d.memoizedState,A]},useDebugValue:Qg,useDeferredValue:function(d,_){var A=Qn();return Rf(A,d,_)},useTransition:function(){var d=If(!1);return d=Rm.bind(null,$r,d.queue,!0,!1),Qn().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,_,A){var k=$r,H=Qn();if(br){if(A===void 0)throw Error(s(407));A=A()}else{if(A=_(),Kn===null)throw Error(s(349));(_i&124)!==0||Om(k,_,A)}H.memoizedState=A;var ee={value:A,getSnapshot:_};return H.queue=ee,Mp(Eu.bind(null,k,ee,d),[d]),k.flags|=2048,bn(9,Cu(),Xs.bind(null,k,ee,A,_),null),A},useId:function(){var d=Qn(),_=Kn.identifierPrefix;if(br){var A=_t,k=Be;A=(k&~(1<<32-Po(k)-1)).toString(32)+A,_="«"+_+"R"+A,A=Sp++,0<A&&(_+="H"+A.toString(32)),_+="»"}else A=Pm++,_="«"+_+"r"+A.toString(32)+"»";return d.memoizedState=_},useHostTransitionStatus:Ip,useFormState:Yg,useActionState:Yg,useOptimistic:function(d){var _=Qn();_.memoizedState=_.baseState=d;var A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=A,_=Rp.bind(null,$r,!0,A),A.dispatch=_,[d,_]},useMemoCache:Mm,useCacheRefresh:function(){return Qn().memoizedState=i0.bind(null,$r)}},Lp={readContext:js,use:Of,useCallback:Ey,useContext:js,useEffect:Op,useImperativeHandle:Hd,useInsertionEffect:Im,useLayoutEffect:Kg,useMemo:e_,useReducer:Pp,useRef:bo,useState:function(){return Pp(oh)},useDebugValue:Qg,useDeferredValue:function(d,_){var A=wa();return Dm(A,xo.memoizedState,d,_)},useTransition:function(){var d=Pp(oh)[0],_=wa().memoizedState;return[typeof d=="boolean"?d:Ap(d),_]},useSyncExternalStore:Al,useId:ah,useHostTransitionStatus:Ip,useFormState:Sy,useActionState:Sy,useOptimistic:function(d,_){var A=wa();return Vd(A,xo,d,_)},useMemoCache:Mm,useCacheRefresh:Fs},Nf={readContext:js,use:Of,useCallback:Ey,useContext:js,useEffect:Op,useImperativeHandle:Hd,useInsertionEffect:Im,useLayoutEffect:Kg,useMemo:e_,useReducer:Zg,useRef:bo,useState:function(){return Zg(oh)},useDebugValue:Qg,useDeferredValue:function(d,_){var A=wa();return xo===null?Rf(A,d,_):Dm(A,xo.memoizedState,d,_)},useTransition:function(){var d=Zg(oh)[0],_=wa().memoizedState;return[typeof d=="boolean"?d:Ap(d),_]},useSyncExternalStore:Al,useId:ah,useHostTransitionStatus:Ip,useFormState:an,useActionState:an,useOptimistic:function(d,_){var A=wa();return xo!==null?Vd(A,xo,d,_):(A.baseState=d,[d,A.queue.dispatch])},useMemoCache:Mm,useCacheRefresh:Fs},Kh=null,jl=0;function Qc(d){var _=jl;return jl+=1,Kh===null&&(Kh=[]),Sm(Kh,d,_)}function sh(d,_){_=_.props.ref,d.ref=_!==void 0?_:null}function Zd(d,_){throw _.$$typeof===j?Error(s(525)):(d=Object.prototype.toString.call(_),Error(s(31,d==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":d)))}function Wd(d){var _=d._init;return _(d._payload)}function Xd(d){function _(Gt,Rt){if(d){var Kt=Gt.deletions;Kt===null?(Gt.deletions=[Rt],Gt.flags|=16):Kt.push(Rt)}}function A(Gt,Rt){if(!d)return null;for(;Rt!==null;)_(Gt,Rt),Rt=Rt.sibling;return null}function k(Gt){for(var Rt=new Map;Gt!==null;)Gt.key!==null?Rt.set(Gt.key,Gt):Rt.set(Gt.index,Gt),Gt=Gt.sibling;return Rt}function H(Gt,Rt){return Gt=hc(Gt,Rt),Gt.index=0,Gt.sibling=null,Gt}function ee(Gt,Rt,Kt){return Gt.index=Kt,d?(Kt=Gt.alternate,Kt!==null?(Kt=Kt.index,Kt<Rt?(Gt.flags|=67108866,Rt):Kt):(Gt.flags|=67108866,Rt)):(Gt.flags|=1048576,Rt)}function Ae(Gt){return d&&Gt.alternate===null&&(Gt.flags|=67108866),Gt}function He(Gt,Rt,Kt,Cn){return Rt===null||Rt.tag!==6?(Rt=yp(Kt,Gt.mode,Cn),Rt.return=Gt,Rt):(Rt=H(Rt,Kt),Rt.return=Gt,Rt)}function vt(Gt,Rt,Kt,Cn){var Si=Kt.type;return Si===J?Mn(Gt,Rt,Kt.props.children,Cn,Kt.key):Rt!==null&&(Rt.elementType===Si||typeof Si=="object"&&Si!==null&&Si.$$typeof===tt&&Wd(Si)===Rt.type)?(Rt=H(Rt,Kt.props),sh(Rt,Kt),Rt.return=Gt,Rt):(Rt=Vh(Kt.type,Kt.key,Kt.props,null,Gt.mode,Cn),sh(Rt,Kt),Rt.return=Gt,Rt)}function Qt(Gt,Rt,Kt,Cn){return Rt===null||Rt.tag!==4||Rt.stateNode.containerInfo!==Kt.containerInfo||Rt.stateNode.implementation!==Kt.implementation?(Rt=xf(Kt,Gt.mode,Cn),Rt.return=Gt,Rt):(Rt=H(Rt,Kt.children||[]),Rt.return=Gt,Rt)}function Mn(Gt,Rt,Kt,Cn,Si){return Rt===null||Rt.tag!==7?(Rt=dc(Kt,Gt.mode,Cn,Si),Rt.return=Gt,Rt):(Rt=H(Rt,Kt),Rt.return=Gt,Rt)}function $n(Gt,Rt,Kt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return Rt=yp(""+Rt,Gt.mode,Kt),Rt.return=Gt,Rt;if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case q:return Kt=Vh(Rt.type,Rt.key,Rt.props,null,Gt.mode,Kt),sh(Kt,Rt),Kt.return=Gt,Kt;case K:return Rt=xf(Rt,Gt.mode,Kt),Rt.return=Gt,Rt;case tt:var Cn=Rt._init;return Rt=Cn(Rt._payload),$n(Gt,Rt,Kt)}if(zt(Rt)||xt(Rt))return Rt=dc(Rt,Gt.mode,Kt,null),Rt.return=Gt,Rt;if(typeof Rt.then=="function")return $n(Gt,Qc(Rt),Kt);if(Rt.$$typeof===ue)return $n(Gt,wf(Gt,Rt),Kt);Zd(Gt,Rt)}return null}function nn(Gt,Rt,Kt,Cn){var Si=Rt!==null?Rt.key:null;if(typeof Kt=="string"&&Kt!==""||typeof Kt=="number"||typeof Kt=="bigint")return Si!==null?null:He(Gt,Rt,""+Kt,Cn);if(typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case q:return Kt.key===Si?vt(Gt,Rt,Kt,Cn):null;case K:return Kt.key===Si?Qt(Gt,Rt,Kt,Cn):null;case tt:return Si=Kt._init,Kt=Si(Kt._payload),nn(Gt,Rt,Kt,Cn)}if(zt(Kt)||xt(Kt))return Si!==null?null:Mn(Gt,Rt,Kt,Cn,null);if(typeof Kt.then=="function")return nn(Gt,Rt,Qc(Kt),Cn);if(Kt.$$typeof===ue)return nn(Gt,Rt,wf(Gt,Kt),Cn);Zd(Gt,Kt)}return null}function cn(Gt,Rt,Kt,Cn,Si){if(typeof Cn=="string"&&Cn!==""||typeof Cn=="number"||typeof Cn=="bigint")return Gt=Gt.get(Kt)||null,He(Rt,Gt,""+Cn,Si);if(typeof Cn=="object"&&Cn!==null){switch(Cn.$$typeof){case q:return Gt=Gt.get(Cn.key===null?Kt:Cn.key)||null,vt(Rt,Gt,Cn,Si);case K:return Gt=Gt.get(Cn.key===null?Kt:Cn.key)||null,Qt(Rt,Gt,Cn,Si);case tt:var Zr=Cn._init;return Cn=Zr(Cn._payload),cn(Gt,Rt,Kt,Cn,Si)}if(zt(Cn)||xt(Cn))return Gt=Gt.get(Kt)||null,Mn(Rt,Gt,Cn,Si,null);if(typeof Cn.then=="function")return cn(Gt,Rt,Kt,Qc(Cn),Si);if(Cn.$$typeof===ue)return cn(Gt,Rt,Kt,wf(Rt,Cn),Si);Zd(Rt,Cn)}return null}function pr(Gt,Rt,Kt,Cn){for(var Si=null,Zr=null,Vi=Rt,lr=Rt=0,el=null;Vi!==null&&lr<Kt.length;lr++){Vi.index>lr?(el=Vi,Vi=null):el=Vi.sibling;var Ao=nn(Gt,Vi,Kt[lr],Cn);if(Ao===null){Vi===null&&(Vi=el);break}d&&Vi&&Ao.alternate===null&&_(Gt,Vi),Rt=ee(Ao,Rt,lr),Zr===null?Si=Ao:Zr.sibling=Ao,Zr=Ao,Vi=el}if(lr===Kt.length)return A(Gt,Vi),br&&Wt(Gt,lr),Si;if(Vi===null){for(;lr<Kt.length;lr++)Vi=$n(Gt,Kt[lr],Cn),Vi!==null&&(Rt=ee(Vi,Rt,lr),Zr===null?Si=Vi:Zr.sibling=Vi,Zr=Vi);return br&&Wt(Gt,lr),Si}for(Vi=k(Vi);lr<Kt.length;lr++)el=cn(Vi,Gt,lr,Kt[lr],Cn),el!==null&&(d&&el.alternate!==null&&Vi.delete(el.key===null?lr:el.key),Rt=ee(el,Rt,lr),Zr===null?Si=el:Zr.sibling=el,Zr=el);return d&&Vi.forEach(function(af){return _(Gt,af)}),br&&Wt(Gt,lr),Si}function ur(Gt,Rt,Kt,Cn){if(Kt==null)throw Error(s(151));for(var Si=null,Zr=null,Vi=Rt,lr=Rt=0,el=null,Ao=Kt.next();Vi!==null&&!Ao.done;lr++,Ao=Kt.next()){Vi.index>lr?(el=Vi,Vi=null):el=Vi.sibling;var af=nn(Gt,Vi,Ao.value,Cn);if(af===null){Vi===null&&(Vi=el);break}d&&Vi&&af.alternate===null&&_(Gt,Vi),Rt=ee(af,Rt,lr),Zr===null?Si=af:Zr.sibling=af,Zr=af,Vi=el}if(Ao.done)return A(Gt,Vi),br&&Wt(Gt,lr),Si;if(Vi===null){for(;!Ao.done;lr++,Ao=Kt.next())Ao=$n(Gt,Ao.value,Cn),Ao!==null&&(Rt=ee(Ao,Rt,lr),Zr===null?Si=Ao:Zr.sibling=Ao,Zr=Ao);return br&&Wt(Gt,lr),Si}for(Vi=k(Vi);!Ao.done;lr++,Ao=Kt.next())Ao=cn(Vi,Gt,lr,Ao.value,Cn),Ao!==null&&(d&&Ao.alternate!==null&&Vi.delete(Ao.key===null?lr:Ao.key),Rt=ee(Ao,Rt,lr),Zr===null?Si=Ao:Zr.sibling=Ao,Zr=Ao);return d&&Vi.forEach(function(tw){return _(Gt,tw)}),br&&Wt(Gt,lr),Si}function $o(Gt,Rt,Kt,Cn){if(typeof Kt=="object"&&Kt!==null&&Kt.type===J&&Kt.key===null&&(Kt=Kt.props.children),typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case q:e:{for(var Si=Kt.key;Rt!==null;){if(Rt.key===Si){if(Si=Kt.type,Si===J){if(Rt.tag===7){A(Gt,Rt.sibling),Cn=H(Rt,Kt.props.children),Cn.return=Gt,Gt=Cn;break e}}else if(Rt.elementType===Si||typeof Si=="object"&&Si!==null&&Si.$$typeof===tt&&Wd(Si)===Rt.type){A(Gt,Rt.sibling),Cn=H(Rt,Kt.props),sh(Cn,Kt),Cn.return=Gt,Gt=Cn;break e}A(Gt,Rt);break}else _(Gt,Rt);Rt=Rt.sibling}Kt.type===J?(Cn=dc(Kt.props.children,Gt.mode,Cn,Kt.key),Cn.return=Gt,Gt=Cn):(Cn=Vh(Kt.type,Kt.key,Kt.props,null,Gt.mode,Cn),sh(Cn,Kt),Cn.return=Gt,Gt=Cn)}return Ae(Gt);case K:e:{for(Si=Kt.key;Rt!==null;){if(Rt.key===Si)if(Rt.tag===4&&Rt.stateNode.containerInfo===Kt.containerInfo&&Rt.stateNode.implementation===Kt.implementation){A(Gt,Rt.sibling),Cn=H(Rt,Kt.children||[]),Cn.return=Gt,Gt=Cn;break e}else{A(Gt,Rt);break}else _(Gt,Rt);Rt=Rt.sibling}Cn=xf(Kt,Gt.mode,Cn),Cn.return=Gt,Gt=Cn}return Ae(Gt);case tt:return Si=Kt._init,Kt=Si(Kt._payload),$o(Gt,Rt,Kt,Cn)}if(zt(Kt))return pr(Gt,Rt,Kt,Cn);if(xt(Kt)){if(Si=xt(Kt),typeof Si!="function")throw Error(s(150));return Kt=Si.call(Kt),ur(Gt,Rt,Kt,Cn)}if(typeof Kt.then=="function")return $o(Gt,Rt,Qc(Kt),Cn);if(Kt.$$typeof===ue)return $o(Gt,Rt,wf(Gt,Kt),Cn);Zd(Gt,Kt)}return typeof Kt=="string"&&Kt!==""||typeof Kt=="number"||typeof Kt=="bigint"?(Kt=""+Kt,Rt!==null&&Rt.tag===6?(A(Gt,Rt.sibling),Cn=H(Rt,Kt),Cn.return=Gt,Gt=Cn):(A(Gt,Rt),Cn=yp(Kt,Gt.mode,Cn),Cn.return=Gt,Gt=Cn),Ae(Gt)):A(Gt,Rt)}return function(Gt,Rt,Kt,Cn){try{jl=0;var Si=$o(Gt,Rt,Kt,Cn);return Kh=null,Si}catch(Vi){if(Vi===wp||Vi===Tm)throw Vi;var Zr=El(29,Vi,null,Gt.mode);return Zr.lanes=Cn,Zr.return=Gt,Zr}finally{}}}var Ta=Xd(!0),Yd=Xd(!1),Es=Pt(null),yc=null;function eu(d){var _=d.alternate;on(za,za.current&1),on(Es,d),yc===null&&(_===null||Ud.current!==null||_.memoizedState!==null)&&(yc=d)}function zm(d){if(d.tag===22){if(on(za,za.current),on(Es,d),yc===null){var _=d.alternate;_!==null&&_.memoizedState!==null&&(yc=d)}}else vc()}function vc(){on(za,za.current),on(Es,Es.current)}function ra(d){$t(Es),yc===d&&(yc=null),$t(za)}var za=Pt(0);function Bf(d){for(var _=d;_!==null;){if(_.tag===13){var A=_.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||Kp(A)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}function zp(d,_,A,k){_=d.memoizedState,A=A(k,_),A=A==null?_:I({},_,A),d.memoizedState=A,d.lanes===0&&(d.updateQueue.baseState=A)}var Mu={enqueueSetState:function(d,_,A){d=d._reactInternals;var k=fs(),H=Bl(k);H.payload=_,A!=null&&(H.callback=A),_=rh(d,H,k),_!==null&&(ps(_,d,k),mc(_,d,k))},enqueueReplaceState:function(d,_,A){d=d._reactInternals;var k=fs(),H=Bl(k);H.tag=1,H.payload=_,A!=null&&(H.callback=A),_=rh(d,H,k),_!==null&&(ps(_,d,k),mc(_,d,k))},enqueueForceUpdate:function(d,_){d=d._reactInternals;var A=fs(),k=Bl(A);k.tag=2,_!=null&&(k.callback=_),_=rh(d,k,A),_!==null&&(ps(_,d,A),mc(_,d,A))}};function jf(d,_,A,k,H,ee,Ae){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(k,ee,Ae):_.prototype&&_.prototype.isPureReactComponent?!Ga(A,k)||!Ga(H,ee):!0}function km(d,_,A,k){d=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(A,k),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(A,k),_.state!==d&&Mu.enqueueReplaceState(_,_.state,null)}function Ou(d,_){var A=_;if("ref"in _){A={};for(var k in _)k!=="ref"&&(A[k]=_[k])}if(d=d.defaultProps){A===_&&(A=I({},A));for(var H in d)A[H]===void 0&&(A[H]=d[H])}return A}var Iu=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function Nm(d){Iu(d)}function Ff(d){console.error(d)}function Kd(d){Iu(d)}function Jh(d,_){try{var A=d.onUncaughtError;A(_.value,{componentStack:_.stack})}catch(k){setTimeout(function(){throw k})}}function Bm(d,_,A){try{var k=d.onCaughtError;k(A.value,{componentStack:A.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(H){setTimeout(function(){throw H})}}function Uf(d,_,A){return A=Bl(A),A.tag=3,A.payload={element:null},A.callback=function(){Jh(d,_)},A}function t_(d){return d=Bl(d),d.tag=3,d}function kp(d,_,A,k){var H=A.type.getDerivedStateFromError;if(typeof H=="function"){var ee=k.value;d.payload=function(){return H(ee)},d.callback=function(){Bm(_,A,k)}}var Ae=A.stateNode;Ae!==null&&typeof Ae.componentDidCatch=="function"&&(d.callback=function(){Bm(_,A,k),typeof H!="function"&&(Gr===null?Gr=new Set([this]):Gr.add(this));var He=k.stack;this.componentDidCatch(k.value,{componentStack:He!==null?He:""})})}function Py(d,_,A,k,H){if(A.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){if(_=A.alternate,_!==null&&mu(_,A,H,!0),A=Es.current,A!==null){switch(A.tag){case 13:return yc===null?Bu():A.alternate===null&&fi===0&&(fi=3),A.flags&=-257,A.flags|=65536,A.lanes=H,k===Ef?A.flags|=16384:(_=A.updateQueue,_===null?A.updateQueue=new Set([k]):_.add(k),l0(d,k,H)),!1;case 22:return A.flags|=65536,k===Ef?A.flags|=16384:(_=A.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([k])},A.updateQueue=_):(A=_.retryQueue,A===null?_.retryQueue=new Set([k]):A.add(k)),l0(d,k,H)),!1}throw Error(s(435,A.tag))}return l0(d,k,H),Bu(),!1}if(br)return _=Es.current,_!==null?((_.flags&65536)===0&&(_.flags|=256),_.flags|=65536,_.lanes=H,k!==Da&&(d=Error(s(422),{cause:k}),th(fn(d,A)))):(k!==Da&&(_=Error(s(423),{cause:k}),th(fn(_,A))),d=d.current.alternate,d.flags|=65536,H&=-H,d.lanes|=H,k=fn(k,A),H=Uf(d.stateNode,k,H),Pf(d,H),fi!==4&&(fi=2)),!1;var ee=Error(s(520),{cause:k});if(ee=fn(ee,A),Ki===null?Ki=[ee]:Ki.push(ee),fi!==4&&(fi=2),_===null)return!0;k=fn(k,A),A=_;do{switch(A.tag){case 3:return A.flags|=65536,d=H&-H,A.lanes|=d,d=Uf(A.stateNode,k,d),Pf(A,d),!1;case 1:if(_=A.type,ee=A.stateNode,(A.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(Gr===null||!Gr.has(ee))))return A.flags|=65536,H&=-H,A.lanes|=H,H=t_(H),kp(H,d,A,k),Pf(A,H),!1}A=A.return}while(A!==null);return!1}var n_=Error(s(461)),As=!1;function Us(d,_,A,k){_.child=d===null?Yd(_,null,A,k):Ta(_,d.child,A,k)}function jm(d,_,A,k,H){A=A.render;var ee=_.ref;if("ref"in k){var Ae={};for(var He in k)He!=="ref"&&(Ae[He]=k[He])}else Ae=k;return Nl(_),k=Kc(d,_,A,Ae,ee,H),He=Cm(),d!==null&&!As?(Tu(d,_,H),xc(d,_,H)):(br&&He&&Un(_),_.flags|=1,Us(d,_,k,H),_.child)}function i_(d,_,A,k,H){if(d===null){var ee=A.type;return typeof ee=="function"&&!Qu(ee)&&ee.defaultProps===void 0&&A.compare===null?(_.tag=15,_.type=ee,r_(d,_,ee,k,H)):(d=Vh(A.type,null,k,_,_.mode,H),d.ref=_.ref,d.return=_,_.child=d)}if(ee=d.child,!Vo(d,H)){var Ae=ee.memoizedProps;if(A=A.compare,A=A!==null?A:Ga,A(Ae,k)&&d.ref===_.ref)return xc(d,_,H)}return _.flags|=1,d=hc(ee,k),d.ref=_.ref,d.return=_,_.child=d}function r_(d,_,A,k,H){if(d!==null){var ee=d.memoizedProps;if(Ga(ee,k)&&d.ref===_.ref)if(As=!1,_.pendingProps=k=ee,Vo(d,H))(d.flags&131072)!==0&&(As=!0);else return _.lanes=d.lanes,xc(d,_,H)}return Fm(d,_,A,k,H)}function o_(d,_,A){var k=_.pendingProps,H=k.children,ee=d!==null?d.memoizedState:null;if(k.mode==="hidden"){if((_.flags&128)!==0){if(k=ee!==null?ee.baseLanes|A:A,d!==null){for(H=_.child=d.child,ee=0;H!==null;)ee=ee|H.lanes|H.childLanes,H=H.sibling;_.childLanes=ee&~k}else _.childLanes=0,_.child=null;return a_(d,_,k,A)}if((A&536870912)!==0)_.memoizedState={baseLanes:0,cachePool:null},d!==null&&gu(_,ee!==null?ee.cachePool:null),ee!==null?Xl(_,ee):$g(),zm(_);else return _.lanes=_.childLanes=536870912,a_(d,_,ee!==null?ee.baseLanes|A:A,A)}else ee!==null?(gu(_,ee.cachePool),Xl(_,ee),vc(),_.memoizedState=null):(d!==null&&gu(_,null),$g(),vc());return Us(d,_,H,A),_.child}function a_(d,_,A,k){var H=wm();return H=H===null?null:{parent:Oo._currentValue,pool:H},_.memoizedState={baseLanes:A,cachePool:H},d!==null&&gu(_,null),$g(),zm(_),d!==null&&mu(d,_,k,!0),null}function Np(d,_){var A=_.ref;if(A===null)d!==null&&d.ref!==null&&(_.flags|=4194816);else{if(typeof A!="function"&&typeof A!="object")throw Error(s(284));(d===null||d.ref!==A)&&(_.flags|=4194816)}}function Fm(d,_,A,k,H){return Nl(_),A=Kc(d,_,A,k,void 0,H),k=Cm(),d!==null&&!As?(Tu(d,_,H),xc(d,_,H)):(br&&k&&Un(_),_.flags|=1,Us(d,_,A,H),_.child)}function Cy(d,_,A,k,H,ee){return Nl(_),_.updateQueue=null,A=Nn(_,k,A,H),wu(d),k=Cm(),d!==null&&!As?(Tu(d,_,ee),xc(d,_,ee)):(br&&k&&Un(_),_.flags|=1,Us(d,_,A,ee),_.child)}function My(d,_,A,k,H){if(Nl(_),_.stateNode===null){var ee=kl,Ae=A.contextType;typeof Ae=="object"&&Ae!==null&&(ee=js(Ae)),ee=new A(k,ee),_.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,ee.updater=Mu,_.stateNode=ee,ee._reactInternals=_,ee=_.stateNode,ee.props=k,ee.state=_.memoizedState,ee.refs={},Am(_),Ae=A.contextType,ee.context=typeof Ae=="object"&&Ae!==null?js(Ae):kl,ee.state=_.memoizedState,Ae=A.getDerivedStateFromProps,typeof Ae=="function"&&(zp(_,A,Ae,k),ee.state=_.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(Ae=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),Ae!==ee.state&&Mu.enqueueReplaceState(ee,ee.state,null),Fd(_,k,ee,H),jd(),ee.state=_.memoizedState),typeof ee.componentDidMount=="function"&&(_.flags|=4194308),k=!0}else if(d===null){ee=_.stateNode;var He=_.memoizedProps,vt=Ou(A,He);ee.props=vt;var Qt=ee.context,Mn=A.contextType;Ae=kl,typeof Mn=="object"&&Mn!==null&&(Ae=js(Mn));var $n=A.getDerivedStateFromProps;Mn=typeof $n=="function"||typeof ee.getSnapshotBeforeUpdate=="function",He=_.pendingProps!==He,Mn||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(He||Qt!==Ae)&&km(_,ee,k,Ae),_u=!1;var nn=_.memoizedState;ee.state=nn,Fd(_,k,ee,H),jd(),Qt=_.memoizedState,He||nn!==Qt||_u?(typeof $n=="function"&&(zp(_,A,$n,k),Qt=_.memoizedState),(vt=_u||jf(_,A,vt,k,nn,Qt,Ae))?(Mn||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount()),typeof ee.componentDidMount=="function"&&(_.flags|=4194308)):(typeof ee.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=k,_.memoizedState=Qt),ee.props=k,ee.state=Qt,ee.context=Ae,k=vt):(typeof ee.componentDidMount=="function"&&(_.flags|=4194308),k=!1)}else{ee=_.stateNode,yu(d,_),Ae=_.memoizedProps,Mn=Ou(A,Ae),ee.props=Mn,$n=_.pendingProps,nn=ee.context,Qt=A.contextType,vt=kl,typeof Qt=="object"&&Qt!==null&&(vt=js(Qt)),He=A.getDerivedStateFromProps,(Qt=typeof He=="function"||typeof ee.getSnapshotBeforeUpdate=="function")||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(Ae!==$n||nn!==vt)&&km(_,ee,k,vt),_u=!1,nn=_.memoizedState,ee.state=nn,Fd(_,k,ee,H),jd();var cn=_.memoizedState;Ae!==$n||nn!==cn||_u||d!==null&&d.dependencies!==null&&Rd(d.dependencies)?(typeof He=="function"&&(zp(_,A,He,k),cn=_.memoizedState),(Mn=_u||jf(_,A,Mn,k,nn,cn,vt)||d!==null&&d.dependencies!==null&&Rd(d.dependencies))?(Qt||typeof ee.UNSAFE_componentWillUpdate!="function"&&typeof ee.componentWillUpdate!="function"||(typeof ee.componentWillUpdate=="function"&&ee.componentWillUpdate(k,cn,vt),typeof ee.UNSAFE_componentWillUpdate=="function"&&ee.UNSAFE_componentWillUpdate(k,cn,vt)),typeof ee.componentDidUpdate=="function"&&(_.flags|=4),typeof ee.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof ee.componentDidUpdate!="function"||Ae===d.memoizedProps&&nn===d.memoizedState||(_.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||Ae===d.memoizedProps&&nn===d.memoizedState||(_.flags|=1024),_.memoizedProps=k,_.memoizedState=cn),ee.props=k,ee.state=cn,ee.context=vt,k=Mn):(typeof ee.componentDidUpdate!="function"||Ae===d.memoizedProps&&nn===d.memoizedState||(_.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||Ae===d.memoizedProps&&nn===d.memoizedState||(_.flags|=1024),k=!1)}return ee=k,Np(d,_),k=(_.flags&128)!==0,ee||k?(ee=_.stateNode,A=k&&typeof A.getDerivedStateFromError!="function"?null:ee.render(),_.flags|=1,d!==null&&k?(_.child=Ta(_,d.child,null,H),_.child=Ta(_,null,A,H)):Us(d,_,A,H),_.memoizedState=ee.state,d=_.child):d=xc(d,_,H),d}function Bp(d,_,A,k){return fc(),_.flags|=256,Us(d,_,A,k),_.child}var wo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Um(d){return{baseLanes:d,cachePool:Vg()}}function Vf(d,_,A){return d=d!==null?d.childLanes&~A:0,_&&(d|=Gi),d}function Vm(d,_,A){var k=_.pendingProps,H=!1,ee=(_.flags&128)!==0,Ae;if((Ae=ee)||(Ae=d!==null&&d.memoizedState===null?!1:(za.current&2)!==0),Ae&&(H=!0,_.flags&=-129),Ae=(_.flags&32)!==0,_.flags&=-33,d===null){if(br){if(H?eu(_):vc(),br){var He=Ai,vt;if(vt=He){e:{for(vt=He,He=ba;vt.nodeType!==8;){if(!He){He=null;break e}if(vt=ju(vt.nextSibling),vt===null){He=null;break e}}He=vt}He!==null?(_.memoizedState={dehydrated:He,treeContext:ve!==null?{id:Be,overflow:_t}:null,retryLane:536870912,hydrationErrors:null},vt=El(18,null,null,0),vt.stateNode=He,vt.return=_,_.child=vt,Ti=_,Ai=null,vt=!0):vt=!1}vt||Ws(_)}if(He=_.memoizedState,He!==null&&(He=He.dehydrated,He!==null))return Kp(He)?_.lanes=32:_.lanes=536870912,null;ra(_)}return He=k.children,k=k.fallback,H?(vc(),H=_.mode,He=Qh({mode:"hidden",children:He},H),k=dc(k,H,A,null),He.return=_,k.return=_,He.sibling=k,_.child=He,H=_.child,H.memoizedState=Um(A),H.childLanes=Vf(d,Ae,A),_.memoizedState=wo,k):(eu(_),$m(_,He))}if(vt=d.memoizedState,vt!==null&&(He=vt.dehydrated,He!==null)){if(ee)_.flags&256?(eu(_),_.flags&=-257,_=jp(d,_,A)):_.memoizedState!==null?(vc(),_.child=d.child,_.flags|=128,_=null):(vc(),H=k.fallback,He=_.mode,k=Qh({mode:"visible",children:k.children},He),H=dc(H,He,A,null),H.flags|=2,k.return=_,H.return=_,k.sibling=H,_.child=k,Ta(_,d.child,null,A),k=_.child,k.memoizedState=Um(A),k.childLanes=Vf(d,Ae,A),_.memoizedState=wo,_=H);else if(eu(_),Kp(He)){if(Ae=He.nextSibling&&He.nextSibling.dataset,Ae)var Qt=Ae.dgst;Ae=Qt,k=Error(s(419)),k.stack="",k.digest=Ae,th({value:k,source:null,stack:null}),_=jp(d,_,A)}else if(As||mu(d,_,A,!1),Ae=(A&d.childLanes)!==0,As||Ae){if(Ae=Kn,Ae!==null&&(k=A&-A,k=(k&42)!==0?1:vs(k),k=(k&(Ae.suspendedLanes|A))!==0?0:k,k!==0&&k!==vt.retryLane))throw vt.retryLane=k,Gc(d,k),ps(Ae,d,k),n_;He.data==="$?"||Bu(),_=jp(d,_,A)}else He.data==="$?"?(_.flags|=192,_.child=d.child,_=null):(d=vt.treeContext,Ai=ju(He.nextSibling),Ti=_,br=!0,Wo=null,ba=!1,d!==null&&($[ne++]=Be,$[ne++]=_t,$[ne++]=ve,Be=d.id,_t=d.overflow,ve=_),_=$m(_,k.children),_.flags|=4096);return _}return H?(vc(),H=k.fallback,He=_.mode,vt=d.child,Qt=vt.sibling,k=hc(vt,{mode:"hidden",children:k.children}),k.subtreeFlags=vt.subtreeFlags&65011712,Qt!==null?H=hc(Qt,H):(H=dc(H,He,A,null),H.flags|=2),H.return=_,k.return=_,k.sibling=H,_.child=k,k=H,H=_.child,He=d.child.memoizedState,He===null?He=Um(A):(vt=He.cachePool,vt!==null?(Qt=Oo._currentValue,vt=vt.parent!==Qt?{parent:Qt,pool:Qt}:vt):vt=Vg(),He={baseLanes:He.baseLanes|A,cachePool:vt}),H.memoizedState=He,H.childLanes=Vf(d,Ae,A),_.memoizedState=wo,k):(eu(_),A=d.child,d=A.sibling,A=hc(A,{mode:"visible",children:k.children}),A.return=_,A.sibling=null,d!==null&&(Ae=_.deletions,Ae===null?(_.deletions=[d],_.flags|=16):Ae.push(d)),_.child=A,_.memoizedState=null,A)}function $m(d,_){return _=Qh({mode:"visible",children:_},d.mode),_.return=d,d.child=_}function Qh(d,_){return d=El(22,d,null,_),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function jp(d,_,A){return Ta(_,d.child,null,A),d=$m(_,_.pendingProps.children),d.flags|=2,_.memoizedState=null,d}function Fp(d,_,A){d.lanes|=_;var k=d.alternate;k!==null&&(k.lanes|=_),Dd(d.return,_,A)}function Jd(d,_,A,k,H){var ee=d.memoizedState;ee===null?d.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:k,tail:A,tailMode:H}:(ee.isBackwards=_,ee.rendering=null,ee.renderingStartTime=0,ee.last=k,ee.tail=A,ee.tailMode=H)}function Du(d,_,A){var k=_.pendingProps,H=k.revealOrder,ee=k.tail;if(Us(d,_,k.children,A),k=za.current,(k&2)!==0)k=k&1|2,_.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=_.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Fp(d,A,_);else if(d.tag===19)Fp(d,A,_);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===_)break e;for(;d.sibling===null;){if(d.return===null||d.return===_)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}k&=1}switch(on(za,k),H){case"forwards":for(A=_.child,H=null;A!==null;)d=A.alternate,d!==null&&Bf(d)===null&&(H=A),A=A.sibling;A=H,A===null?(H=_.child,_.child=null):(H=A.sibling,A.sibling=null),Jd(_,!1,H,A,ee);break;case"backwards":for(A=null,H=_.child,_.child=null;H!==null;){if(d=H.alternate,d!==null&&Bf(d)===null){_.child=H;break}d=H.sibling,H.sibling=A,A=H,H=d}Jd(_,!0,A,null,ee);break;case"together":Jd(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function xc(d,_,A){if(d!==null&&(_.dependencies=d.dependencies),Pr|=_.lanes,(A&_.childLanes)===0)if(d!==null){if(mu(d,_,A,!1),(A&_.childLanes)===0)return null}else return null;if(d!==null&&_.child!==d.child)throw Error(s(153));if(_.child!==null){for(d=_.child,A=hc(d,d.pendingProps),_.child=A,A.return=_;d.sibling!==null;)d=d.sibling,A=A.sibling=hc(d,d.pendingProps),A.return=_;A.sibling=null}return _.child}function Vo(d,_){return(d.lanes&_)!==0?!0:(d=d.dependencies,!!(d!==null&&Rd(d)))}function Ru(d,_,A){switch(_.tag){case 3:ti(_,_.stateNode.containerInfo),Zc(_,Oo,d.memoizedState.cache),fc();break;case 27:case 5:jn(_);break;case 4:ti(_,_.stateNode.containerInfo);break;case 10:Zc(_,_.type,_.memoizedProps.value);break;case 13:var k=_.memoizedState;if(k!==null)return k.dehydrated!==null?(eu(_),_.flags|=128,null):(A&_.child.childLanes)!==0?Vm(d,_,A):(eu(_),d=xc(d,_,A),d!==null?d.sibling:null);eu(_);break;case 19:var H=(d.flags&128)!==0;if(k=(A&_.childLanes)!==0,k||(mu(d,_,A,!1),k=(A&_.childLanes)!==0),H){if(k)return Du(d,_,A);_.flags|=128}if(H=_.memoizedState,H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),on(za,za.current),k)break;return null;case 22:case 23:return _.lanes=0,o_(d,_,A);case 24:Zc(_,Oo,d.memoizedState.cache)}return xc(d,_,A)}function $f(d,_,A){if(d!==null)if(d.memoizedProps!==_.pendingProps)As=!0;else{if(!Vo(d,A)&&(_.flags&128)===0)return As=!1,Ru(d,_,A);As=(d.flags&131072)!==0}else As=!1,br&&(_.flags&1048576)!==0&&ln(_,z,_.index);switch(_.lanes=0,_.tag){case 16:e:{d=_.pendingProps;var k=_.elementType,H=k._init;if(k=H(k._payload),_.type=k,typeof k=="function")Qu(k)?(d=Ou(k,d),_.tag=1,_=My(null,_,k,d,A)):(_.tag=0,_=Fm(null,_,k,d,A));else{if(k!=null){if(H=k.$$typeof,H===Pe){_.tag=11,_=jm(null,_,k,d,A);break e}else if(H===Qe){_.tag=14,_=i_(null,_,k,d,A);break e}}throw _=ot(k)||k,Error(s(306,_,""))}}return _;case 0:return Fm(d,_,_.type,_.pendingProps,A);case 1:return k=_.type,H=Ou(k,_.pendingProps),My(d,_,k,H,A);case 3:e:{if(ti(_,_.stateNode.containerInfo),d===null)throw Error(s(387));k=_.pendingProps;var ee=_.memoizedState;H=ee.element,yu(d,_),Fd(_,k,null,A);var Ae=_.memoizedState;if(k=Ae.cache,Zc(_,Oo,k),k!==ee.cache&&qh(_,[Oo],A,!0),jd(),k=Ae.element,ee.isDehydrated)if(ee={element:k,isDehydrated:!1,cache:Ae.cache},_.updateQueue.baseState=ee,_.memoizedState=ee,_.flags&256){_=Bp(d,_,k,A);break e}else if(k!==H){H=fn(Error(s(424)),_),th(H),_=Bp(d,_,k,A);break e}else{switch(d=_.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(Ai=ju(d.firstChild),Ti=_,br=!0,Wo=null,ba=!0,A=Yd(_,null,k,A),_.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling}else{if(fc(),k===H){_=xc(d,_,A);break e}Us(d,_,k,A)}_=_.child}return _;case 26:return Np(d,_),d===null?(A=Hy(_.type,null,_.pendingProps,null))?_.memoizedState=A:br||(A=_.type,d=_.pendingProps,k=Ny(kt.current).createElement(A),k[ae]=_,k[ge]=d,fl(k,A,d),_n(k),_.stateNode=k):_.memoizedState=Hy(_.type,d.memoizedProps,_.pendingProps,d.memoizedState),null;case 27:return jn(_),d===null&&br&&(k=_.stateNode=m_(_.type,_.pendingProps,kt.current),Ti=_,ba=!0,H=Ai,Yo(_.type)?(Jp=H,Ai=ju(k.firstChild)):Ai=H),Us(d,_,_.pendingProps.children,A),Np(d,_),d===null&&(_.flags|=4194304),_.child;case 5:return d===null&&br&&((H=k=Ai)&&(k=Fy(k,_.type,_.pendingProps,ba),k!==null?(_.stateNode=k,Ti=_,Ai=ju(k.firstChild),ba=!1,H=!0):H=!1),H||Ws(_)),jn(_),H=_.type,ee=_.pendingProps,Ae=d!==null?d.memoizedProps:null,k=ee.children,_0(H,ee)?k=null:Ae!==null&&_0(H,Ae)&&(_.flags|=32),_.memoizedState!==null&&(H=Kc(d,_,wy,null,null,A),ig._currentValue=H),Np(d,_),Us(d,_,k,A),_.child;case 6:return d===null&&br&&((d=A=Ai)&&(A=Uy(A,_.pendingProps,ba),A!==null?(_.stateNode=A,Ti=_,Ai=null,d=!0):d=!1),d||Ws(_)),null;case 13:return Vm(d,_,A);case 4:return ti(_,_.stateNode.containerInfo),k=_.pendingProps,d===null?_.child=Ta(_,null,k,A):Us(d,_,k,A),_.child;case 11:return jm(d,_,_.type,_.pendingProps,A);case 7:return Us(d,_,_.pendingProps,A),_.child;case 8:return Us(d,_,_.pendingProps.children,A),_.child;case 12:return Us(d,_,_.pendingProps.children,A),_.child;case 10:return k=_.pendingProps,Zc(_,_.type,k.value),Us(d,_,k.children,A),_.child;case 9:return H=_.type._context,k=_.pendingProps.children,Nl(_),H=js(H),k=k(H),_.flags|=1,Us(d,_,k,A),_.child;case 14:return i_(d,_,_.type,_.pendingProps,A);case 15:return r_(d,_,_.type,_.pendingProps,A);case 19:return Du(d,_,A);case 31:return k=_.pendingProps,A=_.mode,k={mode:k.mode,children:k.children},d===null?(A=Qh(k,A),A.ref=_.ref,_.child=A,A.return=_,_=A):(A=hc(d.child,k),A.ref=_.ref,_.child=A,A.return=_,_=A),_;case 22:return o_(d,_,A);case 24:return Nl(_),k=js(Oo),d===null?(H=wm(),H===null&&(H=Kn,ee=Tf(),H.pooledCache=ee,ee.refCount++,ee!==null&&(H.pooledCacheLanes|=A),H=ee),_.memoizedState={parent:k,cache:H},Am(_),Zc(_,Oo,H)):((d.lanes&A)!==0&&(yu(d,_),Fd(_,null,null,A),jd()),H=d.memoizedState,ee=_.memoizedState,H.parent!==k?(H={parent:k,cache:k},_.memoizedState=H,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=H),Zc(_,Oo,k)):(k=ee.cache,Zc(_,Oo,k),k!==H.cache&&qh(_,[Oo],A,!0))),Us(d,_,_.pendingProps.children,A),_.child;case 29:throw _.pendingProps}throw Error(s(156,_.tag))}function bc(d){d.flags|=4}function s_(d,_){if(_.type!=="stylesheet"||(_.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!Zb(_)){if(_=Es.current,_!==null&&((_i&4194048)===_i?yc!==null:(_i&62914560)!==_i&&(_i&536870912)===0||_!==yc))throw Af=Ef,xy;d.flags|=8192}}function qm(d,_){_!==null&&(d.flags|=4),d.flags&16384&&(_=d.tag!==22?Is():536870912,d.lanes|=_,eo|=_)}function Lu(d,_){if(!br)switch(d.tailMode){case"hidden":_=d.tail;for(var A=null;_!==null;)_.alternate!==null&&(A=_),_=_.sibling;A===null?d.tail=null:A.sibling=null;break;case"collapsed":A=d.tail;for(var k=null;A!==null;)A.alternate!==null&&(k=A),A=A.sibling;k===null?_||d.tail===null?d.tail=null:d.tail.sibling=null:k.sibling=null}}function ga(d){var _=d.alternate!==null&&d.alternate.child===d.child,A=0,k=0;if(_)for(var H=d.child;H!==null;)A|=H.lanes|H.childLanes,k|=H.subtreeFlags&65011712,k|=H.flags&65011712,H.return=d,H=H.sibling;else for(H=d.child;H!==null;)A|=H.lanes|H.childLanes,k|=H.subtreeFlags,k|=H.flags,H.return=d,H=H.sibling;return d.subtreeFlags|=k,d.childLanes=A,_}function zu(d,_,A){var k=_.pendingProps;switch(yi(_),_.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ga(_),null;case 1:return ga(_),null;case 3:return A=_.stateNode,k=null,d!==null&&(k=d.memoizedState.cache),_.memoizedState.cache!==k&&(_.flags|=2048),Wc(Oo),Dt(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(d===null||d.child===null)&&(pu(_)?bc(_):d===null||d.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,vp())),ga(_),null;case 26:return A=_.memoizedState,d===null?(bc(_),A!==null?(ga(_),s_(_,A)):(ga(_),_.flags&=-16777217)):A?A!==d.memoizedState?(bc(_),ga(_),s_(_,A)):(ga(_),_.flags&=-16777217):(d.memoizedProps!==k&&bc(_),ga(_),_.flags&=-16777217),null;case 27:ai(_),A=kt.current;var H=_.type;if(d!==null&&_.stateNode!=null)d.memoizedProps!==k&&bc(_);else{if(!k){if(_.stateNode===null)throw Error(s(166));return ga(_),null}d=An.current,pu(_)?Id(_):(d=m_(H,k,A),_.stateNode=d,bc(_))}return ga(_),null;case 5:if(ai(_),A=_.type,d!==null&&_.stateNode!=null)d.memoizedProps!==k&&bc(_);else{if(!k){if(_.stateNode===null)throw Error(s(166));return ga(_),null}if(d=An.current,pu(_))Id(_);else{switch(H=Ny(kt.current),d){case 1:d=H.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:d=H.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":d=H.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":d=H.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":d=H.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof k.is=="string"?H.createElement("select",{is:k.is}):H.createElement("select"),k.multiple?d.multiple=!0:k.size&&(d.size=k.size);break;default:d=typeof k.is=="string"?H.createElement(A,{is:k.is}):H.createElement(A)}}d[ae]=_,d[ge]=k;e:for(H=_.child;H!==null;){if(H.tag===5||H.tag===6)d.appendChild(H.stateNode);else if(H.tag!==4&&H.tag!==27&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===_)break e;for(;H.sibling===null;){if(H.return===null||H.return===_)break e;H=H.return}H.sibling.return=H.return,H=H.sibling}_.stateNode=d;e:switch(fl(d,A,k),A){case"button":case"input":case"select":case"textarea":d=!!k.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&bc(_)}}return ga(_),_.flags&=-16777217,null;case 6:if(d&&_.stateNode!=null)d.memoizedProps!==k&&bc(_);else{if(typeof k!="string"&&_.stateNode===null)throw Error(s(166));if(d=kt.current,pu(_)){if(d=_.stateNode,A=_.memoizedProps,k=null,H=Ti,H!==null)switch(H.tag){case 27:case 5:k=H.memoizedProps}d[ae]=_,d=!!(d.nodeValue===A||k!==null&&k.suppressHydrationWarning===!0||Nb(d.nodeValue,A)),d||Ws(_)}else d=Ny(d).createTextNode(k),d[ae]=_,_.stateNode=d}return ga(_),null;case 13:if(k=_.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(H=pu(_),k!==null&&k.dehydrated!==null){if(d===null){if(!H)throw Error(s(318));if(H=_.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(s(317));H[ae]=_}else fc(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;ga(_),H=!1}else H=vp(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=H),H=!0;if(!H)return _.flags&256?(ra(_),_):(ra(_),null)}if(ra(_),(_.flags&128)!==0)return _.lanes=A,_;if(A=k!==null,d=d!==null&&d.memoizedState!==null,A){k=_.child,H=null,k.alternate!==null&&k.alternate.memoizedState!==null&&k.alternate.memoizedState.cachePool!==null&&(H=k.alternate.memoizedState.cachePool.pool);var ee=null;k.memoizedState!==null&&k.memoizedState.cachePool!==null&&(ee=k.memoizedState.cachePool.pool),ee!==H&&(k.flags|=2048)}return A!==d&&A&&(_.child.flags|=8192),qm(_,_.updateQueue),ga(_),null;case 4:return Dt(),d===null&&Ly(_.stateNode.containerInfo),ga(_),null;case 10:return Wc(_.type),ga(_),null;case 19:if($t(za),H=_.memoizedState,H===null)return ga(_),null;if(k=(_.flags&128)!==0,ee=H.rendering,ee===null)if(k)Lu(H,!1);else{if(fi!==0||d!==null&&(d.flags&128)!==0)for(d=_.child;d!==null;){if(ee=Bf(d),ee!==null){for(_.flags|=128,Lu(H,!1),d=ee.updateQueue,_.updateQueue=d,qm(_,d),_.subtreeFlags=0,d=A,A=_.child;A!==null;)Jr(A,d),A=A.sibling;return on(za,za.current&1|2),_.child}d=d.sibling}H.tail!==null&&kr()>Fr&&(_.flags|=128,k=!0,Lu(H,!1),_.lanes=4194304)}else{if(!k)if(d=Bf(ee),d!==null){if(_.flags|=128,k=!0,d=d.updateQueue,_.updateQueue=d,qm(_,d),Lu(H,!0),H.tail===null&&H.tailMode==="hidden"&&!ee.alternate&&!br)return ga(_),null}else 2*kr()-H.renderingStartTime>Fr&&A!==536870912&&(_.flags|=128,k=!0,Lu(H,!1),_.lanes=4194304);H.isBackwards?(ee.sibling=_.child,_.child=ee):(d=H.last,d!==null?d.sibling=ee:_.child=ee,H.last=ee)}return H.tail!==null?(_=H.tail,H.rendering=_,H.tail=_.sibling,H.renderingStartTime=kr(),_.sibling=null,d=za.current,on(za,k?d&1|2:d&1),_):(ga(_),null);case 22:case 23:return ra(_),qg(),k=_.memoizedState!==null,d!==null?d.memoizedState!==null!==k&&(_.flags|=8192):k&&(_.flags|=8192),k?(A&536870912)!==0&&(_.flags&128)===0&&(ga(_),_.subtreeFlags&6&&(_.flags|=8192)):ga(_),A=_.updateQueue,A!==null&&qm(_,A.retryQueue),A=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(A=d.memoizedState.cachePool.pool),k=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(k=_.memoizedState.cachePool.pool),k!==A&&(_.flags|=2048),d!==null&&$t(Zh),null;case 24:return A=null,d!==null&&(A=d.memoizedState.cache),_.memoizedState.cache!==A&&(_.flags|=2048),Wc(Oo),ga(_),null;case 25:return null;case 30:return null}throw Error(s(156,_.tag))}function Up(d,_){switch(yi(_),_.tag){case 1:return d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 3:return Wc(Oo),Dt(),d=_.flags,(d&65536)!==0&&(d&128)===0?(_.flags=d&-65537|128,_):null;case 26:case 27:case 5:return ai(_),null;case 13:if(ra(_),d=_.memoizedState,d!==null&&d.dehydrated!==null){if(_.alternate===null)throw Error(s(340));fc()}return d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 19:return $t(za),null;case 4:return Dt(),null;case 10:return Wc(_.type),null;case 22:case 23:return ra(_),qg(),d!==null&&$t(Zh),d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 24:return Wc(Oo),null;case 25:return null;default:return null}}function Hm(d,_){switch(yi(_),_.tag){case 3:Wc(Oo),Dt();break;case 26:case 27:case 5:ai(_);break;case 4:Dt();break;case 13:ra(_);break;case 19:$t(za);break;case 10:Wc(_.type);break;case 22:case 23:ra(_),qg(),d!==null&&$t(Zh);break;case 24:Wc(Oo)}}function lh(d,_){try{var A=_.updateQueue,k=A!==null?A.lastEffect:null;if(k!==null){var H=k.next;A=H;do{if((A.tag&d)===d){k=void 0;var ee=A.create,Ae=A.inst;k=ee(),Ae.destroy=k}A=A.next}while(A!==H)}}catch(He){Xo(_,_.return,He)}}function Yl(d,_,A){try{var k=_.updateQueue,H=k!==null?k.lastEffect:null;if(H!==null){var ee=H.next;k=ee;do{if((k.tag&d)===d){var Ae=k.inst,He=Ae.destroy;if(He!==void 0){Ae.destroy=void 0,H=_;var vt=A,Qt=He;try{Qt()}catch(Mn){Xo(H,vt,Mn)}}}k=k.next}while(k!==ee)}}catch(Mn){Xo(_,_.return,Mn)}}function ku(d){var _=d.updateQueue;if(_!==null){var A=d.stateNode;try{Mf(_,A)}catch(k){Xo(d,d.return,k)}}}function wc(d,_,A){A.props=Ou(d.type,d.memoizedProps),A.state=d.memoizedState;try{A.componentWillUnmount()}catch(k){Xo(d,_,k)}}function hl(d,_){try{var A=d.ref;if(A!==null){switch(d.tag){case 26:case 27:case 5:var k=d.stateNode;break;case 30:k=d.stateNode;break;default:k=d.stateNode}typeof A=="function"?d.refCleanup=A(k):A.current=k}}catch(H){Xo(d,_,H)}}function Cl(d,_){var A=d.ref,k=d.refCleanup;if(A!==null)if(typeof k=="function")try{k()}catch(H){Xo(d,_,H)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof A=="function")try{A(null)}catch(H){Xo(d,_,H)}else A.current=null}function m(d){var _=d.type,A=d.memoizedProps,k=d.stateNode;try{e:switch(_){case"button":case"input":case"select":case"textarea":A.autoFocus&&k.focus();break e;case"img":A.src?k.src=A.src:A.srcSet&&(k.srcset=A.srcSet)}}catch(H){Xo(d,d.return,H)}}function r(d,_,A){try{var k=d.stateNode;Wp(k,d.type,A,_),k[ge]=_}catch(H){Xo(d,d.return,H)}}function u(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Yo(d.type)||d.tag===4}function g(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||u(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Yo(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function w(d,_,A){var k=d.tag;if(k===5||k===6)d=d.stateNode,_?(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A).insertBefore(d,_):(_=A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,_.appendChild(d),A=A._reactRootContainer,A!=null||_.onclick!==null||(_.onclick=ky));else if(k!==4&&(k===27&&Yo(d.type)&&(A=d.stateNode,_=null),d=d.child,d!==null))for(w(d,_,A),d=d.sibling;d!==null;)w(d,_,A),d=d.sibling}function S(d,_,A){var k=d.tag;if(k===5||k===6)d=d.stateNode,_?A.insertBefore(d,_):A.appendChild(d);else if(k!==4&&(k===27&&Yo(d.type)&&(A=d.stateNode),d=d.child,d!==null))for(S(d,_,A),d=d.sibling;d!==null;)S(d,_,A),d=d.sibling}function P(d){var _=d.stateNode,A=d.memoizedProps;try{for(var k=d.type,H=_.attributes;H.length;)_.removeAttributeNode(H[0]);fl(_,k,A),_[ae]=d,_[ge]=A}catch(ee){Xo(d,d.return,ee)}}var R=!1,N=!1,V=!1,G=typeof WeakSet=="function"?WeakSet:Set,X=null;function W(d,_){if(d=d.containerInfo,Xp=Yy,d=Nh(d),hu(d)){if("selectionStart"in d)var A={start:d.selectionStart,end:d.selectionEnd};else e:{A=(A=d.ownerDocument)&&A.defaultView||window;var k=A.getSelection&&A.getSelection();if(k&&k.rangeCount!==0){A=k.anchorNode;var H=k.anchorOffset,ee=k.focusNode;k=k.focusOffset;try{A.nodeType,ee.nodeType}catch{A=null;break e}var Ae=0,He=-1,vt=-1,Qt=0,Mn=0,$n=d,nn=null;t:for(;;){for(var cn;$n!==A||H!==0&&$n.nodeType!==3||(He=Ae+H),$n!==ee||k!==0&&$n.nodeType!==3||(vt=Ae+k),$n.nodeType===3&&(Ae+=$n.nodeValue.length),(cn=$n.firstChild)!==null;)nn=$n,$n=cn;for(;;){if($n===d)break t;if(nn===A&&++Qt===H&&(He=Ae),nn===ee&&++Mn===k&&(vt=Ae),(cn=$n.nextSibling)!==null)break;$n=nn,nn=$n.parentNode}$n=cn}A=He===-1||vt===-1?null:{start:He,end:vt}}else A=null}A=A||{start:0,end:0}}else A=null;for(g0={focusedElem:d,selectionRange:A},Yy=!1,X=_;X!==null;)if(_=X,d=_.child,(_.subtreeFlags&1024)!==0&&d!==null)d.return=_,X=d;else for(;X!==null;){switch(_=X,ee=_.alternate,d=_.flags,_.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&ee!==null){d=void 0,A=_,H=ee.memoizedProps,ee=ee.memoizedState,k=A.stateNode;try{var pr=Ou(A.type,H,A.elementType===A.type);d=k.getSnapshotBeforeUpdate(pr,ee),k.__reactInternalSnapshotBeforeUpdate=d}catch(ur){Xo(A,A.return,ur)}}break;case 3:if((d&1024)!==0){if(d=_.stateNode.containerInfo,A=d.nodeType,A===9)jy(d);else if(A===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":jy(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(s(163))}if(d=_.sibling,d!==null){d.return=_.return,X=d;break}X=_.return}}function Q(d,_,A){var k=A.flags;switch(A.tag){case 0:case 11:case 15:pt(d,A),k&4&&lh(5,A);break;case 1:if(pt(d,A),k&4)if(d=A.stateNode,_===null)try{d.componentDidMount()}catch(Ae){Xo(A,A.return,Ae)}else{var H=Ou(A.type,_.memoizedProps);_=_.memoizedState;try{d.componentDidUpdate(H,_,d.__reactInternalSnapshotBeforeUpdate)}catch(Ae){Xo(A,A.return,Ae)}}k&64&&ku(A),k&512&&hl(A,A.return);break;case 3:if(pt(d,A),k&64&&(d=A.updateQueue,d!==null)){if(_=null,A.child!==null)switch(A.child.tag){case 27:case 5:_=A.child.stateNode;break;case 1:_=A.child.stateNode}try{Mf(d,_)}catch(Ae){Xo(A,A.return,Ae)}}break;case 27:_===null&&k&4&&P(A);case 26:case 5:pt(d,A),_===null&&k&4&&m(A),k&512&&hl(A,A.return);break;case 12:pt(d,A);break;case 13:pt(d,A),k&4&&De(d,A),k&64&&(d=A.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(A=c0.bind(null,A),Fb(d,A))));break;case 22:if(k=A.memoizedState!==null||R,!k){_=_!==null&&_.memoizedState!==null||N,H=R;var ee=N;R=k,(N=_)&&!ee?It(d,A,(A.subtreeFlags&8772)!==0):pt(d,A),R=H,N=ee}break;case 30:break;default:pt(d,A)}}function fe(d){var _=d.alternate;_!==null&&(d.alternate=null,fe(_)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(_=d.stateNode,_!==null&&lt(_)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var se=null,pe=!1;function ye(d,_,A){for(A=A.child;A!==null;)we(d,_,A),A=A.sibling}function we(d,_,A){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(Ho,A)}catch{}switch(A.tag){case 26:N||Cl(A,_),ye(d,_,A),A.memoizedState?A.memoizedState.count--:A.stateNode&&(A=A.stateNode,A.parentNode.removeChild(A));break;case 27:N||Cl(A,_);var k=se,H=pe;Yo(A.type)&&(se=A.stateNode,pe=!1),ye(d,_,A),g_(A.stateNode),se=k,pe=H;break;case 5:N||Cl(A,_);case 6:if(k=se,H=pe,se=null,ye(d,_,A),se=k,pe=H,se!==null)if(pe)try{(se.nodeType===9?se.body:se.nodeName==="HTML"?se.ownerDocument.body:se).removeChild(A.stateNode)}catch(ee){Xo(A,_,ee)}else try{se.removeChild(A.stateNode)}catch(ee){Xo(A,_,ee)}break;case 18:se!==null&&(pe?(d=se,Yp(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,A.stateNode),S_(d)):Yp(se,A.stateNode));break;case 4:k=se,H=pe,se=A.stateNode.containerInfo,pe=!0,ye(d,_,A),se=k,pe=H;break;case 0:case 11:case 14:case 15:N||Yl(2,A,_),N||Yl(4,A,_),ye(d,_,A);break;case 1:N||(Cl(A,_),k=A.stateNode,typeof k.componentWillUnmount=="function"&&wc(A,_,k)),ye(d,_,A);break;case 21:ye(d,_,A);break;case 22:N=(k=N)||A.memoizedState!==null,ye(d,_,A),N=k;break;default:ye(d,_,A)}}function De(d,_){if(_.memoizedState===null&&(d=_.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{S_(d)}catch(A){Xo(_,_.return,A)}}function Le(d){switch(d.tag){case 13:case 19:var _=d.stateNode;return _===null&&(_=d.stateNode=new G),_;case 22:return d=d.stateNode,_=d._retryCache,_===null&&(_=d._retryCache=new G),_;default:throw Error(s(435,d.tag))}}function Ze(d,_){var A=Le(d);_.forEach(function(k){var H=nd.bind(null,d,k);A.has(k)||(A.add(k),k.then(H,H))})}function Ue(d,_){var A=_.deletions;if(A!==null)for(var k=0;k<A.length;k++){var H=A[k],ee=d,Ae=_,He=Ae;e:for(;He!==null;){switch(He.tag){case 27:if(Yo(He.type)){se=He.stateNode,pe=!1;break e}break;case 5:se=He.stateNode,pe=!1;break e;case 3:case 4:se=He.stateNode.containerInfo,pe=!0;break e}He=He.return}if(se===null)throw Error(s(160));we(ee,Ae,H),se=null,pe=!1,ee=H.alternate,ee!==null&&(ee.return=null),H.return=null}if(_.subtreeFlags&13878)for(_=_.child;_!==null;)ke(_,d),_=_.sibling}var Fe=null;function ke(d,_){var A=d.alternate,k=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Ue(_,d),qe(d),k&4&&(Yl(3,d,d.return),lh(3,d),Yl(5,d,d.return));break;case 1:Ue(_,d),qe(d),k&512&&(N||A===null||Cl(A,A.return)),k&64&&R&&(d=d.updateQueue,d!==null&&(k=d.callbacks,k!==null&&(A=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=A===null?k:A.concat(k))));break;case 26:var H=Fe;if(Ue(_,d),qe(d),k&512&&(N||A===null||Cl(A,A.return)),k&4){var ee=A!==null?A.memoizedState:null;if(k=d.memoizedState,A===null)if(k===null)if(d.stateNode===null){e:{k=d.type,A=d.memoizedProps,H=H.ownerDocument||H;t:switch(k){case"title":ee=H.getElementsByTagName("title")[0],(!ee||ee[Xe]||ee[ae]||ee.namespaceURI==="http://www.w3.org/2000/svg"||ee.hasAttribute("itemprop"))&&(ee=H.createElement(k),H.head.insertBefore(ee,H.querySelector("head > title"))),fl(ee,k,A),ee[ae]=d,_n(ee),k=ee;break e;case"link":var Ae=Hb("link","href",H).get(k+(A.href||""));if(Ae){for(var He=0;He<Ae.length;He++)if(ee=Ae[He],ee.getAttribute("href")===(A.href==null||A.href===""?null:A.href)&&ee.getAttribute("rel")===(A.rel==null?null:A.rel)&&ee.getAttribute("title")===(A.title==null?null:A.title)&&ee.getAttribute("crossorigin")===(A.crossOrigin==null?null:A.crossOrigin)){Ae.splice(He,1);break t}}ee=H.createElement(k),fl(ee,k,A),H.head.appendChild(ee);break;case"meta":if(Ae=Hb("meta","content",H).get(k+(A.content||""))){for(He=0;He<Ae.length;He++)if(ee=Ae[He],ee.getAttribute("content")===(A.content==null?null:""+A.content)&&ee.getAttribute("name")===(A.name==null?null:A.name)&&ee.getAttribute("property")===(A.property==null?null:A.property)&&ee.getAttribute("http-equiv")===(A.httpEquiv==null?null:A.httpEquiv)&&ee.getAttribute("charset")===(A.charSet==null?null:A.charSet)){Ae.splice(He,1);break t}}ee=H.createElement(k),fl(ee,k,A),H.head.appendChild(ee);break;default:throw Error(s(468,k))}ee[ae]=d,_n(ee),k=ee}d.stateNode=k}else Gb(H,d.type,d.stateNode);else d.stateNode=hh(H,k,d.memoizedProps);else ee!==k?(ee===null?A.stateNode!==null&&(A=A.stateNode,A.parentNode.removeChild(A)):ee.count--,k===null?Gb(H,d.type,d.stateNode):hh(H,k,d.memoizedProps)):k===null&&d.stateNode!==null&&r(d,d.memoizedProps,A.memoizedProps)}break;case 27:Ue(_,d),qe(d),k&512&&(N||A===null||Cl(A,A.return)),A!==null&&k&4&&r(d,d.memoizedProps,A.memoizedProps);break;case 5:if(Ue(_,d),qe(d),k&512&&(N||A===null||Cl(A,A.return)),d.flags&32){H=d.stateNode;try{da(H,"")}catch(cn){Xo(d,d.return,cn)}}k&4&&d.stateNode!=null&&(H=d.memoizedProps,r(d,H,A!==null?A.memoizedProps:H)),k&1024&&(V=!0);break;case 6:if(Ue(_,d),qe(d),k&4){if(d.stateNode===null)throw Error(s(162));k=d.memoizedProps,A=d.stateNode;try{A.nodeValue=k}catch(cn){Xo(d,d.return,cn)}}break;case 3:if(Gy=null,H=Fe,Fe=Qm(_.containerInfo),Ue(_,d),Fe=H,qe(d),k&4&&A!==null&&A.memoizedState.isDehydrated)try{S_(_.containerInfo)}catch(cn){Xo(d,d.return,cn)}V&&(V=!1,Ke(d));break;case 4:k=Fe,Fe=Qm(d.stateNode.containerInfo),Ue(_,d),qe(d),Fe=k;break;case 12:Ue(_,d),qe(d);break;case 13:Ue(_,d),qe(d),d.child.flags&8192&&d.memoizedState!==null!=(A!==null&&A.memoizedState!==null)&&(Lr=kr()),k&4&&(k=d.updateQueue,k!==null&&(d.updateQueue=null,Ze(d,k)));break;case 22:H=d.memoizedState!==null;var vt=A!==null&&A.memoizedState!==null,Qt=R,Mn=N;if(R=Qt||H,N=Mn||vt,Ue(_,d),N=Mn,R=Qt,qe(d),k&8192)e:for(_=d.stateNode,_._visibility=H?_._visibility&-2:_._visibility|1,H&&(A===null||vt||R||N||mt(d)),A=null,_=d;;){if(_.tag===5||_.tag===26){if(A===null){vt=A=_;try{if(ee=vt.stateNode,H)Ae=ee.style,typeof Ae.setProperty=="function"?Ae.setProperty("display","none","important"):Ae.display="none";else{He=vt.stateNode;var $n=vt.memoizedProps.style,nn=$n!=null&&$n.hasOwnProperty("display")?$n.display:null;He.style.display=nn==null||typeof nn=="boolean"?"":(""+nn).trim()}}catch(cn){Xo(vt,vt.return,cn)}}}else if(_.tag===6){if(A===null){vt=_;try{vt.stateNode.nodeValue=H?"":vt.memoizedProps}catch(cn){Xo(vt,vt.return,cn)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===d)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break e;for(;_.sibling===null;){if(_.return===null||_.return===d)break e;A===_&&(A=null),_=_.return}A===_&&(A=null),_.sibling.return=_.return,_=_.sibling}k&4&&(k=d.updateQueue,k!==null&&(A=k.retryQueue,A!==null&&(k.retryQueue=null,Ze(d,A))));break;case 19:Ue(_,d),qe(d),k&4&&(k=d.updateQueue,k!==null&&(d.updateQueue=null,Ze(d,k)));break;case 30:break;case 21:break;default:Ue(_,d),qe(d)}}function qe(d){var _=d.flags;if(_&2){try{for(var A,k=d.return;k!==null;){if(u(k)){A=k;break}k=k.return}if(A==null)throw Error(s(160));switch(A.tag){case 27:var H=A.stateNode,ee=g(d);S(d,ee,H);break;case 5:var Ae=A.stateNode;A.flags&32&&(da(Ae,""),A.flags&=-33);var He=g(d);S(d,He,Ae);break;case 3:case 4:var vt=A.stateNode.containerInfo,Qt=g(d);w(d,Qt,vt);break;default:throw Error(s(161))}}catch(Mn){Xo(d,d.return,Mn)}d.flags&=-3}_&4096&&(d.flags&=-4097)}function Ke(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var _=d;Ke(_),_.tag===5&&_.flags&1024&&_.stateNode.reset(),d=d.sibling}}function pt(d,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)Q(d,_.alternate,_),_=_.sibling}function mt(d){for(d=d.child;d!==null;){var _=d;switch(_.tag){case 0:case 11:case 14:case 15:Yl(4,_,_.return),mt(_);break;case 1:Cl(_,_.return);var A=_.stateNode;typeof A.componentWillUnmount=="function"&&wc(_,_.return,A),mt(_);break;case 27:g_(_.stateNode);case 26:case 5:Cl(_,_.return),mt(_);break;case 22:_.memoizedState===null&&mt(_);break;case 30:mt(_);break;default:mt(_)}d=d.sibling}}function It(d,_,A){for(A=A&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var k=_.alternate,H=d,ee=_,Ae=ee.flags;switch(ee.tag){case 0:case 11:case 15:It(H,ee,A),lh(4,ee);break;case 1:if(It(H,ee,A),k=ee,H=k.stateNode,typeof H.componentDidMount=="function")try{H.componentDidMount()}catch(Qt){Xo(k,k.return,Qt)}if(k=ee,H=k.updateQueue,H!==null){var He=k.stateNode;try{var vt=H.shared.hiddenCallbacks;if(vt!==null)for(H.shared.hiddenCallbacks=null,H=0;H<vt.length;H++)Cf(vt[H],He)}catch(Qt){Xo(k,k.return,Qt)}}A&&Ae&64&&ku(ee),hl(ee,ee.return);break;case 27:P(ee);case 26:case 5:It(H,ee,A),A&&k===null&&Ae&4&&m(ee),hl(ee,ee.return);break;case 12:It(H,ee,A);break;case 13:It(H,ee,A),A&&Ae&4&&De(H,ee);break;case 22:ee.memoizedState===null&&It(H,ee,A),hl(ee,ee.return);break;case 30:break;default:It(H,ee,A)}_=_.sibling}}function Nt(d,_){var A=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(A=d.memoizedState.cachePool.pool),d=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(d=_.memoizedState.cachePool.pool),d!==A&&(d!=null&&d.refCount++,A!=null&&nh(A))}function Xt(d,_){d=null,_.alternate!==null&&(d=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==d&&(_.refCount++,d!=null&&nh(d))}function ut(d,_,A,k){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)Et(d,_,A,k),_=_.sibling}function Et(d,_,A,k){var H=_.flags;switch(_.tag){case 0:case 11:case 15:ut(d,_,A,k),H&2048&&lh(9,_);break;case 1:ut(d,_,A,k);break;case 3:ut(d,_,A,k),H&2048&&(d=null,_.alternate!==null&&(d=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==d&&(_.refCount++,d!=null&&nh(d)));break;case 12:if(H&2048){ut(d,_,A,k),d=_.stateNode;try{var ee=_.memoizedProps,Ae=ee.id,He=ee.onPostCommit;typeof He=="function"&&He(Ae,_.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(vt){Xo(_,_.return,vt)}}else ut(d,_,A,k);break;case 13:ut(d,_,A,k);break;case 23:break;case 22:ee=_.stateNode,Ae=_.alternate,_.memoizedState!==null?ee._visibility&2?ut(d,_,A,k):jt(d,_):ee._visibility&2?ut(d,_,A,k):(ee._visibility|=2,at(d,_,A,k,(_.subtreeFlags&10256)!==0)),H&2048&&Nt(Ae,_);break;case 24:ut(d,_,A,k),H&2048&&Xt(_.alternate,_);break;default:ut(d,_,A,k)}}function at(d,_,A,k,H){for(H=H&&(_.subtreeFlags&10256)!==0,_=_.child;_!==null;){var ee=d,Ae=_,He=A,vt=k,Qt=Ae.flags;switch(Ae.tag){case 0:case 11:case 15:at(ee,Ae,He,vt,H),lh(8,Ae);break;case 23:break;case 22:var Mn=Ae.stateNode;Ae.memoizedState!==null?Mn._visibility&2?at(ee,Ae,He,vt,H):jt(ee,Ae):(Mn._visibility|=2,at(ee,Ae,He,vt,H)),H&&Qt&2048&&Nt(Ae.alternate,Ae);break;case 24:at(ee,Ae,He,vt,H),H&&Qt&2048&&Xt(Ae.alternate,Ae);break;default:at(ee,Ae,He,vt,H)}_=_.sibling}}function jt(d,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var A=d,k=_,H=k.flags;switch(k.tag){case 22:jt(A,k),H&2048&&Nt(k.alternate,k);break;case 24:jt(A,k),H&2048&&Xt(k.alternate,k);break;default:jt(A,k)}_=_.sibling}}var wt=8192;function Ht(d){if(d.subtreeFlags&wt)for(d=d.child;d!==null;)pn(d),d=d.sibling}function pn(d){switch(d.tag){case 26:Ht(d),d.flags&wt&&d.memoizedState!==null&&Zy(Fe,d.memoizedState,d.memoizedProps);break;case 5:Ht(d);break;case 3:case 4:var _=Fe;Fe=Qm(d.stateNode.containerInfo),Ht(d),Fe=_;break;case 22:d.memoizedState===null&&(_=d.alternate,_!==null&&_.memoizedState!==null?(_=wt,wt=16777216,Ht(d),wt=_):Ht(d));break;default:Ht(d)}}function Ft(d){var _=d.alternate;if(_!==null&&(d=_.child,d!==null)){_.child=null;do _=d.sibling,d.sibling=null,d=_;while(d!==null)}}function rn(d){var _=d.deletions;if((d.flags&16)!==0){if(_!==null)for(var A=0;A<_.length;A++){var k=_[A];X=k,On(k,d)}Ft(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Bn(d),d=d.sibling}function Bn(d){switch(d.tag){case 0:case 11:case 15:rn(d),d.flags&2048&&Yl(9,d,d.return);break;case 3:rn(d);break;case 12:rn(d);break;case 22:var _=d.stateNode;d.memoizedState!==null&&_._visibility&2&&(d.return===null||d.return.tag!==13)?(_._visibility&=-3,Dn(d)):rn(d);break;default:rn(d)}}function Dn(d){var _=d.deletions;if((d.flags&16)!==0){if(_!==null)for(var A=0;A<_.length;A++){var k=_[A];X=k,On(k,d)}Ft(d)}for(d=d.child;d!==null;){switch(_=d,_.tag){case 0:case 11:case 15:Yl(8,_,_.return),Dn(_);break;case 22:A=_.stateNode,A._visibility&2&&(A._visibility&=-3,Dn(_));break;default:Dn(_)}d=d.sibling}}function On(d,_){for(;X!==null;){var A=X;switch(A.tag){case 0:case 11:case 15:Yl(8,A,_);break;case 23:case 22:if(A.memoizedState!==null&&A.memoizedState.cachePool!==null){var k=A.memoizedState.cachePool.pool;k!=null&&k.refCount++}break;case 24:nh(A.memoizedState.cache)}if(k=A.child,k!==null)k.return=A,X=k;else e:for(A=d;X!==null;){k=X;var H=k.sibling,ee=k.return;if(fe(k),k===A){X=null;break e}if(H!==null){H.return=ee,X=H;break e}X=ee}}}var Yn={getCacheForType:function(d){var _=js(Oo),A=_.data.get(d);return A===void 0&&(A=d(),_.data.set(d,A)),A}},ni=typeof WeakMap=="function"?WeakMap:Map,Rn=0,Kn=null,ei=null,_i=0,Pi=0,Yi=null,fr=!1,ho=!1,wi=!1,xi=0,fi=0,Pr=0,Io=0,Br=0,Gi=0,eo=0,Ki=null,jr=null,qr=!1,Lr=0,Fr=1/0,xr=null,Gr=null,fo=0,Or=null,sr=null,Ps=0,Ys=0,Ml=null,Tc=null,dl=0,Ks=null;function fs(){if((Rn&2)!==0&&_i!==0)return _i&-_i;if(rt.T!==null){var d=Gh;return d!==0?d:h_()}return bt()}function Sc(){Gi===0&&(Gi=(_i&536870912)===0||br?Pa():536870912);var d=Es.current;return d!==null&&(d.flags|=32),Gi}function ps(d,_,A){(d===Kn&&(Pi===2||Pi===9)||d.cancelPendingCommit!==null)&&(ch(d,0),Nu(d,_i,Gi,!1)),al(d,A),((Rn&2)===0||d!==Kn)&&(d===Kn&&((Rn&2)===0&&(Io|=A),fi===4&&Nu(d,_i,Gi,!1)),uh(d))}function qf(d,_,A){if((Rn&6)!==0)throw Error(s(327));var k=!A&&(_&124)===0&&(_&d.expiredLanes)===0||Go(d,_),H=k?Oy(d,_):l_(d,_,!0),ee=k;do{if(H===0){ho&&!k&&Nu(d,_,0,!1);break}else{if(A=d.current.alternate,ee&&!Hf(A)){H=l_(d,_,!1),ee=!1;continue}if(H===2){if(ee=_,d.errorRecoveryDisabledLanes&ee)var Ae=0;else Ae=d.pendingLanes&-536870913,Ae=Ae!==0?Ae:Ae&536870912?536870912:0;if(Ae!==0){_=Ae;e:{var He=d;H=Ki;var vt=He.current.memoizedState.isDehydrated;if(vt&&(ch(He,Ae).flags|=256),Ae=l_(He,Ae,!1),Ae!==2){if(wi&&!vt){He.errorRecoveryDisabledLanes|=ee,Io|=ee,H=4;break e}ee=jr,jr=H,ee!==null&&(jr===null?jr=ee:jr.push.apply(jr,ee))}H=Ae}if(ee=!1,H!==2)continue}}if(H===1){ch(d,0),Nu(d,_,0,!0);break}e:{switch(k=d,ee=H,ee){case 0:case 1:throw Error(s(345));case 4:if((_&4194048)!==_)break;case 6:Nu(k,_,Gi,!fr);break e;case 2:jr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((_&62914560)===_&&(H=Lr+300-kr(),10<H)){if(Nu(k,_,Gi,!fr),Aa(k,0,!0)!==0)break e;k.timeoutHandle=By(Gm.bind(null,k,A,jr,xr,qr,_,Gi,Io,eo,fr,ee,2,-0,0),H);break e}Gm(k,A,jr,xr,qr,_,Gi,Io,eo,fr,ee,0,-0,0)}}break}while(!0);uh(d)}function Gm(d,_,A,k,H,ee,Ae,He,vt,Qt,Mn,$n,nn,cn){if(d.timeoutHandle=-1,$n=_.subtreeFlags,($n&8192||($n&16785408)===16785408)&&(Yf={stylesheets:null,count:0,unsuspend:Wb},pn(_),$n=Xb(),$n!==null)){d.cancelPendingCommit=$n(a0.bind(null,d,_,ee,A,k,H,Ae,He,vt,Mn,1,nn,cn)),Nu(d,ee,Ae,!Qt);return}a0(d,_,ee,A,k,H,Ae,He,vt)}function Hf(d){for(var _=d;;){var A=_.tag;if((A===0||A===11||A===15)&&_.flags&16384&&(A=_.updateQueue,A!==null&&(A=A.stores,A!==null)))for(var k=0;k<A.length;k++){var H=A[k],ee=H.getSnapshot;H=H.value;try{if(!Sl(ee(),H))return!1}catch{return!1}}if(A=_.child,_.subtreeFlags&16384&&A!==null)A.return=_,_=A;else{if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Nu(d,_,A,k){_&=~Br,_&=~Io,d.suspendedLanes|=_,d.pingedLanes&=~_,k&&(d.warmLanes|=_),k=d.expirationTimes;for(var H=_;0<H;){var ee=31-Po(H),Ae=1<<ee;k[ee]=-1,H&=~Ae}A!==0&&Ca(d,A,_)}function ed(){return(Rn&6)===0?(Wf(0),!1):!0}function Gf(){if(ei!==null){if(Pi===0)var d=ei.return;else d=ei,pc=Ss=null,Su(d),Kh=null,jl=0,d=ei;for(;d!==null;)Hm(d.alternate,d),d=d.return;ei=null}}function ch(d,_){var A=d.timeoutHandle;A!==-1&&(d.timeoutHandle=-1,E2(A)),A=d.cancelPendingCommit,A!==null&&(d.cancelPendingCommit=null,A()),Gf(),Kn=d,ei=A=hc(d.current,null),_i=_,Pi=0,Yi=null,fr=!1,ho=Go(d,_),wi=!1,eo=Gi=Br=Io=Pr=fi=0,jr=Ki=null,qr=!1,(_&8)!==0&&(_|=_&32);var k=d.entangledLanes;if(k!==0)for(d=d.entanglements,k&=_;0<k;){var H=31-Po(k),ee=1<<H;_|=d[H],k&=~ee}return xi=_,qc(),A}function tu(d,_){$r=null,rt.H=Jc,_===wp||_===Tm?(_=Wh(),Pi=3):_===xy?(_=Wh(),Pi=4):Pi=_===n_?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,Yi=_,ei===null&&(fi=1,Jh(d,fn(_,d.current)))}function Qd(){var d=rt.H;return rt.H=Jc,d===null?Jc:d}function td(){var d=rt.A;return rt.A=Yn,d}function Bu(){fi=4,fr||(_i&4194048)!==_i&&Es.current!==null||(ho=!0),(Pr&134217727)===0&&(Io&134217727)===0||Kn===null||Nu(Kn,_i,Gi,!1)}function l_(d,_,A){var k=Rn;Rn|=2;var H=Qd(),ee=td();(Kn!==d||_i!==_)&&(xr=null,ch(d,_)),_=!1;var Ae=fi;e:do try{if(Pi!==0&&ei!==null){var He=ei,vt=Yi;switch(Pi){case 8:Gf(),Ae=6;break e;case 3:case 2:case 9:case 6:Es.current===null&&(_=!0);var Qt=Pi;if(Pi=0,Yi=null,Vp(d,He,vt,Qt),A&&ho){Ae=0;break e}break;default:Qt=Pi,Pi=0,Yi=null,Vp(d,He,vt,Qt)}}Zm(),Ae=fi;break}catch(Mn){tu(d,Mn)}while(!0);return _&&d.shellSuspendCounter++,pc=Ss=null,Rn=k,rt.H=H,rt.A=ee,ei===null&&(Kn=null,_i=0,qc()),Ae}function Zm(){for(;ei!==null;)r0(ei)}function Oy(d,_){var A=Rn;Rn|=2;var k=Qd(),H=td();Kn!==d||_i!==_?(xr=null,Fr=kr()+500,ch(d,_)):ho=Go(d,_);e:do try{if(Pi!==0&&ei!==null){_=ei;var ee=Yi;t:switch(Pi){case 1:Pi=0,Yi=null,Vp(d,_,ee,1);break;case 2:case 9:if(by(ee)){Pi=0,Yi=null,o0(_);break}_=function(){Pi!==2&&Pi!==9||Kn!==d||(Pi=7),uh(d)},ee.then(_,_);break e;case 3:Pi=7;break e;case 4:Pi=5;break e;case 7:by(ee)?(Pi=0,Yi=null,o0(_)):(Pi=0,Yi=null,Vp(d,_,ee,7));break;case 5:var Ae=null;switch(ei.tag){case 26:Ae=ei.memoizedState;case 5:case 27:var He=ei;if(!Ae||Zb(Ae)){Pi=0,Yi=null;var vt=He.sibling;if(vt!==null)ei=vt;else{var Qt=He.return;Qt!==null?(ei=Qt,c_(Qt)):ei=null}break t}}Pi=0,Yi=null,Vp(d,_,ee,5);break;case 6:Pi=0,Yi=null,Vp(d,_,ee,6);break;case 8:Gf(),fi=6;break e;default:throw Error(s(462))}}Eb();break}catch(Mn){tu(d,Mn)}while(!0);return pc=Ss=null,rt.H=k,rt.A=H,Rn=A,ei!==null?0:(Kn=null,_i=0,qc(),fi)}function Eb(){for(;ei!==null&&!Mi();)r0(ei)}function r0(d){var _=$f(d.alternate,d,xi);d.memoizedProps=d.pendingProps,_===null?c_(d):ei=_}function o0(d){var _=d,A=_.alternate;switch(_.tag){case 15:case 0:_=Cy(A,_,_.pendingProps,_.type,void 0,_i);break;case 11:_=Cy(A,_,_.pendingProps,_.type.render,_.ref,_i);break;case 5:Su(_);default:Hm(A,_),_=ei=Jr(_,xi),_=$f(A,_,xi)}d.memoizedProps=d.pendingProps,_===null?c_(d):ei=_}function Vp(d,_,A,k){pc=Ss=null,Su(_),Kh=null,jl=0;var H=_.return;try{if(Py(d,H,_,A,_i)){fi=1,Jh(d,fn(A,d.current)),ei=null;return}}catch(ee){if(H!==null)throw ei=H,ee;fi=1,Jh(d,fn(A,d.current)),ei=null;return}_.flags&32768?(br||k===1?d=!0:ho||(_i&536870912)!==0?d=!1:(fr=d=!0,(k===2||k===9||k===3||k===6)&&(k=Es.current,k!==null&&k.tag===13&&(k.flags|=16384))),Zf(_,d)):c_(_)}function c_(d){var _=d;do{if((_.flags&32768)!==0){Zf(_,fr);return}d=_.return;var A=zu(_.alternate,_,xi);if(A!==null){ei=A;return}if(_=_.sibling,_!==null){ei=_;return}ei=_=d}while(_!==null);fi===0&&(fi=5)}function Zf(d,_){do{var A=Up(d.alternate,d);if(A!==null){A.flags&=32767,ei=A;return}if(A=d.return,A!==null&&(A.flags|=32768,A.subtreeFlags=0,A.deletions=null),!_&&(d=d.sibling,d!==null)){ei=d;return}ei=d=A}while(d!==null);fi=6,ei=null}function a0(d,_,A,k,H,ee,Ae,He,vt){d.cancelPendingCommit=null;do qp();while(fo!==0);if((Rn&6)!==0)throw Error(s(327));if(_!==null){if(_===d.current)throw Error(s(177));if(ee=_.lanes|_.childLanes,ee|=ks,ls(d,A,ee,Ae,He,vt),d===Kn&&(ei=Kn=null,_i=0),sr=_,Or=d,Ps=A,Ys=ee,Ml=H,Tc=k,(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,ef(go,function(){return Cb(),null})):(d.callbackNode=null,d.callbackPriority=0),k=(_.flags&13878)!==0,(_.subtreeFlags&13878)!==0||k){k=rt.T,rt.T=null,H=Bt.p,Bt.p=2,Ae=Rn,Rn|=4;try{W(d,_,A)}finally{Rn=Ae,Bt.p=H,rt.T=k}}fo=1,Js(),$p(),Ab()}}function Js(){if(fo===1){fo=0;var d=Or,_=sr,A=(_.flags&13878)!==0;if((_.subtreeFlags&13878)!==0||A){A=rt.T,rt.T=null;var k=Bt.p;Bt.p=2;var H=Rn;Rn|=4;try{ke(_,d);var ee=g0,Ae=Nh(d.containerInfo),He=ee.focusedElem,vt=ee.selectionRange;if(Ae!==He&&He&&He.ownerDocument&&Vc(He.ownerDocument.documentElement,He)){if(vt!==null&&hu(He)){var Qt=vt.start,Mn=vt.end;if(Mn===void 0&&(Mn=Qt),"selectionStart"in He)He.selectionStart=Qt,He.selectionEnd=Math.min(Mn,He.value.length);else{var $n=He.ownerDocument||document,nn=$n&&$n.defaultView||window;if(nn.getSelection){var cn=nn.getSelection(),pr=He.textContent.length,ur=Math.min(vt.start,pr),$o=vt.end===void 0?ur:Math.min(vt.end,pr);!cn.extend&&ur>$o&&(Ae=$o,$o=ur,ur=Ae);var Gt=Uc(He,ur),Rt=Uc(He,$o);if(Gt&&Rt&&(cn.rangeCount!==1||cn.anchorNode!==Gt.node||cn.anchorOffset!==Gt.offset||cn.focusNode!==Rt.node||cn.focusOffset!==Rt.offset)){var Kt=$n.createRange();Kt.setStart(Gt.node,Gt.offset),cn.removeAllRanges(),ur>$o?(cn.addRange(Kt),cn.extend(Rt.node,Rt.offset)):(Kt.setEnd(Rt.node,Rt.offset),cn.addRange(Kt))}}}}for($n=[],cn=He;cn=cn.parentNode;)cn.nodeType===1&&$n.push({element:cn,left:cn.scrollLeft,top:cn.scrollTop});for(typeof He.focus=="function"&&He.focus(),He=0;He<$n.length;He++){var Cn=$n[He];Cn.element.scrollLeft=Cn.left,Cn.element.scrollTop=Cn.top}}Yy=!!Xp,g0=Xp=null}finally{Rn=H,Bt.p=k,rt.T=A}}d.current=_,fo=2}}function $p(){if(fo===2){fo=0;var d=Or,_=sr,A=(_.flags&8772)!==0;if((_.subtreeFlags&8772)!==0||A){A=rt.T,rt.T=null;var k=Bt.p;Bt.p=2;var H=Rn;Rn|=4;try{Q(d,_.alternate,_)}finally{Rn=H,Bt.p=k,rt.T=A}}fo=3}}function Ab(){if(fo===4||fo===3){fo=0,Tr();var d=Or,_=sr,A=Ps,k=Tc;(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?fo=5:(fo=0,sr=Or=null,Pb(d,d.pendingLanes));var H=d.pendingLanes;if(H===0&&(Gr=null),Ja(A),_=_.stateNode,Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(Ho,_,void 0,(_.current.flags&128)===128)}catch{}if(k!==null){_=rt.T,H=Bt.p,Bt.p=2,rt.T=null;try{for(var ee=d.onRecoverableError,Ae=0;Ae<k.length;Ae++){var He=k[Ae];ee(He.value,{componentStack:He.stack})}}finally{rt.T=_,Bt.p=H}}(Ps&3)!==0&&qp(),uh(d),H=d.pendingLanes,(A&4194090)!==0&&(H&42)!==0?d===Ks?dl++:(dl=0,Ks=d):dl=0,Wf(0)}}function Pb(d,_){(d.pooledCacheLanes&=_)===0&&(_=d.pooledCache,_!=null&&(d.pooledCache=null,nh(_)))}function qp(d){return Js(),$p(),Ab(),Cb()}function Cb(){if(fo!==5)return!1;var d=Or,_=Ys;Ys=0;var A=Ja(Ps),k=rt.T,H=Bt.p;try{Bt.p=32>A?32:A,rt.T=null,A=Ml,Ml=null;var ee=Or,Ae=Ps;if(fo=0,sr=Or=null,Ps=0,(Rn&6)!==0)throw Error(s(331));var He=Rn;if(Rn|=4,Bn(ee.current),Et(ee,ee.current,Ae,A),Rn=He,Wf(0,!1),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(Ho,ee)}catch{}return!0}finally{Bt.p=H,rt.T=k,Pb(d,_)}}function s0(d,_,A){_=fn(A,_),_=Uf(d.stateNode,_,2),d=rh(d,_,2),d!==null&&(al(d,2),uh(d))}function Xo(d,_,A){if(d.tag===3)s0(d,d,A);else for(;_!==null;){if(_.tag===3){s0(_,d,A);break}else if(_.tag===1){var k=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(Gr===null||!Gr.has(k))){d=fn(A,d),A=t_(2),k=rh(_,A,2),k!==null&&(kp(A,k,_,d),al(k,2),uh(k));break}}_=_.return}}function l0(d,_,A){var k=d.pingCache;if(k===null){k=d.pingCache=new ni;var H=new Set;k.set(_,H)}else H=k.get(_),H===void 0&&(H=new Set,k.set(_,H));H.has(A)||(wi=!0,H.add(A),d=Mb.bind(null,d,_,A),_.then(d,d))}function Mb(d,_,A){var k=d.pingCache;k!==null&&k.delete(_),d.pingedLanes|=d.suspendedLanes&A,d.warmLanes&=~A,Kn===d&&(_i&A)===A&&(fi===4||fi===3&&(_i&62914560)===_i&&300>kr()-Lr?(Rn&2)===0&&ch(d,0):Br|=A,eo===_i&&(eo=0)),uh(d)}function Ob(d,_){_===0&&(_=Is()),d=Gc(d,_),d!==null&&(al(d,_),uh(d))}function c0(d){var _=d.memoizedState,A=0;_!==null&&(A=_.retryLane),Ob(d,A)}function nd(d,_){var A=0;switch(d.tag){case 13:var k=d.stateNode,H=d.memoizedState;H!==null&&(A=H.retryLane);break;case 19:k=d.stateNode;break;case 22:k=d.stateNode._retryCache;break;default:throw Error(s(314))}k!==null&&k.delete(_),Ob(d,A)}function ef(d,_){return ci(d,_)}var u_=null,Hp=null,Wm=!1,Xm=!1,Gp=!1,id=0;function uh(d){d!==Hp&&d.next===null&&(Hp===null?u_=Hp=d:Hp=Hp.next=d),Xm=!0,Wm||(Wm=!0,Ib())}function Wf(d,_){if(!Gp&&Xm){Gp=!0;do for(var A=!1,k=u_;k!==null;){if(d!==0){var H=k.pendingLanes;if(H===0)var ee=0;else{var Ae=k.suspendedLanes,He=k.pingedLanes;ee=(1<<31-Po(42|d)+1)-1,ee&=H&~(Ae&~He),ee=ee&201326741?ee&201326741|1:ee?ee|2:0}ee!==0&&(A=!0,tf(k,ee))}else ee=_i,ee=Aa(k,k===Kn?ee:0,k.cancelPendingCommit!==null||k.timeoutHandle!==-1),(ee&3)===0||Go(k,ee)||(A=!0,tf(k,ee));k=k.next}while(A);Gp=!1}}function u0(){Iy()}function Iy(){Xm=Wm=!1;var d=0;id!==0&&(S2()&&(d=id),id=0);for(var _=kr(),A=null,k=u_;k!==null;){var H=k.next,ee=h0(k,_);ee===0?(k.next=null,A===null?u_=H:A.next=H,H===null&&(Hp=A)):(A=k,(d!==0||(ee&3)!==0)&&(Xm=!0)),k=H}Wf(d)}function h0(d,_){for(var A=d.suspendedLanes,k=d.pingedLanes,H=d.expirationTimes,ee=d.pendingLanes&-62914561;0<ee;){var Ae=31-Po(ee),He=1<<Ae,vt=H[Ae];vt===-1?((He&A)===0||(He&k)!==0)&&(H[Ae]=tr(He,_)):vt<=_&&(d.expiredLanes|=He),ee&=~He}if(_=Kn,A=_i,A=Aa(d,d===_?A:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),k=d.callbackNode,A===0||d===_&&(Pi===2||Pi===9)||d.cancelPendingCommit!==null)return k!==null&&k!==null&&Ii(k),d.callbackNode=null,d.callbackPriority=0;if((A&3)===0||Go(d,A)){if(_=A&-A,_===d.callbackPriority)return _;switch(k!==null&&Ii(k),Ja(A)){case 2:case 8:A=Yr;break;case 32:A=go;break;case 268435456:A=ya;break;default:A=go}return k=d0.bind(null,d),A=ci(A,k),d.callbackPriority=_,d.callbackNode=A,_}return k!==null&&k!==null&&Ii(k),d.callbackPriority=2,d.callbackNode=null,2}function d0(d,_){if(fo!==0&&fo!==5)return d.callbackNode=null,d.callbackPriority=0,null;var A=d.callbackNode;if(qp()&&d.callbackNode!==A)return null;var k=_i;return k=Aa(d,d===Kn?k:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),k===0?null:(qf(d,k,_),h0(d,kr()),d.callbackNode!=null&&d.callbackNode===A?d0.bind(null,d):null)}function tf(d,_){if(qp())return null;qf(d,_,!0)}function Ib(){p_(function(){(Rn&6)!==0?ci(Xr,u0):Iy()})}function h_(){return id===0&&(id=Pa()),id}function f0(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:St(""+d)}function Db(d,_){var A=_.ownerDocument.createElement("input");return A.name=_.name,A.value=_.value,d.id&&A.setAttribute("form",d.id),_.parentNode.insertBefore(A,_),d=new FormData(d),A.parentNode.removeChild(A),d}function b2(d,_,A,k,H){if(_==="submit"&&A&&A.stateNode===H){var ee=f0((H[ge]||null).action),Ae=k.submitter;Ae&&(_=(_=Ae[ge]||null)?f0(_.formAction):Ae.getAttribute("formAction"),_!==null&&(ee=_,Ae=null));var He=new Tl("action","action",null,k,H);d.push({event:He,listeners:[{instance:null,listener:function(){if(k.defaultPrevented){if(id!==0){var vt=Ae?Db(H,Ae):new FormData(H);Lf(A,{pending:!0,data:vt,method:H.method,action:ee},null,vt)}}else typeof ee=="function"&&(He.preventDefault(),vt=Ae?Db(H,Ae):new FormData(H),Lf(A,{pending:!0,data:vt,method:H.method,action:ee},ee,vt))},currentTarget:H}]})}}for(var p0=0;p0<cc.length;p0++){var Dy=cc[p0],Rb=Dy.toLowerCase(),w2=Dy[0].toUpperCase()+Dy.slice(1);pa(Rb,"on"+w2)}pa(yf,"onAnimationEnd"),pa(Uo,"onAnimationIteration"),pa($c,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(_p,"onTransitionRun"),pa(Fh,"onTransitionStart"),pa(Uh,"onTransitionCancel"),pa(fu,"onTransitionEnd"),gi("onMouseEnter",["mouseout","mouseover"]),gi("onMouseLeave",["mouseout","mouseover"]),gi("onPointerEnter",["pointerout","pointerover"]),gi("onPointerLeave",["pointerout","pointerover"]),si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),si("onBeforeInput",["compositionend","keypress","textInput","paste"]),si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ym="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),T2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ym));function Lb(d,_){_=(_&4)!==0;for(var A=0;A<d.length;A++){var k=d[A],H=k.event;k=k.listeners;e:{var ee=void 0;if(_)for(var Ae=k.length-1;0<=Ae;Ae--){var He=k[Ae],vt=He.instance,Qt=He.currentTarget;if(He=He.listener,vt!==ee&&H.isPropagationStopped())break e;ee=He,H.currentTarget=Qt;try{ee(H)}catch(Mn){Iu(Mn)}H.currentTarget=null,ee=vt}else for(Ae=0;Ae<k.length;Ae++){if(He=k[Ae],vt=He.instance,Qt=He.currentTarget,He=He.listener,vt!==ee&&H.isPropagationStopped())break e;ee=He,H.currentTarget=Qt;try{ee(H)}catch(Mn){Iu(Mn)}H.currentTarget=null,ee=vt}}}}function ao(d,_){var A=_[Ne];A===void 0&&(A=_[Ne]=new Set);var k=d+"__bubble";A.has(k)||(m0(_,d,2,!1),A.add(k))}function Ry(d,_,A){var k=0;_&&(k|=4),m0(A,d,k,_)}var d_="_reactListening"+Math.random().toString(36).slice(2);function Ly(d){if(!d[d_]){d[d_]=!0,zn.forEach(function(A){A!=="selectionchange"&&(T2.has(A)||Ry(A,!1,d),Ry(A,!0,d))});var _=d.nodeType===9?d:d.ownerDocument;_===null||_[d_]||(_[d_]=!0,Ry("selectionchange",!1,_))}}function m0(d,_,A,k){switch(v_(_)){case 2:var H=D2;break;case 8:H=R2;break;default:H=Ky}A=H.bind(null,_,A,d),H=void 0,!hs||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(H=!0),k?H!==void 0?d.addEventListener(_,A,{capture:!0,passive:H}):d.addEventListener(_,A,!0):H!==void 0?d.addEventListener(_,A,{passive:H}):d.addEventListener(_,A,!1)}function zy(d,_,A,k,H){var ee=k;if((_&1)===0&&(_&2)===0&&k!==null)e:for(;;){if(k===null)return;var Ae=k.tag;if(Ae===3||Ae===4){var He=k.stateNode.containerInfo;if(He===H)break;if(Ae===4)for(Ae=k.return;Ae!==null;){var vt=Ae.tag;if((vt===3||vt===4)&&Ae.stateNode.containerInfo===H)return;Ae=Ae.return}for(;He!==null;){if(Ae=gt(He),Ae===null)return;if(vt=Ae.tag,vt===5||vt===6||vt===26||vt===27){k=ee=Ae;continue e}He=He.parentNode}}k=k.return}Sr(function(){var Qt=ee,Mn=Vn(A),$n=[];e:{var nn=vf.get(d);if(nn!==void 0){var cn=Tl,pr=d;switch(d){case"keypress":if(No(A)===0)break e;case"keydown":case"keyup":cn=Jn;break;case"focusin":pr="focus",cn=xa;break;case"focusout":pr="blur",cn=xa;break;case"beforeblur":case"afterblur":cn=xa;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":cn=_o;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":cn=yo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":cn=Nc;break;case yf:case Uo:case $c:cn=Di;break;case fu:cn=_f;break;case"scroll":case"scrollend":cn=Ut;break;case"wheel":cn=Dh;break;case"copy":case"cut":case"paste":cn=Ls;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":cn=dr;break;case"toggle":case"beforetoggle":cn=Eo}var ur=(_&4)!==0,$o=!ur&&(d==="scroll"||d==="scrollend"),Gt=ur?nn!==null?nn+"Capture":null:nn;ur=[];for(var Rt=Qt,Kt;Rt!==null;){var Cn=Rt;if(Kt=Cn.stateNode,Cn=Cn.tag,Cn!==5&&Cn!==26&&Cn!==27||Kt===null||Gt===null||(Cn=ri(Rt,Gt),Cn!=null&&ur.push(Km(Rt,Cn,Kt))),$o)break;Rt=Rt.return}0<ur.length&&(nn=new cn(nn,pr,null,A,Mn),$n.push({event:nn,listeners:ur}))}}if((_&7)===0){e:{if(nn=d==="mouseover"||d==="pointerover",cn=d==="mouseout"||d==="pointerout",nn&&A!==en&&(pr=A.relatedTarget||A.fromElement)&&(gt(pr)||pr[Ee]))break e;if((cn||nn)&&(nn=Mn.window===Mn?Mn:(nn=Mn.ownerDocument)?nn.defaultView||nn.parentWindow:window,cn?(pr=A.relatedTarget||A.toElement,cn=Qt,pr=pr?gt(pr):null,pr!==null&&($o=y(pr),ur=pr.tag,pr!==$o||ur!==5&&ur!==27&&ur!==6)&&(pr=null)):(cn=null,pr=Qt),cn!==pr)){if(ur=_o,Cn="onMouseLeave",Gt="onMouseEnter",Rt="mouse",(d==="pointerout"||d==="pointerover")&&(ur=dr,Cn="onPointerLeave",Gt="onPointerEnter",Rt="pointer"),$o=cn==null?nn:Zt(cn),Kt=pr==null?nn:Zt(pr),nn=new ur(Cn,Rt+"leave",cn,A,Mn),nn.target=$o,nn.relatedTarget=Kt,Cn=null,gt(Mn)===Qt&&(ur=new ur(Gt,Rt+"enter",pr,A,Mn),ur.target=Kt,ur.relatedTarget=$o,Cn=ur),$o=Cn,cn&&pr)t:{for(ur=cn,Gt=pr,Rt=0,Kt=ur;Kt;Kt=nu(Kt))Rt++;for(Kt=0,Cn=Gt;Cn;Cn=nu(Cn))Kt++;for(;0<Rt-Kt;)ur=nu(ur),Rt--;for(;0<Kt-Rt;)Gt=nu(Gt),Kt--;for(;Rt--;){if(ur===Gt||Gt!==null&&ur===Gt.alternate)break t;ur=nu(ur),Gt=nu(Gt)}ur=null}else ur=null;cn!==null&&Cs($n,nn,cn,ur,!1),pr!==null&&$o!==null&&Cs($n,$o,pr,ur,!0)}}e:{if(nn=Qt?Zt(Qt):window,cn=nn.nodeName&&nn.nodeName.toLowerCase(),cn==="select"||cn==="input"&&nn.type==="file")var Si=Zl;else if(ds(nn))if(oc)Si=Pd;else{Si=ac;var Zr=Ad}else cn=nn.nodeName,!cn||cn.toLowerCase()!=="input"||nn.type!=="checkbox"&&nn.type!=="radio"?Qt&&cs(Qt.elementType)&&(Si=Zl):Si=ia;if(Si&&(Si=Si(d,Qt))){di($n,Si,A,Mn);break e}Zr&&Zr(d,nn,Qt),d==="focusout"&&Qt&&nn.type==="number"&&Qt.memoizedProps.value!=null&&va(nn,"number",nn.value)}switch(Zr=Qt?Zt(Qt):window,d){case"focusin":(ds(Zr)||Zr.contentEditable==="true")&&(rs=Zr,jh=Qt,Ju=null);break;case"focusout":Ju=jh=rs=null;break;case"mousedown":Cd=!0;break;case"contextmenu":case"mouseup":case"dragend":Cd=!1,gp($n,A,Mn);break;case"selectionchange":if(Bh)break;case"keydown":case"keyup":gp($n,A,Mn)}var Vi;if(zl)e:{switch(d){case"compositionstart":var lr="onCompositionStart";break e;case"compositionend":lr="onCompositionEnd";break e;case"compositionupdate":lr="onCompositionUpdate";break e}lr=void 0}else Ha?is(d,A)&&(lr="onCompositionEnd"):d==="keydown"&&A.keyCode===229&&(lr="onCompositionStart");lr&&(Lh&&A.locale!=="ko"&&(Ha||lr!=="onCompositionStart"?lr==="onCompositionEnd"&&Ha&&(Vi=Ma()):(Rs=Mn,ws="value"in Rs?Rs.value:Rs.textContent,Ha=!0)),Zr=Jm(Qt,lr),0<Zr.length&&(lr=new Xn(lr,d,null,A,Mn),$n.push({event:lr,listeners:Zr}),Vi?lr.data=Vi:(Vi=rc(A),Vi!==null&&(lr.data=Vi)))),(Vi=Rh?uu(d,A):Ri(d,A))&&(lr=Jm(Qt,"onBeforeInput"),0<lr.length&&(Zr=new Xn("onBeforeInput","beforeinput",null,A,Mn),$n.push({event:Zr,listeners:lr}),Zr.data=Vi)),b2($n,d,Qt,A,Mn)}Lb($n,_)})}function Km(d,_,A){return{instance:d,listener:_,currentTarget:A}}function Jm(d,_){for(var A=_+"Capture",k=[];d!==null;){var H=d,ee=H.stateNode;if(H=H.tag,H!==5&&H!==26&&H!==27||ee===null||(H=ri(d,A),H!=null&&k.unshift(Km(d,H,ee)),H=ri(d,_),H!=null&&k.push(Km(d,H,ee))),d.tag===3)return k;d=d.return}return[]}function nu(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function Cs(d,_,A,k,H){for(var ee=_._reactName,Ae=[];A!==null&&A!==k;){var He=A,vt=He.alternate,Qt=He.stateNode;if(He=He.tag,vt!==null&&vt===k)break;He!==5&&He!==26&&He!==27||Qt===null||(vt=Qt,H?(Qt=ri(A,ee),Qt!=null&&Ae.unshift(Km(A,Qt,vt))):H||(Qt=ri(A,ee),Qt!=null&&Ae.push(Km(A,Qt,vt)))),A=A.return}Ae.length!==0&&d.push({event:_,listeners:Ae})}var zb=/\r\n?/g,f_=/\u0000|\uFFFD/g;function kb(d){return(typeof d=="string"?d:""+d).replace(zb,`
`).replace(f_,"")}function Nb(d,_){return _=kb(_),kb(d)===_}function ky(){}function ca(d,_,A,k,H,ee){switch(A){case"children":typeof k=="string"?_==="body"||_==="textarea"&&k===""||da(d,k):(typeof k=="number"||typeof k=="bigint")&&_!=="body"&&da(d,""+k);break;case"className":Fi(d,"class",k);break;case"tabIndex":Fi(d,"tabindex",k);break;case"dir":case"role":case"viewBox":case"width":case"height":Fi(d,A,k);break;case"style":Gs(d,k,ee);break;case"data":if(_!=="object"){Fi(d,"data",k);break}case"src":case"href":if(k===""&&(_!=="a"||A!=="href")){d.removeAttribute(A);break}if(k==null||typeof k=="function"||typeof k=="symbol"||typeof k=="boolean"){d.removeAttribute(A);break}k=St(""+k),d.setAttribute(A,k);break;case"action":case"formAction":if(typeof k=="function"){d.setAttribute(A,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ee=="function"&&(A==="formAction"?(_!=="input"&&ca(d,_,"name",H.name,H,null),ca(d,_,"formEncType",H.formEncType,H,null),ca(d,_,"formMethod",H.formMethod,H,null),ca(d,_,"formTarget",H.formTarget,H,null)):(ca(d,_,"encType",H.encType,H,null),ca(d,_,"method",H.method,H,null),ca(d,_,"target",H.target,H,null)));if(k==null||typeof k=="symbol"||typeof k=="boolean"){d.removeAttribute(A);break}k=St(""+k),d.setAttribute(A,k);break;case"onClick":k!=null&&(d.onclick=ky);break;case"onScroll":k!=null&&ao("scroll",d);break;case"onScrollEnd":k!=null&&ao("scrollend",d);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(s(61));if(A=k.__html,A!=null){if(H.children!=null)throw Error(s(60));d.innerHTML=A}}break;case"multiple":d.multiple=k&&typeof k!="function"&&typeof k!="symbol";break;case"muted":d.muted=k&&typeof k!="function"&&typeof k!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(k==null||typeof k=="function"||typeof k=="boolean"||typeof k=="symbol"){d.removeAttribute("xlink:href");break}A=St(""+k),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",A);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":k!=null&&typeof k!="function"&&typeof k!="symbol"?d.setAttribute(A,""+k):d.removeAttribute(A);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":k&&typeof k!="function"&&typeof k!="symbol"?d.setAttribute(A,""):d.removeAttribute(A);break;case"capture":case"download":k===!0?d.setAttribute(A,""):k!==!1&&k!=null&&typeof k!="function"&&typeof k!="symbol"?d.setAttribute(A,k):d.removeAttribute(A);break;case"cols":case"rows":case"size":case"span":k!=null&&typeof k!="function"&&typeof k!="symbol"&&!isNaN(k)&&1<=k?d.setAttribute(A,k):d.removeAttribute(A);break;case"rowSpan":case"start":k==null||typeof k=="function"||typeof k=="symbol"||isNaN(k)?d.removeAttribute(A):d.setAttribute(A,k);break;case"popover":ao("beforetoggle",d),ao("toggle",d),ki(d,"popover",k);break;case"xlinkActuate":vi(d,"http://www.w3.org/1999/xlink","xlink:actuate",k);break;case"xlinkArcrole":vi(d,"http://www.w3.org/1999/xlink","xlink:arcrole",k);break;case"xlinkRole":vi(d,"http://www.w3.org/1999/xlink","xlink:role",k);break;case"xlinkShow":vi(d,"http://www.w3.org/1999/xlink","xlink:show",k);break;case"xlinkTitle":vi(d,"http://www.w3.org/1999/xlink","xlink:title",k);break;case"xlinkType":vi(d,"http://www.w3.org/1999/xlink","xlink:type",k);break;case"xmlBase":vi(d,"http://www.w3.org/XML/1998/namespace","xml:base",k);break;case"xmlLang":vi(d,"http://www.w3.org/XML/1998/namespace","xml:lang",k);break;case"xmlSpace":vi(d,"http://www.w3.org/XML/1998/namespace","xml:space",k);break;case"is":ki(d,"is",k);break;case"innerText":case"textContent":break;default:(!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(A=us.get(A)||A,ki(d,A,k))}}function Zp(d,_,A,k,H,ee){switch(A){case"style":Gs(d,k,ee);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(s(61));if(A=k.__html,A!=null){if(H.children!=null)throw Error(s(60));d.innerHTML=A}}break;case"children":typeof k=="string"?da(d,k):(typeof k=="number"||typeof k=="bigint")&&da(d,""+k);break;case"onScroll":k!=null&&ao("scroll",d);break;case"onScrollEnd":k!=null&&ao("scrollend",d);break;case"onClick":k!=null&&(d.onclick=ky);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ii.hasOwnProperty(A))e:{if(A[0]==="o"&&A[1]==="n"&&(H=A.endsWith("Capture"),_=A.slice(2,H?A.length-7:void 0),ee=d[ge]||null,ee=ee!=null?ee[A]:null,typeof ee=="function"&&d.removeEventListener(_,ee,H),typeof k=="function")){typeof ee!="function"&&ee!==null&&(A in d?d[A]=null:d.hasAttribute(A)&&d.removeAttribute(A)),d.addEventListener(_,k,H);break e}A in d?d[A]=k:k===!0?d.setAttribute(A,""):ki(d,A,k)}}}function fl(d,_,A){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ao("error",d),ao("load",d);var k=!1,H=!1,ee;for(ee in A)if(A.hasOwnProperty(ee)){var Ae=A[ee];if(Ae!=null)switch(ee){case"src":k=!0;break;case"srcSet":H=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,_));default:ca(d,_,ee,Ae,A,null)}}H&&ca(d,_,"srcSet",A.srcSet,A,null),k&&ca(d,_,"src",A.src,A,null);return;case"input":ao("invalid",d);var He=ee=Ae=H=null,vt=null,Qt=null;for(k in A)if(A.hasOwnProperty(k)){var Mn=A[k];if(Mn!=null)switch(k){case"name":H=Mn;break;case"type":Ae=Mn;break;case"checked":vt=Mn;break;case"defaultChecked":Qt=Mn;break;case"value":ee=Mn;break;case"defaultValue":He=Mn;break;case"children":case"dangerouslySetInnerHTML":if(Mn!=null)throw Error(s(137,_));break;default:ca(d,_,k,Mn,A,null)}}xs(d,ee,He,vt,Qt,Ae,H,!1),sl(d);return;case"select":ao("invalid",d),k=Ae=ee=null;for(H in A)if(A.hasOwnProperty(H)&&(He=A[H],He!=null))switch(H){case"value":ee=He;break;case"defaultValue":Ae=He;break;case"multiple":k=He;default:ca(d,_,H,He,A,null)}_=ee,A=Ae,d.multiple=!!k,_!=null?jo(d,!!k,_,!1):A!=null&&jo(d,!!k,A,!0);return;case"textarea":ao("invalid",d),ee=H=k=null;for(Ae in A)if(A.hasOwnProperty(Ae)&&(He=A[Ae],He!=null))switch(Ae){case"value":k=He;break;case"defaultValue":H=He;break;case"children":ee=He;break;case"dangerouslySetInnerHTML":if(He!=null)throw Error(s(91));break;default:ca(d,_,Ae,He,A,null)}ha(d,k,H,ee),sl(d);return;case"option":for(vt in A)if(A.hasOwnProperty(vt)&&(k=A[vt],k!=null))switch(vt){case"selected":d.selected=k&&typeof k!="function"&&typeof k!="symbol";break;default:ca(d,_,vt,k,A,null)}return;case"dialog":ao("beforetoggle",d),ao("toggle",d),ao("cancel",d),ao("close",d);break;case"iframe":case"object":ao("load",d);break;case"video":case"audio":for(k=0;k<Ym.length;k++)ao(Ym[k],d);break;case"image":ao("error",d),ao("load",d);break;case"details":ao("toggle",d);break;case"embed":case"source":case"link":ao("error",d),ao("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Qt in A)if(A.hasOwnProperty(Qt)&&(k=A[Qt],k!=null))switch(Qt){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,_));default:ca(d,_,Qt,k,A,null)}return;default:if(cs(_)){for(Mn in A)A.hasOwnProperty(Mn)&&(k=A[Mn],k!==void 0&&Zp(d,_,Mn,k,A,void 0));return}}for(He in A)A.hasOwnProperty(He)&&(k=A[He],k!=null&&ca(d,_,He,k,A,null))}function Wp(d,_,A,k){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var H=null,ee=null,Ae=null,He=null,vt=null,Qt=null,Mn=null;for(cn in A){var $n=A[cn];if(A.hasOwnProperty(cn)&&$n!=null)switch(cn){case"checked":break;case"value":break;case"defaultValue":vt=$n;default:k.hasOwnProperty(cn)||ca(d,_,cn,null,k,$n)}}for(var nn in k){var cn=k[nn];if($n=A[nn],k.hasOwnProperty(nn)&&(cn!=null||$n!=null))switch(nn){case"type":ee=cn;break;case"name":H=cn;break;case"checked":Qt=cn;break;case"defaultChecked":Mn=cn;break;case"value":Ae=cn;break;case"defaultValue":He=cn;break;case"children":case"dangerouslySetInnerHTML":if(cn!=null)throw Error(s(137,_));break;default:cn!==$n&&ca(d,_,nn,cn,k,$n)}}Bo(d,Ae,He,vt,Qt,Mn,ee,H);return;case"select":cn=Ae=He=nn=null;for(ee in A)if(vt=A[ee],A.hasOwnProperty(ee)&&vt!=null)switch(ee){case"value":break;case"multiple":cn=vt;default:k.hasOwnProperty(ee)||ca(d,_,ee,null,k,vt)}for(H in k)if(ee=k[H],vt=A[H],k.hasOwnProperty(H)&&(ee!=null||vt!=null))switch(H){case"value":nn=ee;break;case"defaultValue":He=ee;break;case"multiple":Ae=ee;default:ee!==vt&&ca(d,_,H,ee,k,vt)}_=He,A=Ae,k=cn,nn!=null?jo(d,!!A,nn,!1):!!k!=!!A&&(_!=null?jo(d,!!A,_,!0):jo(d,!!A,A?[]:"",!1));return;case"textarea":cn=nn=null;for(He in A)if(H=A[He],A.hasOwnProperty(He)&&H!=null&&!k.hasOwnProperty(He))switch(He){case"value":break;case"children":break;default:ca(d,_,He,null,k,H)}for(Ae in k)if(H=k[Ae],ee=A[Ae],k.hasOwnProperty(Ae)&&(H!=null||ee!=null))switch(Ae){case"value":nn=H;break;case"defaultValue":cn=H;break;case"children":break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(91));break;default:H!==ee&&ca(d,_,Ae,H,k,ee)}uo(d,nn,cn);return;case"option":for(var pr in A)if(nn=A[pr],A.hasOwnProperty(pr)&&nn!=null&&!k.hasOwnProperty(pr))switch(pr){case"selected":d.selected=!1;break;default:ca(d,_,pr,null,k,nn)}for(vt in k)if(nn=k[vt],cn=A[vt],k.hasOwnProperty(vt)&&nn!==cn&&(nn!=null||cn!=null))switch(vt){case"selected":d.selected=nn&&typeof nn!="function"&&typeof nn!="symbol";break;default:ca(d,_,vt,nn,k,cn)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ur in A)nn=A[ur],A.hasOwnProperty(ur)&&nn!=null&&!k.hasOwnProperty(ur)&&ca(d,_,ur,null,k,nn);for(Qt in k)if(nn=k[Qt],cn=A[Qt],k.hasOwnProperty(Qt)&&nn!==cn&&(nn!=null||cn!=null))switch(Qt){case"children":case"dangerouslySetInnerHTML":if(nn!=null)throw Error(s(137,_));break;default:ca(d,_,Qt,nn,k,cn)}return;default:if(cs(_)){for(var $o in A)nn=A[$o],A.hasOwnProperty($o)&&nn!==void 0&&!k.hasOwnProperty($o)&&Zp(d,_,$o,void 0,k,nn);for(Mn in k)nn=k[Mn],cn=A[Mn],!k.hasOwnProperty(Mn)||nn===cn||nn===void 0&&cn===void 0||Zp(d,_,Mn,nn,k,cn);return}}for(var Gt in A)nn=A[Gt],A.hasOwnProperty(Gt)&&nn!=null&&!k.hasOwnProperty(Gt)&&ca(d,_,Gt,null,k,nn);for($n in k)nn=k[$n],cn=A[$n],!k.hasOwnProperty($n)||nn===cn||nn==null&&cn==null||ca(d,_,$n,nn,k,cn)}var Xp=null,g0=null;function Ny(d){return d.nodeType===9?d:d.ownerDocument}function Bb(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jb(d,_){if(d===0)switch(_){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&_==="foreignObject"?0:d}function _0(d,_){return d==="textarea"||d==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.children=="bigint"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var y0=null;function S2(){var d=window.event;return d&&d.type==="popstate"?d===y0?!1:(y0=d,!0):(y0=null,!1)}var By=typeof setTimeout=="function"?setTimeout:void 0,E2=typeof clearTimeout=="function"?clearTimeout:void 0,v0=typeof Promise=="function"?Promise:void 0,p_=typeof queueMicrotask=="function"?queueMicrotask:typeof v0<"u"?function(d){return v0.resolve(null).then(d).catch(A2)}:By;function A2(d){setTimeout(function(){throw d})}function Yo(d){return d==="head"}function Yp(d,_){var A=_,k=0,H=0;do{var ee=A.nextSibling;if(d.removeChild(A),ee&&ee.nodeType===8)if(A=ee.data,A==="/$"){if(0<k&&8>k){A=k;var Ae=d.ownerDocument;if(A&1&&g_(Ae.documentElement),A&2&&g_(Ae.body),A&4)for(A=Ae.head,g_(A),Ae=A.firstChild;Ae;){var He=Ae.nextSibling,vt=Ae.nodeName;Ae[Xe]||vt==="SCRIPT"||vt==="STYLE"||vt==="LINK"&&Ae.rel.toLowerCase()==="stylesheet"||A.removeChild(Ae),Ae=He}}if(H===0){d.removeChild(ee),S_(_);return}H--}else A==="$"||A==="$?"||A==="$!"?H++:k=A.charCodeAt(0)-48;else k=0;A=ee}while(A);S_(_)}function jy(d){var _=d.firstChild;for(_&&_.nodeType===10&&(_=_.nextSibling);_;){var A=_;switch(_=_.nextSibling,A.nodeName){case"HTML":case"HEAD":case"BODY":jy(A),lt(A);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(A.rel.toLowerCase()==="stylesheet")continue}d.removeChild(A)}}function Fy(d,_,A,k){for(;d.nodeType===1;){var H=A;if(d.nodeName.toLowerCase()!==_.toLowerCase()){if(!k&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(k){if(!d[Xe])switch(_){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(ee=d.getAttribute("rel"),ee==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(ee!==H.rel||d.getAttribute("href")!==(H.href==null||H.href===""?null:H.href)||d.getAttribute("crossorigin")!==(H.crossOrigin==null?null:H.crossOrigin)||d.getAttribute("title")!==(H.title==null?null:H.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(ee=d.getAttribute("src"),(ee!==(H.src==null?null:H.src)||d.getAttribute("type")!==(H.type==null?null:H.type)||d.getAttribute("crossorigin")!==(H.crossOrigin==null?null:H.crossOrigin))&&ee&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(_==="input"&&d.type==="hidden"){var ee=H.name==null?null:""+H.name;if(H.type==="hidden"&&d.getAttribute("name")===ee)return d}else return d;if(d=ju(d.nextSibling),d===null)break}return null}function Uy(d,_,A){if(_==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!A||(d=ju(d.nextSibling),d===null))return null;return d}function Kp(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function Fb(d,_){var A=d.ownerDocument;if(d.data!=="$?"||A.readyState==="complete")_();else{var k=function(){_(),A.removeEventListener("DOMContentLoaded",k)};A.addEventListener("DOMContentLoaded",k),d._reactRetry=k}}function ju(d){for(;d!=null;d=d.nextSibling){var _=d.nodeType;if(_===1||_===3)break;if(_===8){if(_=d.data,_==="$"||_==="$!"||_==="$?"||_==="F!"||_==="F")break;if(_==="/$")return null}}return d}var Jp=null;function Vy(d){d=d.previousSibling;for(var _=0;d;){if(d.nodeType===8){var A=d.data;if(A==="$"||A==="$!"||A==="$?"){if(_===0)return d;_--}else A==="/$"&&_++}d=d.previousSibling}return null}function m_(d,_,A){switch(_=Ny(A),d){case"html":if(d=_.documentElement,!d)throw Error(s(452));return d;case"head":if(d=_.head,!d)throw Error(s(453));return d;case"body":if(d=_.body,!d)throw Error(s(454));return d;default:throw Error(s(451))}}function g_(d){for(var _=d.attributes;_.length;)d.removeAttributeNode(_[0]);lt(d)}var iu=new Map,$y=new Set;function Qm(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var rd=Bt.d;Bt.d={f:Qp,r:P2,D:Ub,C:Vb,L:qy,m:C2,X:b0,S:M2,M:$b};function Qp(){var d=rd.f(),_=ed();return d||_}function P2(d){var _=ht(d);_!==null&&_.tag===5&&_.type==="form"?Yh(_):rd.r(d)}var Qs=typeof document>"u"?null:document;function x0(d,_,A){var k=Qs;if(k&&typeof _=="string"&&_){var H=So(_);H='link[rel="'+d+'"][href="'+H+'"]',typeof A=="string"&&(H+='[crossorigin="'+A+'"]'),$y.has(H)||($y.add(H),d={rel:d,crossOrigin:A,href:_},k.querySelector(H)===null&&(_=k.createElement("link"),fl(_,"link",d),_n(_),k.head.appendChild(_)))}}function Ub(d){rd.D(d),x0("dns-prefetch",d,null)}function Vb(d,_){rd.C(d,_),x0("preconnect",d,_)}function qy(d,_,A){rd.L(d,_,A);var k=Qs;if(k&&d&&_){var H='link[rel="preload"][as="'+So(_)+'"]';_==="image"&&A&&A.imageSrcSet?(H+='[imagesrcset="'+So(A.imageSrcSet)+'"]',typeof A.imageSizes=="string"&&(H+='[imagesizes="'+So(A.imageSizes)+'"]')):H+='[href="'+So(d)+'"]';var ee=H;switch(_){case"style":ee=Xf(d);break;case"script":ee=em(d)}iu.has(ee)||(d=I({rel:"preload",href:_==="image"&&A&&A.imageSrcSet?void 0:d,as:_},A),iu.set(ee,d),k.querySelector(H)!==null||_==="style"&&k.querySelector(eg(ee))||_==="script"&&k.querySelector(tm(ee))||(_=k.createElement("link"),fl(_,"link",d),_n(_),k.head.appendChild(_)))}}function C2(d,_){rd.m(d,_);var A=Qs;if(A&&d){var k=_&&typeof _.as=="string"?_.as:"script",H='link[rel="modulepreload"][as="'+So(k)+'"][href="'+So(d)+'"]',ee=H;switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ee=em(d)}if(!iu.has(ee)&&(d=I({rel:"modulepreload",href:d},_),iu.set(ee,d),A.querySelector(H)===null)){switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(A.querySelector(tm(ee)))return}k=A.createElement("link"),fl(k,"link",d),_n(k),A.head.appendChild(k)}}}function M2(d,_,A){rd.S(d,_,A);var k=Qs;if(k&&d){var H=vn(k).hoistableStyles,ee=Xf(d);_=_||"default";var Ae=H.get(ee);if(!Ae){var He={loading:0,preload:null};if(Ae=k.querySelector(eg(ee)))He.loading=5;else{d=I({rel:"stylesheet",href:d,"data-precedence":_},A),(A=iu.get(ee))&&T0(d,A);var vt=Ae=k.createElement("link");_n(vt),fl(vt,"link",d),vt._p=new Promise(function(Qt,Mn){vt.onload=Qt,vt.onerror=Mn}),vt.addEventListener("load",function(){He.loading|=1}),vt.addEventListener("error",function(){He.loading|=2}),He.loading|=4,__(Ae,_,k)}Ae={type:"stylesheet",instance:Ae,count:1,state:He},H.set(ee,Ae)}}}function b0(d,_){rd.X(d,_);var A=Qs;if(A&&d){var k=vn(A).hoistableScripts,H=em(d),ee=k.get(H);ee||(ee=A.querySelector(tm(H)),ee||(d=I({src:d,async:!0},_),(_=iu.get(H))&&S0(d,_),ee=A.createElement("script"),_n(ee),fl(ee,"link",d),A.head.appendChild(ee)),ee={type:"script",instance:ee,count:1,state:null},k.set(H,ee))}}function $b(d,_){rd.M(d,_);var A=Qs;if(A&&d){var k=vn(A).hoistableScripts,H=em(d),ee=k.get(H);ee||(ee=A.querySelector(tm(H)),ee||(d=I({src:d,async:!0,type:"module"},_),(_=iu.get(H))&&S0(d,_),ee=A.createElement("script"),_n(ee),fl(ee,"link",d),A.head.appendChild(ee)),ee={type:"script",instance:ee,count:1,state:null},k.set(H,ee))}}function Hy(d,_,A,k){var H=(H=kt.current)?Qm(H):null;if(!H)throw Error(s(446));switch(d){case"meta":case"title":return null;case"style":return typeof A.precedence=="string"&&typeof A.href=="string"?(_=Xf(A.href),A=vn(H).hoistableStyles,k=A.get(_),k||(k={type:"style",instance:null,count:0,state:null},A.set(_,k)),k):{type:"void",instance:null,count:0,state:null};case"link":if(A.rel==="stylesheet"&&typeof A.href=="string"&&typeof A.precedence=="string"){d=Xf(A.href);var ee=vn(H).hoistableStyles,Ae=ee.get(d);if(Ae||(H=H.ownerDocument||H,Ae={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ee.set(d,Ae),(ee=H.querySelector(eg(d)))&&!ee._p&&(Ae.instance=ee,Ae.state.loading=5),iu.has(d)||(A={rel:"preload",as:"style",href:A.href,crossOrigin:A.crossOrigin,integrity:A.integrity,media:A.media,hrefLang:A.hrefLang,referrerPolicy:A.referrerPolicy},iu.set(d,A),ee||qb(H,d,A,Ae.state))),_&&k===null)throw Error(s(528,""));return Ae}if(_&&k!==null)throw Error(s(529,""));return null;case"script":return _=A.async,A=A.src,typeof A=="string"&&_&&typeof _!="function"&&typeof _!="symbol"?(_=em(A),A=vn(H).hoistableScripts,k=A.get(_),k||(k={type:"script",instance:null,count:0,state:null},A.set(_,k)),k):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,d))}}function Xf(d){return'href="'+So(d)+'"'}function eg(d){return'link[rel="stylesheet"]['+d+"]"}function w0(d){return I({},d,{"data-precedence":d.precedence,precedence:null})}function qb(d,_,A,k){d.querySelector('link[rel="preload"][as="style"]['+_+"]")?k.loading=1:(_=d.createElement("link"),k.preload=_,_.addEventListener("load",function(){return k.loading|=1}),_.addEventListener("error",function(){return k.loading|=2}),fl(_,"link",A),_n(_),d.head.appendChild(_))}function em(d){return'[src="'+So(d)+'"]'}function tm(d){return"script[async]"+d}function hh(d,_,A){if(_.count++,_.instance===null)switch(_.type){case"style":var k=d.querySelector('style[data-href~="'+So(A.href)+'"]');if(k)return _.instance=k,_n(k),k;var H=I({},A,{"data-href":A.href,"data-precedence":A.precedence,href:null,precedence:null});return k=(d.ownerDocument||d).createElement("style"),_n(k),fl(k,"style",H),__(k,A.precedence,d),_.instance=k;case"stylesheet":H=Xf(A.href);var ee=d.querySelector(eg(H));if(ee)return _.state.loading|=4,_.instance=ee,_n(ee),ee;k=w0(A),(H=iu.get(H))&&T0(k,H),ee=(d.ownerDocument||d).createElement("link"),_n(ee);var Ae=ee;return Ae._p=new Promise(function(He,vt){Ae.onload=He,Ae.onerror=vt}),fl(ee,"link",k),_.state.loading|=4,__(ee,A.precedence,d),_.instance=ee;case"script":return ee=em(A.src),(H=d.querySelector(tm(ee)))?(_.instance=H,_n(H),H):(k=A,(H=iu.get(ee))&&(k=I({},A),S0(k,H)),d=d.ownerDocument||d,H=d.createElement("script"),_n(H),fl(H,"link",k),d.head.appendChild(H),_.instance=H);case"void":return null;default:throw Error(s(443,_.type))}else _.type==="stylesheet"&&(_.state.loading&4)===0&&(k=_.instance,_.state.loading|=4,__(k,A.precedence,d));return _.instance}function __(d,_,A){for(var k=A.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),H=k.length?k[k.length-1]:null,ee=H,Ae=0;Ae<k.length;Ae++){var He=k[Ae];if(He.dataset.precedence===_)ee=He;else if(ee!==H)break}ee?ee.parentNode.insertBefore(d,ee.nextSibling):(_=A.nodeType===9?A.head:A,_.insertBefore(d,_.firstChild))}function T0(d,_){d.crossOrigin==null&&(d.crossOrigin=_.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=_.referrerPolicy),d.title==null&&(d.title=_.title)}function S0(d,_){d.crossOrigin==null&&(d.crossOrigin=_.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=_.referrerPolicy),d.integrity==null&&(d.integrity=_.integrity)}var Gy=null;function Hb(d,_,A){if(Gy===null){var k=new Map,H=Gy=new Map;H.set(A,k)}else H=Gy,k=H.get(A),k||(k=new Map,H.set(A,k));if(k.has(d))return k;for(k.set(d,null),A=A.getElementsByTagName(d),H=0;H<A.length;H++){var ee=A[H];if(!(ee[Xe]||ee[ae]||d==="link"&&ee.getAttribute("rel")==="stylesheet")&&ee.namespaceURI!=="http://www.w3.org/2000/svg"){var Ae=ee.getAttribute(_)||"";Ae=d+Ae;var He=k.get(Ae);He?He.push(ee):k.set(Ae,[ee])}}return k}function Gb(d,_,A){d=d.ownerDocument||d,d.head.insertBefore(A,_==="title"?d.querySelector("head > title"):null)}function O2(d,_,A){if(A===1||_.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof _.precedence!="string"||typeof _.href!="string"||_.href==="")break;return!0;case"link":if(typeof _.rel!="string"||typeof _.href!="string"||_.href===""||_.onLoad||_.onError)break;switch(_.rel){case"stylesheet":return d=_.disabled,typeof _.precedence=="string"&&d==null;default:return!0}case"script":if(_.async&&typeof _.async!="function"&&typeof _.async!="symbol"&&!_.onLoad&&!_.onError&&_.src&&typeof _.src=="string")return!0}return!1}function Zb(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Yf=null;function Wb(){}function Zy(d,_,A){if(Yf===null)throw Error(s(475));var k=Yf;if(_.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(_.state.loading&4)===0){if(_.instance===null){var H=Xf(A.href),ee=d.querySelector(eg(H));if(ee){d=ee._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(k.count++,k=tg.bind(k),d.then(k,k)),_.state.loading|=4,_.instance=ee,_n(ee);return}ee=d.ownerDocument||d,A=w0(A),(H=iu.get(H))&&T0(A,H),ee=ee.createElement("link"),_n(ee);var Ae=ee;Ae._p=new Promise(function(He,vt){Ae.onload=He,Ae.onerror=vt}),fl(ee,"link",A),_.instance=ee}k.stylesheets===null&&(k.stylesheets=new Map),k.stylesheets.set(_,d),(d=_.state.preload)&&(_.state.loading&3)===0&&(k.count++,_=tg.bind(k),d.addEventListener("load",_),d.addEventListener("error",_))}}function Xb(){if(Yf===null)throw Error(s(475));var d=Yf;return d.stylesheets&&d.count===0&&Wy(d,d.stylesheets),0<d.count?function(_){var A=setTimeout(function(){if(d.stylesheets&&Wy(d,d.stylesheets),d.unsuspend){var k=d.unsuspend;d.unsuspend=null,k()}},6e4);return d.unsuspend=_,function(){d.unsuspend=null,clearTimeout(A)}}:null}function tg(){if(this.count--,this.count===0){if(this.stylesheets)Wy(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var ng=null;function Wy(d,_){d.stylesheets=null,d.unsuspend!==null&&(d.count++,ng=new Map,_.forEach(I2,d),ng=null,tg.call(d))}function I2(d,_){if(!(_.state.loading&4)){var A=ng.get(d);if(A)var k=A.get(null);else{A=new Map,ng.set(d,A);for(var H=d.querySelectorAll("link[data-precedence],style[data-precedence]"),ee=0;ee<H.length;ee++){var Ae=H[ee];(Ae.nodeName==="LINK"||Ae.getAttribute("media")!=="not all")&&(A.set(Ae.dataset.precedence,Ae),k=Ae)}k&&A.set(null,k)}H=_.instance,Ae=H.getAttribute("data-precedence"),ee=A.get(Ae)||k,ee===k&&A.set(null,H),A.set(Ae,H),this.count++,k=tg.bind(this),H.addEventListener("load",k),H.addEventListener("error",k),ee?ee.parentNode.insertBefore(H,ee.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(H,d.firstChild)),_.state.loading|=4}}var ig={$$typeof:ue,Provider:null,Consumer:null,_currentValue:Vt,_currentValue2:Vt,_threadCount:0};function Yb(d,_,A,k,H,ee,Ae,He){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ta(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ta(0),this.hiddenUpdates=ta(null),this.identifierPrefix=k,this.onUncaughtError=H,this.onCaughtError=ee,this.onRecoverableError=Ae,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=He,this.incompleteTransitions=new Map}function E0(d,_,A,k,H,ee,Ae,He,vt,Qt,Mn,$n){return d=new Yb(d,_,A,Ae,He,vt,Qt,$n),_=1,ee===!0&&(_|=24),ee=El(3,null,null,_),d.current=ee,ee.stateNode=d,_=Tf(),_.refCount++,d.pooledCache=_,_.refCount++,ee.memoizedState={element:k,isDehydrated:A,cache:_},Am(ee),d}function A0(d){return d?(d=kl,d):kl}function Xy(d,_,A,k,H,ee){H=A0(H),k.context===null?k.context=H:k.pendingContext=H,k=Bl(_),k.payload={element:A},ee=ee===void 0?null:ee,ee!==null&&(k.callback=ee),A=rh(d,k,_),A!==null&&(ps(A,d,_),mc(A,d,_))}function P0(d,_){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var A=d.retryLane;d.retryLane=A!==0&&A<_?A:_}}function y_(d,_){P0(d,_),(d=d.alternate)&&P0(d,_)}function Kb(d){if(d.tag===13){var _=Gc(d,67108864);_!==null&&ps(_,d,67108864),y_(d,67108864)}}var Yy=!0;function D2(d,_,A,k){var H=rt.T;rt.T=null;var ee=Bt.p;try{Bt.p=2,Ky(d,_,A,k)}finally{Bt.p=ee,rt.T=H}}function R2(d,_,A,k){var H=rt.T;rt.T=null;var ee=Bt.p;try{Bt.p=8,Ky(d,_,A,k)}finally{Bt.p=ee,rt.T=H}}function Ky(d,_,A,k){if(Yy){var H=od(k);if(H===null)zy(d,_,k,Kf,A),b_(d,k);else if(L2(H,d,_,A,k))k.stopPropagation();else if(b_(d,k),_&4&&-1<Jb.indexOf(d)){for(;H!==null;){var ee=ht(H);if(ee!==null)switch(ee.tag){case 3:if(ee=ee.stateNode,ee.current.memoizedState.isDehydrated){var Ae=ea(ee.pendingLanes);if(Ae!==0){var He=ee;for(He.pendingLanes|=2,He.entangledLanes|=2;Ae;){var vt=1<<31-Po(Ae);He.entanglements[1]|=vt,Ae&=~vt}uh(ee),(Rn&6)===0&&(Fr=kr()+500,Wf(0))}}break;case 13:He=Gc(ee,2),He!==null&&ps(He,ee,2),ed(),y_(ee,2)}if(ee=od(k),ee===null&&zy(d,_,k,Kf,A),ee===H)break;H=ee}H!==null&&k.stopPropagation()}else zy(d,_,k,null,A)}}function od(d){return d=Vn(d),nm(d)}var Kf=null;function nm(d){if(Kf=null,d=gt(d),d!==null){var _=y(d);if(_===null)d=null;else{var A=_.tag;if(A===13){if(d=T(_),d!==null)return d;d=null}else if(A===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;d=null}else _!==d&&(d=null)}}return Kf=d,null}function v_(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ja()){case Xr:return 2;case Yr:return 8;case go:case _a:return 32;case ya:return 268435456;default:return 32}default:return 32}}var im=!1,nf=null,rf=null,of=null,rg=new Map,x_=new Map,Jf=[],Jb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b_(d,_){switch(d){case"focusin":case"focusout":nf=null;break;case"dragenter":case"dragleave":rf=null;break;case"mouseover":case"mouseout":of=null;break;case"pointerover":case"pointerout":rg.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":x_.delete(_.pointerId)}}function og(d,_,A,k,H,ee){return d===null||d.nativeEvent!==ee?(d={blockedOn:_,domEventName:A,eventSystemFlags:k,nativeEvent:ee,targetContainers:[H]},_!==null&&(_=ht(_),_!==null&&Kb(_)),d):(d.eventSystemFlags|=k,_=d.targetContainers,H!==null&&_.indexOf(H)===-1&&_.push(H),d)}function L2(d,_,A,k,H){switch(_){case"focusin":return nf=og(nf,d,_,A,k,H),!0;case"dragenter":return rf=og(rf,d,_,A,k,H),!0;case"mouseover":return of=og(of,d,_,A,k,H),!0;case"pointerover":var ee=H.pointerId;return rg.set(ee,og(rg.get(ee)||null,d,_,A,k,H)),!0;case"gotpointercapture":return ee=H.pointerId,x_.set(ee,og(x_.get(ee)||null,d,_,A,k,H)),!0}return!1}function C0(d){var _=gt(d.target);if(_!==null){var A=y(_);if(A!==null){if(_=A.tag,_===13){if(_=T(A),_!==null){d.blockedOn=_,Tt(d.priority,function(){if(A.tag===13){var k=fs();k=vs(k);var H=Gc(A,k);H!==null&&ps(H,A,k),y_(A,k)}});return}}else if(_===3&&A.stateNode.current.memoizedState.isDehydrated){d.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}d.blockedOn=null}function ag(d){if(d.blockedOn!==null)return!1;for(var _=d.targetContainers;0<_.length;){var A=od(d.nativeEvent);if(A===null){A=d.nativeEvent;var k=new A.constructor(A.type,A);en=k,A.target.dispatchEvent(k),en=null}else return _=ht(A),_!==null&&Kb(_),d.blockedOn=A,!1;_.shift()}return!0}function M0(d,_,A){ag(d)&&A.delete(_)}function Qb(){im=!1,nf!==null&&ag(nf)&&(nf=null),rf!==null&&ag(rf)&&(rf=null),of!==null&&ag(of)&&(of=null),rg.forEach(M0),x_.forEach(M0)}function w_(d,_){d.blockedOn===_&&(d.blockedOn=null,im||(im=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Qb)))}var T_=null;function O0(d){T_!==d&&(T_=d,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){T_===d&&(T_=null);for(var _=0;_<d.length;_+=3){var A=d[_],k=d[_+1],H=d[_+2];if(typeof k!="function"){if(nm(k||A)===null)continue;break}var ee=ht(A);ee!==null&&(d.splice(_,3),_-=3,Lf(ee,{pending:!0,data:H,method:A.method,action:k},k,H))}}))}function S_(d){function _(vt){return w_(vt,d)}nf!==null&&w_(nf,d),rf!==null&&w_(rf,d),of!==null&&w_(of,d),rg.forEach(_),x_.forEach(_);for(var A=0;A<Jf.length;A++){var k=Jf[A];k.blockedOn===d&&(k.blockedOn=null)}for(;0<Jf.length&&(A=Jf[0],A.blockedOn===null);)C0(A),A.blockedOn===null&&Jf.shift();if(A=(d.ownerDocument||d).$$reactFormReplay,A!=null)for(k=0;k<A.length;k+=3){var H=A[k],ee=A[k+1],Ae=H[ge]||null;if(typeof ee=="function")Ae||O0(A);else if(Ae){var He=null;if(ee&&ee.hasAttribute("formAction")){if(H=ee,Ae=ee[ge]||null)He=Ae.formAction;else if(nm(H)!==null)continue}else He=Ae.action;typeof He=="function"?A[k+1]=He:(A.splice(k,3),k-=3),O0(A)}}}function Jy(d){this._internalRoot=d}E_.prototype.render=Jy.prototype.render=function(d){var _=this._internalRoot;if(_===null)throw Error(s(409));var A=_.current,k=fs();Xy(A,k,d,_,null,null)},E_.prototype.unmount=Jy.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var _=d.containerInfo;Xy(d.current,2,null,d,null,null),ed(),_[Ee]=null}};function E_(d){this._internalRoot=d}E_.prototype.unstable_scheduleHydration=function(d){if(d){var _=bt();d={blockedOn:null,target:d,priority:_};for(var A=0;A<Jf.length&&_!==0&&_<Jf[A].priority;A++);Jf.splice(A,0,d),A===0&&C0(d)}};var Qf=t.version;if(Qf!=="19.1.0")throw Error(s(527,Qf,"19.1.0"));Bt.findDOMNode=function(d){var _=d._reactInternals;if(_===void 0)throw typeof d.render=="function"?Error(s(188)):(d=Object.keys(d).join(","),Error(s(268,d)));return d=C(_),d=d!==null?M(d):null,d=d===null?null:d.stateNode,d};var ew={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:rt,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var A_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!A_.isDisabled&&A_.supportsFiber)try{Ho=A_.inject(ew),Ar=A_}catch{}}return Q0.createRoot=function(d,_){if(!f(d))throw Error(s(299));var A=!1,k="",H=Nm,ee=Ff,Ae=Kd,He=null;return _!=null&&(_.unstable_strictMode===!0&&(A=!0),_.identifierPrefix!==void 0&&(k=_.identifierPrefix),_.onUncaughtError!==void 0&&(H=_.onUncaughtError),_.onCaughtError!==void 0&&(ee=_.onCaughtError),_.onRecoverableError!==void 0&&(Ae=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(He=_.unstable_transitionCallbacks)),_=E0(d,1,!1,null,null,A,k,H,ee,Ae,He,null),d[Ee]=_.current,Ly(d),new Jy(_)},Q0.hydrateRoot=function(d,_,A){if(!f(d))throw Error(s(299));var k=!1,H="",ee=Nm,Ae=Ff,He=Kd,vt=null,Qt=null;return A!=null&&(A.unstable_strictMode===!0&&(k=!0),A.identifierPrefix!==void 0&&(H=A.identifierPrefix),A.onUncaughtError!==void 0&&(ee=A.onUncaughtError),A.onCaughtError!==void 0&&(Ae=A.onCaughtError),A.onRecoverableError!==void 0&&(He=A.onRecoverableError),A.unstable_transitionCallbacks!==void 0&&(vt=A.unstable_transitionCallbacks),A.formState!==void 0&&(Qt=A.formState)),_=E0(d,1,!0,_,A??null,k,H,ee,Ae,He,vt,Qt),_.context=A0(null),A=_.current,k=fs(),k=vs(k),H=Bl(k),H.callback=null,rh(A,H,k),A=k,_.current.lanes=A,al(_,A),uh(_),d[Ee]=_.current,Ly(d),new E_(_)},Q0.version="19.1.0",Q0}var jR;function _H(){if(jR)return CS.exports;jR=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),CS.exports=gH(),CS.exports}var yH=_H();const vH=Zu(yH);var ex={},FR;function xH(){if(FR)return ex;FR=1,Object.defineProperty(ex,"__esModule",{value:!0}),ex.parse=T,ex.serialize=M;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,f=Object.prototype.toString,y=(()=>{const q=function(){};return q.prototype=Object.create(null),q})();function T(q,K){const J=new y,te=q.length;if(te<2)return J;const oe=K?.decode||I;let ce=0;do{const de=q.indexOf("=",ce);if(de===-1)break;const ue=q.indexOf(";",ce),Pe=ue===-1?te:ue;if(de>Pe){ce=q.lastIndexOf(";",de-1)+1;continue}const Oe=o(q,ce,de),xe=C(q,de,Oe),Qe=q.slice(Oe,xe);if(J[Qe]===void 0){let tt=o(q,de+1,Pe),Ge=C(q,Pe,tt);const Je=oe(q.slice(tt,Ge));J[Qe]=Je}ce=Pe+1}while(ce<te);return J}function o(q,K,J){do{const te=q.charCodeAt(K);if(te!==32&&te!==9)return K}while(++K<J);return J}function C(q,K,J){for(;K>J;){const te=q.charCodeAt(--K);if(te!==32&&te!==9)return K+1}return J}function M(q,K,J){const te=J?.encode||encodeURIComponent;if(!e.test(q))throw new TypeError(`argument name is invalid: ${q}`);const oe=te(K);if(!t.test(oe))throw new TypeError(`argument val is invalid: ${K}`);let ce=q+"="+oe;if(!J)return ce;if(J.maxAge!==void 0){if(!Number.isInteger(J.maxAge))throw new TypeError(`option maxAge is invalid: ${J.maxAge}`);ce+="; Max-Age="+J.maxAge}if(J.domain){if(!i.test(J.domain))throw new TypeError(`option domain is invalid: ${J.domain}`);ce+="; Domain="+J.domain}if(J.path){if(!s.test(J.path))throw new TypeError(`option path is invalid: ${J.path}`);ce+="; Path="+J.path}if(J.expires){if(!j(J.expires)||!Number.isFinite(J.expires.valueOf()))throw new TypeError(`option expires is invalid: ${J.expires}`);ce+="; Expires="+J.expires.toUTCString()}if(J.httpOnly&&(ce+="; HttpOnly"),J.secure&&(ce+="; Secure"),J.partitioned&&(ce+="; Partitioned"),J.priority)switch(typeof J.priority=="string"?J.priority.toLowerCase():void 0){case"low":ce+="; Priority=Low";break;case"medium":ce+="; Priority=Medium";break;case"high":ce+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${J.priority}`)}if(J.sameSite)switch(typeof J.sameSite=="string"?J.sameSite.toLowerCase():J.sameSite){case!0:case"strict":ce+="; SameSite=Strict";break;case"lax":ce+="; SameSite=Lax";break;case"none":ce+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${J.sameSite}`)}return ce}function I(q){if(q.indexOf("%")===-1)return q;try{return decodeURIComponent(q)}catch{return q}}function j(q){return f.call(q)==="[object Date]"}return ex}xH();/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var KB=e=>{throw TypeError(e)},bH=(e,t,i)=>t.has(e)||KB("Cannot "+i),DS=(e,t,i)=>(bH(e,t,"read from private field"),i?i.call(e):t.get(e)),wH=(e,t,i)=>t.has(e)?KB("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),UR="popstate";function TH(e={}){function t(s,f){let{pathname:y,search:T,hash:o}=s.location;return Px("",{pathname:y,search:T,hash:o},f.state&&f.state.usr||null,f.state&&f.state.key||"default")}function i(s,f){return typeof f=="string"?f:Ag(f)}return EH(t,i,null,e)}function To(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yl(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function SH(){return Math.random().toString(36).substring(2,10)}function VR(e,t){return{usr:e.state,key:e.key,idx:t}}function Px(e,t,i=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Og(t):t,state:i,key:t&&t.key||s||SH()}}function Ag({pathname:e="/",search:t="",hash:i=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Og(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substring(i),e=e.substring(0,i));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function EH(e,t,i,s={}){let{window:f=document.defaultView,v5Compat:y=!1}=s,T=f.history,o="POP",C=null,M=I();M==null&&(M=0,T.replaceState({...T.state,idx:M},""));function I(){return(T.state||{idx:null}).idx}function j(){o="POP";let oe=I(),ce=oe==null?null:oe-M;M=oe,C&&C({action:o,location:te.location,delta:ce})}function q(oe,ce){o="PUSH";let de=Px(te.location,oe,ce);M=I()+1;let ue=VR(de,M),Pe=te.createHref(de);try{T.pushState(ue,"",Pe)}catch(Oe){if(Oe instanceof DOMException&&Oe.name==="DataCloneError")throw Oe;f.location.assign(Pe)}y&&C&&C({action:o,location:te.location,delta:1})}function K(oe,ce){o="REPLACE";let de=Px(te.location,oe,ce);M=I();let ue=VR(de,M),Pe=te.createHref(de);T.replaceState(ue,"",Pe),y&&C&&C({action:o,location:te.location,delta:0})}function J(oe){return JB(oe)}let te={get action(){return o},get location(){return e(f,T)},listen(oe){if(C)throw new Error("A history only accepts one active listener");return f.addEventListener(UR,j),C=oe,()=>{f.removeEventListener(UR,j),C=null}},createHref(oe){return t(f,oe)},createURL:J,encodeLocation(oe){let ce=J(oe);return{pathname:ce.pathname,search:ce.search,hash:ce.hash}},push:q,replace:K,go(oe){return T.go(oe)}};return te}function JB(e,t=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),To(i,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:Ag(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=i+s),new URL(s,i)}var px,$R=class{constructor(e){if(wH(this,px,new Map),e)for(let[t,i]of e)this.set(t,i)}get(e){if(DS(this,px).has(e))return DS(this,px).get(e);if(e.defaultValue!==void 0)return e.defaultValue;throw new Error("No value found for context")}set(e,t){DS(this,px).set(e,t)}};px=new WeakMap;var AH=new Set(["lazy","caseSensitive","path","id","index","children"]);function PH(e){return AH.has(e)}var CH=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function MH(e){return CH.has(e)}function OH(e){return e.index===!0}function g1(e,t,i=[],s={}){return e.map((f,y)=>{let T=[...i,String(y)],o=typeof f.id=="string"?f.id:T.join("-");if(To(f.index!==!0||!f.children,"Cannot specify children on an index route"),To(!s[o],`Found a route id collision on id "${o}".  Route id's must be globally unique within Data Router usages`),OH(f)){let C={...f,...t(f),id:o};return s[o]=C,C}else{let C={...f,...t(f),id:o,children:void 0};return s[o]=C,f.children&&(C.children=g1(f.children,t,T,s)),C}})}function yg(e,t,i="/"){return i1(e,t,i,!1)}function i1(e,t,i,s){let f=typeof t=="string"?Og(t):t,y=xd(f.pathname||"/",i);if(y==null)return null;let T=QB(e);DH(T);let o=null;for(let C=0;o==null&&C<T.length;++C){let M=$H(y);o=UH(T[C],M,s)}return o}function IH(e,t){let{route:i,pathname:s,params:f}=e;return{id:i.id,pathname:s,params:f,data:t[i.id],handle:i.handle}}function QB(e,t=[],i=[],s=""){let f=(y,T,o)=>{let C={relativePath:o===void 0?y.path||"":o,caseSensitive:y.caseSensitive===!0,childrenIndex:T,route:y};C.relativePath.startsWith("/")&&(To(C.relativePath.startsWith(s),`Absolute route path "${C.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),C.relativePath=C.relativePath.slice(s.length));let M=op([s,C.relativePath]),I=i.concat(C);y.children&&y.children.length>0&&(To(y.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${M}".`),QB(y.children,t,I,M)),!(y.path==null&&!y.index)&&t.push({path:M,score:jH(M,y.index),routesMeta:I})};return e.forEach((y,T)=>{if(y.path===""||!y.path?.includes("?"))f(y,T);else for(let o of ej(y.path))f(y,T,o)}),t}function ej(e){let t=e.split("/");if(t.length===0)return[];let[i,...s]=t,f=i.endsWith("?"),y=i.replace(/\?$/,"");if(s.length===0)return f?[y,""]:[y];let T=ej(s.join("/")),o=[];return o.push(...T.map(C=>C===""?y:[y,C].join("/"))),f&&o.push(...T),o.map(C=>e.startsWith("/")&&C===""?"/":C)}function DH(e){e.sort((t,i)=>t.score!==i.score?i.score-t.score:FH(t.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var RH=/^:[\w-]+$/,LH=3,zH=2,kH=1,NH=10,BH=-2,qR=e=>e==="*";function jH(e,t){let i=e.split("/"),s=i.length;return i.some(qR)&&(s+=BH),t&&(s+=zH),i.filter(f=>!qR(f)).reduce((f,y)=>f+(RH.test(y)?LH:y===""?kH:NH),s)}function FH(e,t){return e.length===t.length&&e.slice(0,-1).every((s,f)=>s===t[f])?e[e.length-1]-t[t.length-1]:0}function UH(e,t,i=!1){let{routesMeta:s}=e,f={},y="/",T=[];for(let o=0;o<s.length;++o){let C=s[o],M=o===s.length-1,I=y==="/"?t:t.slice(y.length)||"/",j=_1({path:C.relativePath,caseSensitive:C.caseSensitive,end:M},I),q=C.route;if(!j&&M&&i&&!s[s.length-1].route.index&&(j=_1({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},I)),!j)return null;Object.assign(f,j.params),T.push({params:f,pathname:op([y,j.pathname]),pathnameBase:GH(op([y,j.pathnameBase])),route:q}),j.pathnameBase!=="/"&&(y=op([y,j.pathnameBase]))}return T}function _1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[i,s]=VH(e.path,e.caseSensitive,e.end),f=t.match(i);if(!f)return null;let y=f[0],T=y.replace(/(.)\/+$/,"$1"),o=f.slice(1);return{params:s.reduce((M,{paramName:I,isOptional:j},q)=>{if(I==="*"){let J=o[q]||"";T=y.slice(0,y.length-J.length).replace(/(.)\/+$/,"$1")}const K=o[q];return j&&!K?M[I]=void 0:M[I]=(K||"").replace(/%2F/g,"/"),M},{}),pathname:y,pathnameBase:T,pattern:e}}function VH(e,t=!1,i=!0){yl(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],f="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(T,o,C)=>(s.push({paramName:o,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),f+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?f+="\\/*$":e!==""&&e!=="/"&&(f+="(?:(?=\\/|$))"),[new RegExp(f,t?void 0:"i"),s]}function $H(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yl(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function xd(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,s=e.charAt(i);return s&&s!=="/"?null:e.slice(i)||"/"}function qH(e,t="/"){let{pathname:i,search:s="",hash:f=""}=typeof e=="string"?Og(e):e;return{pathname:i?i.startsWith("/")?i:HH(i,t):t,search:ZH(s),hash:WH(f)}}function HH(e,t){let i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(f=>{f===".."?i.length>1&&i.pop():f!=="."&&i.push(f)}),i.length>1?i.join("/"):"/"}function RS(e,t,i,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tj(e){return e.filter((t,i)=>i===0||t.route.path&&t.route.path.length>0)}function uC(e){let t=tj(e);return t.map((i,s)=>s===t.length-1?i.pathname:i.pathnameBase)}function hC(e,t,i,s=!1){let f;typeof e=="string"?f=Og(e):(f={...e},To(!f.pathname||!f.pathname.includes("?"),RS("?","pathname","search",f)),To(!f.pathname||!f.pathname.includes("#"),RS("#","pathname","hash",f)),To(!f.search||!f.search.includes("#"),RS("#","search","hash",f)));let y=e===""||f.pathname==="",T=y?"/":f.pathname,o;if(T==null)o=i;else{let j=t.length-1;if(!s&&T.startsWith("..")){let q=T.split("/");for(;q[0]==="..";)q.shift(),j-=1;f.pathname=q.join("/")}o=j>=0?t[j]:"/"}let C=qH(f,o),M=T&&T!=="/"&&T.endsWith("/"),I=(y||T===".")&&i.endsWith("/");return!C.pathname.endsWith("/")&&(M||I)&&(C.pathname+="/"),C}var op=e=>e.join("/").replace(/\/\/+/g,"/"),GH=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ZH=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,WH=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,y1=class{constructor(e,t,i,s=!1){this.status=e,this.statusText=t||"",this.internal=s,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}};function Cx(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var nj=["POST","PUT","PATCH","DELETE"],XH=new Set(nj),YH=["GET",...nj],KH=new Set(YH),JH=new Set([301,302,303,307,308]),QH=new Set([307,308]),LS={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},eG={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},tx={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},dC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tG=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),ij="remix-router-transitions",rj=Symbol("ResetLoaderData");function nG(e){const t=e.window?e.window:typeof window<"u"?window:void 0,i=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";To(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let s=e.hydrationRouteProperties||[],f=e.mapRouteProperties||tG,y={},T=g1(e.routes,f,void 0,y),o,C=e.basename||"/",M=e.dataStrategy||sG,I={unstable_middleware:!1,...e.future},j=null,q=new Set,K=null,J=null,te=null,oe=e.hydrationData!=null,ce=yg(T,e.history.location,C),de=!1,ue=null,Pe;if(ce==null&&!e.patchRoutesOnNavigation){let bt=md(404,{pathname:e.history.location.pathname}),{matches:Tt,route:je}=nL(T);Pe=!0,ce=Tt,ue={[je.id]:bt}}else if(ce&&!e.hydrationData&&Ca(ce,T,e.history.location.pathname).active&&(ce=null),ce)if(ce.some(bt=>bt.route.lazy))Pe=!1;else if(!ce.some(bt=>bt.route.loader))Pe=!0;else{let bt=e.hydrationData?e.hydrationData.loaderData:null,Tt=e.hydrationData?e.hydrationData.errors:null;if(Tt){let je=ce.findIndex(ae=>Tt[ae.route.id]!==void 0);Pe=ce.slice(0,je+1).every(ae=>!NA(ae.route,bt,Tt))}else Pe=ce.every(je=>!NA(je.route,bt,Tt))}else{Pe=!1,ce=[];let bt=Ca(null,T,e.history.location.pathname);bt.active&&bt.matches&&(de=!0,ce=bt.matches)}let Oe,xe={historyAction:e.history.action,location:e.history.location,matches:ce,initialized:Pe,navigation:LS,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||ue,fetchers:new Map,blockers:new Map},Qe="POP",tt=!1,Ge,Je=!1,Ve=new Map,xt=null,yt=!1,ot=!1,zt=new Set,rt=new Map,Bt=0,Vt=-1,Ln=new Map,$e=new Set,Pt=new Map,$t=new Map,on=new Set,An=new Map,ct,kt=null;function In(){if(j=e.history.listen(({action:bt,location:Tt,delta:je})=>{if(ct){ct(),ct=void 0;return}yl(An.size===0||je!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ae=tr({currentLocation:xe.location,nextLocation:Tt,historyAction:bt});if(ae&&je!=null){let ge=new Promise(Ee=>{ct=Ee});e.history.go(je*-1),Go(ae,{state:"blocked",location:Tt,proceed(){Go(ae,{state:"proceeding",proceed:void 0,reset:void 0,location:Tt}),ge.then(()=>e.history.go(je))},reset(){let Ee=new Map(xe.blockers);Ee.set(ae,tx),jn({blockers:Ee})}});return}return Ii(bt,Tt)}),i){yG(t,Ve);let bt=()=>vG(t,Ve);t.addEventListener("pagehide",bt),xt=()=>t.removeEventListener("pagehide",bt)}return xe.initialized||Ii("POP",xe.location,{initialHydration:!0}),Oe}function ti(){j&&j(),xt&&xt(),q.clear(),Ge&&Ge.abort(),xe.fetchers.forEach((bt,Tt)=>Po(Tt)),xe.blockers.forEach((bt,Tt)=>Aa(Tt))}function Dt(bt){return q.add(bt),()=>q.delete(bt)}function jn(bt,Tt={}){xe={...xe,...bt};let je=[],ae=[];xe.fetchers.forEach((ge,Ee)=>{ge.state==="idle"&&(on.has(Ee)?je.push(Ee):ae.push(Ee))}),on.forEach(ge=>{!xe.fetchers.has(ge)&&!rt.has(ge)&&je.push(ge)}),[...q].forEach(ge=>ge(xe,{deletedFetchers:je,viewTransitionOpts:Tt.viewTransitionOpts,flushSync:Tt.flushSync===!0})),je.forEach(ge=>Po(ge)),ae.forEach(ge=>xe.fetchers.delete(ge))}function ai(bt,Tt,{flushSync:je}={}){let ae=xe.actionData!=null&&xe.navigation.formMethod!=null&&_h(xe.navigation.formMethod)&&xe.navigation.state==="loading"&&bt.state?._isRedirect!==!0,ge;Tt.actionData?Object.keys(Tt.actionData).length>0?ge=Tt.actionData:ge=null:ae?ge=xe.actionData:ge=null;let Ee=Tt.loaderData?eL(xe.loaderData,Tt.loaderData,Tt.matches||[],Tt.errors):xe.loaderData,Ne=xe.blockers;Ne.size>0&&(Ne=new Map(Ne),Ne.forEach((nt,Xe)=>Ne.set(Xe,tx)));let be=tt===!0||xe.navigation.formMethod!=null&&_h(xe.navigation.formMethod)&&bt.state?._isRedirect!==!0;o&&(T=o,o=void 0),yt||Qe==="POP"||(Qe==="PUSH"?e.history.push(bt,bt.state):Qe==="REPLACE"&&e.history.replace(bt,bt.state));let We;if(Qe==="POP"){let nt=Ve.get(xe.location.pathname);nt&&nt.has(bt.pathname)?We={currentLocation:xe.location,nextLocation:bt}:Ve.has(bt.pathname)&&(We={currentLocation:bt,nextLocation:xe.location})}else if(Je){let nt=Ve.get(xe.location.pathname);nt?nt.add(bt.pathname):(nt=new Set([bt.pathname]),Ve.set(xe.location.pathname,nt)),We={currentLocation:xe.location,nextLocation:bt}}jn({...Tt,actionData:ge,loaderData:Ee,historyAction:Qe,location:bt,initialized:!0,navigation:LS,revalidation:"idle",restoreScrollPosition:ls(bt,Tt.matches||xe.matches),preventScrollReset:be,blockers:Ne},{viewTransitionOpts:We,flushSync:je===!0}),Qe="POP",tt=!1,Je=!1,yt=!1,ot=!1,kt?.resolve(),kt=null}async function mn(bt,Tt){if(typeof bt=="number"){e.history.go(bt);return}let je=kA(xe.location,xe.matches,C,bt,Tt?.fromRouteId,Tt?.relative),{path:ae,submission:ge,error:Ee}=HR(!1,je,Tt),Ne=xe.location,be=Px(xe.location,ae,Tt&&Tt.state);be={...be,...e.history.encodeLocation(be)};let We=Tt&&Tt.replace!=null?Tt.replace:void 0,nt="PUSH";We===!0?nt="REPLACE":We===!1||ge!=null&&_h(ge.formMethod)&&ge.formAction===xe.location.pathname+xe.location.search&&(nt="REPLACE");let Xe=Tt&&"preventScrollReset"in Tt?Tt.preventScrollReset===!0:void 0,lt=(Tt&&Tt.flushSync)===!0,gt=tr({currentLocation:Ne,nextLocation:be,historyAction:nt});if(gt){Go(gt,{state:"blocked",location:be,proceed(){Go(gt,{state:"proceeding",proceed:void 0,reset:void 0,location:be}),mn(bt,Tt)},reset(){let ht=new Map(xe.blockers);ht.set(gt,tx),jn({blockers:ht})}});return}await Ii(nt,be,{submission:ge,pendingError:Ee,preventScrollReset:Xe,replace:Tt&&Tt.replace,enableViewTransition:Tt&&Tt.viewTransition,flushSync:lt})}function ci(){kt||(kt=xG()),qs(),jn({revalidation:"loading"});let bt=kt.promise;return xe.navigation.state==="submitting"?bt:xe.navigation.state==="idle"?(Ii(xe.historyAction,xe.location,{startUninterruptedRevalidation:!0}),bt):(Ii(Qe||xe.historyAction,xe.navigation.location,{overrideNavigation:xe.navigation,enableViewTransition:Je===!0}),bt)}async function Ii(bt,Tt,je){Ge&&Ge.abort(),Ge=null,Qe=bt,yt=(je&&je.startUninterruptedRevalidation)===!0,al(xe.location,xe.matches),tt=(je&&je.preventScrollReset)===!0,Je=(je&&je.enableViewTransition)===!0;let ae=o||T,ge=je&&je.overrideNavigation,Ee=je?.initialHydration&&xe.matches&&xe.matches.length>0&&!de?xe.matches:yg(ae,Tt,C),Ne=(je&&je.flushSync)===!0;if(Ee&&xe.initialized&&!ot&&fG(xe.location,Tt)&&!(je&&je.submission&&_h(je.submission.formMethod))){ai(Tt,{matches:Ee},{flushSync:Ne});return}let be=Ca(Ee,ae,Tt.pathname);if(be.active&&be.matches&&(Ee=be.matches),!Ee){let{error:vn,notFoundMatches:_n,route:zn}=Pa(Tt.pathname);ai(Tt,{matches:_n,loaderData:{},errors:{[zn.id]:vn}},{flushSync:Ne});return}Ge=new AbortController;let We=dv(e.history,Tt,Ge.signal,je&&je.submission),nt=new $R(e.unstable_getContext?await e.unstable_getContext():void 0),Xe;if(je&&je.pendingError)Xe=[B_(Ee).route.id,{type:"error",error:je.pendingError}];else if(je&&je.submission&&_h(je.submission.formMethod)){let vn=await Mi(We,Tt,je.submission,Ee,nt,be.active,je&&je.initialHydration===!0,{replace:je.replace,flushSync:Ne});if(vn.shortCircuited)return;if(vn.pendingActionResult){let[_n,zn]=vn.pendingActionResult;if(gh(zn)&&Cx(zn.error)&&zn.error.status===404){Ge=null,ai(Tt,{matches:vn.matches,loaderData:{},errors:{[_n]:zn.error}});return}}Ee=vn.matches||Ee,Xe=vn.pendingActionResult,ge=zS(Tt,je.submission),Ne=!1,be.active=!1,We=dv(e.history,We.url,We.signal)}let{shortCircuited:lt,matches:gt,loaderData:ht,errors:Zt}=await Tr(We,Tt,Ee,nt,be.active,ge,je&&je.submission,je&&je.fetcherSubmission,je&&je.replace,je&&je.initialHydration===!0,Ne,Xe);lt||(Ge=null,ai(Tt,{matches:gt||Ee,...tL(Xe),loaderData:ht,errors:Zt}))}async function Mi(bt,Tt,je,ae,ge,Ee,Ne,be={}){qs();let We=gG(Tt,je);if(jn({navigation:We},{flushSync:be.flushSync===!0}),Ee){let lt=await hn(ae,Tt.pathname,bt.signal);if(lt.type==="aborted")return{shortCircuited:!0};if(lt.type==="error"){let gt=B_(lt.partialMatches).route.id;return{matches:lt.partialMatches,pendingActionResult:[gt,{type:"error",error:lt.error}]}}else if(lt.matches)ae=lt.matches;else{let{notFoundMatches:gt,error:ht,route:Zt}=Pa(Tt.pathname);return{matches:gt,pendingActionResult:[Zt.id,{type:"error",error:ht}]}}}let nt,Xe=mx(ae,Tt);if(!Xe.route.action&&!Xe.route.lazy)nt={type:"error",error:md(405,{method:bt.method,pathname:Tt.pathname,routeId:Xe.route.id})};else{let lt=xv(f,y,bt,ae,Xe,Ne?[]:s,ge),gt=await ya(bt,lt,ge,null);if(nt=gt[Xe.route.id],!nt){for(let ht of ae)if(gt[ht.route.id]){nt=gt[ht.route.id];break}}if(bt.signal.aborted)return{shortCircuited:!0}}if(j_(nt)){let lt;return be&&be.replace!=null?lt=be.replace:lt=KR(nt.response.headers.get("Location"),new URL(bt.url),C)===xe.location.pathname+xe.location.search,await _a(bt,nt,!0,{submission:je,replace:lt}),{shortCircuited:!0}}if(gh(nt)){let lt=B_(ae,Xe.route.id);return(be&&be.replace)!==!0&&(Qe="PUSH"),{matches:ae,pendingActionResult:[lt.route.id,nt,Xe.route.id]}}return{matches:ae,pendingActionResult:[Xe.route.id,nt]}}async function Tr(bt,Tt,je,ae,ge,Ee,Ne,be,We,nt,Xe,lt){let gt=Ee||zS(Tt,Ne),ht=Ne||be||rL(gt),Zt=!yt&&!nt;if(ge){if(Zt){let nr=kr(lt);jn({navigation:gt,...nr!==void 0?{actionData:nr}:{}},{flushSync:Xe})}let vi=await hn(je,Tt.pathname,bt.signal);if(vi.type==="aborted")return{shortCircuited:!0};if(vi.type==="error"){let nr=B_(vi.partialMatches).route.id;return{matches:vi.partialMatches,loaderData:{},errors:{[nr]:vi.error}}}else if(vi.matches)je=vi.matches;else{let{error:nr,notFoundMatches:rr,route:Nr}=Pa(Tt.pathname);return{matches:rr,loaderData:{},errors:{[Nr.id]:nr}}}}let vn=o||T,{dsMatches:_n,revalidatingFetchers:zn}=GR(bt,ae,f,y,e.history,xe,je,ht,Tt,nt?[]:s,nt===!0,ot,zt,on,Pt,$e,vn,C,e.patchRoutesOnNavigation!=null,lt);if(Vt=++Bt,!e.dataStrategy&&!_n.some(vi=>vi.shouldLoad)&&zn.length===0){let vi=Ua();return ai(Tt,{matches:je,loaderData:{},errors:lt&&gh(lt[1])?{[lt[0]]:lt[1].error}:null,...tL(lt),...vi?{fetchers:new Map(xe.fetchers)}:{}},{flushSync:Xe}),{shortCircuited:!0}}if(Zt){let vi={};if(!ge){vi.navigation=gt;let nr=kr(lt);nr!==void 0&&(vi.actionData=nr)}zn.length>0&&(vi.fetchers=ja(zn)),jn(vi,{flushSync:Xe})}zn.forEach(vi=>{ro(vi.key),vi.controller&&rt.set(vi.key,vi.controller)});let ii=()=>zn.forEach(vi=>ro(vi.key));Ge&&Ge.signal.addEventListener("abort",ii);let{loaderResults:si,fetcherResults:gi}=await aa(_n,zn,bt,ae);if(bt.signal.aborted)return{shortCircuited:!0};Ge&&Ge.signal.removeEventListener("abort",ii),zn.forEach(vi=>rt.delete(vi.key));let ui=kw(si);if(ui)return await _a(bt,ui.result,!0,{replace:We}),{shortCircuited:!0};if(ui=kw(gi),ui)return $e.add(ui.key),await _a(bt,ui.result,!0,{replace:We}),{shortCircuited:!0};let{loaderData:Wi,errors:_r}=QR(xe,je,si,lt,zn,gi);nt&&xe.errors&&(_r={...xe.errors,..._r});let ir=Ua(),ki=Co(Vt),Fi=ir||ki||zn.length>0;return{matches:je,loaderData:Wi,errors:_r,...Fi?{fetchers:new Map(xe.fetchers)}:{}}}function kr(bt){if(bt&&!gh(bt[1]))return{[bt[0]]:bt[1].data};if(xe.actionData)return Object.keys(xe.actionData).length===0?null:xe.actionData}function ja(bt){return bt.forEach(Tt=>{let je=xe.fetchers.get(Tt.key),ae=nx(void 0,je?je.data:void 0);xe.fetchers.set(Tt.key,ae)}),new Map(xe.fetchers)}async function Xr(bt,Tt,je,ae){ro(bt);let ge=(ae&&ae.flushSync)===!0,Ee=o||T,Ne=kA(xe.location,xe.matches,C,je,Tt,ae?.relative),be=yg(Ee,Ne,C),We=Ca(be,Ee,Ne);if(We.active&&We.matches&&(be=We.matches),!be){Ar(bt,Tt,md(404,{pathname:Ne}),{flushSync:ge});return}let{path:nt,submission:Xe,error:lt}=HR(!0,Ne,ae);if(lt){Ar(bt,Tt,lt,{flushSync:ge});return}let gt=mx(be,nt),ht=new $R(e.unstable_getContext?await e.unstable_getContext():void 0),Zt=(ae&&ae.preventScrollReset)===!0;if(Xe&&_h(Xe.formMethod)){await Yr(bt,Tt,nt,gt,be,ht,We.active,ge,Zt,Xe);return}Pt.set(bt,{routeId:Tt,path:nt}),await go(bt,Tt,nt,gt,be,ht,We.active,ge,Zt,Xe)}async function Yr(bt,Tt,je,ae,ge,Ee,Ne,be,We,nt){qs(),Pt.delete(bt);function Xe(hr){if(!hr.route.action&&!hr.route.lazy){let Xi=md(405,{method:nt.formMethod,pathname:je,routeId:Tt});return Ar(bt,Tt,Xi,{flushSync:be}),!0}return!1}if(!Ne&&Xe(ae))return;let lt=xe.fetchers.get(bt);Ho(bt,_G(nt,lt),{flushSync:be});let gt=new AbortController,ht=dv(e.history,je,gt.signal,nt);if(Ne){let hr=await hn(ge,je,ht.signal,bt);if(hr.type==="aborted")return;if(hr.type==="error"){Ar(bt,Tt,hr.error,{flushSync:be});return}else if(hr.matches){if(ge=hr.matches,ae=mx(ge,je),Xe(ae))return}else{Ar(bt,Tt,md(404,{pathname:je}),{flushSync:be});return}}rt.set(bt,gt);let Zt=Bt,vn=xv(f,y,ht,ge,ae,s,Ee),zn=(await ya(ht,vn,Ee,bt))[ae.route.id];if(ht.signal.aborted){rt.get(bt)===gt&&rt.delete(bt);return}if(on.has(bt)){if(j_(zn)||gh(zn)){Ho(bt,mg(void 0));return}}else{if(j_(zn))if(rt.delete(bt),Vt>Zt){Ho(bt,mg(void 0));return}else return $e.add(bt),Ho(bt,nx(nt)),_a(ht,zn,!1,{fetcherSubmission:nt,preventScrollReset:We});if(gh(zn)){Ar(bt,Tt,zn.error);return}}let ii=xe.navigation.location||xe.location,si=dv(e.history,ii,gt.signal),gi=o||T,ui=xe.navigation.state!=="idle"?yg(gi,xe.navigation.location,C):xe.matches;To(ui,"Didn't find any matches after fetcher action");let Wi=++Bt;Ln.set(bt,Wi);let _r=nx(nt,zn.data);xe.fetchers.set(bt,_r);let{dsMatches:ir,revalidatingFetchers:ki}=GR(si,Ee,f,y,e.history,xe,ui,nt,ii,s,!1,ot,zt,on,Pt,$e,gi,C,e.patchRoutesOnNavigation!=null,[ae.route.id,zn]);ki.filter(hr=>hr.key!==bt).forEach(hr=>{let Xi=hr.key,or=xe.fetchers.get(Xi),Lo=nx(void 0,or?or.data:void 0);xe.fetchers.set(Xi,Lo),ro(Xi),hr.controller&&rt.set(Xi,hr.controller)}),jn({fetchers:new Map(xe.fetchers)});let Fi=()=>ki.forEach(hr=>ro(hr.key));gt.signal.addEventListener("abort",Fi);let{loaderResults:vi,fetcherResults:nr}=await aa(ir,ki,si,Ee);if(gt.signal.aborted)return;if(gt.signal.removeEventListener("abort",Fi),Ln.delete(bt),rt.delete(bt),ki.forEach(hr=>rt.delete(hr.key)),xe.fetchers.has(bt)){let hr=mg(zn.data);xe.fetchers.set(bt,hr)}let rr=kw(vi);if(rr)return _a(si,rr.result,!1,{preventScrollReset:We});if(rr=kw(nr),rr)return $e.add(rr.key),_a(si,rr.result,!1,{preventScrollReset:We});let{loaderData:Nr,errors:Zo}=QR(xe,ui,vi,void 0,ki,nr);Co(Wi),xe.navigation.state==="loading"&&Wi>Vt?(To(Qe,"Expected pending action"),Ge&&Ge.abort(),ai(xe.navigation.location,{matches:ui,loaderData:Nr,errors:Zo,fetchers:new Map(xe.fetchers)})):(jn({errors:Zo,loaderData:eL(xe.loaderData,Nr,ui,Zo),fetchers:new Map(xe.fetchers)}),ot=!1)}async function go(bt,Tt,je,ae,ge,Ee,Ne,be,We,nt){let Xe=xe.fetchers.get(bt);Ho(bt,nx(nt,Xe?Xe.data:void 0),{flushSync:be});let lt=new AbortController,gt=dv(e.history,je,lt.signal);if(Ne){let zn=await hn(ge,je,gt.signal,bt);if(zn.type==="aborted")return;if(zn.type==="error"){Ar(bt,Tt,zn.error,{flushSync:be});return}else if(zn.matches)ge=zn.matches,ae=mx(ge,je);else{Ar(bt,Tt,md(404,{pathname:je}),{flushSync:be});return}}rt.set(bt,lt);let ht=Bt,Zt=xv(f,y,gt,ge,ae,s,Ee),_n=(await ya(gt,Zt,Ee,bt))[ae.route.id];if(rt.get(bt)===lt&&rt.delete(bt),!gt.signal.aborted){if(on.has(bt)){Ho(bt,mg(void 0));return}if(j_(_n))if(Vt>ht){Ho(bt,mg(void 0));return}else{$e.add(bt),await _a(gt,_n,!1,{preventScrollReset:We});return}if(gh(_n)){Ar(bt,Tt,_n.error);return}Ho(bt,mg(_n.data))}}async function _a(bt,Tt,je,{submission:ae,fetcherSubmission:ge,preventScrollReset:Ee,replace:Ne}={}){Tt.response.headers.has("X-Remix-Revalidate")&&(ot=!0);let be=Tt.response.headers.get("Location");To(be,"Expected a Location header on the redirect Response"),be=KR(be,new URL(bt.url),C);let We=Px(xe.location,be,{_isRedirect:!0});if(i){let Zt=!1;if(Tt.response.headers.has("X-Remix-Reload-Document"))Zt=!0;else if(dC.test(be)){const vn=JB(be,!0);Zt=vn.origin!==t.location.origin||xd(vn.pathname,C)==null}if(Zt){Ne?t.location.replace(be):t.location.assign(be);return}}Ge=null;let nt=Ne===!0||Tt.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Xe,formAction:lt,formEncType:gt}=xe.navigation;!ae&&!ge&&Xe&&lt&&gt&&(ae=rL(xe.navigation));let ht=ae||ge;if(QH.has(Tt.response.status)&&ht&&_h(ht.formMethod))await Ii(nt,We,{submission:{...ht,formAction:be},preventScrollReset:Ee||tt,enableViewTransition:je?Je:void 0});else{let Zt=zS(We,ae);await Ii(nt,We,{overrideNavigation:Zt,fetcherSubmission:ge,preventScrollReset:Ee||tt,enableViewTransition:je?Je:void 0})}}async function ya(bt,Tt,je,ae){let ge,Ee={};try{ge=await lG(M,bt,Tt,ae,je,!1)}catch(Ne){return Tt.filter(be=>be.shouldLoad).forEach(be=>{Ee[be.route.id]={type:"error",error:Ne}}),Ee}if(bt.signal.aborted)return Ee;for(let[Ne,be]of Object.entries(ge))if(pG(be)){let We=be.result;Ee[Ne]={type:"redirect",response:hG(We,bt,Ne,Tt,C)}}else Ee[Ne]=await uG(be);return Ee}async function aa(bt,Tt,je,ae){let ge=ya(je,bt,ae,null),Ee=Promise.all(Tt.map(async We=>{if(We.matches&&We.match&&We.request&&We.controller){let Xe=(await ya(We.request,We.matches,ae,We.key))[We.match.route.id];return{[We.key]:Xe}}else return Promise.resolve({[We.key]:{type:"error",error:md(404,{pathname:We.path})}})})),Ne=await ge,be=(await Ee).reduce((We,nt)=>Object.assign(We,nt),{});return{loaderResults:Ne,fetcherResults:be}}function qs(){ot=!0,Pt.forEach((bt,Tt)=>{rt.has(Tt)&&zt.add(Tt),ro(Tt)})}function Ho(bt,Tt,je={}){xe.fetchers.set(bt,Tt),jn({fetchers:new Map(xe.fetchers)},{flushSync:(je&&je.flushSync)===!0})}function Ar(bt,Tt,je,ae={}){let ge=B_(xe.matches,Tt);Po(bt),jn({errors:{[ge.route.id]:je},fetchers:new Map(xe.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function Fa(bt){return $t.set(bt,($t.get(bt)||0)+1),on.has(bt)&&on.delete(bt),xe.fetchers.get(bt)||eG}function Po(bt){let Tt=xe.fetchers.get(bt);rt.has(bt)&&!(Tt&&Tt.state==="loading"&&Ln.has(bt))&&ro(bt),Pt.delete(bt),Ln.delete(bt),$e.delete(bt),on.delete(bt),zt.delete(bt),xe.fetchers.delete(bt)}function bl(bt){let Tt=($t.get(bt)||0)-1;Tt<=0?($t.delete(bt),on.add(bt)):$t.set(bt,Tt),jn({fetchers:new Map(xe.fetchers)})}function ro(bt){let Tt=rt.get(bt);Tt&&(Tt.abort(),rt.delete(bt))}function Ea(bt){for(let Tt of bt){let je=Fa(Tt),ae=mg(je.data);xe.fetchers.set(Tt,ae)}}function Ua(){let bt=[],Tt=!1;for(let je of $e){let ae=xe.fetchers.get(je);To(ae,`Expected fetcher: ${je}`),ae.state==="loading"&&($e.delete(je),bt.push(je),Tt=!0)}return Ea(bt),Tt}function Co(bt){let Tt=[];for(let[je,ae]of Ln)if(ae<bt){let ge=xe.fetchers.get(je);To(ge,`Expected fetcher: ${je}`),ge.state==="loading"&&(ro(je),Ln.delete(je),Tt.push(je))}return Ea(Tt),Tt.length>0}function ea(bt,Tt){let je=xe.blockers.get(bt)||tx;return An.get(bt)!==Tt&&An.set(bt,Tt),je}function Aa(bt){xe.blockers.delete(bt),An.delete(bt)}function Go(bt,Tt){let je=xe.blockers.get(bt)||tx;To(je.state==="unblocked"&&Tt.state==="blocked"||je.state==="blocked"&&Tt.state==="blocked"||je.state==="blocked"&&Tt.state==="proceeding"||je.state==="blocked"&&Tt.state==="unblocked"||je.state==="proceeding"&&Tt.state==="unblocked",`Invalid blocker state transition: ${je.state} -> ${Tt.state}`);let ae=new Map(xe.blockers);ae.set(bt,Tt),jn({blockers:ae})}function tr({currentLocation:bt,nextLocation:Tt,historyAction:je}){if(An.size===0)return;An.size>1&&yl(!1,"A router only supports one blocker at a time");let ae=Array.from(An.entries()),[ge,Ee]=ae[ae.length-1],Ne=xe.blockers.get(ge);if(!(Ne&&Ne.state==="proceeding")&&Ee({currentLocation:bt,nextLocation:Tt,historyAction:je}))return ge}function Pa(bt){let Tt=md(404,{pathname:bt}),je=o||T,{matches:ae,route:ge}=nL(je);return{notFoundMatches:ae,route:ge,error:Tt}}function Is(bt,Tt,je){if(K=bt,te=Tt,J=je||null,!oe&&xe.navigation===LS){oe=!0;let ae=ls(xe.location,xe.matches);ae!=null&&jn({restoreScrollPosition:ae})}return()=>{K=null,te=null,J=null}}function ta(bt,Tt){return J&&J(bt,Tt.map(ae=>IH(ae,xe.loaderData)))||bt.key}function al(bt,Tt){if(K&&te){let je=ta(bt,Tt);K[je]=te()}}function ls(bt,Tt){if(K){let je=ta(bt,Tt),ae=K[je];if(typeof ae=="number")return ae}return null}function Ca(bt,Tt,je){if(e.patchRoutesOnNavigation)if(bt){if(Object.keys(bt[0].params).length>0)return{active:!0,matches:i1(Tt,je,C,!0)}}else return{active:!0,matches:i1(Tt,je,C,!0)||[]};return{active:!1,matches:null}}async function hn(bt,Tt,je,ae){if(!e.patchRoutesOnNavigation)return{type:"success",matches:bt};let ge=bt;for(;;){let Ee=o==null,Ne=o||T,be=y;try{await e.patchRoutesOnNavigation({signal:je,path:Tt,matches:ge,fetcherKey:ae,patch:(Xe,lt)=>{je.aborted||ZR(Xe,lt,Ne,be,f)}})}catch(Xe){return{type:"error",error:Xe,partialMatches:ge}}finally{Ee&&!je.aborted&&(T=[...T])}if(je.aborted)return{type:"aborted"};let We=yg(Ne,Tt,C);if(We)return{type:"success",matches:We};let nt=i1(Ne,Tt,C,!0);if(!nt||ge.length===nt.length&&ge.every((Xe,lt)=>Xe.route.id===nt[lt].route.id))return{type:"success",matches:null};ge=nt}}function vs(bt){y={},o=g1(bt,f,void 0,y)}function Ja(bt,Tt){let je=o==null;ZR(bt,Tt,o||T,y,f),je&&(T=[...T],jn({}))}return Oe={get basename(){return C},get future(){return I},get state(){return xe},get routes(){return T},get window(){return t},initialize:In,subscribe:Dt,enableScrollRestoration:Is,navigate:mn,fetch:Xr,revalidate:ci,createHref:bt=>e.history.createHref(bt),encodeLocation:bt=>e.history.encodeLocation(bt),getFetcher:Fa,deleteFetcher:bl,dispose:ti,getBlocker:ea,deleteBlocker:Aa,patchRoutes:Ja,_internalFetchControllers:rt,_internalSetRoutes:vs},Oe}function iG(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function kA(e,t,i,s,f,y){let T,o;if(f){T=[];for(let M of t)if(T.push(M),M.route.id===f){o=M;break}}else T=t,o=t[t.length-1];let C=hC(s||".",uC(T),xd(e.pathname,i)||e.pathname,y==="path");if(s==null&&(C.search=e.search,C.hash=e.hash),(s==null||s===""||s===".")&&o){let M=fC(C.search);if(o.route.index&&!M)C.search=C.search?C.search.replace(/^\?/,"?index&"):"?index";else if(!o.route.index&&M){let I=new URLSearchParams(C.search),j=I.getAll("index");I.delete("index"),j.filter(K=>K).forEach(K=>I.append("index",K));let q=I.toString();C.search=q?`?${q}`:""}}return i!=="/"&&(C.pathname=C.pathname==="/"?i:op([i,C.pathname])),Ag(C)}function HR(e,t,i){if(!i||!iG(i))return{path:t};if(i.formMethod&&!mG(i.formMethod))return{path:t,error:md(405,{method:i.formMethod})};let s=()=>({path:t,error:md(400,{type:"invalid-body"})}),y=(i.formMethod||"get").toUpperCase(),T=uj(t);if(i.body!==void 0){if(i.formEncType==="text/plain"){if(!_h(y))return s();let j=typeof i.body=="string"?i.body:i.body instanceof FormData||i.body instanceof URLSearchParams?Array.from(i.body.entries()).reduce((q,[K,J])=>`${q}${K}=${J}
`,""):String(i.body);return{path:t,submission:{formMethod:y,formAction:T,formEncType:i.formEncType,formData:void 0,json:void 0,text:j}}}else if(i.formEncType==="application/json"){if(!_h(y))return s();try{let j=typeof i.body=="string"?JSON.parse(i.body):i.body;return{path:t,submission:{formMethod:y,formAction:T,formEncType:i.formEncType,formData:void 0,json:j,text:void 0}}}catch{return s()}}}To(typeof FormData=="function","FormData is not available in this environment");let o,C;if(i.formData)o=jA(i.formData),C=i.formData;else if(i.body instanceof FormData)o=jA(i.body),C=i.body;else if(i.body instanceof URLSearchParams)o=i.body,C=JR(o);else if(i.body==null)o=new URLSearchParams,C=new FormData;else try{o=new URLSearchParams(i.body),C=JR(o)}catch{return s()}let M={formMethod:y,formAction:T,formEncType:i&&i.formEncType||"application/x-www-form-urlencoded",formData:C,json:void 0,text:void 0};if(_h(M.formMethod))return{path:t,submission:M};let I=Og(t);return e&&I.search&&fC(I.search)&&o.append("index",""),I.search=`?${o}`,{path:Ag(I),submission:M}}function GR(e,t,i,s,f,y,T,o,C,M,I,j,q,K,J,te,oe,ce,de,ue){let Pe=ue?gh(ue[1])?ue[1].error:ue[1].data:void 0,Oe=f.createURL(y.location),xe=f.createURL(C),Qe;if(I&&y.errors){let yt=Object.keys(y.errors)[0];Qe=T.findIndex(ot=>ot.route.id===yt)}else if(ue&&gh(ue[1])){let yt=ue[0];Qe=T.findIndex(ot=>ot.route.id===yt)-1}let tt=ue?ue[1].statusCode:void 0,Ge=tt&&tt>=400,Je={currentUrl:Oe,currentParams:y.matches[0]?.params||{},nextUrl:xe,nextParams:T[0].params,...o,actionResult:Pe,actionStatus:tt},Ve=T.map((yt,ot)=>{let{route:zt}=yt,rt=null;if(Qe!=null&&ot>Qe?rt=!1:zt.lazy?rt=!0:zt.loader==null?rt=!1:I?rt=NA(zt,y.loaderData,y.errors):rG(y.loaderData,y.matches[ot],yt)&&(rt=!0),rt!==null)return BA(i,s,e,yt,M,t,rt);let Bt=Ge?!1:j||Oe.pathname+Oe.search===xe.pathname+xe.search||Oe.search!==xe.search||oG(y.matches[ot],yt),Vt={...Je,defaultShouldRevalidate:Bt},Ln=v1(yt,Vt);return BA(i,s,e,yt,M,t,Ln,Vt)}),xt=[];return J.forEach((yt,ot)=>{if(I||!T.some($t=>$t.route.id===yt.routeId)||K.has(ot))return;let zt=y.fetchers.get(ot),rt=zt&&zt.state!=="idle"&&zt.data===void 0,Bt=yg(oe,yt.path,ce);if(!Bt){if(de&&rt)return;xt.push({key:ot,routeId:yt.routeId,path:yt.path,matches:null,match:null,request:null,controller:null});return}if(te.has(ot))return;let Vt=mx(Bt,yt.path),Ln=new AbortController,$e=dv(f,yt.path,Ln.signal),Pt=null;if(q.has(ot))q.delete(ot),Pt=xv(i,s,$e,Bt,Vt,M,t);else if(rt)j&&(Pt=xv(i,s,$e,Bt,Vt,M,t));else{let $t={...Je,defaultShouldRevalidate:Ge?!1:j};v1(Vt,$t)&&(Pt=xv(i,s,$e,Bt,Vt,M,t,$t))}Pt&&xt.push({key:ot,routeId:yt.routeId,path:yt.path,matches:Pt,match:Vt,request:$e,controller:Ln})}),{dsMatches:Ve,revalidatingFetchers:xt}}function NA(e,t,i){if(e.lazy)return!0;if(!e.loader)return!1;let s=t!=null&&e.id in t,f=i!=null&&i[e.id]!==void 0;return!s&&f?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!s&&!f}function rG(e,t,i){let s=!t||i.route.id!==t.route.id,f=!e.hasOwnProperty(i.route.id);return s||f}function oG(e,t){let i=e.route.path;return e.pathname!==t.pathname||i!=null&&i.endsWith("*")&&e.params["*"]!==t.params["*"]}function v1(e,t){if(e.route.shouldRevalidate){let i=e.route.shouldRevalidate(t);if(typeof i=="boolean")return i}return t.defaultShouldRevalidate}function ZR(e,t,i,s,f){let y;if(e){let C=s[e];To(C,`No route found to patch children into: routeId = ${e}`),C.children||(C.children=[]),y=C.children}else y=i;let T=t.filter(C=>!y.some(M=>oj(C,M))),o=g1(T,f,[e||"_","patch",String(y?.length||"0")],s);y.push(...o)}function oj(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((i,s)=>t.children?.some(f=>oj(i,f))):!1}var WR=new WeakMap,aj=({key:e,route:t,manifest:i,mapRouteProperties:s})=>{let f=i[t.id];if(To(f,"No route found in manifest"),!f.lazy||typeof f.lazy!="object")return;let y=f.lazy[e];if(!y)return;let T=WR.get(f);T||(T={},WR.set(f,T));let o=T[e];if(o)return o;let C=(async()=>{let M=PH(e),j=f[e]!==void 0&&e!=="hasErrorBoundary";if(M)yl(!M,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),T[e]=Promise.resolve();else if(j)yl(!1,`Route "${f.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let q=await y();q!=null&&(Object.assign(f,{[e]:q}),Object.assign(f,s(f)))}typeof f.lazy=="object"&&(f.lazy[e]=void 0,Object.values(f.lazy).every(q=>q===void 0)&&(f.lazy=void 0))})();return T[e]=C,C},XR=new WeakMap;function aG(e,t,i,s,f){let y=i[e.id];if(To(y,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof e.lazy=="function"){let I=XR.get(y);if(I)return{lazyRoutePromise:I,lazyHandlerPromise:I};let j=(async()=>{To(typeof e.lazy=="function","No lazy route function found");let q=await e.lazy(),K={};for(let J in q){let te=q[J];if(te===void 0)continue;let oe=MH(J),de=y[J]!==void 0&&J!=="hasErrorBoundary";oe?yl(!oe,"Route property "+J+" is not a supported property to be returned from a lazy route function. This property will be ignored."):de?yl(!de,`Route "${y.id}" has a static property "${J}" defined but its lazy function is also returning a value for this property. The lazy route property "${J}" will be ignored.`):K[J]=te}Object.assign(y,K),Object.assign(y,{...s(y),lazy:void 0})})();return XR.set(y,j),j.catch(()=>{}),{lazyRoutePromise:j,lazyHandlerPromise:j}}let T=Object.keys(e.lazy),o=[],C;for(let I of T){if(f&&f.includes(I))continue;let j=aj({key:I,route:e,manifest:i,mapRouteProperties:s});j&&(o.push(j),I===t&&(C=j))}let M=o.length>0?Promise.all(o).then(()=>{}):void 0;return M?.catch(()=>{}),C?.catch(()=>{}),{lazyRoutePromise:M,lazyHandlerPromise:C}}async function YR(e){let t=e.matches.filter(f=>f.shouldLoad),i={};return(await Promise.all(t.map(f=>f.resolve()))).forEach((f,y)=>{i[t[y].route.id]=f}),i}async function sG(e){return e.matches.some(t=>t.route.unstable_middleware)?sj(e,!1,()=>YR(e),(t,i)=>({[i]:{type:"error",result:t}})):YR(e)}async function sj(e,t,i,s){let{matches:f,request:y,params:T,context:o}=e,C={handlerResult:void 0};try{let M=f.flatMap(j=>j.route.unstable_middleware?j.route.unstable_middleware.map(q=>[j.route.id,q]):[]),I=await lj({request:y,params:T,context:o},M,t,C,i);return t?I:C.handlerResult}catch(M){if(!C.middlewareError)throw M;let I=await s(C.middlewareError.error,C.middlewareError.routeId);return C.handlerResult?Object.assign(C.handlerResult,I):I}}async function lj(e,t,i,s,f,y=0){let{request:T}=e;if(T.signal.aborted)throw T.signal.reason?T.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${T.method} ${T.url}`);let o=t[y];if(!o)return s.handlerResult=await f(),s.handlerResult;let[C,M]=o,I=!1,j,q=async()=>{if(I)throw new Error("You may only call `next()` once per middleware");I=!0,await lj(e,t,i,s,f,y+1)};try{let K=await M({request:e.request,params:e.params,context:e.context},q);return I?K===void 0?j:K:q()}catch(K){throw s.middlewareError?s.middlewareError.error!==K&&(s.middlewareError={routeId:C,error:K}):s.middlewareError={routeId:C,error:K},K}}function cj(e,t,i,s,f){let y=aj({key:"unstable_middleware",route:s.route,manifest:t,mapRouteProperties:e}),T=aG(s.route,_h(i.method)?"action":"loader",t,e,f);return{middleware:y,route:T.lazyRoutePromise,handler:T.lazyHandlerPromise}}function BA(e,t,i,s,f,y,T,o=null){let C=!1,M=cj(e,t,i,s,f);return{...s,_lazyPromises:M,shouldLoad:T,unstable_shouldRevalidateArgs:o,unstable_shouldCallHandler(I){return C=!0,o?typeof I=="boolean"?v1(s,{...o,defaultShouldRevalidate:I}):v1(s,o):T},resolve(I){return C||T||I&&i.method==="GET"&&(s.route.lazy||s.route.loader)?cG({request:i,match:s,lazyHandlerPromise:M?.handler,lazyRoutePromise:M?.route,handlerOverride:I,scopedContext:y}):Promise.resolve({type:"data",result:void 0})}}}function xv(e,t,i,s,f,y,T,o=null){return s.map(C=>C.route.id!==f.route.id?{...C,shouldLoad:!1,unstable_shouldRevalidateArgs:o,unstable_shouldCallHandler:()=>!1,_lazyPromises:cj(e,t,i,C,y),resolve:()=>Promise.resolve({type:"data",result:void 0})}:BA(e,t,i,C,y,T,!0,o))}async function lG(e,t,i,s,f,y){i.some(M=>M._lazyPromises?.middleware)&&await Promise.all(i.map(M=>M._lazyPromises?.middleware));let T={request:t,params:i[0].params,context:f,matches:i},C=await e({...T,fetcherKey:s,unstable_runClientMiddleware:M=>{let I=T;return sj(I,!1,()=>M({...I,fetcherKey:s,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}),(j,q)=>({[q]:{type:"error",result:j}}))}});try{await Promise.all(i.flatMap(M=>[M._lazyPromises?.handler,M._lazyPromises?.route]))}catch{}return C}async function cG({request:e,match:t,lazyHandlerPromise:i,lazyRoutePromise:s,handlerOverride:f,scopedContext:y}){let T,o,C=_h(e.method),M=C?"action":"loader",I=j=>{let q,K=new Promise((oe,ce)=>q=ce);o=()=>q(),e.signal.addEventListener("abort",o);let J=oe=>typeof j!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${M}" [routeId: ${t.route.id}]`)):j({request:e,params:t.params,context:y},...oe!==void 0?[oe]:[]),te=(async()=>{try{return{type:"data",result:await(f?f(ce=>J(ce)):J())}}catch(oe){return{type:"error",result:oe}}})();return Promise.race([te,K])};try{let j=C?t.route.action:t.route.loader;if(i||s)if(j){let q,[K]=await Promise.all([I(j).catch(J=>{q=J}),i,s]);if(q!==void 0)throw q;T=K}else{await i;let q=C?t.route.action:t.route.loader;if(q)[T]=await Promise.all([I(q),s]);else if(M==="action"){let K=new URL(e.url),J=K.pathname+K.search;throw md(405,{method:e.method,pathname:J,routeId:t.route.id})}else return{type:"data",result:void 0}}else if(j)T=await I(j);else{let q=new URL(e.url),K=q.pathname+q.search;throw md(404,{pathname:K})}}catch(j){return{type:"error",result:j}}finally{o&&e.signal.removeEventListener("abort",o)}return T}async function uG(e){let{result:t,type:i}=e;if(hj(t)){let s;try{let f=t.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(f){return{type:"error",error:f}}return i==="error"?{type:"error",error:new y1(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}return i==="error"?iL(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:t.init?.status,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new y1(t.init?.status||500,void 0,t.data),statusCode:Cx(t)?t.status:void 0,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:Cx(t)?t.status:void 0}:iL(t)?{type:"data",data:t.data,statusCode:t.init?.status,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function hG(e,t,i,s,f){let y=e.headers.get("Location");if(To(y,"Redirects returned/thrown from loaders/actions must have a Location header"),!dC.test(y)){let T=s.slice(0,s.findIndex(o=>o.route.id===i)+1);y=kA(new URL(t.url),T,f,y),e.headers.set("Location",y)}return e}function KR(e,t,i){if(dC.test(e)){let s=e,f=s.startsWith("//")?new URL(t.protocol+s):new URL(s),y=xd(f.pathname,i)!=null;if(f.origin===t.origin&&y)return f.pathname+f.search+f.hash}return e}function dv(e,t,i,s){let f=e.createURL(uj(t)).toString(),y={signal:i};if(s&&_h(s.formMethod)){let{formMethod:T,formEncType:o}=s;y.method=T.toUpperCase(),o==="application/json"?(y.headers=new Headers({"Content-Type":o}),y.body=JSON.stringify(s.json)):o==="text/plain"?y.body=s.text:o==="application/x-www-form-urlencoded"&&s.formData?y.body=jA(s.formData):y.body=s.formData}return new Request(f,y)}function jA(e){let t=new URLSearchParams;for(let[i,s]of e.entries())t.append(i,typeof s=="string"?s:s.name);return t}function JR(e){let t=new FormData;for(let[i,s]of e.entries())t.append(i,s);return t}function dG(e,t,i,s=!1,f=!1){let y={},T=null,o,C=!1,M={},I=i&&gh(i[1])?i[1].error:void 0;return e.forEach(j=>{if(!(j.route.id in t))return;let q=j.route.id,K=t[q];if(To(!j_(K),"Cannot handle redirect results in processLoaderData"),gh(K)){let J=K.error;if(I!==void 0&&(J=I,I=void 0),T=T||{},f)T[q]=J;else{let te=B_(e,q);T[te.route.id]==null&&(T[te.route.id]=J)}s||(y[q]=rj),C||(C=!0,o=Cx(K.error)?K.error.status:500),K.headers&&(M[q]=K.headers)}else y[q]=K.data,K.statusCode&&K.statusCode!==200&&!C&&(o=K.statusCode),K.headers&&(M[q]=K.headers)}),I!==void 0&&i&&(T={[i[0]]:I},i[2]&&(y[i[2]]=void 0)),{loaderData:y,errors:T,statusCode:o||200,loaderHeaders:M}}function QR(e,t,i,s,f,y){let{loaderData:T,errors:o}=dG(t,i,s);return f.filter(C=>!C.matches||C.matches.some(M=>M.shouldLoad)).forEach(C=>{let{key:M,match:I,controller:j}=C,q=y[M];if(To(q,"Did not find corresponding fetcher result"),!(j&&j.signal.aborted))if(gh(q)){let K=B_(e.matches,I?.route.id);o&&o[K.route.id]||(o={...o,[K.route.id]:q.error}),e.fetchers.delete(M)}else if(j_(q))To(!1,"Unhandled fetcher revalidation redirect");else{let K=mg(q.data);e.fetchers.set(M,K)}}),{loaderData:T,errors:o}}function eL(e,t,i,s){let f=Object.entries(t).filter(([,y])=>y!==rj).reduce((y,[T,o])=>(y[T]=o,y),{});for(let y of i){let T=y.route.id;if(!t.hasOwnProperty(T)&&e.hasOwnProperty(T)&&y.route.loader&&(f[T]=e[T]),s&&s.hasOwnProperty(T))break}return f}function tL(e){return e?gh(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function B_(e,t){return(t?e.slice(0,e.findIndex(s=>s.route.id===t)+1):[...e]).reverse().find(s=>s.route.hasErrorBoundary===!0)||e[0]}function nL(e){let t=e.length===1?e[0]:e.find(i=>i.index||!i.path||i.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function md(e,{pathname:t,routeId:i,method:s,type:f,message:y}={}){let T="Unknown Server Error",o="Unknown @remix-run/router error";return e===400?(T="Bad Request",s&&t&&i?o=`You made a ${s} request to "${t}" but did not provide a \`loader\` for route "${i}", so there is no way to handle the request.`:f==="invalid-body"&&(o="Unable to encode submission body")):e===403?(T="Forbidden",o=`Route "${i}" does not match URL "${t}"`):e===404?(T="Not Found",o=`No route matches URL "${t}"`):e===405&&(T="Method Not Allowed",s&&t&&i?o=`You made a ${s.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${i}", so there is no way to handle the request.`:s&&(o=`Invalid request method "${s.toUpperCase()}"`)),new y1(e||500,T,new Error(o),!0)}function kw(e){let t=Object.entries(e);for(let i=t.length-1;i>=0;i--){let[s,f]=t[i];if(j_(f))return{key:s,result:f}}}function uj(e){let t=typeof e=="string"?Og(e):e;return Ag({...t,hash:""})}function fG(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function pG(e){return hj(e.result)&&JH.has(e.result.status)}function gh(e){return e.type==="error"}function j_(e){return(e&&e.type)==="redirect"}function iL(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function hj(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function mG(e){return KH.has(e.toUpperCase())}function _h(e){return XH.has(e.toUpperCase())}function fC(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function mx(e,t){let i=typeof t=="string"?Og(t).search:t.search;if(e[e.length-1].route.index&&fC(i||""))return e[e.length-1];let s=tj(e);return s[s.length-1]}function rL(e){let{formMethod:t,formAction:i,formEncType:s,text:f,formData:y,json:T}=e;if(!(!t||!i||!s)){if(f!=null)return{formMethod:t,formAction:i,formEncType:s,formData:void 0,json:void 0,text:f};if(y!=null)return{formMethod:t,formAction:i,formEncType:s,formData:y,json:void 0,text:void 0};if(T!==void 0)return{formMethod:t,formAction:i,formEncType:s,formData:void 0,json:T,text:void 0}}}function zS(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function gG(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function nx(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function _G(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function mg(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function yG(e,t){try{let i=e.sessionStorage.getItem(ij);if(i){let s=JSON.parse(i);for(let[f,y]of Object.entries(s||{}))y&&Array.isArray(y)&&t.set(f,new Set(y||[]))}}catch{}}function vG(e,t){if(t.size>0){let i={};for(let[s,f]of t)i[s]=[...f];try{e.sessionStorage.setItem(ij,JSON.stringify(i))}catch(s){yl(!1,`Failed to save applied view transitions in sessionStorage (${s}).`)}}}function xG(){let e,t,i=new Promise((s,f)=>{e=async y=>{s(y);try{await i}catch{}},t=async y=>{f(y);try{await i}catch{}}});return{promise:i,resolve:e,reject:t}}var uy=me.createContext(null);uy.displayName="DataRouter";var Kx=me.createContext(null);Kx.displayName="DataRouterState";var pC=me.createContext({isTransitioning:!1});pC.displayName="ViewTransition";var dj=me.createContext(new Map);dj.displayName="Fetchers";var bG=me.createContext(null);bG.displayName="Await";var pp=me.createContext(null);pp.displayName="Navigation";var ST=me.createContext(null);ST.displayName="Location";var pf=me.createContext({outlet:null,matches:[],isDataRoute:!1});pf.displayName="Route";var mC=me.createContext(null);mC.displayName="RouteError";function wG(e,{relative:t}={}){To(Jx(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=me.useContext(pp),{hash:f,pathname:y,search:T}=Qx(e,{relative:t}),o=y;return i!=="/"&&(o=y==="/"?i:op([i,y])),s.createHref({pathname:o,search:T,hash:f})}function Jx(){return me.useContext(ST)!=null}function mp(){return To(Jx(),"useLocation() may be used only in the context of a <Router> component."),me.useContext(ST).location}var fj="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pj(e){me.useContext(pp).static||me.useLayoutEffect(e)}function jv(){let{isDataRoute:e}=me.useContext(pf);return e?BG():TG()}function TG(){To(Jx(),"useNavigate() may be used only in the context of a <Router> component.");let e=me.useContext(uy),{basename:t,navigator:i}=me.useContext(pp),{matches:s}=me.useContext(pf),{pathname:f}=mp(),y=JSON.stringify(uC(s)),T=me.useRef(!1);return pj(()=>{T.current=!0}),me.useCallback((C,M={})=>{if(yl(T.current,fj),!T.current)return;if(typeof C=="number"){i.go(C);return}let I=hC(C,JSON.parse(y),f,M.relative==="path");e==null&&t!=="/"&&(I.pathname=I.pathname==="/"?t:op([t,I.pathname])),(M.replace?i.replace:i.push)(I,M.state,M)},[t,i,y,f,e])}var SG=me.createContext(null);function EG(e){let t=me.useContext(pf).outlet;return t&&me.createElement(SG.Provider,{value:e},t)}function AG(){let{matches:e}=me.useContext(pf),t=e[e.length-1];return t?t.params:{}}function Qx(e,{relative:t}={}){let{matches:i}=me.useContext(pf),{pathname:s}=mp(),f=JSON.stringify(uC(i));return me.useMemo(()=>hC(e,JSON.parse(f),s,t==="path"),[e,f,s,t])}function PG(e,t,i,s){To(Jx(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:f}=me.useContext(pp),{matches:y}=me.useContext(pf),T=y[y.length-1],o=T?T.params:{},C=T?T.pathname:"/",M=T?T.pathnameBase:"/",I=T&&T.route;{let ce=I&&I.path||"";mj(C,!I||ce.endsWith("*")||ce.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${C}" (under <Route path="${ce}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ce}"> to <Route path="${ce==="/"?"*":`${ce}/*`}">.`)}let j=mp(),q;q=j;let K=q.pathname||"/",J=K;if(M!=="/"){let ce=M.replace(/^\//,"").split("/");J="/"+K.replace(/^\//,"").split("/").slice(ce.length).join("/")}let te=yg(e,{pathname:J});return yl(I||te!=null,`No routes matched location "${q.pathname}${q.search}${q.hash}" `),yl(te==null||te[te.length-1].route.element!==void 0||te[te.length-1].route.Component!==void 0||te[te.length-1].route.lazy!==void 0,`Matched leaf route at location "${q.pathname}${q.search}${q.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),DG(te&&te.map(ce=>Object.assign({},ce,{params:Object.assign({},o,ce.params),pathname:op([M,f.encodeLocation?f.encodeLocation(ce.pathname).pathname:ce.pathname]),pathnameBase:ce.pathnameBase==="/"?M:op([M,f.encodeLocation?f.encodeLocation(ce.pathnameBase).pathname:ce.pathnameBase])})),y,i,s)}function CG(){let e=NG(),t=Cx(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",f={padding:"0.5rem",backgroundColor:s},y={padding:"2px 4px",backgroundColor:s},T=null;return console.error("Error handled by React Router default ErrorBoundary:",e),T=me.createElement(me.Fragment,null,me.createElement("p",null,"💿 Hey developer 👋"),me.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",me.createElement("code",{style:y},"ErrorBoundary")," or"," ",me.createElement("code",{style:y},"errorElement")," prop on your route.")),me.createElement(me.Fragment,null,me.createElement("h2",null,"Unexpected Application Error!"),me.createElement("h3",{style:{fontStyle:"italic"}},t),i?me.createElement("pre",{style:f},i):null,T)}var MG=me.createElement(CG,null),OG=class extends me.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?me.createElement(pf.Provider,{value:this.props.routeContext},me.createElement(mC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IG({routeContext:e,match:t,children:i}){let s=me.useContext(uy);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),me.createElement(pf.Provider,{value:e},i)}function DG(e,t=[],i=null,s=null){if(e==null){if(!i)return null;if(i.errors)e=i.matches;else if(t.length===0&&!i.initialized&&i.matches.length>0)e=i.matches;else return null}let f=e,y=i?.errors;if(y!=null){let C=f.findIndex(M=>M.route.id&&y?.[M.route.id]!==void 0);To(C>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(y).join(",")}`),f=f.slice(0,Math.min(f.length,C+1))}let T=!1,o=-1;if(i)for(let C=0;C<f.length;C++){let M=f[C];if((M.route.HydrateFallback||M.route.hydrateFallbackElement)&&(o=C),M.route.id){let{loaderData:I,errors:j}=i,q=M.route.loader&&!I.hasOwnProperty(M.route.id)&&(!j||j[M.route.id]===void 0);if(M.route.lazy||q){T=!0,o>=0?f=f.slice(0,o+1):f=[f[0]];break}}}return f.reduceRight((C,M,I)=>{let j,q=!1,K=null,J=null;i&&(j=y&&M.route.id?y[M.route.id]:void 0,K=M.route.errorElement||MG,T&&(o<0&&I===0?(mj("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),q=!0,J=null):o===I&&(q=!0,J=M.route.hydrateFallbackElement||null)));let te=t.concat(f.slice(0,I+1)),oe=()=>{let ce;return j?ce=K:q?ce=J:M.route.Component?ce=me.createElement(M.route.Component,null):M.route.element?ce=M.route.element:ce=C,me.createElement(IG,{match:M,routeContext:{outlet:C,matches:te,isDataRoute:i!=null},children:ce})};return i&&(M.route.ErrorBoundary||M.route.errorElement||I===0)?me.createElement(OG,{location:i.location,revalidation:i.revalidation,component:K,error:j,children:oe(),routeContext:{outlet:null,matches:te,isDataRoute:!0}}):oe()},null)}function gC(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RG(e){let t=me.useContext(uy);return To(t,gC(e)),t}function LG(e){let t=me.useContext(Kx);return To(t,gC(e)),t}function zG(e){let t=me.useContext(pf);return To(t,gC(e)),t}function _C(e){let t=zG(e),i=t.matches[t.matches.length-1];return To(i.route.id,`${e} can only be used on routes that contain a unique "id"`),i.route.id}function kG(){return _C("useRouteId")}function NG(){let e=me.useContext(mC),t=LG("useRouteError"),i=_C("useRouteError");return e!==void 0?e:t.errors?.[i]}function BG(){let{router:e}=RG("useNavigate"),t=_C("useNavigate"),i=me.useRef(!1);return pj(()=>{i.current=!0}),me.useCallback(async(f,y={})=>{yl(i.current,fj),i.current&&(typeof f=="number"?e.navigate(f):await e.navigate(f,{fromRouteId:t,...y}))},[e,t])}var oL={};function mj(e,t,i){!t&&!oL[e]&&(oL[e]=!0,yl(!1,i))}var aL={};function sL(e,t){!e&&!aL[t]&&(aL[t]=!0,console.warn(t))}function jG(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&yl(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:me.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&yl(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:me.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&yl(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:me.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var FG=["HydrateFallback","hydrateFallbackElement"],UG=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=i=>{this.status==="pending"&&(this.status="resolved",e(i))},this.reject=i=>{this.status==="pending"&&(this.status="rejected",t(i))}})}};function VG({router:e,flushSync:t}){let[i,s]=me.useState(e.state),[f,y]=me.useState(),[T,o]=me.useState({isTransitioning:!1}),[C,M]=me.useState(),[I,j]=me.useState(),[q,K]=me.useState(),J=me.useRef(new Map),te=me.useCallback((ue,{deletedFetchers:Pe,flushSync:Oe,viewTransitionOpts:xe})=>{ue.fetchers.forEach((tt,Ge)=>{tt.data!==void 0&&J.current.set(Ge,tt.data)}),Pe.forEach(tt=>J.current.delete(tt)),sL(Oe===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let Qe=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(sL(xe==null||Qe,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!xe||!Qe){t&&Oe?t(()=>s(ue)):me.startTransition(()=>s(ue));return}if(t&&Oe){t(()=>{I&&(C&&C.resolve(),I.skipTransition()),o({isTransitioning:!0,flushSync:!0,currentLocation:xe.currentLocation,nextLocation:xe.nextLocation})});let tt=e.window.document.startViewTransition(()=>{t(()=>s(ue))});tt.finished.finally(()=>{t(()=>{M(void 0),j(void 0),y(void 0),o({isTransitioning:!1})})}),t(()=>j(tt));return}I?(C&&C.resolve(),I.skipTransition(),K({state:ue,currentLocation:xe.currentLocation,nextLocation:xe.nextLocation})):(y(ue),o({isTransitioning:!0,flushSync:!1,currentLocation:xe.currentLocation,nextLocation:xe.nextLocation}))},[e.window,t,I,C]);me.useLayoutEffect(()=>e.subscribe(te),[e,te]),me.useEffect(()=>{T.isTransitioning&&!T.flushSync&&M(new UG)},[T]),me.useEffect(()=>{if(C&&f&&e.window){let ue=f,Pe=C.promise,Oe=e.window.document.startViewTransition(async()=>{me.startTransition(()=>s(ue)),await Pe});Oe.finished.finally(()=>{M(void 0),j(void 0),y(void 0),o({isTransitioning:!1})}),j(Oe)}},[f,C,e.window]),me.useEffect(()=>{C&&f&&i.location.key===f.location.key&&C.resolve()},[C,I,i.location,f]),me.useEffect(()=>{!T.isTransitioning&&q&&(y(q.state),o({isTransitioning:!0,flushSync:!1,currentLocation:q.currentLocation,nextLocation:q.nextLocation}),K(void 0))},[T.isTransitioning,q]);let oe=me.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:ue=>e.navigate(ue),push:(ue,Pe,Oe)=>e.navigate(ue,{state:Pe,preventScrollReset:Oe?.preventScrollReset}),replace:(ue,Pe,Oe)=>e.navigate(ue,{replace:!0,state:Pe,preventScrollReset:Oe?.preventScrollReset})}),[e]),ce=e.basename||"/",de=me.useMemo(()=>({router:e,navigator:oe,static:!1,basename:ce}),[e,oe,ce]);return me.createElement(me.Fragment,null,me.createElement(uy.Provider,{value:de},me.createElement(Kx.Provider,{value:i},me.createElement(dj.Provider,{value:J.current},me.createElement(pC.Provider,{value:T},me.createElement(GG,{basename:ce,location:i.location,navigationType:i.historyAction,navigator:oe},me.createElement($G,{routes:e.routes,future:e.future,state:i})))))),null)}var $G=me.memo(qG);function qG({routes:e,future:t,state:i}){return PG(e,void 0,i,t)}function HG(e){return EG(e.context)}function GG({basename:e="/",children:t=null,location:i,navigationType:s="POP",navigator:f,static:y=!1}){To(!Jx(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let T=e.replace(/^\/*/,"/"),o=me.useMemo(()=>({basename:T,navigator:f,static:y,future:{}}),[T,f,y]);typeof i=="string"&&(i=Og(i));let{pathname:C="/",search:M="",hash:I="",state:j=null,key:q="default"}=i,K=me.useMemo(()=>{let J=xd(C,T);return J==null?null:{location:{pathname:J,search:M,hash:I,state:j,key:q},navigationType:s}},[T,C,M,I,j,q,s]);return yl(K!=null,`<Router basename="${T}"> is not able to match the URL "${C}${M}${I}" because it does not start with the basename, so the <Router> won't render anything.`),K==null?null:me.createElement(pp.Provider,{value:o},me.createElement(ST.Provider,{children:t,value:K}))}var r1="get",o1="application/x-www-form-urlencoded";function ET(e){return e!=null&&typeof e.tagName=="string"}function ZG(e){return ET(e)&&e.tagName.toLowerCase()==="button"}function WG(e){return ET(e)&&e.tagName.toLowerCase()==="form"}function XG(e){return ET(e)&&e.tagName.toLowerCase()==="input"}function YG(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function KG(e,t){return e.button===0&&(!t||t==="_self")&&!YG(e)}var Nw=null;function JG(){if(Nw===null)try{new FormData(document.createElement("form"),0),Nw=!1}catch{Nw=!0}return Nw}var QG=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function kS(e){return e!=null&&!QG.has(e)?(yl(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${o1}"`),null):e}function e7(e,t){let i,s,f,y,T;if(WG(e)){let o=e.getAttribute("action");s=o?xd(o,t):null,i=e.getAttribute("method")||r1,f=kS(e.getAttribute("enctype"))||o1,y=new FormData(e)}else if(ZG(e)||XG(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=e.getAttribute("formaction")||o.getAttribute("action");if(s=C?xd(C,t):null,i=e.getAttribute("formmethod")||o.getAttribute("method")||r1,f=kS(e.getAttribute("formenctype"))||kS(o.getAttribute("enctype"))||o1,y=new FormData(o,e),!JG()){let{name:M,type:I,value:j}=e;if(I==="image"){let q=M?`${M}.`:"";y.append(`${q}x`,"0"),y.append(`${q}y`,"0")}else M&&y.append(M,j)}}else{if(ET(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=r1,s=null,f=o1,T=e}return y&&f==="text/plain"&&(T=y,y=void 0),{action:s,method:i.toLowerCase(),encType:f,formData:y,body:T}}function yC(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function t7(e,t){if(e.id in t)return t[e.id];try{let i=await import(e.module);return t[e.id]=i,i}catch(i){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function n7(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function i7(e,t,i){let s=await Promise.all(e.map(async f=>{let y=t.routes[f.route.id];if(y){let T=await t7(y,i);return T.links?T.links():[]}return[]}));return s7(s.flat(1).filter(n7).filter(f=>f.rel==="stylesheet"||f.rel==="preload").map(f=>f.rel==="stylesheet"?{...f,rel:"prefetch",as:"style"}:{...f,rel:"prefetch"}))}function lL(e,t,i,s,f,y){let T=(C,M)=>i[M]?C.route.id!==i[M].route.id:!0,o=(C,M)=>i[M].pathname!==C.pathname||i[M].route.path?.endsWith("*")&&i[M].params["*"]!==C.params["*"];return y==="assets"?t.filter((C,M)=>T(C,M)||o(C,M)):y==="data"?t.filter((C,M)=>{let I=s.routes[C.route.id];if(!I||!I.hasLoader)return!1;if(T(C,M)||o(C,M))return!0;if(C.route.shouldRevalidate){let j=C.route.shouldRevalidate({currentUrl:new URL(f.pathname+f.search+f.hash,window.origin),currentParams:i[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function r7(e,t,{includeHydrateFallback:i}={}){return o7(e.map(s=>{let f=t.routes[s.route.id];if(!f)return[];let y=[f.module];return f.clientActionModule&&(y=y.concat(f.clientActionModule)),f.clientLoaderModule&&(y=y.concat(f.clientLoaderModule)),i&&f.hydrateFallbackModule&&(y=y.concat(f.hydrateFallbackModule)),f.imports&&(y=y.concat(f.imports)),y}).flat(1))}function o7(e){return[...new Set(e)]}function a7(e){let t={},i=Object.keys(e).sort();for(let s of i)t[s]=e[s];return t}function s7(e,t){let i=new Set;return new Set(t),e.reduce((s,f)=>{let y=JSON.stringify(a7(f));return i.has(y)||(i.add(y),s.push({key:y,link:f})),s},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var l7=new Set([100,101,204,205]);function c7(e,t){let i=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return i.pathname==="/"?i.pathname="_root.data":t&&xd(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.data`:i.pathname=`${i.pathname.replace(/\/$/,"")}.data`,i}function gj(){let e=me.useContext(uy);return yC(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function u7(){let e=me.useContext(Kx);return yC(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var vC=me.createContext(void 0);vC.displayName="FrameworkContext";function _j(){let e=me.useContext(vC);return yC(e,"You must render this element inside a <HydratedRouter> element"),e}function h7(e,t){let i=me.useContext(vC),[s,f]=me.useState(!1),[y,T]=me.useState(!1),{onFocus:o,onBlur:C,onMouseEnter:M,onMouseLeave:I,onTouchStart:j}=t,q=me.useRef(null);me.useEffect(()=>{if(e==="render"&&T(!0),e==="viewport"){let te=ce=>{ce.forEach(de=>{T(de.isIntersecting)})},oe=new IntersectionObserver(te,{threshold:.5});return q.current&&oe.observe(q.current),()=>{oe.disconnect()}}},[e]),me.useEffect(()=>{if(s){let te=setTimeout(()=>{T(!0)},100);return()=>{clearTimeout(te)}}},[s]);let K=()=>{f(!0)},J=()=>{f(!1),T(!1)};return i?e!=="intent"?[y,q,{}]:[y,q,{onFocus:ix(o,K),onBlur:ix(C,J),onMouseEnter:ix(M,K),onMouseLeave:ix(I,J),onTouchStart:ix(j,K)}]:[!1,q,{}]}function ix(e,t){return i=>{e&&e(i),i.defaultPrevented||t(i)}}function d7({page:e,...t}){let{router:i}=gj(),s=me.useMemo(()=>yg(i.routes,e,i.basename),[i.routes,e,i.basename]);return s?me.createElement(p7,{page:e,matches:s,...t}):null}function f7(e){let{manifest:t,routeModules:i}=_j(),[s,f]=me.useState([]);return me.useEffect(()=>{let y=!1;return i7(e,t,i).then(T=>{y||f(T)}),()=>{y=!0}},[e,t,i]),s}function p7({page:e,matches:t,...i}){let s=mp(),{manifest:f,routeModules:y}=_j(),{basename:T}=gj(),{loaderData:o,matches:C}=u7(),M=me.useMemo(()=>lL(e,t,C,f,s,"data"),[e,t,C,f,s]),I=me.useMemo(()=>lL(e,t,C,f,s,"assets"),[e,t,C,f,s]),j=me.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let J=new Set,te=!1;if(t.forEach(ce=>{let de=f.routes[ce.route.id];!de||!de.hasLoader||(!M.some(ue=>ue.route.id===ce.route.id)&&ce.route.id in o&&y[ce.route.id]?.shouldRevalidate||de.hasClientLoader?te=!0:J.add(ce.route.id))}),J.size===0)return[];let oe=c7(e,T);return te&&J.size>0&&oe.searchParams.set("_routes",t.filter(ce=>J.has(ce.route.id)).map(ce=>ce.route.id).join(",")),[oe.pathname+oe.search]},[T,o,s,f,M,t,e,y]),q=me.useMemo(()=>r7(I,f),[I,f]),K=f7(I);return me.createElement(me.Fragment,null,j.map(J=>me.createElement("link",{key:J,rel:"prefetch",as:"fetch",href:J,...i})),q.map(J=>me.createElement("link",{key:J,rel:"modulepreload",href:J,...i})),K.map(({key:J,link:te})=>me.createElement("link",{key:J,...te})))}function m7(...e){return t=>{e.forEach(i=>{typeof i=="function"?i(t):i!=null&&(i.current=t)})}}var yj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yj&&(window.__reactRouterVersion="7.6.3")}catch{}function g7(e,t){return nG({basename:t?.basename,unstable_getContext:t?.unstable_getContext,future:t?.future,history:TH({window:t?.window}),hydrationData:_7(),routes:e,mapRouteProperties:jG,hydrationRouteProperties:FG,dataStrategy:t?.dataStrategy,patchRoutesOnNavigation:t?.patchRoutesOnNavigation,window:t?.window}).initialize()}function _7(){let e=window?.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:y7(e.errors)}),e}function y7(e){if(!e)return null;let t=Object.entries(e),i={};for(let[s,f]of t)if(f&&f.__type==="RouteErrorResponse")i[s]=new y1(f.status,f.statusText,f.data,f.internal===!0);else if(f&&f.__type==="Error"){if(f.__subType){let y=window[f.__subType];if(typeof y=="function")try{let T=new y(f.message);T.stack="",i[s]=T}catch{}}if(i[s]==null){let y=new Error(f.message);y.stack="",i[s]=y}}else i[s]=f;return i}var vj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ss=me.forwardRef(function({onClick:t,discover:i="render",prefetch:s="none",relative:f,reloadDocument:y,replace:T,state:o,target:C,to:M,preventScrollReset:I,viewTransition:j,...q},K){let{basename:J}=me.useContext(pp),te=typeof M=="string"&&vj.test(M),oe,ce=!1;if(typeof M=="string"&&te&&(oe=M,yj))try{let Ge=new URL(window.location.href),Je=M.startsWith("//")?new URL(Ge.protocol+M):new URL(M),Ve=xd(Je.pathname,J);Je.origin===Ge.origin&&Ve!=null?M=Ve+Je.search+Je.hash:ce=!0}catch{yl(!1,`<Link to="${M}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let de=wG(M,{relative:f}),[ue,Pe,Oe]=h7(s,q),xe=w7(M,{replace:T,state:o,target:C,preventScrollReset:I,relative:f,viewTransition:j});function Qe(Ge){t&&t(Ge),Ge.defaultPrevented||xe(Ge)}let tt=me.createElement("a",{...q,...Oe,href:oe||de,onClick:ce||y?t:Qe,ref:m7(K,Pe),target:C,"data-discover":!te&&i==="render"?"true":void 0});return ue&&!te?me.createElement(me.Fragment,null,tt,me.createElement(d7,{page:de})):tt});ss.displayName="Link";var v7=me.forwardRef(function({"aria-current":t="page",caseSensitive:i=!1,className:s="",end:f=!1,style:y,to:T,viewTransition:o,children:C,...M},I){let j=Qx(T,{relative:M.relative}),q=mp(),K=me.useContext(Kx),{navigator:J,basename:te}=me.useContext(pp),oe=K!=null&&P7(j)&&o===!0,ce=J.encodeLocation?J.encodeLocation(j).pathname:j.pathname,de=q.pathname,ue=K&&K.navigation&&K.navigation.location?K.navigation.location.pathname:null;i||(de=de.toLowerCase(),ue=ue?ue.toLowerCase():null,ce=ce.toLowerCase()),ue&&te&&(ue=xd(ue,te)||ue);const Pe=ce!=="/"&&ce.endsWith("/")?ce.length-1:ce.length;let Oe=de===ce||!f&&de.startsWith(ce)&&de.charAt(Pe)==="/",xe=ue!=null&&(ue===ce||!f&&ue.startsWith(ce)&&ue.charAt(ce.length)==="/"),Qe={isActive:Oe,isPending:xe,isTransitioning:oe},tt=Oe?t:void 0,Ge;typeof s=="function"?Ge=s(Qe):Ge=[s,Oe?"active":null,xe?"pending":null,oe?"transitioning":null].filter(Boolean).join(" ");let Je=typeof y=="function"?y(Qe):y;return me.createElement(ss,{...M,"aria-current":tt,className:Ge,ref:I,style:Je,to:T,viewTransition:o},typeof C=="function"?C(Qe):C)});v7.displayName="NavLink";var x7=me.forwardRef(({discover:e="render",fetcherKey:t,navigate:i,reloadDocument:s,replace:f,state:y,method:T=r1,action:o,onSubmit:C,relative:M,preventScrollReset:I,viewTransition:j,...q},K)=>{let J=E7(),te=A7(o,{relative:M}),oe=T.toLowerCase()==="get"?"get":"post",ce=typeof o=="string"&&vj.test(o),de=ue=>{if(C&&C(ue),ue.defaultPrevented)return;ue.preventDefault();let Pe=ue.nativeEvent.submitter,Oe=Pe?.getAttribute("formmethod")||T;J(Pe||ue.currentTarget,{fetcherKey:t,method:Oe,navigate:i,replace:f,state:y,relative:M,preventScrollReset:I,viewTransition:j})};return me.createElement("form",{ref:K,method:oe,action:te,onSubmit:s?C:de,...q,"data-discover":!ce&&e==="render"?"true":void 0})});x7.displayName="Form";function b7(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xj(e){let t=me.useContext(uy);return To(t,b7(e)),t}function w7(e,{target:t,replace:i,state:s,preventScrollReset:f,relative:y,viewTransition:T}={}){let o=jv(),C=mp(),M=Qx(e,{relative:y});return me.useCallback(I=>{if(KG(I,t)){I.preventDefault();let j=i!==void 0?i:Ag(C)===Ag(M);o(e,{replace:j,state:s,preventScrollReset:f,relative:y,viewTransition:T})}},[C,o,M,i,s,t,e,f,y,T])}var T7=0,S7=()=>`__${String(++T7)}__`;function E7(){let{router:e}=xj("useSubmit"),{basename:t}=me.useContext(pp),i=kG();return me.useCallback(async(s,f={})=>{let{action:y,method:T,encType:o,formData:C,body:M}=e7(s,t);if(f.navigate===!1){let I=f.fetcherKey||S7();await e.fetch(I,i,f.action||y,{preventScrollReset:f.preventScrollReset,formData:C,body:M,formMethod:f.method||T,formEncType:f.encType||o,flushSync:f.flushSync})}else await e.navigate(f.action||y,{preventScrollReset:f.preventScrollReset,formData:C,body:M,formMethod:f.method||T,formEncType:f.encType||o,replace:f.replace,state:f.state,fromRouteId:i,flushSync:f.flushSync,viewTransition:f.viewTransition})},[e,t,i])}function A7(e,{relative:t}={}){let{basename:i}=me.useContext(pp),s=me.useContext(pf);To(s,"useFormAction must be used inside a RouteContext");let[f]=s.matches.slice(-1),y={...Qx(e||".",{relative:t})},T=mp();if(e==null){y.search=T.search;let o=new URLSearchParams(y.search),C=o.getAll("index");if(C.some(I=>I==="")){o.delete("index"),C.filter(j=>j).forEach(j=>o.append("index",j));let I=o.toString();y.search=I?`?${I}`:""}}return(!e||e===".")&&f.route.index&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(y.pathname=y.pathname==="/"?i:op([i,y.pathname])),Ag(y)}function P7(e,t={}){let i=me.useContext(pC);To(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=xj("useViewTransitionState"),f=Qx(e,{relative:t.relative});if(!i.isTransitioning)return!1;let y=xd(i.currentLocation.pathname,s)||i.currentLocation.pathname,T=xd(i.nextLocation.pathname,s)||i.nextLocation.pathname;return _1(f.pathname,T)!=null||_1(f.pathname,y)!=null}[...l7];function C7(){return ie.jsxs("div",{children:[" ",ie.jsxs("section",{className:"flex flex-col items-center justify-center text-center p-10 bg-[#1f1c3d]",children:[ie.jsx("h2",{className:"text-4xl font-bold mb-4",children:"بصّار، لتكن على بصيرة "}),ie.jsx("p",{className:"text-lg max-w-xl text-yellow-100",children:"سافر واطمّن – بصار يكشف لك المخاطر أول بأول باستخدام تحديثات مباشرة."}),ie.jsx("button",{className:"mt-6 px-6 py-3 text-lg font-semibold bg-[#F8D203] text-[#272343] rounded hover:opacity-90 transition cursor-pointer",children:"ابدأ الآن"})]})]})}const M7="/assets/logo-remove.png";function O7(){const[e,t]=me.useState(!1);return ie.jsxs("nav",{className:"bg-white/10 backdrop-blur-xl shadow-md px-6 py-4 border-b border-b-white/20 w-[70%] mx-auto",children:[ie.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[ie.jsxs("div",{className:"flex items-center",children:[ie.jsx("img",{src:M7,alt:"Logo",className:"h-10"}),ie.jsx("span",{className:"text-yellow-300 font-bold text-lg ml-2",children:"بّصار"})]}),ie.jsx("div",{className:"md:hidden",children:ie.jsx("button",{onClick:()=>t(!e),className:"text-yellow-100 focus:outline-none",children:ie.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:ie.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),ie.jsxs("ul",{className:"hidden md:flex gap-6 text-yellow-100 font-medium",children:[ie.jsx("li",{children:ie.jsx("a",{href:"#home",className:"hover:text-yellow-300 transition",children:"الصفحة الرئيسية"})}),ie.jsx(ss,{to:"/Map",children:ie.jsx("li",{className:"hover:text-yellow-300 transition cursor-pointer",children:"المميزات"})}),ie.jsx(ss,{to:"/Map",children:ie.jsx("li",{className:"hover:text-yellow-300 transition cursor-pointer",children:"الخريطة"})}),ie.jsx(ss,{to:"/contact",children:ie.jsx("li",{className:"hover:text-yellow-300 transition",children:"تواصل"})})]}),ie.jsx(ss,{to:"/signup",children:ie.jsx("button",{className:"hidden md:block bg-yellow-400 text-[#272343] font-semibold py-2 px-4 rounded-lg hover:bg-yellow-300 transition duration-300 cursor-pointer",children:"ابدأ الآن"})})]}),e&&ie.jsxs("div",{className:"md:hidden mt-4 text-yellow-100 space-y-4",children:[ie.jsx("a",{href:"#home",className:"block hover:text-yellow-300",children:"الصفحة الرئيسية"}),ie.jsx(ss,{to:"/Map",className:"block hover:text-yellow-300",children:"المميزات"}),ie.jsx(ss,{to:"/Map",className:"block hover:text-yellow-300",children:"الخريطة"}),ie.jsx(ss,{to:"/contact",className:"block hover:text-yellow-300",children:"تواصل"}),ie.jsx(ss,{to:"/signup",children:ie.jsx("button",{className:"mt-2 bg-yellow-400 text-[#272343] font-semibold py-2 px-4 rounded-lg hover:bg-yellow-300 transition duration-300 w-full",children:"ابدأ الآن"})})]})]})}/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I7=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),D7=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,i,s)=>s?s.toUpperCase():i.toLowerCase()),cL=e=>{const t=D7(e);return t.charAt(0).toUpperCase()+t.slice(1)},bj=(...e)=>e.filter((t,i,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===i).join(" ").trim(),R7=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var L7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z7=me.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:f="",children:y,iconNode:T,...o},C)=>me.createElement("svg",{ref:C,...L7,width:t,height:t,stroke:e,strokeWidth:s?Number(i)*24/Number(t):i,className:bj("lucide",f),...!y&&!R7(o)&&{"aria-hidden":"true"},...o},[...T.map(([M,I])=>me.createElement(M,I)),...Array.isArray(y)?y:[y]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=(e,t)=>{const i=me.forwardRef(({className:s,...f},y)=>me.createElement(z7,{ref:y,iconNode:t,className:bj(`lucide-${I7(cL(e))}`,`lucide-${e}`,s),...f}));return i.displayName=cL(e),i};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],wj=tc("arrow-up-right",k7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],B7=tc("arrow-up",N7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j7=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ig=tc("bell",j7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F7=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],U7=tc("check",F7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V7=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],$7=tc("facebook",V7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q7=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],H7=tc("instagram",q7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G7=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],xC=tc("log-out",G7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],W7=tc("map-pin",Z7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X7=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Y7=tc("menu",X7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bC=tc("plus",K7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J7=[["path",{d:"m20 19.5-5.5 1.2",key:"1aenhr"}],["path",{d:"M14.5 4v11.22a1 1 0 0 0 1.242.97L20 15.2",key:"2rtezt"}],["path",{d:"m2.978 19.351 5.549-1.363A2 2 0 0 0 10 16V2",key:"1kbm92"}],["path",{d:"M20 10 4 13.5",key:"8nums9"}]],W_=tc("saudi-riyal",J7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q7=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],e9=tc("shield-off",Q7);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],n9=tc("star",t9);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],FA=tc("trash-2",i9);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],o9=tc("triangle-alert",r9);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],s9=tc("twitter",a9);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],c9=tc("wifi-off",l9),Tj=me.createContext({});function u9(e){const t=me.useRef(null);return t.current===null&&(t.current=e()),t.current}const wC=typeof window<"u",h9=wC?me.useLayoutEffect:me.useEffect,TC=me.createContext(null);function SC(e,t){e.indexOf(t)===-1&&e.push(t)}function EC(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const dm=(e,t,i)=>i>t?t:i<e?e:i;let AC=()=>{};const fm={},Sj=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Ej(e){return typeof e=="object"&&e!==null}const Aj=e=>/^0[^.\s]+$/u.test(e);function PC(e){let t;return()=>(t===void 0&&(t=e()),t)}const vd=e=>e,d9=(e,t)=>i=>t(e(i)),eb=(...e)=>e.reduce(d9),Mx=(e,t,i)=>{const s=t-e;return s===0?1:(i-e)/s};class CC{constructor(){this.subscriptions=[]}add(t){return SC(this.subscriptions,t),()=>EC(this.subscriptions,t)}notify(t,i,s){const f=this.subscriptions.length;if(f)if(f===1)this.subscriptions[0](t,i,s);else for(let y=0;y<f;y++){const T=this.subscriptions[y];T&&T(t,i,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ap=e=>e*1e3,sp=e=>e/1e3;function Pj(e,t){return t?e*(1e3/t):0}const Cj=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,f9=1e-7,p9=12;function m9(e,t,i,s,f){let y,T,o=0;do T=t+(i-t)/2,y=Cj(T,s,f)-e,y>0?i=T:t=T;while(Math.abs(y)>f9&&++o<p9);return T}function tb(e,t,i,s){if(e===t&&i===s)return vd;const f=y=>m9(y,0,1,e,i);return y=>y===0||y===1?y:Cj(f(y),t,s)}const Mj=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Oj=e=>t=>1-e(1-t),Ij=tb(.33,1.53,.69,.99),MC=Oj(Ij),Dj=Mj(MC),Rj=e=>(e*=2)<1?.5*MC(e):.5*(2-Math.pow(2,-10*(e-1))),OC=e=>1-Math.sin(Math.acos(e)),Lj=Oj(OC),zj=Mj(OC),g9=tb(.42,0,1,1),_9=tb(0,0,.58,1),kj=tb(.42,0,.58,1),y9=e=>Array.isArray(e)&&typeof e[0]!="number",Nj=e=>Array.isArray(e)&&typeof e[0]=="number",v9={linear:vd,easeIn:g9,easeInOut:kj,easeOut:_9,circIn:OC,circInOut:zj,circOut:Lj,backIn:MC,backInOut:Dj,backOut:Ij,anticipate:Rj},x9=e=>typeof e=="string",uL=e=>{if(Nj(e)){AC(e.length===4);const[t,i,s,f]=e;return tb(t,i,s,f)}else if(x9(e))return v9[e];return e},Bw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],hL={value:null};function b9(e,t){let i=new Set,s=new Set,f=!1,y=!1;const T=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},C=0;function M(j){T.has(j)&&(I.schedule(j),e()),C++,j(o)}const I={schedule:(j,q=!1,K=!1)=>{const te=K&&f?i:s;return q&&T.add(j),te.has(j)||te.add(j),j},cancel:j=>{s.delete(j),T.delete(j)},process:j=>{if(o=j,f){y=!0;return}f=!0,[i,s]=[s,i],i.forEach(M),t&&hL.value&&hL.value.frameloop[t].push(C),C=0,i.clear(),f=!1,y&&(y=!1,I.process(j))}};return I}const w9=40;function Bj(e,t){let i=!1,s=!0;const f={delta:0,timestamp:0,isProcessing:!1},y=()=>i=!0,T=Bw.reduce((ue,Pe)=>(ue[Pe]=b9(y,t?Pe:void 0),ue),{}),{setup:o,read:C,resolveKeyframes:M,preUpdate:I,update:j,preRender:q,render:K,postRender:J}=T,te=()=>{const ue=fm.useManualTiming?f.timestamp:performance.now();i=!1,fm.useManualTiming||(f.delta=s?1e3/60:Math.max(Math.min(ue-f.timestamp,w9),1)),f.timestamp=ue,f.isProcessing=!0,o.process(f),C.process(f),M.process(f),I.process(f),j.process(f),q.process(f),K.process(f),J.process(f),f.isProcessing=!1,i&&t&&(s=!1,e(te))},oe=()=>{i=!0,s=!0,f.isProcessing||e(te)};return{schedule:Bw.reduce((ue,Pe)=>{const Oe=T[Pe];return ue[Pe]=(xe,Qe=!1,tt=!1)=>(i||oe(),Oe.schedule(xe,Qe,tt)),ue},{}),cancel:ue=>{for(let Pe=0;Pe<Bw.length;Pe++)T[Bw[Pe]].cancel(ue)},state:f,steps:T}}const{schedule:_s,cancel:Pg,state:Jl,steps:NS}=Bj(typeof requestAnimationFrame<"u"?requestAnimationFrame:vd,!0);let a1;function T9(){a1=void 0}const Uu={now:()=>(a1===void 0&&Uu.set(Jl.isProcessing||fm.useManualTiming?Jl.timestamp:performance.now()),a1),set:e=>{a1=e,queueMicrotask(T9)}},jj=e=>t=>typeof t=="string"&&t.startsWith(e),IC=jj("--"),S9=jj("var(--"),DC=e=>S9(e)?E9.test(e.split("/*")[0].trim()):!1,E9=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fv={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ox={...Fv,transform:e=>dm(0,1,e)},jw={...Fv,default:1},xx=e=>Math.round(e*1e5)/1e5,RC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function A9(e){return e==null}const P9=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,LC=(e,t)=>i=>!!(typeof i=="string"&&P9.test(i)&&i.startsWith(e)||t&&!A9(i)&&Object.prototype.hasOwnProperty.call(i,t)),Fj=(e,t,i)=>s=>{if(typeof s!="string")return s;const[f,y,T,o]=s.match(RC);return{[e]:parseFloat(f),[t]:parseFloat(y),[i]:parseFloat(T),alpha:o!==void 0?parseFloat(o):1}},C9=e=>dm(0,255,e),BS={...Fv,transform:e=>Math.round(C9(e))},F_={test:LC("rgb","red"),parse:Fj("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:s=1})=>"rgba("+BS.transform(e)+", "+BS.transform(t)+", "+BS.transform(i)+", "+xx(Ox.transform(s))+")"};function M9(e){let t="",i="",s="",f="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7),f=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),s=e.substring(3,4),f=e.substring(4,5),t+=t,i+=i,s+=s,f+=f),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(s,16),alpha:f?parseInt(f,16)/255:1}}const UA={test:LC("#"),parse:M9,transform:F_.transform},nb=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),gg=nb("deg"),lp=nb("%"),Cr=nb("px"),O9=nb("vh"),I9=nb("vw"),dL={...lp,parse:e=>lp.parse(e)/100,transform:e=>lp.transform(e*100)},fv={test:LC("hsl","hue"),parse:Fj("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:s=1})=>"hsla("+Math.round(e)+", "+lp.transform(xx(t))+", "+lp.transform(xx(i))+", "+xx(Ox.transform(s))+")"},_l={test:e=>F_.test(e)||UA.test(e)||fv.test(e),parse:e=>F_.test(e)?F_.parse(e):fv.test(e)?fv.parse(e):UA.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?F_.transform(e):fv.transform(e),getAnimatableNone:e=>{const t=_l.parse(e);return t.alpha=0,_l.transform(t)}},D9=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function R9(e){return isNaN(e)&&typeof e=="string"&&(e.match(RC)?.length||0)+(e.match(D9)?.length||0)>0}const Uj="number",Vj="color",L9="var",z9="var(",fL="${}",k9=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ix(e){const t=e.toString(),i=[],s={color:[],number:[],var:[]},f=[];let y=0;const o=t.replace(k9,C=>(_l.test(C)?(s.color.push(y),f.push(Vj),i.push(_l.parse(C))):C.startsWith(z9)?(s.var.push(y),f.push(L9),i.push(C)):(s.number.push(y),f.push(Uj),i.push(parseFloat(C))),++y,fL)).split(fL);return{values:i,split:o,indexes:s,types:f}}function $j(e){return Ix(e).values}function qj(e){const{split:t,types:i}=Ix(e),s=t.length;return f=>{let y="";for(let T=0;T<s;T++)if(y+=t[T],f[T]!==void 0){const o=i[T];o===Uj?y+=xx(f[T]):o===Vj?y+=_l.transform(f[T]):y+=f[T]}return y}}const N9=e=>typeof e=="number"?0:_l.test(e)?_l.getAnimatableNone(e):e;function B9(e){const t=$j(e);return qj(e)(t.map(N9))}const Cg={test:R9,parse:$j,createTransformer:qj,getAnimatableNone:B9};function jS(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function j9({hue:e,saturation:t,lightness:i,alpha:s}){e/=360,t/=100,i/=100;let f=0,y=0,T=0;if(!t)f=y=T=i;else{const o=i<.5?i*(1+t):i+t-i*t,C=2*i-o;f=jS(C,o,e+1/3),y=jS(C,o,e),T=jS(C,o,e-1/3)}return{red:Math.round(f*255),green:Math.round(y*255),blue:Math.round(T*255),alpha:s}}function x1(e,t){return i=>i>0?t:e}const Ms=(e,t,i)=>e+(t-e)*i,FS=(e,t,i)=>{const s=e*e,f=i*(t*t-s)+s;return f<0?0:Math.sqrt(f)},F9=[UA,F_,fv],U9=e=>F9.find(t=>t.test(e));function pL(e){const t=U9(e);if(!t)return!1;let i=t.parse(e);return t===fv&&(i=j9(i)),i}const mL=(e,t)=>{const i=pL(e),s=pL(t);if(!i||!s)return x1(e,t);const f={...i};return y=>(f.red=FS(i.red,s.red,y),f.green=FS(i.green,s.green,y),f.blue=FS(i.blue,s.blue,y),f.alpha=Ms(i.alpha,s.alpha,y),F_.transform(f))},VA=new Set(["none","hidden"]);function V9(e,t){return VA.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}function $9(e,t){return i=>Ms(e,t,i)}function zC(e){return typeof e=="number"?$9:typeof e=="string"?DC(e)?x1:_l.test(e)?mL:G9:Array.isArray(e)?Hj:typeof e=="object"?_l.test(e)?mL:q9:x1}function Hj(e,t){const i=[...e],s=i.length,f=e.map((y,T)=>zC(y)(y,t[T]));return y=>{for(let T=0;T<s;T++)i[T]=f[T](y);return i}}function q9(e,t){const i={...e,...t},s={};for(const f in i)e[f]!==void 0&&t[f]!==void 0&&(s[f]=zC(e[f])(e[f],t[f]));return f=>{for(const y in s)i[y]=s[y](f);return i}}function H9(e,t){const i=[],s={color:0,var:0,number:0};for(let f=0;f<t.values.length;f++){const y=t.types[f],T=e.indexes[y][s[y]],o=e.values[T]??0;i[f]=o,s[y]++}return i}const G9=(e,t)=>{const i=Cg.createTransformer(t),s=Ix(e),f=Ix(t);return s.indexes.var.length===f.indexes.var.length&&s.indexes.color.length===f.indexes.color.length&&s.indexes.number.length>=f.indexes.number.length?VA.has(e)&&!f.values.length||VA.has(t)&&!s.values.length?V9(e,t):eb(Hj(H9(s,f),f.values),i):x1(e,t)};function Gj(e,t,i){return typeof e=="number"&&typeof t=="number"&&typeof i=="number"?Ms(e,t,i):zC(e)(e,t)}const Z9=e=>{const t=({timestamp:i})=>e(i);return{start:(i=!0)=>_s.update(t,i),stop:()=>Pg(t),now:()=>Jl.isProcessing?Jl.timestamp:Uu.now()}},Zj=(e,t,i=10)=>{let s="";const f=Math.max(Math.round(t/i),2);for(let y=0;y<f;y++)s+=Math.round(e(y/(f-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},b1=2e4;function kC(e){let t=0;const i=50;let s=e.next(t);for(;!s.done&&t<b1;)t+=i,s=e.next(t);return t>=b1?1/0:t}function W9(e,t=100,i){const s=i({...e,keyframes:[0,t]}),f=Math.min(kC(s),b1);return{type:"keyframes",ease:y=>s.next(f*y).value/t,duration:sp(f)}}const X9=5;function Wj(e,t,i){const s=Math.max(t-X9,0);return Pj(i-e(s),t-s)}const $s={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},US=.001;function Y9({duration:e=$s.duration,bounce:t=$s.bounce,velocity:i=$s.velocity,mass:s=$s.mass}){let f,y,T=1-t;T=dm($s.minDamping,$s.maxDamping,T),e=dm($s.minDuration,$s.maxDuration,sp(e)),T<1?(f=M=>{const I=M*T,j=I*e,q=I-i,K=$A(M,T),J=Math.exp(-j);return US-q/K*J},y=M=>{const j=M*T*e,q=j*i+i,K=Math.pow(T,2)*Math.pow(M,2)*e,J=Math.exp(-j),te=$A(Math.pow(M,2),T);return(-f(M)+US>0?-1:1)*((q-K)*J)/te}):(f=M=>{const I=Math.exp(-M*e),j=(M-i)*e+1;return-US+I*j},y=M=>{const I=Math.exp(-M*e),j=(i-M)*(e*e);return I*j});const o=5/e,C=J9(f,y,o);if(e=ap(e),isNaN(C))return{stiffness:$s.stiffness,damping:$s.damping,duration:e};{const M=Math.pow(C,2)*s;return{stiffness:M,damping:T*2*Math.sqrt(s*M),duration:e}}}const K9=12;function J9(e,t,i){let s=i;for(let f=1;f<K9;f++)s=s-e(s)/t(s);return s}function $A(e,t){return e*Math.sqrt(1-t*t)}const Q9=["duration","bounce"],eZ=["stiffness","damping","mass"];function gL(e,t){return t.some(i=>e[i]!==void 0)}function tZ(e){let t={velocity:$s.velocity,stiffness:$s.stiffness,damping:$s.damping,mass:$s.mass,isResolvedFromDuration:!1,...e};if(!gL(e,eZ)&&gL(e,Q9))if(e.visualDuration){const i=e.visualDuration,s=2*Math.PI/(i*1.2),f=s*s,y=2*dm(.05,1,1-(e.bounce||0))*Math.sqrt(f);t={...t,mass:$s.mass,stiffness:f,damping:y}}else{const i=Y9(e);t={...t,...i,mass:$s.mass},t.isResolvedFromDuration=!0}return t}function w1(e=$s.visualDuration,t=$s.bounce){const i=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:f}=i;const y=i.keyframes[0],T=i.keyframes[i.keyframes.length-1],o={done:!1,value:y},{stiffness:C,damping:M,mass:I,duration:j,velocity:q,isResolvedFromDuration:K}=tZ({...i,velocity:-sp(i.velocity||0)}),J=q||0,te=M/(2*Math.sqrt(C*I)),oe=T-y,ce=sp(Math.sqrt(C/I)),de=Math.abs(oe)<5;s||(s=de?$s.restSpeed.granular:$s.restSpeed.default),f||(f=de?$s.restDelta.granular:$s.restDelta.default);let ue;if(te<1){const Oe=$A(ce,te);ue=xe=>{const Qe=Math.exp(-te*ce*xe);return T-Qe*((J+te*ce*oe)/Oe*Math.sin(Oe*xe)+oe*Math.cos(Oe*xe))}}else if(te===1)ue=Oe=>T-Math.exp(-ce*Oe)*(oe+(J+ce*oe)*Oe);else{const Oe=ce*Math.sqrt(te*te-1);ue=xe=>{const Qe=Math.exp(-te*ce*xe),tt=Math.min(Oe*xe,300);return T-Qe*((J+te*ce*oe)*Math.sinh(tt)+Oe*oe*Math.cosh(tt))/Oe}}const Pe={calculatedDuration:K&&j||null,next:Oe=>{const xe=ue(Oe);if(K)o.done=Oe>=j;else{let Qe=Oe===0?J:0;te<1&&(Qe=Oe===0?ap(J):Wj(ue,Oe,xe));const tt=Math.abs(Qe)<=s,Ge=Math.abs(T-xe)<=f;o.done=tt&&Ge}return o.value=o.done?T:xe,o},toString:()=>{const Oe=Math.min(kC(Pe),b1),xe=Zj(Qe=>Pe.next(Oe*Qe).value,Oe,30);return Oe+"ms "+xe},toTransition:()=>{}};return Pe}w1.applyToOptions=e=>{const t=W9(e,100,w1);return e.ease=t.ease,e.duration=ap(t.duration),e.type="keyframes",e};function qA({keyframes:e,velocity:t=0,power:i=.8,timeConstant:s=325,bounceDamping:f=10,bounceStiffness:y=500,modifyTarget:T,min:o,max:C,restDelta:M=.5,restSpeed:I}){const j=e[0],q={done:!1,value:j},K=tt=>o!==void 0&&tt<o||C!==void 0&&tt>C,J=tt=>o===void 0?C:C===void 0||Math.abs(o-tt)<Math.abs(C-tt)?o:C;let te=i*t;const oe=j+te,ce=T===void 0?oe:T(oe);ce!==oe&&(te=ce-j);const de=tt=>-te*Math.exp(-tt/s),ue=tt=>ce+de(tt),Pe=tt=>{const Ge=de(tt),Je=ue(tt);q.done=Math.abs(Ge)<=M,q.value=q.done?ce:Je};let Oe,xe;const Qe=tt=>{K(q.value)&&(Oe=tt,xe=w1({keyframes:[q.value,J(q.value)],velocity:Wj(ue,tt,q.value),damping:f,stiffness:y,restDelta:M,restSpeed:I}))};return Qe(0),{calculatedDuration:null,next:tt=>{let Ge=!1;return!xe&&Oe===void 0&&(Ge=!0,Pe(tt),Qe(tt)),Oe!==void 0&&tt>=Oe?xe.next(tt-Oe):(!Ge&&Pe(tt),q)}}}function nZ(e,t,i){const s=[],f=i||fm.mix||Gj,y=e.length-1;for(let T=0;T<y;T++){let o=f(e[T],e[T+1]);if(t){const C=Array.isArray(t)?t[T]||vd:t;o=eb(C,o)}s.push(o)}return s}function iZ(e,t,{clamp:i=!0,ease:s,mixer:f}={}){const y=e.length;if(AC(y===t.length),y===1)return()=>t[0];if(y===2&&t[0]===t[1])return()=>t[1];const T=e[0]===e[1];e[0]>e[y-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=nZ(t,s,f),C=o.length,M=I=>{if(T&&I<e[0])return t[0];let j=0;if(C>1)for(;j<e.length-2&&!(I<e[j+1]);j++);const q=Mx(e[j],e[j+1],I);return o[j](q)};return i?I=>M(dm(e[0],e[y-1],I)):M}function rZ(e,t){const i=e[e.length-1];for(let s=1;s<=t;s++){const f=Mx(0,t,s);e.push(Ms(i,1,f))}}function oZ(e){const t=[0];return rZ(t,e.length-1),t}function aZ(e,t){return e.map(i=>i*t)}function sZ(e,t){return e.map(()=>t||kj).splice(0,e.length-1)}function bx({duration:e=300,keyframes:t,times:i,ease:s="easeInOut"}){const f=y9(s)?s.map(uL):uL(s),y={done:!1,value:t[0]},T=aZ(i&&i.length===t.length?i:oZ(t),e),o=iZ(T,t,{ease:Array.isArray(f)?f:sZ(t,f)});return{calculatedDuration:e,next:C=>(y.value=o(C),y.done=C>=e,y)}}const lZ=e=>e!==null;function NC(e,{repeat:t,repeatType:i="loop"},s,f=1){const y=e.filter(lZ),o=f<0||t&&i!=="loop"&&t%2===1?0:y.length-1;return!o||s===void 0?y[o]:s}const cZ={decay:qA,inertia:qA,tween:bx,keyframes:bx,spring:w1};function Xj(e){typeof e.type=="string"&&(e.type=cZ[e.type])}class BC{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,i){return this.finished.then(t,i)}}const uZ=e=>e/100;class jC extends BC{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:i}=this.options;i&&i.updatedAt!==Uu.now()&&this.tick(Uu.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Xj(t);const{type:i=bx,repeat:s=0,repeatDelay:f=0,repeatType:y,velocity:T=0}=t;let{keyframes:o}=t;const C=i||bx;C!==bx&&typeof o[0]!="number"&&(this.mixKeyframes=eb(uZ,Gj(o[0],o[1])),o=[0,100]);const M=C({...t,keyframes:o});y==="mirror"&&(this.mirroredGenerator=C({...t,keyframes:[...o].reverse(),velocity:-T})),M.calculatedDuration===null&&(M.calculatedDuration=kC(M));const{calculatedDuration:I}=M;this.calculatedDuration=I,this.resolvedDuration=I+f,this.totalDuration=this.resolvedDuration*(s+1)-f,this.generator=M}updateTime(t){const i=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=i}tick(t,i=!1){const{generator:s,totalDuration:f,mixKeyframes:y,mirroredGenerator:T,resolvedDuration:o,calculatedDuration:C}=this;if(this.startTime===null)return s.next(0);const{delay:M=0,keyframes:I,repeat:j,repeatType:q,repeatDelay:K,type:J,onUpdate:te,finalKeyframe:oe}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-f/this.speed,this.startTime)),i?this.currentTime=t:this.updateTime(t);const ce=this.currentTime-M*(this.playbackSpeed>=0?1:-1),de=this.playbackSpeed>=0?ce<0:ce>f;this.currentTime=Math.max(ce,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let ue=this.currentTime,Pe=s;if(j){const tt=Math.min(this.currentTime,f)/o;let Ge=Math.floor(tt),Je=tt%1;!Je&&tt>=1&&(Je=1),Je===1&&Ge--,Ge=Math.min(Ge,j+1),!!(Ge%2)&&(q==="reverse"?(Je=1-Je,K&&(Je-=K/o)):q==="mirror"&&(Pe=T)),ue=dm(0,1,Je)*o}const Oe=de?{done:!1,value:I[0]}:Pe.next(ue);y&&(Oe.value=y(Oe.value));let{done:xe}=Oe;!de&&C!==null&&(xe=this.playbackSpeed>=0?this.currentTime>=f:this.currentTime<=0);const Qe=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&xe);return Qe&&J!==qA&&(Oe.value=NC(I,this.options,oe,this.speed)),te&&te(Oe.value),Qe&&this.finish(),Oe}then(t,i){return this.finished.then(t,i)}get duration(){return sp(this.calculatedDuration)}get time(){return sp(this.currentTime)}set time(t){t=ap(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Uu.now());const i=this.playbackSpeed!==t;this.playbackSpeed=t,i&&(this.time=sp(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Z9,startTime:i}=this.options;this.driver||(this.driver=t(f=>this.tick(f))),this.options.onPlay?.();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=i??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Uu.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function hZ(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const U_=e=>e*180/Math.PI,HA=e=>{const t=U_(Math.atan2(e[1],e[0]));return GA(t)},dZ={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:HA,rotateZ:HA,skewX:e=>U_(Math.atan(e[1])),skewY:e=>U_(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},GA=e=>(e=e%360,e<0&&(e+=360),e),_L=HA,yL=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),vL=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),fZ={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:yL,scaleY:vL,scale:e=>(yL(e)+vL(e))/2,rotateX:e=>GA(U_(Math.atan2(e[6],e[5]))),rotateY:e=>GA(U_(Math.atan2(-e[2],e[0]))),rotateZ:_L,rotate:_L,skewX:e=>U_(Math.atan(e[4])),skewY:e=>U_(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function ZA(e){return e.includes("scale")?1:0}function WA(e,t){if(!e||e==="none")return ZA(t);const i=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,f;if(i)s=fZ,f=i;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=dZ,f=o}if(!f)return ZA(t);const y=s[t],T=f[1].split(",").map(mZ);return typeof y=="function"?y(T):T[y]}const pZ=(e,t)=>{const{transform:i="none"}=getComputedStyle(e);return WA(i,t)};function mZ(e){return parseFloat(e.trim())}const Uv=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Vv=new Set(Uv),xL=e=>e===Fv||e===Cr,gZ=new Set(["x","y","z"]),_Z=Uv.filter(e=>!gZ.has(e));function yZ(e){const t=[];return _Z.forEach(i=>{const s=e.getValue(i);s!==void 0&&(t.push([i,s.get()]),s.set(i.startsWith("scale")?1:0))}),t}const X_={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>WA(t,"x"),y:(e,{transform:t})=>WA(t,"y")};X_.translateX=X_.x;X_.translateY=X_.y;const Y_=new Set;let XA=!1,YA=!1,KA=!1;function Yj(){if(YA){const e=Array.from(Y_).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),i=new Map;t.forEach(s=>{const f=yZ(s);f.length&&(i.set(s,f),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const f=i.get(s);f&&f.forEach(([y,T])=>{s.getValue(y)?.set(T)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}YA=!1,XA=!1,Y_.forEach(e=>e.complete(KA)),Y_.clear()}function Kj(){Y_.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(YA=!0)})}function vZ(){KA=!0,Kj(),Yj(),KA=!1}class FC{constructor(t,i,s,f,y,T=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=i,this.name=s,this.motionValue=f,this.element=y,this.isAsync=T}scheduleResolve(){this.state="scheduled",this.isAsync?(Y_.add(this),XA||(XA=!0,_s.read(Kj),_s.resolveKeyframes(Yj))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:i,element:s,motionValue:f}=this;if(t[0]===null){const y=f?.get(),T=t[t.length-1];if(y!==void 0)t[0]=y;else if(s&&i){const o=s.readValue(i,T);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=T),f&&y===void 0&&f.set(t[0])}hZ(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Y_.delete(this)}cancel(){this.state==="scheduled"&&(Y_.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const xZ=e=>e.startsWith("--");function bZ(e,t,i){xZ(t)?e.style.setProperty(t,i):e.style[t]=i}const wZ=PC(()=>window.ScrollTimeline!==void 0),TZ={};function SZ(e,t){const i=PC(e);return()=>TZ[t]??i()}const Jj=SZ(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),gx=([e,t,i,s])=>`cubic-bezier(${e}, ${t}, ${i}, ${s})`,bL={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gx([0,.65,.55,1]),circOut:gx([.55,0,1,.45]),backIn:gx([.31,.01,.66,-.59]),backOut:gx([.33,1.53,.69,.99])};function Qj(e,t){if(e)return typeof e=="function"?Jj()?Zj(e,t):"ease-out":Nj(e)?gx(e):Array.isArray(e)?e.map(i=>Qj(i,t)||bL.easeOut):bL[e]}function EZ(e,t,i,{delay:s=0,duration:f=300,repeat:y=0,repeatType:T="loop",ease:o="easeOut",times:C}={},M=void 0){const I={[t]:i};C&&(I.offset=C);const j=Qj(o,f);Array.isArray(j)&&(I.easing=j);const q={delay:s,duration:f,easing:Array.isArray(j)?"linear":j,fill:"both",iterations:y+1,direction:T==="reverse"?"alternate":"normal"};return M&&(q.pseudoElement=M),e.animate(I,q)}function eF(e){return typeof e=="function"&&"applyToOptions"in e}function AZ({type:e,...t}){return eF(e)&&Jj()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class PZ extends BC{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:i,name:s,keyframes:f,pseudoElement:y,allowFlatten:T=!1,finalKeyframe:o,onComplete:C}=t;this.isPseudoElement=!!y,this.allowFlatten=T,this.options=t,AC(typeof t.type!="string");const M=AZ(t);this.animation=EZ(i,s,f,M,y),M.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!y){const I=NC(f,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(I):bZ(i,s,I),this.animation.cancel()}C?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return sp(Number(t))}get time(){return sp(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=ap(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:i}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&wZ()?(this.animation.timeline=t,vd):i(this)}}const tF={anticipate:Rj,backInOut:Dj,circInOut:zj};function CZ(e){return e in tF}function MZ(e){typeof e.ease=="string"&&CZ(e.ease)&&(e.ease=tF[e.ease])}const wL=10;class OZ extends PZ{constructor(t){MZ(t),Xj(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:i,onUpdate:s,onComplete:f,element:y,...T}=this.options;if(!i)return;if(t!==void 0){i.set(t);return}const o=new jC({...T,autoplay:!1}),C=ap(this.finishedTime??this.time);i.setWithVelocity(o.sample(C-wL).value,o.sample(C).value,wL),o.stop()}}const TL=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Cg.test(e)||e==="0")&&!e.startsWith("url("));function IZ(e){const t=e[0];if(e.length===1)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}function DZ(e,t,i,s){const f=e[0];if(f===null)return!1;if(t==="display"||t==="visibility")return!0;const y=e[e.length-1],T=TL(f,t),o=TL(y,t);return!T||!o?!1:IZ(e)||(i==="spring"||eF(i))&&s}function nF(e){return Ej(e)&&"offsetHeight"in e}const RZ=new Set(["opacity","clipPath","filter","transform"]),LZ=PC(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function zZ(e){const{motionValue:t,name:i,repeatDelay:s,repeatType:f,damping:y,type:T}=e;if(!nF(t?.owner?.current))return!1;const{onUpdate:o,transformTemplate:C}=t.owner.getProps();return LZ()&&i&&RZ.has(i)&&(i!=="transform"||!C)&&!o&&!s&&f!=="mirror"&&y!==0&&T!=="inertia"}const kZ=40;class NZ extends BC{constructor({autoplay:t=!0,delay:i=0,type:s="keyframes",repeat:f=0,repeatDelay:y=0,repeatType:T="loop",keyframes:o,name:C,motionValue:M,element:I,...j}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Uu.now();const q={autoplay:t,delay:i,type:s,repeat:f,repeatDelay:y,repeatType:T,name:C,motionValue:M,element:I,...j},K=I?.KeyframeResolver||FC;this.keyframeResolver=new K(o,(J,te,oe)=>this.onKeyframesResolved(J,te,q,!oe),C,M,I),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,i,s,f){this.keyframeResolver=void 0;const{name:y,type:T,velocity:o,delay:C,isHandoff:M,onUpdate:I}=s;this.resolvedAt=Uu.now(),DZ(t,y,T,o)||((fm.instantAnimations||!C)&&I?.(NC(t,s,i)),t[0]=t[t.length-1],s.duration=0,s.repeat=0);const q={startTime:f?this.resolvedAt?this.resolvedAt-this.createdAt>kZ?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:i,...s,keyframes:t},K=!M&&zZ(q)?new OZ({...q,element:q.motionValue.owner.current}):new jC(q);K.finished.then(()=>this.notifyFinished()).catch(vd),this.pendingTimeline&&(this.stopTimeline=K.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=K}get finished(){return this._animation?this.animation.finished:this._finished}then(t,i){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),vZ()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const BZ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function jZ(e){const t=BZ.exec(e);if(!t)return[,];const[,i,s,f]=t;return[`--${i??s}`,f]}function iF(e,t,i=1){const[s,f]=jZ(e);if(!s)return;const y=window.getComputedStyle(t).getPropertyValue(s);if(y){const T=y.trim();return Sj(T)?parseFloat(T):T}return DC(f)?iF(f,t,i+1):f}function UC(e,t){return e?.[t]??e?.default??e}const rF=new Set(["width","height","top","left","right","bottom",...Uv]),FZ={test:e=>e==="auto",parse:e=>e},oF=e=>t=>t.test(e),aF=[Fv,Cr,lp,gg,I9,O9,FZ],SL=e=>aF.find(oF(e));function UZ(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Aj(e):!0}const VZ=new Set(["brightness","contrast","saturate","opacity"]);function $Z(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=i.match(RC)||[];if(!s)return e;const f=i.replace(s,"");let y=VZ.has(t)?1:0;return s!==i&&(y*=100),t+"("+y+f+")"}const qZ=/\b([a-z-]*)\(.*?\)/gu,JA={...Cg,getAnimatableNone:e=>{const t=e.match(qZ);return t?t.map($Z).join(" "):e}},EL={...Fv,transform:Math.round},HZ={rotate:gg,rotateX:gg,rotateY:gg,rotateZ:gg,scale:jw,scaleX:jw,scaleY:jw,scaleZ:jw,skew:gg,skewX:gg,skewY:gg,distance:Cr,translateX:Cr,translateY:Cr,translateZ:Cr,x:Cr,y:Cr,z:Cr,perspective:Cr,transformPerspective:Cr,opacity:Ox,originX:dL,originY:dL,originZ:Cr},VC={borderWidth:Cr,borderTopWidth:Cr,borderRightWidth:Cr,borderBottomWidth:Cr,borderLeftWidth:Cr,borderRadius:Cr,radius:Cr,borderTopLeftRadius:Cr,borderTopRightRadius:Cr,borderBottomRightRadius:Cr,borderBottomLeftRadius:Cr,width:Cr,maxWidth:Cr,height:Cr,maxHeight:Cr,top:Cr,right:Cr,bottom:Cr,left:Cr,padding:Cr,paddingTop:Cr,paddingRight:Cr,paddingBottom:Cr,paddingLeft:Cr,margin:Cr,marginTop:Cr,marginRight:Cr,marginBottom:Cr,marginLeft:Cr,backgroundPositionX:Cr,backgroundPositionY:Cr,...HZ,zIndex:EL,fillOpacity:Ox,strokeOpacity:Ox,numOctaves:EL},GZ={...VC,color:_l,backgroundColor:_l,outlineColor:_l,fill:_l,stroke:_l,borderColor:_l,borderTopColor:_l,borderRightColor:_l,borderBottomColor:_l,borderLeftColor:_l,filter:JA,WebkitFilter:JA},sF=e=>GZ[e];function lF(e,t){let i=sF(e);return i!==JA&&(i=Cg),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const ZZ=new Set(["auto","none","0"]);function WZ(e,t,i){let s=0,f;for(;s<e.length&&!f;){const y=e[s];typeof y=="string"&&!ZZ.has(y)&&Ix(y).values.length&&(f=e[s]),s++}if(f&&i)for(const y of t)e[y]=lF(i,f)}class XZ extends FC{constructor(t,i,s,f,y){super(t,i,s,f,y,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:i,name:s}=this;if(!i||!i.current)return;super.readKeyframes();for(let C=0;C<t.length;C++){let M=t[C];if(typeof M=="string"&&(M=M.trim(),DC(M))){const I=iF(M,i.current);I!==void 0&&(t[C]=I),C===t.length-1&&(this.finalKeyframe=M)}}if(this.resolveNoneKeyframes(),!rF.has(s)||t.length!==2)return;const[f,y]=t,T=SL(f),o=SL(y);if(T!==o)if(xL(T)&&xL(o))for(let C=0;C<t.length;C++){const M=t[C];typeof M=="string"&&(t[C]=parseFloat(M))}else X_[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:i}=this,s=[];for(let f=0;f<t.length;f++)(t[f]===null||UZ(t[f]))&&s.push(f);s.length&&WZ(t,s,i)}measureInitialState(){const{element:t,unresolvedKeyframes:i,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=X_[s](t.measureViewportBox(),window.getComputedStyle(t.current)),i[0]=this.measuredOrigin;const f=i[i.length-1];f!==void 0&&t.getValue(s,f).jump(f,!1)}measureEndState(){const{element:t,name:i,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const f=t.getValue(i);f&&f.jump(this.measuredOrigin,!1);const y=s.length-1,T=s[y];s[y]=X_[i](t.measureViewportBox(),window.getComputedStyle(t.current)),T!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=T),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,C])=>{t.getValue(o).set(C)}),this.resolveNoneKeyframes()}}function cF(e,t,i){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const f=document.querySelectorAll(e);return f?Array.from(f):[]}return Array.from(e)}const uF=(e,t)=>t&&typeof e=="number"?t.transform(e):e,AL=30,YZ=e=>!isNaN(parseFloat(e));class KZ{constructor(t,i={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,f=!0)=>{const y=Uu.now();if(this.updatedAt!==y&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const T of this.dependents)T.dirty();f&&this.events.renderRequest?.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=i.owner}setCurrent(t){this.current=t,this.updatedAt=Uu.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=YZ(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new CC);const s=this.events[t].add(i);return t==="change"?()=>{s(),_s.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t,i=!0){!i||!this.passiveEffect?this.updateAndNotify(t,i):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,i,s){this.set(i),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,i=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Uu.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>AL)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,AL);return Pj(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ev(e,t){return new KZ(e,t)}const{schedule:$C}=Bj(queueMicrotask,!1),uf={x:!1,y:!1};function hF(){return uf.x||uf.y}function JZ(e){return e==="x"||e==="y"?uf[e]?null:(uf[e]=!0,()=>{uf[e]=!1}):uf.x||uf.y?null:(uf.x=uf.y=!0,()=>{uf.x=uf.y=!1})}function dF(e,t){const i=cF(e),s=new AbortController,f={passive:!0,...t,signal:s.signal};return[i,f,()=>s.abort()]}function PL(e){return!(e.pointerType==="touch"||hF())}function QZ(e,t,i={}){const[s,f,y]=dF(e,i),T=o=>{if(!PL(o))return;const{target:C}=o,M=t(C,o);if(typeof M!="function"||!C)return;const I=j=>{PL(j)&&(M(j),C.removeEventListener("pointerleave",I))};C.addEventListener("pointerleave",I,f)};return s.forEach(o=>{o.addEventListener("pointerenter",T,f)}),y}const fF=(e,t)=>t?e===t?!0:fF(e,t.parentElement):!1,qC=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,eW=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function tW(e){return eW.has(e.tagName)||e.tabIndex!==-1}const s1=new WeakSet;function CL(e){return t=>{t.key==="Enter"&&e(t)}}function VS(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const nW=(e,t)=>{const i=e.currentTarget;if(!i)return;const s=CL(()=>{if(s1.has(i))return;VS(i,"down");const f=CL(()=>{VS(i,"up")}),y=()=>VS(i,"cancel");i.addEventListener("keyup",f,t),i.addEventListener("blur",y,t)});i.addEventListener("keydown",s,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",s),t)};function ML(e){return qC(e)&&!hF()}function iW(e,t,i={}){const[s,f,y]=dF(e,i),T=o=>{const C=o.currentTarget;if(!ML(o))return;s1.add(C);const M=t(C,o),I=(K,J)=>{window.removeEventListener("pointerup",j),window.removeEventListener("pointercancel",q),s1.has(C)&&s1.delete(C),ML(K)&&typeof M=="function"&&M(K,{success:J})},j=K=>{I(K,C===window||C===document||i.useGlobalTarget||fF(C,K.target))},q=K=>{I(K,!1)};window.addEventListener("pointerup",j,f),window.addEventListener("pointercancel",q,f)};return s.forEach(o=>{(i.useGlobalTarget?window:o).addEventListener("pointerdown",T,f),nF(o)&&(o.addEventListener("focus",M=>nW(M,f)),!tW(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),y}function pF(e){return Ej(e)&&"ownerSVGElement"in e}function rW(e){return pF(e)&&e.tagName==="svg"}const Rc=e=>!!(e&&e.getVelocity),oW=[...aF,_l,Cg],aW=e=>oW.find(oF(e)),mF=me.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function sW(e=!0){const t=me.useContext(TC);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:s,register:f}=t,y=me.useId();me.useEffect(()=>{if(e)return f(y)},[e]);const T=me.useCallback(()=>e&&s&&s(y),[y,s,e]);return!i&&s?[!1,T]:[!0]}const gF=me.createContext({strict:!1}),OL={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Av={};for(const e in OL)Av[e]={isEnabled:t=>OL[e].some(i=>!!t[i])};function lW(e){for(const t in e)Av[t]={...Av[t],...e[t]}}const cW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function T1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||cW.has(e)}let _F=e=>!T1(e);function uW(e){typeof e=="function"&&(_F=t=>t.startsWith("on")?!T1(t):e(t))}try{uW(require("@emotion/is-prop-valid").default)}catch{}function hW(e,t,i){const s={};for(const f in e)f==="values"&&typeof e.values=="object"||(_F(f)||i===!0&&T1(f)||!t&&!T1(f)||e.draggable&&f.startsWith("onDrag"))&&(s[f]=e[f]);return s}function dW(e){if(typeof Proxy>"u")return e;const t=new Map,i=(...s)=>e(...s);return new Proxy(i,{get:(s,f)=>f==="create"?e:(t.has(f)||t.set(f,e(f)),t.get(f))})}const AT=me.createContext({});function PT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Dx(e){return typeof e=="string"||Array.isArray(e)}const HC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],GC=["initial",...HC];function CT(e){return PT(e.animate)||GC.some(t=>Dx(e[t]))}function yF(e){return!!(CT(e)||e.variants)}function fW(e,t){if(CT(e)){const{initial:i,animate:s}=e;return{initial:i===!1||Dx(i)?i:void 0,animate:Dx(s)?s:void 0}}return e.inherit!==!1?t:{}}function pW(e){const{initial:t,animate:i}=fW(e,me.useContext(AT));return me.useMemo(()=>({initial:t,animate:i}),[IL(t),IL(i)])}function IL(e){return Array.isArray(e)?e.join(" "):e}const mW=Symbol.for("motionComponentSymbol");function pv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function gW(e,t,i){return me.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),i&&(typeof i=="function"?i(s):pv(i)&&(i.current=s))},[t])}const ZC=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),_W="framerAppearId",vF="data-"+ZC(_W),xF=me.createContext({});function yW(e,t,i,s,f){const{visualElement:y}=me.useContext(AT),T=me.useContext(gF),o=me.useContext(TC),C=me.useContext(mF).reducedMotion,M=me.useRef(null);s=s||T.renderer,!M.current&&s&&(M.current=s(e,{visualState:t,parent:y,props:i,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:C}));const I=M.current,j=me.useContext(xF);I&&!I.projection&&f&&(I.type==="html"||I.type==="svg")&&vW(M.current,i,f,j);const q=me.useRef(!1);me.useInsertionEffect(()=>{I&&q.current&&I.update(i,o)});const K=i[vF],J=me.useRef(!!K&&!window.MotionHandoffIsComplete?.(K)&&window.MotionHasOptimisedAnimation?.(K));return h9(()=>{I&&(q.current=!0,window.MotionIsMounted=!0,I.updateFeatures(),$C.render(I.render),J.current&&I.animationState&&I.animationState.animateChanges())}),me.useEffect(()=>{I&&(!J.current&&I.animationState&&I.animationState.animateChanges(),J.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(K)}),J.current=!1))}),I}function vW(e,t,i,s){const{layoutId:f,layout:y,drag:T,dragConstraints:o,layoutScroll:C,layoutRoot:M,layoutCrossfade:I}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:bF(e.parent)),e.projection.setOptions({layoutId:f,layout:y,alwaysMeasureLayout:!!T||o&&pv(o),visualElement:e,animationType:typeof y=="string"?y:"both",initialPromotionConfig:s,crossfade:I,layoutScroll:C,layoutRoot:M})}function bF(e){if(e)return e.options.allowProjection!==!1?e.projection:bF(e.parent)}function xW({preloadedFeatures:e,createVisualElement:t,useRender:i,useVisualState:s,Component:f}){e&&lW(e);function y(o,C){let M;const I={...me.useContext(mF),...o,layoutId:bW(o)},{isStatic:j}=I,q=pW(o),K=s(o,j);if(!j&&wC){wW();const J=TW(I);M=J.MeasureLayout,q.visualElement=yW(f,K,I,t,J.ProjectionNode)}return ie.jsxs(AT.Provider,{value:q,children:[M&&q.visualElement?ie.jsx(M,{visualElement:q.visualElement,...I}):null,i(f,o,gW(K,q.visualElement,C),K,j,q.visualElement)]})}y.displayName=`motion.${typeof f=="string"?f:`create(${f.displayName??f.name??""})`}`;const T=me.forwardRef(y);return T[mW]=f,T}function bW({layoutId:e}){const t=me.useContext(Tj).id;return t&&e!==void 0?t+"-"+e:e}function wW(e,t){me.useContext(gF).strict}function TW(e){const{drag:t,layout:i}=Av;if(!t&&!i)return{};const s={...t,...i};return{MeasureLayout:t?.isEnabled(e)||i?.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const Rx={};function SW(e){for(const t in e)Rx[t]=e[t],IC(t)&&(Rx[t].isCSSVariable=!0)}function wF(e,{layout:t,layoutId:i}){return Vv.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!Rx[e]||e==="opacity")}const EW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},AW=Uv.length;function PW(e,t,i){let s="",f=!0;for(let y=0;y<AW;y++){const T=Uv[y],o=e[T];if(o===void 0)continue;let C=!0;if(typeof o=="number"?C=o===(T.startsWith("scale")?1:0):C=parseFloat(o)===0,!C||i){const M=uF(o,VC[T]);if(!C){f=!1;const I=EW[T]||T;s+=`${I}(${M}) `}i&&(t[T]=M)}}return s=s.trim(),i?s=i(t,f?"":s):f&&(s="none"),s}function WC(e,t,i){const{style:s,vars:f,transformOrigin:y}=e;let T=!1,o=!1;for(const C in t){const M=t[C];if(Vv.has(C)){T=!0;continue}else if(IC(C)){f[C]=M;continue}else{const I=uF(M,VC[C]);C.startsWith("origin")?(o=!0,y[C]=I):s[C]=I}}if(t.transform||(T||i?s.transform=PW(t,e.transform,i):s.transform&&(s.transform="none")),o){const{originX:C="50%",originY:M="50%",originZ:I=0}=y;s.transformOrigin=`${C} ${M} ${I}`}}const XC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function TF(e,t,i){for(const s in t)!Rc(t[s])&&!wF(s,i)&&(e[s]=t[s])}function CW({transformTemplate:e},t){return me.useMemo(()=>{const i=XC();return WC(i,t,e),Object.assign({},i.vars,i.style)},[t])}function MW(e,t){const i=e.style||{},s={};return TF(s,i,e),Object.assign(s,CW(e,t)),s}function OW(e,t){const i={},s=MW(e,t);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=s,i}const IW={offset:"stroke-dashoffset",array:"stroke-dasharray"},DW={offset:"strokeDashoffset",array:"strokeDasharray"};function RW(e,t,i=1,s=0,f=!0){e.pathLength=1;const y=f?IW:DW;e[y.offset]=Cr.transform(-s);const T=Cr.transform(t),o=Cr.transform(i);e[y.array]=`${T} ${o}`}function SF(e,{attrX:t,attrY:i,attrScale:s,pathLength:f,pathSpacing:y=1,pathOffset:T=0,...o},C,M,I){if(WC(e,o,M),C){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:j,style:q}=e;j.transform&&(q.transform=j.transform,delete j.transform),(q.transform||j.transformOrigin)&&(q.transformOrigin=j.transformOrigin??"50% 50%",delete j.transformOrigin),q.transform&&(q.transformBox=I?.transformBox??"fill-box",delete j.transformBox),t!==void 0&&(j.x=t),i!==void 0&&(j.y=i),s!==void 0&&(j.scale=s),f!==void 0&&RW(j,f,y,T,!1)}const EF=()=>({...XC(),attrs:{}}),AF=e=>typeof e=="string"&&e.toLowerCase()==="svg";function LW(e,t,i,s){const f=me.useMemo(()=>{const y=EF();return SF(y,t,AF(s),e.transformTemplate,e.style),{...y.attrs,style:{...y.style}}},[t]);if(e.style){const y={};TF(y,e.style,e),f.style={...y,...f.style}}return f}const zW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function YC(e){return typeof e!="string"||e.includes("-")?!1:!!(zW.indexOf(e)>-1||/[A-Z]/u.test(e))}function kW(e=!1){return(i,s,f,{latestValues:y},T)=>{const C=(YC(i)?LW:OW)(s,y,T,i),M=hW(s,typeof i=="string",e),I=i!==me.Fragment?{...M,...C,ref:f}:{},{children:j}=s,q=me.useMemo(()=>Rc(j)?j.get():j,[j]);return me.createElement(i,{...I,children:q})}}function DL(e){const t=[{},{}];return e?.values.forEach((i,s)=>{t[0][s]=i.get(),t[1][s]=i.getVelocity()}),t}function KC(e,t,i,s){if(typeof t=="function"){const[f,y]=DL(s);t=t(i!==void 0?i:e.custom,f,y)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[f,y]=DL(s);t=t(i!==void 0?i:e.custom,f,y)}return t}function l1(e){return Rc(e)?e.get():e}function NW({scrapeMotionValuesFromProps:e,createRenderState:t},i,s,f){return{latestValues:BW(i,s,f,e),renderState:t()}}const PF=e=>(t,i)=>{const s=me.useContext(AT),f=me.useContext(TC),y=()=>NW(e,t,s,f);return i?y():u9(y)};function BW(e,t,i,s){const f={},y=s(e,{});for(const q in y)f[q]=l1(y[q]);let{initial:T,animate:o}=e;const C=CT(e),M=yF(e);t&&M&&!C&&e.inherit!==!1&&(T===void 0&&(T=t.initial),o===void 0&&(o=t.animate));let I=i?i.initial===!1:!1;I=I||T===!1;const j=I?o:T;if(j&&typeof j!="boolean"&&!PT(j)){const q=Array.isArray(j)?j:[j];for(let K=0;K<q.length;K++){const J=KC(e,q[K]);if(J){const{transitionEnd:te,transition:oe,...ce}=J;for(const de in ce){let ue=ce[de];if(Array.isArray(ue)){const Pe=I?ue.length-1:0;ue=ue[Pe]}ue!==null&&(f[de]=ue)}for(const de in te)f[de]=te[de]}}}return f}function JC(e,t,i){const{style:s}=e,f={};for(const y in s)(Rc(s[y])||t.style&&Rc(t.style[y])||wF(y,e)||i?.getValue(y)?.liveStyle!==void 0)&&(f[y]=s[y]);return f}const jW={useVisualState:PF({scrapeMotionValuesFromProps:JC,createRenderState:XC})};function CF(e,t,i){const s=JC(e,t,i);for(const f in e)if(Rc(e[f])||Rc(t[f])){const y=Uv.indexOf(f)!==-1?"attr"+f.charAt(0).toUpperCase()+f.substring(1):f;s[y]=e[f]}return s}const FW={useVisualState:PF({scrapeMotionValuesFromProps:CF,createRenderState:EF})};function UW(e,t){return function(s,{forwardMotionProps:f}={forwardMotionProps:!1}){const T={...YC(s)?FW:jW,preloadedFeatures:e,useRender:kW(f),createVisualElement:t,Component:s};return xW(T)}}function Lx(e,t,i){const s=e.getProps();return KC(s,t,i!==void 0?i:s.custom,e)}const QA=e=>Array.isArray(e);function VW(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,Ev(i))}function $W(e){return QA(e)?e[e.length-1]||0:e}function qW(e,t){const i=Lx(e,t);let{transitionEnd:s={},transition:f={},...y}=i||{};y={...y,...s};for(const T in y){const o=$W(y[T]);VW(e,T,o)}}function HW(e){return!!(Rc(e)&&e.add)}function eP(e,t){const i=e.getValue("willChange");if(HW(i))return i.add(t);if(!i&&fm.WillChange){const s=new fm.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function MF(e){return e.props[vF]}const GW=e=>e!==null;function ZW(e,{repeat:t,repeatType:i="loop"},s){const f=e.filter(GW),y=t&&i!=="loop"&&t%2===1?0:f.length-1;return f[y]}const WW={type:"spring",stiffness:500,damping:25,restSpeed:10},XW=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),YW={type:"keyframes",duration:.8},KW={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},JW=(e,{keyframes:t})=>t.length>2?YW:Vv.has(e)?e.startsWith("scale")?XW(t[1]):WW:KW;function QW({when:e,delay:t,delayChildren:i,staggerChildren:s,staggerDirection:f,repeat:y,repeatType:T,repeatDelay:o,from:C,elapsed:M,...I}){return!!Object.keys(I).length}const QC=(e,t,i,s={},f,y)=>T=>{const o=UC(s,e)||{},C=o.delay||s.delay||0;let{elapsed:M=0}=s;M=M-ap(C);const I={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-M,onUpdate:q=>{t.set(q),o.onUpdate&&o.onUpdate(q)},onComplete:()=>{T(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:y?void 0:f};QW(o)||Object.assign(I,JW(e,I)),I.duration&&(I.duration=ap(I.duration)),I.repeatDelay&&(I.repeatDelay=ap(I.repeatDelay)),I.from!==void 0&&(I.keyframes[0]=I.from);let j=!1;if((I.type===!1||I.duration===0&&!I.repeatDelay)&&(I.duration=0,I.delay===0&&(j=!0)),(fm.instantAnimations||fm.skipAnimations)&&(j=!0,I.duration=0,I.delay=0),I.allowFlatten=!o.type&&!o.ease,j&&!y&&t.get()!==void 0){const q=ZW(I.keyframes,o);if(q!==void 0){_s.update(()=>{I.onUpdate(q),I.onComplete()});return}}return o.isSync?new jC(I):new NZ(I)};function eX({protectedKeys:e,needsAnimating:t},i){const s=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,s}function OF(e,t,{delay:i=0,transitionOverride:s,type:f}={}){let{transition:y=e.getDefaultTransition(),transitionEnd:T,...o}=t;s&&(y=s);const C=[],M=f&&e.animationState&&e.animationState.getState()[f];for(const I in o){const j=e.getValue(I,e.latestValues[I]??null),q=o[I];if(q===void 0||M&&eX(M,I))continue;const K={delay:i,...UC(y||{},I)},J=j.get();if(J!==void 0&&!j.isAnimating&&!Array.isArray(q)&&q===J&&!K.velocity)continue;let te=!1;if(window.MotionHandoffAnimation){const ce=MF(e);if(ce){const de=window.MotionHandoffAnimation(ce,I,_s);de!==null&&(K.startTime=de,te=!0)}}eP(e,I),j.start(QC(I,j,q,e.shouldReduceMotion&&rF.has(I)?{type:!1}:K,e,te));const oe=j.animation;oe&&C.push(oe)}return T&&Promise.all(C).then(()=>{_s.update(()=>{T&&qW(e,T)})}),C}function tP(e,t,i={}){const s=Lx(e,t,i.type==="exit"?e.presenceContext?.custom:void 0);let{transition:f=e.getDefaultTransition()||{}}=s||{};i.transitionOverride&&(f=i.transitionOverride);const y=s?()=>Promise.all(OF(e,s,i)):()=>Promise.resolve(),T=e.variantChildren&&e.variantChildren.size?(C=0)=>{const{delayChildren:M=0,staggerChildren:I,staggerDirection:j}=f;return tX(e,t,C,M,I,j,i)}:()=>Promise.resolve(),{when:o}=f;if(o){const[C,M]=o==="beforeChildren"?[y,T]:[T,y];return C().then(()=>M())}else return Promise.all([y(),T(i.delay)])}function tX(e,t,i=0,s=0,f=0,y=1,T){const o=[],C=e.variantChildren.size,M=(C-1)*f,I=typeof s=="function",j=I?q=>s(q,C):y===1?(q=0)=>q*f:(q=0)=>M-q*f;return Array.from(e.variantChildren).sort(nX).forEach((q,K)=>{q.notify("AnimationStart",t),o.push(tP(q,t,{...T,delay:i+(I?0:s)+j(K)}).then(()=>q.notify("AnimationComplete",t)))}),Promise.all(o)}function nX(e,t){return e.sortNodePosition(t)}function iX(e,t,i={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const f=t.map(y=>tP(e,y,i));s=Promise.all(f)}else if(typeof t=="string")s=tP(e,t,i);else{const f=typeof t=="function"?Lx(e,t,i.custom):t;s=Promise.all(OF(e,f,i))}return s.then(()=>{e.notify("AnimationComplete",t)})}function IF(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let s=0;s<i;s++)if(t[s]!==e[s])return!1;return!0}const rX=GC.length;function DF(e){if(!e)return;if(!e.isControllingVariants){const i=e.parent?DF(e.parent)||{}:{};return e.props.initial!==void 0&&(i.initial=e.props.initial),i}const t={};for(let i=0;i<rX;i++){const s=GC[i],f=e.props[s];(Dx(f)||f===!1)&&(t[s]=f)}return t}const oX=[...HC].reverse(),aX=HC.length;function sX(e){return t=>Promise.all(t.map(({animation:i,options:s})=>iX(e,i,s)))}function lX(e){let t=sX(e),i=RL(),s=!0;const f=C=>(M,I)=>{const j=Lx(e,I,C==="exit"?e.presenceContext?.custom:void 0);if(j){const{transition:q,transitionEnd:K,...J}=j;M={...M,...J,...K}}return M};function y(C){t=C(e)}function T(C){const{props:M}=e,I=DF(e.parent)||{},j=[],q=new Set;let K={},J=1/0;for(let oe=0;oe<aX;oe++){const ce=oX[oe],de=i[ce],ue=M[ce]!==void 0?M[ce]:I[ce],Pe=Dx(ue),Oe=ce===C?de.isActive:null;Oe===!1&&(J=oe);let xe=ue===I[ce]&&ue!==M[ce]&&Pe;if(xe&&s&&e.manuallyAnimateOnMount&&(xe=!1),de.protectedKeys={...K},!de.isActive&&Oe===null||!ue&&!de.prevProp||PT(ue)||typeof ue=="boolean")continue;const Qe=cX(de.prevProp,ue);let tt=Qe||ce===C&&de.isActive&&!xe&&Pe||oe>J&&Pe,Ge=!1;const Je=Array.isArray(ue)?ue:[ue];let Ve=Je.reduce(f(ce),{});Oe===!1&&(Ve={});const{prevResolvedValues:xt={}}=de,yt={...xt,...Ve},ot=Bt=>{tt=!0,q.has(Bt)&&(Ge=!0,q.delete(Bt)),de.needsAnimating[Bt]=!0;const Vt=e.getValue(Bt);Vt&&(Vt.liveStyle=!1)};for(const Bt in yt){const Vt=Ve[Bt],Ln=xt[Bt];if(K.hasOwnProperty(Bt))continue;let $e=!1;QA(Vt)&&QA(Ln)?$e=!IF(Vt,Ln):$e=Vt!==Ln,$e?Vt!=null?ot(Bt):q.add(Bt):Vt!==void 0&&q.has(Bt)?ot(Bt):de.protectedKeys[Bt]=!0}de.prevProp=ue,de.prevResolvedValues=Ve,de.isActive&&(K={...K,...Ve}),s&&e.blockInitialAnimation&&(tt=!1),tt&&(!(xe&&Qe)||Ge)&&j.push(...Je.map(Bt=>({animation:Bt,options:{type:ce}})))}if(q.size){const oe={};if(typeof M.initial!="boolean"){const ce=Lx(e,Array.isArray(M.initial)?M.initial[0]:M.initial);ce&&ce.transition&&(oe.transition=ce.transition)}q.forEach(ce=>{const de=e.getBaseTarget(ce),ue=e.getValue(ce);ue&&(ue.liveStyle=!0),oe[ce]=de??null}),j.push({animation:oe})}let te=!!j.length;return s&&(M.initial===!1||M.initial===M.animate)&&!e.manuallyAnimateOnMount&&(te=!1),s=!1,te?t(j):Promise.resolve()}function o(C,M){if(i[C].isActive===M)return Promise.resolve();e.variantChildren?.forEach(j=>j.animationState?.setActive(C,M)),i[C].isActive=M;const I=T(C);for(const j in i)i[j].protectedKeys={};return I}return{animateChanges:T,setActive:o,setAnimateFunction:y,getState:()=>i,reset:()=>{i=RL(),s=!0}}}function cX(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!IF(t,e):!1}function D_(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function RL(){return{animate:D_(!0),whileInView:D_(),whileHover:D_(),whileTap:D_(),whileDrag:D_(),whileFocus:D_(),exit:D_()}}class Dg{constructor(t){this.isMounted=!1,this.node=t}update(){}}class uX extends Dg{constructor(t){super(t),t.animationState||(t.animationState=lX(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();PT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let hX=0;class dX extends Dg{constructor(){super(...arguments),this.id=hX++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const f=this.node.animationState.setActive("exit",!t);i&&!t&&f.then(()=>{i(this.id)})}mount(){const{register:t,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const fX={animation:{Feature:uX},exit:{Feature:dX}};function zx(e,t,i,s={passive:!0}){return e.addEventListener(t,i,s),()=>e.removeEventListener(t,i)}function ib(e){return{point:{x:e.pageX,y:e.pageY}}}const pX=e=>t=>qC(t)&&e(t,ib(t));function wx(e,t,i,s){return zx(e,t,pX(i),s)}function RF({top:e,left:t,right:i,bottom:s}){return{x:{min:t,max:i},y:{min:e,max:s}}}function mX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function gX(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:s.y,right:s.x}}const LF=1e-4,_X=1-LF,yX=1+LF,zF=.01,vX=0-zF,xX=0+zF;function ou(e){return e.max-e.min}function bX(e,t,i){return Math.abs(e-t)<=i}function LL(e,t,i,s=.5){e.origin=s,e.originPoint=Ms(t.min,t.max,e.origin),e.scale=ou(i)/ou(t),e.translate=Ms(i.min,i.max,e.origin)-e.originPoint,(e.scale>=_X&&e.scale<=yX||isNaN(e.scale))&&(e.scale=1),(e.translate>=vX&&e.translate<=xX||isNaN(e.translate))&&(e.translate=0)}function Tx(e,t,i,s){LL(e.x,t.x,i.x,s?s.originX:void 0),LL(e.y,t.y,i.y,s?s.originY:void 0)}function zL(e,t,i){e.min=i.min+t.min,e.max=e.min+ou(t)}function wX(e,t,i){zL(e.x,t.x,i.x),zL(e.y,t.y,i.y)}function kL(e,t,i){e.min=t.min-i.min,e.max=e.min+ou(t)}function Sx(e,t,i){kL(e.x,t.x,i.x),kL(e.y,t.y,i.y)}const NL=()=>({translate:0,scale:1,origin:0,originPoint:0}),mv=()=>({x:NL(),y:NL()}),BL=()=>({min:0,max:0}),nl=()=>({x:BL(),y:BL()});function fd(e){return[e("x"),e("y")]}function $S(e){return e===void 0||e===1}function nP({scale:e,scaleX:t,scaleY:i}){return!$S(e)||!$S(t)||!$S(i)}function L_(e){return nP(e)||kF(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function kF(e){return jL(e.x)||jL(e.y)}function jL(e){return e&&e!=="0%"}function S1(e,t,i){const s=e-i,f=t*s;return i+f}function FL(e,t,i,s,f){return f!==void 0&&(e=S1(e,f,s)),S1(e,i,s)+t}function iP(e,t=0,i=1,s,f){e.min=FL(e.min,t,i,s,f),e.max=FL(e.max,t,i,s,f)}function NF(e,{x:t,y:i}){iP(e.x,t.translate,t.scale,t.originPoint),iP(e.y,i.translate,i.scale,i.originPoint)}const UL=.999999999999,VL=1.0000000000001;function TX(e,t,i,s=!1){const f=i.length;if(!f)return;t.x=t.y=1;let y,T;for(let o=0;o<f;o++){y=i[o],T=y.projectionDelta;const{visualElement:C}=y.options;C&&C.props.style&&C.props.style.display==="contents"||(s&&y.options.layoutScroll&&y.scroll&&y!==y.root&&_v(e,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),T&&(t.x*=T.x.scale,t.y*=T.y.scale,NF(e,T)),s&&L_(y.latestValues)&&_v(e,y.latestValues))}t.x<VL&&t.x>UL&&(t.x=1),t.y<VL&&t.y>UL&&(t.y=1)}function gv(e,t){e.min=e.min+t,e.max=e.max+t}function $L(e,t,i,s,f=.5){const y=Ms(e.min,e.max,f);iP(e,t,i,y,s)}function _v(e,t){$L(e.x,t.x,t.scaleX,t.scale,t.originX),$L(e.y,t.y,t.scaleY,t.scale,t.originY)}function BF(e,t){return RF(gX(e.getBoundingClientRect(),t))}function SX(e,t,i){const s=BF(e,i),{scroll:f}=t;return f&&(gv(s.x,f.offset.x),gv(s.y,f.offset.y)),s}const jF=({current:e})=>e?e.ownerDocument.defaultView:null,qL=(e,t)=>Math.abs(e-t);function EX(e,t){const i=qL(e.x,t.x),s=qL(e.y,t.y);return Math.sqrt(i**2+s**2)}class FF{constructor(t,i,{transformPagePoint:s,contextWindow:f=window,dragSnapToOrigin:y=!1,distanceThreshold:T=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const q=HS(this.lastMoveEventInfo,this.history),K=this.startEvent!==null,J=EX(q.offset,{x:0,y:0})>=this.distanceThreshold;if(!K&&!J)return;const{point:te}=q,{timestamp:oe}=Jl;this.history.push({...te,timestamp:oe});const{onStart:ce,onMove:de}=this.handlers;K||(ce&&ce(this.lastMoveEvent,q),this.startEvent=this.lastMoveEvent),de&&de(this.lastMoveEvent,q)},this.handlePointerMove=(q,K)=>{this.lastMoveEvent=q,this.lastMoveEventInfo=qS(K,this.transformPagePoint),_s.update(this.updatePoint,!0)},this.handlePointerUp=(q,K)=>{this.end();const{onEnd:J,onSessionEnd:te,resumeAnimation:oe}=this.handlers;if(this.dragSnapToOrigin&&oe&&oe(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ce=HS(q.type==="pointercancel"?this.lastMoveEventInfo:qS(K,this.transformPagePoint),this.history);this.startEvent&&J&&J(q,ce),te&&te(q,ce)},!qC(t))return;this.dragSnapToOrigin=y,this.handlers=i,this.transformPagePoint=s,this.distanceThreshold=T,this.contextWindow=f||window;const o=ib(t),C=qS(o,this.transformPagePoint),{point:M}=C,{timestamp:I}=Jl;this.history=[{...M,timestamp:I}];const{onSessionStart:j}=i;j&&j(t,HS(C,this.history)),this.removeListeners=eb(wx(this.contextWindow,"pointermove",this.handlePointerMove),wx(this.contextWindow,"pointerup",this.handlePointerUp),wx(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Pg(this.updatePoint)}}function qS(e,t){return t?{point:t(e.point)}:e}function HL(e,t){return{x:e.x-t.x,y:e.y-t.y}}function HS({point:e},t){return{point:e,delta:HL(e,UF(t)),offset:HL(e,AX(t)),velocity:PX(t,.1)}}function AX(e){return e[0]}function UF(e){return e[e.length-1]}function PX(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,s=null;const f=UF(e);for(;i>=0&&(s=e[i],!(f.timestamp-s.timestamp>ap(t)));)i--;if(!s)return{x:0,y:0};const y=sp(f.timestamp-s.timestamp);if(y===0)return{x:0,y:0};const T={x:(f.x-s.x)/y,y:(f.y-s.y)/y};return T.x===1/0&&(T.x=0),T.y===1/0&&(T.y=0),T}function CX(e,{min:t,max:i},s){return t!==void 0&&e<t?e=s?Ms(t,e,s.min):Math.max(e,t):i!==void 0&&e>i&&(e=s?Ms(i,e,s.max):Math.min(e,i)),e}function GL(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function MX(e,{top:t,left:i,bottom:s,right:f}){return{x:GL(e.x,i,f),y:GL(e.y,t,s)}}function ZL(e,t){let i=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,s]=[s,i]),{min:i,max:s}}function OX(e,t){return{x:ZL(e.x,t.x),y:ZL(e.y,t.y)}}function IX(e,t){let i=.5;const s=ou(e),f=ou(t);return f>s?i=Mx(t.min,t.max-s,e.min):s>f&&(i=Mx(e.min,e.max-f,t.min)),dm(0,1,i)}function DX(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const rP=.35;function RX(e=rP){return e===!1?e=0:e===!0&&(e=rP),{x:WL(e,"left","right"),y:WL(e,"top","bottom")}}function WL(e,t,i){return{min:XL(e,t),max:XL(e,i)}}function XL(e,t){return typeof e=="number"?e:e[t]||0}const LX=new WeakMap;class zX{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=nl(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:i=!1,distanceThreshold:s}={}){const{presenceContext:f}=this.visualElement;if(f&&f.isPresent===!1)return;const y=j=>{const{dragSnapToOrigin:q}=this.getProps();q?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(ib(j).point)},T=(j,q)=>{const{drag:K,dragPropagation:J,onDragStart:te}=this.getProps();if(K&&!J&&(this.openDragLock&&this.openDragLock(),this.openDragLock=JZ(K),!this.openDragLock))return;this.latestPointerEvent=j,this.latestPanInfo=q,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fd(ce=>{let de=this.getAxisMotionValue(ce).get()||0;if(lp.test(de)){const{projection:ue}=this.visualElement;if(ue&&ue.layout){const Pe=ue.layout.layoutBox[ce];Pe&&(de=ou(Pe)*(parseFloat(de)/100))}}this.originPoint[ce]=de}),te&&_s.postRender(()=>te(j,q)),eP(this.visualElement,"transform");const{animationState:oe}=this.visualElement;oe&&oe.setActive("whileDrag",!0)},o=(j,q)=>{this.latestPointerEvent=j,this.latestPanInfo=q;const{dragPropagation:K,dragDirectionLock:J,onDirectionLock:te,onDrag:oe}=this.getProps();if(!K&&!this.openDragLock)return;const{offset:ce}=q;if(J&&this.currentDirection===null){this.currentDirection=kX(ce),this.currentDirection!==null&&te&&te(this.currentDirection);return}this.updateAxis("x",q.point,ce),this.updateAxis("y",q.point,ce),this.visualElement.render(),oe&&oe(j,q)},C=(j,q)=>{this.latestPointerEvent=j,this.latestPanInfo=q,this.stop(j,q),this.latestPointerEvent=null,this.latestPanInfo=null},M=()=>fd(j=>this.getAnimationState(j)==="paused"&&this.getAxisMotionValue(j).animation?.play()),{dragSnapToOrigin:I}=this.getProps();this.panSession=new FF(t,{onSessionStart:y,onStart:T,onMove:o,onSessionEnd:C,resumeAnimation:M},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:I,distanceThreshold:s,contextWindow:jF(this.visualElement)})}stop(t,i){const s=t||this.latestPointerEvent,f=i||this.latestPanInfo,y=this.isDragging;if(this.cancel(),!y||!f||!s)return;const{velocity:T}=f;this.startAnimation(T);const{onDragEnd:o}=this.getProps();o&&_s.postRender(()=>o(s,f))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,s){const{drag:f}=this.getProps();if(!s||!Fw(t,f,this.currentDirection))return;const y=this.getAxisMotionValue(t);let T=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(T=CX(T,this.constraints[t],this.elastic[t])),y.set(T)}resolveConstraints(){const{dragConstraints:t,dragElastic:i}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,f=this.constraints;t&&pv(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=MX(s.layoutBox,t):this.constraints=!1,this.elastic=RX(i),f!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&fd(y=>{this.constraints!==!1&&this.getAxisMotionValue(y)&&(this.constraints[y]=DX(s.layoutBox[y],this.constraints[y]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!pv(t))return!1;const s=t.current,{projection:f}=this.visualElement;if(!f||!f.layout)return!1;const y=SX(s,f.root,this.visualElement.getTransformPagePoint());let T=OX(f.layout.layoutBox,y);if(i){const o=i(mX(T));this.hasMutatedConstraints=!!o,o&&(T=RF(o))}return T}startAnimation(t){const{drag:i,dragMomentum:s,dragElastic:f,dragTransition:y,dragSnapToOrigin:T,onDragTransitionEnd:o}=this.getProps(),C=this.constraints||{},M=fd(I=>{if(!Fw(I,i,this.currentDirection))return;let j=C&&C[I]||{};T&&(j={min:0,max:0});const q=f?200:1e6,K=f?40:1e7,J={type:"inertia",velocity:s?t[I]:0,bounceStiffness:q,bounceDamping:K,timeConstant:750,restDelta:1,restSpeed:10,...y,...j};return this.startAxisValueAnimation(I,J)});return Promise.all(M).then(o)}startAxisValueAnimation(t,i){const s=this.getAxisMotionValue(t);return eP(this.visualElement,t),s.start(QC(t,s,0,i,this.visualElement,!1))}stopAnimation(){fd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){fd(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const i=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),f=s[i];return f||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){fd(i=>{const{drag:s}=this.getProps();if(!Fw(i,s,this.currentDirection))return;const{projection:f}=this.visualElement,y=this.getAxisMotionValue(i);if(f&&f.layout){const{min:T,max:o}=f.layout.layoutBox[i];y.set(t[i]-Ms(T,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:s}=this.visualElement;if(!pv(i)||!s||!this.constraints)return;this.stopAnimation();const f={x:0,y:0};fd(T=>{const o=this.getAxisMotionValue(T);if(o&&this.constraints!==!1){const C=o.get();f[T]=IX({min:C,max:C},this.constraints[T])}});const{transformTemplate:y}=this.visualElement.getProps();this.visualElement.current.style.transform=y?y({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),fd(T=>{if(!Fw(T,t,null))return;const o=this.getAxisMotionValue(T),{min:C,max:M}=this.constraints[T];o.set(Ms(C,M,f[T]))})}addListeners(){if(!this.visualElement.current)return;LX.set(this.visualElement,this);const t=this.visualElement.current,i=wx(t,"pointerdown",C=>{const{drag:M,dragListener:I=!0}=this.getProps();M&&I&&this.start(C)}),s=()=>{const{dragConstraints:C}=this.getProps();pv(C)&&C.current&&(this.constraints=this.resolveRefConstraints())},{projection:f}=this.visualElement,y=f.addEventListener("measure",s);f&&!f.layout&&(f.root&&f.root.updateScroll(),f.updateLayout()),_s.read(s);const T=zx(window,"resize",()=>this.scalePositionWithinConstraints()),o=f.addEventListener("didUpdate",({delta:C,hasLayoutChanged:M})=>{this.isDragging&&M&&(fd(I=>{const j=this.getAxisMotionValue(I);j&&(this.originPoint[I]+=C[I].translate,j.set(j.get()+C[I].translate))}),this.visualElement.render())});return()=>{T(),i(),y(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:s=!1,dragPropagation:f=!1,dragConstraints:y=!1,dragElastic:T=rP,dragMomentum:o=!0}=t;return{...t,drag:i,dragDirectionLock:s,dragPropagation:f,dragConstraints:y,dragElastic:T,dragMomentum:o}}}function Fw(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function kX(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class NX extends Dg{constructor(t){super(t),this.removeGroupControls=vd,this.removeListeners=vd,this.controls=new zX(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||vd}unmount(){this.removeGroupControls(),this.removeListeners()}}const YL=e=>(t,i)=>{e&&_s.postRender(()=>e(t,i))};class BX extends Dg{constructor(){super(...arguments),this.removePointerDownListener=vd}onPointerDown(t){this.session=new FF(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:jF(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:s,onPanEnd:f}=this.node.getProps();return{onSessionStart:YL(t),onStart:YL(i),onMove:s,onEnd:(y,T)=>{delete this.session,f&&_s.postRender(()=>f(y,T))}}}mount(){this.removePointerDownListener=wx(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const c1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function KL(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const rx={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Cr.test(e))e=parseFloat(e);else return e;const i=KL(e,t.target.x),s=KL(e,t.target.y);return`${i}% ${s}%`}},jX={correct:(e,{treeScale:t,projectionDelta:i})=>{const s=e,f=Cg.parse(e);if(f.length>5)return s;const y=Cg.createTransformer(e),T=typeof f[0]!="number"?1:0,o=i.x.scale*t.x,C=i.y.scale*t.y;f[0+T]/=o,f[1+T]/=C;const M=Ms(o,C,.5);return typeof f[2+T]=="number"&&(f[2+T]/=M),typeof f[3+T]=="number"&&(f[3+T]/=M),y(f)}};let JL=!1;class FX extends me.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:s,layoutId:f}=this.props,{projection:y}=t;SW(UX),y&&(i.group&&i.group.add(y),s&&s.register&&f&&s.register(y),JL&&y.root.didUpdate(),y.addEventListener("animationComplete",()=>{this.safeToRemove()}),y.setOptions({...y.options,onExitComplete:()=>this.safeToRemove()})),c1.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:s,drag:f,isPresent:y}=this.props,{projection:T}=s;return T&&(T.isPresent=y,JL=!0,f||t.layoutDependency!==i||i===void 0||t.isPresent!==y?T.willUpdate():this.safeToRemove(),t.isPresent!==y&&(y?T.promote():T.relegate()||_s.postRender(()=>{const o=T.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),$C.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:s}=this.props,{projection:f}=t;f&&(f.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(f),s&&s.deregister&&s.deregister(f))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function VF(e){const[t,i]=sW(),s=me.useContext(Tj);return ie.jsx(FX,{...e,layoutGroup:s,switchLayoutGroup:me.useContext(xF),isPresent:t,safeToRemove:i})}const UX={borderRadius:{...rx,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:rx,borderTopRightRadius:rx,borderBottomLeftRadius:rx,borderBottomRightRadius:rx,boxShadow:jX};function VX(e,t,i){const s=Rc(e)?e:Ev(e);return s.start(QC("",s,t,i)),s.animation}const $X=(e,t)=>e.depth-t.depth;class qX{constructor(){this.children=[],this.isDirty=!1}add(t){SC(this.children,t),this.isDirty=!0}remove(t){EC(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort($X),this.isDirty=!1,this.children.forEach(t)}}function HX(e,t){const i=Uu.now(),s=({timestamp:f})=>{const y=f-i;y>=t&&(Pg(s),e(y-t))};return _s.setup(s,!0),()=>Pg(s)}const $F=["TopLeft","TopRight","BottomLeft","BottomRight"],GX=$F.length,QL=e=>typeof e=="string"?parseFloat(e):e,ez=e=>typeof e=="number"||Cr.test(e);function ZX(e,t,i,s,f,y){f?(e.opacity=Ms(0,i.opacity??1,WX(s)),e.opacityExit=Ms(t.opacity??1,0,XX(s))):y&&(e.opacity=Ms(t.opacity??1,i.opacity??1,s));for(let T=0;T<GX;T++){const o=`border${$F[T]}Radius`;let C=tz(t,o),M=tz(i,o);if(C===void 0&&M===void 0)continue;C||(C=0),M||(M=0),C===0||M===0||ez(C)===ez(M)?(e[o]=Math.max(Ms(QL(C),QL(M),s),0),(lp.test(M)||lp.test(C))&&(e[o]+="%")):e[o]=M}(t.rotate||i.rotate)&&(e.rotate=Ms(t.rotate||0,i.rotate||0,s))}function tz(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const WX=qF(0,.5,Lj),XX=qF(.5,.95,vd);function qF(e,t,i){return s=>s<e?0:s>t?1:i(Mx(e,t,s))}function nz(e,t){e.min=t.min,e.max=t.max}function sd(e,t){nz(e.x,t.x),nz(e.y,t.y)}function iz(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function rz(e,t,i,s,f){return e-=t,e=S1(e,1/i,s),f!==void 0&&(e=S1(e,1/f,s)),e}function YX(e,t=0,i=1,s=.5,f,y=e,T=e){if(lp.test(t)&&(t=parseFloat(t),t=Ms(T.min,T.max,t/100)-T.min),typeof t!="number")return;let o=Ms(y.min,y.max,s);e===y&&(o-=t),e.min=rz(e.min,t,i,o,f),e.max=rz(e.max,t,i,o,f)}function oz(e,t,[i,s,f],y,T){YX(e,t[i],t[s],t[f],t.scale,y,T)}const KX=["x","scaleX","originX"],JX=["y","scaleY","originY"];function az(e,t,i,s){oz(e.x,t,KX,i?i.x:void 0,s?s.x:void 0),oz(e.y,t,JX,i?i.y:void 0,s?s.y:void 0)}function sz(e){return e.translate===0&&e.scale===1}function HF(e){return sz(e.x)&&sz(e.y)}function lz(e,t){return e.min===t.min&&e.max===t.max}function QX(e,t){return lz(e.x,t.x)&&lz(e.y,t.y)}function cz(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function GF(e,t){return cz(e.x,t.x)&&cz(e.y,t.y)}function uz(e){return ou(e.x)/ou(e.y)}function hz(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class eY{constructor(){this.members=[]}add(t){SC(this.members,t),t.scheduleRender()}remove(t){if(EC(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(f=>t===f);if(i===0)return!1;let s;for(let f=i;f>=0;f--){const y=this.members[f];if(y.isPresent!==!1){s=y;break}}return s?(this.promote(s),!0):!1}promote(t,i){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,i&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:f}=t.options;f===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:s}=t;i.onExitComplete&&i.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tY(e,t,i){let s="";const f=e.x.translate/t.x,y=e.y.translate/t.y,T=i?.z||0;if((f||y||T)&&(s=`translate3d(${f}px, ${y}px, ${T}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),i){const{transformPerspective:M,rotate:I,rotateX:j,rotateY:q,skewX:K,skewY:J}=i;M&&(s=`perspective(${M}px) ${s}`),I&&(s+=`rotate(${I}deg) `),j&&(s+=`rotateX(${j}deg) `),q&&(s+=`rotateY(${q}deg) `),K&&(s+=`skewX(${K}deg) `),J&&(s+=`skewY(${J}deg) `)}const o=e.x.scale*t.x,C=e.y.scale*t.y;return(o!==1||C!==1)&&(s+=`scale(${o}, ${C})`),s||"none"}const GS=["","X","Y","Z"],nY=1e3;let iY=0;function ZS(e,t,i,s){const{latestValues:f}=t;f[e]&&(i[e]=f[e],t.setStaticValue(e,0),s&&(s[e]=0))}function ZF(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const i=MF(t);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:f,layoutId:y}=e.options;window.MotionCancelOptimisedAnimation(i,"transform",_s,!(f||y))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&ZF(s)}function WF({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:s,resetTransform:f}){return class{constructor(T={},o=t?.()){this.id=iY++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(aY),this.nodes.forEach(uY),this.nodes.forEach(hY),this.nodes.forEach(sY)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=T,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let C=0;C<this.path.length;C++)this.path[C].shouldResetTransform=!0;this.root===this&&(this.nodes=new qX)}addEventListener(T,o){return this.eventHandlers.has(T)||this.eventHandlers.set(T,new CC),this.eventHandlers.get(T).add(o)}notifyListeners(T,...o){const C=this.eventHandlers.get(T);C&&C.notify(...o)}hasListeners(T){return this.eventHandlers.has(T)}mount(T){if(this.instance)return;this.isSVG=pF(T)&&!rW(T),this.instance=T;const{layoutId:o,layout:C,visualElement:M}=this.options;if(M&&!M.current&&M.mount(T),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(C||o)&&(this.isLayoutDirty=!0),e){let I,j=0;const q=()=>this.root.updateBlockedByResize=!1;_s.read(()=>{j=window.innerWidth}),e(T,()=>{const K=window.innerWidth;K!==j&&(j=K,this.root.updateBlockedByResize=!0,I&&I(),I=HX(q,250),c1.hasAnimatedSinceResize&&(c1.hasAnimatedSinceResize=!1,this.nodes.forEach(pz)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&M&&(o||C)&&this.addEventListener("didUpdate",({delta:I,hasLayoutChanged:j,hasRelativeLayoutChanged:q,layout:K})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const J=this.options.transition||M.getDefaultTransition()||gY,{onLayoutAnimationStart:te,onLayoutAnimationComplete:oe}=M.getProps(),ce=!this.targetLayout||!GF(this.targetLayout,K),de=!j&&q;if(this.options.layoutRoot||this.resumeFrom||de||j&&(ce||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ue={...UC(J,"layout"),onPlay:te,onComplete:oe};(M.shouldReduceMotion||this.options.layoutRoot)&&(ue.delay=0,ue.type=!1),this.startAnimation(ue),this.setAnimationOrigin(I,de)}else j||pz(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=K})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const T=this.getStack();T&&T.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Pg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(dY),this.animationId++)}getTransformTemplate(){const{visualElement:T}=this.options;return T&&T.getProps().transformTemplate}willUpdate(T=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ZF(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let I=0;I<this.path.length;I++){const j=this.path[I];j.shouldResetTransform=!0,j.updateScroll("snapshot"),j.options.layoutRoot&&j.willUpdate(!1)}const{layoutId:o,layout:C}=this.options;if(o===void 0&&!C)return;const M=this.getTransformTemplate();this.prevTransformTemplateValue=M?M(this.latestValues,""):void 0,this.updateSnapshot(),T&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(dz);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(fz);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(cY),this.nodes.forEach(rY),this.nodes.forEach(oY)):this.nodes.forEach(fz),this.clearAllSnapshots();const o=Uu.now();Jl.delta=dm(0,1e3/60,o-Jl.timestamp),Jl.timestamp=o,Jl.isProcessing=!0,NS.update.process(Jl),NS.preRender.process(Jl),NS.render.process(Jl),Jl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,$C.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(lY),this.sharedNodes.forEach(fY)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_s.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_s.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ou(this.snapshot.measuredBox.x)&&!ou(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let C=0;C<this.path.length;C++)this.path[C].updateScroll();const T=this.layout;this.layout=this.measure(!1),this.layoutCorrected=nl(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,T?T.layoutBox:void 0)}updateScroll(T="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===T&&(o=!1),o&&this.instance){const C=s(this.instance);this.scroll={animationId:this.root.animationId,phase:T,isRoot:C,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:C}}}resetTransform(){if(!f)return;const T=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!HF(this.projectionDelta),C=this.getTransformTemplate(),M=C?C(this.latestValues,""):void 0,I=M!==this.prevTransformTemplateValue;T&&this.instance&&(o||L_(this.latestValues)||I)&&(f(this.instance,M),this.shouldResetTransform=!1,this.scheduleRender())}measure(T=!0){const o=this.measurePageBox();let C=this.removeElementScroll(o);return T&&(C=this.removeTransform(C)),_Y(C),{animationId:this.root.animationId,measuredBox:o,layoutBox:C,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:T}=this.options;if(!T)return nl();const o=T.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(yY))){const{scroll:M}=this.root;M&&(gv(o.x,M.offset.x),gv(o.y,M.offset.y))}return o}removeElementScroll(T){const o=nl();if(sd(o,T),this.scroll?.wasRoot)return o;for(let C=0;C<this.path.length;C++){const M=this.path[C],{scroll:I,options:j}=M;M!==this.root&&I&&j.layoutScroll&&(I.wasRoot&&sd(o,T),gv(o.x,I.offset.x),gv(o.y,I.offset.y))}return o}applyTransform(T,o=!1){const C=nl();sd(C,T);for(let M=0;M<this.path.length;M++){const I=this.path[M];!o&&I.options.layoutScroll&&I.scroll&&I!==I.root&&_v(C,{x:-I.scroll.offset.x,y:-I.scroll.offset.y}),L_(I.latestValues)&&_v(C,I.latestValues)}return L_(this.latestValues)&&_v(C,this.latestValues),C}removeTransform(T){const o=nl();sd(o,T);for(let C=0;C<this.path.length;C++){const M=this.path[C];if(!M.instance||!L_(M.latestValues))continue;nP(M.latestValues)&&M.updateSnapshot();const I=nl(),j=M.measurePageBox();sd(I,j),az(o,M.latestValues,M.snapshot?M.snapshot.layoutBox:void 0,I)}return L_(this.latestValues)&&az(o,this.latestValues),o}setTargetDelta(T){this.targetDelta=T,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(T){this.options={...this.options,...T,crossfade:T.crossfade!==void 0?T.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Jl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(T=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const C=!!this.resumingFrom||this!==o;if(!(T||C&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:I,layoutId:j}=this.options;if(!(!this.layout||!(I||j))){if(this.resolvedRelativeTargetAt=Jl.timestamp,!this.targetDelta&&!this.relativeTarget){const q=this.getClosestProjectingParent();q&&q.layout&&this.animationProgress!==1?(this.relativeParent=q,this.forceRelativeParentToResolveTarget(),this.relativeTarget=nl(),this.relativeTargetOrigin=nl(),Sx(this.relativeTargetOrigin,this.layout.layoutBox,q.layout.layoutBox),sd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=nl(),this.targetWithTransforms=nl()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),wX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):sd(this.target,this.layout.layoutBox),NF(this.target,this.targetDelta)):sd(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const q=this.getClosestProjectingParent();q&&!!q.resumingFrom==!!this.resumingFrom&&!q.options.layoutScroll&&q.target&&this.animationProgress!==1?(this.relativeParent=q,this.forceRelativeParentToResolveTarget(),this.relativeTarget=nl(),this.relativeTargetOrigin=nl(),Sx(this.relativeTargetOrigin,this.target,q.target),sd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||nP(this.parent.latestValues)||kF(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const T=this.getLead(),o=!!this.resumingFrom||this!==T;let C=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(C=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(C=!1),this.resolvedRelativeTargetAt===Jl.timestamp&&(C=!1),C)return;const{layout:M,layoutId:I}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(M||I))return;sd(this.layoutCorrected,this.layout.layoutBox);const j=this.treeScale.x,q=this.treeScale.y;TX(this.layoutCorrected,this.treeScale,this.path,o),T.layout&&!T.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(T.target=T.layout.layoutBox,T.targetWithTransforms=nl());const{target:K}=T;if(!K){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(iz(this.prevProjectionDelta.x,this.projectionDelta.x),iz(this.prevProjectionDelta.y,this.projectionDelta.y)),Tx(this.projectionDelta,this.layoutCorrected,K,this.latestValues),(this.treeScale.x!==j||this.treeScale.y!==q||!hz(this.projectionDelta.x,this.prevProjectionDelta.x)||!hz(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",K))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(T=!0){if(this.options.visualElement?.scheduleRender(),T){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mv(),this.projectionDelta=mv(),this.projectionDeltaWithTransform=mv()}setAnimationOrigin(T,o=!1){const C=this.snapshot,M=C?C.latestValues:{},I={...this.latestValues},j=mv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const q=nl(),K=C?C.source:void 0,J=this.layout?this.layout.source:void 0,te=K!==J,oe=this.getStack(),ce=!oe||oe.members.length<=1,de=!!(te&&!ce&&this.options.crossfade===!0&&!this.path.some(mY));this.animationProgress=0;let ue;this.mixTargetDelta=Pe=>{const Oe=Pe/1e3;mz(j.x,T.x,Oe),mz(j.y,T.y,Oe),this.setTargetDelta(j),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Sx(q,this.layout.layoutBox,this.relativeParent.layout.layoutBox),pY(this.relativeTarget,this.relativeTargetOrigin,q,Oe),ue&&QX(this.relativeTarget,ue)&&(this.isProjectionDirty=!1),ue||(ue=nl()),sd(ue,this.relativeTarget)),te&&(this.animationValues=I,ZX(I,M,this.latestValues,Oe,de,ce)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Oe},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(T){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Pg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_s.update(()=>{c1.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ev(0)),this.currentAnimation=VX(this.motionValue,[0,1e3],{...T,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),T.onUpdate&&T.onUpdate(o)},onStop:()=>{},onComplete:()=>{T.onComplete&&T.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const T=this.getStack();T&&T.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(nY),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const T=this.getLead();let{targetWithTransforms:o,target:C,layout:M,latestValues:I}=T;if(!(!o||!C||!M)){if(this!==T&&this.layout&&M&&XF(this.options.animationType,this.layout.layoutBox,M.layoutBox)){C=this.target||nl();const j=ou(this.layout.layoutBox.x);C.x.min=T.target.x.min,C.x.max=C.x.min+j;const q=ou(this.layout.layoutBox.y);C.y.min=T.target.y.min,C.y.max=C.y.min+q}sd(o,C),_v(o,I),Tx(this.projectionDeltaWithTransform,this.layoutCorrected,o,I)}}registerSharedNode(T,o){this.sharedNodes.has(T)||this.sharedNodes.set(T,new eY),this.sharedNodes.get(T).add(o);const M=o.options.initialPromotionConfig;o.promote({transition:M?M.transition:void 0,preserveFollowOpacity:M&&M.shouldPreserveFollowOpacity?M.shouldPreserveFollowOpacity(o):void 0})}isLead(){const T=this.getStack();return T?T.lead===this:!0}getLead(){const{layoutId:T}=this.options;return T?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:T}=this.options;return T?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:T}=this.options;if(T)return this.root.sharedNodes.get(T)}promote({needsReset:T,transition:o,preserveFollowOpacity:C}={}){const M=this.getStack();M&&M.promote(this,C),T&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const T=this.getStack();return T?T.relegate(this):!1}resetSkewAndRotation(){const{visualElement:T}=this.options;if(!T)return;let o=!1;const{latestValues:C}=T;if((C.z||C.rotate||C.rotateX||C.rotateY||C.rotateZ||C.skewX||C.skewY)&&(o=!0),!o)return;const M={};C.z&&ZS("z",T,M,this.animationValues);for(let I=0;I<GS.length;I++)ZS(`rotate${GS[I]}`,T,M,this.animationValues),ZS(`skew${GS[I]}`,T,M,this.animationValues);T.render();for(const I in M)T.setStaticValue(I,M[I]),this.animationValues&&(this.animationValues[I]=M[I]);T.scheduleRender()}applyProjectionStyles(T,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){T.visibility="hidden";return}const C=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,T.visibility="",T.opacity="",T.pointerEvents=l1(o?.pointerEvents)||"",T.transform=C?C(this.latestValues,""):"none";return}const M=this.getLead();if(!this.projectionDelta||!this.layout||!M.target){this.options.layoutId&&(T.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,T.pointerEvents=l1(o?.pointerEvents)||""),this.hasProjected&&!L_(this.latestValues)&&(T.transform=C?C({},""):"none",this.hasProjected=!1);return}T.visibility="";const I=M.animationValues||M.latestValues;this.applyTransformsToTarget();let j=tY(this.projectionDeltaWithTransform,this.treeScale,I);C&&(j=C(I,j)),T.transform=j;const{x:q,y:K}=this.projectionDelta;T.transformOrigin=`${q.origin*100}% ${K.origin*100}% 0`,M.animationValues?T.opacity=M===this?I.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:I.opacityExit:T.opacity=M===this?I.opacity!==void 0?I.opacity:"":I.opacityExit!==void 0?I.opacityExit:0;for(const J in Rx){if(I[J]===void 0)continue;const{correct:te,applyTo:oe,isCSSVariable:ce}=Rx[J],de=j==="none"?I[J]:te(I[J],M);if(oe){const ue=oe.length;for(let Pe=0;Pe<ue;Pe++)T[oe[Pe]]=de}else ce?this.options.visualElement.renderState.vars[J]=de:T[J]=de}this.options.layoutId&&(T.pointerEvents=M===this?l1(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(T=>T.currentAnimation?.stop()),this.root.nodes.forEach(dz),this.root.sharedNodes.clear()}}}function rY(e){e.updateLayout()}function oY(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:s}=e.layout,{animationType:f}=e.options,y=t.source!==e.layout.source;f==="size"?fd(I=>{const j=y?t.measuredBox[I]:t.layoutBox[I],q=ou(j);j.min=i[I].min,j.max=j.min+q}):XF(f,t.layoutBox,i)&&fd(I=>{const j=y?t.measuredBox[I]:t.layoutBox[I],q=ou(i[I]);j.max=j.min+q,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[I].max=e.relativeTarget[I].min+q)});const T=mv();Tx(T,i,t.layoutBox);const o=mv();y?Tx(o,e.applyTransform(s,!0),t.measuredBox):Tx(o,i,t.layoutBox);const C=!HF(T);let M=!1;if(!e.resumeFrom){const I=e.getClosestProjectingParent();if(I&&!I.resumeFrom){const{snapshot:j,layout:q}=I;if(j&&q){const K=nl();Sx(K,t.layoutBox,j.layoutBox);const J=nl();Sx(J,i,q.layoutBox),GF(K,J)||(M=!0),I.options.layoutRoot&&(e.relativeTarget=J,e.relativeTargetOrigin=K,e.relativeParent=I)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:o,layoutDelta:T,hasLayoutChanged:C,hasRelativeLayoutChanged:M})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function aY(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function sY(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function lY(e){e.clearSnapshot()}function dz(e){e.clearMeasurements()}function fz(e){e.isLayoutDirty=!1}function cY(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function pz(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function uY(e){e.resolveTargetDelta()}function hY(e){e.calcProjection()}function dY(e){e.resetSkewAndRotation()}function fY(e){e.removeLeadSnapshot()}function mz(e,t,i){e.translate=Ms(t.translate,0,i),e.scale=Ms(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function gz(e,t,i,s){e.min=Ms(t.min,i.min,s),e.max=Ms(t.max,i.max,s)}function pY(e,t,i,s){gz(e.x,t.x,i.x,s),gz(e.y,t.y,i.y,s)}function mY(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const gY={duration:.45,ease:[.4,0,.1,1]},_z=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),yz=_z("applewebkit/")&&!_z("chrome/")?Math.round:vd;function vz(e){e.min=yz(e.min),e.max=yz(e.max)}function _Y(e){vz(e.x),vz(e.y)}function XF(e,t,i){return e==="position"||e==="preserve-aspect"&&!bX(uz(t),uz(i),.2)}function yY(e){return e!==e.root&&e.scroll?.wasRoot}const vY=WF({attachResizeListener:(e,t)=>zx(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),WS={current:void 0},YF=WF({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!WS.current){const e=new vY({});e.mount(window),e.setOptions({layoutScroll:!0}),WS.current=e}return WS.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),xY={pan:{Feature:BX},drag:{Feature:NX,ProjectionNode:YF,MeasureLayout:VF}};function xz(e,t,i){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",i==="Start");const f="onHover"+i,y=s[f];y&&_s.postRender(()=>y(t,ib(t)))}class bY extends Dg{mount(){const{current:t}=this.node;t&&(this.unmount=QZ(t,(i,s)=>(xz(this.node,s,"Start"),f=>xz(this.node,f,"End"))))}unmount(){}}class wY extends Dg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=eb(zx(this.node.current,"focus",()=>this.onFocus()),zx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function bz(e,t,i){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",i==="Start");const f="onTap"+(i==="End"?"":i),y=s[f];y&&_s.postRender(()=>y(t,ib(t)))}class TY extends Dg{mount(){const{current:t}=this.node;t&&(this.unmount=iW(t,(i,s)=>(bz(this.node,s,"Start"),(f,{success:y})=>bz(this.node,f,y?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const oP=new WeakMap,XS=new WeakMap,SY=e=>{const t=oP.get(e.target);t&&t(e)},EY=e=>{e.forEach(SY)};function AY({root:e,...t}){const i=e||document;XS.has(i)||XS.set(i,{});const s=XS.get(i),f=JSON.stringify(t);return s[f]||(s[f]=new IntersectionObserver(EY,{root:e,...t})),s[f]}function PY(e,t,i){const s=AY(t);return oP.set(e,i),s.observe(e),()=>{oP.delete(e),s.unobserve(e)}}const CY={some:0,all:1};class MY extends Dg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:s,amount:f="some",once:y}=t,T={root:i?i.current:void 0,rootMargin:s,threshold:typeof f=="number"?f:CY[f]},o=C=>{const{isIntersecting:M}=C;if(this.isInView===M||(this.isInView=M,y&&!M&&this.hasEnteredView))return;M&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",M);const{onViewportEnter:I,onViewportLeave:j}=this.node.getProps(),q=M?I:j;q&&q(C)};return PY(this.node.current,T,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(OY(t,i))&&this.startObserver()}unmount(){}}function OY({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const IY={inView:{Feature:MY},tap:{Feature:TY},focus:{Feature:wY},hover:{Feature:bY}},DY={layout:{ProjectionNode:YF,MeasureLayout:VF}},aP={current:null},KF={current:!1};function RY(){if(KF.current=!0,!!wC)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>aP.current=e.matches;e.addEventListener("change",t),t()}else aP.current=!1}const LY=new WeakMap;function zY(e,t,i){for(const s in t){const f=t[s],y=i[s];if(Rc(f))e.addValue(s,f);else if(Rc(y))e.addValue(s,Ev(f,{owner:e}));else if(y!==f)if(e.hasValue(s)){const T=e.getValue(s);T.liveStyle===!0?T.jump(f):T.hasAnimated||T.set(f)}else{const T=e.getStaticValue(s);e.addValue(s,Ev(T!==void 0?T:f,{owner:e}))}}for(const s in i)t[s]===void 0&&e.removeValue(s);return t}const wz=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class kY{scrapeMotionValuesFromProps(t,i,s){return{}}constructor({parent:t,props:i,presenceContext:s,reducedMotionConfig:f,blockInitialAnimation:y,visualState:T},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=FC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const q=Uu.now();this.renderScheduledAt<q&&(this.renderScheduledAt=q,_s.render(this.render,!1,!0))};const{latestValues:C,renderState:M}=T;this.latestValues=C,this.baseTarget={...C},this.initialValues=i.initial?{...C}:{},this.renderState=M,this.parent=t,this.props=i,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=f,this.options=o,this.blockInitialAnimation=!!y,this.isControllingVariants=CT(i),this.isVariantNode=yF(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:I,...j}=this.scrapeMotionValuesFromProps(i,{},this);for(const q in j){const K=j[q];C[q]!==void 0&&Rc(K)&&K.set(C[q],!1)}}mount(t){this.current=t,LY.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,s)=>this.bindToMotionValue(s,i)),KF.current||RY(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:aP.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Pg(this.notifyUpdate),Pg(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const i=this.features[t];i&&(i.unmount(),i.isMounted=!1)}this.current=null}bindToMotionValue(t,i){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Vv.has(t);s&&this.onBindTransform&&this.onBindTransform();const f=i.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&_s.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),y=i.on("renderRequest",this.scheduleRender);let T;window.MotionCheckAppearSync&&(T=window.MotionCheckAppearSync(this,t,i)),this.valueSubscriptions.set(t,()=>{f(),y(),T&&T(),i.owner&&i.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Av){const i=Av[t];if(!i)continue;const{isEnabled:s,Feature:f}=i;if(!this.features[t]&&f&&s(this.props)&&(this.features[t]=new f(this)),this.features[t]){const y=this.features[t];y.isMounted?y.update():(y.mount(),y.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):nl()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let s=0;s<wz.length;s++){const f=wz[s];this.propEventSubscriptions[f]&&(this.propEventSubscriptions[f](),delete this.propEventSubscriptions[f]);const y="on"+f,T=t[y];T&&(this.propEventSubscriptions[f]=this.on(f,T))}this.prevMotionValues=zY(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){const s=this.values.get(t);i!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,i),this.values.set(t,i),this.latestValues[t]=i.get())}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&i!==void 0&&(s=Ev(i===null?void 0:i,{owner:this}),this.addValue(t,s)),s}readValue(t,i){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(Sj(s)||Aj(s))?s=parseFloat(s):!aW(s)&&Cg.test(i)&&(s=lF(t,i)),this.setBaseTarget(t,Rc(s)?s.get():s)),Rc(s)?s.get():s}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){const{initial:i}=this.props;let s;if(typeof i=="string"||typeof i=="object"){const y=KC(this.props,i,this.presenceContext?.custom);y&&(s=y[t])}if(i&&s!==void 0)return s;const f=this.getBaseTargetFromProps(this.props,t);return f!==void 0&&!Rc(f)?f:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new CC),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}}class JF extends kY{constructor(){super(...arguments),this.KeyframeResolver=XZ}sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:s}){delete i[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Rc(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function QF(e,{style:t,vars:i},s,f){const y=e.style;let T;for(T in t)y[T]=t[T];f?.applyProjectionStyles(y,s);for(T in i)y.setProperty(T,i[T])}function NY(e){return window.getComputedStyle(e)}class BY extends JF{constructor(){super(...arguments),this.type="html",this.renderInstance=QF}readValueFromInstance(t,i){if(Vv.has(i))return this.projection?.isProjecting?ZA(i):pZ(t,i);{const s=NY(t),f=(IC(i)?s.getPropertyValue(i):s[i])||0;return typeof f=="string"?f.trim():f}}measureInstanceViewportBox(t,{transformPagePoint:i}){return BF(t,i)}build(t,i,s){WC(t,i,s.transformTemplate)}scrapeMotionValuesFromProps(t,i,s){return JC(t,i,s)}}const e5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jY(e,t,i,s){QF(e,t,void 0,s);for(const f in t.attrs)e.setAttribute(e5.has(f)?f:ZC(f),t.attrs[f])}class FY extends JF{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=nl}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(Vv.has(i)){const s=sF(i);return s&&s.default||0}return i=e5.has(i)?i:ZC(i),t.getAttribute(i)}scrapeMotionValuesFromProps(t,i,s){return CF(t,i,s)}build(t,i,s){SF(t,i,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,i,s,f){jY(t,i,s,f)}mount(t){this.isSVGTag=AF(t.tagName),super.mount(t)}}const UY=(e,t)=>YC(e)?new FY(t):new BY(t,{allowProjection:e!==me.Fragment}),VY=UW({...fX,...IY,...xY,...DY},UY),u1=dW(VY),$Y={some:0,all:1};function qY(e,t,{root:i,margin:s,amount:f="some"}={}){const y=cF(e),T=new WeakMap,o=M=>{M.forEach(I=>{const j=T.get(I.target);if(I.isIntersecting!==!!j)if(I.isIntersecting){const q=t(I.target,I);typeof q=="function"?T.set(I.target,q):C.unobserve(I.target)}else typeof j=="function"&&(j(I),T.delete(I.target))})},C=new IntersectionObserver(o,{root:i,rootMargin:s,threshold:typeof f=="number"?f:$Y[f]});return y.forEach(M=>C.observe(M)),()=>C.disconnect()}function HY(e,{root:t,margin:i,amount:s,once:f=!1,initial:y=!1}={}){const[T,o]=me.useState(y);return me.useEffect(()=>{if(!e.current||f&&T)return;const C=()=>(o(!0),f?void 0:()=>o(!1)),M={root:t&&t.current||void 0,margin:i,amount:s};return qY(e.current,C,M)},[t,e,i,f,s]),T}const GY=[{icon:ie.jsx(o9,{className:"h-8 w-8 text-yellow-400"}),title:"تحذيرات عبور الحيوانات",description:"بصار ينبهك فورًا إذا تم رصد حيوانات قريبة منك."},{icon:ie.jsx(c9,{className:"h-8 w-8 text-yellow-400"}),title:"انقطاع الإرسال",description:"تعرف على الأماكن اللي تنقطع فيها الإشارة قبل لا توصلها."},{icon:ie.jsx(e9,{className:"h-8 w-8 text-yellow-400"}),title:"تحذير المناطق المحظورة",description:"تنبيهات فورية عند دخول مناطق محظورة"},{icon:ie.jsx(W7,{className:"h-8 w-8 text-yellow-400"}),title:"التضاريس الخطرة",description:"يتم رصد المنحدرات والمنعطفات الحادة والمناطق عالية الخطورة في الوقت الحقيقي لضمان سلامتك."}];function ZY(){return ie.jsx("div",{children:ie.jsx("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-10 max-w-6xl mx-auto",children:GY.map((e,t)=>ie.jsxs(u1.div,{className:"bg-[#32305a] p-6 rounded-2xl shadow hover:shadow-md transition duration-300",initial:{opacity:0,y:0},animate:{opacity:1,y:0},transition:{delay:t*.3,duration:.9},children:[ie.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.icon,ie.jsx("h3",{className:"text-xl font-semibold text-yellow-300",children:e.title})]}),ie.jsx("p",{className:"text-yellow-100",children:e.description})]},t))})})}function WY(){const e=[{step:"ابدأ",description:"سجّل، وحدد موقعك فورًا."},{step:"الرصد",description:"مسح لحظي لمحيطك بحثًا عن أي خطر"},{step:"التنبيه",description:"تنبيه لحظي عند اقتراب أي خطر"},{step:"التنقّل",description:"اقتراحات ذكية تساعدك تتجنب الخطر بأمان."}],t=me.useRef(null),i=HY(t,{once:!0,margin:"-100px"}),s=`
    M20 0 
    C 80 40, -40 100, 20 140 
    C 80 180, -40 240, 20 280 
    C 80 320, -40 380, 20 420
  `;return ie.jsxs("section",{ref:t,className:"relative px-6 py-16 max-w-3xl mx-auto",children:[ie.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-yellow-300 text-center mb-12",children:"كيف يعمل بصّار؟"}),ie.jsxs("svg",{className:"absolute left-4 top-[112px] hidden md:block",width:"100",height:"460",viewBox:"0 0 100 460",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ie.jsx(u1.path,{d:s,stroke:"#facc15",strokeWidth:"4",fill:"none",initial:{pathLength:0},animate:i?{pathLength:1}:{pathLength:0},transition:{duration:2,ease:"easeInOut"}}),i&&ie.jsx(u1.circle,{r:"6",fill:"#facc15",animate:{offsetDistance:["0%","33%","66%","100%"]},transition:{duration:4,ease:"easeInOut",times:[0,.33,.66,1]},style:{offsetPath:`path('${s}')`,offsetRotate:"auto"}})]}),ie.jsx("ol",{className:"relative pl-14",children:e.map((f,y)=>ie.jsxs(u1.li,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.6,ease:"easeOut",delay:y*.3},className:"mb-20 relative",children:[ie.jsx("span",{className:"absolute w-4 h-4 bg-yellow-400 rounded-full left-0 top-2 border-2 border-[#1d1a33]"}),ie.jsxs("div",{className:"bg-[#32305a] p-6 rounded-xl shadow-md hover:shadow-lg transition",children:[ie.jsx("h3",{className:"text-xl font-semibold text-yellow-200 mb-2",children:f.step}),ie.jsx("p",{className:"text-yellow-100",children:f.description})]})]},y))})]})}function XY(){const[e,t]=me.useState(!1),i=()=>{window.scrollTo({top:0,behavior:"smooth"})};return me.useEffect(()=>{const s=()=>{window.scrollY>200?t(!0):t(!1)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]),ie.jsx("div",{children:ie.jsxs("footer",{className:"bg-[#1d1a33] text-yellow-200 p-8 text-sm mt-10",children:[ie.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left",children:[ie.jsxs("div",{children:[ie.jsx("h4",{className:"font-semibold text-yellow-400 mb-2",children:"Contact Us"}),ie.jsxs("p",{children:["Email:"," ",ie.jsx("a",{href:"mailto:support@safepath.com",className:"underline text-yellow-300",children:"support@safepath.com"})]}),ie.jsxs("p",{children:["Phone:"," ",ie.jsx("a",{href:"tel:+1234567890",className:"underline text-yellow-300",children:"+1 (234) 567-890"})]}),ie.jsx("p",{children:"Address: 123 Safety Road, Alert City, SP 10001"})]}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"font-semibold text-yellow-400 mb-2",children:"Legal"}),ie.jsxs("ul",{className:"space-y-1",children:[ie.jsx("li",{children:ie.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Privacy Policy"})}),ie.jsx("li",{children:ie.jsx("a",{href:"#",className:"hover:text-yellow-400",children:"Terms of Service"})})]})]}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"font-semibold text-yellow-400 mb-2",children:"Follow Us"}),ie.jsxs("div",{className:"flex justify-center md:justify-start space-x-4 mt-2",children:[ie.jsx("a",{href:"#","aria-label":"Facebook",className:"hover:text-yellow-400",children:ie.jsx($7,{})}),ie.jsx("a",{href:"#","aria-label":"Twitter",className:"hover:text-yellow-400",children:ie.jsx(s9,{})}),ie.jsx("a",{href:"#","aria-label":"Instagram",className:"hover:text-yellow-400",children:ie.jsx(H7,{})})]})]})]}),ie.jsxs("div",{dir:"ltr",className:"text-center mt-6 text-yellow-300",children:["© ",new Date().getFullYear()," بّصار"]}),ie.jsx("button",{onClick:i,className:`fixed bottom-6 right-10 transform transition-all duration-500 ease-in-out 
            ${e?"translate-x-0 opacity-100":"translate-x-full opacity-0"} 
            bg-yellow-400 text-[#272343] p-3 rounded-full shadow hover:bg-yellow-300 cursor-pointer`,"aria-label":"Scroll to top",children:ie.jsx(B7,{className:"h-5 w-5"})})]})})}function t5(e,t){const i=me.useRef(t);me.useEffect(function(){t!==i.current&&e.attributionControl!=null&&(i.current!=null&&e.attributionControl.removeAttribution(i.current),t!=null&&e.attributionControl.addAttribution(t)),i.current=t},[e,t])}var eM=YB();const YY=1;function KY(e){return Object.freeze({__version:YY,map:e})}function JY(e,t){return Object.freeze({...e,...t})}const tM=me.createContext(null);function n5(){const e=me.use(tM);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function QY(e){function t(i,s){const{instance:f,context:y}=e(i).current;me.useImperativeHandle(s,()=>f);const{children:T}=i;return T==null?null:yd.createElement(tM,{value:y},T)}return me.forwardRef(t)}function eK(e){function t(i,s){const[f,y]=me.useState(!1),{instance:T}=e(i,y).current;me.useImperativeHandle(s,()=>T),me.useEffect(function(){f&&T.update()},[T,f,i.children]);const o=T._contentNode;return o?eM.createPortal(i.children,o):null}return me.forwardRef(t)}function tK(e){function t(i,s){const{instance:f}=e(i).current;return me.useImperativeHandle(s,()=>f),null}return me.forwardRef(t)}function i5(e,t){const i=me.useRef(void 0);me.useEffect(function(){return t!=null&&e.instance.on(t),i.current=t,function(){i.current!=null&&e.instance.off(i.current),i.current=null}},[e,t])}function nM(e,t){const i=e.pane??t.pane;return i?{...e,pane:i}:e}function nK(e,t){return function(s,f){const y=n5(),T=e(nM(s,y),y);return t5(y.map,s.attribution),i5(T.current,s.eventHandlers),t(T.current,y,s,f),T}}var _x={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var iK=_x.exports,Tz;function rK(){return Tz||(Tz=1,function(e,t){(function(i,s){s(t)})(iK,function(i){var s="1.9.4";function f(b){var z,$,ne,ve;for($=1,ne=arguments.length;$<ne;$++){ve=arguments[$];for(z in ve)b[z]=ve[z]}return b}var y=Object.create||function(){function b(){}return function(z){return b.prototype=z,new b}}();function T(b,z){var $=Array.prototype.slice;if(b.bind)return b.bind.apply(b,$.call(arguments,1));var ne=$.call(arguments,2);return function(){return b.apply(z,ne.length?ne.concat($.call(arguments)):arguments)}}var o=0;function C(b){return"_leaflet_id"in b||(b._leaflet_id=++o),b._leaflet_id}function M(b,z,$){var ne,ve,Be,_t;return _t=function(){ne=!1,ve&&(Be.apply($,ve),ve=!1)},Be=function(){ne?ve=arguments:(b.apply($,arguments),setTimeout(_t,z),ne=!0)},Be}function I(b,z,$){var ne=z[1],ve=z[0],Be=ne-ve;return b===ne&&$?b:((b-ve)%Be+Be)%Be+ve}function j(){return!1}function q(b,z){if(z===!1)return b;var $=Math.pow(10,z===void 0?6:z);return Math.round(b*$)/$}function K(b){return b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")}function J(b){return K(b).split(/\s+/)}function te(b,z){Object.prototype.hasOwnProperty.call(b,"options")||(b.options=b.options?y(b.options):{});for(var $ in z)b.options[$]=z[$];return b.options}function oe(b,z,$){var ne=[];for(var ve in b)ne.push(encodeURIComponent($?ve.toUpperCase():ve)+"="+encodeURIComponent(b[ve]));return(!z||z.indexOf("?")===-1?"?":"&")+ne.join("&")}var ce=/\{ *([\w_ -]+) *\}/g;function de(b,z){return b.replace(ce,function($,ne){var ve=z[ne];if(ve===void 0)throw new Error("No value provided for variable "+$);return typeof ve=="function"&&(ve=ve(z)),ve})}var ue=Array.isArray||function(b){return Object.prototype.toString.call(b)==="[object Array]"};function Pe(b,z){for(var $=0;$<b.length;$++)if(b[$]===z)return $;return-1}var Oe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function xe(b){return window["webkit"+b]||window["moz"+b]||window["ms"+b]}var Qe=0;function tt(b){var z=+new Date,$=Math.max(0,16-(z-Qe));return Qe=z+$,window.setTimeout(b,$)}var Ge=window.requestAnimationFrame||xe("RequestAnimationFrame")||tt,Je=window.cancelAnimationFrame||xe("CancelAnimationFrame")||xe("CancelRequestAnimationFrame")||function(b){window.clearTimeout(b)};function Ve(b,z,$){if($&&Ge===tt)b.call(z);else return Ge.call(window,T(b,z))}function xt(b){b&&Je.call(window,b)}var yt={__proto__:null,extend:f,create:y,bind:T,get lastId(){return o},stamp:C,throttle:M,wrapNum:I,falseFn:j,formatNum:q,trim:K,splitWords:J,setOptions:te,getParamString:oe,template:de,isArray:ue,indexOf:Pe,emptyImageUrl:Oe,requestFn:Ge,cancelFn:Je,requestAnimFrame:Ve,cancelAnimFrame:xt};function ot(){}ot.extend=function(b){var z=function(){te(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},$=z.__super__=this.prototype,ne=y($);ne.constructor=z,z.prototype=ne;for(var ve in this)Object.prototype.hasOwnProperty.call(this,ve)&&ve!=="prototype"&&ve!=="__super__"&&(z[ve]=this[ve]);return b.statics&&f(z,b.statics),b.includes&&(zt(b.includes),f.apply(null,[ne].concat(b.includes))),f(ne,b),delete ne.statics,delete ne.includes,ne.options&&(ne.options=$.options?y($.options):{},f(ne.options,b.options)),ne._initHooks=[],ne.callInitHooks=function(){if(!this._initHooksCalled){$.callInitHooks&&$.callInitHooks.call(this),this._initHooksCalled=!0;for(var Be=0,_t=ne._initHooks.length;Be<_t;Be++)ne._initHooks[Be].call(this)}},z},ot.include=function(b){var z=this.prototype.options;return f(this.prototype,b),b.options&&(this.prototype.options=z,this.mergeOptions(b.options)),this},ot.mergeOptions=function(b){return f(this.prototype.options,b),this},ot.addInitHook=function(b){var z=Array.prototype.slice.call(arguments,1),$=typeof b=="function"?b:function(){this[b].apply(this,z)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push($),this};function zt(b){if(!(typeof L>"u"||!L||!L.Mixin)){b=ue(b)?b:[b];for(var z=0;z<b.length;z++)b[z]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var rt={on:function(b,z,$){if(typeof b=="object")for(var ne in b)this._on(ne,b[ne],z);else{b=J(b);for(var ve=0,Be=b.length;ve<Be;ve++)this._on(b[ve],z,$)}return this},off:function(b,z,$){if(!arguments.length)delete this._events;else if(typeof b=="object")for(var ne in b)this._off(ne,b[ne],z);else{b=J(b);for(var ve=arguments.length===1,Be=0,_t=b.length;Be<_t;Be++)ve?this._off(b[Be]):this._off(b[Be],z,$)}return this},_on:function(b,z,$,ne){if(typeof z!="function"){console.warn("wrong listener type: "+typeof z);return}if(this._listens(b,z,$)===!1){$===this&&($=void 0);var ve={fn:z,ctx:$};ne&&(ve.once=!0),this._events=this._events||{},this._events[b]=this._events[b]||[],this._events[b].push(ve)}},_off:function(b,z,$){var ne,ve,Be;if(this._events&&(ne=this._events[b],!!ne)){if(arguments.length===1){if(this._firingCount)for(ve=0,Be=ne.length;ve<Be;ve++)ne[ve].fn=j;delete this._events[b];return}if(typeof z!="function"){console.warn("wrong listener type: "+typeof z);return}var _t=this._listens(b,z,$);if(_t!==!1){var Wt=ne[_t];this._firingCount&&(Wt.fn=j,this._events[b]=ne=ne.slice()),ne.splice(_t,1)}}},fire:function(b,z,$){if(!this.listens(b,$))return this;var ne=f({},z,{type:b,target:this,sourceTarget:z&&z.sourceTarget||this});if(this._events){var ve=this._events[b];if(ve){this._firingCount=this._firingCount+1||1;for(var Be=0,_t=ve.length;Be<_t;Be++){var Wt=ve[Be],ln=Wt.fn;Wt.once&&this.off(b,ln,Wt.ctx),ln.call(Wt.ctx||this,ne)}this._firingCount--}}return $&&this._propagateEvent(ne),this},listens:function(b,z,$,ne){typeof b!="string"&&console.warn('"string" type argument expected');var ve=z;typeof z!="function"&&(ne=!!z,ve=void 0,$=void 0);var Be=this._events&&this._events[b];if(Be&&Be.length&&this._listens(b,ve,$)!==!1)return!0;if(ne){for(var _t in this._eventParents)if(this._eventParents[_t].listens(b,z,$,ne))return!0}return!1},_listens:function(b,z,$){if(!this._events)return!1;var ne=this._events[b]||[];if(!z)return!!ne.length;$===this&&($=void 0);for(var ve=0,Be=ne.length;ve<Be;ve++)if(ne[ve].fn===z&&ne[ve].ctx===$)return ve;return!1},once:function(b,z,$){if(typeof b=="object")for(var ne in b)this._on(ne,b[ne],z,!0);else{b=J(b);for(var ve=0,Be=b.length;ve<Be;ve++)this._on(b[ve],z,$,!0)}return this},addEventParent:function(b){return this._eventParents=this._eventParents||{},this._eventParents[C(b)]=b,this},removeEventParent:function(b){return this._eventParents&&delete this._eventParents[C(b)],this},_propagateEvent:function(b){for(var z in this._eventParents)this._eventParents[z].fire(b.type,f({layer:b.target,propagatedFrom:b.target},b),!0)}};rt.addEventListener=rt.on,rt.removeEventListener=rt.clearAllEventListeners=rt.off,rt.addOneTimeEventListener=rt.once,rt.fireEvent=rt.fire,rt.hasEventListeners=rt.listens;var Bt=ot.extend(rt);function Vt(b,z,$){this.x=$?Math.round(b):b,this.y=$?Math.round(z):z}var Ln=Math.trunc||function(b){return b>0?Math.floor(b):Math.ceil(b)};Vt.prototype={clone:function(){return new Vt(this.x,this.y)},add:function(b){return this.clone()._add($e(b))},_add:function(b){return this.x+=b.x,this.y+=b.y,this},subtract:function(b){return this.clone()._subtract($e(b))},_subtract:function(b){return this.x-=b.x,this.y-=b.y,this},divideBy:function(b){return this.clone()._divideBy(b)},_divideBy:function(b){return this.x/=b,this.y/=b,this},multiplyBy:function(b){return this.clone()._multiplyBy(b)},_multiplyBy:function(b){return this.x*=b,this.y*=b,this},scaleBy:function(b){return new Vt(this.x*b.x,this.y*b.y)},unscaleBy:function(b){return new Vt(this.x/b.x,this.y/b.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ln(this.x),this.y=Ln(this.y),this},distanceTo:function(b){b=$e(b);var z=b.x-this.x,$=b.y-this.y;return Math.sqrt(z*z+$*$)},equals:function(b){return b=$e(b),b.x===this.x&&b.y===this.y},contains:function(b){return b=$e(b),Math.abs(b.x)<=Math.abs(this.x)&&Math.abs(b.y)<=Math.abs(this.y)},toString:function(){return"Point("+q(this.x)+", "+q(this.y)+")"}};function $e(b,z,$){return b instanceof Vt?b:ue(b)?new Vt(b[0],b[1]):b==null?b:typeof b=="object"&&"x"in b&&"y"in b?new Vt(b.x,b.y):new Vt(b,z,$)}function Pt(b,z){if(b)for(var $=z?[b,z]:b,ne=0,ve=$.length;ne<ve;ne++)this.extend($[ne])}Pt.prototype={extend:function(b){var z,$;if(!b)return this;if(b instanceof Vt||typeof b[0]=="number"||"x"in b)z=$=$e(b);else if(b=$t(b),z=b.min,$=b.max,!z||!$)return this;return!this.min&&!this.max?(this.min=z.clone(),this.max=$.clone()):(this.min.x=Math.min(z.x,this.min.x),this.max.x=Math.max($.x,this.max.x),this.min.y=Math.min(z.y,this.min.y),this.max.y=Math.max($.y,this.max.y)),this},getCenter:function(b){return $e((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,b)},getBottomLeft:function(){return $e(this.min.x,this.max.y)},getTopRight:function(){return $e(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(b){var z,$;return typeof b[0]=="number"||b instanceof Vt?b=$e(b):b=$t(b),b instanceof Pt?(z=b.min,$=b.max):z=$=b,z.x>=this.min.x&&$.x<=this.max.x&&z.y>=this.min.y&&$.y<=this.max.y},intersects:function(b){b=$t(b);var z=this.min,$=this.max,ne=b.min,ve=b.max,Be=ve.x>=z.x&&ne.x<=$.x,_t=ve.y>=z.y&&ne.y<=$.y;return Be&&_t},overlaps:function(b){b=$t(b);var z=this.min,$=this.max,ne=b.min,ve=b.max,Be=ve.x>z.x&&ne.x<$.x,_t=ve.y>z.y&&ne.y<$.y;return Be&&_t},isValid:function(){return!!(this.min&&this.max)},pad:function(b){var z=this.min,$=this.max,ne=Math.abs(z.x-$.x)*b,ve=Math.abs(z.y-$.y)*b;return $t($e(z.x-ne,z.y-ve),$e($.x+ne,$.y+ve))},equals:function(b){return b?(b=$t(b),this.min.equals(b.getTopLeft())&&this.max.equals(b.getBottomRight())):!1}};function $t(b,z){return!b||b instanceof Pt?b:new Pt(b,z)}function on(b,z){if(b)for(var $=z?[b,z]:b,ne=0,ve=$.length;ne<ve;ne++)this.extend($[ne])}on.prototype={extend:function(b){var z=this._southWest,$=this._northEast,ne,ve;if(b instanceof ct)ne=b,ve=b;else if(b instanceof on){if(ne=b._southWest,ve=b._northEast,!ne||!ve)return this}else return b?this.extend(kt(b)||An(b)):this;return!z&&!$?(this._southWest=new ct(ne.lat,ne.lng),this._northEast=new ct(ve.lat,ve.lng)):(z.lat=Math.min(ne.lat,z.lat),z.lng=Math.min(ne.lng,z.lng),$.lat=Math.max(ve.lat,$.lat),$.lng=Math.max(ve.lng,$.lng)),this},pad:function(b){var z=this._southWest,$=this._northEast,ne=Math.abs(z.lat-$.lat)*b,ve=Math.abs(z.lng-$.lng)*b;return new on(new ct(z.lat-ne,z.lng-ve),new ct($.lat+ne,$.lng+ve))},getCenter:function(){return new ct((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ct(this.getNorth(),this.getWest())},getSouthEast:function(){return new ct(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(b){typeof b[0]=="number"||b instanceof ct||"lat"in b?b=kt(b):b=An(b);var z=this._southWest,$=this._northEast,ne,ve;return b instanceof on?(ne=b.getSouthWest(),ve=b.getNorthEast()):ne=ve=b,ne.lat>=z.lat&&ve.lat<=$.lat&&ne.lng>=z.lng&&ve.lng<=$.lng},intersects:function(b){b=An(b);var z=this._southWest,$=this._northEast,ne=b.getSouthWest(),ve=b.getNorthEast(),Be=ve.lat>=z.lat&&ne.lat<=$.lat,_t=ve.lng>=z.lng&&ne.lng<=$.lng;return Be&&_t},overlaps:function(b){b=An(b);var z=this._southWest,$=this._northEast,ne=b.getSouthWest(),ve=b.getNorthEast(),Be=ve.lat>z.lat&&ne.lat<$.lat,_t=ve.lng>z.lng&&ne.lng<$.lng;return Be&&_t},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(b,z){return b?(b=An(b),this._southWest.equals(b.getSouthWest(),z)&&this._northEast.equals(b.getNorthEast(),z)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function An(b,z){return b instanceof on?b:new on(b,z)}function ct(b,z,$){if(isNaN(b)||isNaN(z))throw new Error("Invalid LatLng object: ("+b+", "+z+")");this.lat=+b,this.lng=+z,$!==void 0&&(this.alt=+$)}ct.prototype={equals:function(b,z){if(!b)return!1;b=kt(b);var $=Math.max(Math.abs(this.lat-b.lat),Math.abs(this.lng-b.lng));return $<=(z===void 0?1e-9:z)},toString:function(b){return"LatLng("+q(this.lat,b)+", "+q(this.lng,b)+")"},distanceTo:function(b){return ti.distance(this,kt(b))},wrap:function(){return ti.wrapLatLng(this)},toBounds:function(b){var z=180*b/40075017,$=z/Math.cos(Math.PI/180*this.lat);return An([this.lat-z,this.lng-$],[this.lat+z,this.lng+$])},clone:function(){return new ct(this.lat,this.lng,this.alt)}};function kt(b,z,$){return b instanceof ct?b:ue(b)&&typeof b[0]!="object"?b.length===3?new ct(b[0],b[1],b[2]):b.length===2?new ct(b[0],b[1]):null:b==null?b:typeof b=="object"&&"lat"in b?new ct(b.lat,"lng"in b?b.lng:b.lon,b.alt):z===void 0?null:new ct(b,z,$)}var In={latLngToPoint:function(b,z){var $=this.projection.project(b),ne=this.scale(z);return this.transformation._transform($,ne)},pointToLatLng:function(b,z){var $=this.scale(z),ne=this.transformation.untransform(b,$);return this.projection.unproject(ne)},project:function(b){return this.projection.project(b)},unproject:function(b){return this.projection.unproject(b)},scale:function(b){return 256*Math.pow(2,b)},zoom:function(b){return Math.log(b/256)/Math.LN2},getProjectedBounds:function(b){if(this.infinite)return null;var z=this.projection.bounds,$=this.scale(b),ne=this.transformation.transform(z.min,$),ve=this.transformation.transform(z.max,$);return new Pt(ne,ve)},infinite:!1,wrapLatLng:function(b){var z=this.wrapLng?I(b.lng,this.wrapLng,!0):b.lng,$=this.wrapLat?I(b.lat,this.wrapLat,!0):b.lat,ne=b.alt;return new ct($,z,ne)},wrapLatLngBounds:function(b){var z=b.getCenter(),$=this.wrapLatLng(z),ne=z.lat-$.lat,ve=z.lng-$.lng;if(ne===0&&ve===0)return b;var Be=b.getSouthWest(),_t=b.getNorthEast(),Wt=new ct(Be.lat-ne,Be.lng-ve),ln=new ct(_t.lat-ne,_t.lng-ve);return new on(Wt,ln)}},ti=f({},In,{wrapLng:[-180,180],R:6371e3,distance:function(b,z){var $=Math.PI/180,ne=b.lat*$,ve=z.lat*$,Be=Math.sin((z.lat-b.lat)*$/2),_t=Math.sin((z.lng-b.lng)*$/2),Wt=Be*Be+Math.cos(ne)*Math.cos(ve)*_t*_t,ln=2*Math.atan2(Math.sqrt(Wt),Math.sqrt(1-Wt));return this.R*ln}}),Dt=6378137,jn={R:Dt,MAX_LATITUDE:85.0511287798,project:function(b){var z=Math.PI/180,$=this.MAX_LATITUDE,ne=Math.max(Math.min($,b.lat),-$),ve=Math.sin(ne*z);return new Vt(this.R*b.lng*z,this.R*Math.log((1+ve)/(1-ve))/2)},unproject:function(b){var z=180/Math.PI;return new ct((2*Math.atan(Math.exp(b.y/this.R))-Math.PI/2)*z,b.x*z/this.R)},bounds:function(){var b=Dt*Math.PI;return new Pt([-b,-b],[b,b])}()};function ai(b,z,$,ne){if(ue(b)){this._a=b[0],this._b=b[1],this._c=b[2],this._d=b[3];return}this._a=b,this._b=z,this._c=$,this._d=ne}ai.prototype={transform:function(b,z){return this._transform(b.clone(),z)},_transform:function(b,z){return z=z||1,b.x=z*(this._a*b.x+this._b),b.y=z*(this._c*b.y+this._d),b},untransform:function(b,z){return z=z||1,new Vt((b.x/z-this._b)/this._a,(b.y/z-this._d)/this._c)}};function mn(b,z,$,ne){return new ai(b,z,$,ne)}var ci=f({},ti,{code:"EPSG:3857",projection:jn,transformation:function(){var b=.5/(Math.PI*jn.R);return mn(b,.5,-b,.5)}()}),Ii=f({},ci,{code:"EPSG:900913"});function Mi(b){return document.createElementNS("http://www.w3.org/2000/svg",b)}function Tr(b,z){var $="",ne,ve,Be,_t,Wt,ln;for(ne=0,Be=b.length;ne<Be;ne++){for(Wt=b[ne],ve=0,_t=Wt.length;ve<_t;ve++)ln=Wt[ve],$+=(ve?"L":"M")+ln.x+" "+ln.y;$+=z?be.svg?"z":"x":""}return $||"M0 0"}var kr=document.documentElement.style,ja="ActiveXObject"in window,Xr=ja&&!document.addEventListener,Yr="msLaunchUri"in navigator&&!("documentMode"in document),go=Ne("webkit"),_a=Ne("android"),ya=Ne("android 2")||Ne("android 3"),aa=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),qs=_a&&Ne("Google")&&aa<537&&!("AudioNode"in window),Ho=!!window.opera,Ar=!Yr&&Ne("chrome"),Fa=Ne("gecko")&&!go&&!Ho&&!ja,Po=!Ar&&Ne("safari"),bl=Ne("phantom"),ro="OTransition"in kr,Ea=navigator.platform.indexOf("Win")===0,Ua=ja&&"transition"in kr,Co="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ya,ea="MozPerspective"in kr,Aa=!window.L_DISABLE_3D&&(Ua||Co||ea)&&!ro&&!bl,Go=typeof orientation<"u"||Ne("mobile"),tr=Go&&go,Pa=Go&&Co,Is=!window.PointerEvent&&window.MSPointerEvent,ta=!!(window.PointerEvent||Is),al="ontouchstart"in window||!!window.TouchEvent,ls=!window.L_NO_TOUCH&&(al||ta),Ca=Go&&Ho,hn=Go&&Fa,vs=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ja=function(){var b=!1;try{var z=Object.defineProperty({},"passive",{get:function(){b=!0}});window.addEventListener("testPassiveEventSupport",j,z),window.removeEventListener("testPassiveEventSupport",j,z)}catch{}return b}(),bt=function(){return!!document.createElement("canvas").getContext}(),Tt=!!(document.createElementNS&&Mi("svg").createSVGRect),je=!!Tt&&function(){var b=document.createElement("div");return b.innerHTML="<svg/>",(b.firstChild&&b.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ae=!Tt&&function(){try{var b=document.createElement("div");b.innerHTML='<v:shape adj="1"/>';var z=b.firstChild;return z.style.behavior="url(#default#VML)",z&&typeof z.adj=="object"}catch{return!1}}(),ge=navigator.platform.indexOf("Mac")===0,Ee=navigator.platform.indexOf("Linux")===0;function Ne(b){return navigator.userAgent.toLowerCase().indexOf(b)>=0}var be={ie:ja,ielt9:Xr,edge:Yr,webkit:go,android:_a,android23:ya,androidStock:qs,opera:Ho,chrome:Ar,gecko:Fa,safari:Po,phantom:bl,opera12:ro,win:Ea,ie3d:Ua,webkit3d:Co,gecko3d:ea,any3d:Aa,mobile:Go,mobileWebkit:tr,mobileWebkit3d:Pa,msPointer:Is,pointer:ta,touch:ls,touchNative:al,mobileOpera:Ca,mobileGecko:hn,retina:vs,passiveEvents:Ja,canvas:bt,svg:Tt,vml:ae,inlineSvg:je,mac:ge,linux:Ee},We=be.msPointer?"MSPointerDown":"pointerdown",nt=be.msPointer?"MSPointerMove":"pointermove",Xe=be.msPointer?"MSPointerUp":"pointerup",lt=be.msPointer?"MSPointerCancel":"pointercancel",gt={touchstart:We,touchmove:nt,touchend:Xe,touchcancel:lt},ht={touchstart:_r,touchmove:Wi,touchend:Wi,touchcancel:Wi},Zt={},vn=!1;function _n(b,z,$){return z==="touchstart"&&ui(),ht[z]?($=ht[z].bind(this,$),b.addEventListener(gt[z],$,!1),$):(console.warn("wrong event specified:",z),j)}function zn(b,z,$){if(!gt[z]){console.warn("wrong event specified:",z);return}b.removeEventListener(gt[z],$,!1)}function ii(b){Zt[b.pointerId]=b}function si(b){Zt[b.pointerId]&&(Zt[b.pointerId]=b)}function gi(b){delete Zt[b.pointerId]}function ui(){vn||(document.addEventListener(We,ii,!0),document.addEventListener(nt,si,!0),document.addEventListener(Xe,gi,!0),document.addEventListener(lt,gi,!0),vn=!0)}function Wi(b,z){if(z.pointerType!==(z.MSPOINTER_TYPE_MOUSE||"mouse")){z.touches=[];for(var $ in Zt)z.touches.push(Zt[$]);z.changedTouches=[z],b(z)}}function _r(b,z){z.MSPOINTER_TYPE_TOUCH&&z.pointerType===z.MSPOINTER_TYPE_TOUCH&&No(z),Wi(b,z)}function ir(b){var z={},$,ne;for(ne in b)$=b[ne],z[ne]=$&&$.bind?$.bind(b):$;return b=z,z.type="dblclick",z.detail=2,z.isTrusted=!1,z._simulated=!0,z}var ki=200;function Fi(b,z){b.addEventListener("dblclick",z);var $=0,ne;function ve(Be){if(Be.detail!==1){ne=Be.detail;return}if(!(Be.pointerType==="mouse"||Be.sourceCapabilities&&!Be.sourceCapabilities.firesTouchEvents)){var _t=Ts(Be);if(!(_t.some(function(ln){return ln instanceof HTMLLabelElement&&ln.attributes.for})&&!_t.some(function(ln){return ln instanceof HTMLInputElement||ln instanceof HTMLSelectElement}))){var Wt=Date.now();Wt-$<=ki?(ne++,ne===2&&z(ir(Be))):ne=1,$=Wt}}}return b.addEventListener("click",ve),{dblclick:z,simDblclick:ve}}function vi(b,z){b.removeEventListener("dblclick",z.dblclick),b.removeEventListener("click",z.simDblclick)}var nr=va(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),rr=va(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Nr=rr==="webkitTransition"||rr==="OTransition"?rr+"End":"transitionend";function Zo(b){return typeof b=="string"?document.getElementById(b):b}function hr(b,z){var $=b.style[z]||b.currentStyle&&b.currentStyle[z];if((!$||$==="auto")&&document.defaultView){var ne=document.defaultView.getComputedStyle(b,null);$=ne?ne[z]:null}return $==="auto"?null:$}function Xi(b,z,$){var ne=document.createElement(b);return ne.className=z||"",$&&$.appendChild(ne),ne}function or(b){var z=b.parentNode;z&&z.removeChild(b)}function Lo(b){for(;b.firstChild;)b.removeChild(b.firstChild)}function Hs(b){var z=b.parentNode;z&&z.lastChild!==b&&z.appendChild(b)}function Ds(b){var z=b.parentNode;z&&z.firstChild!==b&&z.insertBefore(b,z.firstChild)}function sl(b,z){if(b.classList!==void 0)return b.classList.contains(z);var $=So(b);return $.length>0&&new RegExp("(^|\\s)"+z+"(\\s|$)").test($)}function cr(b,z){if(b.classList!==void 0)for(var $=J(z),ne=0,ve=$.length;ne<ve;ne++)b.classList.add($[ne]);else if(!sl(b,z)){var Be=So(b);ll(b,(Be?Be+" ":"")+z)}}function Kr(b,z){b.classList!==void 0?b.classList.remove(z):ll(b,K((" "+So(b)+" ").replace(" "+z+" "," ")))}function ll(b,z){b.className.baseVal===void 0?b.className=z:b.className.baseVal=z}function So(b){return b.correspondingElement&&(b=b.correspondingElement),b.className.baseVal===void 0?b.className:b.className.baseVal}function Bo(b,z){"opacity"in b.style?b.style.opacity=z:"filter"in b.style&&xs(b,z)}function xs(b,z){var $=!1,ne="DXImageTransform.Microsoft.Alpha";try{$=b.filters.item(ne)}catch{if(z===1)return}z=Math.round(z*100),$?($.Enabled=z!==100,$.Opacity=z):b.style.filter+=" progid:"+ne+"(opacity="+z+")"}function va(b){for(var z=document.documentElement.style,$=0;$<b.length;$++)if(b[$]in z)return b[$];return!1}function jo(b,z,$){var ne=z||new Vt(0,0);b.style[nr]=(be.ie3d?"translate("+ne.x+"px,"+ne.y+"px)":"translate3d("+ne.x+"px,"+ne.y+"px,0)")+($?" scale("+$+")":"")}function uo(b,z){b._leaflet_pos=z,be.any3d?jo(b,z):(b.style.left=z.x+"px",b.style.top=z.y+"px")}function ha(b){return b._leaflet_pos||new Vt(0,0)}var da,wl,bs;if("onselectstart"in document)da=function(){Ni(window,"selectstart",No)},wl=function(){ri(window,"selectstart",No)};else{var Gs=va(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);da=function(){if(Gs){var b=document.documentElement.style;bs=b[Gs],b[Gs]="none"}},wl=function(){Gs&&(document.documentElement.style[Gs]=bs,bs=void 0)}}function cs(){Ni(window,"dragstart",No)}function us(){ri(window,"dragstart",No)}var ic,St;function en(b){for(;b.tabIndex===-1;)b=b.parentNode;b.style&&(Vn(),ic=b,St=b.style.outlineStyle,b.style.outlineStyle="none",Ni(window,"keydown",Vn))}function Vn(){ic&&(ic.style.outlineStyle=St,ic=void 0,St=void 0,ri(window,"keydown",Vn))}function Zi(b){do b=b.parentNode;while((!b.offsetWidth||!b.offsetHeight)&&b!==document.body);return b}function yr(b){var z=b.getBoundingClientRect();return{x:z.width/b.offsetWidth||1,y:z.height/b.offsetHeight||1,boundingClientRect:z}}var na={__proto__:null,TRANSFORM:nr,TRANSITION:rr,TRANSITION_END:Nr,get:Zo,getStyle:hr,create:Xi,remove:or,empty:Lo,toFront:Hs,toBack:Ds,hasClass:sl,addClass:cr,removeClass:Kr,setClass:ll,getClass:So,setOpacity:Bo,testProp:va,setTransform:jo,setPosition:uo,getPosition:ha,get disableTextSelection(){return da},get enableTextSelection(){return wl},disableImageDrag:cs,enableImageDrag:us,preventOutline:en,restoreOutline:Vn,getSizedParentNode:Zi,getScale:yr};function Ni(b,z,$,ne){if(z&&typeof z=="object")for(var ve in z)ko(b,ve,z[ve],$);else{z=J(z);for(var Be=0,_t=z.length;Be<_t;Be++)ko(b,z[Be],$,ne)}return this}var Sr="_leaflet_events";function ri(b,z,$,ne){if(arguments.length===1)zo(b),delete b[Sr];else if(z&&typeof z=="object")for(var ve in z)Rs(b,ve,z[ve],$);else if(z=J(z),arguments.length===2)zo(b,function(Wt){return Pe(z,Wt)!==-1});else for(var Be=0,_t=z.length;Be<_t;Be++)Rs(b,z[Be],$,ne);return this}function zo(b,z){for(var $ in b[Sr]){var ne=$.split(/\d/)[0];(!z||z(ne))&&Rs(b,ne,null,null,$)}}var hs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ko(b,z,$,ne){var ve=z+C($)+(ne?"_"+C(ne):"");if(b[Sr]&&b[Sr][ve])return this;var Be=function(Wt){return $.call(ne||b,Wt||window.event)},_t=Be;!be.touchNative&&be.pointer&&z.indexOf("touch")===0?Be=_n(b,z,Be):be.touch&&z==="dblclick"?Be=Fi(b,Be):"addEventListener"in b?z==="touchstart"||z==="touchmove"||z==="wheel"||z==="mousewheel"?b.addEventListener(hs[z]||z,Be,be.passiveEvents?{passive:!1}:!1):z==="mouseenter"||z==="mouseleave"?(Be=function(Wt){Wt=Wt||window.event,st(b,Wt)&&_t(Wt)},b.addEventListener(hs[z],Be,!1)):b.addEventListener(z,_t,!1):b.attachEvent("on"+z,Be),b[Sr]=b[Sr]||{},b[Sr][ve]=Be}function Rs(b,z,$,ne,ve){ve=ve||z+C($)+(ne?"_"+C(ne):"");var Be=b[Sr]&&b[Sr][ve];if(!Be)return this;!be.touchNative&&be.pointer&&z.indexOf("touch")===0?zn(b,z,Be):be.touch&&z==="dblclick"?vi(b,Be):"removeEventListener"in b?b.removeEventListener(hs[z]||z,Be,!1):b.detachEvent("on"+z,Be),b[Sr][ve]=null}function ws(b){return b.stopPropagation?b.stopPropagation():b.originalEvent?b.originalEvent._stopped=!0:b.cancelBubble=!0,this}function Qa(b){return ko(b,"wheel",ws),this}function Ma(b){return Ni(b,"mousedown touchstart dblclick contextmenu",ws),b._leaflet_disable_click=!0,this}function No(b){return b.preventDefault?b.preventDefault():b.returnValue=!1,this}function Oa(b){return No(b),ws(b),this}function Ts(b){if(b.composedPath)return b.composedPath();for(var z=[],$=b.target;$;)z.push($),$=$.parentNode;return z}function Va(b,z){if(!z)return new Vt(b.clientX,b.clientY);var $=yr(z),ne=$.boundingClientRect;return new Vt((b.clientX-ne.left)/$.x-z.clientLeft,(b.clientY-ne.top)/$.y-z.clientTop)}var $a=be.linux&&be.chrome?window.devicePixelRatio:be.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Tl(b){return be.edge?b.wheelDeltaY/2:b.deltaY&&b.deltaMode===0?-b.deltaY/$a:b.deltaY&&b.deltaMode===1?-b.deltaY*20:b.deltaY&&b.deltaMode===2?-b.deltaY*60:b.deltaX||b.deltaZ?0:b.wheelDelta?(b.wheelDeltaY||b.wheelDelta)/2:b.detail&&Math.abs(b.detail)<32765?-b.detail*20:b.detail?b.detail/-32765*60:0}function st(b,z){var $=z.relatedTarget;if(!$)return!0;try{for(;$&&$!==b;)$=$.parentNode}catch{return!1}return $!==b}var Ut={__proto__:null,on:Ni,off:ri,stopPropagation:ws,disableScrollPropagation:Qa,disableClickPropagation:Ma,preventDefault:No,stop:Oa,getPropagationPath:Ts,getMousePosition:Va,getWheelDelta:Tl,isExternalTarget:st,addListener:Ni,removeListener:ri},kn=Bt.extend({run:function(b,z,$,ne){this.stop(),this._el=b,this._inProgress=!0,this._duration=$||.25,this._easeOutPower=1/Math.max(ne||.5,.2),this._startPos=ha(b),this._offset=z.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Ve(this._animate,this),this._step()},_step:function(b){var z=+new Date-this._startTime,$=this._duration*1e3;z<$?this._runFrame(this._easeOut(z/$),b):(this._runFrame(1),this._complete())},_runFrame:function(b,z){var $=this._startPos.add(this._offset.multiplyBy(b));z&&$._round(),uo(this._el,$),this.fire("step")},_complete:function(){xt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(b){return 1-Math.pow(1-b,this._easeOutPower)}}),qn=Bt.extend({options:{crs:ci,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(b,z){z=te(this,z),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(b),this._initLayout(),this._onResize=T(this._onResize,this),this._initEvents(),z.maxBounds&&this.setMaxBounds(z.maxBounds),z.zoom!==void 0&&(this._zoom=this._limitZoom(z.zoom)),z.center&&z.zoom!==void 0&&this.setView(kt(z.center),z.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=rr&&be.any3d&&!be.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ni(this._proxy,Nr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(b,z,$){if(z=z===void 0?this._zoom:this._limitZoom(z),b=this._limitCenter(kt(b),z,this.options.maxBounds),$=$||{},this._stop(),this._loaded&&!$.reset&&$!==!0){$.animate!==void 0&&($.zoom=f({animate:$.animate},$.zoom),$.pan=f({animate:$.animate,duration:$.duration},$.pan));var ne=this._zoom!==z?this._tryAnimatedZoom&&this._tryAnimatedZoom(b,z,$.zoom):this._tryAnimatedPan(b,$.pan);if(ne)return clearTimeout(this._sizeTimer),this}return this._resetView(b,z,$.pan&&$.pan.noMoveStart),this},setZoom:function(b,z){return this._loaded?this.setView(this.getCenter(),b,{zoom:z}):(this._zoom=b,this)},zoomIn:function(b,z){return b=b||(be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+b,z)},zoomOut:function(b,z){return b=b||(be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-b,z)},setZoomAround:function(b,z,$){var ne=this.getZoomScale(z),ve=this.getSize().divideBy(2),Be=b instanceof Vt?b:this.latLngToContainerPoint(b),_t=Be.subtract(ve).multiplyBy(1-1/ne),Wt=this.containerPointToLatLng(ve.add(_t));return this.setView(Wt,z,{zoom:$})},_getBoundsCenterZoom:function(b,z){z=z||{},b=b.getBounds?b.getBounds():An(b);var $=$e(z.paddingTopLeft||z.padding||[0,0]),ne=$e(z.paddingBottomRight||z.padding||[0,0]),ve=this.getBoundsZoom(b,!1,$.add(ne));if(ve=typeof z.maxZoom=="number"?Math.min(z.maxZoom,ve):ve,ve===1/0)return{center:b.getCenter(),zoom:ve};var Be=ne.subtract($).divideBy(2),_t=this.project(b.getSouthWest(),ve),Wt=this.project(b.getNorthEast(),ve),ln=this.unproject(_t.add(Wt).divideBy(2).add(Be),ve);return{center:ln,zoom:ve}},fitBounds:function(b,z){if(b=An(b),!b.isValid())throw new Error("Bounds are not valid.");var $=this._getBoundsCenterZoom(b,z);return this.setView($.center,$.zoom,z)},fitWorld:function(b){return this.fitBounds([[-90,-180],[90,180]],b)},panTo:function(b,z){return this.setView(b,this._zoom,{pan:z})},panBy:function(b,z){if(b=$e(b).round(),z=z||{},!b.x&&!b.y)return this.fire("moveend");if(z.animate!==!0&&!this.getSize().contains(b))return this._resetView(this.unproject(this.project(this.getCenter()).add(b)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new kn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),z.noMoveStart||this.fire("movestart"),z.animate!==!1){cr(this._mapPane,"leaflet-pan-anim");var $=this._getMapPanePos().subtract(b).round();this._panAnim.run(this._mapPane,$,z.duration||.25,z.easeLinearity)}else this._rawPanBy(b),this.fire("move").fire("moveend");return this},flyTo:function(b,z,$){if($=$||{},$.animate===!1||!be.any3d)return this.setView(b,z,$);this._stop();var ne=this.project(this.getCenter()),ve=this.project(b),Be=this.getSize(),_t=this._zoom;b=kt(b),z=z===void 0?_t:z;var Wt=Math.max(Be.x,Be.y),ln=Wt*this.getZoomScale(_t,z),Un=ve.distanceTo(ne)||1,yi=1.42,Ti=yi*yi;function Ai(ma){var Ss=ma?-1:1,pc=ma?ln:Wt,Zc=ln*ln-Wt*Wt+Ss*Ti*Ti*Un*Un,Wc=2*pc*Ti*Un,Dd=Zc/Wc,qh=Math.sqrt(Dd*Dd+1)-Dd,mu=qh<1e-9?-18:Math.log(qh);return mu}function br(ma){return(Math.exp(ma)-Math.exp(-ma))/2}function Wo(ma){return(Math.exp(ma)+Math.exp(-ma))/2}function ba(ma){return br(ma)/Wo(ma)}var Da=Ai(0);function Ws(ma){return Wt*(Wo(Da)/Wo(Da+yi*ma))}function Id(ma){return Wt*(Wo(Da)*ba(Da+yi*ma)-br(Da))/Ti}function bf(ma){return 1-Math.pow(1-ma,1.5)}var pu=Date.now(),fc=(Ai(1)-Da)/yi,vp=$.duration?1e3*$.duration:1e3*fc*.8;function th(){var ma=(Date.now()-pu)/vp,Ss=bf(ma)*fc;ma<=1?(this._flyToFrame=Ve(th,this),this._move(this.unproject(ne.add(ve.subtract(ne).multiplyBy(Id(Ss)/Un)),_t),this.getScaleZoom(Wt/Ws(Ss),_t),{flyTo:!0})):this._move(b,z)._moveEnd(!0)}return this._moveStart(!0,$.noMoveStart),th.call(this),this},flyToBounds:function(b,z){var $=this._getBoundsCenterZoom(b,z);return this.flyTo($.center,$.zoom,z)},setMaxBounds:function(b){return b=An(b),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),b.isValid()?(this.options.maxBounds=b,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(b){var z=this.options.minZoom;return this.options.minZoom=b,this._loaded&&z!==b&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(b):this},setMaxZoom:function(b){var z=this.options.maxZoom;return this.options.maxZoom=b,this._loaded&&z!==b&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(b):this},panInsideBounds:function(b,z){this._enforcingBounds=!0;var $=this.getCenter(),ne=this._limitCenter($,this._zoom,An(b));return $.equals(ne)||this.panTo(ne,z),this._enforcingBounds=!1,this},panInside:function(b,z){z=z||{};var $=$e(z.paddingTopLeft||z.padding||[0,0]),ne=$e(z.paddingBottomRight||z.padding||[0,0]),ve=this.project(this.getCenter()),Be=this.project(b),_t=this.getPixelBounds(),Wt=$t([_t.min.add($),_t.max.subtract(ne)]),ln=Wt.getSize();if(!Wt.contains(Be)){this._enforcingBounds=!0;var Un=Be.subtract(Wt.getCenter()),yi=Wt.extend(Be).getSize().subtract(ln);ve.x+=Un.x<0?-yi.x:yi.x,ve.y+=Un.y<0?-yi.y:yi.y,this.panTo(this.unproject(ve),z),this._enforcingBounds=!1}return this},invalidateSize:function(b){if(!this._loaded)return this;b=f({animate:!1,pan:!0},b===!0?{animate:!0}:b);var z=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var $=this.getSize(),ne=z.divideBy(2).round(),ve=$.divideBy(2).round(),Be=ne.subtract(ve);return!Be.x&&!Be.y?this:(b.animate&&b.pan?this.panBy(Be):(b.pan&&this._rawPanBy(Be),this.fire("move"),b.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(T(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:z,newSize:$}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(b){if(b=this._locateOptions=f({timeout:1e4,watch:!1},b),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var z=T(this._handleGeolocationResponse,this),$=T(this._handleGeolocationError,this);return b.watch?this._locationWatchId=navigator.geolocation.watchPosition(z,$,b):navigator.geolocation.getCurrentPosition(z,$,b),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(b){if(this._container._leaflet_id){var z=b.code,$=b.message||(z===1?"permission denied":z===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:z,message:"Geolocation error: "+$+"."})}},_handleGeolocationResponse:function(b){if(this._container._leaflet_id){var z=b.coords.latitude,$=b.coords.longitude,ne=new ct(z,$),ve=ne.toBounds(b.coords.accuracy*2),Be=this._locateOptions;if(Be.setView){var _t=this.getBoundsZoom(ve);this.setView(ne,Be.maxZoom?Math.min(_t,Be.maxZoom):_t)}var Wt={latlng:ne,bounds:ve,timestamp:b.timestamp};for(var ln in b.coords)typeof b.coords[ln]=="number"&&(Wt[ln]=b.coords[ln]);this.fire("locationfound",Wt)}},addHandler:function(b,z){if(!z)return this;var $=this[b]=new z(this);return this._handlers.push($),this.options[b]&&$.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),or(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(xt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var b;for(b in this._layers)this._layers[b].remove();for(b in this._panes)or(this._panes[b]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(b,z){var $="leaflet-pane"+(b?" leaflet-"+b.replace("Pane","")+"-pane":""),ne=Xi("div",$,z||this._mapPane);return b&&(this._panes[b]=ne),ne},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var b=this.getPixelBounds(),z=this.unproject(b.getBottomLeft()),$=this.unproject(b.getTopRight());return new on(z,$)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(b,z,$){b=An(b),$=$e($||[0,0]);var ne=this.getZoom()||0,ve=this.getMinZoom(),Be=this.getMaxZoom(),_t=b.getNorthWest(),Wt=b.getSouthEast(),ln=this.getSize().subtract($),Un=$t(this.project(Wt,ne),this.project(_t,ne)).getSize(),yi=be.any3d?this.options.zoomSnap:1,Ti=ln.x/Un.x,Ai=ln.y/Un.y,br=z?Math.max(Ti,Ai):Math.min(Ti,Ai);return ne=this.getScaleZoom(br,ne),yi&&(ne=Math.round(ne/(yi/100))*(yi/100),ne=z?Math.ceil(ne/yi)*yi:Math.floor(ne/yi)*yi),Math.max(ve,Math.min(Be,ne))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Vt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(b,z){var $=this._getTopLeftPoint(b,z);return new Pt($,$.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(b){return this.options.crs.getProjectedBounds(b===void 0?this.getZoom():b)},getPane:function(b){return typeof b=="string"?this._panes[b]:b},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(b,z){var $=this.options.crs;return z=z===void 0?this._zoom:z,$.scale(b)/$.scale(z)},getScaleZoom:function(b,z){var $=this.options.crs;z=z===void 0?this._zoom:z;var ne=$.zoom(b*$.scale(z));return isNaN(ne)?1/0:ne},project:function(b,z){return z=z===void 0?this._zoom:z,this.options.crs.latLngToPoint(kt(b),z)},unproject:function(b,z){return z=z===void 0?this._zoom:z,this.options.crs.pointToLatLng($e(b),z)},layerPointToLatLng:function(b){var z=$e(b).add(this.getPixelOrigin());return this.unproject(z)},latLngToLayerPoint:function(b){var z=this.project(kt(b))._round();return z._subtract(this.getPixelOrigin())},wrapLatLng:function(b){return this.options.crs.wrapLatLng(kt(b))},wrapLatLngBounds:function(b){return this.options.crs.wrapLatLngBounds(An(b))},distance:function(b,z){return this.options.crs.distance(kt(b),kt(z))},containerPointToLayerPoint:function(b){return $e(b).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(b){return $e(b).add(this._getMapPanePos())},containerPointToLatLng:function(b){var z=this.containerPointToLayerPoint($e(b));return this.layerPointToLatLng(z)},latLngToContainerPoint:function(b){return this.layerPointToContainerPoint(this.latLngToLayerPoint(kt(b)))},mouseEventToContainerPoint:function(b){return Va(b,this._container)},mouseEventToLayerPoint:function(b){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(b))},mouseEventToLatLng:function(b){return this.layerPointToLatLng(this.mouseEventToLayerPoint(b))},_initContainer:function(b){var z=this._container=Zo(b);if(z){if(z._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ni(z,"scroll",this._onScroll,this),this._containerId=C(z)},_initLayout:function(){var b=this._container;this._fadeAnimated=this.options.fadeAnimation&&be.any3d,cr(b,"leaflet-container"+(be.touch?" leaflet-touch":"")+(be.retina?" leaflet-retina":"")+(be.ielt9?" leaflet-oldie":"")+(be.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var z=hr(b,"position");z!=="absolute"&&z!=="relative"&&z!=="fixed"&&z!=="sticky"&&(b.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var b=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),uo(this._mapPane,new Vt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(cr(b.markerPane,"leaflet-zoom-hide"),cr(b.shadowPane,"leaflet-zoom-hide"))},_resetView:function(b,z,$){uo(this._mapPane,new Vt(0,0));var ne=!this._loaded;this._loaded=!0,z=this._limitZoom(z),this.fire("viewprereset");var ve=this._zoom!==z;this._moveStart(ve,$)._move(b,z)._moveEnd(ve),this.fire("viewreset"),ne&&this.fire("load")},_moveStart:function(b,z){return b&&this.fire("zoomstart"),z||this.fire("movestart"),this},_move:function(b,z,$,ne){z===void 0&&(z=this._zoom);var ve=this._zoom!==z;return this._zoom=z,this._lastCenter=b,this._pixelOrigin=this._getNewPixelOrigin(b),ne?$&&$.pinch&&this.fire("zoom",$):((ve||$&&$.pinch)&&this.fire("zoom",$),this.fire("move",$)),this},_moveEnd:function(b){return b&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return xt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(b){uo(this._mapPane,this._getMapPanePos().subtract(b))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(b){this._targets={},this._targets[C(this._container)]=this;var z=b?ri:Ni;z(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&z(window,"resize",this._onResize,this),be.any3d&&this.options.transform3DLimit&&(b?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){xt(this._resizeRequest),this._resizeRequest=Ve(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var b=this._getMapPanePos();Math.max(Math.abs(b.x),Math.abs(b.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(b,z){for(var $=[],ne,ve=z==="mouseout"||z==="mouseover",Be=b.target||b.srcElement,_t=!1;Be;){if(ne=this._targets[C(Be)],ne&&(z==="click"||z==="preclick")&&this._draggableMoved(ne)){_t=!0;break}if(ne&&ne.listens(z,!0)&&(ve&&!st(Be,b)||($.push(ne),ve))||Be===this._container)break;Be=Be.parentNode}return!$.length&&!_t&&!ve&&this.listens(z,!0)&&($=[this]),$},_isClickDisabled:function(b){for(;b&&b!==this._container;){if(b._leaflet_disable_click)return!0;b=b.parentNode}},_handleDOMEvent:function(b){var z=b.target||b.srcElement;if(!(!this._loaded||z._leaflet_disable_events||b.type==="click"&&this._isClickDisabled(z))){var $=b.type;$==="mousedown"&&en(z),this._fireDOMEvent(b,$)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(b,z,$){if(b.type==="click"){var ne=f({},b);ne.type="preclick",this._fireDOMEvent(ne,ne.type,$)}var ve=this._findEventTargets(b,z);if($){for(var Be=[],_t=0;_t<$.length;_t++)$[_t].listens(z,!0)&&Be.push($[_t]);ve=Be.concat(ve)}if(ve.length){z==="contextmenu"&&No(b);var Wt=ve[0],ln={originalEvent:b};if(b.type!=="keypress"&&b.type!=="keydown"&&b.type!=="keyup"){var Un=Wt.getLatLng&&(!Wt._radius||Wt._radius<=10);ln.containerPoint=Un?this.latLngToContainerPoint(Wt.getLatLng()):this.mouseEventToContainerPoint(b),ln.layerPoint=this.containerPointToLayerPoint(ln.containerPoint),ln.latlng=Un?Wt.getLatLng():this.layerPointToLatLng(ln.layerPoint)}for(_t=0;_t<ve.length;_t++)if(ve[_t].fire(z,ln,!0),ln.originalEvent._stopped||ve[_t].options.bubblingMouseEvents===!1&&Pe(this._mouseEvents,z)!==-1)return}},_draggableMoved:function(b){return b=b.dragging&&b.dragging.enabled()?b:this,b.dragging&&b.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var b=0,z=this._handlers.length;b<z;b++)this._handlers[b].disable()},whenReady:function(b,z){return this._loaded?b.call(z||this,{target:this}):this.on("load",b,z),this},_getMapPanePos:function(){return ha(this._mapPane)||new Vt(0,0)},_moved:function(){var b=this._getMapPanePos();return b&&!b.equals([0,0])},_getTopLeftPoint:function(b,z){var $=b&&z!==void 0?this._getNewPixelOrigin(b,z):this.getPixelOrigin();return $.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(b,z){var $=this.getSize()._divideBy(2);return this.project(b,z)._subtract($)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(b,z,$){var ne=this._getNewPixelOrigin($,z);return this.project(b,z)._subtract(ne)},_latLngBoundsToNewLayerBounds:function(b,z,$){var ne=this._getNewPixelOrigin($,z);return $t([this.project(b.getSouthWest(),z)._subtract(ne),this.project(b.getNorthWest(),z)._subtract(ne),this.project(b.getSouthEast(),z)._subtract(ne),this.project(b.getNorthEast(),z)._subtract(ne)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(b){return this.latLngToLayerPoint(b).subtract(this._getCenterLayerPoint())},_limitCenter:function(b,z,$){if(!$)return b;var ne=this.project(b,z),ve=this.getSize().divideBy(2),Be=new Pt(ne.subtract(ve),ne.add(ve)),_t=this._getBoundsOffset(Be,$,z);return Math.abs(_t.x)<=1&&Math.abs(_t.y)<=1?b:this.unproject(ne.add(_t),z)},_limitOffset:function(b,z){if(!z)return b;var $=this.getPixelBounds(),ne=new Pt($.min.add(b),$.max.add(b));return b.add(this._getBoundsOffset(ne,z))},_getBoundsOffset:function(b,z,$){var ne=$t(this.project(z.getNorthEast(),$),this.project(z.getSouthWest(),$)),ve=ne.min.subtract(b.min),Be=ne.max.subtract(b.max),_t=this._rebound(ve.x,-Be.x),Wt=this._rebound(ve.y,-Be.y);return new Vt(_t,Wt)},_rebound:function(b,z){return b+z>0?Math.round(b-z)/2:Math.max(0,Math.ceil(b))-Math.max(0,Math.floor(z))},_limitZoom:function(b){var z=this.getMinZoom(),$=this.getMaxZoom(),ne=be.any3d?this.options.zoomSnap:1;return ne&&(b=Math.round(b/ne)*ne),Math.max(z,Math.min($,b))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Kr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(b,z){var $=this._getCenterOffset(b)._trunc();return(z&&z.animate)!==!0&&!this.getSize().contains($)?!1:(this.panBy($,z),!0)},_createAnimProxy:function(){var b=this._proxy=Xi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(b),this.on("zoomanim",function(z){var $=nr,ne=this._proxy.style[$];jo(this._proxy,this.project(z.center,z.zoom),this.getZoomScale(z.zoom,1)),ne===this._proxy.style[$]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){or(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var b=this.getCenter(),z=this.getZoom();jo(this._proxy,this.project(b,z),this.getZoomScale(z,1))},_catchTransitionEnd:function(b){this._animatingZoom&&b.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(b,z,$){if(this._animatingZoom)return!0;if($=$||{},!this._zoomAnimated||$.animate===!1||this._nothingToAnimate()||Math.abs(z-this._zoom)>this.options.zoomAnimationThreshold)return!1;var ne=this.getZoomScale(z),ve=this._getCenterOffset(b)._divideBy(1-1/ne);return $.animate!==!0&&!this.getSize().contains(ve)?!1:(Ve(function(){this._moveStart(!0,$.noMoveStart||!1)._animateZoom(b,z,!0)},this),!0)},_animateZoom:function(b,z,$,ne){this._mapPane&&($&&(this._animatingZoom=!0,this._animateToCenter=b,this._animateToZoom=z,cr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:b,zoom:z,noUpdate:ne}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(T(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Kr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function oo(b,z){return new qn(b,z)}var Ui=ot.extend({options:{position:"topright"},initialize:function(b){te(this,b)},getPosition:function(){return this.options.position},setPosition:function(b){var z=this._map;return z&&z.removeControl(this),this.options.position=b,z&&z.addControl(this),this},getContainer:function(){return this._container},addTo:function(b){this.remove(),this._map=b;var z=this._container=this.onAdd(b),$=this.getPosition(),ne=b._controlCorners[$];return cr(z,"leaflet-control"),$.indexOf("bottom")!==-1?ne.insertBefore(z,ne.firstChild):ne.appendChild(z),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(or(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(b){this._map&&b&&b.screenX>0&&b.screenY>0&&this._map.getContainer().focus()}}),_o=function(b){return new Ui(b)};qn.include({addControl:function(b){return b.addTo(this),this},removeControl:function(b){return b.remove(),this},_initControlPos:function(){var b=this._controlCorners={},z="leaflet-",$=this._controlContainer=Xi("div",z+"control-container",this._container);function ne(ve,Be){var _t=z+ve+" "+z+Be;b[ve+Be]=Xi("div",_t,$)}ne("top","left"),ne("top","right"),ne("bottom","left"),ne("bottom","right")},_clearControlPos:function(){for(var b in this._controlCorners)or(this._controlCorners[b]);or(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Fo=Ui.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(b,z,$,ne){return $<ne?-1:ne<$?1:0}},initialize:function(b,z,$){te(this,$),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var ne in b)this._addLayer(b[ne],ne);for(ne in z)this._addLayer(z[ne],ne,!0)},onAdd:function(b){this._initLayout(),this._update(),this._map=b,b.on("zoomend",this._checkDisabledLayers,this);for(var z=0;z<this._layers.length;z++)this._layers[z].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(b){return Ui.prototype.addTo.call(this,b),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(b,z){return this._addLayer(b,z),this._map?this._update():this},addOverlay:function(b,z){return this._addLayer(b,z,!0),this._map?this._update():this},removeLayer:function(b){b.off("add remove",this._onLayerChange,this);var z=this._getLayer(C(b));return z&&this._layers.splice(this._layers.indexOf(z),1),this._map?this._update():this},expand:function(){cr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var b=this._map.getSize().y-(this._container.offsetTop+50);return b<this._section.clientHeight?(cr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=b+"px"):Kr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Kr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var b="leaflet-control-layers",z=this._container=Xi("div",b),$=this.options.collapsed;z.setAttribute("aria-haspopup",!0),Ma(z),Qa(z);var ne=this._section=Xi("section",b+"-list");$&&(this._map.on("click",this.collapse,this),Ni(z,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var ve=this._layersLink=Xi("a",b+"-toggle",z);ve.href="#",ve.title="Layers",ve.setAttribute("role","button"),Ni(ve,{keydown:function(Be){Be.keyCode===13&&this._expandSafely()},click:function(Be){No(Be),this._expandSafely()}},this),$||this.expand(),this._baseLayersList=Xi("div",b+"-base",ne),this._separator=Xi("div",b+"-separator",ne),this._overlaysList=Xi("div",b+"-overlays",ne),z.appendChild(ne)},_getLayer:function(b){for(var z=0;z<this._layers.length;z++)if(this._layers[z]&&C(this._layers[z].layer)===b)return this._layers[z]},_addLayer:function(b,z,$){this._map&&b.on("add remove",this._onLayerChange,this),this._layers.push({layer:b,name:z,overlay:$}),this.options.sortLayers&&this._layers.sort(T(function(ne,ve){return this.options.sortFunction(ne.layer,ve.layer,ne.name,ve.name)},this)),this.options.autoZIndex&&b.setZIndex&&(this._lastZIndex++,b.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Lo(this._baseLayersList),Lo(this._overlaysList),this._layerControlInputs=[];var b,z,$,ne,ve=0;for($=0;$<this._layers.length;$++)ne=this._layers[$],this._addItem(ne),z=z||ne.overlay,b=b||!ne.overlay,ve+=ne.overlay?0:1;return this.options.hideSingleBase&&(b=b&&ve>1,this._baseLayersList.style.display=b?"":"none"),this._separator.style.display=z&&b?"":"none",this},_onLayerChange:function(b){this._handlingClick||this._update();var z=this._getLayer(C(b.target)),$=z.overlay?b.type==="add"?"overlayadd":"overlayremove":b.type==="add"?"baselayerchange":null;$&&this._map.fire($,z)},_createRadioElement:function(b,z){var $='<input type="radio" class="leaflet-control-layers-selector" name="'+b+'"'+(z?' checked="checked"':"")+"/>",ne=document.createElement("div");return ne.innerHTML=$,ne.firstChild},_addItem:function(b){var z=document.createElement("label"),$=this._map.hasLayer(b.layer),ne;b.overlay?(ne=document.createElement("input"),ne.type="checkbox",ne.className="leaflet-control-layers-selector",ne.defaultChecked=$):ne=this._createRadioElement("leaflet-base-layers_"+C(this),$),this._layerControlInputs.push(ne),ne.layerId=C(b.layer),Ni(ne,"click",this._onInputClick,this);var ve=document.createElement("span");ve.innerHTML=" "+b.name;var Be=document.createElement("span");z.appendChild(Be),Be.appendChild(ne),Be.appendChild(ve);var _t=b.overlay?this._overlaysList:this._baseLayersList;return _t.appendChild(z),this._checkDisabledLayers(),z},_onInputClick:function(){if(!this._preventClick){var b=this._layerControlInputs,z,$,ne=[],ve=[];this._handlingClick=!0;for(var Be=b.length-1;Be>=0;Be--)z=b[Be],$=this._getLayer(z.layerId).layer,z.checked?ne.push($):z.checked||ve.push($);for(Be=0;Be<ve.length;Be++)this._map.hasLayer(ve[Be])&&this._map.removeLayer(ve[Be]);for(Be=0;Be<ne.length;Be++)this._map.hasLayer(ne[Be])||this._map.addLayer(ne[Be]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var b=this._layerControlInputs,z,$,ne=this._map.getZoom(),ve=b.length-1;ve>=0;ve--)z=b[ve],$=this._getLayer(z.layerId).layer,z.disabled=$.options.minZoom!==void 0&&ne<$.options.minZoom||$.options.maxZoom!==void 0&&ne>$.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var b=this._section;this._preventClick=!0,Ni(b,"click",No),this.expand();var z=this;setTimeout(function(){ri(b,"click",No),z._preventClick=!1})}}),yo=function(b,z,$){return new Fo(b,z,$)},Mo=Ui.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(b){var z="leaflet-control-zoom",$=Xi("div",z+" leaflet-bar"),ne=this.options;return this._zoomInButton=this._createButton(ne.zoomInText,ne.zoomInTitle,z+"-in",$,this._zoomIn),this._zoomOutButton=this._createButton(ne.zoomOutText,ne.zoomOutTitle,z+"-out",$,this._zoomOut),this._updateDisabled(),b.on("zoomend zoomlevelschange",this._updateDisabled,this),$},onRemove:function(b){b.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(b){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(b.shiftKey?3:1))},_zoomOut:function(b){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(b.shiftKey?3:1))},_createButton:function(b,z,$,ne,ve){var Be=Xi("a",$,ne);return Be.innerHTML=b,Be.href="#",Be.title=z,Be.setAttribute("role","button"),Be.setAttribute("aria-label",z),Ma(Be),Ni(Be,"click",Oa),Ni(Be,"click",ve,this),Ni(Be,"click",this._refocusOnMap,this),Be},_updateDisabled:function(){var b=this._map,z="leaflet-disabled";Kr(this._zoomInButton,z),Kr(this._zoomOutButton,z),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||b._zoom===b.getMinZoom())&&(cr(this._zoomOutButton,z),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||b._zoom===b.getMaxZoom())&&(cr(this._zoomInButton,z),this._zoomInButton.setAttribute("aria-disabled","true"))}});qn.mergeOptions({zoomControl:!0}),qn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Mo,this.addControl(this.zoomControl))});var xa=function(b){return new Mo(b)},qa=Ui.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(b){var z="leaflet-control-scale",$=Xi("div",z),ne=this.options;return this._addScales(ne,z+"-line",$),b.on(ne.updateWhenIdle?"moveend":"move",this._update,this),b.whenReady(this._update,this),$},onRemove:function(b){b.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(b,z,$){b.metric&&(this._mScale=Xi("div",z,$)),b.imperial&&(this._iScale=Xi("div",z,$))},_update:function(){var b=this._map,z=b.getSize().y/2,$=b.distance(b.containerPointToLatLng([0,z]),b.containerPointToLatLng([this.options.maxWidth,z]));this._updateScales($)},_updateScales:function(b){this.options.metric&&b&&this._updateMetric(b),this.options.imperial&&b&&this._updateImperial(b)},_updateMetric:function(b){var z=this._getRoundNum(b),$=z<1e3?z+" m":z/1e3+" km";this._updateScale(this._mScale,$,z/b)},_updateImperial:function(b){var z=b*3.2808399,$,ne,ve;z>5280?($=z/5280,ne=this._getRoundNum($),this._updateScale(this._iScale,ne+" mi",ne/$)):(ve=this._getRoundNum(z),this._updateScale(this._iScale,ve+" ft",ve/z))},_updateScale:function(b,z,$){b.style.width=Math.round(this.options.maxWidth*$)+"px",b.innerHTML=z},_getRoundNum:function(b){var z=Math.pow(10,(Math.floor(b)+"").length-1),$=b/z;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:1,z*$}}),Di=function(b){return new qa(b)},sa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ls=Ui.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(be.inlineSvg?sa+" ":"")+"Leaflet</a>"},initialize:function(b){te(this,b),this._attributions={}},onAdd:function(b){b.attributionControl=this,this._container=Xi("div","leaflet-control-attribution"),Ma(this._container);for(var z in b._layers)b._layers[z].getAttribution&&this.addAttribution(b._layers[z].getAttribution());return this._update(),b.on("layeradd",this._addAttribution,this),this._container},onRemove:function(b){b.off("layeradd",this._addAttribution,this)},_addAttribution:function(b){b.layer.getAttribution&&(this.addAttribution(b.layer.getAttribution()),b.layer.once("remove",function(){this.removeAttribution(b.layer.getAttribution())},this))},setPrefix:function(b){return this.options.prefix=b,this._update(),this},addAttribution:function(b){return b?(this._attributions[b]||(this._attributions[b]=0),this._attributions[b]++,this._update(),this):this},removeAttribution:function(b){return b?(this._attributions[b]&&(this._attributions[b]--,this._update()),this):this},_update:function(){if(this._map){var b=[];for(var z in this._attributions)this._attributions[z]&&b.push(z);var $=[];this.options.prefix&&$.push(this.options.prefix),b.length&&$.push(b.join(", ")),this._container.innerHTML=$.join(' <span aria-hidden="true">|</span> ')}}});qn.mergeOptions({attributionControl:!0}),qn.addInitHook(function(){this.options.attributionControl&&new Ls().addTo(this)});var Rl=function(b){return new Ls(b)};Ui.Layers=Fo,Ui.Zoom=Mo,Ui.Scale=qa,Ui.Attribution=Ls,_o.layers=yo,_o.zoom=xa,_o.scale=Di,_o.attribution=Rl;var Xn=ot.extend({initialize:function(b){this._map=b},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Xn.addTo=function(b,z){return b.addHandler(z,this),this};var Ll={Events:rt},kc=be.touch?"touchstart mousedown":"mousedown",es=Bt.extend({options:{clickTolerance:3},initialize:function(b,z,$,ne){te(this,ne),this._element=b,this._dragStartTarget=z||b,this._preventOutline=$},enable:function(){this._enabled||(Ni(this._dragStartTarget,kc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(es._dragging===this&&this.finishDrag(!0),ri(this._dragStartTarget,kc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(b){if(this._enabled&&(this._moved=!1,!sl(this._element,"leaflet-zoom-anim"))){if(b.touches&&b.touches.length!==1){es._dragging===this&&this.finishDrag();return}if(!(es._dragging||b.shiftKey||b.which!==1&&b.button!==1&&!b.touches)&&(es._dragging=this,this._preventOutline&&en(this._element),cs(),da(),!this._moving)){this.fire("down");var z=b.touches?b.touches[0]:b,$=Zi(this._element);this._startPoint=new Vt(z.clientX,z.clientY),this._startPos=ha(this._element),this._parentScale=yr($);var ne=b.type==="mousedown";Ni(document,ne?"mousemove":"touchmove",this._onMove,this),Ni(document,ne?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(b){if(this._enabled){if(b.touches&&b.touches.length>1){this._moved=!0;return}var z=b.touches&&b.touches.length===1?b.touches[0]:b,$=new Vt(z.clientX,z.clientY)._subtract(this._startPoint);!$.x&&!$.y||Math.abs($.x)+Math.abs($.y)<this.options.clickTolerance||($.x/=this._parentScale.x,$.y/=this._parentScale.y,No(b),this._moved||(this.fire("dragstart"),this._moved=!0,cr(document.body,"leaflet-dragging"),this._lastTarget=b.target||b.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),cr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add($),this._moving=!0,this._lastEvent=b,this._updatePosition())}},_updatePosition:function(){var b={originalEvent:this._lastEvent};this.fire("predrag",b),uo(this._element,this._newPos),this.fire("drag",b)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(b){Kr(document.body,"leaflet-dragging"),this._lastTarget&&(Kr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ri(document,"mousemove touchmove",this._onMove,this),ri(document,"mouseup touchend touchcancel",this._onUp,this),us(),wl();var z=this._moved&&this._moving;this._moving=!1,es._dragging=!1,z&&this.fire("dragend",{noInertia:b,distance:this._newPos.distanceTo(this._startPos)})}});function ts(b,z,$){var ne,ve=[1,4,2,8],Be,_t,Wt,ln,Un,yi,Ti,Ai;for(Be=0,yi=b.length;Be<yi;Be++)b[Be]._code=Eo(b[Be],z);for(Wt=0;Wt<4;Wt++){for(Ti=ve[Wt],ne=[],Be=0,yi=b.length,_t=yi-1;Be<yi;_t=Be++)ln=b[Be],Un=b[_t],ln._code&Ti?Un._code&Ti||(Ai=ns(Un,ln,Ti,z,$),Ai._code=Eo(Ai,z),ne.push(Ai)):(Un._code&Ti&&(Ai=ns(Un,ln,Ti,z,$),Ai._code=Eo(Ai,z),ne.push(Ai)),ne.push(ln));b=ne}return b}function Oh(b,z){var $,ne,ve,Be,_t,Wt,ln,Un,yi;if(!b||b.length===0)throw new Error("latlngs not passed");fa(b)||(console.warn("latlngs are not flat! Only the first ring will be used"),b=b[0]);var Ti=kt([0,0]),Ai=An(b),br=Ai.getNorthWest().distanceTo(Ai.getSouthWest())*Ai.getNorthEast().distanceTo(Ai.getNorthWest());br<1700&&(Ti=cu(b));var Wo=b.length,ba=[];for($=0;$<Wo;$++){var Da=kt(b[$]);ba.push(z.project(kt([Da.lat-Ti.lat,Da.lng-Ti.lng])))}for(Wt=ln=Un=0,$=0,ne=Wo-1;$<Wo;ne=$++)ve=ba[$],Be=ba[ne],_t=ve.y*Be.x-Be.y*ve.x,ln+=(ve.x+Be.x)*_t,Un+=(ve.y+Be.y)*_t,Wt+=_t*3;Wt===0?yi=ba[0]:yi=[ln/Wt,Un/Wt];var Ws=z.unproject($e(yi));return kt([Ws.lat+Ti.lat,Ws.lng+Ti.lng])}function cu(b){for(var z=0,$=0,ne=0,ve=0;ve<b.length;ve++){var Be=kt(b[ve]);z+=Be.lat,$+=Be.lng,ne++}return kt([z/ne,$/ne])}var Jn={__proto__:null,clipPolygon:ts,polygonCenter:Oh,centroid:cu};function Er(b,z){if(!z||!b.length)return b.slice();var $=z*z;return b=_f(b,$),b=Nc(b,$),b}function dr(b,z,$){return Math.sqrt(zl(b,z,$,!0))}function cl(b,z,$){return zl(b,z,$)}function Nc(b,z){var $=b.length,ne=typeof Uint8Array<"u"?Uint8Array:Array,ve=new ne($);ve[0]=ve[$-1]=1,vr(b,ve,z,0,$-1);var Be,_t=[];for(Be=0;Be<$;Be++)ve[Be]&&_t.push(b[Be]);return _t}function vr(b,z,$,ne,ve){var Be=0,_t,Wt,ln;for(Wt=ne+1;Wt<=ve-1;Wt++)ln=zl(b[Wt],b[ne],b[ve],!0),ln>Be&&(_t=Wt,Be=ln);Be>$&&(z[_t]=1,vr(b,z,$,ne,_t),vr(b,z,$,_t,ve))}function _f(b,z){for(var $=[b[0]],ne=1,ve=0,Be=b.length;ne<Be;ne++)Fg(b[ne],b[ve])>z&&($.push(b[ne]),ve=ne);return ve<Be-1&&$.push(b[Be-1]),$}var Ih;function Dh(b,z,$,ne,ve){var Be=ne?Ih:Eo(b,$),_t=Eo(z,$),Wt,ln,Un;for(Ih=_t;;){if(!(Be|_t))return[b,z];if(Be&_t)return!1;Wt=Be||_t,ln=ns(b,z,Wt,$,ve),Un=Eo(ln,$),Wt===Be?(b=ln,Be=Un):(z=ln,_t=Un)}}function ns(b,z,$,ne,ve){var Be=z.x-b.x,_t=z.y-b.y,Wt=ne.min,ln=ne.max,Un,yi;return $&8?(Un=b.x+Be*(ln.y-b.y)/_t,yi=ln.y):$&4?(Un=b.x+Be*(Wt.y-b.y)/_t,yi=Wt.y):$&2?(Un=ln.x,yi=b.y+_t*(ln.x-b.x)/Be):$&1&&(Un=Wt.x,yi=b.y+_t*(Wt.x-b.x)/Be),new Vt(Un,yi,ve)}function Eo(b,z){var $=0;return b.x<z.min.x?$|=1:b.x>z.max.x&&($|=2),b.y<z.min.y?$|=4:b.y>z.max.y&&($|=8),$}function Fg(b,z){var $=z.x-b.x,ne=z.y-b.y;return $*$+ne*ne}function zl(b,z,$,ne){var ve=z.x,Be=z.y,_t=$.x-ve,Wt=$.y-Be,ln=_t*_t+Wt*Wt,Un;return ln>0&&(Un=((b.x-ve)*_t+(b.y-Be)*Wt)/ln,Un>1?(ve=$.x,Be=$.y):Un>0&&(ve+=_t*Un,Be+=Wt*Un)),_t=b.x-ve,Wt=b.y-Be,ne?_t*_t+Wt*Wt:new Vt(ve,Be)}function fa(b){return!ue(b[0])||typeof b[0][0]!="object"&&typeof b[0][0]<"u"}function Rh(b){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),fa(b)}function Lh(b,z){var $,ne,ve,Be,_t,Wt,ln,Un;if(!b||b.length===0)throw new Error("latlngs not passed");fa(b)||(console.warn("latlngs are not flat! Only the first ring will be used"),b=b[0]);var yi=kt([0,0]),Ti=An(b),Ai=Ti.getNorthWest().distanceTo(Ti.getSouthWest())*Ti.getNorthEast().distanceTo(Ti.getNorthWest());Ai<1700&&(yi=cu(b));var br=b.length,Wo=[];for($=0;$<br;$++){var ba=kt(b[$]);Wo.push(z.project(kt([ba.lat-yi.lat,ba.lng-yi.lng])))}for($=0,ne=0;$<br-1;$++)ne+=Wo[$].distanceTo(Wo[$+1])/2;if(ne===0)Un=Wo[0];else for($=0,Be=0;$<br-1;$++)if(_t=Wo[$],Wt=Wo[$+1],ve=_t.distanceTo(Wt),Be+=ve,Be>ne){ln=(Be-ne)/ve,Un=[Wt.x-ln*(Wt.x-_t.x),Wt.y-ln*(Wt.y-_t.y)];break}var Da=z.unproject($e(Un));return kt([Da.lat+yi.lat,Da.lng+yi.lng])}var zh={__proto__:null,simplify:Er,pointToSegmentDistance:dr,closestPointOnSegment:cl,clipSegment:Dh,_getEdgeIntersection:ns,_getBitCode:Eo,_sqClosestPointOnSegment:zl,isFlat:fa,_flat:Rh,polylineCenter:Lh},Yu={project:function(b){return new Vt(b.lng,b.lat)},unproject:function(b){return new ct(b.y,b.x)},bounds:new Pt([-180,-90],[180,90])},is={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Pt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(b){var z=Math.PI/180,$=this.R,ne=b.lat*z,ve=this.R_MINOR/$,Be=Math.sqrt(1-ve*ve),_t=Be*Math.sin(ne),Wt=Math.tan(Math.PI/4-ne/2)/Math.pow((1-_t)/(1+_t),Be/2);return ne=-$*Math.log(Math.max(Wt,1e-10)),new Vt(b.lng*z*$,ne)},unproject:function(b){for(var z=180/Math.PI,$=this.R,ne=this.R_MINOR/$,ve=Math.sqrt(1-ne*ne),Be=Math.exp(-b.y/$),_t=Math.PI/2-2*Math.atan(Be),Wt=0,ln=.1,Un;Wt<15&&Math.abs(ln)>1e-7;Wt++)Un=ve*Math.sin(_t),Un=Math.pow((1-Un)/(1+Un),ve/2),ln=Math.PI/2-2*Math.atan(Be*Un)-_t,_t+=ln;return new ct(_t*z,b.x*z/$)}},rc={__proto__:null,LonLat:Yu,Mercator:is,SphericalMercator:jn},Ha=f({},ti,{code:"EPSG:3395",projection:is,transformation:function(){var b=.5/(Math.PI*is.R);return mn(b,.5,-b,.5)}()}),uu=f({},ti,{code:"EPSG:4326",projection:Yu,transformation:mn(1/180,1,-1/180,.5)}),Ri=f({},In,{projection:Yu,transformation:mn(1,0,-1,0),scale:function(b){return Math.pow(2,b)},zoom:function(b){return Math.log(b)/Math.LN2},distance:function(b,z){var $=z.lng-b.lng,ne=z.lat-b.lat;return Math.sqrt($*$+ne*ne)},infinite:!0});In.Earth=ti,In.EPSG3395=Ha,In.EPSG3857=ci,In.EPSG900913=Ii,In.EPSG4326=uu,In.Simple=Ri;var Tn=Bt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(b){return b.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(b){return b&&b.removeLayer(this),this},getPane:function(b){return this._map.getPane(b?this.options[b]||b:this.options.pane)},addInteractiveTarget:function(b){return this._map._targets[C(b)]=this,this},removeInteractiveTarget:function(b){return delete this._map._targets[C(b)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(b){var z=b.target;if(z.hasLayer(this)){if(this._map=z,this._zoomAnimated=z._zoomAnimated,this.getEvents){var $=this.getEvents();z.on($,this),this.once("remove",function(){z.off($,this)},this)}this.onAdd(z),this.fire("add"),z.fire("layeradd",{layer:this})}}});qn.include({addLayer:function(b){if(!b._layerAdd)throw new Error("The provided object is not a Layer.");var z=C(b);return this._layers[z]?this:(this._layers[z]=b,b._mapToAdd=this,b.beforeAdd&&b.beforeAdd(this),this.whenReady(b._layerAdd,b),this)},removeLayer:function(b){var z=C(b);return this._layers[z]?(this._loaded&&b.onRemove(this),delete this._layers[z],this._loaded&&(this.fire("layerremove",{layer:b}),b.fire("remove")),b._map=b._mapToAdd=null,this):this},hasLayer:function(b){return C(b)in this._layers},eachLayer:function(b,z){for(var $ in this._layers)b.call(z,this._layers[$]);return this},_addLayers:function(b){b=b?ue(b)?b:[b]:[];for(var z=0,$=b.length;z<$;z++)this.addLayer(b[z])},_addZoomLimit:function(b){(!isNaN(b.options.maxZoom)||!isNaN(b.options.minZoom))&&(this._zoomBoundLayers[C(b)]=b,this._updateZoomLevels())},_removeZoomLimit:function(b){var z=C(b);this._zoomBoundLayers[z]&&(delete this._zoomBoundLayers[z],this._updateZoomLevels())},_updateZoomLevels:function(){var b=1/0,z=-1/0,$=this._getZoomSpan();for(var ne in this._zoomBoundLayers){var ve=this._zoomBoundLayers[ne].options;b=ve.minZoom===void 0?b:Math.min(b,ve.minZoom),z=ve.maxZoom===void 0?z:Math.max(z,ve.maxZoom)}this._layersMaxZoom=z===-1/0?void 0:z,this._layersMinZoom=b===1/0?void 0:b,$!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ds=Tn.extend({initialize:function(b,z){te(this,z),this._layers={};var $,ne;if(b)for($=0,ne=b.length;$<ne;$++)this.addLayer(b[$])},addLayer:function(b){var z=this.getLayerId(b);return this._layers[z]=b,this._map&&this._map.addLayer(b),this},removeLayer:function(b){var z=b in this._layers?b:this.getLayerId(b);return this._map&&this._layers[z]&&this._map.removeLayer(this._layers[z]),delete this._layers[z],this},hasLayer:function(b){var z=typeof b=="number"?b:this.getLayerId(b);return z in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(b){var z=Array.prototype.slice.call(arguments,1),$,ne;for($ in this._layers)ne=this._layers[$],ne[b]&&ne[b].apply(ne,z);return this},onAdd:function(b){this.eachLayer(b.addLayer,b)},onRemove:function(b){this.eachLayer(b.removeLayer,b)},eachLayer:function(b,z){for(var $ in this._layers)b.call(z,this._layers[$]);return this},getLayer:function(b){return this._layers[b]},getLayers:function(){var b=[];return this.eachLayer(b.push,b),b},setZIndex:function(b){return this.invoke("setZIndex",b)},getLayerId:function(b){return C(b)}}),di=function(b,z){return new ds(b,z)},Vr=ds.extend({addLayer:function(b){return this.hasLayer(b)?this:(b.addEventParent(this),ds.prototype.addLayer.call(this,b),this.fire("layeradd",{layer:b}))},removeLayer:function(b){return this.hasLayer(b)?(b in this._layers&&(b=this._layers[b]),b.removeEventParent(this),ds.prototype.removeLayer.call(this,b),this.fire("layerremove",{layer:b})):this},setStyle:function(b){return this.invoke("setStyle",b)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var b=new on;for(var z in this._layers){var $=this._layers[z];b.extend($.getBounds?$.getBounds():$.getLatLng())}return b}}),Bc=function(b,z){return new Vr(b,z)},li=ot.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(b){te(this,b)},createIcon:function(b){return this._createIcon("icon",b)},createShadow:function(b){return this._createIcon("shadow",b)},_createIcon:function(b,z){var $=this._getIconUrl(b);if(!$){if(b==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var ne=this._createImg($,z&&z.tagName==="IMG"?z:null);return this._setIconStyles(ne,b),(this.options.crossOrigin||this.options.crossOrigin==="")&&(ne.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),ne},_setIconStyles:function(b,z){var $=this.options,ne=$[z+"Size"];typeof ne=="number"&&(ne=[ne,ne]);var ve=$e(ne),Be=$e(z==="shadow"&&$.shadowAnchor||$.iconAnchor||ve&&ve.divideBy(2,!0));b.className="leaflet-marker-"+z+" "+($.className||""),Be&&(b.style.marginLeft=-Be.x+"px",b.style.marginTop=-Be.y+"px"),ve&&(b.style.width=ve.x+"px",b.style.height=ve.y+"px")},_createImg:function(b,z){return z=z||document.createElement("img"),z.src=b,z},_getIconUrl:function(b){return be.retina&&this.options[b+"RetinaUrl"]||this.options[b+"Url"]}});function jc(b){return new li(b)}var Zl=li.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(b){return typeof Zl.imagePath!="string"&&(Zl.imagePath=this._detectIconPath()),(this.options.imagePath||Zl.imagePath)+li.prototype._getIconUrl.call(this,b)},_stripUrl:function(b){var z=function($,ne,ve){var Be=ne.exec($);return Be&&Be[ve]};return b=z(b,/^url\((['"])?(.+)\1\)$/,2),b&&z(b,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var b=Xi("div","leaflet-default-icon-path",document.body),z=hr(b,"background-image")||hr(b,"backgroundImage");if(document.body.removeChild(b),z=this._stripUrl(z),z)return z;var $=document.querySelector('link[href$="leaflet.css"]');return $?$.href.substring(0,$.href.length-11-1):""}}),oc=Xn.extend({initialize:function(b){this._marker=b},addHooks:function(){var b=this._marker._icon;this._draggable||(this._draggable=new es(b,b,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),cr(b,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Kr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(b){var z=this._marker,$=z._map,ne=this._marker.options.autoPanSpeed,ve=this._marker.options.autoPanPadding,Be=ha(z._icon),_t=$.getPixelBounds(),Wt=$.getPixelOrigin(),ln=$t(_t.min._subtract(Wt).add(ve),_t.max._subtract(Wt).subtract(ve));if(!ln.contains(Be)){var Un=$e((Math.max(ln.max.x,Be.x)-ln.max.x)/(_t.max.x-ln.max.x)-(Math.min(ln.min.x,Be.x)-ln.min.x)/(_t.min.x-ln.min.x),(Math.max(ln.max.y,Be.y)-ln.max.y)/(_t.max.y-ln.max.y)-(Math.min(ln.min.y,Be.y)-ln.min.y)/(_t.min.y-ln.min.y)).multiplyBy(ne);$.panBy(Un,{animate:!1}),this._draggable._newPos._add(Un),this._draggable._startPos._add(Un),uo(z._icon,this._draggable._newPos),this._onDrag(b),this._panRequest=Ve(this._adjustPan.bind(this,b))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(b){this._marker.options.autoPan&&(xt(this._panRequest),this._panRequest=Ve(this._adjustPan.bind(this,b)))},_onDrag:function(b){var z=this._marker,$=z._shadow,ne=ha(z._icon),ve=z._map.layerPointToLatLng(ne);$&&uo($,ne),z._latlng=ve,b.latlng=ve,b.oldLatLng=this._oldLatLng,z.fire("move",b).fire("drag",b)},_onDragEnd:function(b){xt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",b)}}),Ku=Tn.extend({options:{icon:new Zl,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(b,z){te(this,z),this._latlng=kt(b)},onAdd:function(b){this._zoomAnimated=this._zoomAnimated&&b.options.markerZoomAnimation,this._zoomAnimated&&b.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(b){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&b.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(b){var z=this._latlng;return this._latlng=kt(b),this.update(),this.fire("move",{oldLatLng:z,latlng:this._latlng})},setZIndexOffset:function(b){return this.options.zIndexOffset=b,this.update()},getIcon:function(){return this.options.icon},setIcon:function(b){return this.options.icon=b,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var b=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(b)}return this},_initIcon:function(){var b=this.options,z="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),$=b.icon.createIcon(this._icon),ne=!1;$!==this._icon&&(this._icon&&this._removeIcon(),ne=!0,b.title&&($.title=b.title),$.tagName==="IMG"&&($.alt=b.alt||"")),cr($,z),b.keyboard&&($.tabIndex="0",$.setAttribute("role","button")),this._icon=$,b.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ni($,"focus",this._panOnFocus,this);var ve=b.icon.createShadow(this._shadow),Be=!1;ve!==this._shadow&&(this._removeShadow(),Be=!0),ve&&(cr(ve,z),ve.alt=""),this._shadow=ve,b.opacity<1&&this._updateOpacity(),ne&&this.getPane().appendChild(this._icon),this._initInteraction(),ve&&Be&&this.getPane(b.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ri(this._icon,"focus",this._panOnFocus,this),or(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&or(this._shadow),this._shadow=null},_setPos:function(b){this._icon&&uo(this._icon,b),this._shadow&&uo(this._shadow,b),this._zIndex=b.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(b){this._icon&&(this._icon.style.zIndex=this._zIndex+b)},_animateZoom:function(b){var z=this._map._latLngToNewLayerPoint(this._latlng,b.zoom,b.center).round();this._setPos(z)},_initInteraction:function(){if(this.options.interactive&&(cr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),oc)){var b=this.options.draggable;this.dragging&&(b=this.dragging.enabled(),this.dragging.disable()),this.dragging=new oc(this),b&&this.dragging.enable()}},setOpacity:function(b){return this.options.opacity=b,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var b=this.options.opacity;this._icon&&Bo(this._icon,b),this._shadow&&Bo(this._shadow,b)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var b=this._map;if(b){var z=this.options.icon.options,$=z.iconSize?$e(z.iconSize):$e(0,0),ne=z.iconAnchor?$e(z.iconAnchor):$e(0,0);b.panInside(this._latlng,{paddingTopLeft:ne,paddingBottomRight:$.subtract(ne)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ul(b,z){return new Ku(b,z)}var la=Tn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(b){this._renderer=b.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(b){return te(this,b),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&b&&Object.prototype.hasOwnProperty.call(b,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Fc=la.extend({options:{fill:!0,radius:10},initialize:function(b,z){te(this,z),this._latlng=kt(b),this._radius=this.options.radius},setLatLng:function(b){var z=this._latlng;return this._latlng=kt(b),this.redraw(),this.fire("move",{oldLatLng:z,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(b){return this.options.radius=this._radius=b,this.redraw()},getRadius:function(){return this._radius},setStyle:function(b){var z=b&&b.radius||this._radius;return la.prototype.setStyle.call(this,b),this.setRadius(z),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var b=this._radius,z=this._radiusY||b,$=this._clickTolerance(),ne=[b+$,z+$];this._pxBounds=new Pt(this._point.subtract(ne),this._point.add(ne))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(b){return b.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ia(b,z){return new Fc(b,z)}var Ad=Fc.extend({initialize:function(b,z,$){if(typeof z=="number"&&(z=f({},$,{radius:z})),te(this,z),this._latlng=kt(b),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(b){return this._mRadius=b,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var b=[this._radius,this._radiusY||this._radius];return new on(this._map.layerPointToLatLng(this._point.subtract(b)),this._map.layerPointToLatLng(this._point.add(b)))},setStyle:la.prototype.setStyle,_project:function(){var b=this._latlng.lng,z=this._latlng.lat,$=this._map,ne=$.options.crs;if(ne.distance===ti.distance){var ve=Math.PI/180,Be=this._mRadius/ti.R/ve,_t=$.project([z+Be,b]),Wt=$.project([z-Be,b]),ln=_t.add(Wt).divideBy(2),Un=$.unproject(ln).lat,yi=Math.acos((Math.cos(Be*ve)-Math.sin(z*ve)*Math.sin(Un*ve))/(Math.cos(z*ve)*Math.cos(Un*ve)))/ve;(isNaN(yi)||yi===0)&&(yi=Be/Math.cos(Math.PI/180*z)),this._point=ln.subtract($.getPixelOrigin()),this._radius=isNaN(yi)?0:ln.x-$.project([Un,b-yi]).x,this._radiusY=ln.y-_t.y}else{var Ti=ne.unproject(ne.project(this._latlng).subtract([this._mRadius,0]));this._point=$.latLngToLayerPoint(this._latlng),this._radius=this._point.x-$.latLngToLayerPoint(Ti).x}this._updateBounds()}});function ac(b,z,$){return new Ad(b,z,$)}var ia=la.extend({options:{smoothFactor:1,noClip:!1},initialize:function(b,z){te(this,z),this._setLatLngs(b)},getLatLngs:function(){return this._latlngs},setLatLngs:function(b){return this._setLatLngs(b),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(b){for(var z=1/0,$=null,ne=zl,ve,Be,_t=0,Wt=this._parts.length;_t<Wt;_t++)for(var ln=this._parts[_t],Un=1,yi=ln.length;Un<yi;Un++){ve=ln[Un-1],Be=ln[Un];var Ti=ne(b,ve,Be,!0);Ti<z&&(z=Ti,$=ne(b,ve,Be))}return $&&($.distance=Math.sqrt(z)),$},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Lh(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(b,z){return z=z||this._defaultShape(),b=kt(b),z.push(b),this._bounds.extend(b),this.redraw()},_setLatLngs:function(b){this._bounds=new on,this._latlngs=this._convertLatLngs(b)},_defaultShape:function(){return fa(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(b){for(var z=[],$=fa(b),ne=0,ve=b.length;ne<ve;ne++)$?(z[ne]=kt(b[ne]),this._bounds.extend(z[ne])):z[ne]=this._convertLatLngs(b[ne]);return z},_project:function(){var b=new Pt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,b),this._bounds.isValid()&&b.isValid()&&(this._rawPxBounds=b,this._updateBounds())},_updateBounds:function(){var b=this._clickTolerance(),z=new Vt(b,b);this._rawPxBounds&&(this._pxBounds=new Pt([this._rawPxBounds.min.subtract(z),this._rawPxBounds.max.add(z)]))},_projectLatlngs:function(b,z,$){var ne=b[0]instanceof ct,ve=b.length,Be,_t;if(ne){for(_t=[],Be=0;Be<ve;Be++)_t[Be]=this._map.latLngToLayerPoint(b[Be]),$.extend(_t[Be]);z.push(_t)}else for(Be=0;Be<ve;Be++)this._projectLatlngs(b[Be],z,$)},_clipPoints:function(){var b=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(b))){if(this.options.noClip){this._parts=this._rings;return}var z=this._parts,$,ne,ve,Be,_t,Wt,ln;for($=0,ve=0,Be=this._rings.length;$<Be;$++)for(ln=this._rings[$],ne=0,_t=ln.length;ne<_t-1;ne++)Wt=Dh(ln[ne],ln[ne+1],b,ne,!0),Wt&&(z[ve]=z[ve]||[],z[ve].push(Wt[0]),(Wt[1]!==ln[ne+1]||ne===_t-2)&&(z[ve].push(Wt[1]),ve++))}},_simplifyPoints:function(){for(var b=this._parts,z=this.options.smoothFactor,$=0,ne=b.length;$<ne;$++)b[$]=Er(b[$],z)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(b,z){var $,ne,ve,Be,_t,Wt,ln=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(b))return!1;for($=0,Be=this._parts.length;$<Be;$++)for(Wt=this._parts[$],ne=0,_t=Wt.length,ve=_t-1;ne<_t;ve=ne++)if(!(!z&&ne===0)&&dr(b,Wt[ve],Wt[ne])<=ln)return!0;return!1}});function Pd(b,z){return new ia(b,z)}ia._flat=Rh;var kh=ia.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Oh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(b){var z=ia.prototype._convertLatLngs.call(this,b),$=z.length;return $>=2&&z[0]instanceof ct&&z[0].equals(z[$-1])&&z.pop(),z},_setLatLngs:function(b){ia.prototype._setLatLngs.call(this,b),fa(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fa(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var b=this._renderer._bounds,z=this.options.weight,$=new Vt(z,z);if(b=new Pt(b.min.subtract($),b.max.add($)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(b))){if(this.options.noClip){this._parts=this._rings;return}for(var ne=0,ve=this._rings.length,Be;ne<ve;ne++)Be=ts(this._rings[ne],b,!0),Be.length&&this._parts.push(Be)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(b){var z=!1,$,ne,ve,Be,_t,Wt,ln,Un;if(!this._pxBounds||!this._pxBounds.contains(b))return!1;for(Be=0,ln=this._parts.length;Be<ln;Be++)for($=this._parts[Be],_t=0,Un=$.length,Wt=Un-1;_t<Un;Wt=_t++)ne=$[_t],ve=$[Wt],ne.y>b.y!=ve.y>b.y&&b.x<(ve.x-ne.x)*(b.y-ne.y)/(ve.y-ne.y)+ne.x&&(z=!z);return z||ia.prototype._containsPoint.call(this,b,!0)}});function Sl(b,z){return new kh(b,z)}var Ga=Vr.extend({initialize:function(b,z){te(this,z),this._layers={},b&&this.addData(b)},addData:function(b){var z=ue(b)?b:b.features,$,ne,ve;if(z){for($=0,ne=z.length;$<ne;$++)ve=z[$],(ve.geometries||ve.geometry||ve.features||ve.coordinates)&&this.addData(ve);return this}var Be=this.options;if(Be.filter&&!Be.filter(b))return this;var _t=sc(b,Be);return _t?(_t.feature=jh(b),_t.defaultOptions=_t.options,this.resetStyle(_t),Be.onEachFeature&&Be.onEachFeature(b,_t),this.addLayer(_t)):this},resetStyle:function(b){return b===void 0?this.eachLayer(this.resetStyle,this):(b.options=f({},b.defaultOptions),this._setLayerStyle(b,this.options.style),this)},setStyle:function(b){return this.eachLayer(function(z){this._setLayerStyle(z,b)},this)},_setLayerStyle:function(b,z){b.setStyle&&(typeof z=="function"&&(z=z(b.feature)),b.setStyle(z))}});function sc(b,z){var $=b.type==="Feature"?b.geometry:b,ne=$?$.coordinates:null,ve=[],Be=z&&z.pointToLayer,_t=z&&z.coordsToLatLng||Vc,Wt,ln,Un,yi;if(!ne&&!$)return null;switch($.type){case"Point":return Wt=_t(ne),Uc(Be,b,Wt,z);case"MultiPoint":for(Un=0,yi=ne.length;Un<yi;Un++)Wt=_t(ne[Un]),ve.push(Uc(Be,b,Wt,z));return new Vr(ve);case"LineString":case"MultiLineString":return ln=Nh(ne,$.type==="LineString"?0:1,_t),new ia(ln,z);case"Polygon":case"MultiPolygon":return ln=Nh(ne,$.type==="Polygon"?1:2,_t),new kh(ln,z);case"GeometryCollection":for(Un=0,yi=$.geometries.length;Un<yi;Un++){var Ti=sc({geometry:$.geometries[Un],type:"Feature",properties:b.properties},z);Ti&&ve.push(Ti)}return new Vr(ve);case"FeatureCollection":for(Un=0,yi=$.features.length;Un<yi;Un++){var Ai=sc($.features[Un],z);Ai&&ve.push(Ai)}return new Vr(ve);default:throw new Error("Invalid GeoJSON object.")}}function Uc(b,z,$,ne){return b?b(z,$):new Ku($,ne&&ne.markersInheritOptions&&ne)}function Vc(b){return new ct(b[1],b[0],b[2])}function Nh(b,z,$){for(var ne=[],ve=0,Be=b.length,_t;ve<Be;ve++)_t=z?Nh(b[ve],z-1,$):($||Vc)(b[ve]),ne.push(_t);return ne}function hu(b,z){return b=kt(b),b.alt!==void 0?[q(b.lng,z),q(b.lat,z),q(b.alt,z)]:[q(b.lng,z),q(b.lat,z)]}function Bh(b,z,$,ne){for(var ve=[],Be=0,_t=b.length;Be<_t;Be++)ve.push(z?Bh(b[Be],fa(b[Be])?0:z-1,$,ne):hu(b[Be],ne));return!z&&$&&ve.length>0&&ve.push(ve[0].slice()),ve}function rs(b,z){return b.feature?f({},b.feature,{geometry:z}):jh(z)}function jh(b){return b.type==="Feature"||b.type==="FeatureCollection"?b:{type:"Feature",properties:{},geometry:b}}var Ju={toGeoJSON:function(b){return rs(this,{type:"Point",coordinates:hu(this.getLatLng(),b)})}};Ku.include(Ju),Ad.include(Ju),Fc.include(Ju),ia.include({toGeoJSON:function(b){var z=!fa(this._latlngs),$=Bh(this._latlngs,z?1:0,!1,b);return rs(this,{type:(z?"Multi":"")+"LineString",coordinates:$})}}),kh.include({toGeoJSON:function(b){var z=!fa(this._latlngs),$=z&&!fa(this._latlngs[0]),ne=Bh(this._latlngs,$?2:z?1:0,!0,b);return z||(ne=[ne]),rs(this,{type:($?"Multi":"")+"Polygon",coordinates:ne})}}),ds.include({toMultiPoint:function(b){var z=[];return this.eachLayer(function($){z.push($.toGeoJSON(b).geometry.coordinates)}),rs(this,{type:"MultiPoint",coordinates:z})},toGeoJSON:function(b){var z=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(z==="MultiPoint")return this.toMultiPoint(b);var $=z==="GeometryCollection",ne=[];return this.eachLayer(function(ve){if(ve.toGeoJSON){var Be=ve.toGeoJSON(b);if($)ne.push(Be.geometry);else{var _t=jh(Be);_t.type==="FeatureCollection"?ne.push.apply(ne,_t.features):ne.push(_t)}}}),$?rs(this,{geometries:ne,type:"GeometryCollection"}):{type:"FeatureCollection",features:ne}}});function Cd(b,z){return new Ga(b,z)}var gp=Cd,zs=Tn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(b,z,$){this._url=b,this._bounds=An(z),te(this,$)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(cr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){or(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(b){return this.options.opacity=b,this._image&&this._updateOpacity(),this},setStyle:function(b){return b.opacity&&this.setOpacity(b.opacity),this},bringToFront:function(){return this._map&&Hs(this._image),this},bringToBack:function(){return this._map&&Ds(this._image),this},setUrl:function(b){return this._url=b,this._image&&(this._image.src=b),this},setBounds:function(b){return this._bounds=An(b),this._map&&this._reset(),this},getEvents:function(){var b={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(b.zoomanim=this._animateZoom),b},setZIndex:function(b){return this.options.zIndex=b,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var b=this._url.tagName==="IMG",z=this._image=b?this._url:Xi("img");if(cr(z,"leaflet-image-layer"),this._zoomAnimated&&cr(z,"leaflet-zoom-animated"),this.options.className&&cr(z,this.options.className),z.onselectstart=j,z.onmousemove=j,z.onload=T(this.fire,this,"load"),z.onerror=T(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(z.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),b){this._url=z.src;return}z.src=this._url,z.alt=this.options.alt},_animateZoom:function(b){var z=this._map.getZoomScale(b.zoom),$=this._map._latLngBoundsToNewLayerBounds(this._bounds,b.zoom,b.center).min;jo(this._image,$,z)},_reset:function(){var b=this._image,z=new Pt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),$=z.getSize();uo(b,z.min),b.style.width=$.x+"px",b.style.height=$.y+"px"},_updateOpacity:function(){Bo(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var b=this.options.errorOverlayUrl;b&&this._url!==b&&(this._url=b,this._image.src=b)},getCenter:function(){return this._bounds.getCenter()}}),du=function(b,z,$){return new zs(b,z,$)},Md=zs.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var b=this._url.tagName==="VIDEO",z=this._image=b?this._url:Xi("video");if(cr(z,"leaflet-image-layer"),this._zoomAnimated&&cr(z,"leaflet-zoom-animated"),this.options.className&&cr(z,this.options.className),z.onselectstart=j,z.onmousemove=j,z.onloadeddata=T(this.fire,this,"load"),b){for(var $=z.getElementsByTagName("source"),ne=[],ve=0;ve<$.length;ve++)ne.push($[ve].src);this._url=$.length>0?ne:[z.src];return}ue(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(z.style,"objectFit")&&(z.style.objectFit="fill"),z.autoplay=!!this.options.autoplay,z.loop=!!this.options.loop,z.muted=!!this.options.muted,z.playsInline=!!this.options.playsInline;for(var Be=0;Be<this._url.length;Be++){var _t=Xi("source");_t.src=this._url[Be],z.appendChild(_t)}}});function Od(b,z,$){return new Md(b,z,$)}var lc=zs.extend({_initImage:function(){var b=this._image=this._url;cr(b,"leaflet-image-layer"),this._zoomAnimated&&cr(b,"leaflet-zoom-animated"),this.options.className&&cr(b,this.options.className),b.onselectstart=j,b.onmousemove=j}});function yf(b,z,$){return new lc(b,z,$)}var Uo=Tn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(b,z){b&&(b instanceof ct||ue(b))?(this._latlng=kt(b),te(this,z)):(te(this,b),this._source=z),this.options.content&&(this._content=this.options.content)},openOn:function(b){return b=arguments.length?b:this._source._map,b.hasLayer(this)||b.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(b){return this._map?this.close():(arguments.length?this._source=b:b=this._source,this._prepareOpen(),this.openOn(b._map)),this},onAdd:function(b){this._zoomAnimated=b._zoomAnimated,this._container||this._initLayout(),b._fadeAnimated&&Bo(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),b._fadeAnimated&&Bo(this._container,1),this.bringToFront(),this.options.interactive&&(cr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(b){b._fadeAnimated?(Bo(this._container,0),this._removeTimeout=setTimeout(T(or,void 0,this._container),200)):or(this._container),this.options.interactive&&(Kr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(b){return this._latlng=kt(b),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(b){return this._content=b,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var b={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(b.zoomanim=this._animateZoom),b},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Hs(this._container),this},bringToBack:function(){return this._map&&Ds(this._container),this},_prepareOpen:function(b){var z=this._source;if(!z._map)return!1;if(z instanceof Vr){z=null;var $=this._source._layers;for(var ne in $)if($[ne]._map){z=$[ne];break}if(!z)return!1;this._source=z}if(!b)if(z.getCenter)b=z.getCenter();else if(z.getLatLng)b=z.getLatLng();else if(z.getBounds)b=z.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(b),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var b=this._contentNode,z=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof z=="string")b.innerHTML=z;else{for(;b.hasChildNodes();)b.removeChild(b.firstChild);b.appendChild(z)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var b=this._map.latLngToLayerPoint(this._latlng),z=$e(this.options.offset),$=this._getAnchor();this._zoomAnimated?uo(this._container,b.add($)):z=z.add(b).add($);var ne=this._containerBottom=-z.y,ve=this._containerLeft=-Math.round(this._containerWidth/2)+z.x;this._container.style.bottom=ne+"px",this._container.style.left=ve+"px"}},_getAnchor:function(){return[0,0]}});qn.include({_initOverlay:function(b,z,$,ne){var ve=z;return ve instanceof b||(ve=new b(ne).setContent(z)),$&&ve.setLatLng($),ve}}),Tn.include({_initOverlay:function(b,z,$,ne){var ve=$;return ve instanceof b?(te(ve,ne),ve._source=this):(ve=z&&!ne?z:new b(ne,this),ve.setContent($)),ve}});var $c=Uo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(b){return b=arguments.length?b:this._source._map,!b.hasLayer(this)&&b._popup&&b._popup.options.autoClose&&b.removeLayer(b._popup),b._popup=this,Uo.prototype.openOn.call(this,b)},onAdd:function(b){Uo.prototype.onAdd.call(this,b),b.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof la||this._source.on("preclick",ws))},onRemove:function(b){Uo.prototype.onRemove.call(this,b),b.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof la||this._source.off("preclick",ws))},getEvents:function(){var b=Uo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(b.preclick=this.close),this.options.keepInView&&(b.moveend=this._adjustPan),b},_initLayout:function(){var b="leaflet-popup",z=this._container=Xi("div",b+" "+(this.options.className||"")+" leaflet-zoom-animated"),$=this._wrapper=Xi("div",b+"-content-wrapper",z);if(this._contentNode=Xi("div",b+"-content",$),Ma(z),Qa(this._contentNode),Ni(z,"contextmenu",ws),this._tipContainer=Xi("div",b+"-tip-container",z),this._tip=Xi("div",b+"-tip",this._tipContainer),this.options.closeButton){var ne=this._closeButton=Xi("a",b+"-close-button",z);ne.setAttribute("role","button"),ne.setAttribute("aria-label","Close popup"),ne.href="#close",ne.innerHTML='<span aria-hidden="true">&#215;</span>',Ni(ne,"click",function(ve){No(ve),this.close()},this)}},_updateLayout:function(){var b=this._contentNode,z=b.style;z.width="",z.whiteSpace="nowrap";var $=b.offsetWidth;$=Math.min($,this.options.maxWidth),$=Math.max($,this.options.minWidth),z.width=$+1+"px",z.whiteSpace="",z.height="";var ne=b.offsetHeight,ve=this.options.maxHeight,Be="leaflet-popup-scrolled";ve&&ne>ve?(z.height=ve+"px",cr(b,Be)):Kr(b,Be),this._containerWidth=this._container.offsetWidth},_animateZoom:function(b){var z=this._map._latLngToNewLayerPoint(this._latlng,b.zoom,b.center),$=this._getAnchor();uo(this._container,z.add($))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var b=this._map,z=parseInt(hr(this._container,"marginBottom"),10)||0,$=this._container.offsetHeight+z,ne=this._containerWidth,ve=new Vt(this._containerLeft,-$-this._containerBottom);ve._add(ha(this._container));var Be=b.layerPointToContainerPoint(ve),_t=$e(this.options.autoPanPadding),Wt=$e(this.options.autoPanPaddingTopLeft||_t),ln=$e(this.options.autoPanPaddingBottomRight||_t),Un=b.getSize(),yi=0,Ti=0;Be.x+ne+ln.x>Un.x&&(yi=Be.x+ne-Un.x+ln.x),Be.x-yi-Wt.x<0&&(yi=Be.x-Wt.x),Be.y+$+ln.y>Un.y&&(Ti=Be.y+$-Un.y+ln.y),Be.y-Ti-Wt.y<0&&(Ti=Be.y-Wt.y),(yi||Ti)&&(this.options.keepInView&&(this._autopanning=!0),b.fire("autopanstart").panBy([yi,Ti]))}},_getAnchor:function(){return $e(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),_p=function(b,z){return new $c(b,z)};qn.mergeOptions({closePopupOnClick:!0}),qn.include({openPopup:function(b,z,$){return this._initOverlay($c,b,z,$).openOn(this),this},closePopup:function(b){return b=arguments.length?b:this._popup,b&&b.close(),this}}),Tn.include({bindPopup:function(b,z){return this._popup=this._initOverlay($c,this._popup,b,z),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(b){return this._popup&&(this instanceof Vr||(this._popup._source=this),this._popup._prepareOpen(b||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(b){return this._popup&&this._popup.setContent(b),this},getPopup:function(){return this._popup},_openPopup:function(b){if(!(!this._popup||!this._map)){Oa(b);var z=b.layer||b.target;if(this._popup._source===z&&!(z instanceof la)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(b.latlng);return}this._popup._source=z,this.openPopup(b.latlng)}},_movePopup:function(b){this._popup.setLatLng(b.latlng)},_onKeyPress:function(b){b.originalEvent.keyCode===13&&this._openPopup(b)}});var Fh=Uo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(b){Uo.prototype.onAdd.call(this,b),this.setOpacity(this.options.opacity),b.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(b){Uo.prototype.onRemove.call(this,b),b.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var b=Uo.prototype.getEvents.call(this);return this.options.permanent||(b.preclick=this.close),b},_initLayout:function(){var b="leaflet-tooltip",z=b+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Xi("div",z),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+C(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(b){var z,$,ne=this._map,ve=this._container,Be=ne.latLngToContainerPoint(ne.getCenter()),_t=ne.layerPointToContainerPoint(b),Wt=this.options.direction,ln=ve.offsetWidth,Un=ve.offsetHeight,yi=$e(this.options.offset),Ti=this._getAnchor();Wt==="top"?(z=ln/2,$=Un):Wt==="bottom"?(z=ln/2,$=0):Wt==="center"?(z=ln/2,$=Un/2):Wt==="right"?(z=0,$=Un/2):Wt==="left"?(z=ln,$=Un/2):_t.x<Be.x?(Wt="right",z=0,$=Un/2):(Wt="left",z=ln+(yi.x+Ti.x)*2,$=Un/2),b=b.subtract($e(z,$,!0)).add(yi).add(Ti),Kr(ve,"leaflet-tooltip-right"),Kr(ve,"leaflet-tooltip-left"),Kr(ve,"leaflet-tooltip-top"),Kr(ve,"leaflet-tooltip-bottom"),cr(ve,"leaflet-tooltip-"+Wt),uo(ve,b)},_updatePosition:function(){var b=this._map.latLngToLayerPoint(this._latlng);this._setPosition(b)},setOpacity:function(b){this.options.opacity=b,this._container&&Bo(this._container,b)},_animateZoom:function(b){var z=this._map._latLngToNewLayerPoint(this._latlng,b.zoom,b.center);this._setPosition(z)},_getAnchor:function(){return $e(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Uh=function(b,z){return new Fh(b,z)};qn.include({openTooltip:function(b,z,$){return this._initOverlay(Fh,b,z,$).openOn(this),this},closeTooltip:function(b){return b.close(),this}}),Tn.include({bindTooltip:function(b,z){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Fh,this._tooltip,b,z),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(b){if(!(!b&&this._tooltipHandlersAdded)){var z=b?"off":"on",$={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?$.add=this._openTooltip:($.mouseover=this._openTooltip,$.mouseout=this.closeTooltip,$.click=this._openTooltip,this._map?this._addFocusListeners():$.add=this._addFocusListeners),this._tooltip.options.sticky&&($.mousemove=this._moveTooltip),this[z]($),this._tooltipHandlersAdded=!b}},openTooltip:function(b){return this._tooltip&&(this instanceof Vr||(this._tooltip._source=this),this._tooltip._prepareOpen(b)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(b){return this._tooltip&&this._tooltip.setContent(b),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(b){var z=typeof b.getElement=="function"&&b.getElement();z&&(Ni(z,"focus",function(){this._tooltip._source=b,this.openTooltip()},this),Ni(z,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(b){var z=typeof b.getElement=="function"&&b.getElement();z&&z.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(b){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var z=this;this._map.once("moveend",function(){z._openOnceFlag=!1,z._openTooltip(b)});return}this._tooltip._source=b.layer||b.target,this.openTooltip(this._tooltip.options.sticky?b.latlng:void 0)}},_moveTooltip:function(b){var z=b.latlng,$,ne;this._tooltip.options.sticky&&b.originalEvent&&($=this._map.mouseEventToContainerPoint(b.originalEvent),ne=this._map.containerPointToLayerPoint($),z=this._map.layerPointToLatLng(ne)),this._tooltip.setLatLng(z)}});var fu=li.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(b){var z=b&&b.tagName==="DIV"?b:document.createElement("div"),$=this.options;if($.html instanceof Element?(Lo(z),z.appendChild($.html)):z.innerHTML=$.html!==!1?$.html:"",$.bgPos){var ne=$e($.bgPos);z.style.backgroundPosition=-ne.x+"px "+-ne.y+"px"}return this._setIconStyles(z,"icon"),z},createShadow:function(){return null}});function vf(b){return new fu(b)}li.Default=Zl;var cc=Tn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:be.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(b){te(this,b)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(b){b._addZoomLimit(this)},onRemove:function(b){this._removeAllTiles(),or(this._container),b._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Hs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ds(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(b){return this.options.opacity=b,this._updateOpacity(),this},setZIndex:function(b){return this.options.zIndex=b,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var b=this._clampZoom(this._map.getZoom());b!==this._tileZoom&&(this._tileZoom=b,this._updateLevels()),this._update()}return this},getEvents:function(){var b={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=M(this._onMoveEnd,this.options.updateInterval,this)),b.move=this._onMove),this._zoomAnimated&&(b.zoomanim=this._animateZoom),b},createTile:function(){return document.createElement("div")},getTileSize:function(){var b=this.options.tileSize;return b instanceof Vt?b:new Vt(b,b)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(b){for(var z=this.getPane().children,$=-b(-1/0,1/0),ne=0,ve=z.length,Be;ne<ve;ne++)Be=z[ne].style.zIndex,z[ne]!==this._container&&Be&&($=b($,+Be));isFinite($)&&(this.options.zIndex=$+b(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!be.ielt9){Bo(this._container,this.options.opacity);var b=+new Date,z=!1,$=!1;for(var ne in this._tiles){var ve=this._tiles[ne];if(!(!ve.current||!ve.loaded)){var Be=Math.min(1,(b-ve.loaded)/200);Bo(ve.el,Be),Be<1?z=!0:(ve.active?$=!0:this._onOpaqueTile(ve),ve.active=!0)}}$&&!this._noPrune&&this._pruneTiles(),z&&(xt(this._fadeFrame),this._fadeFrame=Ve(this._updateOpacity,this))}},_onOpaqueTile:j,_initContainer:function(){this._container||(this._container=Xi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var b=this._tileZoom,z=this.options.maxZoom;if(b!==void 0){for(var $ in this._levels)$=Number($),this._levels[$].el.children.length||$===b?(this._levels[$].el.style.zIndex=z-Math.abs(b-$),this._onUpdateLevel($)):(or(this._levels[$].el),this._removeTilesAtZoom($),this._onRemoveLevel($),delete this._levels[$]);var ne=this._levels[b],ve=this._map;return ne||(ne=this._levels[b]={},ne.el=Xi("div","leaflet-tile-container leaflet-zoom-animated",this._container),ne.el.style.zIndex=z,ne.origin=ve.project(ve.unproject(ve.getPixelOrigin()),b).round(),ne.zoom=b,this._setZoomTransform(ne,ve.getCenter(),ve.getZoom()),j(ne.el.offsetWidth),this._onCreateLevel(ne)),this._level=ne,ne}},_onUpdateLevel:j,_onRemoveLevel:j,_onCreateLevel:j,_pruneTiles:function(){if(this._map){var b,z,$=this._map.getZoom();if($>this.options.maxZoom||$<this.options.minZoom){this._removeAllTiles();return}for(b in this._tiles)z=this._tiles[b],z.retain=z.current;for(b in this._tiles)if(z=this._tiles[b],z.current&&!z.active){var ne=z.coords;this._retainParent(ne.x,ne.y,ne.z,ne.z-5)||this._retainChildren(ne.x,ne.y,ne.z,ne.z+2)}for(b in this._tiles)this._tiles[b].retain||this._removeTile(b)}},_removeTilesAtZoom:function(b){for(var z in this._tiles)this._tiles[z].coords.z===b&&this._removeTile(z)},_removeAllTiles:function(){for(var b in this._tiles)this._removeTile(b)},_invalidateAll:function(){for(var b in this._levels)or(this._levels[b].el),this._onRemoveLevel(Number(b)),delete this._levels[b];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(b,z,$,ne){var ve=Math.floor(b/2),Be=Math.floor(z/2),_t=$-1,Wt=new Vt(+ve,+Be);Wt.z=+_t;var ln=this._tileCoordsToKey(Wt),Un=this._tiles[ln];return Un&&Un.active?(Un.retain=!0,!0):(Un&&Un.loaded&&(Un.retain=!0),_t>ne?this._retainParent(ve,Be,_t,ne):!1)},_retainChildren:function(b,z,$,ne){for(var ve=2*b;ve<2*b+2;ve++)for(var Be=2*z;Be<2*z+2;Be++){var _t=new Vt(ve,Be);_t.z=$+1;var Wt=this._tileCoordsToKey(_t),ln=this._tiles[Wt];if(ln&&ln.active){ln.retain=!0;continue}else ln&&ln.loaded&&(ln.retain=!0);$+1<ne&&this._retainChildren(ve,Be,$+1,ne)}},_resetView:function(b){var z=b&&(b.pinch||b.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),z,z)},_animateZoom:function(b){this._setView(b.center,b.zoom,!0,b.noUpdate)},_clampZoom:function(b){var z=this.options;return z.minNativeZoom!==void 0&&b<z.minNativeZoom?z.minNativeZoom:z.maxNativeZoom!==void 0&&z.maxNativeZoom<b?z.maxNativeZoom:b},_setView:function(b,z,$,ne){var ve=Math.round(z);this.options.maxZoom!==void 0&&ve>this.options.maxZoom||this.options.minZoom!==void 0&&ve<this.options.minZoom?ve=void 0:ve=this._clampZoom(ve);var Be=this.options.updateWhenZooming&&ve!==this._tileZoom;(!ne||Be)&&(this._tileZoom=ve,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),ve!==void 0&&this._update(b),$||this._pruneTiles(),this._noPrune=!!$),this._setZoomTransforms(b,z)},_setZoomTransforms:function(b,z){for(var $ in this._levels)this._setZoomTransform(this._levels[$],b,z)},_setZoomTransform:function(b,z,$){var ne=this._map.getZoomScale($,b.zoom),ve=b.origin.multiplyBy(ne).subtract(this._map._getNewPixelOrigin(z,$)).round();be.any3d?jo(b.el,ve,ne):uo(b.el,ve)},_resetGrid:function(){var b=this._map,z=b.options.crs,$=this._tileSize=this.getTileSize(),ne=this._tileZoom,ve=this._map.getPixelWorldBounds(this._tileZoom);ve&&(this._globalTileRange=this._pxBoundsToTileRange(ve)),this._wrapX=z.wrapLng&&!this.options.noWrap&&[Math.floor(b.project([0,z.wrapLng[0]],ne).x/$.x),Math.ceil(b.project([0,z.wrapLng[1]],ne).x/$.y)],this._wrapY=z.wrapLat&&!this.options.noWrap&&[Math.floor(b.project([z.wrapLat[0],0],ne).y/$.x),Math.ceil(b.project([z.wrapLat[1],0],ne).y/$.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(b){var z=this._map,$=z._animatingZoom?Math.max(z._animateToZoom,z.getZoom()):z.getZoom(),ne=z.getZoomScale($,this._tileZoom),ve=z.project(b,this._tileZoom).floor(),Be=z.getSize().divideBy(ne*2);return new Pt(ve.subtract(Be),ve.add(Be))},_update:function(b){var z=this._map;if(z){var $=this._clampZoom(z.getZoom());if(b===void 0&&(b=z.getCenter()),this._tileZoom!==void 0){var ne=this._getTiledPixelBounds(b),ve=this._pxBoundsToTileRange(ne),Be=ve.getCenter(),_t=[],Wt=this.options.keepBuffer,ln=new Pt(ve.getBottomLeft().subtract([Wt,-Wt]),ve.getTopRight().add([Wt,-Wt]));if(!(isFinite(ve.min.x)&&isFinite(ve.min.y)&&isFinite(ve.max.x)&&isFinite(ve.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Un in this._tiles){var yi=this._tiles[Un].coords;(yi.z!==this._tileZoom||!ln.contains(new Vt(yi.x,yi.y)))&&(this._tiles[Un].current=!1)}if(Math.abs($-this._tileZoom)>1){this._setView(b,$);return}for(var Ti=ve.min.y;Ti<=ve.max.y;Ti++)for(var Ai=ve.min.x;Ai<=ve.max.x;Ai++){var br=new Vt(Ai,Ti);if(br.z=this._tileZoom,!!this._isValidTile(br)){var Wo=this._tiles[this._tileCoordsToKey(br)];Wo?Wo.current=!0:_t.push(br)}}if(_t.sort(function(Da,Ws){return Da.distanceTo(Be)-Ws.distanceTo(Be)}),_t.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ba=document.createDocumentFragment();for(Ai=0;Ai<_t.length;Ai++)this._addTile(_t[Ai],ba);this._level.el.appendChild(ba)}}}},_isValidTile:function(b){var z=this._map.options.crs;if(!z.infinite){var $=this._globalTileRange;if(!z.wrapLng&&(b.x<$.min.x||b.x>$.max.x)||!z.wrapLat&&(b.y<$.min.y||b.y>$.max.y))return!1}if(!this.options.bounds)return!0;var ne=this._tileCoordsToBounds(b);return An(this.options.bounds).overlaps(ne)},_keyToBounds:function(b){return this._tileCoordsToBounds(this._keyToTileCoords(b))},_tileCoordsToNwSe:function(b){var z=this._map,$=this.getTileSize(),ne=b.scaleBy($),ve=ne.add($),Be=z.unproject(ne,b.z),_t=z.unproject(ve,b.z);return[Be,_t]},_tileCoordsToBounds:function(b){var z=this._tileCoordsToNwSe(b),$=new on(z[0],z[1]);return this.options.noWrap||($=this._map.wrapLatLngBounds($)),$},_tileCoordsToKey:function(b){return b.x+":"+b.y+":"+b.z},_keyToTileCoords:function(b){var z=b.split(":"),$=new Vt(+z[0],+z[1]);return $.z=+z[2],$},_removeTile:function(b){var z=this._tiles[b];z&&(or(z.el),delete this._tiles[b],this.fire("tileunload",{tile:z.el,coords:this._keyToTileCoords(b)}))},_initTile:function(b){cr(b,"leaflet-tile");var z=this.getTileSize();b.style.width=z.x+"px",b.style.height=z.y+"px",b.onselectstart=j,b.onmousemove=j,be.ielt9&&this.options.opacity<1&&Bo(b,this.options.opacity)},_addTile:function(b,z){var $=this._getTilePos(b),ne=this._tileCoordsToKey(b),ve=this.createTile(this._wrapCoords(b),T(this._tileReady,this,b));this._initTile(ve),this.createTile.length<2&&Ve(T(this._tileReady,this,b,null,ve)),uo(ve,$),this._tiles[ne]={el:ve,coords:b,current:!0},z.appendChild(ve),this.fire("tileloadstart",{tile:ve,coords:b})},_tileReady:function(b,z,$){z&&this.fire("tileerror",{error:z,tile:$,coords:b});var ne=this._tileCoordsToKey(b);$=this._tiles[ne],$&&($.loaded=+new Date,this._map._fadeAnimated?(Bo($.el,0),xt(this._fadeFrame),this._fadeFrame=Ve(this._updateOpacity,this)):($.active=!0,this._pruneTiles()),z||(cr($.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:$.el,coords:b})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),be.ielt9||!this._map._fadeAnimated?Ve(this._pruneTiles,this):setTimeout(T(this._pruneTiles,this),250)))},_getTilePos:function(b){return b.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(b){var z=new Vt(this._wrapX?I(b.x,this._wrapX):b.x,this._wrapY?I(b.y,this._wrapY):b.y);return z.z=b.z,z},_pxBoundsToTileRange:function(b){var z=this.getTileSize();return new Pt(b.min.unscaleBy(z).floor(),b.max.unscaleBy(z).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var b in this._tiles)if(!this._tiles[b].loaded)return!1;return!0}});function pa(b){return new cc(b)}var uc=cc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(b,z){this._url=b,z=te(this,z),z.detectRetina&&be.retina&&z.maxZoom>0?(z.tileSize=Math.floor(z.tileSize/2),z.zoomReverse?(z.zoomOffset--,z.minZoom=Math.min(z.maxZoom,z.minZoom+1)):(z.zoomOffset++,z.maxZoom=Math.max(z.minZoom,z.maxZoom-1)),z.minZoom=Math.max(0,z.minZoom)):z.zoomReverse?z.minZoom=Math.min(z.maxZoom,z.minZoom):z.maxZoom=Math.max(z.minZoom,z.maxZoom),typeof z.subdomains=="string"&&(z.subdomains=z.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(b,z){return this._url===b&&z===void 0&&(z=!0),this._url=b,z||this.redraw(),this},createTile:function(b,z){var $=document.createElement("img");return Ni($,"load",T(this._tileOnLoad,this,z,$)),Ni($,"error",T(this._tileOnError,this,z,$)),(this.options.crossOrigin||this.options.crossOrigin==="")&&($.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&($.referrerPolicy=this.options.referrerPolicy),$.alt="",$.src=this.getTileUrl(b),$},getTileUrl:function(b){var z={r:be.retina?"@2x":"",s:this._getSubdomain(b),x:b.x,y:b.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var $=this._globalTileRange.max.y-b.y;this.options.tms&&(z.y=$),z["-y"]=$}return de(this._url,f(z,this.options))},_tileOnLoad:function(b,z){be.ielt9?setTimeout(T(b,this,null,z),0):b(null,z)},_tileOnError:function(b,z,$){var ne=this.options.errorTileUrl;ne&&z.getAttribute("src")!==ne&&(z.src=ne),b($,z)},_onTileRemove:function(b){b.tile.onload=null},_getZoomForUrl:function(){var b=this._tileZoom,z=this.options.maxZoom,$=this.options.zoomReverse,ne=this.options.zoomOffset;return $&&(b=z-b),b+ne},_getSubdomain:function(b){var z=Math.abs(b.x+b.y)%this.options.subdomains.length;return this.options.subdomains[z]},_abortLoading:function(){var b,z;for(b in this._tiles)if(this._tiles[b].coords.z!==this._tileZoom&&(z=this._tiles[b].el,z.onload=j,z.onerror=j,!z.complete)){z.src=Oe;var $=this._tiles[b].coords;or(z),delete this._tiles[b],this.fire("tileabort",{tile:z,coords:$})}},_removeTile:function(b){var z=this._tiles[b];if(z)return z.el.setAttribute("src",Oe),cc.prototype._removeTile.call(this,b)},_tileReady:function(b,z,$){if(!(!this._map||$&&$.getAttribute("src")===Oe))return cc.prototype._tileReady.call(this,b,z,$)}});function fn(b,z){return new uc(b,z)}var Zs=uc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(b,z){this._url=b;var $=f({},this.defaultWmsParams);for(var ne in z)ne in this.options||($[ne]=z[ne]);z=te(this,z);var ve=z.detectRetina&&be.retina?2:1,Be=this.getTileSize();$.width=Be.x*ve,$.height=Be.y*ve,this.wmsParams=$},onAdd:function(b){this._crs=this.options.crs||b.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var z=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[z]=this._crs.code,uc.prototype.onAdd.call(this,b)},getTileUrl:function(b){var z=this._tileCoordsToNwSe(b),$=this._crs,ne=$t($.project(z[0]),$.project(z[1])),ve=ne.min,Be=ne.max,_t=(this._wmsVersion>=1.3&&this._crs===uu?[ve.y,ve.x,Be.y,Be.x]:[ve.x,ve.y,Be.x,Be.y]).join(","),Wt=uc.prototype.getTileUrl.call(this,b);return Wt+oe(this.wmsParams,Wt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+_t},setParams:function(b,z){return f(this.wmsParams,b),z||this.redraw(),this}});function Wl(b,z){return new Zs(b,z)}uc.WMS=Zs,fn.wms=Wl;var ks=Tn.extend({options:{padding:.1},initialize:function(b){te(this,b),C(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),cr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var b={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(b.zoomanim=this._onAnimZoom),b},_onAnimZoom:function(b){this._updateTransform(b.center,b.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(b,z){var $=this._map.getZoomScale(z,this._zoom),ne=this._map.getSize().multiplyBy(.5+this.options.padding),ve=this._map.project(this._center,z),Be=ne.multiplyBy(-$).add(ve).subtract(this._map._getNewPixelOrigin(b,z));be.any3d?jo(this._container,Be,$):uo(this._container,Be)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var b in this._layers)this._layers[b]._reset()},_onZoomEnd:function(){for(var b in this._layers)this._layers[b]._project()},_updatePaths:function(){for(var b in this._layers)this._layers[b]._update()},_update:function(){var b=this.options.padding,z=this._map.getSize(),$=this._map.containerPointToLayerPoint(z.multiplyBy(-b)).round();this._bounds=new Pt($,$.add(z.multiplyBy(1+b*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),qc=ks.extend({options:{tolerance:0},getEvents:function(){var b=ks.prototype.getEvents.call(this);return b.viewprereset=this._onViewPreReset,b},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ks.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var b=this._container=document.createElement("canvas");Ni(b,"mousemove",this._onMouseMove,this),Ni(b,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ni(b,"mouseout",this._handleMouseOut,this),b._leaflet_disable_events=!0,this._ctx=b.getContext("2d")},_destroyContainer:function(){xt(this._redrawRequest),delete this._ctx,or(this._container),ri(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var b;this._redrawBounds=null;for(var z in this._layers)b=this._layers[z],b._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ks.prototype._update.call(this);var b=this._bounds,z=this._container,$=b.getSize(),ne=be.retina?2:1;uo(z,b.min),z.width=ne*$.x,z.height=ne*$.y,z.style.width=$.x+"px",z.style.height=$.y+"px",be.retina&&this._ctx.scale(2,2),this._ctx.translate(-b.min.x,-b.min.y),this.fire("update")}},_reset:function(){ks.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(b){this._updateDashArray(b),this._layers[C(b)]=b;var z=b._order={layer:b,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=z),this._drawLast=z,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(b){this._requestRedraw(b)},_removePath:function(b){var z=b._order,$=z.next,ne=z.prev;$?$.prev=ne:this._drawLast=ne,ne?ne.next=$:this._drawFirst=$,delete b._order,delete this._layers[C(b)],this._requestRedraw(b)},_updatePath:function(b){this._extendRedrawBounds(b),b._project(),b._update(),this._requestRedraw(b)},_updateStyle:function(b){this._updateDashArray(b),this._requestRedraw(b)},_updateDashArray:function(b){if(typeof b.options.dashArray=="string"){var z=b.options.dashArray.split(/[, ]+/),$=[],ne,ve;for(ve=0;ve<z.length;ve++){if(ne=Number(z[ve]),isNaN(ne))return;$.push(ne)}b.options._dashArray=$}else b.options._dashArray=b.options.dashArray},_requestRedraw:function(b){this._map&&(this._extendRedrawBounds(b),this._redrawRequest=this._redrawRequest||Ve(this._redraw,this))},_extendRedrawBounds:function(b){if(b._pxBounds){var z=(b.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Pt,this._redrawBounds.extend(b._pxBounds.min.subtract([z,z])),this._redrawBounds.extend(b._pxBounds.max.add([z,z]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var b=this._redrawBounds;if(b){var z=b.getSize();this._ctx.clearRect(b.min.x,b.min.y,z.x,z.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var b,z=this._redrawBounds;if(this._ctx.save(),z){var $=z.getSize();this._ctx.beginPath(),this._ctx.rect(z.min.x,z.min.y,$.x,$.y),this._ctx.clip()}this._drawing=!0;for(var ne=this._drawFirst;ne;ne=ne.next)b=ne.layer,(!z||b._pxBounds&&b._pxBounds.intersects(z))&&b._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(b,z){if(this._drawing){var $,ne,ve,Be,_t=b._parts,Wt=_t.length,ln=this._ctx;if(Wt){for(ln.beginPath(),$=0;$<Wt;$++){for(ne=0,ve=_t[$].length;ne<ve;ne++)Be=_t[$][ne],ln[ne?"lineTo":"moveTo"](Be.x,Be.y);z&&ln.closePath()}this._fillStroke(ln,b)}}},_updateCircle:function(b){if(!(!this._drawing||b._empty())){var z=b._point,$=this._ctx,ne=Math.max(Math.round(b._radius),1),ve=(Math.max(Math.round(b._radiusY),1)||ne)/ne;ve!==1&&($.save(),$.scale(1,ve)),$.beginPath(),$.arc(z.x,z.y/ve,ne,0,Math.PI*2,!1),ve!==1&&$.restore(),this._fillStroke($,b)}},_fillStroke:function(b,z){var $=z.options;$.fill&&(b.globalAlpha=$.fillOpacity,b.fillStyle=$.fillColor||$.color,b.fill($.fillRule||"evenodd")),$.stroke&&$.weight!==0&&(b.setLineDash&&b.setLineDash(z.options&&z.options._dashArray||[]),b.globalAlpha=$.opacity,b.lineWidth=$.weight,b.strokeStyle=$.color,b.lineCap=$.lineCap,b.lineJoin=$.lineJoin,b.stroke())},_onClick:function(b){for(var z=this._map.mouseEventToLayerPoint(b),$,ne,ve=this._drawFirst;ve;ve=ve.next)$=ve.layer,$.options.interactive&&$._containsPoint(z)&&(!(b.type==="click"||b.type==="preclick")||!this._map._draggableMoved($))&&(ne=$);this._fireEvent(ne?[ne]:!1,b)},_onMouseMove:function(b){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var z=this._map.mouseEventToLayerPoint(b);this._handleMouseHover(b,z)}},_handleMouseOut:function(b){var z=this._hoveredLayer;z&&(Kr(this._container,"leaflet-interactive"),this._fireEvent([z],b,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(b,z){if(!this._mouseHoverThrottled){for(var $,ne,ve=this._drawFirst;ve;ve=ve.next)$=ve.layer,$.options.interactive&&$._containsPoint(z)&&(ne=$);ne!==this._hoveredLayer&&(this._handleMouseOut(b),ne&&(cr(this._container,"leaflet-interactive"),this._fireEvent([ne],b,"mouseover"),this._hoveredLayer=ne)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,b),this._mouseHoverThrottled=!0,setTimeout(T(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(b,z,$){this._map._fireDOMEvent(z,$||z.type,b)},_bringToFront:function(b){var z=b._order;if(z){var $=z.next,ne=z.prev;if($)$.prev=ne;else return;ne?ne.next=$:$&&(this._drawFirst=$),z.prev=this._drawLast,this._drawLast.next=z,z.next=null,this._drawLast=z,this._requestRedraw(b)}},_bringToBack:function(b){var z=b._order;if(z){var $=z.next,ne=z.prev;if(ne)ne.next=$;else return;$?$.prev=ne:ne&&(this._drawLast=ne),z.prev=null,z.next=this._drawFirst,this._drawFirst.prev=z,this._drawFirst=z,this._requestRedraw(b)}}});function Hc(b){return be.canvas?new qc(b):null}var Ns=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(b){return document.createElement("<lvml:"+b+' class="lvml">')}}catch{}return function(b){return document.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Gc={_initContainer:function(){this._container=Xi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ks.prototype._update.call(this),this.fire("update"))},_initPath:function(b){var z=b._container=Ns("shape");cr(z,"leaflet-vml-shape "+(this.options.className||"")),z.coordsize="1 1",b._path=Ns("path"),z.appendChild(b._path),this._updateStyle(b),this._layers[C(b)]=b},_addPath:function(b){var z=b._container;this._container.appendChild(z),b.options.interactive&&b.addInteractiveTarget(z)},_removePath:function(b){var z=b._container;or(z),b.removeInteractiveTarget(z),delete this._layers[C(b)]},_updateStyle:function(b){var z=b._stroke,$=b._fill,ne=b.options,ve=b._container;ve.stroked=!!ne.stroke,ve.filled=!!ne.fill,ne.stroke?(z||(z=b._stroke=Ns("stroke")),ve.appendChild(z),z.weight=ne.weight+"px",z.color=ne.color,z.opacity=ne.opacity,ne.dashArray?z.dashStyle=ue(ne.dashArray)?ne.dashArray.join(" "):ne.dashArray.replace(/( *, *)/g," "):z.dashStyle="",z.endcap=ne.lineCap.replace("butt","flat"),z.joinstyle=ne.lineJoin):z&&(ve.removeChild(z),b._stroke=null),ne.fill?($||($=b._fill=Ns("fill")),ve.appendChild($),$.color=ne.fillColor||ne.color,$.opacity=ne.fillOpacity):$&&(ve.removeChild($),b._fill=null)},_updateCircle:function(b){var z=b._point.round(),$=Math.round(b._radius),ne=Math.round(b._radiusY||$);this._setPath(b,b._empty()?"M0 0":"AL "+z.x+","+z.y+" "+$+","+ne+" 0,"+65535*360)},_setPath:function(b,z){b._path.v=z},_bringToFront:function(b){Hs(b._container)},_bringToBack:function(b){Ds(b._container)}},Bs=be.vml?Ns:Mi,Oi=ks.extend({_initContainer:function(){this._container=Bs("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Bs("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){or(this._container),ri(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ks.prototype._update.call(this);var b=this._bounds,z=b.getSize(),$=this._container;(!this._svgSize||!this._svgSize.equals(z))&&(this._svgSize=z,$.setAttribute("width",z.x),$.setAttribute("height",z.y)),uo($,b.min),$.setAttribute("viewBox",[b.min.x,b.min.y,z.x,z.y].join(" ")),this.fire("update")}},_initPath:function(b){var z=b._path=Bs("path");b.options.className&&cr(z,b.options.className),b.options.interactive&&cr(z,"leaflet-interactive"),this._updateStyle(b),this._layers[C(b)]=b},_addPath:function(b){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(b._path),b.addInteractiveTarget(b._path)},_removePath:function(b){or(b._path),b.removeInteractiveTarget(b._path),delete this._layers[C(b)]},_updatePath:function(b){b._project(),b._update()},_updateStyle:function(b){var z=b._path,$=b.options;z&&($.stroke?(z.setAttribute("stroke",$.color),z.setAttribute("stroke-opacity",$.opacity),z.setAttribute("stroke-width",$.weight),z.setAttribute("stroke-linecap",$.lineCap),z.setAttribute("stroke-linejoin",$.lineJoin),$.dashArray?z.setAttribute("stroke-dasharray",$.dashArray):z.removeAttribute("stroke-dasharray"),$.dashOffset?z.setAttribute("stroke-dashoffset",$.dashOffset):z.removeAttribute("stroke-dashoffset")):z.setAttribute("stroke","none"),$.fill?(z.setAttribute("fill",$.fillColor||$.color),z.setAttribute("fill-opacity",$.fillOpacity),z.setAttribute("fill-rule",$.fillRule||"evenodd")):z.setAttribute("fill","none"))},_updatePoly:function(b,z){this._setPath(b,Tr(b._parts,z))},_updateCircle:function(b){var z=b._point,$=Math.max(Math.round(b._radius),1),ne=Math.max(Math.round(b._radiusY),1)||$,ve="a"+$+","+ne+" 0 1,0 ",Be=b._empty()?"M0 0":"M"+(z.x-$)+","+z.y+ve+$*2+",0 "+ve+-$*2+",0 ";this._setPath(b,Be)},_setPath:function(b,z){b._path.setAttribute("d",z)},_bringToFront:function(b){Hs(b._path)},_bringToBack:function(b){Ds(b._path)}});be.vml&&Oi.include(Gc);function kl(b){return be.svg||be.vml?new Oi(b):null}qn.include({getRenderer:function(b){var z=b.options.renderer||this._getPaneRenderer(b.options.pane)||this.options.renderer||this._renderer;return z||(z=this._renderer=this._createRenderer()),this.hasLayer(z)||this.addLayer(z),z},_getPaneRenderer:function(b){if(b==="overlayPane"||b===void 0)return!1;var z=this._paneRenderers[b];return z===void 0&&(z=this._createRenderer({pane:b}),this._paneRenderers[b]=z),z},_createRenderer:function(b){return this.options.preferCanvas&&Hc(b)||kl(b)}});var bm=kh.extend({initialize:function(b,z){kh.prototype.initialize.call(this,this._boundsToLatLngs(b),z)},setBounds:function(b){return this.setLatLngs(this._boundsToLatLngs(b))},_boundsToLatLngs:function(b){return b=An(b),[b.getSouthWest(),b.getNorthWest(),b.getNorthEast(),b.getSouthEast()]}});function El(b,z){return new bm(b,z)}Oi.create=Bs,Oi.pointsToPath=Tr,Ga.geometryToLayer=sc,Ga.coordsToLatLng=Vc,Ga.coordsToLatLngs=Nh,Ga.latLngToCoords=hu,Ga.latLngsToCoords=Bh,Ga.getFeature=rs,Ga.asFeature=jh,qn.mergeOptions({boxZoom:!0});var Qu=Xn.extend({initialize:function(b){this._map=b,this._container=b._container,this._pane=b._panes.overlayPane,this._resetStateTimeout=0,b.on("unload",this._destroy,this)},addHooks:function(){Ni(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ri(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){or(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(b){if(!b.shiftKey||b.which!==1&&b.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),da(),cs(),this._startPoint=this._map.mouseEventToContainerPoint(b),Ni(document,{contextmenu:Oa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(b){this._moved||(this._moved=!0,this._box=Xi("div","leaflet-zoom-box",this._container),cr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(b);var z=new Pt(this._point,this._startPoint),$=z.getSize();uo(this._box,z.min),this._box.style.width=$.x+"px",this._box.style.height=$.y+"px"},_finish:function(){this._moved&&(or(this._box),Kr(this._container,"leaflet-crosshair")),wl(),us(),ri(document,{contextmenu:Oa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(b){if(!(b.which!==1&&b.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(T(this._resetState,this),0);var z=new on(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(z).fire("boxzoomend",{boxZoomBounds:z})}},_onKeyDown:function(b){b.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});qn.addInitHook("addHandler","boxZoom",Qu),qn.mergeOptions({doubleClickZoom:!0});var hc=Xn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(b){var z=this._map,$=z.getZoom(),ne=z.options.zoomDelta,ve=b.originalEvent.shiftKey?$-ne:$+ne;z.options.doubleClickZoom==="center"?z.setZoom(ve):z.setZoomAround(b.containerPoint,ve)}});qn.addInitHook("addHandler","doubleClickZoom",hc),qn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Jr=Xn.extend({addHooks:function(){if(!this._draggable){var b=this._map;this._draggable=new es(b._mapPane,b._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),b.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),b.on("zoomend",this._onZoomEnd,this),b.whenReady(this._onZoomEnd,this))}cr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Kr(this._map._container,"leaflet-grab"),Kr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var b=this._map;if(b._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var z=An(this._map.options.maxBounds);this._offsetLimit=$t(this._map.latLngToContainerPoint(z.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(z.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;b.fire("movestart").fire("dragstart"),b.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(b){if(this._map.options.inertia){var z=this._lastTime=+new Date,$=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push($),this._times.push(z),this._prunePositions(z)}this._map.fire("move",b).fire("drag",b)},_prunePositions:function(b){for(;this._positions.length>1&&b-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var b=this._map.getSize().divideBy(2),z=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=z.subtract(b).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(b,z){return b-(b-z)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var b=this._draggable._newPos.subtract(this._draggable._startPos),z=this._offsetLimit;b.x<z.min.x&&(b.x=this._viscousLimit(b.x,z.min.x)),b.y<z.min.y&&(b.y=this._viscousLimit(b.y,z.min.y)),b.x>z.max.x&&(b.x=this._viscousLimit(b.x,z.max.x)),b.y>z.max.y&&(b.y=this._viscousLimit(b.y,z.max.y)),this._draggable._newPos=this._draggable._startPos.add(b)}},_onPreDragWrap:function(){var b=this._worldWidth,z=Math.round(b/2),$=this._initialWorldOffset,ne=this._draggable._newPos.x,ve=(ne-z+$)%b+z-$,Be=(ne+z+$)%b-z-$,_t=Math.abs(ve+$)<Math.abs(Be+$)?ve:Be;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=_t},_onDragEnd:function(b){var z=this._map,$=z.options,ne=!$.inertia||b.noInertia||this._times.length<2;if(z.fire("dragend",b),ne)z.fire("moveend");else{this._prunePositions(+new Date);var ve=this._lastPos.subtract(this._positions[0]),Be=(this._lastTime-this._times[0])/1e3,_t=$.easeLinearity,Wt=ve.multiplyBy(_t/Be),ln=Wt.distanceTo([0,0]),Un=Math.min($.inertiaMaxSpeed,ln),yi=Wt.multiplyBy(Un/ln),Ti=Un/($.inertiaDeceleration*_t),Ai=yi.multiplyBy(-Ti/2).round();!Ai.x&&!Ai.y?z.fire("moveend"):(Ai=z._limitOffset(Ai,z.options.maxBounds),Ve(function(){z.panBy(Ai,{duration:Ti,easeLinearity:_t,noMoveStart:!0,animate:!0})}))}}});qn.addInitHook("addHandler","dragging",Jr),qn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Vh=Xn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(b){this._map=b,this._setPanDelta(b.options.keyboardPanDelta),this._setZoomDelta(b.options.zoomDelta)},addHooks:function(){var b=this._map._container;b.tabIndex<=0&&(b.tabIndex="0"),Ni(b,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ri(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var b=document.body,z=document.documentElement,$=b.scrollTop||z.scrollTop,ne=b.scrollLeft||z.scrollLeft;this._map._container.focus(),window.scrollTo(ne,$)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(b){var z=this._panKeys={},$=this.keyCodes,ne,ve;for(ne=0,ve=$.left.length;ne<ve;ne++)z[$.left[ne]]=[-1*b,0];for(ne=0,ve=$.right.length;ne<ve;ne++)z[$.right[ne]]=[b,0];for(ne=0,ve=$.down.length;ne<ve;ne++)z[$.down[ne]]=[0,b];for(ne=0,ve=$.up.length;ne<ve;ne++)z[$.up[ne]]=[0,-1*b]},_setZoomDelta:function(b){var z=this._zoomKeys={},$=this.keyCodes,ne,ve;for(ne=0,ve=$.zoomIn.length;ne<ve;ne++)z[$.zoomIn[ne]]=b;for(ne=0,ve=$.zoomOut.length;ne<ve;ne++)z[$.zoomOut[ne]]=-b},_addHooks:function(){Ni(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ri(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(b){if(!(b.altKey||b.ctrlKey||b.metaKey)){var z=b.keyCode,$=this._map,ne;if(z in this._panKeys){if(!$._panAnim||!$._panAnim._inProgress)if(ne=this._panKeys[z],b.shiftKey&&(ne=$e(ne).multiplyBy(3)),$.options.maxBounds&&(ne=$._limitOffset($e(ne),$.options.maxBounds)),$.options.worldCopyJump){var ve=$.wrapLatLng($.unproject($.project($.getCenter()).add(ne)));$.panTo(ve)}else $.panBy(ne)}else if(z in this._zoomKeys)$.setZoom($.getZoom()+(b.shiftKey?3:1)*this._zoomKeys[z]);else if(z===27&&$._popup&&$._popup.options.closeOnEscapeKey)$.closePopup();else return;Oa(b)}}});qn.addInitHook("addHandler","keyboard",Vh),qn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var dc=Xn.extend({addHooks:function(){Ni(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ri(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(b){var z=Tl(b),$=this._map.options.wheelDebounceTime;this._delta+=z,this._lastMousePos=this._map.mouseEventToContainerPoint(b),this._startTime||(this._startTime=+new Date);var ne=Math.max($-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(T(this._performZoom,this),ne),Oa(b)},_performZoom:function(){var b=this._map,z=b.getZoom(),$=this._map.options.zoomSnap||0;b._stop();var ne=this._delta/(this._map.options.wheelPxPerZoomLevel*4),ve=4*Math.log(2/(1+Math.exp(-Math.abs(ne))))/Math.LN2,Be=$?Math.ceil(ve/$)*$:ve,_t=b._limitZoom(z+(this._delta>0?Be:-Be))-z;this._delta=0,this._startTime=null,_t&&(b.options.scrollWheelZoom==="center"?b.setZoom(z+_t):b.setZoomAround(this._lastMousePos,z+_t))}});qn.addInitHook("addHandler","scrollWheelZoom",dc);var yp=600;qn.mergeOptions({tapHold:be.touchNative&&be.safari&&be.mobile,tapTolerance:15});var xf=Xn.extend({addHooks:function(){Ni(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ri(this._map._container,"touchstart",this._onDown,this)},_onDown:function(b){if(clearTimeout(this._holdTimeout),b.touches.length===1){var z=b.touches[0];this._startPos=this._newPos=new Vt(z.clientX,z.clientY),this._holdTimeout=setTimeout(T(function(){this._cancel(),this._isTapValid()&&(Ni(document,"touchend",No),Ni(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",z))},this),yp),Ni(document,"touchend touchcancel contextmenu",this._cancel,this),Ni(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function b(){ri(document,"touchend",No),ri(document,"touchend touchcancel",b)},_cancel:function(){clearTimeout(this._holdTimeout),ri(document,"touchend touchcancel contextmenu",this._cancel,this),ri(document,"touchmove",this._onMove,this)},_onMove:function(b){var z=b.touches[0];this._newPos=new Vt(z.clientX,z.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(b,z){var $=new MouseEvent(b,{bubbles:!0,cancelable:!0,view:window,screenX:z.screenX,screenY:z.screenY,clientX:z.clientX,clientY:z.clientY});$._simulated=!0,z.target.dispatchEvent($)}});qn.addInitHook("addHandler","tapHold",xf),qn.mergeOptions({touchZoom:be.touch,bounceAtZoomLimits:!0});var eh=Xn.extend({addHooks:function(){cr(this._map._container,"leaflet-touch-zoom"),Ni(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Kr(this._map._container,"leaflet-touch-zoom"),ri(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(b){var z=this._map;if(!(!b.touches||b.touches.length!==2||z._animatingZoom||this._zooming)){var $=z.mouseEventToContainerPoint(b.touches[0]),ne=z.mouseEventToContainerPoint(b.touches[1]);this._centerPoint=z.getSize()._divideBy(2),this._startLatLng=z.containerPointToLatLng(this._centerPoint),z.options.touchZoom!=="center"&&(this._pinchStartLatLng=z.containerPointToLatLng($.add(ne)._divideBy(2))),this._startDist=$.distanceTo(ne),this._startZoom=z.getZoom(),this._moved=!1,this._zooming=!0,z._stop(),Ni(document,"touchmove",this._onTouchMove,this),Ni(document,"touchend touchcancel",this._onTouchEnd,this),No(b)}},_onTouchMove:function(b){if(!(!b.touches||b.touches.length!==2||!this._zooming)){var z=this._map,$=z.mouseEventToContainerPoint(b.touches[0]),ne=z.mouseEventToContainerPoint(b.touches[1]),ve=$.distanceTo(ne)/this._startDist;if(this._zoom=z.getScaleZoom(ve,this._startZoom),!z.options.bounceAtZoomLimits&&(this._zoom<z.getMinZoom()&&ve<1||this._zoom>z.getMaxZoom()&&ve>1)&&(this._zoom=z._limitZoom(this._zoom)),z.options.touchZoom==="center"){if(this._center=this._startLatLng,ve===1)return}else{var Be=$._add(ne)._divideBy(2)._subtract(this._centerPoint);if(ve===1&&Be.x===0&&Be.y===0)return;this._center=z.unproject(z.project(this._pinchStartLatLng,this._zoom).subtract(Be),this._zoom)}this._moved||(z._moveStart(!0,!1),this._moved=!0),xt(this._animRequest);var _t=T(z._move,z,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Ve(_t,this,!0),No(b)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,xt(this._animRequest),ri(document,"touchmove",this._onTouchMove,this),ri(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});qn.addInitHook("addHandler","touchZoom",eh),qn.BoxZoom=Qu,qn.DoubleClickZoom=hc,qn.Drag=Jr,qn.Keyboard=Vh,qn.ScrollWheelZoom=dc,qn.TapHold=xf,qn.TouchZoom=eh,i.Bounds=Pt,i.Browser=be,i.CRS=In,i.Canvas=qc,i.Circle=Ad,i.CircleMarker=Fc,i.Class=ot,i.Control=Ui,i.DivIcon=fu,i.DivOverlay=Uo,i.DomEvent=Ut,i.DomUtil=na,i.Draggable=es,i.Evented=Bt,i.FeatureGroup=Vr,i.GeoJSON=Ga,i.GridLayer=cc,i.Handler=Xn,i.Icon=li,i.ImageOverlay=zs,i.LatLng=ct,i.LatLngBounds=on,i.Layer=Tn,i.LayerGroup=ds,i.LineUtil=zh,i.Map=qn,i.Marker=Ku,i.Mixin=Ll,i.Path=la,i.Point=Vt,i.PolyUtil=Jn,i.Polygon=kh,i.Polyline=ia,i.Popup=$c,i.PosAnimation=kn,i.Projection=rc,i.Rectangle=bm,i.Renderer=ks,i.SVG=Oi,i.SVGOverlay=lc,i.TileLayer=uc,i.Tooltip=Fh,i.Transformation=ai,i.Util=yt,i.VideoOverlay=Md,i.bind=T,i.bounds=$t,i.canvas=Hc,i.circle=ac,i.circleMarker=Ia,i.control=_o,i.divIcon=vf,i.extend=f,i.featureGroup=Bc,i.geoJSON=Cd,i.geoJson=gp,i.gridLayer=pa,i.icon=jc,i.imageOverlay=du,i.latLng=kt,i.latLngBounds=An,i.layerGroup=di,i.map=oo,i.marker=ul,i.point=$e,i.polygon=Sl,i.polyline=Pd,i.popup=_p,i.rectangle=El,i.setOptions=te,i.stamp=C,i.svg=kl,i.svgOverlay=yf,i.tileLayer=fn,i.tooltip=Uh,i.transformation=mn,i.version=s,i.videoOverlay=Od;var $h=window.L;i.noConflict=function(){return window.L=$h,this},window.L=i})}(_x,_x.exports)),_x.exports}var rb=rK();const r5=Zu(rb);function iM(e,t,i){return Object.freeze({instance:e,context:t,container:i})}function rM(e,t){return t==null?function(s,f){const y=me.useRef(void 0);return y.current||(y.current=e(s,f)),y}:function(s,f){const y=me.useRef(void 0);y.current||(y.current=e(s,f));const T=me.useRef(s),{instance:o}=y.current;return me.useEffect(function(){T.current!==s&&(t(o,s,T.current),T.current=s)},[o,s,t]),y}}function oK(e,t){me.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function o5(e){return function(i){const s=n5(),f=e(nM(i,s),s);return t5(s.map,i.attribution),i5(f.current,i.eventHandlers),oK(f.current,s),f}}function aK(e,t){const i=rM(e,t),s=o5(i);return QY(s)}function sK(e,t){const i=rM(e),s=nK(i,t);return eK(s)}function lK(e,t){const i=rM(e,t),s=o5(i);return tK(s)}function cK(e,t,i){const{opacity:s,zIndex:f}=t;s!=null&&s!==i.opacity&&e.setOpacity(s),f!=null&&f!==i.zIndex&&e.setZIndex(f)}function uK({bounds:e,boundsOptions:t,center:i,children:s,className:f,id:y,placeholder:T,style:o,whenReady:C,zoom:M,...I},j){const[q]=me.useState({className:f,id:y,style:o}),[K,J]=me.useState(null),te=me.useRef(void 0);me.useImperativeHandle(j,()=>K?.map??null,[K]);const oe=me.useCallback(de=>{if(de!==null&&!te.current){const ue=new rb.Map(de,I);te.current=ue,i!=null&&M!=null?ue.setView(i,M):e!=null&&ue.fitBounds(e,t),C!=null&&ue.whenReady(C),J(KY(ue))}},[]);me.useEffect(()=>()=>{K?.map.remove()},[K]);const ce=K?yd.createElement(tM,{value:K},s):T??null;return yd.createElement("div",{...q,ref:oe},ce)}const hK=me.forwardRef(uK),dK=aK(function({position:t,...i},s){const f=new rb.Marker(t,i);return iM(f,JY(s,{overlayContainer:f}))},function(t,i,s){i.position!==s.position&&t.setLatLng(i.position),i.icon!=null&&i.icon!==s.icon&&t.setIcon(i.icon),i.zIndexOffset!=null&&i.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(i.zIndexOffset),i.opacity!=null&&i.opacity!==s.opacity&&t.setOpacity(i.opacity),t.dragging!=null&&i.draggable!==s.draggable&&(i.draggable===!0?t.dragging.enable():t.dragging.disable())}),fK=sK(function(t,i){const s=new rb.Popup(t,i.overlayContainer);return iM(s,i)},function(t,i,{position:s},f){me.useEffect(function(){const{instance:T}=t;function o(M){M.popup===T&&(T.update(),f(!0))}function C(M){M.popup===T&&f(!1)}return i.map.on({popupopen:o,popupclose:C}),i.overlayContainer==null?(s!=null&&T.setLatLng(s),T.openOn(i.map)):i.overlayContainer.bindPopup(T),function(){i.map.off({popupopen:o,popupclose:C}),i.overlayContainer?.unbindPopup(),i.map.removeLayer(T)}},[t,i,f,s])}),pK=lK(function({url:t,...i},s){const f=new rb.TileLayer(t,nM(i,s));return iM(f,s)},function(t,i,s){cK(t,i,s);const{url:f}=i;f!=null&&f!==s.url&&t.setUrl(f)});delete r5.Icon.Default.prototype._getIconUrl;r5.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const mK=[{lat:24.7136,lng:46.6753,title:"منطقة محظورة",desc:"تقع في الرياض"},{lat:21.3891,lng:39.8579,title:"منطقة محظورة",desc:"تقع في مكة"},{lat:21.4858,lng:39.1925,title:"بحر محظور للسباحة",desc:"في مدينة جدة"},{lat:26.4207,lng:50.0888,title:"منطقة مقطوعة",desc:"في المنطقة الشرقية"}],gK=()=>ie.jsx("div",{style:{height:"500px",borderRadius:"12px",overflow:"hidden"},children:ie.jsxs(hK,{center:[24.7136,46.6753],zoom:5,style:{height:"100%",width:"100%"},children:[ie.jsx(pK,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"© OpenStreetMap"}),mK.map((e,t)=>ie.jsx(dK,{position:[e.lat,e.lng],children:ie.jsxs(fK,{children:[ie.jsx("strong",{children:e.title}),ie.jsx("br",{}),e.desc]})},t))]})});function _K(){return ie.jsxs(ie.Fragment,{children:[ie.jsxs("div",{className:"bg-[#1E1C3D] h-[100vh] text-white",children:[" ",ie.jsx(O7,{}),ie.jsxs("div",{className:"flex justify-center h-screen items-center",children:[" ",ie.jsx(C7,{})]})]}),ie.jsxs("div",{className:"min-h-screen bg-[#272343]  text-white",children:[ie.jsx(ZY,{}),ie.jsx(WY,{}),ie.jsx(gK,{}),ie.jsx(XY,{})]})]})}const Vl=({children:e,className:t="",variant:i="default",...s})=>{const f="px-4 py-2 rounded font-medium transition",y={default:"bg-[#F8D203] text-white hover:bg-[#f8d30397] cursor-pointer",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 cursor-pointer"};return ie.jsx("button",{className:`${f} ${y[i]} ${t}`,...s,children:e})};function oM(){const[e,t]=me.useState(!1),s=mp().pathname,f=()=>{t(!1)};return ie.jsx(ie.Fragment,{children:ie.jsxs("div",{className:" bg-gray-50 flex",children:[e&&ie.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-30 md:hidden",onClick:f,children:ie.jsx(Y7,{})}),ie.jsxs("aside",{className:"w-64 bg-white p-6 border-r border-[#d8d0d090] hidden md:block",children:[ie.jsx("div",{className:"flex justify-center items-center",children:ie.jsx("img",{src:"/assets/logo.png",className:"w-25 mb-9"})}),ie.jsxs("nav",{className:"space-y-3 relative",children:[ie.jsx(ss,{to:"/admin",children:ie.jsx(Vl,{variant:s==="/admin"?"default":"ghost",className:`w-full ${s==="/admin"?"bg-yellow-400 text-black":"justify-start"}`,children:"لوحة التحكم"})}),ie.jsx(ss,{to:"/listuser",children:ie.jsx(Vl,{variant:s==="/listuser"?"default":"ghost",className:`w-full ${s==="/listuser"?"bg-yellow-400 text-black":"justify-start"}`,children:"جميع المستخدمين"})}),ie.jsx(ss,{to:"/listhelper",children:ie.jsx(Vl,{variant:s==="/listhelper"?"default":"ghost",className:`w-full ${s==="/listhelper"?"bg-yellow-400 text-black":"justify-start"}`,children:"الخدمات المساندة"})}),ie.jsxs("div",{className:"absolute mt-10 right-6 flex items-center space-x-3",children:[ie.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center font-bold text-green-700",children:"A"}),ie.jsxs("div",{children:[ie.jsx("p",{className:"font-semibold",children:"admin"}),ie.jsx("p",{className:"text-xs text-gray-400",children:"admin@admin.com"})]}),ie.jsx(xC,{className:"mr-auto text-red-500 cursor-pointer"})]})]})]})]})})}const yK=[{name:"James Anderson",email:"olivia@jsmastery.pro",dateJoined:"Jan 6, 2022",itineraries:12,status:"User",avatar:"https://randomuser.me/api/portraits/men/32.jpg"},{name:"Michael Johnson",email:"phoenix@jsmastery.pro",dateJoined:"Jan 6, 2022",itineraries:21,status:"User",avatar:"https://randomuser.me/api/portraits/men/45.jpg"},{name:"David Brown",email:"lana@jsmastery.pro",dateJoined:"Jan 6, 2022",itineraries:15,status:"Helper",avatar:"https://randomuser.me/api/portraits/men/14.jpg"},{name:"Jason Wilson",email:"demi@jsmastery.pro",dateJoined:"Jan 5, 2022",itineraries:3,status:"User",avatar:"https://randomuser.me/api/portraits/men/25.jpg"},{name:"Mark Davis",email:"candice@jsmastery.pro",dateJoined:"Jan 5, 2022",itineraries:6,status:"Helper",avatar:null},{name:"Kevin Taylor",email:"natali@jsmastery.pro",dateJoined:"Jan 5, 2022",itineraries:31,status:"User",avatar:"https://randomuser.me/api/portraits/men/56.jpg"},{name:"Brian Miller",email:"drew@jsmastery.pro",dateJoined:"Jan 4, 2022",itineraries:17,status:"User",avatar:"https://randomuser.me/api/portraits/men/61.jpg"},{name:"Orlando Diggs",email:"orlando@jsmastery.pro",dateJoined:"Jan 5, 2022",itineraries:26,status:"Helper",avatar:"https://randomuser.me/api/portraits/men/71.jpg"}],vK=()=>{const[e,t]=me.useState(null),[i,s]=me.useState(0),[f,y]=me.useState(!1),[T,o]=me.useState(""),[C,M]=me.useState(""),[I,j]=me.useState(""),[q,K]=me.useState(""),[J,te]=me.useState(""),[oe,ce]=me.useState("User"),[de,ue]=me.useState([]),Pe=xe=>{t(xe)},Oe=()=>{t(null)};return ie.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[ie.jsx(oM,{}),ie.jsxs("main",{className:"flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-2",children:[ie.jsxs("div",{children:[ie.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"ادارة المستخدمين  "}),ie.jsx("p",{className:"text-gray-500 text-sm",children:"يمكنك ادارة المستخدمين مثل تعديل وحذف واضافة"})]}),ie.jsx("button",{onClick:()=>y(!0),className:"bg-[#F8D203] hover:bg-yellow-500 text-white px-4 py-2 rounded font-medium w-full md:w-auto",children:ie.jsxs("div",{className:"flex flex-row",children:[ie.jsx("p",{children:"اضافة مستخدمين "}),"  ",ie.jsx(bC,{className:"mr-2"})]})})]}),ie.jsx("div",{className:"bg-white shadow rounded overflow-x-auto",children:ie.jsxs("table",{className:"min-w-full text-right text-sm",children:[ie.jsx("thead",{className:"border-b border-[#7a77777e] bg-gray-50",children:ie.jsxs("tr",{children:[ie.jsx("th",{className:"p-4 font-medium",children:"الاسم"}),ie.jsx("th",{className:"p-4 font-medium hidden sm:table-cell",children:"البريد الالكتروني"}),ie.jsx("th",{className:"p-4 font-medium",children:"الحاله"}),ie.jsx("th",{className:"p-4 font-medium"})]})}),ie.jsx("tbody",{children:yK.map(xe=>ie.jsxs("tr",{className:"border-b border-[#c5c1c1a6] hover:bg-gray-50 transition-colors",children:[ie.jsx("td",{className:"p-4 flex items-center gap-3",children:xe.name}),ie.jsx("td",{className:"p-4 hidden sm:table-cell",children:xe.email}),ie.jsx("td",{className:"p-4",children:ie.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${xe.status==="User"?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"}`,children:xe.status})}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{onClick:()=>Pe(xe),className:"bg-blue-100 text-blue-600 rounded px-2 py-1 hover:bg-gray-400",children:"المزيد"})}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:ie.jsx(FA,{size:18})})})]}))})]})}),f&&ie.jsx("div",{className:"fixed inset-0 bg-[#ffffff0b] bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 transition-opacity duration-300",children:ie.jsx("div",{className:"bg-white w-full max-w-lg max-h-[90vh]  overflow-y-auto rounded-xl shadow-lg",children:ie.jsxs("form",{onSubmit:xe=>{xe.preventDefault(),console.log({name:T,email:C,phone:I,location:q,password:J,role:oe,services:de}),y(!1)},className:"bg-white p-6 rounded-xl w-[90%] max-w-md relative transform transition-all duration-300 scale-95 opacity-0 animate-fadeIn",children:[ie.jsx("h2",{className:"text-lg font-bold mb-4",children:"إضافة / تعديل مستخدم"}),ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"الاسم"}),ie.jsx("input",{type:"text",className:"w-full border border-[#7a77777e] rounded px-3 py-2",required:!0,value:T,onChange:xe=>o(xe.target.value)})]}),ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"البريد الإلكتروني"}),ie.jsx("input",{type:"email",className:"w-full border border-[#7a77777e] rounded px-3 py-2",required:!0,value:C,onChange:xe=>M(xe.target.value)})]}),ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"رقم الجوال"}),ie.jsx("input",{type:"tel",className:"w-full border border-[#7a77777e] rounded px-3 py-2",required:!0,value:I,onChange:xe=>j(xe.target.value)})]}),ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"الموقع"}),ie.jsx("input",{type:"text",className:"w-full border border-[#7a77777e] rounded px-3 py-2",placeholder:"رابط الموقع ",value:q,onChange:xe=>K(xe.target.value)})]}),ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"كلمة المرور"}),ie.jsx("input",{type:"password",className:"w-full border border-[#7a77777e] rounded px-3 py-2",required:!0,value:J,onChange:xe=>te(xe.target.value)})]}),ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"الدور"}),ie.jsxs("select",{className:"w-full border border-[#7a77777e] rounded px-3 py-2",value:oe,onChange:xe=>ce(xe.target.value),children:[ie.jsx("option",{value:"User",children:"مستخدم"}),ie.jsx("option",{value:"Helper",children:"مساعد"})]})]}),oe==="Helper"&&ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"الخدمات"}),ie.jsxs("select",{multiple:!0,className:"w-full border border-[#7a77777e] rounded px-3 py-2",value:de,onChange:xe=>{const Qe=Array.from(xe.target.selectedOptions).map(tt=>tt.value);ue(Qe)},children:[ie.jsx("option",{value:"سطحه",children:"سطحة"}),ie.jsx("option",{value:"بطارية",children:"بطارية"}),ie.jsx("option",{value:"وقود",children:"وقود"}),ie.jsx("option",{value:"لتقديم المساعدة الشخصية",children:"لتقديم المساعدة الشخصية"})]})]}),oe==="Helper"&&ie.jsxs("div",{className:"mb-3",children:[ie.jsx("label",{className:"block text-sm font-medium mb-1",children:"السعر"}),ie.jsxs("select",{multiple:!0,className:"w-full border border-[#7a77777e] rounded px-3 py-2",value:de,onChange:xe=>{const Qe=Array.from(xe.target.selectedOptions).map(tt=>tt.value);ue(Qe)},children:[ie.jsxs("option",{value:"10-100",children:["10-100 ",ie.jsx(W_,{})]}),ie.jsxs("option",{value:"200-300",children:["200-500 ",ie.jsx(W_,{})]}),ie.jsxs("option",{value:"500>",children:["اكثر من 500 ",ie.jsx(W_,{})]})]})]}),ie.jsxs("div",{className:"flex justify-between mt-6",children:[ie.jsx("button",{type:"button",onClick:()=>y(!1),className:"px-4 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"إغلاق"}),ie.jsx("button",{type:"submit",className:"px-4 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"حفظ"}),ie.jsxs("button",{type:"button",onClick:()=>{console.log("تم الحذف"),y(!1)},className:"flex items-center gap-2 px-4 py-1 bg-red-100 text-red-700 hover:bg-red-200 rounded",children:[ie.jsx(FA,{size:18}),"حذف"]})]})]})})}),e&&ie.jsx("div",{className:"fixed inset-0 bg-[#ffffff0b] bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 transition-opacity duration-300",children:ie.jsxs("div",{className:"bg-white p-6 rounded-xl w-[90%] max-w-md relative transform transition-all duration-300 scale-95 opacity-0 animate-fadeIn",children:[ie.jsx("h2",{className:"text-lg font-bold mb-4",children:"تفاصيل المستخدم"}),ie.jsxs("p",{children:[ie.jsx("strong",{children:"رقم الجوال:"})," i"]}),ie.jsxs("p",{className:"mt-2",children:[ie.jsx("strong",{children:"تاريخ الخدمة:"})," oo"]}),ie.jsxs("div",{className:"mt-4",children:[ie.jsx("strong",{children:"الموقع:"}),ie.jsx("iframe",{src:"",width:"100%",height:"200",className:"mt-2 rounded",allowFullScreen:!0})]}),ie.jsxs("div",{className:"flex justify-between mt-6",children:[ie.jsx("button",{onClick:Oe,className:"px-4 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"إغلاق"}),ie.jsxs("button",{onClick:()=>{alert("تم الحذف"),Oe()},className:"flex items-center gap-2 px-4 py-1 bg-green-100 text-green-700 hover:bg-green-200 rounded",children:[ie.jsx(U7,{size:18}),"حفظ"]})]})]})})]})]})},xK=[{id:1,title:"سطحة",price:"200",image:"/assets/tow-truck.png"},{id:2,title:"وقود",price:"50",image:"/assets/gas-pump.png"},{id:3,title:"بطارية سيارة",price:"300",image:"/assets/accumulator.png"},{id:4,title:"شخص للمساعدة ",price:"50-500",image:"/assets/man.png"}],bK=[{id:"1",name:"Michael Johnson",phone:"phoenix@jsmastery.pro",locationUrl:"https://www.google.com/maps?q=24.7136,46.6753",services:"بطارية",rating:5,status:"رفض",date:"2025-07-07"},{id:"2",name:"Jason Wilson",phone:"demi@jsmastery.pro",locationUrl:"https://www.google.com/maps?q=24.774265,46.738586",services:"بطارية",rating:4,status:"قبول",date:"2025-07-07"}];function Sz(){return ie.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[ie.jsx(oM,{}),ie.jsxs("main",{className:" flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex justify-between items-start flex-wrap mb-5 gap-4",children:[ie.jsx("div",{children:ie.jsx("h2",{className:"text-xl font-bold",children:"مرحبا Admin 👋"})}),ie.jsx(Vl,{className:"bg-yellow-400 text-black rounded-full flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]}),ie.jsx("div",{className:"mt-5 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:xK.map(e=>ie.jsxs("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:[ie.jsx("div",{className:"flex justify-center items-center m-3",children:ie.jsx("img",{src:e.image,className:"w-20 h-20 "})}),ie.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:ie.jsxs("div",{className:"p-4",children:[ie.jsx("h2",{className:"text-lg font-semibold",children:e.title}),ie.jsxs("div",{className:"mt-2 flex flex-row justify-between items-center",children:[ie.jsx("p",{className:"text-lg text-gray-500",children:e.price}),ie.jsx(W_,{color:"#f8d203"})]})]})})]},e.id))}),ie.jsx("div",{className:"bg-white shadow rounded overflow-x-auto",children:ie.jsxs("table",{className:"min-w-full text-right text-sm",children:[ie.jsx("thead",{className:"border-b border-[#7a77777e] bg-gray-50",children:ie.jsxs("tr",{children:[ie.jsx("th",{className:"p-4 font-medium",children:"الأسم"}),ie.jsx("th",{className:"p-4 font-medium hidden sm:table-cell",children:"رقم الجوال"}),ie.jsx("th",{className:"p-4 font-medium hidden lg:table-cell",children:"نوع الخدمة"}),ie.jsx("th",{className:"p-4 font-medium hidden lg:table-cell",children:"السعر"}),ie.jsx("th",{className:"p-4 font-medium",children:"الحالة"}),ie.jsx("th",{className:"p-4 font-medium",children:"التقييم"}),ie.jsx("th",{className:"p-4 font-medium"})]})}),ie.jsx("tbody",{children:bK.map(e=>ie.jsxs("tr",{className:"border-b border-[#c5c1c1a6] hover:bg-gray-50 transition-colors",children:[ie.jsx("td",{className:"p-4 flex items-center gap-3",children:ie.jsx("span",{className:"text-[#272343]",children:e.name})}),ie.jsx("td",{className:"p-4 hidden text-[#272343] sm:table-cell",children:e.phone}),ie.jsx("td",{className:"p-4 hidden lg:table-cell",children:ie.jsx("span",{className:"px-2 py-1  bg-gray-100 rounded text-xs text-[#272343] font-medium",children:e.services})}),ie.jsx("td",{className:"p-4",children:ie.jsx(W_,{size:"20px",color:"#272343"})}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{onClick:()=>{},className:"text-gray-400 hover:text-gray-600",children:ie.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.status==="قبول"?"bg-green-100 text-green-600":e.status==="مراجعة"?"bg-yellow-100 text-yellow-600":e.status==="رفض"?"bg-red-100 text-red-600":""}`,children:e.status})})}),ie.jsx("td",{className:"p-2 text-yellow-500",children:"⭐".repeat(e.rating)}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{onClick:()=>{},className:"bg-blue-100 text-blue-600 rounded px-2 py-1 hover:bg-gray-400",children:"المزيد"})})]}))})]})})]})]})}function wK({title:e,titleId:t,...i},s){return me.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},i),e?me.createElement("title",{id:t},e):null,me.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const E1=me.forwardRef(wK);function TK({title:e,titleId:t,...i},s){return me.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},i),e?me.createElement("title",{id:t},e):null,me.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),me.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const A1=me.forwardRef(TK);function SK(){const[e,t]=me.useState(!1),[i,s]=me.useState(""),[f,y]=me.useState(""),T=jv(),o=async C=>{C.preventDefault();try{const M=await fetch("http://localhost:3000/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:i,password:f})}),I=await M.json();M.ok&&I.token?(alert("تم تسجيل الدخول بنجاح"),localStorage.setItem("token",I.token),T("/map")):alert(I.message||"رقم الجوال أو كلمة السر غير صحيحة")}catch(M){console.error(M),alert("حدث خطأ أثناء تسجيل الدخول")}};return ie.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-r from-yellow-90 via-yellow-100 to-white-200 px-4",children:ie.jsxs("div",{className:"relative bg-white/60 backdrop-blur-xl border border-white/70 rounded-3xl shadow-xl w-full max-w-md p-8 md:p-10",children:[ie.jsxs("div",{className:"flex flex-col justify-center items-center",children:[ie.jsx("img",{src:"/assets/logo-remove.png",alt:"logo",className:"w-30"}),ie.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-gray-800 text-center",children:"بصّار"})]}),ie.jsxs("form",{className:"space-y-4",onSubmit:o,children:[ie.jsxs("p",{className:"text-[#272343] text-center mt-1 mb-6 text-sm",children:[" ","لتكن على بصيرة"," "]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"رقم الجوال"}),ie.jsx("input",{type:"tel",placeholder:"+966",value:i,onChange:C=>s(C.target.value),className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",required:!0})]}),ie.jsxs("div",{className:"relative",children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"كلمة السر"}),ie.jsx("input",{type:e?"text":"password",placeholder:"",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl  focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",value:f,onChange:C=>y(C.target.value),required:!0}),ie.jsx("button",{type:"button",className:"absolute left-3 top-9 text-[#272343] hover:text-gray-700",onClick:()=>t(!e),children:e?ie.jsx(A1,{className:"w-5 h-5 cursor-pointer"}):ie.jsx(E1,{className:"w-5 h-5 cursor-pointer"})})]}),ie.jsx("button",{type:"submit",className:"w-full mt-5 bg-[#F8D203] hover:bg-[#f8d30381] text-[#272343] font-semibold py-2 rounded-xl transition cursor-pointer",children:"تسجيل الدخول"}),ie.jsxs("div",{className:"flex justify-center items-center",children:[ie.jsx("p",{className:"p-1 text-[#272343]",children:" لاتملك حساب ؟! "}),ie.jsxs(ss,{className:"underline text-[#272343]",to:"/signup",children:[" ","تسجيل"," "]})]})]})]})})}function vg({children:e,className:t=""}){return ie.jsx("div",{dir:"rtl",className:`bg-white rounded-xl shadow ${t}`,children:e})}function xg({children:e,className:t=""}){return ie.jsx("div",{className:`p-4 ${t}`,children:e})}function a5(e){var t,i,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var f=e.length;for(t=0;t<f;t++)e[t]&&(i=a5(e[t]))&&(s&&(s+=" "),s+=i)}else for(i in e)e[i]&&(s&&(s+=" "),s+=i);return s}function Ya(){for(var e,t,i=0,s="",f=arguments.length;i<f;i++)(e=arguments[i])&&(t=a5(e))&&(s&&(s+=" "),s+=t);return s}var YS={},KS={},Ez;function EK(){return Ez||(Ez=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i==="__proto__"}e.isUnsafeProperty=t}(KS)),KS}var JS={},Az;function s5(){return Az||(Az=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){switch(typeof i){case"number":case"symbol":return!1;case"string":return i.includes(".")||i.includes("[")||i.includes("]")}}e.isDeepKey=t}(JS)),JS}var QS={},Pz;function l5(){return Pz||(Pz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="string"||typeof i=="symbol"?i:Object.is(i?.valueOf?.(),-0)?"-0":String(i)}e.toKey=t}(QS)),QS}var eE={},Cz;function aM(){return Cz||(Cz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){const s=[],f=i.length;if(f===0)return s;let y=0,T="",o="",C=!1;for(i.charCodeAt(0)===46&&(s.push(""),y++);y<f;){const M=i[y];o?M==="\\"&&y+1<f?(y++,T+=i[y]):M===o?o="":T+=M:C?M==='"'||M==="'"?o=M:M==="]"?(C=!1,s.push(T),T=""):T+=M:M==="["?(C=!0,T&&(s.push(T),T="")):M==="."?T&&(s.push(T),T=""):T+=M,y++}return T&&s.push(T),s}e.toPath=t}(eE)),eE}var Mz;function sM(){return Mz||(Mz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EK(),i=s5(),s=l5(),f=aM();function y(o,C,M){if(o==null)return M;switch(typeof C){case"string":{if(t.isUnsafeProperty(C))return M;const I=o[C];return I===void 0?i.isDeepKey(C)?y(o,f.toPath(C),M):M:I}case"number":case"symbol":{typeof C=="number"&&(C=s.toKey(C));const I=o[C];return I===void 0?M:I}default:{if(Array.isArray(C))return T(o,C,M);if(Object.is(C?.valueOf(),-0)?C="-0":C=String(C),t.isUnsafeProperty(C))return M;const I=o[C];return I===void 0?M:I}}}function T(o,C,M){if(C.length===0)return M;let I=o;for(let j=0;j<C.length;j++){if(I==null||t.isUnsafeProperty(C[j]))return M;I=I[C[j]]}return I===void 0?M:I}e.get=y}(YS)),YS}var tE,Oz;function AK(){return Oz||(Oz=1,tE=sM().get),tE}var PK=AK();const ry=Zu(PK);var nE={exports:{}},Sa={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iz;function CK(){if(Iz)return Sa;Iz=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),T=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),q=Symbol.for("react.view_transition"),K=Symbol.for("react.client.reference");function J(te){if(typeof te=="object"&&te!==null){var oe=te.$$typeof;switch(oe){case e:switch(te=te.type,te){case i:case f:case s:case C:case M:case q:return te;default:switch(te=te&&te.$$typeof,te){case T:case o:case j:case I:return te;case y:return te;default:return oe}}case t:return oe}}}return Sa.ContextConsumer=y,Sa.ContextProvider=T,Sa.Element=e,Sa.ForwardRef=o,Sa.Fragment=i,Sa.Lazy=j,Sa.Memo=I,Sa.Portal=t,Sa.Profiler=f,Sa.StrictMode=s,Sa.Suspense=C,Sa.SuspenseList=M,Sa.isContextConsumer=function(te){return J(te)===y},Sa.isContextProvider=function(te){return J(te)===T},Sa.isElement=function(te){return typeof te=="object"&&te!==null&&te.$$typeof===e},Sa.isForwardRef=function(te){return J(te)===o},Sa.isFragment=function(te){return J(te)===i},Sa.isLazy=function(te){return J(te)===j},Sa.isMemo=function(te){return J(te)===I},Sa.isPortal=function(te){return J(te)===t},Sa.isProfiler=function(te){return J(te)===f},Sa.isStrictMode=function(te){return J(te)===s},Sa.isSuspense=function(te){return J(te)===C},Sa.isSuspenseList=function(te){return J(te)===M},Sa.isValidElementType=function(te){return typeof te=="string"||typeof te=="function"||te===i||te===f||te===s||te===C||te===M||typeof te=="object"&&te!==null&&(te.$$typeof===j||te.$$typeof===I||te.$$typeof===T||te.$$typeof===y||te.$$typeof===o||te.$$typeof===K||te.getModuleId!==void 0)},Sa.typeOf=J,Sa}var Dz;function MK(){return Dz||(Dz=1,nE.exports=CK()),nE.exports}var OK=MK(),Vu=e=>e===0?0:e>0?1:-1,Th=e=>typeof e=="number"&&e!=+e,V_=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Hi=e=>(typeof e=="number"||e instanceof Number)&&!Th(e),up=e=>Hi(e)||typeof e=="string",IK=0,kx=e=>{var t=++IK;return"".concat(e||"").concat(t)},ff=function(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Hi(t)&&typeof t!="string")return s;var y;if(V_(t)){if(i==null)return s;var T=t.indexOf("%");y=i*parseFloat(t.slice(0,T))/100}else y=+t;return Th(y)&&(y=s),f&&i!=null&&y>i&&(y=i),y},c5=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,i={},s=0;s<t;s++)if(!i[e[s]])i[e[s]]=!0;else return!0;return!1},cv=(e,t)=>Hi(e)&&Hi(t)?i=>e+i*(t-e):()=>t;function DK(e,t,i){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):ry(s,t))===i)}var vl=e=>e===null||typeof e>"u",ob=e=>vl(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),RK=["viewBox","children"],LK=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Rz=["points","pathLength"],iE={svg:RK,polygon:Rz,polyline:Rz},lM=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],zK=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(me.isValidElement(e)&&(i=e.props),typeof i!="object"&&typeof i!="function")return null;var s={};return Object.keys(i).forEach(f=>{lM.includes(f)&&(s[f]=y=>i[f](i,y))}),s},kK=(e,t,i)=>s=>(e(t,i,s),null),MT=(e,t,i)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(f=>{var y=e[f];lM.includes(f)&&typeof y=="function"&&(s||(s={}),s[f]=kK(y,t,i))}),s},Lz=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",zz=null,rE=null,u5=e=>{if(e===zz&&Array.isArray(rE))return rE;var t=[];return me.Children.forEach(e,i=>{vl(i)||(OK.isFragment(i)?t=t.concat(u5(i.props.children)):t.push(i))}),rE=t,zz=e,t};function cM(e,t){var i=[],s=[];return Array.isArray(t)?s=t.map(f=>Lz(f)):s=[Lz(t)],u5(e).forEach(f=>{var y=ry(f,"type.displayName")||ry(f,"type.name");s.indexOf(y)!==-1&&i.push(f)}),i}var NK=(e,t,i,s)=>{var f,y=(f=s&&iE?.[s])!==null&&f!==void 0?f:[];return t.startsWith("data-")||typeof e!="function"&&(s&&y.includes(t)||LK.includes(t))||i&&lM.includes(t)},gs=(e,t,i)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var s=e;if(me.isValidElement(e)&&(s=e.props),typeof s!="object"&&typeof s!="function")return null;var f={};return Object.keys(s).forEach(y=>{var T;NK((T=s)===null||T===void 0?void 0:T[y],y,t,i)&&(f[y]=s[y])}),f},BK=["children","width","height","viewBox","className","style","title","desc"];function sP(){return sP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},sP.apply(null,arguments)}function jK(e,t){if(e==null)return{};var i,s,f=FK(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function FK(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var uM=me.forwardRef((e,t)=>{var{children:i,width:s,height:f,viewBox:y,className:T,style:o,title:C,desc:M}=e,I=jK(e,BK),j=y||{width:s,height:f,x:0,y:0},q=Ya("recharts-surface",T);return me.createElement("svg",sP({},gs(I,!0,"svg"),{className:q,width:s,height:f,style:o,viewBox:"".concat(j.x," ").concat(j.y," ").concat(j.width," ").concat(j.height),ref:t}),me.createElement("title",null,C),me.createElement("desc",null,M),i)}),UK=["children","className"];function lP(){return lP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},lP.apply(null,arguments)}function VK(e,t){if(e==null)return{};var i,s,f=$K(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function $K(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var hp=me.forwardRef((e,t)=>{var{children:i,className:s}=e,f=VK(e,UK),y=Ya("recharts-layer",s);return me.createElement("g",lP({className:y},gs(f,!0),{ref:t}),i)}),h5=me.createContext(null),qK=()=>me.useContext(h5);function Xa(e){return function(){return e}}const d5=Math.cos,P1=Math.sin,mf=Math.sqrt,C1=Math.PI,OT=2*C1,cP=Math.PI,uP=2*cP,z_=1e-6,HK=uP-z_;function f5(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function GK(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return f5;const i=10**t;return function(s){this._+=s[0];for(let f=1,y=s.length;f<y;++f)this._+=Math.round(arguments[f]*i)/i+s[f]}}class ZK{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?f5:GK(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,s,f){this._append`Q${+t},${+i},${this._x1=+s},${this._y1=+f}`}bezierCurveTo(t,i,s,f,y,T){this._append`C${+t},${+i},${+s},${+f},${this._x1=+y},${this._y1=+T}`}arcTo(t,i,s,f,y){if(t=+t,i=+i,s=+s,f=+f,y=+y,y<0)throw new Error(`negative radius: ${y}`);let T=this._x1,o=this._y1,C=s-t,M=f-i,I=T-t,j=o-i,q=I*I+j*j;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(q>z_)if(!(Math.abs(j*C-M*I)>z_)||!y)this._append`L${this._x1=t},${this._y1=i}`;else{let K=s-T,J=f-o,te=C*C+M*M,oe=K*K+J*J,ce=Math.sqrt(te),de=Math.sqrt(q),ue=y*Math.tan((cP-Math.acos((te+q-oe)/(2*ce*de)))/2),Pe=ue/de,Oe=ue/ce;Math.abs(Pe-1)>z_&&this._append`L${t+Pe*I},${i+Pe*j}`,this._append`A${y},${y},0,0,${+(j*K>I*J)},${this._x1=t+Oe*C},${this._y1=i+Oe*M}`}}arc(t,i,s,f,y,T){if(t=+t,i=+i,s=+s,T=!!T,s<0)throw new Error(`negative radius: ${s}`);let o=s*Math.cos(f),C=s*Math.sin(f),M=t+o,I=i+C,j=1^T,q=T?f-y:y-f;this._x1===null?this._append`M${M},${I}`:(Math.abs(this._x1-M)>z_||Math.abs(this._y1-I)>z_)&&this._append`L${M},${I}`,s&&(q<0&&(q=q%uP+uP),q>HK?this._append`A${s},${s},0,1,${j},${t-o},${i-C}A${s},${s},0,1,${j},${this._x1=M},${this._y1=I}`:q>z_&&this._append`A${s},${s},0,${+(q>=cP)},${j},${this._x1=t+s*Math.cos(y)},${this._y1=i+s*Math.sin(y)}`)}rect(t,i,s,f){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${s=+s}v${+f}h${-s}Z`}toString(){return this._}}function hM(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);t=s}return e},()=>new ZK(t)}function dM(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function p5(e){this._context=e}p5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function IT(e){return new p5(e)}function m5(e){return e[0]}function g5(e){return e[1]}function _5(e,t){var i=Xa(!0),s=null,f=IT,y=null,T=hM(o);e=typeof e=="function"?e:e===void 0?m5:Xa(e),t=typeof t=="function"?t:t===void 0?g5:Xa(t);function o(C){var M,I=(C=dM(C)).length,j,q=!1,K;for(s==null&&(y=f(K=T())),M=0;M<=I;++M)!(M<I&&i(j=C[M],M,C))===q&&((q=!q)?y.lineStart():y.lineEnd()),q&&y.point(+e(j,M,C),+t(j,M,C));if(K)return y=null,K+""||null}return o.x=function(C){return arguments.length?(e=typeof C=="function"?C:Xa(+C),o):e},o.y=function(C){return arguments.length?(t=typeof C=="function"?C:Xa(+C),o):t},o.defined=function(C){return arguments.length?(i=typeof C=="function"?C:Xa(!!C),o):i},o.curve=function(C){return arguments.length?(f=C,s!=null&&(y=f(s)),o):f},o.context=function(C){return arguments.length?(C==null?s=y=null:y=f(s=C),o):s},o}function Uw(e,t,i){var s=null,f=Xa(!0),y=null,T=IT,o=null,C=hM(M);e=typeof e=="function"?e:e===void 0?m5:Xa(+e),t=typeof t=="function"?t:Xa(t===void 0?0:+t),i=typeof i=="function"?i:i===void 0?g5:Xa(+i);function M(j){var q,K,J,te=(j=dM(j)).length,oe,ce=!1,de,ue=new Array(te),Pe=new Array(te);for(y==null&&(o=T(de=C())),q=0;q<=te;++q){if(!(q<te&&f(oe=j[q],q,j))===ce)if(ce=!ce)K=q,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),J=q-1;J>=K;--J)o.point(ue[J],Pe[J]);o.lineEnd(),o.areaEnd()}ce&&(ue[q]=+e(oe,q,j),Pe[q]=+t(oe,q,j),o.point(s?+s(oe,q,j):ue[q],i?+i(oe,q,j):Pe[q]))}if(de)return o=null,de+""||null}function I(){return _5().defined(f).curve(T).context(y)}return M.x=function(j){return arguments.length?(e=typeof j=="function"?j:Xa(+j),s=null,M):e},M.x0=function(j){return arguments.length?(e=typeof j=="function"?j:Xa(+j),M):e},M.x1=function(j){return arguments.length?(s=j==null?null:typeof j=="function"?j:Xa(+j),M):s},M.y=function(j){return arguments.length?(t=typeof j=="function"?j:Xa(+j),i=null,M):t},M.y0=function(j){return arguments.length?(t=typeof j=="function"?j:Xa(+j),M):t},M.y1=function(j){return arguments.length?(i=j==null?null:typeof j=="function"?j:Xa(+j),M):i},M.lineX0=M.lineY0=function(){return I().x(e).y(t)},M.lineY1=function(){return I().x(e).y(i)},M.lineX1=function(){return I().x(s).y(t)},M.defined=function(j){return arguments.length?(f=typeof j=="function"?j:Xa(!!j),M):f},M.curve=function(j){return arguments.length?(T=j,y!=null&&(o=T(y)),M):T},M.context=function(j){return arguments.length?(j==null?y=o=null:o=T(y=j),M):y},M}class y5{constructor(t,i){this._context=t,this._x=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,i){switch(t=+t,i=+i,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,i,t,i):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+i)/2,t,this._y0,t,i);break}}this._x0=t,this._y0=i}}function WK(e){return new y5(e,!0)}function XK(e){return new y5(e,!1)}const fM={draw(e,t){const i=mf(t/C1);e.moveTo(i,0),e.arc(0,0,i,0,OT)}},YK={draw(e,t){const i=mf(t/5)/2;e.moveTo(-3*i,-i),e.lineTo(-i,-i),e.lineTo(-i,-3*i),e.lineTo(i,-3*i),e.lineTo(i,-i),e.lineTo(3*i,-i),e.lineTo(3*i,i),e.lineTo(i,i),e.lineTo(i,3*i),e.lineTo(-i,3*i),e.lineTo(-i,i),e.lineTo(-3*i,i),e.closePath()}},v5=mf(1/3),KK=v5*2,JK={draw(e,t){const i=mf(t/KK),s=i*v5;e.moveTo(0,-i),e.lineTo(s,0),e.lineTo(0,i),e.lineTo(-s,0),e.closePath()}},QK={draw(e,t){const i=mf(t),s=-i/2;e.rect(s,s,i,i)}},eJ=.8908130915292852,x5=P1(C1/10)/P1(7*C1/10),tJ=P1(OT/10)*x5,nJ=-d5(OT/10)*x5,iJ={draw(e,t){const i=mf(t*eJ),s=tJ*i,f=nJ*i;e.moveTo(0,-i),e.lineTo(s,f);for(let y=1;y<5;++y){const T=OT*y/5,o=d5(T),C=P1(T);e.lineTo(C*i,-o*i),e.lineTo(o*s-C*f,C*s+o*f)}e.closePath()}},oE=mf(3),rJ={draw(e,t){const i=-mf(t/(oE*3));e.moveTo(0,i*2),e.lineTo(-oE*i,-i),e.lineTo(oE*i,-i),e.closePath()}},ld=-.5,cd=mf(3)/2,hP=1/mf(12),oJ=(hP/2+1)*3,aJ={draw(e,t){const i=mf(t/oJ),s=i/2,f=i*hP,y=s,T=i*hP+i,o=-y,C=T;e.moveTo(s,f),e.lineTo(y,T),e.lineTo(o,C),e.lineTo(ld*s-cd*f,cd*s+ld*f),e.lineTo(ld*y-cd*T,cd*y+ld*T),e.lineTo(ld*o-cd*C,cd*o+ld*C),e.lineTo(ld*s+cd*f,ld*f-cd*s),e.lineTo(ld*y+cd*T,ld*T-cd*y),e.lineTo(ld*o+cd*C,ld*C-cd*o),e.closePath()}};function sJ(e,t){let i=null,s=hM(f);e=typeof e=="function"?e:Xa(e||fM),t=typeof t=="function"?t:Xa(t===void 0?64:+t);function f(){let y;if(i||(i=y=s()),e.apply(this,arguments).draw(i,+t.apply(this,arguments)),y)return i=null,y+""||null}return f.type=function(y){return arguments.length?(e=typeof y=="function"?y:Xa(y),f):e},f.size=function(y){return arguments.length?(t=typeof y=="function"?y:Xa(+y),f):t},f.context=function(y){return arguments.length?(i=y??null,f):i},f}function M1(){}function O1(e,t,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+i)/6)}function b5(e){this._context=e}b5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:O1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:O1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lJ(e){return new b5(e)}function w5(e){this._context=e}w5.prototype={areaStart:M1,areaEnd:M1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:O1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cJ(e){return new w5(e)}function T5(e){this._context=e}T5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(i,s):this._context.moveTo(i,s);break;case 3:this._point=4;default:O1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uJ(e){return new T5(e)}function S5(e){this._context=e}S5.prototype={areaStart:M1,areaEnd:M1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function hJ(e){return new S5(e)}function kz(e){return e<0?-1:1}function Nz(e,t,i){var s=e._x1-e._x0,f=t-e._x1,y=(e._y1-e._y0)/(s||f<0&&-0),T=(i-e._y1)/(f||s<0&&-0),o=(y*f+T*s)/(s+f);return(kz(y)+kz(T))*Math.min(Math.abs(y),Math.abs(T),.5*Math.abs(o))||0}function Bz(e,t){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function aE(e,t,i){var s=e._x0,f=e._y0,y=e._x1,T=e._y1,o=(y-s)/3;e._context.bezierCurveTo(s+o,f+o*t,y-o,T-o*i,y,T)}function I1(e){this._context=e}I1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:aE(this,this._t0,Bz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var i=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,aE(this,Bz(this,i=Nz(this,e,t)),i);break;default:aE(this,this._t0,i=Nz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}};function E5(e){this._context=new A5(e)}(E5.prototype=Object.create(I1.prototype)).point=function(e,t){I1.prototype.point.call(this,t,e)};function A5(e){this._context=e}A5.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,i,s,f,y){this._context.bezierCurveTo(t,e,s,i,y,f)}};function dJ(e){return new I1(e)}function fJ(e){return new E5(e)}function P5(e){this._context=e}P5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,i=e.length;if(i)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),i===2)this._context.lineTo(e[1],t[1]);else for(var s=jz(e),f=jz(t),y=0,T=1;T<i;++y,++T)this._context.bezierCurveTo(s[0][y],f[0][y],s[1][y],f[1][y],e[T],t[T]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function jz(e){var t,i=e.length-1,s,f=new Array(i),y=new Array(i),T=new Array(i);for(f[0]=0,y[0]=2,T[0]=e[0]+2*e[1],t=1;t<i-1;++t)f[t]=1,y[t]=4,T[t]=4*e[t]+2*e[t+1];for(f[i-1]=2,y[i-1]=7,T[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)s=f[t]/y[t-1],y[t]-=s,T[t]-=s*T[t-1];for(f[i-1]=T[i-1]/y[i-1],t=i-2;t>=0;--t)f[t]=(T[t]-f[t+1])/y[t];for(y[i-1]=(e[i]+f[i-1])/2,t=0;t<i-1;++t)y[t]=2*e[t+1]-f[t+1];return[f,y]}function pJ(e){return new P5(e)}function DT(e,t){this._context=e,this._t=t}DT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,t)}break}}this._x=e,this._y=t}};function mJ(e){return new DT(e,.5)}function gJ(e){return new DT(e,0)}function _J(e){return new DT(e,1)}function Pv(e,t){if((T=e.length)>1)for(var i=1,s,f,y=e[t[0]],T,o=y.length;i<T;++i)for(f=y,y=e[t[i]],s=0;s<o;++s)y[s][1]+=y[s][0]=isNaN(f[s][1])?f[s][0]:f[s][1]}function dP(e){for(var t=e.length,i=new Array(t);--t>=0;)i[t]=t;return i}function yJ(e,t){return e[t]}function vJ(e){const t=[];return t.key=e,t}function xJ(){var e=Xa([]),t=dP,i=Pv,s=yJ;function f(y){var T=Array.from(e.apply(this,arguments),vJ),o,C=T.length,M=-1,I;for(const j of y)for(o=0,++M;o<C;++o)(T[o][M]=[0,+s(j,T[o].key,M,y)]).data=j;for(o=0,I=dM(t(T));o<C;++o)T[I[o]].index=o;return i(T,I),T}return f.keys=function(y){return arguments.length?(e=typeof y=="function"?y:Xa(Array.from(y)),f):e},f.value=function(y){return arguments.length?(s=typeof y=="function"?y:Xa(+y),f):s},f.order=function(y){return arguments.length?(t=y==null?dP:typeof y=="function"?y:Xa(Array.from(y)),f):t},f.offset=function(y){return arguments.length?(i=y??Pv,f):i},f}function bJ(e,t){if((s=e.length)>0){for(var i,s,f=0,y=e[0].length,T;f<y;++f){for(T=i=0;i<s;++i)T+=e[i][f][1]||0;if(T)for(i=0;i<s;++i)e[i][f][1]/=T}Pv(e,t)}}function wJ(e,t){if((f=e.length)>0){for(var i=0,s=e[t[0]],f,y=s.length;i<y;++i){for(var T=0,o=0;T<f;++T)o+=e[T][i][1]||0;s[i][1]+=s[i][0]=-o/2}Pv(e,t)}}function TJ(e,t){if(!(!((T=e.length)>0)||!((y=(f=e[t[0]]).length)>0))){for(var i=0,s=1,f,y,T;s<y;++s){for(var o=0,C=0,M=0;o<T;++o){for(var I=e[t[o]],j=I[s][1]||0,q=I[s-1][1]||0,K=(j-q)/2,J=0;J<o;++J){var te=e[t[J]],oe=te[s][1]||0,ce=te[s-1][1]||0;K+=oe-ce}C+=j,M+=K*j}f[s-1][1]+=f[s-1][0]=i,C&&(i-=M/C)}f[s-1][1]+=f[s-1][0]=i,Pv(e,t)}}var SJ=["type","size","sizeType"];function fP(){return fP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},fP.apply(null,arguments)}function Fz(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Uz(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Fz(Object(i),!0).forEach(function(s){EJ(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Fz(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function EJ(e,t,i){return(t=AJ(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function AJ(e){var t=PJ(e,"string");return typeof t=="symbol"?t:t+""}function PJ(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CJ(e,t){if(e==null)return{};var i,s,f=MJ(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function MJ(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var C5={symbolCircle:fM,symbolCross:YK,symbolDiamond:JK,symbolSquare:QK,symbolStar:iJ,symbolTriangle:rJ,symbolWye:aJ},OJ=Math.PI/180,IJ=e=>{var t="symbol".concat(ob(e));return C5[t]||fM},DJ=(e,t,i)=>{if(t==="area")return e;switch(i){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*OJ;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},RJ=(e,t)=>{C5["symbol".concat(ob(e))]=t},pM=e=>{var{type:t="circle",size:i=64,sizeType:s="area"}=e,f=CJ(e,SJ),y=Uz(Uz({},f),{},{type:t,size:i,sizeType:s}),T=()=>{var j=IJ(t),q=sJ().type(j).size(DJ(i,s,t));return q()},{className:o,cx:C,cy:M}=y,I=gs(y,!0);return C===+C&&M===+M&&i===+i?me.createElement("path",fP({},I,{className:Ya("recharts-symbols",o),transform:"translate(".concat(C,", ").concat(M,")"),d:T()})):null};pM.registerSymbol=RJ;function pP(){return pP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},pP.apply(null,arguments)}function Vz(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function LJ(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Vz(Object(i),!0).forEach(function(s){mM(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Vz(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function mM(e,t,i){return(t=zJ(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function zJ(e){var t=kJ(e,"string");return typeof t=="symbol"?t:t+""}function kJ(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ud=32;class gM extends me.PureComponent{renderIcon(t,i){var{inactiveColor:s}=this.props,f=ud/2,y=ud/6,T=ud/3,o=t.inactive?s:t.color,C=i??t.type;if(C==="none")return null;if(C==="plainline")return me.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:f,x2:ud,y2:f,className:"recharts-legend-icon"});if(C==="line")return me.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(f,"h").concat(T,`
            A`).concat(y,",").concat(y,",0,1,1,").concat(2*T,",").concat(f,`
            H`).concat(ud,"M").concat(2*T,",").concat(f,`
            A`).concat(y,",").concat(y,",0,1,1,").concat(T,",").concat(f),className:"recharts-legend-icon"});if(C==="rect")return me.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(ud/8,"h").concat(ud,"v").concat(ud*3/4,"h").concat(-ud,"z"),className:"recharts-legend-icon"});if(me.isValidElement(t.legendIcon)){var M=LJ({},t);return delete M.legendIcon,me.cloneElement(t.legendIcon,M)}return me.createElement(pM,{fill:o,cx:f,cy:f,size:ud,sizeType:"diameter",type:C})}renderItems(){var{payload:t,iconSize:i,layout:s,formatter:f,inactiveColor:y,iconType:T}=this.props,o={x:0,y:0,width:ud,height:ud},C={display:s==="horizontal"?"inline-block":"block",marginRight:10},M={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((I,j)=>{var q=I.formatter||f,K=Ya({"recharts-legend-item":!0,["legend-item-".concat(j)]:!0,inactive:I.inactive});if(I.type==="none")return null;var J=I.inactive?y:I.color,te=q?q(I.value,I,j):I.value;return me.createElement("li",pP({className:K,style:C,key:"legend-item-".concat(j)},MT(this.props,I,j)),me.createElement(uM,{width:i,height:i,viewBox:o,style:M,"aria-label":"".concat(te," legend icon")},this.renderIcon(I,T)),me.createElement("span",{className:"recharts-legend-item-text",style:{color:J}},te))})}render(){var{payload:t,layout:i,align:s}=this.props;if(!t||!t.length)return null;var f={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return me.createElement("ul",{className:"recharts-default-legend",style:f},this.renderItems())}}mM(gM,"displayName","Legend");mM(gM,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var sE={},lE={},$z;function NJ(){return $z||($z=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,s){const f=new Map;for(let y=0;y<i.length;y++){const T=i[y],o=s(T);f.has(o)||f.set(o,T)}return Array.from(f.values())}e.uniqBy=t}(lE)),lE}var cE={},qz;function M5(){return qz||(qz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i}e.identity=t}(cE)),cE}var uE={},hE={},dE={},Hz;function BJ(){return Hz||(Hz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return Number.isSafeInteger(i)&&i>=0}e.isLength=t}(dE)),dE}var Gz;function _M(){return Gz||(Gz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BJ();function i(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=i}(hE)),hE}var fE={},Zz;function jJ(){return Zz||(Zz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="object"&&i!==null}e.isObjectLike=t}(fE)),fE}var Wz;function FJ(){return Wz||(Wz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_M(),i=jJ();function s(f){return i.isObjectLike(f)&&t.isArrayLike(f)}e.isArrayLikeObject=s}(uE)),uE}var pE={},mE={},Xz;function UJ(){return Xz||(Xz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sM();function i(s){return function(f){return t.get(f,s)}}e.property=i}(mE)),mE}var gE={},_E={},yE={},vE={},Yz;function O5(){return Yz||(Yz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i!==null&&(typeof i=="object"||typeof i=="function")}e.isObject=t}(vE)),vE}var xE={},Kz;function I5(){return Kz||(Kz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i==null||typeof i!="object"&&typeof i!="function"}e.isPrimitive=t}(xE)),xE}var bE={},Jz;function yM(){return Jz||(Jz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,s){return i===s||Number.isNaN(i)&&Number.isNaN(s)}e.eq=t}(bE)),bE}var Qz;function VJ(){return Qz||(Qz=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vM(),i=O5(),s=I5(),f=yM();function y(j,q,K){return typeof K!="function"?t.isMatch(j,q):T(j,q,function J(te,oe,ce,de,ue,Pe){const Oe=K(te,oe,ce,de,ue,Pe);return Oe!==void 0?!!Oe:T(te,oe,J,Pe)},new Map)}function T(j,q,K,J){if(q===j)return!0;switch(typeof q){case"object":return o(j,q,K,J);case"function":return Object.keys(q).length>0?T(j,{...q},K,J):f.eq(j,q);default:return i.isObject(j)?typeof q=="string"?q==="":!0:f.eq(j,q)}}function o(j,q,K,J){if(q==null)return!0;if(Array.isArray(q))return M(j,q,K,J);if(q instanceof Map)return C(j,q,K,J);if(q instanceof Set)return I(j,q,K,J);const te=Object.keys(q);if(j==null)return te.length===0;if(te.length===0)return!0;if(J&&J.has(q))return J.get(q)===j;J&&J.set(q,j);try{for(let oe=0;oe<te.length;oe++){const ce=te[oe];if(!s.isPrimitive(j)&&!(ce in j)||q[ce]===void 0&&j[ce]!==void 0||q[ce]===null&&j[ce]!==null||!K(j[ce],q[ce],ce,j,q,J))return!1}return!0}finally{J&&J.delete(q)}}function C(j,q,K,J){if(q.size===0)return!0;if(!(j instanceof Map))return!1;for(const[te,oe]of q.entries()){const ce=j.get(te);if(K(ce,oe,te,j,q,J)===!1)return!1}return!0}function M(j,q,K,J){if(q.length===0)return!0;if(!Array.isArray(j))return!1;const te=new Set;for(let oe=0;oe<q.length;oe++){const ce=q[oe];let de=!1;for(let ue=0;ue<j.length;ue++){if(te.has(ue))continue;const Pe=j[ue];let Oe=!1;if(K(Pe,ce,oe,j,q,J)&&(Oe=!0),Oe){te.add(ue),de=!0;break}}if(!de)return!1}return!0}function I(j,q,K,J){return q.size===0?!0:j instanceof Set?M([...j],[...q],K,J):!1}e.isMatchWith=y,e.isSetMatch=I}(yE)),yE}var ek;function vM(){return ek||(ek=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VJ();function i(s,f){return t.isMatchWith(s,f,()=>{})}e.isMatch=i}(_E)),_E}var wE={},TE={},SE={},tk;function D5(){return tk||(tk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return Object.getOwnPropertySymbols(i).filter(s=>Object.prototype.propertyIsEnumerable.call(i,s))}e.getSymbols=t}(SE)),SE}var EE={},nk;function xM(){return nk||(nk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}e.getTag=t}(EE)),EE}var AE={},ik;function bM(){return ik||(ik=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",i="[object String]",s="[object Number]",f="[object Boolean]",y="[object Arguments]",T="[object Symbol]",o="[object Date]",C="[object Map]",M="[object Set]",I="[object Array]",j="[object Function]",q="[object ArrayBuffer]",K="[object Object]",J="[object Error]",te="[object DataView]",oe="[object Uint8Array]",ce="[object Uint8ClampedArray]",de="[object Uint16Array]",ue="[object Uint32Array]",Pe="[object BigUint64Array]",Oe="[object Int8Array]",xe="[object Int16Array]",Qe="[object Int32Array]",tt="[object BigInt64Array]",Ge="[object Float32Array]",Je="[object Float64Array]";e.argumentsTag=y,e.arrayBufferTag=q,e.arrayTag=I,e.bigInt64ArrayTag=tt,e.bigUint64ArrayTag=Pe,e.booleanTag=f,e.dataViewTag=te,e.dateTag=o,e.errorTag=J,e.float32ArrayTag=Ge,e.float64ArrayTag=Je,e.functionTag=j,e.int16ArrayTag=xe,e.int32ArrayTag=Qe,e.int8ArrayTag=Oe,e.mapTag=C,e.numberTag=s,e.objectTag=K,e.regexpTag=t,e.setTag=M,e.stringTag=i,e.symbolTag=T,e.uint16ArrayTag=de,e.uint32ArrayTag=ue,e.uint8ArrayTag=oe,e.uint8ClampedArrayTag=ce}(AE)),AE}var PE={},rk;function $J(){return rk||(rk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}e.isTypedArray=t}(PE)),PE}var ok;function R5(){return ok||(ok=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D5(),i=xM(),s=bM(),f=I5(),y=$J();function T(I,j){return o(I,void 0,I,new Map,j)}function o(I,j,q,K=new Map,J=void 0){const te=J?.(I,j,q,K);if(te!=null)return te;if(f.isPrimitive(I))return I;if(K.has(I))return K.get(I);if(Array.isArray(I)){const oe=new Array(I.length);K.set(I,oe);for(let ce=0;ce<I.length;ce++)oe[ce]=o(I[ce],ce,q,K,J);return Object.hasOwn(I,"index")&&(oe.index=I.index),Object.hasOwn(I,"input")&&(oe.input=I.input),oe}if(I instanceof Date)return new Date(I.getTime());if(I instanceof RegExp){const oe=new RegExp(I.source,I.flags);return oe.lastIndex=I.lastIndex,oe}if(I instanceof Map){const oe=new Map;K.set(I,oe);for(const[ce,de]of I)oe.set(ce,o(de,ce,q,K,J));return oe}if(I instanceof Set){const oe=new Set;K.set(I,oe);for(const ce of I)oe.add(o(ce,void 0,q,K,J));return oe}if(typeof Buffer<"u"&&Buffer.isBuffer(I))return I.subarray();if(y.isTypedArray(I)){const oe=new(Object.getPrototypeOf(I)).constructor(I.length);K.set(I,oe);for(let ce=0;ce<I.length;ce++)oe[ce]=o(I[ce],ce,q,K,J);return oe}if(I instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&I instanceof SharedArrayBuffer)return I.slice(0);if(I instanceof DataView){const oe=new DataView(I.buffer.slice(0),I.byteOffset,I.byteLength);return K.set(I,oe),C(oe,I,q,K,J),oe}if(typeof File<"u"&&I instanceof File){const oe=new File([I],I.name,{type:I.type});return K.set(I,oe),C(oe,I,q,K,J),oe}if(I instanceof Blob){const oe=new Blob([I],{type:I.type});return K.set(I,oe),C(oe,I,q,K,J),oe}if(I instanceof Error){const oe=new I.constructor;return K.set(I,oe),oe.message=I.message,oe.name=I.name,oe.stack=I.stack,oe.cause=I.cause,C(oe,I,q,K,J),oe}if(typeof I=="object"&&M(I)){const oe=Object.create(Object.getPrototypeOf(I));return K.set(I,oe),C(oe,I,q,K,J),oe}return I}function C(I,j,q=I,K,J){const te=[...Object.keys(j),...t.getSymbols(j)];for(let oe=0;oe<te.length;oe++){const ce=te[oe],de=Object.getOwnPropertyDescriptor(I,ce);(de==null||de.writable)&&(I[ce]=o(j[ce],ce,q,K,J))}}function M(I){switch(i.getTag(I)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=T,e.cloneDeepWithImpl=o,e.copyProperties=C}(TE)),TE}var ak;function qJ(){return ak||(ak=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R5();function i(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=i}(wE)),wE}var sk;function HJ(){return sk||(sk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vM(),i=qJ();function s(f){return f=i.cloneDeep(f),y=>t.isMatch(y,f)}e.matches=s}(gE)),gE}var CE={},ME={},OE={},lk;function GJ(){return lk||(lk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R5(),i=bM();function s(f,y){return t.cloneDeepWith(f,(T,o,C,M)=>{const I=y?.(T,o,C,M);if(I!=null)return I;if(typeof f=="object")switch(Object.prototype.toString.call(f)){case i.numberTag:case i.stringTag:case i.booleanTag:{const j=new f.constructor(f?.valueOf());return t.copyProperties(j,f),j}case i.argumentsTag:{const j={};return t.copyProperties(j,f),j.length=f.length,j[Symbol.iterator]=f[Symbol.iterator],j}default:return}})}e.cloneDeepWith=s}(OE)),OE}var ck;function ZJ(){return ck||(ck=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GJ();function i(s){return t.cloneDeepWith(s)}e.cloneDeep=i}(ME)),ME}var IE={},DE={},uk;function L5(){return uk||(uk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function i(s,f=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<f;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=i}(DE)),DE}var RE={},hk;function WJ(){return hk||(hk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xM();function i(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=i}(RE)),RE}var dk;function XJ(){return dk||(dk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=s5(),i=L5(),s=WJ(),f=aM();function y(T,o){let C;if(Array.isArray(o)?C=o:typeof o=="string"&&t.isDeepKey(o)&&T?.[o]==null?C=f.toPath(o):C=[o],C.length===0)return!1;let M=T;for(let I=0;I<C.length;I++){const j=C[I];if((M==null||!Object.hasOwn(M,j))&&!((Array.isArray(M)||s.isArguments(M))&&i.isIndex(j)&&j<M.length))return!1;M=M[j]}return!0}e.has=y}(IE)),IE}var fk;function YJ(){return fk||(fk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vM(),i=l5(),s=ZJ(),f=sM(),y=XJ();function T(o,C){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=i.toKey(o);break}}return C=s.cloneDeep(C),function(M){const I=f.get(M,o);return I===void 0?y.has(M,o):C===void 0?I===void 0:t.isMatch(I,C)}}e.matchesProperty=T}(CE)),CE}var pk;function KJ(){return pk||(pk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M5(),i=UJ(),s=HJ(),f=YJ();function y(T){if(T==null)return t.identity;switch(typeof T){case"function":return T;case"object":return Array.isArray(T)&&T.length===2?f.matchesProperty(T[0],T[1]):s.matches(T);case"string":case"symbol":case"number":return i.property(T)}}e.iteratee=y}(pE)),pE}var mk;function JJ(){return mk||(mk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NJ(),i=M5(),s=FJ(),f=KJ();function y(T,o=i.identity){return s.isArrayLikeObject(T)?t.uniqBy(Array.from(T),f.iteratee(o)):[]}e.uniqBy=y}(sE)),sE}var LE,gk;function QJ(){return gk||(gk=1,LE=JJ().uniqBy),LE}var eQ=QJ();const _k=Zu(eQ);function z5(e,t,i){return t===!0?_k(e,i):typeof t=="function"?_k(e,t):e}var zE={exports:{}},kE={},NE={exports:{}},BE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yk;function tQ(){if(yk)return BE;yk=1;var e=Bv();function t(j,q){return j===q&&(j!==0||1/j===1/q)||j!==j&&q!==q}var i=typeof Object.is=="function"?Object.is:t,s=e.useState,f=e.useEffect,y=e.useLayoutEffect,T=e.useDebugValue;function o(j,q){var K=q(),J=s({inst:{value:K,getSnapshot:q}}),te=J[0].inst,oe=J[1];return y(function(){te.value=K,te.getSnapshot=q,C(te)&&oe({inst:te})},[j,K,q]),f(function(){return C(te)&&oe({inst:te}),j(function(){C(te)&&oe({inst:te})})},[j]),T(K),K}function C(j){var q=j.getSnapshot;j=j.value;try{var K=q();return!i(j,K)}catch{return!0}}function M(j,q){return q()}var I=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?M:o;return BE.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:I,BE}var vk;function nQ(){return vk||(vk=1,NE.exports=tQ()),NE.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xk;function iQ(){if(xk)return kE;xk=1;var e=Bv(),t=nQ();function i(M,I){return M===I&&(M!==0||1/M===1/I)||M!==M&&I!==I}var s=typeof Object.is=="function"?Object.is:i,f=t.useSyncExternalStore,y=e.useRef,T=e.useEffect,o=e.useMemo,C=e.useDebugValue;return kE.useSyncExternalStoreWithSelector=function(M,I,j,q,K){var J=y(null);if(J.current===null){var te={hasValue:!1,value:null};J.current=te}else te=J.current;J=o(function(){function ce(xe){if(!de){if(de=!0,ue=xe,xe=q(xe),K!==void 0&&te.hasValue){var Qe=te.value;if(K(Qe,xe))return Pe=Qe}return Pe=xe}if(Qe=Pe,s(ue,xe))return Qe;var tt=q(xe);return K!==void 0&&K(Qe,tt)?(ue=xe,Qe):(ue=xe,Pe=tt)}var de=!1,ue,Pe,Oe=j===void 0?null:j;return[function(){return ce(I())},Oe===null?void 0:function(){return ce(Oe())}]},[I,j,q,K]);var oe=f(M,J[0],J[1]);return T(function(){te.hasValue=!0,te.value=oe},[oe]),C(oe),oe},kE}var bk;function rQ(){return bk||(bk=1,zE.exports=iQ()),zE.exports}var oQ=rQ(),wM=me.createContext(null),aQ=e=>e,rl=()=>{var e=me.useContext(wM);return e?e.store.dispatch:aQ},h1=()=>{},sQ=()=>h1,lQ=(e,t)=>e===t;function gr(e){var t=me.useContext(wM);return oQ.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:sQ,t?t.store.getState:h1,t?t.store.getState:h1,t?e:h1,lQ)}function cQ(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function uQ(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function hQ(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(i=>typeof i=="function")){const i=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${i}]`)}}var wk=e=>Array.isArray(e)?e:[e];function dQ(e){const t=Array.isArray(e[0])?e[0]:e;return hQ(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function fQ(e,t){const i=[],{length:s}=e;for(let f=0;f<s;f++)i.push(e[f].apply(null,t));return i}var pQ=class{constructor(e){this.value=e}deref(){return this.value}},mQ=typeof WeakRef<"u"?WeakRef:pQ,gQ=0,Tk=1;function Vw(){return{s:gQ,v:void 0,o:null,p:null}}function k5(e,t={}){let i=Vw();const{resultEqualityCheck:s}=t;let f,y=0;function T(){let o=i;const{length:C}=arguments;for(let j=0,q=C;j<q;j++){const K=arguments[j];if(typeof K=="function"||typeof K=="object"&&K!==null){let J=o.o;J===null&&(o.o=J=new WeakMap);const te=J.get(K);te===void 0?(o=Vw(),J.set(K,o)):o=te}else{let J=o.p;J===null&&(o.p=J=new Map);const te=J.get(K);te===void 0?(o=Vw(),J.set(K,o)):o=te}}const M=o;let I;if(o.s===Tk)I=o.v;else if(I=e.apply(null,arguments),y++,s){const j=f?.deref?.()??f;j!=null&&s(j,I)&&(I=j,y!==0&&y--),f=typeof I=="object"&&I!==null||typeof I=="function"?new mQ(I):I}return M.s=Tk,M.v=I,I}return T.clearCache=()=>{i=Vw(),T.resetResultsCount()},T.resultsCount=()=>y,T.resetResultsCount=()=>{y=0},T}function _Q(e,...t){const i=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...f)=>{let y=0,T=0,o,C={},M=f.pop();typeof M=="object"&&(C=M,M=f.pop()),cQ(M,`createSelector expects an output function after the inputs, but received: [${typeof M}]`);const I={...i,...C},{memoize:j,memoizeOptions:q=[],argsMemoize:K=k5,argsMemoizeOptions:J=[]}=I,te=wk(q),oe=wk(J),ce=dQ(f),de=j(function(){return y++,M.apply(null,arguments)},...te),ue=K(function(){T++;const Oe=fQ(ce,arguments);return o=de.apply(null,Oe),o},...oe);return Object.assign(ue,{resultFunc:M,memoizedResultFunc:de,dependencies:ce,dependencyRecomputations:()=>T,resetDependencyRecomputations:()=>{T=0},lastResult:()=>o,recomputations:()=>y,resetRecomputations:()=>{y=0},memoize:j,argsMemoize:K})};return Object.assign(s,{withTypes:()=>s}),s}var Fn=_Q(k5),yQ=Object.assign((e,t=Fn)=>{uQ(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const i=Object.keys(e),s=i.map(y=>e[y]);return t(s,(...y)=>y.reduce((T,o,C)=>(T[i[C]]=o,T),{}))},{withTypes:()=>yQ}),jE={},FE={},UE={},Sk;function vQ(){return Sk||(Sk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const i=(s,f,y)=>{if(s!==f){const T=t(s),o=t(f);if(T===o&&T===0){if(s<f)return y==="desc"?1:-1;if(s>f)return y==="desc"?-1:1}return y==="desc"?o-T:T-o}return 0};e.compareValues=i}(UE)),UE}var VE={},$E={},Ek;function N5(){return Ek||(Ek=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="symbol"||i instanceof Symbol}e.isSymbol=t}($E)),$E}var Ak;function xQ(){return Ak||(Ak=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=N5(),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function f(y,T){return Array.isArray(y)?!1:typeof y=="number"||typeof y=="boolean"||y==null||t.isSymbol(y)?!0:typeof y=="string"&&(s.test(y)||!i.test(y))||T!=null&&Object.hasOwn(T,y)}e.isKey=f}(VE)),VE}var Pk;function bQ(){return Pk||(Pk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vQ(),i=xQ(),s=aM();function f(y,T,o,C){if(y==null)return[];o=C?void 0:o,Array.isArray(y)||(y=Object.values(y)),Array.isArray(T)||(T=T==null?[null]:[T]),T.length===0&&(T=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(K=>String(K));const M=(K,J)=>{let te=K;for(let oe=0;oe<J.length&&te!=null;++oe)te=te[J[oe]];return te},I=(K,J)=>J==null||K==null?J:typeof K=="object"&&"key"in K?Object.hasOwn(J,K.key)?J[K.key]:M(J,K.path):typeof K=="function"?K(J):Array.isArray(K)?M(J,K):typeof J=="object"?J[K]:J,j=T.map(K=>(Array.isArray(K)&&K.length===1&&(K=K[0]),K==null||typeof K=="function"||Array.isArray(K)||i.isKey(K)?K:{key:K,path:s.toPath(K)}));return y.map(K=>({original:K,criteria:j.map(J=>I(J,K))})).slice().sort((K,J)=>{for(let te=0;te<j.length;te++){const oe=t.compareValues(K.criteria[te],J.criteria[te],o[te]);if(oe!==0)return oe}return 0}).map(K=>K.original)}e.orderBy=f}(FE)),FE}var qE={},Ck;function wQ(){return Ck||(Ck=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,s=1){const f=[],y=Math.floor(s),T=(o,C)=>{for(let M=0;M<o.length;M++){const I=o[M];Array.isArray(I)&&C<y?T(I,C+1):f.push(I)}};return T(i,0),f}e.flatten=t}(qE)),qE}var HE={},Mk;function B5(){return Mk||(Mk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L5(),i=_M(),s=O5(),f=yM();function y(T,o,C){return s.isObject(C)&&(typeof o=="number"&&i.isArrayLike(C)&&t.isIndex(o)&&o<C.length||typeof o=="string"&&o in C)?f.eq(C[o],T):!1}e.isIterateeCall=y}(HE)),HE}var Ok;function TQ(){return Ok||(Ok=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bQ(),i=wQ(),s=B5();function f(y,...T){const o=T.length;return o>1&&s.isIterateeCall(y,T[0],T[1])?T=[]:o>2&&s.isIterateeCall(T[0],T[1],T[2])&&(T=[T[0]]),t.orderBy(y,i.flatten(T),["asc"])}e.sortBy=f}(jE)),jE}var GE,Ik;function SQ(){return Ik||(Ik=1,GE=TQ().sortBy),GE}var EQ=SQ();const RT=Zu(EQ);var j5=e=>e.legend.settings,AQ=e=>e.legend.size,PQ=e=>e.legend.payload,CQ=Fn([PQ,j5],(e,t)=>{var{itemSorter:i}=t,s=e.flat(1);return i?RT(s,i):s});function MQ(){return gr(CQ)}var $w=1;function F5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,i]=me.useState({height:0,left:0,top:0,width:0}),s=me.useCallback(f=>{if(f!=null){var y=f.getBoundingClientRect(),T={height:y.height,left:y.left,top:y.top,width:y.width};(Math.abs(T.height-t.height)>$w||Math.abs(T.left-t.left)>$w||Math.abs(T.top-t.top)>$w||Math.abs(T.width-t.width)>$w)&&i({height:T.height,left:T.left,top:T.top,width:T.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function Kl(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var OQ=typeof Symbol=="function"&&Symbol.observable||"@@observable",Dk=OQ,ZE=()=>Math.random().toString(36).substring(7).split("").join("."),IQ={INIT:`@@redux/INIT${ZE()}`,REPLACE:`@@redux/REPLACE${ZE()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ZE()}`},D1=IQ;function TM(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function U5(e,t,i){if(typeof e!="function")throw new Error(Kl(2));if(typeof t=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(Kl(0));if(typeof t=="function"&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(Kl(1));return i(U5)(e,t)}let s=e,f=t,y=new Map,T=y,o=0,C=!1;function M(){T===y&&(T=new Map,y.forEach((oe,ce)=>{T.set(ce,oe)}))}function I(){if(C)throw new Error(Kl(3));return f}function j(oe){if(typeof oe!="function")throw new Error(Kl(4));if(C)throw new Error(Kl(5));let ce=!0;M();const de=o++;return T.set(de,oe),function(){if(ce){if(C)throw new Error(Kl(6));ce=!1,M(),T.delete(de),y=null}}}function q(oe){if(!TM(oe))throw new Error(Kl(7));if(typeof oe.type>"u")throw new Error(Kl(8));if(typeof oe.type!="string")throw new Error(Kl(17));if(C)throw new Error(Kl(9));try{C=!0,f=s(f,oe)}finally{C=!1}return(y=T).forEach(de=>{de()}),oe}function K(oe){if(typeof oe!="function")throw new Error(Kl(10));s=oe,q({type:D1.REPLACE})}function J(){const oe=j;return{subscribe(ce){if(typeof ce!="object"||ce===null)throw new Error(Kl(11));function de(){const Pe=ce;Pe.next&&Pe.next(I())}return de(),{unsubscribe:oe(de)}},[Dk](){return this}}}return q({type:D1.INIT}),{dispatch:q,subscribe:j,getState:I,replaceReducer:K,[Dk]:J}}function DQ(e){Object.keys(e).forEach(t=>{const i=e[t];if(typeof i(void 0,{type:D1.INIT})>"u")throw new Error(Kl(12));if(typeof i(void 0,{type:D1.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Kl(13))})}function V5(e){const t=Object.keys(e),i={};for(let y=0;y<t.length;y++){const T=t[y];typeof e[T]=="function"&&(i[T]=e[T])}const s=Object.keys(i);let f;try{DQ(i)}catch(y){f=y}return function(T={},o){if(f)throw f;let C=!1;const M={};for(let I=0;I<s.length;I++){const j=s[I],q=i[j],K=T[j],J=q(K,o);if(typeof J>"u")throw o&&o.type,new Error(Kl(14));M[j]=J,C=C||J!==K}return C=C||s.length!==Object.keys(T).length,C?M:T}}function R1(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...s)=>t(i(...s)))}function RQ(...e){return t=>(i,s)=>{const f=t(i,s);let y=()=>{throw new Error(Kl(15))};const T={getState:f.getState,dispatch:(C,...M)=>y(C,...M)},o=e.map(C=>C(T));return y=R1(...o)(f.dispatch),{...f,dispatch:y}}}function $5(e){return TM(e)&&"type"in e&&typeof e.type=="string"}var q5=Symbol.for("immer-nothing"),Rk=Symbol.for("immer-draftable"),Sh=Symbol.for("immer-state");function hf(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Cv=Object.getPrototypeOf;function oy(e){return!!e&&!!e[Sh]}function pm(e){return e?H5(e)||Array.isArray(e)||!!e[Rk]||!!e.constructor?.[Rk]||zT(e)||kT(e):!1}var LQ=Object.prototype.constructor.toString();function H5(e){if(!e||typeof e!="object")return!1;const t=Cv(e);if(t===null)return!0;const i=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return i===Object?!0:typeof i=="function"&&Function.toString.call(i)===LQ}function L1(e,t){LT(e)===0?Reflect.ownKeys(e).forEach(i=>{t(i,e[i],e)}):e.forEach((i,s)=>t(s,i,e))}function LT(e){const t=e[Sh];return t?t.type_:Array.isArray(e)?1:zT(e)?2:kT(e)?3:0}function mP(e,t){return LT(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function G5(e,t,i){const s=LT(e);s===2?e.set(t,i):s===3?e.add(i):e[t]=i}function zQ(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function zT(e){return e instanceof Map}function kT(e){return e instanceof Set}function k_(e){return e.copy_||e.base_}function gP(e,t){if(zT(e))return new Map(e);if(kT(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const i=H5(e);if(t===!0||t==="class_only"&&!i){const s=Object.getOwnPropertyDescriptors(e);delete s[Sh];let f=Reflect.ownKeys(s);for(let y=0;y<f.length;y++){const T=f[y],o=s[T];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(s[T]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[T]})}return Object.create(Cv(e),s)}else{const s=Cv(e);if(s!==null&&i)return{...e};const f=Object.create(s);return Object.assign(f,e)}}function SM(e,t=!1){return NT(e)||oy(e)||!pm(e)||(LT(e)>1&&(e.set=e.add=e.clear=e.delete=kQ),Object.freeze(e),t&&Object.entries(e).forEach(([i,s])=>SM(s,!0))),e}function kQ(){hf(2)}function NT(e){return Object.isFrozen(e)}var NQ={};function ay(e){const t=NQ[e];return t||hf(0,e),t}var Nx;function Z5(){return Nx}function BQ(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Lk(e,t){t&&(ay("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function _P(e){yP(e),e.drafts_.forEach(jQ),e.drafts_=null}function yP(e){e===Nx&&(Nx=e.parent_)}function zk(e){return Nx=BQ(Nx,e)}function jQ(e){const t=e[Sh];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function kk(e,t){t.unfinalizedDrafts_=t.drafts_.length;const i=t.drafts_[0];return e!==void 0&&e!==i?(i[Sh].modified_&&(_P(t),hf(4)),pm(e)&&(e=z1(t,e),t.parent_||k1(t,e)),t.patches_&&ay("Patches").generateReplacementPatches_(i[Sh].base_,e,t.patches_,t.inversePatches_)):e=z1(t,i,[]),_P(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==q5?e:void 0}function z1(e,t,i){if(NT(t))return t;const s=t[Sh];if(!s)return L1(t,(f,y)=>Nk(e,s,t,f,y,i)),t;if(s.scope_!==e)return t;if(!s.modified_)return k1(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const f=s.copy_;let y=f,T=!1;s.type_===3&&(y=new Set(f),f.clear(),T=!0),L1(y,(o,C)=>Nk(e,s,f,o,C,i,T)),k1(e,f,!1),i&&e.patches_&&ay("Patches").generatePatches_(s,i,e.patches_,e.inversePatches_)}return s.copy_}function Nk(e,t,i,s,f,y,T){if(oy(f)){const o=y&&t&&t.type_!==3&&!mP(t.assigned_,s)?y.concat(s):void 0,C=z1(e,f,o);if(G5(i,s,C),oy(C))e.canAutoFreeze_=!1;else return}else T&&i.add(f);if(pm(f)&&!NT(f)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;z1(e,f),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&Object.prototype.propertyIsEnumerable.call(i,s)&&k1(e,f)}}function k1(e,t,i=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&SM(t,i)}function FQ(e,t){const i=Array.isArray(e),s={type_:i?1:0,scope_:t?t.scope_:Z5(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let f=s,y=EM;i&&(f=[s],y=Bx);const{revoke:T,proxy:o}=Proxy.revocable(f,y);return s.draft_=o,s.revoke_=T,o}var EM={get(e,t){if(t===Sh)return e;const i=k_(e);if(!mP(i,t))return UQ(e,i,t);const s=i[t];return e.finalized_||!pm(s)?s:s===WE(e.base_,t)?(XE(e),e.copy_[t]=xP(s,e)):s},has(e,t){return t in k_(e)},ownKeys(e){return Reflect.ownKeys(k_(e))},set(e,t,i){const s=W5(k_(e),t);if(s?.set)return s.set.call(e.draft_,i),!0;if(!e.modified_){const f=WE(k_(e),t),y=f?.[Sh];if(y&&y.base_===i)return e.copy_[t]=i,e.assigned_[t]=!1,!0;if(zQ(i,f)&&(i!==void 0||mP(e.base_,t)))return!0;XE(e),vP(e)}return e.copy_[t]===i&&(i!==void 0||t in e.copy_)||Number.isNaN(i)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=i,e.assigned_[t]=!0),!0},deleteProperty(e,t){return WE(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,XE(e),vP(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const i=k_(e),s=Reflect.getOwnPropertyDescriptor(i,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:i[t]}},defineProperty(){hf(11)},getPrototypeOf(e){return Cv(e.base_)},setPrototypeOf(){hf(12)}},Bx={};L1(EM,(e,t)=>{Bx[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Bx.deleteProperty=function(e,t){return Bx.set.call(this,e,t,void 0)};Bx.set=function(e,t,i){return EM.set.call(this,e[0],t,i,e[0])};function WE(e,t){const i=e[Sh];return(i?k_(i):e)[t]}function UQ(e,t,i){const s=W5(t,i);return s?"value"in s?s.value:s.get?.call(e.draft_):void 0}function W5(e,t){if(!(t in e))return;let i=Cv(e);for(;i;){const s=Object.getOwnPropertyDescriptor(i,t);if(s)return s;i=Cv(i)}}function vP(e){e.modified_||(e.modified_=!0,e.parent_&&vP(e.parent_))}function XE(e){e.copy_||(e.copy_=gP(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var VQ=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,i,s)=>{if(typeof t=="function"&&typeof i!="function"){const y=i;i=t;const T=this;return function(C=y,...M){return T.produce(C,I=>i.call(this,I,...M))}}typeof i!="function"&&hf(6),s!==void 0&&typeof s!="function"&&hf(7);let f;if(pm(t)){const y=zk(this),T=xP(t,void 0);let o=!0;try{f=i(T),o=!1}finally{o?_P(y):yP(y)}return Lk(y,s),kk(f,y)}else if(!t||typeof t!="object"){if(f=i(t),f===void 0&&(f=t),f===q5&&(f=void 0),this.autoFreeze_&&SM(f,!0),s){const y=[],T=[];ay("Patches").generateReplacementPatches_(t,f,y,T),s(y,T)}return f}else hf(1,t)},this.produceWithPatches=(t,i)=>{if(typeof t=="function")return(T,...o)=>this.produceWithPatches(T,C=>t(C,...o));let s,f;return[this.produce(t,i,(T,o)=>{s=T,f=o}),s,f]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){pm(e)||hf(8),oy(e)&&(e=Sg(e));const t=zk(this),i=xP(e,void 0);return i[Sh].isManual_=!0,yP(t),i}finishDraft(e,t){const i=e&&e[Sh];(!i||!i.isManual_)&&hf(9);const{scope_:s}=i;return Lk(s,t),kk(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let i;for(i=t.length-1;i>=0;i--){const f=t[i];if(f.path.length===0&&f.op==="replace"){e=f.value;break}}i>-1&&(t=t.slice(i+1));const s=ay("Patches").applyPatches_;return oy(e)?s(e,t):this.produce(e,f=>s(f,t))}};function xP(e,t){const i=zT(e)?ay("MapSet").proxyMap_(e,t):kT(e)?ay("MapSet").proxySet_(e,t):FQ(e,t);return(t?t.scope_:Z5()).drafts_.push(i),i}function Sg(e){return oy(e)||hf(10,e),X5(e)}function X5(e){if(!pm(e)||NT(e))return e;const t=e[Sh];let i;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,i=gP(e,t.scope_.immer_.useStrictShallowCopy_)}else i=gP(e,!0);return L1(i,(s,f)=>{G5(i,s,X5(f))}),t&&(t.finalized_=!1),i}var Eh=new VQ,Y5=Eh.produce;Eh.produceWithPatches.bind(Eh);Eh.setAutoFreeze.bind(Eh);Eh.setUseStrictShallowCopy.bind(Eh);Eh.applyPatches.bind(Eh);Eh.createDraft.bind(Eh);Eh.finishDraft.bind(Eh);function K5(e){return({dispatch:i,getState:s})=>f=>y=>typeof y=="function"?y(i,s,e):f(y)}var $Q=K5(),qQ=K5,HQ=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?R1:R1.apply(null,arguments)};function bd(e,t){function i(...s){if(t){let f=t(...s);if(!f)throw new Error(bh(0));return{type:e,payload:f.payload,..."meta"in f&&{meta:f.meta},..."error"in f&&{error:f.error}}}return{type:e,payload:s[0]}}return i.toString=()=>`${e}`,i.type=e,i.match=s=>$5(s)&&s.type===e,i}var J5=class yx extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,yx.prototype)}static get[Symbol.species](){return yx}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new yx(...t[0].concat(this)):new yx(...t.concat(this))}};function Bk(e){return pm(e)?Y5(e,()=>{}):e}function qw(e,t,i){return e.has(t)?e.get(t):e.set(t,i(t)).get(t)}function GQ(e){return typeof e=="boolean"}var ZQ=()=>function(t){const{thunk:i=!0,immutableCheck:s=!0,serializableCheck:f=!0,actionCreatorCheck:y=!0}=t??{};let T=new J5;return i&&(GQ(i)?T.push($Q):T.push(qQ(i.extraArgument))),T},WQ="RTK_autoBatch",jk=e=>t=>{setTimeout(t,e)},XQ=(e={type:"raf"})=>t=>(...i)=>{const s=t(...i);let f=!0,y=!1,T=!1;const o=new Set,C=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:jk(10):e.type==="callback"?e.queueNotification:jk(e.timeout),M=()=>{T=!1,y&&(y=!1,o.forEach(I=>I()))};return Object.assign({},s,{subscribe(I){const j=()=>f&&I(),q=s.subscribe(j);return o.add(I),()=>{q(),o.delete(I)}},dispatch(I){try{return f=!I?.meta?.[WQ],y=!f,y&&(T||(T=!0,C(M))),s.dispatch(I)}finally{f=!0}}})},YQ=e=>function(i){const{autoBatch:s=!0}=i??{};let f=new J5(e);return s&&f.push(XQ(typeof s=="object"?s:void 0)),f};function KQ(e){const t=ZQ(),{reducer:i=void 0,middleware:s,devTools:f=!0,preloadedState:y=void 0,enhancers:T=void 0}=e||{};let o;if(typeof i=="function")o=i;else if(TM(i))o=V5(i);else throw new Error(bh(1));let C;typeof s=="function"?C=s(t):C=t();let M=R1;f&&(M=HQ({trace:!1,...typeof f=="object"&&f}));const I=RQ(...C),j=YQ(I);let q=typeof T=="function"?T(j):j();const K=M(...q);return U5(o,y,K)}function Q5(e){const t={},i=[];let s;const f={addCase(y,T){const o=typeof y=="string"?y:y.type;if(!o)throw new Error(bh(28));if(o in t)throw new Error(bh(29));return t[o]=T,f},addMatcher(y,T){return i.push({matcher:y,reducer:T}),f},addDefaultCase(y){return s=y,f}};return e(f),[t,i,s]}function JQ(e){return typeof e=="function"}function QQ(e,t){let[i,s,f]=Q5(t),y;if(JQ(e))y=()=>Bk(e());else{const o=Bk(e);y=()=>o}function T(o=y(),C){let M=[i[C.type],...s.filter(({matcher:I})=>I(C)).map(({reducer:I})=>I)];return M.filter(I=>!!I).length===0&&(M=[f]),M.reduce((I,j)=>{if(j)if(oy(I)){const K=j(I,C);return K===void 0?I:K}else{if(pm(I))return Y5(I,q=>j(q,C));{const q=j(I,C);if(q===void 0){if(I===null)return I;throw Error("A case reducer on a non-draftable value must not return undefined")}return q}}return I},o)}return T.getInitialState=y,T}var eee="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",tee=(e=21)=>{let t="",i=e;for(;i--;)t+=eee[Math.random()*64|0];return t},nee=Symbol.for("rtk-slice-createasyncthunk");function iee(e,t){return`${e}/${t}`}function ree({creators:e}={}){const t=e?.asyncThunk?.[nee];return function(s){const{name:f,reducerPath:y=f}=s;if(!f)throw new Error(bh(11));const T=(typeof s.reducers=="function"?s.reducers(aee()):s.reducers)||{},o=Object.keys(T),C={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},M={addCase(ue,Pe){const Oe=typeof ue=="string"?ue:ue.type;if(!Oe)throw new Error(bh(12));if(Oe in C.sliceCaseReducersByType)throw new Error(bh(13));return C.sliceCaseReducersByType[Oe]=Pe,M},addMatcher(ue,Pe){return C.sliceMatchers.push({matcher:ue,reducer:Pe}),M},exposeAction(ue,Pe){return C.actionCreators[ue]=Pe,M},exposeCaseReducer(ue,Pe){return C.sliceCaseReducersByName[ue]=Pe,M}};o.forEach(ue=>{const Pe=T[ue],Oe={reducerName:ue,type:iee(f,ue),createNotation:typeof s.reducers=="function"};lee(Pe)?uee(Oe,Pe,M,t):see(Oe,Pe,M)});function I(){const[ue={},Pe=[],Oe=void 0]=typeof s.extraReducers=="function"?Q5(s.extraReducers):[s.extraReducers],xe={...ue,...C.sliceCaseReducersByType};return QQ(s.initialState,Qe=>{for(let tt in xe)Qe.addCase(tt,xe[tt]);for(let tt of C.sliceMatchers)Qe.addMatcher(tt.matcher,tt.reducer);for(let tt of Pe)Qe.addMatcher(tt.matcher,tt.reducer);Oe&&Qe.addDefaultCase(Oe)})}const j=ue=>ue,q=new Map,K=new WeakMap;let J;function te(ue,Pe){return J||(J=I()),J(ue,Pe)}function oe(){return J||(J=I()),J.getInitialState()}function ce(ue,Pe=!1){function Oe(Qe){let tt=Qe[ue];return typeof tt>"u"&&Pe&&(tt=qw(K,Oe,oe)),tt}function xe(Qe=j){const tt=qw(q,Pe,()=>new WeakMap);return qw(tt,Qe,()=>{const Ge={};for(const[Je,Ve]of Object.entries(s.selectors??{}))Ge[Je]=oee(Ve,Qe,()=>qw(K,Qe,oe),Pe);return Ge})}return{reducerPath:ue,getSelectors:xe,get selectors(){return xe(Oe)},selectSlice:Oe}}const de={name:f,reducer:te,actions:C.actionCreators,caseReducers:C.sliceCaseReducersByName,getInitialState:oe,...ce(y),injectInto(ue,{reducerPath:Pe,...Oe}={}){const xe=Pe??y;return ue.inject({reducerPath:xe,reducer:te},Oe),{...de,...ce(xe,!0)}}};return de}}function oee(e,t,i,s){function f(y,...T){let o=t(y);return typeof o>"u"&&s&&(o=i()),e(o,...T)}return f.unwrapped=e,f}var Sd=ree();function aee(){function e(t,i){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...i}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...i){return t(...i)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,i){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:i}},asyncThunk:e}}function see({type:e,reducerName:t,createNotation:i},s,f){let y,T;if("reducer"in s){if(i&&!cee(s))throw new Error(bh(17));y=s.reducer,T=s.prepare}else y=s;f.addCase(e,y).exposeCaseReducer(t,y).exposeAction(t,T?bd(e,T):bd(e))}function lee(e){return e._reducerDefinitionType==="asyncThunk"}function cee(e){return e._reducerDefinitionType==="reducerWithPrepare"}function uee({type:e,reducerName:t},i,s,f){if(!f)throw new Error(bh(18));const{payloadCreator:y,fulfilled:T,pending:o,rejected:C,settled:M,options:I}=i,j=f(e,y,I);s.exposeAction(t,j),T&&s.addCase(j.fulfilled,T),o&&s.addCase(j.pending,o),C&&s.addCase(j.rejected,C),M&&s.addMatcher(j.settled,M),s.exposeCaseReducer(t,{fulfilled:T||Hw,pending:o||Hw,rejected:C||Hw,settled:M||Hw})}function Hw(){}var hee="task",e4="listener",t4="completed",AM="cancelled",dee=`task-${AM}`,fee=`task-${t4}`,bP=`${e4}-${AM}`,pee=`${e4}-${t4}`,BT=class{constructor(e){this.code=e,this.message=`${hee} ${AM} (reason: ${e})`}name="TaskAbortError";message},PM=(e,t)=>{if(typeof e!="function")throw new TypeError(bh(32))},N1=()=>{},n4=(e,t=N1)=>(e.catch(t),e),i4=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),K_=(e,t)=>{const i=e.signal;i.aborted||("reason"in i||Object.defineProperty(i,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},J_=e=>{if(e.aborted){const{reason:t}=e;throw new BT(t)}};function r4(e,t){let i=N1;return new Promise((s,f)=>{const y=()=>f(new BT(e.reason));if(e.aborted){y();return}i=i4(e,y),t.finally(()=>i()).then(s,f)}).finally(()=>{i=N1})}var mee=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(i){return{status:i instanceof BT?"cancelled":"rejected",error:i}}finally{t?.()}},B1=e=>t=>n4(r4(e,t).then(i=>(J_(e),i))),o4=e=>{const t=B1(e);return i=>t(new Promise(s=>setTimeout(s,i)))},{assign:bv}=Object,Fk={},jT="listenerMiddleware",gee=(e,t)=>{const i=s=>i4(e,()=>K_(s,e.reason));return(s,f)=>{PM(s);const y=new AbortController;i(y);const T=mee(async()=>{J_(e),J_(y.signal);const o=await s({pause:B1(y.signal),delay:o4(y.signal),signal:y.signal});return J_(y.signal),o},()=>K_(y,fee));return f?.autoJoin&&t.push(T.catch(N1)),{result:B1(e)(T),cancel(){K_(y,dee)}}}},_ee=(e,t)=>{const i=async(s,f)=>{J_(t);let y=()=>{};const o=[new Promise((C,M)=>{let I=e({predicate:s,effect:(j,q)=>{q.unsubscribe(),C([j,q.getState(),q.getOriginalState()])}});y=()=>{I(),M()}})];f!=null&&o.push(new Promise(C=>setTimeout(C,f,null)));try{const C=await r4(t,Promise.race(o));return J_(t),C}finally{y()}};return(s,f)=>n4(i(s,f))},a4=e=>{let{type:t,actionCreator:i,matcher:s,predicate:f,effect:y}=e;if(t)f=bd(t).match;else if(i)t=i.type,f=i.match;else if(s)f=s;else if(!f)throw new Error(bh(21));return PM(y),{predicate:f,type:t,effect:y}},s4=bv(e=>{const{type:t,predicate:i,effect:s}=a4(e);return{id:tee(),effect:s,type:t,predicate:i,pending:new Set,unsubscribe:()=>{throw new Error(bh(22))}}},{withTypes:()=>s4}),Uk=(e,t)=>{const{type:i,effect:s,predicate:f}=a4(t);return Array.from(e.values()).find(y=>(typeof i=="string"?y.type===i:y.predicate===f)&&y.effect===s)},wP=e=>{e.pending.forEach(t=>{K_(t,bP)})},yee=e=>()=>{e.forEach(wP),e.clear()},Vk=(e,t,i)=>{try{e(t,i)}catch(s){setTimeout(()=>{throw s},0)}},l4=bv(bd(`${jT}/add`),{withTypes:()=>l4}),vee=bd(`${jT}/removeAll`),c4=bv(bd(`${jT}/remove`),{withTypes:()=>c4}),xee=(...e)=>{console.error(`${jT}/error`,...e)},ab=(e={})=>{const t=new Map,{extra:i,onError:s=xee}=e;PM(s);const f=I=>(I.unsubscribe=()=>t.delete(I.id),t.set(I.id,I),j=>{I.unsubscribe(),j?.cancelActive&&wP(I)}),y=I=>{const j=Uk(t,I)??s4(I);return f(j)};bv(y,{withTypes:()=>y});const T=I=>{const j=Uk(t,I);return j&&(j.unsubscribe(),I.cancelActive&&wP(j)),!!j};bv(T,{withTypes:()=>T});const o=async(I,j,q,K)=>{const J=new AbortController,te=_ee(y,J.signal),oe=[];try{I.pending.add(J),await Promise.resolve(I.effect(j,bv({},q,{getOriginalState:K,condition:(ce,de)=>te(ce,de).then(Boolean),take:te,delay:o4(J.signal),pause:B1(J.signal),extra:i,signal:J.signal,fork:gee(J.signal,oe),unsubscribe:I.unsubscribe,subscribe:()=>{t.set(I.id,I)},cancelActiveListeners:()=>{I.pending.forEach((ce,de,ue)=>{ce!==J&&(K_(ce,bP),ue.delete(ce))})},cancel:()=>{K_(J,bP),I.pending.delete(J)},throwIfCancelled:()=>{J_(J.signal)}})))}catch(ce){ce instanceof BT||Vk(s,ce,{raisedBy:"effect"})}finally{await Promise.all(oe),K_(J,pee),I.pending.delete(J)}},C=yee(t);return{middleware:I=>j=>q=>{if(!$5(q))return j(q);if(l4.match(q))return y(q.payload);if(vee.match(q)){C();return}if(c4.match(q))return T(q.payload);let K=I.getState();const J=()=>{if(K===Fk)throw new Error(bh(23));return K};let te;try{if(te=j(q),t.size>0){const oe=I.getState(),ce=Array.from(t.values());for(const de of ce){let ue=!1;try{ue=de.predicate(q,oe,K)}catch(Pe){ue=!1,Vk(s,Pe,{raisedBy:"predicate"})}ue&&o(de,q,I,J)}}}finally{K=Fk}return te},startListening:y,stopListening:T,clearListeners:C}};function bh(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var bee={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},u4=Sd({name:"chartLayout",initialState:bee,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:wee,setLayout:Tee,setChartSize:See,setScale:Eee}=u4.actions,Aee=u4.reducer;function $k(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function qk(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?$k(Object(i),!0).forEach(function(s){Pee(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):$k(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Pee(e,t,i){return(t=Cee(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Cee(e){var t=Mee(e,"string");return typeof t=="symbol"?t:t+""}function Mee(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j1=Math.PI/180,Oee=e=>e*180/Math.PI,ec=(e,t,i,s)=>({x:e+Math.cos(-j1*s)*i,y:t+Math.sin(-j1*s)*i}),Iee=function(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(i-(s.top||0)-(s.bottom||0)))/2},Dee=(e,t)=>{var{x:i,y:s}=e,{x:f,y}=t;return Math.sqrt((i-f)**2+(s-y)**2)},Ree=(e,t)=>{var{x:i,y:s}=e,{cx:f,cy:y}=t,T=Dee({x:i,y:s},{x:f,y});if(T<=0)return{radius:T,angle:0};var o=(i-f)/T,C=Math.acos(o);return s>y&&(C=2*Math.PI-C),{radius:T,angle:Oee(C),angleInRadian:C}},Lee=e=>{var{startAngle:t,endAngle:i}=e,s=Math.floor(t/360),f=Math.floor(i/360),y=Math.min(s,f);return{startAngle:t-y*360,endAngle:i-y*360}},zee=(e,t)=>{var{startAngle:i,endAngle:s}=t,f=Math.floor(i/360),y=Math.floor(s/360),T=Math.min(f,y);return e+T*360},kee=(e,t)=>{var{x:i,y:s}=e,{radius:f,angle:y}=Ree({x:i,y:s},t),{innerRadius:T,outerRadius:o}=t;if(f<T||f>o||f===0)return null;var{startAngle:C,endAngle:M}=Lee(t),I=y,j;if(C<=M){for(;I>M;)I-=360;for(;I<C;)I+=360;j=I>=C&&I<=M}else{for(;I>C;)I-=360;for(;I<M;)I+=360;j=I>=M&&I<=C}return j?qk(qk({},t),{},{radius:f,angle:zee(I,t)}):null};function Hk(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function gd(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Hk(Object(i),!0).forEach(function(s){Nee(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Hk(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Nee(e,t,i){return(t=Bee(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bee(e){var t=jee(e,"string");return typeof t=="symbol"?t:t+""}function jee(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wh(e,t,i){return vl(e)||vl(t)?i:up(t)?ry(e,t,i):typeof t=="function"?t(e):i}var Fee=(e,t,i,s,f)=>{var y,T=-1,o=(y=t?.length)!==null&&y!==void 0?y:0;if(o<=1||e==null)return 0;if(s==="angleAxis"&&f!=null&&Math.abs(Math.abs(f[1]-f[0])-360)<=1e-6)for(var C=0;C<o;C++){var M=C>0?i[C-1].coordinate:i[o-1].coordinate,I=i[C].coordinate,j=C>=o-1?i[0].coordinate:i[C+1].coordinate,q=void 0;if(Vu(I-M)!==Vu(j-I)){var K=[];if(Vu(j-I)===Vu(f[1]-f[0])){q=j;var J=I+f[1]-f[0];K[0]=Math.min(J,(J+M)/2),K[1]=Math.max(J,(J+M)/2)}else{q=M;var te=j+f[1]-f[0];K[0]=Math.min(I,(te+I)/2),K[1]=Math.max(I,(te+I)/2)}var oe=[Math.min(I,(q+I)/2),Math.max(I,(q+I)/2)];if(e>oe[0]&&e<=oe[1]||e>=K[0]&&e<=K[1]){({index:T}=i[C]);break}}else{var ce=Math.min(M,j),de=Math.max(M,j);if(e>(ce+I)/2&&e<=(de+I)/2){({index:T}=i[C]);break}}}else if(t){for(var ue=0;ue<o;ue++)if(ue===0&&e<=(t[ue].coordinate+t[ue+1].coordinate)/2||ue>0&&ue<o-1&&e>(t[ue].coordinate+t[ue-1].coordinate)/2&&e<=(t[ue].coordinate+t[ue+1].coordinate)/2||ue===o-1&&e>(t[ue].coordinate+t[ue-1].coordinate)/2){({index:T}=t[ue]);break}}return T},Uee=(e,t,i)=>{if(t&&i){var{width:s,height:f}=i,{align:y,verticalAlign:T,layout:o}=t;if((o==="vertical"||o==="horizontal"&&T==="middle")&&y!=="center"&&Hi(e[y]))return gd(gd({},e),{},{[y]:e[y]+(s||0)});if((o==="horizontal"||o==="vertical"&&y==="center")&&T!=="middle"&&Hi(e[T]))return gd(gd({},e),{},{[T]:e[T]+(f||0)})}return e},hy=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",h4=(e,t,i,s)=>{if(s)return e.map(o=>o.coordinate);var f,y,T=e.map(o=>(o.coordinate===t&&(f=!0),o.coordinate===i&&(y=!0),o.coordinate));return f||T.push(t),y||T.push(i),T},d4=(e,t,i)=>{if(!e)return null;var{duplicateDomain:s,type:f,range:y,scale:T,realScaleType:o,isCategorical:C,categoricalDomain:M,tickCount:I,ticks:j,niceTicks:q,axisType:K}=e;if(!T)return null;var J=o==="scaleBand"&&T.bandwidth?T.bandwidth()/2:2,te=f==="category"&&T.bandwidth?T.bandwidth()/J:0;if(te=K==="angleAxis"&&y&&y.length>=2?Vu(y[0]-y[1])*2*te:te,j||q){var oe=(j||q||[]).map((ce,de)=>{var ue=s?s.indexOf(ce):ce;return{coordinate:T(ue)+te,value:ce,offset:te,index:de}});return oe.filter(ce=>!Th(ce.coordinate))}return C&&M?M.map((ce,de)=>({coordinate:T(ce)+te,value:ce,index:de,offset:te})):T.ticks&&I!=null?T.ticks(I).map((ce,de)=>({coordinate:T(ce)+te,value:ce,offset:te,index:de})):T.domain().map((ce,de)=>({coordinate:T(ce)+te,value:s?s[ce]:ce,index:de,offset:te}))},Gk=1e-4,Vee=e=>{var t=e.domain();if(!(!t||t.length<=2)){var i=t.length,s=e.range(),f=Math.min(s[0],s[1])-Gk,y=Math.max(s[0],s[1])+Gk,T=e(t[0]),o=e(t[i-1]);(T<f||T>y||o<f||o>y)&&e.domain([t[0],t[i-1]])}},$ee=(e,t)=>{if(!t||t.length!==2||!Hi(t[0])||!Hi(t[1]))return e;var i=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),f=[e[0],e[1]];return(!Hi(e[0])||e[0]<i)&&(f[0]=i),(!Hi(e[1])||e[1]>s)&&(f[1]=s),f[0]>s&&(f[0]=s),f[1]<i&&(f[1]=i),f},qee=e=>{var t=e.length;if(!(t<=0))for(var i=0,s=e[0].length;i<s;++i)for(var f=0,y=0,T=0;T<t;++T){var o=Th(e[T][i][1])?e[T][i][0]:e[T][i][1];o>=0?(e[T][i][0]=f,e[T][i][1]=f+o,f=e[T][i][1]):(e[T][i][0]=y,e[T][i][1]=y+o,y=e[T][i][1])}},Hee=e=>{var t=e.length;if(!(t<=0))for(var i=0,s=e[0].length;i<s;++i)for(var f=0,y=0;y<t;++y){var T=Th(e[y][i][1])?e[y][i][0]:e[y][i][1];T>=0?(e[y][i][0]=f,e[y][i][1]=f+T,f=e[y][i][1]):(e[y][i][0]=0,e[y][i][1]=0)}},Gee={sign:qee,expand:bJ,none:Pv,silhouette:wJ,wiggle:TJ,positive:Hee},Zee=(e,t,i)=>{var s=Gee[i],f=xJ().keys(t).value((y,T)=>+wh(y,T,0)).order(dP).offset(s);return f(e)};function f4(e){return e==null?void 0:String(e)}var Zk=e=>{var{axis:t,ticks:i,offset:s,bandSize:f,entry:y,index:T}=e;if(t.type==="category")return i[T]?i[T].coordinate+s:null;var o=wh(y,t.dataKey,t.scale.domain()[T]);return vl(o)?null:t.scale(o)-f/2+s},Wee=e=>{var{numericAxis:t}=e,i=t.scale.domain();if(t.type==="number"){var s=Math.min(i[0],i[1]),f=Math.max(i[0],i[1]);return s<=0&&f>=0?0:f<0?f:s}return i[0]},Xee=e=>{var t=e.flat(2).filter(Hi);return[Math.min(...t),Math.max(...t)]},Yee=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Kee=(e,t,i)=>{if(e!=null)return Yee(Object.keys(e).reduce((s,f)=>{var y=e[f],{stackedData:T}=y,o=T.reduce((C,M)=>{var I=Xee(M.slice(t,i+1));return[Math.min(C[0],I[0]),Math.max(C[1],I[1])]},[1/0,-1/0]);return[Math.min(o[0],s[0]),Math.max(o[1],s[1])]},[1/0,-1/0]))},Wk=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Xk=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,CM=(e,t,i)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!i||s>0)return s}if(e&&t&&t.length>=2){for(var f=RT(t,I=>I.coordinate),y=1/0,T=1,o=f.length;T<o;T++){var C=f[T],M=f[T-1];y=Math.min((C.coordinate||0)-(M.coordinate||0),y)}return y===1/0?0:y}return i?void 0:0};function Yk(e){var{tooltipEntrySettings:t,dataKey:i,payload:s,value:f,name:y}=e;return gd(gd({},t),{},{dataKey:i,payload:s,value:f,name:y})}function p4(e,t){if(e)return String(e);if(typeof t=="string")return t}function Jee(e,t,i,s,f){if(i==="horizontal"||i==="vertical"){var y=e>=f.left&&e<=f.left+f.width&&t>=f.top&&t<=f.top+f.height;return y?{x:e,y:t}:null}return s?kee({x:e,y:t},s):null}var Qee=(e,t,i,s)=>{var f=t.find(M=>M&&M.index===i);if(f){if(e==="horizontal")return{x:f.coordinate,y:s.y};if(e==="vertical")return{x:s.x,y:f.coordinate};if(e==="centric"){var y=f.coordinate,{radius:T}=s;return gd(gd(gd({},s),ec(s.cx,s.cy,T,y)),{},{angle:y,radius:T})}var o=f.coordinate,{angle:C}=s;return gd(gd(gd({},s),ec(s.cx,s.cy,o,C)),{},{angle:C,radius:o})}return{x:0,y:0}},ete=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Rg=e=>e.layout.width,Lg=e=>e.layout.height,tte=e=>e.layout.scale,m4=e=>e.layout.margin,MM=Fn(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),OM=Fn(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),nte="data-recharts-item-index",ite="data-recharts-item-data-key",FT=60;function Kk(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function fg(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Kk(Object(i),!0).forEach(function(s){rte(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Kk(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function rte(e,t,i){return(t=ote(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ote(e){var t=ate(e,"string");return typeof t=="symbol"?t:t+""}function ate(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ste=e=>e.brush.height,nc=Fn([Rg,Lg,m4,ste,MM,OM,j5,AQ],(e,t,i,s,f,y,T,o)=>{var C=y.reduce((J,te)=>{var{orientation:oe}=te;if(!te.mirror&&!te.hide){var ce=typeof te.width=="number"?te.width:FT;return fg(fg({},J),{},{[oe]:J[oe]+ce})}return J},{left:i.left||0,right:i.right||0}),M=f.reduce((J,te)=>{var{orientation:oe}=te;return!te.mirror&&!te.hide?fg(fg({},J),{},{[oe]:ry(J,"".concat(oe))+te.height}):J},{top:i.top||0,bottom:i.bottom||0}),I=fg(fg({},M),C),j=I.bottom;I.bottom+=s,I=Uee(I,T,o);var q=e-I.left-I.right,K=t-I.top-I.bottom;return fg(fg({brushBottom:j},I),{},{width:Math.max(q,0),height:Math.max(K,0)})}),lte=Fn(nc,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),g4=Fn(Rg,Lg,(e,t)=>({x:0,y:0,width:e,height:t})),cte=me.createContext(null),Wu=()=>me.useContext(cte)!=null,UT=e=>e.brush,VT=Fn([UT,nc,m4],(e,t,i)=>({height:e.height,x:Hi(e.x)?e.x:t.left,y:Hi(e.y)?e.y:t.top+t.height+t.brushBottom-(i?.bottom||0),width:Hi(e.width)?e.width:t.width})),IM=()=>{var e,t=Wu(),i=gr(lte),s=gr(VT),f=(e=gr(UT))===null||e===void 0?void 0:e.padding;return!t||!s||!f?i:{width:s.width-f.left-f.right,height:s.height-f.top-f.bottom,x:f.left,y:f.top}},ute={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},$T=()=>{var e;return(e=gr(nc))!==null&&e!==void 0?e:ute},DM=()=>gr(Rg),RM=()=>gr(Lg),hte={top:0,right:0,bottom:0,left:0},dte=()=>{var e;return(e=gr(t=>t.layout.margin))!==null&&e!==void 0?e:hte},Ba=e=>e.layout.layoutType,LM=()=>gr(Ba),fte={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},_4=Sd({name:"legend",initialState:fte,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var i=Sg(e).payload.indexOf(t.payload);i>-1&&e.payload.splice(i,1)}}}),{setLegendSize:Jk,setLegendSettings:pte,addLegendPayload:mte,removeLegendPayload:gte}=_4.actions,_te=_4.reducer,yte=["contextPayload"];function TP(){return TP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},TP.apply(null,arguments)}function Qk(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Mv(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Qk(Object(i),!0).forEach(function(s){zM(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Qk(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function zM(e,t,i){return(t=vte(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vte(e){var t=xte(e,"string");return typeof t=="symbol"?t:t+""}function xte(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bte(e,t){if(e==null)return{};var i,s,f=wte(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function wte(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function Tte(e){return e.value}function Ste(e){var{contextPayload:t}=e,i=bte(e,yte),s=z5(t,e.payloadUniqBy,Tte),f=Mv(Mv({},i),{},{payload:s});return me.isValidElement(e.content)?me.cloneElement(e.content,f):typeof e.content=="function"?me.createElement(e.content,f):me.createElement(gM,f)}function Ete(e,t,i,s,f,y){var{layout:T,align:o,verticalAlign:C}=t,M,I;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&T==="vertical"?M={left:((s||0)-y.width)/2}:M=o==="right"?{right:i&&i.right||0}:{left:i&&i.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(C==="middle"?I={top:((f||0)-y.height)/2}:I=C==="bottom"?{bottom:i&&i.bottom||0}:{top:i&&i.top||0}),Mv(Mv({},M),I)}function Ate(e){var t=rl();return me.useEffect(()=>{t(pte(e))},[t,e]),null}function Pte(e){var t=rl();return me.useEffect(()=>(t(Jk(e)),()=>{t(Jk({width:0,height:0}))}),[t,e]),null}function Cte(e){var t=MQ(),i=qK(),s=dte(),{width:f,height:y,wrapperStyle:T,portal:o}=e,[C,M]=F5([t]),I=DM(),j=RM(),q=I-(s.left||0)-(s.right||0),K=jx.getWidthOrHeight(e.layout,y,f,q),J=o?T:Mv(Mv({position:"absolute",width:K?.width||f||"auto",height:K?.height||y||"auto"},Ete(T,e,s,I,j,C)),T),te=o??i;if(te==null)return null;var oe=me.createElement("div",{className:"recharts-legend-wrapper",style:J,ref:M},me.createElement(Ate,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),me.createElement(Pte,{width:C.width,height:C.height}),me.createElement(Ste,TP({},e,K,{margin:s,chartWidth:I,chartHeight:j,contextPayload:t})));return eM.createPortal(oe,te)}class jx extends me.PureComponent{static getWidthOrHeight(t,i,s,f){return t==="vertical"&&Hi(i)?{height:i}:t==="horizontal"?{width:s||f}:null}render(){return me.createElement(Cte,this.props)}}zM(jx,"displayName","Legend");zM(jx,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function SP(){return SP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},SP.apply(null,arguments)}function e3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function YE(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?e3(Object(i),!0).forEach(function(s){Mte(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):e3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Mte(e,t,i){return(t=Ote(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ote(e){var t=Ite(e,"string");return typeof t=="symbol"?t:t+""}function Ite(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dte(e){return Array.isArray(e)&&up(e[0])&&up(e[1])?e.join(" ~ "):e}var Rte=e=>{var{separator:t=" : ",contentStyle:i={},itemStyle:s={},labelStyle:f={},payload:y,formatter:T,itemSorter:o,wrapperClassName:C,labelClassName:M,label:I,labelFormatter:j,accessibilityLayer:q=!1}=e,K=()=>{if(y&&y.length){var Oe={padding:0,margin:0},xe=(o?RT(y,o):y).map((Qe,tt)=>{if(Qe.type==="none")return null;var Ge=Qe.formatter||T||Dte,{value:Je,name:Ve}=Qe,xt=Je,yt=Ve;if(Ge){var ot=Ge(Je,Ve,Qe,tt,y);if(Array.isArray(ot))[xt,yt]=ot;else if(ot!=null)xt=ot;else return null}var zt=YE({display:"block",paddingTop:4,paddingBottom:4,color:Qe.color||"#000"},s);return me.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(tt),style:zt},up(yt)?me.createElement("span",{className:"recharts-tooltip-item-name"},yt):null,up(yt)?me.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,me.createElement("span",{className:"recharts-tooltip-item-value"},xt),me.createElement("span",{className:"recharts-tooltip-item-unit"},Qe.unit||""))});return me.createElement("ul",{className:"recharts-tooltip-item-list",style:Oe},xe)}return null},J=YE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),te=YE({margin:0},f),oe=!vl(I),ce=oe?I:"",de=Ya("recharts-default-tooltip",C),ue=Ya("recharts-tooltip-label",M);oe&&j&&y!==void 0&&y!==null&&(ce=j(I,y));var Pe=q?{role:"status","aria-live":"assertive"}:{};return me.createElement("div",SP({className:de,style:J},Pe),me.createElement("p",{className:ue,style:te},me.isValidElement(ce)?ce:"".concat(ce)),K())},ox="recharts-tooltip-wrapper",Lte={visibility:"hidden"};function zte(e){var{coordinate:t,translateX:i,translateY:s}=e;return Ya(ox,{["".concat(ox,"-right")]:Hi(i)&&t&&Hi(t.x)&&i>=t.x,["".concat(ox,"-left")]:Hi(i)&&t&&Hi(t.x)&&i<t.x,["".concat(ox,"-bottom")]:Hi(s)&&t&&Hi(t.y)&&s>=t.y,["".concat(ox,"-top")]:Hi(s)&&t&&Hi(t.y)&&s<t.y})}function t3(e){var{allowEscapeViewBox:t,coordinate:i,key:s,offsetTopLeft:f,position:y,reverseDirection:T,tooltipDimension:o,viewBox:C,viewBoxDimension:M}=e;if(y&&Hi(y[s]))return y[s];var I=i[s]-o-(f>0?f:0),j=i[s]+f;if(t[s])return T[s]?I:j;var q=C[s];if(q==null)return 0;if(T[s]){var K=I,J=q;return K<J?Math.max(j,q):Math.max(I,q)}if(M==null)return 0;var te=j+o,oe=q+M;return te>oe?Math.max(I,q):Math.max(j,q)}function kte(e){var{translateX:t,translateY:i,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(i,"px, 0)"):"translate(".concat(t,"px, ").concat(i,"px)")}}function Nte(e){var{allowEscapeViewBox:t,coordinate:i,offsetTopLeft:s,position:f,reverseDirection:y,tooltipBox:T,useTranslate3d:o,viewBox:C}=e,M,I,j;return T.height>0&&T.width>0&&i?(I=t3({allowEscapeViewBox:t,coordinate:i,key:"x",offsetTopLeft:s,position:f,reverseDirection:y,tooltipDimension:T.width,viewBox:C,viewBoxDimension:C.width}),j=t3({allowEscapeViewBox:t,coordinate:i,key:"y",offsetTopLeft:s,position:f,reverseDirection:y,tooltipDimension:T.height,viewBox:C,viewBoxDimension:C.height}),M=kte({translateX:I,translateY:j,useTranslate3d:o})):M=Lte,{cssProperties:M,cssClasses:zte({translateX:I,translateY:j,coordinate:i})}}function n3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Gw(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?n3(Object(i),!0).forEach(function(s){EP(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function EP(e,t,i){return(t=Bte(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bte(e){var t=jte(e,"string");return typeof t=="symbol"?t:t+""}function jte(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Fte extends me.PureComponent{constructor(){super(...arguments),EP(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),EP(this,"handleKeyDown",t=>{if(t.key==="Escape"){var i,s,f,y;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&i!==void 0?i:0,y:(f=(y=this.props.coordinate)===null||y===void 0?void 0:y.y)!==null&&f!==void 0?f:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,i;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:i,animationDuration:s,animationEasing:f,children:y,coordinate:T,hasPayload:o,isAnimationActive:C,offset:M,position:I,reverseDirection:j,useTranslate3d:q,viewBox:K,wrapperStyle:J,lastBoundingBox:te,innerRef:oe,hasPortalFromProps:ce}=this.props,{cssClasses:de,cssProperties:ue}=Nte({allowEscapeViewBox:i,coordinate:T,offsetTopLeft:M,position:I,reverseDirection:j,tooltipBox:{height:te.height,width:te.width},useTranslate3d:q,viewBox:K}),Pe=ce?{}:Gw(Gw({transition:C&&t?"transform ".concat(s,"ms ").concat(f):void 0},ue),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),Oe=Gw(Gw({},Pe),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},J);return me.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:de,style:Oe,ref:oe},y)}}var Ute=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),sb={isSsr:Ute()},y4=()=>gr(e=>e.rootProps.accessibilityLayer);function Ah(e){return Number.isFinite(e)}function F1(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function AP(){return AP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},AP.apply(null,arguments)}function i3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function r3(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?i3(Object(i),!0).forEach(function(s){Vte(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):i3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Vte(e,t,i){return(t=$te(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $te(e){var t=qte(e,"string");return typeof t=="symbol"?t:t+""}function qte(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o3={curveBasisClosed:cJ,curveBasisOpen:uJ,curveBasis:lJ,curveBumpX:WK,curveBumpY:XK,curveLinearClosed:hJ,curveLinear:IT,curveMonotoneX:dJ,curveMonotoneY:fJ,curveNatural:pJ,curveStep:mJ,curveStepAfter:_J,curveStepBefore:gJ},Zw=e=>Ah(e.x)&&Ah(e.y),ax=e=>e.x,sx=e=>e.y,Hte=(e,t)=>{if(typeof e=="function")return e;var i="curve".concat(ob(e));return(i==="curveMonotone"||i==="curveBump")&&t?o3["".concat(i).concat(t==="vertical"?"Y":"X")]:o3[i]||IT},Gte=e=>{var{type:t="linear",points:i=[],baseLine:s,layout:f,connectNulls:y=!1}=e,T=Hte(t,f),o=y?i.filter(Zw):i,C;if(Array.isArray(s)){var M=y?s.filter(j=>Zw(j)):s,I=o.map((j,q)=>r3(r3({},j),{},{base:M[q]}));return f==="vertical"?C=Uw().y(sx).x1(ax).x0(j=>j.base.x):C=Uw().x(ax).y1(sx).y0(j=>j.base.y),C.defined(Zw).curve(T),C(I)}return f==="vertical"&&Hi(s)?C=Uw().y(sx).x1(ax).x0(s):Hi(s)?C=Uw().x(ax).y1(sx).y0(s):C=_5().x(ax).y(sx),C.defined(Zw).curve(T),C(o)},Zte=e=>{var{className:t,points:i,path:s,pathRef:f}=e;if((!i||!i.length)&&!s)return null;var y=i&&i.length?Gte(e):s;return me.createElement("path",AP({},gs(e,!1),zK(e),{className:Ya("recharts-curve",t),d:y===null?void 0:y,ref:f}))},Wte=["x","y","top","left","width","height","className"];function PP(){return PP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},PP.apply(null,arguments)}function a3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Xte(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(i),!0).forEach(function(s){Yte(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Yte(e,t,i){return(t=Kte(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Kte(e){var t=Jte(e,"string");return typeof t=="symbol"?t:t+""}function Jte(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qte(e,t){if(e==null)return{};var i,s,f=ene(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function ene(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var tne=(e,t,i,s,f,y)=>"M".concat(e,",").concat(f,"v").concat(s,"M").concat(y,",").concat(t,"h").concat(i),nne=e=>{var{x:t=0,y:i=0,top:s=0,left:f=0,width:y=0,height:T=0,className:o}=e,C=Qte(e,Wte),M=Xte({x:t,y:i,top:s,left:f,width:y,height:T},C);return!Hi(t)||!Hi(i)||!Hi(y)||!Hi(T)||!Hi(s)||!Hi(f)?null:me.createElement("path",PP({},gs(M,!0),{className:Ya("recharts-cross",o),d:tne(t,i,y,T,s,f)}))};function ine(e,t,i,s){var f=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-f:i.left+.5,y:e==="horizontal"?i.top+.5:t.y-f,width:e==="horizontal"?s:i.width-1,height:e==="horizontal"?i.height-1:s}}function s3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function rne(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?s3(Object(i),!0).forEach(function(s){one(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function one(e,t,i){return(t=ane(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ane(e){var t=sne(e,"string");return typeof t=="symbol"?t:t+""}function sne(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zg(e,t){var i=rne({},e),s=t,f=Object.keys(t),y=f.reduce((T,o)=>(T[o]===void 0&&s[o]!==void 0&&(T[o]=s[o]),T),i);return y}var KE={},JE={},QE={},l3;function lne(){return l3||(l3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){if(!i||typeof i!="object")return!1;const s=Object.getPrototypeOf(i);return s===null||s===Object.prototype||Object.getPrototypeOf(s)===null?Object.prototype.toString.call(i)==="[object Object]":!1}e.isPlainObject=t}(QE)),QE}var c3;function cne(){return c3||(c3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lne(),i=D5(),s=xM(),f=bM(),y=yM();function T(M,I,j){return o(M,I,void 0,void 0,void 0,void 0,j)}function o(M,I,j,q,K,J,te){const oe=te(M,I,j,q,K,J);if(oe!==void 0)return oe;if(typeof M==typeof I)switch(typeof M){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return M===I;case"number":return M===I||Object.is(M,I);case"function":return M===I;case"object":return C(M,I,J,te)}return C(M,I,J,te)}function C(M,I,j,q){if(Object.is(M,I))return!0;let K=s.getTag(M),J=s.getTag(I);if(K===f.argumentsTag&&(K=f.objectTag),J===f.argumentsTag&&(J=f.objectTag),K!==J)return!1;switch(K){case f.stringTag:return M.toString()===I.toString();case f.numberTag:{const ce=M.valueOf(),de=I.valueOf();return y.eq(ce,de)}case f.booleanTag:case f.dateTag:case f.symbolTag:return Object.is(M.valueOf(),I.valueOf());case f.regexpTag:return M.source===I.source&&M.flags===I.flags;case f.functionTag:return M===I}j=j??new Map;const te=j.get(M),oe=j.get(I);if(te!=null&&oe!=null)return te===I;j.set(M,I),j.set(I,M);try{switch(K){case f.mapTag:{if(M.size!==I.size)return!1;for(const[ce,de]of M.entries())if(!I.has(ce)||!o(de,I.get(ce),ce,M,I,j,q))return!1;return!0}case f.setTag:{if(M.size!==I.size)return!1;const ce=Array.from(M.values()),de=Array.from(I.values());for(let ue=0;ue<ce.length;ue++){const Pe=ce[ue],Oe=de.findIndex(xe=>o(Pe,xe,void 0,M,I,j,q));if(Oe===-1)return!1;de.splice(Oe,1)}return!0}case f.arrayTag:case f.uint8ArrayTag:case f.uint8ClampedArrayTag:case f.uint16ArrayTag:case f.uint32ArrayTag:case f.bigUint64ArrayTag:case f.int8ArrayTag:case f.int16ArrayTag:case f.int32ArrayTag:case f.bigInt64ArrayTag:case f.float32ArrayTag:case f.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(M)!==Buffer.isBuffer(I)||M.length!==I.length)return!1;for(let ce=0;ce<M.length;ce++)if(!o(M[ce],I[ce],ce,M,I,j,q))return!1;return!0}case f.arrayBufferTag:return M.byteLength!==I.byteLength?!1:C(new Uint8Array(M),new Uint8Array(I),j,q);case f.dataViewTag:return M.byteLength!==I.byteLength||M.byteOffset!==I.byteOffset?!1:C(new Uint8Array(M),new Uint8Array(I),j,q);case f.errorTag:return M.name===I.name&&M.message===I.message;case f.objectTag:{if(!(C(M.constructor,I.constructor,j,q)||t.isPlainObject(M)&&t.isPlainObject(I)))return!1;const de=[...Object.keys(M),...i.getSymbols(M)],ue=[...Object.keys(I),...i.getSymbols(I)];if(de.length!==ue.length)return!1;for(let Pe=0;Pe<de.length;Pe++){const Oe=de[Pe],xe=M[Oe];if(!Object.hasOwn(I,Oe))return!1;const Qe=I[Oe];if(!o(xe,Qe,Oe,M,I,j,q))return!1}return!0}default:return!1}}finally{j.delete(M),j.delete(I)}}e.isEqualWith=T}(JE)),JE}var eA={},u3;function une(){return u3||(u3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t}(eA)),eA}var h3;function hne(){return h3||(h3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cne(),i=une();function s(f,y){return t.isEqualWith(f,y,i.noop)}e.isEqual=s}(KE)),KE}var tA,d3;function dne(){return d3||(d3=1,tA=hne().isEqual),tA}var fne=dne();const pne=Zu(fne);function mne(e){var t={},i=()=>null,s=!1,f=null,y=T=>{if(!s){if(Array.isArray(T)){if(!T.length)return;var o=T,[C,...M]=o;if(typeof C=="number"){f=e.setTimeout(y.bind(null,M),C);return}y(C),f=e.setTimeout(y.bind(null,M));return}typeof T=="object"&&(t=T,i(t)),typeof T=="function"&&T()}};return{stop:()=>{s=!0},start:T=>{s=!1,f&&(f(),f=null),y(T)},subscribe:T=>(i=T,()=>{i=()=>null}),getTimeoutController:()=>e}}var U1=1e-4,v4=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],x4=(e,t)=>e.map((i,s)=>i*t**s).reduce((i,s)=>i+s),f3=(e,t)=>i=>{var s=v4(e,t);return x4(s,i)},gne=(e,t)=>i=>{var s=v4(e,t),f=[...s.map((y,T)=>y*T).slice(1),0];return x4(f,i)},p3=function(){for(var t,i,s,f,y=arguments.length,T=new Array(y),o=0;o<y;o++)T[o]=arguments[o];if(T.length===1)switch(T[0]){case"linear":[t,s,i,f]=[0,0,1,1];break;case"ease":[t,s,i,f]=[.25,.1,.25,1];break;case"ease-in":[t,s,i,f]=[.42,0,1,1];break;case"ease-out":[t,s,i,f]=[.42,0,.58,1];break;case"ease-in-out":[t,s,i,f]=[0,0,.58,1];break;default:{var C=T[0].split("(");C[0]==="cubic-bezier"&&C[1].split(")")[0].split(",").length===4&&([t,s,i,f]=C[1].split(")")[0].split(",").map(J=>parseFloat(J)))}}else T.length===4&&([t,s,i,f]=T);var M=f3(t,i),I=f3(s,f),j=gne(t,i),q=J=>J>1?1:J<0?0:J,K=J=>{for(var te=J>1?1:J,oe=te,ce=0;ce<8;++ce){var de=M(oe)-te,ue=j(oe);if(Math.abs(de-te)<U1||ue<U1)return I(oe);oe=q(oe-de/ue)}return I(oe)};return K.isStepper=!1,K},_ne=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:i=100,damping:s=8,dt:f=17}=t,y=(T,o,C)=>{var M=-(T-o)*i,I=C*s,j=C+(M-I)*f/1e3,q=C*f/1e3+T;return Math.abs(q-o)<U1&&Math.abs(j)<U1?[o,0]:[q,j]};return y.isStepper=!0,y.dt=f,y},yne=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return p3(e);case"spring":return _ne();default:if(e.split("(")[0]==="cubic-bezier")return p3(e)}return typeof e=="function"?e:null};function m3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function g3(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?m3(Object(i),!0).forEach(function(s){vne(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function vne(e,t,i){return(t=xne(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function xne(e){var t=bne(e,"string");return typeof t=="symbol"?t:t+""}function bne(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wne=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Tne=(e,t,i)=>e.map(s=>"".concat(wne(s)," ").concat(t,"ms ").concat(i)).join(","),Sne=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((i,s)=>i.filter(f=>s.includes(f))),Fx=(e,t)=>Object.keys(t).reduce((i,s)=>g3(g3({},i),{},{[s]:e(s,t[s])}),{});function _3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Ql(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?_3(Object(i),!0).forEach(function(s){Ene(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Ene(e,t,i){return(t=Ane(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ane(e){var t=Pne(e,"string");return typeof t=="symbol"?t:t+""}function Pne(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V1=(e,t,i)=>e+(t-e)*i,CP=e=>{var{from:t,to:i}=e;return t!==i},b4=(e,t,i)=>{var s=Fx((f,y)=>{if(CP(y)){var[T,o]=e(y.from,y.to,y.velocity);return Ql(Ql({},y),{},{from:T,velocity:o})}return y},t);return i<1?Fx((f,y)=>CP(y)?Ql(Ql({},y),{},{velocity:V1(y.velocity,s[f].velocity,i),from:V1(y.from,s[f].from,i)}):y,t):b4(e,s,i-1)};function Cne(e,t,i,s,f,y){var T,o=s.reduce((q,K)=>Ql(Ql({},q),{},{[K]:{from:e[K],velocity:0,to:t[K]}}),{}),C=()=>Fx((q,K)=>K.from,o),M=()=>!Object.values(o).filter(CP).length,I=null,j=q=>{T||(T=q);var K=q-T,J=K/i.dt;o=b4(i,o,J),f(Ql(Ql(Ql({},e),t),C())),T=q,M()||(I=y.setTimeout(j))};return()=>(I=y.setTimeout(j),()=>{I()})}function Mne(e,t,i,s,f,y,T){var o=null,C=f.reduce((j,q)=>Ql(Ql({},j),{},{[q]:[e[q],t[q]]}),{}),M,I=j=>{M||(M=j);var q=(j-M)/s,K=Fx((te,oe)=>V1(...oe,i(q)),C);if(y(Ql(Ql(Ql({},e),t),K)),q<1)o=T.setTimeout(I);else{var J=Fx((te,oe)=>V1(...oe,i(1)),C);y(Ql(Ql(Ql({},e),t),J))}};return()=>(o=T.setTimeout(I),()=>{o()})}const One=(e,t,i,s,f,y)=>{var T=Sne(e,t);return i.isStepper===!0?Cne(e,t,i,T,f,y):Mne(e,t,i,s,T,f,y)};class Ine{setTimeout(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),f=null,y=T=>{T-s>=i?t(T):typeof requestAnimationFrame=="function"&&(f=requestAnimationFrame(y))};return f=requestAnimationFrame(y),()=>{cancelAnimationFrame(f)}}}var Dne=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function MP(){return MP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},MP.apply(null,arguments)}function Rne(e,t){if(e==null)return{};var i,s,f=Lne(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function Lne(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function y3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function pg(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?y3(Object(i),!0).forEach(function(s){$_(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y3(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function $_(e,t,i){return(t=zne(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function zne(e){var t=kne(e,"string");return typeof t=="symbol"?t:t+""}function kne(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nne(){return mne(new Ine)}class kM extends me.PureComponent{constructor(t,i){super(t,i),$_(this,"mounted",!1),$_(this,"manager",null),$_(this,"stopJSAnimation",null),$_(this,"unSubscribe",null);var{isActive:s,attributeName:f,from:y,to:T,children:o,duration:C,animationManager:M}=this.props;if(this.manager=M,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!s||C<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:T});return}if(y){if(typeof o=="function"){this.state={style:y};return}this.state={style:f?{[f]:y}:y}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:i}=this.props;this.mounted=!0,!(!t||!i)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:i,canBegin:s,attributeName:f,shouldReAnimate:y,to:T,from:o}=this.props,{style:C}=this.state;if(s){if(!i){var M={style:f?{[f]:T}:T};this.state&&C&&(f&&C[f]!==T||!f&&C!==T)&&this.setState(M);return}if(!(pne(t.to,T)&&t.canBegin&&t.isActive)){var I=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var j=I||y?o:t.to;if(this.state&&C){var q={style:f?{[f]:j}:j};(f&&C[f]!==j||!f&&C!==j)&&this.setState(q)}this.runAnimation(pg(pg({},this.props),{},{from:j,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:i,to:s,duration:f,easing:y,begin:T,onAnimationEnd:o,onAnimationStart:C}=t,M=One(i,s,yne(y),f,this.changeStyle,this.manager.getTimeoutController()),I=()=>{this.stopJSAnimation=M()};this.manager.start([C,T,I,f,o])}runAnimation(t){var{begin:i,duration:s,attributeName:f,to:y,easing:T,onAnimationStart:o,onAnimationEnd:C,children:M}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof T=="function"||typeof M=="function"||T==="spring"){this.runJSAnimation(t);return}var I=f?{[f]:y}:y,j=Tne(Object.keys(I),s,T);this.manager.start([o,i,pg(pg({},I),{},{transition:j}),s,C])}render(){var t=this.props,{children:i,begin:s,duration:f,attributeName:y,easing:T,isActive:o,from:C,to:M,canBegin:I,onAnimationEnd:j,shouldReAnimate:q,onAnimationReStart:K,animationManager:J}=t,te=Rne(t,Dne),oe=me.Children.count(i),ce=this.state.style;if(typeof i=="function")return i(ce);if(!o||oe===0||f<=0)return i;var de=ue=>{var{style:Pe={},className:Oe}=ue.props,xe=me.cloneElement(ue,pg(pg({},te),{},{style:pg(pg({},Pe),ce),className:Oe}));return xe};return oe===1?de(me.Children.only(i)):me.createElement("div",null,me.Children.map(i,ue=>de(ue)))}}$_(kM,"displayName","Animate");$_(kM,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var Bne=me.createContext(null);function Ov(e){var t,i,s=me.useContext(Bne);return me.createElement(kM,MP({},e,{animationManager:(t=(i=e.animationManager)!==null&&i!==void 0?i:s)!==null&&t!==void 0?t:Nne()}))}function $1(){return $1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},$1.apply(null,arguments)}var v3=(e,t,i,s,f)=>{var y=Math.min(Math.abs(i)/2,Math.abs(s)/2),T=s>=0?1:-1,o=i>=0?1:-1,C=s>=0&&i>=0||s<0&&i<0?1:0,M;if(y>0&&f instanceof Array){for(var I=[0,0,0,0],j=0,q=4;j<q;j++)I[j]=f[j]>y?y:f[j];M="M".concat(e,",").concat(t+T*I[0]),I[0]>0&&(M+="A ".concat(I[0],",").concat(I[0],",0,0,").concat(C,",").concat(e+o*I[0],",").concat(t)),M+="L ".concat(e+i-o*I[1],",").concat(t),I[1]>0&&(M+="A ".concat(I[1],",").concat(I[1],",0,0,").concat(C,`,
        `).concat(e+i,",").concat(t+T*I[1])),M+="L ".concat(e+i,",").concat(t+s-T*I[2]),I[2]>0&&(M+="A ".concat(I[2],",").concat(I[2],",0,0,").concat(C,`,
        `).concat(e+i-o*I[2],",").concat(t+s)),M+="L ".concat(e+o*I[3],",").concat(t+s),I[3]>0&&(M+="A ".concat(I[3],",").concat(I[3],",0,0,").concat(C,`,
        `).concat(e,",").concat(t+s-T*I[3])),M+="Z"}else if(y>0&&f===+f&&f>0){var K=Math.min(y,f);M="M ".concat(e,",").concat(t+T*K,`
            A `).concat(K,",").concat(K,",0,0,").concat(C,",").concat(e+o*K,",").concat(t,`
            L `).concat(e+i-o*K,",").concat(t,`
            A `).concat(K,",").concat(K,",0,0,").concat(C,",").concat(e+i,",").concat(t+T*K,`
            L `).concat(e+i,",").concat(t+s-T*K,`
            A `).concat(K,",").concat(K,",0,0,").concat(C,",").concat(e+i-o*K,",").concat(t+s,`
            L `).concat(e+o*K,",").concat(t+s,`
            A `).concat(K,",").concat(K,",0,0,").concat(C,",").concat(e,",").concat(t+s-T*K," Z")}else M="M ".concat(e,",").concat(t," h ").concat(i," v ").concat(s," h ").concat(-i," Z");return M},jne={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},w4=e=>{var t=zg(e,jne),i=me.useRef(null),[s,f]=me.useState(-1);me.useEffect(()=>{if(i.current&&i.current.getTotalLength)try{var ce=i.current.getTotalLength();ce&&f(ce)}catch{}},[]);var{x:y,y:T,width:o,height:C,radius:M,className:I}=t,{animationEasing:j,animationDuration:q,animationBegin:K,isAnimationActive:J,isUpdateAnimationActive:te}=t;if(y!==+y||T!==+T||o!==+o||C!==+C||o===0||C===0)return null;var oe=Ya("recharts-rectangle",I);return te?me.createElement(Ov,{canBegin:s>0,from:{width:o,height:C,x:y,y:T},to:{width:o,height:C,x:y,y:T},duration:q,animationEasing:j,isActive:te},ce=>{var{width:de,height:ue,x:Pe,y:Oe}=ce;return me.createElement(Ov,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:K,duration:q,isActive:J,easing:j},me.createElement("path",$1({},gs(t,!0),{className:oe,d:v3(Pe,Oe,de,ue,M),ref:i})))}):me.createElement("path",$1({},gs(t,!0),{className:oe,d:v3(y,T,o,C,M)}))};function T4(e){var{cx:t,cy:i,radius:s,startAngle:f,endAngle:y}=e,T=ec(t,i,s,f),o=ec(t,i,s,y);return{points:[T,o],cx:t,cy:i,radius:s,startAngle:f,endAngle:y}}function OP(){return OP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},OP.apply(null,arguments)}var Fne=(e,t)=>{var i=Vu(t-e),s=Math.min(Math.abs(t-e),359.999);return i*s},Ww=e=>{var{cx:t,cy:i,radius:s,angle:f,sign:y,isExternal:T,cornerRadius:o,cornerIsExternal:C}=e,M=o*(T?1:-1)+s,I=Math.asin(o/M)/j1,j=C?f:f+y*I,q=ec(t,i,M,j),K=ec(t,i,s,j),J=C?f-y*I:f,te=ec(t,i,M*Math.cos(I*j1),J);return{center:q,circleTangency:K,lineTangency:te,theta:I}},S4=e=>{var{cx:t,cy:i,innerRadius:s,outerRadius:f,startAngle:y,endAngle:T}=e,o=Fne(y,T),C=y+o,M=ec(t,i,f,y),I=ec(t,i,f,C),j="M ".concat(M.x,",").concat(M.y,`
    A `).concat(f,",").concat(f,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(y>C),`,
    `).concat(I.x,",").concat(I.y,`
  `);if(s>0){var q=ec(t,i,s,y),K=ec(t,i,s,C);j+="L ".concat(K.x,",").concat(K.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(y<=C),`,
            `).concat(q.x,",").concat(q.y," Z")}else j+="L ".concat(t,",").concat(i," Z");return j},Une=e=>{var{cx:t,cy:i,innerRadius:s,outerRadius:f,cornerRadius:y,forceCornerRadius:T,cornerIsExternal:o,startAngle:C,endAngle:M}=e,I=Vu(M-C),{circleTangency:j,lineTangency:q,theta:K}=Ww({cx:t,cy:i,radius:f,angle:C,sign:I,cornerRadius:y,cornerIsExternal:o}),{circleTangency:J,lineTangency:te,theta:oe}=Ww({cx:t,cy:i,radius:f,angle:M,sign:-I,cornerRadius:y,cornerIsExternal:o}),ce=o?Math.abs(C-M):Math.abs(C-M)-K-oe;if(ce<0)return T?"M ".concat(q.x,",").concat(q.y,`
        a`).concat(y,",").concat(y,",0,0,1,").concat(y*2,`,0
        a`).concat(y,",").concat(y,",0,0,1,").concat(-y*2,`,0
      `):S4({cx:t,cy:i,innerRadius:s,outerRadius:f,startAngle:C,endAngle:M});var de="M ".concat(q.x,",").concat(q.y,`
    A`).concat(y,",").concat(y,",0,0,").concat(+(I<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(f,",").concat(f,",0,").concat(+(ce>180),",").concat(+(I<0),",").concat(J.x,",").concat(J.y,`
    A`).concat(y,",").concat(y,",0,0,").concat(+(I<0),",").concat(te.x,",").concat(te.y,`
  `);if(s>0){var{circleTangency:ue,lineTangency:Pe,theta:Oe}=Ww({cx:t,cy:i,radius:s,angle:C,sign:I,isExternal:!0,cornerRadius:y,cornerIsExternal:o}),{circleTangency:xe,lineTangency:Qe,theta:tt}=Ww({cx:t,cy:i,radius:s,angle:M,sign:-I,isExternal:!0,cornerRadius:y,cornerIsExternal:o}),Ge=o?Math.abs(C-M):Math.abs(C-M)-Oe-tt;if(Ge<0&&y===0)return"".concat(de,"L").concat(t,",").concat(i,"Z");de+="L".concat(Qe.x,",").concat(Qe.y,`
      A`).concat(y,",").concat(y,",0,0,").concat(+(I<0),",").concat(xe.x,",").concat(xe.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(Ge>180),",").concat(+(I>0),",").concat(ue.x,",").concat(ue.y,`
      A`).concat(y,",").concat(y,",0,0,").concat(+(I<0),",").concat(Pe.x,",").concat(Pe.y,"Z")}else de+="L".concat(t,",").concat(i,"Z");return de},Vne={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},E4=e=>{var t=zg(e,Vne),{cx:i,cy:s,innerRadius:f,outerRadius:y,cornerRadius:T,forceCornerRadius:o,cornerIsExternal:C,startAngle:M,endAngle:I,className:j}=t;if(y<f||M===I)return null;var q=Ya("recharts-sector",j),K=y-f,J=ff(T,K,0,!0),te;return J>0&&Math.abs(M-I)<360?te=Une({cx:i,cy:s,innerRadius:f,outerRadius:y,cornerRadius:Math.min(J,K/2),forceCornerRadius:o,cornerIsExternal:C,startAngle:M,endAngle:I}):te=S4({cx:i,cy:s,innerRadius:f,outerRadius:y,startAngle:M,endAngle:I}),me.createElement("path",OP({},gs(t,!0),{className:q,d:te}))};function $ne(e,t,i){var s,f,y,T;if(e==="horizontal")s=t.x,y=s,f=i.top,T=i.top+i.height;else if(e==="vertical")f=t.y,T=f,s=i.left,y=i.left+i.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:C,innerRadius:M,outerRadius:I,angle:j}=t,q=ec(o,C,M,j),K=ec(o,C,I,j);s=q.x,f=q.y,y=K.x,T=K.y}else return T4(t);return[{x:s,y:f},{x:y,y:T}]}var nA={},iA={},rA={},x3;function qne(){return x3||(x3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=N5();function i(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=i}(rA)),rA}var b3;function Hne(){return b3||(b3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qne();function i(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=i}(iA)),iA}var w3;function Gne(){return w3||(w3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B5(),i=Hne();function s(f,y,T){T&&typeof T!="number"&&t.isIterateeCall(f,y,T)&&(y=T=void 0),f=i.toFinite(f),y===void 0?(y=f,f=0):y=i.toFinite(y),T=T===void 0?f<y?1:-1:i.toFinite(T);const o=Math.max(Math.ceil((y-f)/(T||1)),0),C=new Array(o);for(let M=0;M<o;M++)C[M]=f,f+=T;return C}e.range=s}(nA)),nA}var oA,T3;function Zne(){return T3||(T3=1,oA=Gne().range),oA}var Wne=Zne();const A4=Zu(Wne);function Eg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Xne(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function NM(e){let t,i,s;e.length!==2?(t=Eg,i=(o,C)=>Eg(e(o),C),s=(o,C)=>e(o)-C):(t=e===Eg||e===Xne?e:Yne,i=e,s=e);function f(o,C,M=0,I=o.length){if(M<I){if(t(C,C)!==0)return I;do{const j=M+I>>>1;i(o[j],C)<0?M=j+1:I=j}while(M<I)}return M}function y(o,C,M=0,I=o.length){if(M<I){if(t(C,C)!==0)return I;do{const j=M+I>>>1;i(o[j],C)<=0?M=j+1:I=j}while(M<I)}return M}function T(o,C,M=0,I=o.length){const j=f(o,C,M,I-1);return j>M&&s(o[j-1],C)>-s(o[j],C)?j-1:j}return{left:f,center:T,right:y}}function Yne(){return 0}function P4(e){return e===null?NaN:+e}function*Kne(e,t){for(let i of e)i!=null&&(i=+i)>=i&&(yield i)}const Jne=NM(Eg),lb=Jne.right;NM(P4).center;class S3 extends Map{constructor(t,i=tie){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),t!=null)for(const[s,f]of t)this.set(s,f)}get(t){return super.get(E3(this,t))}has(t){return super.has(E3(this,t))}set(t,i){return super.set(Qne(this,t),i)}delete(t){return super.delete(eie(this,t))}}function E3({_intern:e,_key:t},i){const s=t(i);return e.has(s)?e.get(s):i}function Qne({_intern:e,_key:t},i){const s=t(i);return e.has(s)?e.get(s):(e.set(s,i),i)}function eie({_intern:e,_key:t},i){const s=t(i);return e.has(s)&&(i=e.get(s),e.delete(s)),i}function tie(e){return e!==null&&typeof e=="object"?e.valueOf():e}function nie(e=Eg){if(e===Eg)return C4;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,i)=>{const s=e(t,i);return s||s===0?s:(e(i,i)===0)-(e(t,t)===0)}}function C4(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const iie=Math.sqrt(50),rie=Math.sqrt(10),oie=Math.sqrt(2);function q1(e,t,i){const s=(t-e)/Math.max(0,i),f=Math.floor(Math.log10(s)),y=s/Math.pow(10,f),T=y>=iie?10:y>=rie?5:y>=oie?2:1;let o,C,M;return f<0?(M=Math.pow(10,-f)/T,o=Math.round(e*M),C=Math.round(t*M),o/M<e&&++o,C/M>t&&--C,M=-M):(M=Math.pow(10,f)*T,o=Math.round(e/M),C=Math.round(t/M),o*M<e&&++o,C*M>t&&--C),C<o&&.5<=i&&i<2?q1(e,t,i*2):[o,C,M]}function IP(e,t,i){if(t=+t,e=+e,i=+i,!(i>0))return[];if(e===t)return[e];const s=t<e,[f,y,T]=s?q1(t,e,i):q1(e,t,i);if(!(y>=f))return[];const o=y-f+1,C=new Array(o);if(s)if(T<0)for(let M=0;M<o;++M)C[M]=(y-M)/-T;else for(let M=0;M<o;++M)C[M]=(y-M)*T;else if(T<0)for(let M=0;M<o;++M)C[M]=(f+M)/-T;else for(let M=0;M<o;++M)C[M]=(f+M)*T;return C}function DP(e,t,i){return t=+t,e=+e,i=+i,q1(e,t,i)[2]}function RP(e,t,i){t=+t,e=+e,i=+i;const s=t<e,f=s?DP(t,e,i):DP(e,t,i);return(s?-1:1)*(f<0?1/-f:f)}function A3(e,t){let i;for(const s of e)s!=null&&(i<s||i===void 0&&s>=s)&&(i=s);return i}function P3(e,t){let i;for(const s of e)s!=null&&(i>s||i===void 0&&s>=s)&&(i=s);return i}function M4(e,t,i=0,s=1/0,f){if(t=Math.floor(t),i=Math.floor(Math.max(0,i)),s=Math.floor(Math.min(e.length-1,s)),!(i<=t&&t<=s))return e;for(f=f===void 0?C4:nie(f);s>i;){if(s-i>600){const C=s-i+1,M=t-i+1,I=Math.log(C),j=.5*Math.exp(2*I/3),q=.5*Math.sqrt(I*j*(C-j)/C)*(M-C/2<0?-1:1),K=Math.max(i,Math.floor(t-M*j/C+q)),J=Math.min(s,Math.floor(t+(C-M)*j/C+q));M4(e,t,K,J,f)}const y=e[t];let T=i,o=s;for(lx(e,i,t),f(e[s],y)>0&&lx(e,i,s);T<o;){for(lx(e,T,o),++T,--o;f(e[T],y)<0;)++T;for(;f(e[o],y)>0;)--o}f(e[i],y)===0?lx(e,i,o):(++o,lx(e,o,s)),o<=t&&(i=o+1),t<=o&&(s=o-1)}return e}function lx(e,t,i){const s=e[t];e[t]=e[i],e[i]=s}function aie(e,t,i){if(e=Float64Array.from(Kne(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return P3(e);if(t>=1)return A3(e);var s,f=(s-1)*t,y=Math.floor(f),T=A3(M4(e,y).subarray(0,y+1)),o=P3(e.subarray(y+1));return T+(o-T)*(f-y)}}function sie(e,t,i=P4){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+i(e[0],0,e);if(t>=1)return+i(e[s-1],s-1,e);var s,f=(s-1)*t,y=Math.floor(f),T=+i(e[y],y,e),o=+i(e[y+1],y+1,e);return T+(o-T)*(f-y)}}function lie(e,t,i){e=+e,t=+t,i=(f=arguments.length)<2?(t=e,e=0,1):f<3?1:+i;for(var s=-1,f=Math.max(0,Math.ceil((t-e)/i))|0,y=new Array(f);++s<f;)y[s]=e+s*i;return y}function Ed(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ym(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const LP=Symbol("implicit");function BM(){var e=new S3,t=[],i=[],s=LP;function f(y){let T=e.get(y);if(T===void 0){if(s!==LP)return s;e.set(y,T=t.push(y)-1)}return i[T%i.length]}return f.domain=function(y){if(!arguments.length)return t.slice();t=[],e=new S3;for(const T of y)e.has(T)||e.set(T,t.push(T)-1);return f},f.range=function(y){return arguments.length?(i=Array.from(y),f):i.slice()},f.unknown=function(y){return arguments.length?(s=y,f):s},f.copy=function(){return BM(t,i).unknown(s)},Ed.apply(f,arguments),f}function jM(){var e=BM().unknown(void 0),t=e.domain,i=e.range,s=0,f=1,y,T,o=!1,C=0,M=0,I=.5;delete e.unknown;function j(){var q=t().length,K=f<s,J=K?f:s,te=K?s:f;y=(te-J)/Math.max(1,q-C+M*2),o&&(y=Math.floor(y)),J+=(te-J-y*(q-C))*I,T=y*(1-C),o&&(J=Math.round(J),T=Math.round(T));var oe=lie(q).map(function(ce){return J+y*ce});return i(K?oe.reverse():oe)}return e.domain=function(q){return arguments.length?(t(q),j()):t()},e.range=function(q){return arguments.length?([s,f]=q,s=+s,f=+f,j()):[s,f]},e.rangeRound=function(q){return[s,f]=q,s=+s,f=+f,o=!0,j()},e.bandwidth=function(){return T},e.step=function(){return y},e.round=function(q){return arguments.length?(o=!!q,j()):o},e.padding=function(q){return arguments.length?(C=Math.min(1,M=+q),j()):C},e.paddingInner=function(q){return arguments.length?(C=Math.min(1,q),j()):C},e.paddingOuter=function(q){return arguments.length?(M=+q,j()):M},e.align=function(q){return arguments.length?(I=Math.max(0,Math.min(1,q)),j()):I},e.copy=function(){return jM(t(),[s,f]).round(o).paddingInner(C).paddingOuter(M).align(I)},Ed.apply(j(),arguments)}function O4(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return O4(t())},e}function cie(){return O4(jM.apply(null,arguments).paddingInner(1))}function FM(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function I4(e,t){var i=Object.create(e.prototype);for(var s in t)i[s]=t[s];return i}function cb(){}var Ux=.7,H1=1/Ux,wv="\\s*([+-]?\\d+)\\s*",Vx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uie=/^#([0-9a-f]{3,8})$/,hie=new RegExp(`^rgb\\(${wv},${wv},${wv}\\)$`),die=new RegExp(`^rgb\\(${cp},${cp},${cp}\\)$`),fie=new RegExp(`^rgba\\(${wv},${wv},${wv},${Vx}\\)$`),pie=new RegExp(`^rgba\\(${cp},${cp},${cp},${Vx}\\)$`),mie=new RegExp(`^hsl\\(${Vx},${cp},${cp}\\)$`),gie=new RegExp(`^hsla\\(${Vx},${cp},${cp},${Vx}\\)$`),C3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};FM(cb,$x,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:M3,formatHex:M3,formatHex8:_ie,formatHsl:yie,formatRgb:O3,toString:O3});function M3(){return this.rgb().formatHex()}function _ie(){return this.rgb().formatHex8()}function yie(){return D4(this).formatHsl()}function O3(){return this.rgb().formatRgb()}function $x(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=uie.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?I3(t):i===3?new $u(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?Xw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?Xw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=hie.exec(e))?new $u(t[1],t[2],t[3],1):(t=die.exec(e))?new $u(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fie.exec(e))?Xw(t[1],t[2],t[3],t[4]):(t=pie.exec(e))?Xw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=mie.exec(e))?L3(t[1],t[2]/100,t[3]/100,1):(t=gie.exec(e))?L3(t[1],t[2]/100,t[3]/100,t[4]):C3.hasOwnProperty(e)?I3(C3[e]):e==="transparent"?new $u(NaN,NaN,NaN,0):null}function I3(e){return new $u(e>>16&255,e>>8&255,e&255,1)}function Xw(e,t,i,s){return s<=0&&(e=t=i=NaN),new $u(e,t,i,s)}function vie(e){return e instanceof cb||(e=$x(e)),e?(e=e.rgb(),new $u(e.r,e.g,e.b,e.opacity)):new $u}function zP(e,t,i,s){return arguments.length===1?vie(e):new $u(e,t,i,s??1)}function $u(e,t,i,s){this.r=+e,this.g=+t,this.b=+i,this.opacity=+s}FM($u,zP,I4(cb,{brighter(e){return e=e==null?H1:Math.pow(H1,e),new $u(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ux:Math.pow(Ux,e),new $u(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $u(Q_(this.r),Q_(this.g),Q_(this.b),G1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:D3,formatHex:D3,formatHex8:xie,formatRgb:R3,toString:R3}));function D3(){return`#${q_(this.r)}${q_(this.g)}${q_(this.b)}`}function xie(){return`#${q_(this.r)}${q_(this.g)}${q_(this.b)}${q_((isNaN(this.opacity)?1:this.opacity)*255)}`}function R3(){const e=G1(this.opacity);return`${e===1?"rgb(":"rgba("}${Q_(this.r)}, ${Q_(this.g)}, ${Q_(this.b)}${e===1?")":`, ${e})`}`}function G1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Q_(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function q_(e){return e=Q_(e),(e<16?"0":"")+e.toString(16)}function L3(e,t,i,s){return s<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new df(e,t,i,s)}function D4(e){if(e instanceof df)return new df(e.h,e.s,e.l,e.opacity);if(e instanceof cb||(e=$x(e)),!e)return new df;if(e instanceof df)return e;e=e.rgb();var t=e.r/255,i=e.g/255,s=e.b/255,f=Math.min(t,i,s),y=Math.max(t,i,s),T=NaN,o=y-f,C=(y+f)/2;return o?(t===y?T=(i-s)/o+(i<s)*6:i===y?T=(s-t)/o+2:T=(t-i)/o+4,o/=C<.5?y+f:2-y-f,T*=60):o=C>0&&C<1?0:T,new df(T,o,C,e.opacity)}function bie(e,t,i,s){return arguments.length===1?D4(e):new df(e,t,i,s??1)}function df(e,t,i,s){this.h=+e,this.s=+t,this.l=+i,this.opacity=+s}FM(df,bie,I4(cb,{brighter(e){return e=e==null?H1:Math.pow(H1,e),new df(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ux:Math.pow(Ux,e),new df(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,s=i+(i<.5?i:1-i)*t,f=2*i-s;return new $u(aA(e>=240?e-240:e+120,f,s),aA(e,f,s),aA(e<120?e+240:e-120,f,s),this.opacity)},clamp(){return new df(z3(this.h),Yw(this.s),Yw(this.l),G1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=G1(this.opacity);return`${e===1?"hsl(":"hsla("}${z3(this.h)}, ${Yw(this.s)*100}%, ${Yw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function z3(e){return e=(e||0)%360,e<0?e+360:e}function Yw(e){return Math.max(0,Math.min(1,e||0))}function aA(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}const UM=e=>()=>e;function wie(e,t){return function(i){return e+i*t}}function Tie(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(s){return Math.pow(e+s*t,i)}}function Sie(e){return(e=+e)==1?R4:function(t,i){return i-t?Tie(t,i,e):UM(isNaN(t)?i:t)}}function R4(e,t){var i=t-e;return i?wie(e,i):UM(isNaN(e)?t:e)}const k3=function e(t){var i=Sie(t);function s(f,y){var T=i((f=zP(f)).r,(y=zP(y)).r),o=i(f.g,y.g),C=i(f.b,y.b),M=R4(f.opacity,y.opacity);return function(I){return f.r=T(I),f.g=o(I),f.b=C(I),f.opacity=M(I),f+""}}return s.gamma=e,s}(1);function Eie(e,t){t||(t=[]);var i=e?Math.min(t.length,e.length):0,s=t.slice(),f;return function(y){for(f=0;f<i;++f)s[f]=e[f]*(1-y)+t[f]*y;return s}}function Aie(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Pie(e,t){var i=t?t.length:0,s=e?Math.min(i,e.length):0,f=new Array(s),y=new Array(i),T;for(T=0;T<s;++T)f[T]=$v(e[T],t[T]);for(;T<i;++T)y[T]=t[T];return function(o){for(T=0;T<s;++T)y[T]=f[T](o);return y}}function Cie(e,t){var i=new Date;return e=+e,t=+t,function(s){return i.setTime(e*(1-s)+t*s),i}}function Z1(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function Mie(e,t){var i={},s={},f;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(f in t)f in e?i[f]=$v(e[f],t[f]):s[f]=t[f];return function(y){for(f in i)s[f]=i[f](y);return s}}var kP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sA=new RegExp(kP.source,"g");function Oie(e){return function(){return e}}function Iie(e){return function(t){return e(t)+""}}function Die(e,t){var i=kP.lastIndex=sA.lastIndex=0,s,f,y,T=-1,o=[],C=[];for(e=e+"",t=t+"";(s=kP.exec(e))&&(f=sA.exec(t));)(y=f.index)>i&&(y=t.slice(i,y),o[T]?o[T]+=y:o[++T]=y),(s=s[0])===(f=f[0])?o[T]?o[T]+=f:o[++T]=f:(o[++T]=null,C.push({i:T,x:Z1(s,f)})),i=sA.lastIndex;return i<t.length&&(y=t.slice(i),o[T]?o[T]+=y:o[++T]=y),o.length<2?C[0]?Iie(C[0].x):Oie(t):(t=C.length,function(M){for(var I=0,j;I<t;++I)o[(j=C[I]).i]=j.x(M);return o.join("")})}function $v(e,t){var i=typeof t,s;return t==null||i==="boolean"?UM(t):(i==="number"?Z1:i==="string"?(s=$x(t))?(t=s,k3):Die:t instanceof $x?k3:t instanceof Date?Cie:Aie(t)?Eie:Array.isArray(t)?Pie:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Mie:Z1)(e,t)}function VM(e,t){return e=+e,t=+t,function(i){return Math.round(e*(1-i)+t*i)}}function Rie(e,t){t===void 0&&(t=e,e=$v);for(var i=0,s=t.length-1,f=t[0],y=new Array(s<0?0:s);i<s;)y[i]=e(f,f=t[++i]);return function(T){var o=Math.max(0,Math.min(s-1,Math.floor(T*=s)));return y[o](T-o)}}function Lie(e){return function(){return e}}function W1(e){return+e}var N3=[0,1];function au(e){return e}function NP(e,t){return(t-=e=+e)?function(i){return(i-e)/t}:Lie(isNaN(t)?NaN:.5)}function zie(e,t){var i;return e>t&&(i=e,e=t,t=i),function(s){return Math.max(e,Math.min(t,s))}}function kie(e,t,i){var s=e[0],f=e[1],y=t[0],T=t[1];return f<s?(s=NP(f,s),y=i(T,y)):(s=NP(s,f),y=i(y,T)),function(o){return y(s(o))}}function Nie(e,t,i){var s=Math.min(e.length,t.length)-1,f=new Array(s),y=new Array(s),T=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++T<s;)f[T]=NP(e[T],e[T+1]),y[T]=i(t[T],t[T+1]);return function(o){var C=lb(e,o,1,s)-1;return y[C](f[C](o))}}function ub(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function qT(){var e=N3,t=N3,i=$v,s,f,y,T=au,o,C,M;function I(){var q=Math.min(e.length,t.length);return T!==au&&(T=zie(e[0],e[q-1])),o=q>2?Nie:kie,C=M=null,j}function j(q){return q==null||isNaN(q=+q)?y:(C||(C=o(e.map(s),t,i)))(s(T(q)))}return j.invert=function(q){return T(f((M||(M=o(t,e.map(s),Z1)))(q)))},j.domain=function(q){return arguments.length?(e=Array.from(q,W1),I()):e.slice()},j.range=function(q){return arguments.length?(t=Array.from(q),I()):t.slice()},j.rangeRound=function(q){return t=Array.from(q),i=VM,I()},j.clamp=function(q){return arguments.length?(T=q?!0:au,I()):T!==au},j.interpolate=function(q){return arguments.length?(i=q,I()):i},j.unknown=function(q){return arguments.length?(y=q,j):y},function(q,K){return s=q,f=K,I()}}function $M(){return qT()(au,au)}function Bie(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function X1(e,t){if((i=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var i,s=e.slice(0,i);return[s.length>1?s[0]+s.slice(2):s,+e.slice(i+1)]}function Iv(e){return e=X1(Math.abs(e)),e?e[1]:NaN}function jie(e,t){return function(i,s){for(var f=i.length,y=[],T=0,o=e[0],C=0;f>0&&o>0&&(C+o+1>s&&(o=Math.max(1,s-C)),y.push(i.substring(f-=o,f+o)),!((C+=o+1)>s));)o=e[T=(T+1)%e.length];return y.reverse().join(t)}}function Fie(e){return function(t){return t.replace(/[0-9]/g,function(i){return e[+i]})}}var Uie=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qx(e){if(!(t=Uie.exec(e)))throw new Error("invalid format: "+e);var t;return new qM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}qx.prototype=qM.prototype;function qM(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}qM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Vie(e){e:for(var t=e.length,i=1,s=-1,f;i<t;++i)switch(e[i]){case".":s=f=i;break;case"0":s===0&&(s=i),f=i;break;default:if(!+e[i])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(f+1):e}var L4;function $ie(e,t){var i=X1(e,t);if(!i)return e+"";var s=i[0],f=i[1],y=f-(L4=Math.max(-8,Math.min(8,Math.floor(f/3)))*3)+1,T=s.length;return y===T?s:y>T?s+new Array(y-T+1).join("0"):y>0?s.slice(0,y)+"."+s.slice(y):"0."+new Array(1-y).join("0")+X1(e,Math.max(0,t+y-1))[0]}function B3(e,t){var i=X1(e,t);if(!i)return e+"";var s=i[0],f=i[1];return f<0?"0."+new Array(-f).join("0")+s:s.length>f+1?s.slice(0,f+1)+"."+s.slice(f+1):s+new Array(f-s.length+2).join("0")}const j3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Bie,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>B3(e*100,t),r:B3,s:$ie,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function F3(e){return e}var U3=Array.prototype.map,V3=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function qie(e){var t=e.grouping===void 0||e.thousands===void 0?F3:jie(U3.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",f=e.decimal===void 0?".":e.decimal+"",y=e.numerals===void 0?F3:Fie(U3.call(e.numerals,String)),T=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",C=e.nan===void 0?"NaN":e.nan+"";function M(j){j=qx(j);var q=j.fill,K=j.align,J=j.sign,te=j.symbol,oe=j.zero,ce=j.width,de=j.comma,ue=j.precision,Pe=j.trim,Oe=j.type;Oe==="n"?(de=!0,Oe="g"):j3[Oe]||(ue===void 0&&(ue=12),Pe=!0,Oe="g"),(oe||q==="0"&&K==="=")&&(oe=!0,q="0",K="=");var xe=te==="$"?i:te==="#"&&/[boxX]/.test(Oe)?"0"+Oe.toLowerCase():"",Qe=te==="$"?s:/[%p]/.test(Oe)?T:"",tt=j3[Oe],Ge=/[defgprs%]/.test(Oe);ue=ue===void 0?6:/[gprs]/.test(Oe)?Math.max(1,Math.min(21,ue)):Math.max(0,Math.min(20,ue));function Je(Ve){var xt=xe,yt=Qe,ot,zt,rt;if(Oe==="c")yt=tt(Ve)+yt,Ve="";else{Ve=+Ve;var Bt=Ve<0||1/Ve<0;if(Ve=isNaN(Ve)?C:tt(Math.abs(Ve),ue),Pe&&(Ve=Vie(Ve)),Bt&&+Ve==0&&J!=="+"&&(Bt=!1),xt=(Bt?J==="("?J:o:J==="-"||J==="("?"":J)+xt,yt=(Oe==="s"?V3[8+L4/3]:"")+yt+(Bt&&J==="("?")":""),Ge){for(ot=-1,zt=Ve.length;++ot<zt;)if(rt=Ve.charCodeAt(ot),48>rt||rt>57){yt=(rt===46?f+Ve.slice(ot+1):Ve.slice(ot))+yt,Ve=Ve.slice(0,ot);break}}}de&&!oe&&(Ve=t(Ve,1/0));var Vt=xt.length+Ve.length+yt.length,Ln=Vt<ce?new Array(ce-Vt+1).join(q):"";switch(de&&oe&&(Ve=t(Ln+Ve,Ln.length?ce-yt.length:1/0),Ln=""),K){case"<":Ve=xt+Ve+yt+Ln;break;case"=":Ve=xt+Ln+Ve+yt;break;case"^":Ve=Ln.slice(0,Vt=Ln.length>>1)+xt+Ve+yt+Ln.slice(Vt);break;default:Ve=Ln+xt+Ve+yt;break}return y(Ve)}return Je.toString=function(){return j+""},Je}function I(j,q){var K=M((j=qx(j),j.type="f",j)),J=Math.max(-8,Math.min(8,Math.floor(Iv(q)/3)))*3,te=Math.pow(10,-J),oe=V3[8+J/3];return function(ce){return K(te*ce)+oe}}return{format:M,formatPrefix:I}}var Kw,HM,z4;Hie({thousands:",",grouping:[3],currency:["$",""]});function Hie(e){return Kw=qie(e),HM=Kw.format,z4=Kw.formatPrefix,Kw}function Gie(e){return Math.max(0,-Iv(Math.abs(e)))}function Zie(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Iv(t)/3)))*3-Iv(Math.abs(e)))}function Wie(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Iv(t)-Iv(e))+1}function k4(e,t,i,s){var f=RP(e,t,i),y;switch(s=qx(s??",f"),s.type){case"s":{var T=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(y=Zie(f,T))&&(s.precision=y),z4(s,T)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(y=Wie(f,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=y-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(y=Gie(f))&&(s.precision=y-(s.type==="%")*2);break}}return HM(s)}function kg(e){var t=e.domain;return e.ticks=function(i){var s=t();return IP(s[0],s[s.length-1],i??10)},e.tickFormat=function(i,s){var f=t();return k4(f[0],f[f.length-1],i??10,s)},e.nice=function(i){i==null&&(i=10);var s=t(),f=0,y=s.length-1,T=s[f],o=s[y],C,M,I=10;for(o<T&&(M=T,T=o,o=M,M=f,f=y,y=M);I-- >0;){if(M=DP(T,o,i),M===C)return s[f]=T,s[y]=o,t(s);if(M>0)T=Math.floor(T/M)*M,o=Math.ceil(o/M)*M;else if(M<0)T=Math.ceil(T*M)/M,o=Math.floor(o*M)/M;else break;C=M}return e},e}function N4(){var e=$M();return e.copy=function(){return ub(e,N4())},Ed.apply(e,arguments),kg(e)}function B4(e){var t;function i(s){return s==null||isNaN(s=+s)?t:s}return i.invert=i,i.domain=i.range=function(s){return arguments.length?(e=Array.from(s,W1),i):e.slice()},i.unknown=function(s){return arguments.length?(t=s,i):t},i.copy=function(){return B4(e).unknown(t)},e=arguments.length?Array.from(e,W1):[0,1],kg(i)}function j4(e,t){e=e.slice();var i=0,s=e.length-1,f=e[i],y=e[s],T;return y<f&&(T=i,i=s,s=T,T=f,f=y,y=T),e[i]=t.floor(f),e[s]=t.ceil(y),e}function $3(e){return Math.log(e)}function q3(e){return Math.exp(e)}function Xie(e){return-Math.log(-e)}function Yie(e){return-Math.exp(-e)}function Kie(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Jie(e){return e===10?Kie:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Qie(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function H3(e){return(t,i)=>-e(-t,i)}function GM(e){const t=e($3,q3),i=t.domain;let s=10,f,y;function T(){return f=Qie(s),y=Jie(s),i()[0]<0?(f=H3(f),y=H3(y),e(Xie,Yie)):e($3,q3),t}return t.base=function(o){return arguments.length?(s=+o,T()):s},t.domain=function(o){return arguments.length?(i(o),T()):i()},t.ticks=o=>{const C=i();let M=C[0],I=C[C.length-1];const j=I<M;j&&([M,I]=[I,M]);let q=f(M),K=f(I),J,te;const oe=o==null?10:+o;let ce=[];if(!(s%1)&&K-q<oe){if(q=Math.floor(q),K=Math.ceil(K),M>0){for(;q<=K;++q)for(J=1;J<s;++J)if(te=q<0?J/y(-q):J*y(q),!(te<M)){if(te>I)break;ce.push(te)}}else for(;q<=K;++q)for(J=s-1;J>=1;--J)if(te=q>0?J/y(-q):J*y(q),!(te<M)){if(te>I)break;ce.push(te)}ce.length*2<oe&&(ce=IP(M,I,oe))}else ce=IP(q,K,Math.min(K-q,oe)).map(y);return j?ce.reverse():ce},t.tickFormat=(o,C)=>{if(o==null&&(o=10),C==null&&(C=s===10?"s":","),typeof C!="function"&&(!(s%1)&&(C=qx(C)).precision==null&&(C.trim=!0),C=HM(C)),o===1/0)return C;const M=Math.max(1,s*o/t.ticks().length);return I=>{let j=I/y(Math.round(f(I)));return j*s<s-.5&&(j*=s),j<=M?C(I):""}},t.nice=()=>i(j4(i(),{floor:o=>y(Math.floor(f(o))),ceil:o=>y(Math.ceil(f(o)))})),t}function F4(){const e=GM(qT()).domain([1,10]);return e.copy=()=>ub(e,F4()).base(e.base()),Ed.apply(e,arguments),e}function G3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Z3(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ZM(e){var t=1,i=e(G3(t),Z3(t));return i.constant=function(s){return arguments.length?e(G3(t=+s),Z3(t)):t},kg(i)}function U4(){var e=ZM(qT());return e.copy=function(){return ub(e,U4()).constant(e.constant())},Ed.apply(e,arguments)}function W3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ere(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function tre(e){return e<0?-e*e:e*e}function WM(e){var t=e(au,au),i=1;function s(){return i===1?e(au,au):i===.5?e(ere,tre):e(W3(i),W3(1/i))}return t.exponent=function(f){return arguments.length?(i=+f,s()):i},kg(t)}function XM(){var e=WM(qT());return e.copy=function(){return ub(e,XM()).exponent(e.exponent())},Ed.apply(e,arguments),e}function nre(){return XM.apply(null,arguments).exponent(.5)}function X3(e){return Math.sign(e)*e*e}function ire(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function V4(){var e=$M(),t=[0,1],i=!1,s;function f(y){var T=ire(e(y));return isNaN(T)?s:i?Math.round(T):T}return f.invert=function(y){return e.invert(X3(y))},f.domain=function(y){return arguments.length?(e.domain(y),f):e.domain()},f.range=function(y){return arguments.length?(e.range((t=Array.from(y,W1)).map(X3)),f):t.slice()},f.rangeRound=function(y){return f.range(y).round(!0)},f.round=function(y){return arguments.length?(i=!!y,f):i},f.clamp=function(y){return arguments.length?(e.clamp(y),f):e.clamp()},f.unknown=function(y){return arguments.length?(s=y,f):s},f.copy=function(){return V4(e.domain(),t).round(i).clamp(e.clamp()).unknown(s)},Ed.apply(f,arguments),kg(f)}function $4(){var e=[],t=[],i=[],s;function f(){var T=0,o=Math.max(1,t.length);for(i=new Array(o-1);++T<o;)i[T-1]=sie(e,T/o);return y}function y(T){return T==null||isNaN(T=+T)?s:t[lb(i,T)]}return y.invertExtent=function(T){var o=t.indexOf(T);return o<0?[NaN,NaN]:[o>0?i[o-1]:e[0],o<i.length?i[o]:e[e.length-1]]},y.domain=function(T){if(!arguments.length)return e.slice();e=[];for(let o of T)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Eg),f()},y.range=function(T){return arguments.length?(t=Array.from(T),f()):t.slice()},y.unknown=function(T){return arguments.length?(s=T,y):s},y.quantiles=function(){return i.slice()},y.copy=function(){return $4().domain(e).range(t).unknown(s)},Ed.apply(y,arguments)}function q4(){var e=0,t=1,i=1,s=[.5],f=[0,1],y;function T(C){return C!=null&&C<=C?f[lb(s,C,0,i)]:y}function o(){var C=-1;for(s=new Array(i);++C<i;)s[C]=((C+1)*t-(C-i)*e)/(i+1);return T}return T.domain=function(C){return arguments.length?([e,t]=C,e=+e,t=+t,o()):[e,t]},T.range=function(C){return arguments.length?(i=(f=Array.from(C)).length-1,o()):f.slice()},T.invertExtent=function(C){var M=f.indexOf(C);return M<0?[NaN,NaN]:M<1?[e,s[0]]:M>=i?[s[i-1],t]:[s[M-1],s[M]]},T.unknown=function(C){return arguments.length&&(y=C),T},T.thresholds=function(){return s.slice()},T.copy=function(){return q4().domain([e,t]).range(f).unknown(y)},Ed.apply(kg(T),arguments)}function H4(){var e=[.5],t=[0,1],i,s=1;function f(y){return y!=null&&y<=y?t[lb(e,y,0,s)]:i}return f.domain=function(y){return arguments.length?(e=Array.from(y),s=Math.min(e.length,t.length-1),f):e.slice()},f.range=function(y){return arguments.length?(t=Array.from(y),s=Math.min(e.length,t.length-1),f):t.slice()},f.invertExtent=function(y){var T=t.indexOf(y);return[e[T-1],e[T]]},f.unknown=function(y){return arguments.length?(i=y,f):i},f.copy=function(){return H4().domain(e).range(t).unknown(i)},Ed.apply(f,arguments)}const lA=new Date,cA=new Date;function Dl(e,t,i,s){function f(y){return e(y=arguments.length===0?new Date:new Date(+y)),y}return f.floor=y=>(e(y=new Date(+y)),y),f.ceil=y=>(e(y=new Date(y-1)),t(y,1),e(y),y),f.round=y=>{const T=f(y),o=f.ceil(y);return y-T<o-y?T:o},f.offset=(y,T)=>(t(y=new Date(+y),T==null?1:Math.floor(T)),y),f.range=(y,T,o)=>{const C=[];if(y=f.ceil(y),o=o==null?1:Math.floor(o),!(y<T)||!(o>0))return C;let M;do C.push(M=new Date(+y)),t(y,o),e(y);while(M<y&&y<T);return C},f.filter=y=>Dl(T=>{if(T>=T)for(;e(T),!y(T);)T.setTime(T-1)},(T,o)=>{if(T>=T)if(o<0)for(;++o<=0;)for(;t(T,-1),!y(T););else for(;--o>=0;)for(;t(T,1),!y(T););}),i&&(f.count=(y,T)=>(lA.setTime(+y),cA.setTime(+T),e(lA),e(cA),Math.floor(i(lA,cA))),f.every=y=>(y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?f.filter(s?T=>s(T)%y===0:T=>f.count(0,T)%y===0):f)),f}const Y1=Dl(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Y1.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Dl(t=>{t.setTime(Math.floor(t/e)*e)},(t,i)=>{t.setTime(+t+i*e)},(t,i)=>(i-t)/e):Y1);Y1.range;const lm=1e3,_d=lm*60,cm=_d*60,mm=cm*24,YM=mm*7,Y3=mm*30,uA=mm*365,H_=Dl(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*lm)},(e,t)=>(t-e)/lm,e=>e.getUTCSeconds());H_.range;const KM=Dl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*lm)},(e,t)=>{e.setTime(+e+t*_d)},(e,t)=>(t-e)/_d,e=>e.getMinutes());KM.range;const JM=Dl(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*_d)},(e,t)=>(t-e)/_d,e=>e.getUTCMinutes());JM.range;const QM=Dl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*lm-e.getMinutes()*_d)},(e,t)=>{e.setTime(+e+t*cm)},(e,t)=>(t-e)/cm,e=>e.getHours());QM.range;const eO=Dl(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*cm)},(e,t)=>(t-e)/cm,e=>e.getUTCHours());eO.range;const hb=Dl(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_d)/mm,e=>e.getDate()-1);hb.range;const HT=Dl(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mm,e=>e.getUTCDate()-1);HT.range;const G4=Dl(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mm,e=>Math.floor(e/mm));G4.range;function dy(e){return Dl(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,i)=>{t.setDate(t.getDate()+i*7)},(t,i)=>(i-t-(i.getTimezoneOffset()-t.getTimezoneOffset())*_d)/YM)}const GT=dy(0),K1=dy(1),rre=dy(2),ore=dy(3),Dv=dy(4),are=dy(5),sre=dy(6);GT.range;K1.range;rre.range;ore.range;Dv.range;are.range;sre.range;function fy(e){return Dl(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCDate(t.getUTCDate()+i*7)},(t,i)=>(i-t)/YM)}const ZT=fy(0),J1=fy(1),lre=fy(2),cre=fy(3),Rv=fy(4),ure=fy(5),hre=fy(6);ZT.range;J1.range;lre.range;cre.range;Rv.range;ure.range;hre.range;const tO=Dl(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());tO.range;const nO=Dl(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());nO.range;const gm=Dl(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());gm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Dl(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,i)=>{t.setFullYear(t.getFullYear()+i*e)});gm.range;const _m=Dl(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_m.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Dl(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCFullYear(t.getUTCFullYear()+i*e)});_m.range;function Z4(e,t,i,s,f,y){const T=[[H_,1,lm],[H_,5,5*lm],[H_,15,15*lm],[H_,30,30*lm],[y,1,_d],[y,5,5*_d],[y,15,15*_d],[y,30,30*_d],[f,1,cm],[f,3,3*cm],[f,6,6*cm],[f,12,12*cm],[s,1,mm],[s,2,2*mm],[i,1,YM],[t,1,Y3],[t,3,3*Y3],[e,1,uA]];function o(M,I,j){const q=I<M;q&&([M,I]=[I,M]);const K=j&&typeof j.range=="function"?j:C(M,I,j),J=K?K.range(M,+I+1):[];return q?J.reverse():J}function C(M,I,j){const q=Math.abs(I-M)/j,K=NM(([,,oe])=>oe).right(T,q);if(K===T.length)return e.every(RP(M/uA,I/uA,j));if(K===0)return Y1.every(Math.max(RP(M,I,j),1));const[J,te]=T[q/T[K-1][2]<T[K][2]/q?K-1:K];return J.every(te)}return[o,C]}const[dre,fre]=Z4(_m,nO,ZT,G4,eO,JM),[pre,mre]=Z4(gm,tO,GT,hb,QM,KM);function hA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function dA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function cx(e,t,i){return{y:e,m:t,d:i,H:0,M:0,S:0,L:0}}function gre(e){var t=e.dateTime,i=e.date,s=e.time,f=e.periods,y=e.days,T=e.shortDays,o=e.months,C=e.shortMonths,M=ux(f),I=hx(f),j=ux(y),q=hx(y),K=ux(T),J=hx(T),te=ux(o),oe=hx(o),ce=ux(C),de=hx(C),ue={a:Bt,A:Vt,b:Ln,B:$e,c:null,d:nN,e:nN,f:jre,g:Xre,G:Kre,H:kre,I:Nre,j:Bre,L:W4,m:Fre,M:Ure,p:Pt,q:$t,Q:oN,s:aN,S:Vre,u:$re,U:qre,V:Hre,w:Gre,W:Zre,x:null,X:null,y:Wre,Y:Yre,Z:Jre,"%":rN},Pe={a:on,A:An,b:ct,B:kt,c:null,d:iN,e:iN,f:noe,g:doe,G:poe,H:Qre,I:eoe,j:toe,L:Y4,m:ioe,M:roe,p:In,q:ti,Q:oN,s:aN,S:ooe,u:aoe,U:soe,V:loe,w:coe,W:uoe,x:null,X:null,y:hoe,Y:foe,Z:moe,"%":rN},Oe={a:Je,A:Ve,b:xt,B:yt,c:ot,d:eN,e:eN,f:Dre,g:Q3,G:J3,H:tN,I:tN,j:Cre,L:Ire,m:Pre,M:Mre,p:Ge,q:Are,Q:Lre,s:zre,S:Ore,u:bre,U:wre,V:Tre,w:xre,W:Sre,x:zt,X:rt,y:Q3,Y:J3,Z:Ere,"%":Rre};ue.x=xe(i,ue),ue.X=xe(s,ue),ue.c=xe(t,ue),Pe.x=xe(i,Pe),Pe.X=xe(s,Pe),Pe.c=xe(t,Pe);function xe(Dt,jn){return function(ai){var mn=[],ci=-1,Ii=0,Mi=Dt.length,Tr,kr,ja;for(ai instanceof Date||(ai=new Date(+ai));++ci<Mi;)Dt.charCodeAt(ci)===37&&(mn.push(Dt.slice(Ii,ci)),(kr=K3[Tr=Dt.charAt(++ci)])!=null?Tr=Dt.charAt(++ci):kr=Tr==="e"?" ":"0",(ja=jn[Tr])&&(Tr=ja(ai,kr)),mn.push(Tr),Ii=ci+1);return mn.push(Dt.slice(Ii,ci)),mn.join("")}}function Qe(Dt,jn){return function(ai){var mn=cx(1900,void 0,1),ci=tt(mn,Dt,ai+="",0),Ii,Mi;if(ci!=ai.length)return null;if("Q"in mn)return new Date(mn.Q);if("s"in mn)return new Date(mn.s*1e3+("L"in mn?mn.L:0));if(jn&&!("Z"in mn)&&(mn.Z=0),"p"in mn&&(mn.H=mn.H%12+mn.p*12),mn.m===void 0&&(mn.m="q"in mn?mn.q:0),"V"in mn){if(mn.V<1||mn.V>53)return null;"w"in mn||(mn.w=1),"Z"in mn?(Ii=dA(cx(mn.y,0,1)),Mi=Ii.getUTCDay(),Ii=Mi>4||Mi===0?J1.ceil(Ii):J1(Ii),Ii=HT.offset(Ii,(mn.V-1)*7),mn.y=Ii.getUTCFullYear(),mn.m=Ii.getUTCMonth(),mn.d=Ii.getUTCDate()+(mn.w+6)%7):(Ii=hA(cx(mn.y,0,1)),Mi=Ii.getDay(),Ii=Mi>4||Mi===0?K1.ceil(Ii):K1(Ii),Ii=hb.offset(Ii,(mn.V-1)*7),mn.y=Ii.getFullYear(),mn.m=Ii.getMonth(),mn.d=Ii.getDate()+(mn.w+6)%7)}else("W"in mn||"U"in mn)&&("w"in mn||(mn.w="u"in mn?mn.u%7:"W"in mn?1:0),Mi="Z"in mn?dA(cx(mn.y,0,1)).getUTCDay():hA(cx(mn.y,0,1)).getDay(),mn.m=0,mn.d="W"in mn?(mn.w+6)%7+mn.W*7-(Mi+5)%7:mn.w+mn.U*7-(Mi+6)%7);return"Z"in mn?(mn.H+=mn.Z/100|0,mn.M+=mn.Z%100,dA(mn)):hA(mn)}}function tt(Dt,jn,ai,mn){for(var ci=0,Ii=jn.length,Mi=ai.length,Tr,kr;ci<Ii;){if(mn>=Mi)return-1;if(Tr=jn.charCodeAt(ci++),Tr===37){if(Tr=jn.charAt(ci++),kr=Oe[Tr in K3?jn.charAt(ci++):Tr],!kr||(mn=kr(Dt,ai,mn))<0)return-1}else if(Tr!=ai.charCodeAt(mn++))return-1}return mn}function Ge(Dt,jn,ai){var mn=M.exec(jn.slice(ai));return mn?(Dt.p=I.get(mn[0].toLowerCase()),ai+mn[0].length):-1}function Je(Dt,jn,ai){var mn=K.exec(jn.slice(ai));return mn?(Dt.w=J.get(mn[0].toLowerCase()),ai+mn[0].length):-1}function Ve(Dt,jn,ai){var mn=j.exec(jn.slice(ai));return mn?(Dt.w=q.get(mn[0].toLowerCase()),ai+mn[0].length):-1}function xt(Dt,jn,ai){var mn=ce.exec(jn.slice(ai));return mn?(Dt.m=de.get(mn[0].toLowerCase()),ai+mn[0].length):-1}function yt(Dt,jn,ai){var mn=te.exec(jn.slice(ai));return mn?(Dt.m=oe.get(mn[0].toLowerCase()),ai+mn[0].length):-1}function ot(Dt,jn,ai){return tt(Dt,t,jn,ai)}function zt(Dt,jn,ai){return tt(Dt,i,jn,ai)}function rt(Dt,jn,ai){return tt(Dt,s,jn,ai)}function Bt(Dt){return T[Dt.getDay()]}function Vt(Dt){return y[Dt.getDay()]}function Ln(Dt){return C[Dt.getMonth()]}function $e(Dt){return o[Dt.getMonth()]}function Pt(Dt){return f[+(Dt.getHours()>=12)]}function $t(Dt){return 1+~~(Dt.getMonth()/3)}function on(Dt){return T[Dt.getUTCDay()]}function An(Dt){return y[Dt.getUTCDay()]}function ct(Dt){return C[Dt.getUTCMonth()]}function kt(Dt){return o[Dt.getUTCMonth()]}function In(Dt){return f[+(Dt.getUTCHours()>=12)]}function ti(Dt){return 1+~~(Dt.getUTCMonth()/3)}return{format:function(Dt){var jn=xe(Dt+="",ue);return jn.toString=function(){return Dt},jn},parse:function(Dt){var jn=Qe(Dt+="",!1);return jn.toString=function(){return Dt},jn},utcFormat:function(Dt){var jn=xe(Dt+="",Pe);return jn.toString=function(){return Dt},jn},utcParse:function(Dt){var jn=Qe(Dt+="",!0);return jn.toString=function(){return Dt},jn}}}var K3={"-":"",_:" ",0:"0"},ql=/^\s*\d+/,_re=/^%/,yre=/[\\^$*+?|[\]().{}]/g;function Qo(e,t,i){var s=e<0?"-":"",f=(s?-e:e)+"",y=f.length;return s+(y<i?new Array(i-y+1).join(t)+f:f)}function vre(e){return e.replace(yre,"\\$&")}function ux(e){return new RegExp("^(?:"+e.map(vre).join("|")+")","i")}function hx(e){return new Map(e.map((t,i)=>[t.toLowerCase(),i]))}function xre(e,t,i){var s=ql.exec(t.slice(i,i+1));return s?(e.w=+s[0],i+s[0].length):-1}function bre(e,t,i){var s=ql.exec(t.slice(i,i+1));return s?(e.u=+s[0],i+s[0].length):-1}function wre(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.U=+s[0],i+s[0].length):-1}function Tre(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.V=+s[0],i+s[0].length):-1}function Sre(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.W=+s[0],i+s[0].length):-1}function J3(e,t,i){var s=ql.exec(t.slice(i,i+4));return s?(e.y=+s[0],i+s[0].length):-1}function Q3(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),i+s[0].length):-1}function Ere(e,t,i){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(i,i+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),i+s[0].length):-1}function Are(e,t,i){var s=ql.exec(t.slice(i,i+1));return s?(e.q=s[0]*3-3,i+s[0].length):-1}function Pre(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.m=s[0]-1,i+s[0].length):-1}function eN(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.d=+s[0],i+s[0].length):-1}function Cre(e,t,i){var s=ql.exec(t.slice(i,i+3));return s?(e.m=0,e.d=+s[0],i+s[0].length):-1}function tN(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.H=+s[0],i+s[0].length):-1}function Mre(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.M=+s[0],i+s[0].length):-1}function Ore(e,t,i){var s=ql.exec(t.slice(i,i+2));return s?(e.S=+s[0],i+s[0].length):-1}function Ire(e,t,i){var s=ql.exec(t.slice(i,i+3));return s?(e.L=+s[0],i+s[0].length):-1}function Dre(e,t,i){var s=ql.exec(t.slice(i,i+6));return s?(e.L=Math.floor(s[0]/1e3),i+s[0].length):-1}function Rre(e,t,i){var s=_re.exec(t.slice(i,i+1));return s?i+s[0].length:-1}function Lre(e,t,i){var s=ql.exec(t.slice(i));return s?(e.Q=+s[0],i+s[0].length):-1}function zre(e,t,i){var s=ql.exec(t.slice(i));return s?(e.s=+s[0],i+s[0].length):-1}function nN(e,t){return Qo(e.getDate(),t,2)}function kre(e,t){return Qo(e.getHours(),t,2)}function Nre(e,t){return Qo(e.getHours()%12||12,t,2)}function Bre(e,t){return Qo(1+hb.count(gm(e),e),t,3)}function W4(e,t){return Qo(e.getMilliseconds(),t,3)}function jre(e,t){return W4(e,t)+"000"}function Fre(e,t){return Qo(e.getMonth()+1,t,2)}function Ure(e,t){return Qo(e.getMinutes(),t,2)}function Vre(e,t){return Qo(e.getSeconds(),t,2)}function $re(e){var t=e.getDay();return t===0?7:t}function qre(e,t){return Qo(GT.count(gm(e)-1,e),t,2)}function X4(e){var t=e.getDay();return t>=4||t===0?Dv(e):Dv.ceil(e)}function Hre(e,t){return e=X4(e),Qo(Dv.count(gm(e),e)+(gm(e).getDay()===4),t,2)}function Gre(e){return e.getDay()}function Zre(e,t){return Qo(K1.count(gm(e)-1,e),t,2)}function Wre(e,t){return Qo(e.getFullYear()%100,t,2)}function Xre(e,t){return e=X4(e),Qo(e.getFullYear()%100,t,2)}function Yre(e,t){return Qo(e.getFullYear()%1e4,t,4)}function Kre(e,t){var i=e.getDay();return e=i>=4||i===0?Dv(e):Dv.ceil(e),Qo(e.getFullYear()%1e4,t,4)}function Jre(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Qo(t/60|0,"0",2)+Qo(t%60,"0",2)}function iN(e,t){return Qo(e.getUTCDate(),t,2)}function Qre(e,t){return Qo(e.getUTCHours(),t,2)}function eoe(e,t){return Qo(e.getUTCHours()%12||12,t,2)}function toe(e,t){return Qo(1+HT.count(_m(e),e),t,3)}function Y4(e,t){return Qo(e.getUTCMilliseconds(),t,3)}function noe(e,t){return Y4(e,t)+"000"}function ioe(e,t){return Qo(e.getUTCMonth()+1,t,2)}function roe(e,t){return Qo(e.getUTCMinutes(),t,2)}function ooe(e,t){return Qo(e.getUTCSeconds(),t,2)}function aoe(e){var t=e.getUTCDay();return t===0?7:t}function soe(e,t){return Qo(ZT.count(_m(e)-1,e),t,2)}function K4(e){var t=e.getUTCDay();return t>=4||t===0?Rv(e):Rv.ceil(e)}function loe(e,t){return e=K4(e),Qo(Rv.count(_m(e),e)+(_m(e).getUTCDay()===4),t,2)}function coe(e){return e.getUTCDay()}function uoe(e,t){return Qo(J1.count(_m(e)-1,e),t,2)}function hoe(e,t){return Qo(e.getUTCFullYear()%100,t,2)}function doe(e,t){return e=K4(e),Qo(e.getUTCFullYear()%100,t,2)}function foe(e,t){return Qo(e.getUTCFullYear()%1e4,t,4)}function poe(e,t){var i=e.getUTCDay();return e=i>=4||i===0?Rv(e):Rv.ceil(e),Qo(e.getUTCFullYear()%1e4,t,4)}function moe(){return"+0000"}function rN(){return"%"}function oN(e){return+e}function aN(e){return Math.floor(+e/1e3)}var uv,J4,Q4;goe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function goe(e){return uv=gre(e),J4=uv.format,uv.parse,Q4=uv.utcFormat,uv.utcParse,uv}function _oe(e){return new Date(e)}function yoe(e){return e instanceof Date?+e:+new Date(+e)}function iO(e,t,i,s,f,y,T,o,C,M){var I=$M(),j=I.invert,q=I.domain,K=M(".%L"),J=M(":%S"),te=M("%I:%M"),oe=M("%I %p"),ce=M("%a %d"),de=M("%b %d"),ue=M("%B"),Pe=M("%Y");function Oe(xe){return(C(xe)<xe?K:o(xe)<xe?J:T(xe)<xe?te:y(xe)<xe?oe:s(xe)<xe?f(xe)<xe?ce:de:i(xe)<xe?ue:Pe)(xe)}return I.invert=function(xe){return new Date(j(xe))},I.domain=function(xe){return arguments.length?q(Array.from(xe,yoe)):q().map(_oe)},I.ticks=function(xe){var Qe=q();return e(Qe[0],Qe[Qe.length-1],xe??10)},I.tickFormat=function(xe,Qe){return Qe==null?Oe:M(Qe)},I.nice=function(xe){var Qe=q();return(!xe||typeof xe.range!="function")&&(xe=t(Qe[0],Qe[Qe.length-1],xe??10)),xe?q(j4(Qe,xe)):I},I.copy=function(){return ub(I,iO(e,t,i,s,f,y,T,o,C,M))},I}function voe(){return Ed.apply(iO(pre,mre,gm,tO,GT,hb,QM,KM,H_,J4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function xoe(){return Ed.apply(iO(dre,fre,_m,nO,ZT,HT,eO,JM,H_,Q4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function WT(){var e=0,t=1,i,s,f,y,T=au,o=!1,C;function M(j){return j==null||isNaN(j=+j)?C:T(f===0?.5:(j=(y(j)-i)*f,o?Math.max(0,Math.min(1,j)):j))}M.domain=function(j){return arguments.length?([e,t]=j,i=y(e=+e),s=y(t=+t),f=i===s?0:1/(s-i),M):[e,t]},M.clamp=function(j){return arguments.length?(o=!!j,M):o},M.interpolator=function(j){return arguments.length?(T=j,M):T};function I(j){return function(q){var K,J;return arguments.length?([K,J]=q,T=j(K,J),M):[T(0),T(1)]}}return M.range=I($v),M.rangeRound=I(VM),M.unknown=function(j){return arguments.length?(C=j,M):C},function(j){return y=j,i=j(e),s=j(t),f=i===s?0:1/(s-i),M}}function Ng(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function eU(){var e=kg(WT()(au));return e.copy=function(){return Ng(e,eU())},ym.apply(e,arguments)}function tU(){var e=GM(WT()).domain([1,10]);return e.copy=function(){return Ng(e,tU()).base(e.base())},ym.apply(e,arguments)}function nU(){var e=ZM(WT());return e.copy=function(){return Ng(e,nU()).constant(e.constant())},ym.apply(e,arguments)}function rO(){var e=WM(WT());return e.copy=function(){return Ng(e,rO()).exponent(e.exponent())},ym.apply(e,arguments)}function boe(){return rO.apply(null,arguments).exponent(.5)}function iU(){var e=[],t=au;function i(s){if(s!=null&&!isNaN(s=+s))return t((lb(e,s,1)-1)/(e.length-1))}return i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let f of s)f!=null&&!isNaN(f=+f)&&e.push(f);return e.sort(Eg),i},i.interpolator=function(s){return arguments.length?(t=s,i):t},i.range=function(){return e.map((s,f)=>t(f/(e.length-1)))},i.quantiles=function(s){return Array.from({length:s+1},(f,y)=>aie(e,y/s))},i.copy=function(){return iU(t).domain(e)},ym.apply(i,arguments)}function XT(){var e=0,t=.5,i=1,s=1,f,y,T,o,C,M=au,I,j=!1,q;function K(te){return isNaN(te=+te)?q:(te=.5+((te=+I(te))-y)*(s*te<s*y?o:C),M(j?Math.max(0,Math.min(1,te)):te))}K.domain=function(te){return arguments.length?([e,t,i]=te,f=I(e=+e),y=I(t=+t),T=I(i=+i),o=f===y?0:.5/(y-f),C=y===T?0:.5/(T-y),s=y<f?-1:1,K):[e,t,i]},K.clamp=function(te){return arguments.length?(j=!!te,K):j},K.interpolator=function(te){return arguments.length?(M=te,K):M};function J(te){return function(oe){var ce,de,ue;return arguments.length?([ce,de,ue]=oe,M=Rie(te,[ce,de,ue]),K):[M(0),M(.5),M(1)]}}return K.range=J($v),K.rangeRound=J(VM),K.unknown=function(te){return arguments.length?(q=te,K):q},function(te){return I=te,f=te(e),y=te(t),T=te(i),o=f===y?0:.5/(y-f),C=y===T?0:.5/(T-y),s=y<f?-1:1,K}}function rU(){var e=kg(XT()(au));return e.copy=function(){return Ng(e,rU())},ym.apply(e,arguments)}function oU(){var e=GM(XT()).domain([.1,1,10]);return e.copy=function(){return Ng(e,oU()).base(e.base())},ym.apply(e,arguments)}function aU(){var e=ZM(XT());return e.copy=function(){return Ng(e,aU()).constant(e.constant())},ym.apply(e,arguments)}function oO(){var e=WM(XT());return e.copy=function(){return Ng(e,oO()).exponent(e.exponent())},ym.apply(e,arguments)}function woe(){return oO.apply(null,arguments).exponent(.5)}const vx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:jM,scaleDiverging:rU,scaleDivergingLog:oU,scaleDivergingPow:oO,scaleDivergingSqrt:woe,scaleDivergingSymlog:aU,scaleIdentity:B4,scaleImplicit:LP,scaleLinear:N4,scaleLog:F4,scaleOrdinal:BM,scalePoint:cie,scalePow:XM,scaleQuantile:$4,scaleQuantize:q4,scaleRadial:V4,scaleSequential:eU,scaleSequentialLog:tU,scaleSequentialPow:rO,scaleSequentialQuantile:iU,scaleSequentialSqrt:boe,scaleSequentialSymlog:nU,scaleSqrt:nre,scaleSymlog:U4,scaleThreshold:H4,scaleTime:voe,scaleUtc:xoe,tickFormat:k4},Symbol.toStringTag,{value:"Module"}));var qv=e=>e.chartData,Toe=Fn([qv],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),sU=(e,t,i,s)=>s?Toe(e):qv(e);function Lv(e){if(Array.isArray(e)&&e.length===2){var[t,i]=e;if(Ah(t)&&Ah(i))return!0}return!1}function sN(e,t,i){return i?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Soe(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[i,s]=e,f,y;if(Ah(i))f=i;else if(typeof i=="function")return;if(Ah(s))y=s;else if(typeof s=="function")return;var T=[f,y];if(Lv(T))return T}}function Eoe(e,t,i){if(!(!i&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,i);if(Lv(s))return sN(s,t,i)}catch{}if(Array.isArray(e)&&e.length===2){var[f,y]=e,T,o;if(f==="auto")t!=null&&(T=Math.min(...t));else if(Hi(f))T=f;else if(typeof f=="function")try{t!=null&&(T=f(t?.[0]))}catch{}else if(typeof f=="string"&&Wk.test(f)){var C=Wk.exec(f);if(C==null||t==null)T=void 0;else{var M=+C[1];T=t[0]-M}}else T=t?.[0];if(y==="auto")t!=null&&(o=Math.max(...t));else if(Hi(y))o=y;else if(typeof y=="function")try{t!=null&&(o=y(t?.[1]))}catch{}else if(typeof y=="string"&&Xk.test(y)){var I=Xk.exec(y);if(I==null||t==null)o=void 0;else{var j=+I[1];o=t[1]+j}}else o=t?.[1];var q=[T,o];if(Lv(q))return t==null?q:sN(q,t,i)}}}var Hv=1e9,Aoe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},sO,ys=!0,wd="[DecimalError] ",ey=wd+"Invalid argument: ",aO=wd+"Exponent out of range: ",Gv=Math.floor,N_=Math.pow,Poe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,xh,Ul=1e7,as=7,lU=9007199254740991,Q1=Gv(lU/as),ji={};ji.absoluteValue=ji.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ji.comparedTo=ji.cmp=function(e){var t,i,s,f,y=this;if(e=new y.constructor(e),y.s!==e.s)return y.s||-e.s;if(y.e!==e.e)return y.e>e.e^y.s<0?1:-1;for(s=y.d.length,f=e.d.length,t=0,i=s<f?s:f;t<i;++t)if(y.d[t]!==e.d[t])return y.d[t]>e.d[t]^y.s<0?1:-1;return s===f?0:s>f^y.s<0?1:-1};ji.decimalPlaces=ji.dp=function(){var e=this,t=e.d.length-1,i=(t-e.e)*as;if(t=e.d[t],t)for(;t%10==0;t/=10)i--;return i<0?0:i};ji.dividedBy=ji.div=function(e){return um(this,new this.constructor(e))};ji.dividedToIntegerBy=ji.idiv=function(e){var t=this,i=t.constructor;return Na(um(t,new i(e),0,1),i.precision)};ji.equals=ji.eq=function(e){return!this.cmp(e)};ji.exponent=function(){return xl(this)};ji.greaterThan=ji.gt=function(e){return this.cmp(e)>0};ji.greaterThanOrEqualTo=ji.gte=function(e){return this.cmp(e)>=0};ji.isInteger=ji.isint=function(){return this.e>this.d.length-2};ji.isNegative=ji.isneg=function(){return this.s<0};ji.isPositive=ji.ispos=function(){return this.s>0};ji.isZero=function(){return this.s===0};ji.lessThan=ji.lt=function(e){return this.cmp(e)<0};ji.lessThanOrEqualTo=ji.lte=function(e){return this.cmp(e)<1};ji.logarithm=ji.log=function(e){var t,i=this,s=i.constructor,f=s.precision,y=f+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(xh))throw Error(wd+"NaN");if(i.s<1)throw Error(wd+(i.s?"NaN":"-Infinity"));return i.eq(xh)?new s(0):(ys=!1,t=um(Hx(i,y),Hx(e,y),y),ys=!0,Na(t,f))};ji.minus=ji.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?hU(t,e):cU(t,(e.s=-e.s,e))};ji.modulo=ji.mod=function(e){var t,i=this,s=i.constructor,f=s.precision;if(e=new s(e),!e.s)throw Error(wd+"NaN");return i.s?(ys=!1,t=um(i,e,0,1).times(e),ys=!0,i.minus(t)):Na(new s(i),f)};ji.naturalExponential=ji.exp=function(){return uU(this)};ji.naturalLogarithm=ji.ln=function(){return Hx(this)};ji.negated=ji.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ji.plus=ji.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?cU(t,e):hU(t,(e.s=-e.s,e))};ji.precision=ji.sd=function(e){var t,i,s,f=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ey+e);if(t=xl(f)+1,s=f.d.length-1,i=s*as+1,s=f.d[s],s){for(;s%10==0;s/=10)i--;for(s=f.d[0];s>=10;s/=10)i++}return e&&t>i?t:i};ji.squareRoot=ji.sqrt=function(){var e,t,i,s,f,y,T,o=this,C=o.constructor;if(o.s<1){if(!o.s)return new C(0);throw Error(wd+"NaN")}for(e=xl(o),ys=!1,f=Math.sqrt(+o),f==0||f==1/0?(t=rp(o.d),(t.length+e)%2==0&&(t+="0"),f=Math.sqrt(t),e=Gv((e+1)/2)-(e<0||e%2),f==1/0?t="5e"+e:(t=f.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new C(t)):s=new C(f.toString()),i=C.precision,f=T=i+3;;)if(y=s,s=y.plus(um(o,y,T+2)).times(.5),rp(y.d).slice(0,T)===(t=rp(s.d)).slice(0,T)){if(t=t.slice(T-3,T+1),f==T&&t=="4999"){if(Na(y,i+1,0),y.times(y).eq(o)){s=y;break}}else if(t!="9999")break;T+=4}return ys=!0,Na(s,i)};ji.times=ji.mul=function(e){var t,i,s,f,y,T,o,C,M,I=this,j=I.constructor,q=I.d,K=(e=new j(e)).d;if(!I.s||!e.s)return new j(0);for(e.s*=I.s,i=I.e+e.e,C=q.length,M=K.length,C<M&&(y=q,q=K,K=y,T=C,C=M,M=T),y=[],T=C+M,s=T;s--;)y.push(0);for(s=M;--s>=0;){for(t=0,f=C+s;f>s;)o=y[f]+K[s]*q[f-s-1]+t,y[f--]=o%Ul|0,t=o/Ul|0;y[f]=(y[f]+t)%Ul|0}for(;!y[--T];)y.pop();return t?++i:y.shift(),e.d=y,e.e=i,ys?Na(e,j.precision):e};ji.toDecimalPlaces=ji.todp=function(e,t){var i=this,s=i.constructor;return i=new s(i),e===void 0?i:(dp(e,0,Hv),t===void 0?t=s.rounding:dp(t,0,8),Na(i,e+xl(i)+1,t))};ji.toExponential=function(e,t){var i,s=this,f=s.constructor;return e===void 0?i=sy(s,!0):(dp(e,0,Hv),t===void 0?t=f.rounding:dp(t,0,8),s=Na(new f(s),e+1,t),i=sy(s,!0,e+1)),i};ji.toFixed=function(e,t){var i,s,f=this,y=f.constructor;return e===void 0?sy(f):(dp(e,0,Hv),t===void 0?t=y.rounding:dp(t,0,8),s=Na(new y(f),e+xl(f)+1,t),i=sy(s.abs(),!1,e+xl(s)+1),f.isneg()&&!f.isZero()?"-"+i:i)};ji.toInteger=ji.toint=function(){var e=this,t=e.constructor;return Na(new t(e),xl(e)+1,t.rounding)};ji.toNumber=function(){return+this};ji.toPower=ji.pow=function(e){var t,i,s,f,y,T,o=this,C=o.constructor,M=12,I=+(e=new C(e));if(!e.s)return new C(xh);if(o=new C(o),!o.s){if(e.s<1)throw Error(wd+"Infinity");return o}if(o.eq(xh))return o;if(s=C.precision,e.eq(xh))return Na(o,s);if(t=e.e,i=e.d.length-1,T=t>=i,y=o.s,T){if((i=I<0?-I:I)<=lU){for(f=new C(xh),t=Math.ceil(s/as+4),ys=!1;i%2&&(f=f.times(o),cN(f.d,t)),i=Gv(i/2),i!==0;)o=o.times(o),cN(o.d,t);return ys=!0,e.s<0?new C(xh).div(f):Na(f,s)}}else if(y<0)throw Error(wd+"NaN");return y=y<0&&e.d[Math.max(t,i)]&1?-1:1,o.s=1,ys=!1,f=e.times(Hx(o,s+M)),ys=!0,f=uU(f),f.s=y,f};ji.toPrecision=function(e,t){var i,s,f=this,y=f.constructor;return e===void 0?(i=xl(f),s=sy(f,i<=y.toExpNeg||i>=y.toExpPos)):(dp(e,1,Hv),t===void 0?t=y.rounding:dp(t,0,8),f=Na(new y(f),e,t),i=xl(f),s=sy(f,e<=i||i<=y.toExpNeg,e)),s};ji.toSignificantDigits=ji.tosd=function(e,t){var i=this,s=i.constructor;return e===void 0?(e=s.precision,t=s.rounding):(dp(e,1,Hv),t===void 0?t=s.rounding:dp(t,0,8)),Na(new s(i),e,t)};ji.toString=ji.valueOf=ji.val=ji.toJSON=ji[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=xl(e),i=e.constructor;return sy(e,t<=i.toExpNeg||t>=i.toExpPos)};function cU(e,t){var i,s,f,y,T,o,C,M,I=e.constructor,j=I.precision;if(!e.s||!t.s)return t.s||(t=new I(e)),ys?Na(t,j):t;if(C=e.d,M=t.d,T=e.e,f=t.e,C=C.slice(),y=T-f,y){for(y<0?(s=C,y=-y,o=M.length):(s=M,f=T,o=C.length),T=Math.ceil(j/as),o=T>o?T+1:o+1,y>o&&(y=o,s.length=1),s.reverse();y--;)s.push(0);s.reverse()}for(o=C.length,y=M.length,o-y<0&&(y=o,s=M,M=C,C=s),i=0;y;)i=(C[--y]=C[y]+M[y]+i)/Ul|0,C[y]%=Ul;for(i&&(C.unshift(i),++f),o=C.length;C[--o]==0;)C.pop();return t.d=C,t.e=f,ys?Na(t,j):t}function dp(e,t,i){if(e!==~~e||e<t||e>i)throw Error(ey+e)}function rp(e){var t,i,s,f=e.length-1,y="",T=e[0];if(f>0){for(y+=T,t=1;t<f;t++)s=e[t]+"",i=as-s.length,i&&(y+=_g(i)),y+=s;T=e[t],s=T+"",i=as-s.length,i&&(y+=_g(i))}else if(T===0)return"0";for(;T%10===0;)T/=10;return y+T}var um=function(){function e(s,f){var y,T=0,o=s.length;for(s=s.slice();o--;)y=s[o]*f+T,s[o]=y%Ul|0,T=y/Ul|0;return T&&s.unshift(T),s}function t(s,f,y,T){var o,C;if(y!=T)C=y>T?1:-1;else for(o=C=0;o<y;o++)if(s[o]!=f[o]){C=s[o]>f[o]?1:-1;break}return C}function i(s,f,y){for(var T=0;y--;)s[y]-=T,T=s[y]<f[y]?1:0,s[y]=T*Ul+s[y]-f[y];for(;!s[0]&&s.length>1;)s.shift()}return function(s,f,y,T){var o,C,M,I,j,q,K,J,te,oe,ce,de,ue,Pe,Oe,xe,Qe,tt,Ge=s.constructor,Je=s.s==f.s?1:-1,Ve=s.d,xt=f.d;if(!s.s)return new Ge(s);if(!f.s)throw Error(wd+"Division by zero");for(C=s.e-f.e,Qe=xt.length,Oe=Ve.length,K=new Ge(Je),J=K.d=[],M=0;xt[M]==(Ve[M]||0);)++M;if(xt[M]>(Ve[M]||0)&&--C,y==null?de=y=Ge.precision:T?de=y+(xl(s)-xl(f))+1:de=y,de<0)return new Ge(0);if(de=de/as+2|0,M=0,Qe==1)for(I=0,xt=xt[0],de++;(M<Oe||I)&&de--;M++)ue=I*Ul+(Ve[M]||0),J[M]=ue/xt|0,I=ue%xt|0;else{for(I=Ul/(xt[0]+1)|0,I>1&&(xt=e(xt,I),Ve=e(Ve,I),Qe=xt.length,Oe=Ve.length),Pe=Qe,te=Ve.slice(0,Qe),oe=te.length;oe<Qe;)te[oe++]=0;tt=xt.slice(),tt.unshift(0),xe=xt[0],xt[1]>=Ul/2&&++xe;do I=0,o=t(xt,te,Qe,oe),o<0?(ce=te[0],Qe!=oe&&(ce=ce*Ul+(te[1]||0)),I=ce/xe|0,I>1?(I>=Ul&&(I=Ul-1),j=e(xt,I),q=j.length,oe=te.length,o=t(j,te,q,oe),o==1&&(I--,i(j,Qe<q?tt:xt,q))):(I==0&&(o=I=1),j=xt.slice()),q=j.length,q<oe&&j.unshift(0),i(te,j,oe),o==-1&&(oe=te.length,o=t(xt,te,Qe,oe),o<1&&(I++,i(te,Qe<oe?tt:xt,oe))),oe=te.length):o===0&&(I++,te=[0]),J[M++]=I,o&&te[0]?te[oe++]=Ve[Pe]||0:(te=[Ve[Pe]],oe=1);while((Pe++<Oe||te[0]!==void 0)&&de--)}return J[0]||J.shift(),K.e=C,Na(K,T?y+xl(K)+1:y)}}();function uU(e,t){var i,s,f,y,T,o,C=0,M=0,I=e.constructor,j=I.precision;if(xl(e)>16)throw Error(aO+xl(e));if(!e.s)return new I(xh);for(ys=!1,o=j,T=new I(.03125);e.abs().gte(.1);)e=e.times(T),M+=5;for(s=Math.log(N_(2,M))/Math.LN10*2+5|0,o+=s,i=f=y=new I(xh),I.precision=o;;){if(f=Na(f.times(e),o),i=i.times(++C),T=y.plus(um(f,i,o)),rp(T.d).slice(0,o)===rp(y.d).slice(0,o)){for(;M--;)y=Na(y.times(y),o);return I.precision=j,t==null?(ys=!0,Na(y,j)):y}y=T}}function xl(e){for(var t=e.e*as,i=e.d[0];i>=10;i/=10)t++;return t}function fA(e,t,i){if(t>e.LN10.sd())throw ys=!0,i&&(e.precision=i),Error(wd+"LN10 precision limit exceeded");return Na(new e(e.LN10),t)}function _g(e){for(var t="";e--;)t+="0";return t}function Hx(e,t){var i,s,f,y,T,o,C,M,I,j=1,q=10,K=e,J=K.d,te=K.constructor,oe=te.precision;if(K.s<1)throw Error(wd+(K.s?"NaN":"-Infinity"));if(K.eq(xh))return new te(0);if(t==null?(ys=!1,M=oe):M=t,K.eq(10))return t==null&&(ys=!0),fA(te,M);if(M+=q,te.precision=M,i=rp(J),s=i.charAt(0),y=xl(K),Math.abs(y)<15e14){for(;s<7&&s!=1||s==1&&i.charAt(1)>3;)K=K.times(e),i=rp(K.d),s=i.charAt(0),j++;y=xl(K),s>1?(K=new te("0."+i),y++):K=new te(s+"."+i.slice(1))}else return C=fA(te,M+2,oe).times(y+""),K=Hx(new te(s+"."+i.slice(1)),M-q).plus(C),te.precision=oe,t==null?(ys=!0,Na(K,oe)):K;for(o=T=K=um(K.minus(xh),K.plus(xh),M),I=Na(K.times(K),M),f=3;;){if(T=Na(T.times(I),M),C=o.plus(um(T,new te(f),M)),rp(C.d).slice(0,M)===rp(o.d).slice(0,M))return o=o.times(2),y!==0&&(o=o.plus(fA(te,M+2,oe).times(y+""))),o=um(o,new te(j),M),te.precision=oe,t==null?(ys=!0,Na(o,oe)):o;o=C,f+=2}}function lN(e,t){var i,s,f;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(i<0&&(i=s),i+=+t.slice(s+1),t=t.substring(0,s)):i<0&&(i=t.length),s=0;t.charCodeAt(s)===48;)++s;for(f=t.length;t.charCodeAt(f-1)===48;)--f;if(t=t.slice(s,f),t){if(f-=s,i=i-s-1,e.e=Gv(i/as),e.d=[],s=(i+1)%as,i<0&&(s+=as),s<f){for(s&&e.d.push(+t.slice(0,s)),f-=as;s<f;)e.d.push(+t.slice(s,s+=as));t=t.slice(s),s=as-t.length}else s-=f;for(;s--;)t+="0";if(e.d.push(+t),ys&&(e.e>Q1||e.e<-Q1))throw Error(aO+i)}else e.s=0,e.e=0,e.d=[0];return e}function Na(e,t,i){var s,f,y,T,o,C,M,I,j=e.d;for(T=1,y=j[0];y>=10;y/=10)T++;if(s=t-T,s<0)s+=as,f=t,M=j[I=0];else{if(I=Math.ceil((s+1)/as),y=j.length,I>=y)return e;for(M=y=j[I],T=1;y>=10;y/=10)T++;s%=as,f=s-as+T}if(i!==void 0&&(y=N_(10,T-f-1),o=M/y%10|0,C=t<0||j[I+1]!==void 0||M%y,C=i<4?(o||C)&&(i==0||i==(e.s<0?3:2)):o>5||o==5&&(i==4||C||i==6&&(s>0?f>0?M/N_(10,T-f):0:j[I-1])%10&1||i==(e.s<0?8:7))),t<1||!j[0])return C?(y=xl(e),j.length=1,t=t-y-1,j[0]=N_(10,(as-t%as)%as),e.e=Gv(-t/as)||0):(j.length=1,j[0]=e.e=e.s=0),e;if(s==0?(j.length=I,y=1,I--):(j.length=I+1,y=N_(10,as-s),j[I]=f>0?(M/N_(10,T-f)%N_(10,f)|0)*y:0),C)for(;;)if(I==0){(j[0]+=y)==Ul&&(j[0]=1,++e.e);break}else{if(j[I]+=y,j[I]!=Ul)break;j[I--]=0,y=1}for(s=j.length;j[--s]===0;)j.pop();if(ys&&(e.e>Q1||e.e<-Q1))throw Error(aO+xl(e));return e}function hU(e,t){var i,s,f,y,T,o,C,M,I,j,q=e.constructor,K=q.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new q(e),ys?Na(t,K):t;if(C=e.d,j=t.d,s=t.e,M=e.e,C=C.slice(),T=M-s,T){for(I=T<0,I?(i=C,T=-T,o=j.length):(i=j,s=M,o=C.length),f=Math.max(Math.ceil(K/as),o)+2,T>f&&(T=f,i.length=1),i.reverse(),f=T;f--;)i.push(0);i.reverse()}else{for(f=C.length,o=j.length,I=f<o,I&&(o=f),f=0;f<o;f++)if(C[f]!=j[f]){I=C[f]<j[f];break}T=0}for(I&&(i=C,C=j,j=i,t.s=-t.s),o=C.length,f=j.length-o;f>0;--f)C[o++]=0;for(f=j.length;f>T;){if(C[--f]<j[f]){for(y=f;y&&C[--y]===0;)C[y]=Ul-1;--C[y],C[f]+=Ul}C[f]-=j[f]}for(;C[--o]===0;)C.pop();for(;C[0]===0;C.shift())--s;return C[0]?(t.d=C,t.e=s,ys?Na(t,K):t):new q(0)}function sy(e,t,i){var s,f=xl(e),y=rp(e.d),T=y.length;return t?(i&&(s=i-T)>0?y=y.charAt(0)+"."+y.slice(1)+_g(s):T>1&&(y=y.charAt(0)+"."+y.slice(1)),y=y+(f<0?"e":"e+")+f):f<0?(y="0."+_g(-f-1)+y,i&&(s=i-T)>0&&(y+=_g(s))):f>=T?(y+=_g(f+1-T),i&&(s=i-f-1)>0&&(y=y+"."+_g(s))):((s=f+1)<T&&(y=y.slice(0,s)+"."+y.slice(s)),i&&(s=i-T)>0&&(f+1===T&&(y+="."),y+=_g(s))),e.s<0?"-"+y:y}function cN(e,t){if(e.length>t)return e.length=t,!0}function dU(e){var t,i,s;function f(y){var T=this;if(!(T instanceof f))return new f(y);if(T.constructor=f,y instanceof f){T.s=y.s,T.e=y.e,T.d=(y=y.d)?y.slice():y;return}if(typeof y=="number"){if(y*0!==0)throw Error(ey+y);if(y>0)T.s=1;else if(y<0)y=-y,T.s=-1;else{T.s=0,T.e=0,T.d=[0];return}if(y===~~y&&y<1e7){T.e=0,T.d=[y];return}return lN(T,y.toString())}else if(typeof y!="string")throw Error(ey+y);if(y.charCodeAt(0)===45?(y=y.slice(1),T.s=-1):T.s=1,Poe.test(y))lN(T,y);else throw Error(ey+y)}if(f.prototype=ji,f.ROUND_UP=0,f.ROUND_DOWN=1,f.ROUND_CEIL=2,f.ROUND_FLOOR=3,f.ROUND_HALF_UP=4,f.ROUND_HALF_DOWN=5,f.ROUND_HALF_EVEN=6,f.ROUND_HALF_CEIL=7,f.ROUND_HALF_FLOOR=8,f.clone=dU,f.config=f.set=Coe,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(i=s[t++])||(e[i]=this[i]);return f.config(e),f}function Coe(e){if(!e||typeof e!="object")throw Error(wd+"Object expected");var t,i,s,f=["precision",1,Hv,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<f.length;t+=3)if((s=e[i=f[t]])!==void 0)if(Gv(s)===s&&s>=f[t+1]&&s<=f[t+2])this[i]=s;else throw Error(ey+i+": "+s);if((s=e[i="LN10"])!==void 0)if(s==Math.LN10)this[i]=new this(s);else throw Error(ey+i+": "+s);return this}var sO=dU(Aoe);xh=new sO(1);const ua=sO;var Moe=e=>e,fU={},pU=e=>e===fU,uN=e=>function t(){return arguments.length===0||arguments.length===1&&pU(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},mU=(e,t)=>e===1?t:uN(function(){for(var i=arguments.length,s=new Array(i),f=0;f<i;f++)s[f]=arguments[f];var y=s.filter(T=>T!==fU).length;return y>=e?t(...s):mU(e-y,uN(function(){for(var T=arguments.length,o=new Array(T),C=0;C<T;C++)o[C]=arguments[C];var M=s.map(I=>pU(I)?o.shift():I);return t(...M,...o)}))}),YT=e=>mU(e.length,e),BP=(e,t)=>{for(var i=[],s=e;s<t;++s)i[s-e]=s;return i},Ooe=YT((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(i=>t[i]).map(e)),Ioe=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];if(!i.length)return Moe;var f=i.reverse(),y=f[0],T=f.slice(1);return function(){return T.reduce((o,C)=>C(o),y(...arguments))}},jP=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),gU=e=>{var t=null,i=null;return function(){for(var s=arguments.length,f=new Array(s),y=0;y<s;y++)f[y]=arguments[y];return t&&f.every((T,o)=>{var C;return T===((C=t)===null||C===void 0?void 0:C[o])})||(t=f,i=e(...f)),i}};function _U(e){var t;return e===0?t=1:t=Math.floor(new ua(e).abs().log(10).toNumber())+1,t}function yU(e,t,i){for(var s=new ua(e),f=0,y=[];s.lt(t)&&f<1e5;)y.push(s.toNumber()),s=s.add(i),f++;return y}YT((e,t,i)=>{var s=+e,f=+t;return s+i*(f-s)});YT((e,t,i)=>{var s=t-+e;return s=s||1/0,(i-e)/s});YT((e,t,i)=>{var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(i-e)/s))});var vU=e=>{var[t,i]=e,[s,f]=[t,i];return t>i&&([s,f]=[i,t]),[s,f]},xU=(e,t,i)=>{if(e.lte(0))return new ua(0);var s=_U(e.toNumber()),f=new ua(10).pow(s),y=e.div(f),T=s!==1?.05:.1,o=new ua(Math.ceil(y.div(T).toNumber())).add(i).mul(T),C=o.mul(f);return t?new ua(C.toNumber()):new ua(Math.ceil(C.toNumber()))},Doe=(e,t,i)=>{var s=new ua(1),f=new ua(e);if(!f.isint()&&i){var y=Math.abs(e);y<1?(s=new ua(10).pow(_U(e)-1),f=new ua(Math.floor(f.div(s).toNumber())).mul(s)):y>1&&(f=new ua(Math.floor(e)))}else e===0?f=new ua(Math.floor((t-1)/2)):i||(f=new ua(Math.floor(e)));var T=Math.floor((t-1)/2),o=Ioe(Ooe(C=>f.add(new ua(C-T).mul(s)).toNumber()),BP);return o(0,t)},bU=function(t,i,s,f){var y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((i-t)/(s-1)))return{step:new ua(0),tickMin:new ua(0),tickMax:new ua(0)};var T=xU(new ua(i).sub(t).div(s-1),f,y),o;t<=0&&i>=0?o=new ua(0):(o=new ua(t).add(i).div(2),o=o.sub(new ua(o).mod(T)));var C=Math.ceil(o.sub(t).div(T).toNumber()),M=Math.ceil(new ua(i).sub(o).div(T).toNumber()),I=C+M+1;return I>s?bU(t,i,s,f,y+1):(I<s&&(M=i>0?M+(s-I):M,C=i>0?C:C+(s-I)),{step:T,tickMin:o.sub(new ua(C).mul(T)),tickMax:o.add(new ua(M).mul(T))})};function Roe(e){var[t,i]=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,y=Math.max(s,2),[T,o]=vU([t,i]);if(T===-1/0||o===1/0){var C=o===1/0?[T,...BP(0,s-1).map(()=>1/0)]:[...BP(0,s-1).map(()=>-1/0),o];return t>i?jP(C):C}if(T===o)return Doe(T,s,f);var{step:M,tickMin:I,tickMax:j}=bU(T,o,y,f,0),q=yU(I,j.add(new ua(.1).mul(M)),M);return t>i?jP(q):q}function Loe(e,t){var[i,s]=e,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[y,T]=vU([i,s]);if(y===-1/0||T===1/0)return[i,s];if(y===T)return[y];var o=Math.max(t,2),C=xU(new ua(T).sub(y).div(o-1),f,0),M=[...yU(new ua(y),new ua(T).sub(new ua(.99).mul(C)),C),T];return i>s?jP(M):M}var zoe=gU(Roe),koe=gU(Loe),wU=e=>e.rootProps.maxBarSize,Noe=e=>e.rootProps.barGap,TU=e=>e.rootProps.barCategoryGap,Boe=e=>e.rootProps.barSize,KT=e=>e.rootProps.stackOffset,lO=e=>e.options.chartName,cO=e=>e.rootProps.syncId,SU=e=>e.rootProps.syncMethod,uO=e=>e.options.eventEmitter,am={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},yh={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},JT=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},joe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:am.angleAxisId,includeHidden:!1,name:void 0,reversed:am.reversed,scale:am.scale,tick:am.tick,tickCount:void 0,ticks:void 0,type:am.type,unit:void 0},Foe={allowDataOverflow:yh.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:yh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:yh.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:yh.scale,tick:yh.tick,tickCount:yh.tickCount,ticks:void 0,type:yh.type,unit:void 0},Uoe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:am.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:am.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:am.scale,tick:am.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Voe={allowDataOverflow:yh.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:yh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:yh.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:yh.scale,tick:yh.tick,tickCount:yh.tickCount,ticks:void 0,type:"category",unit:void 0},hO=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?Uoe:joe,dO=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Voe:Foe,QT=e=>e.polarOptions,fO=Fn([Rg,Lg,nc],Iee),EU=Fn([QT,fO],(e,t)=>{if(e!=null)return ff(e.innerRadius,t,0)}),AU=Fn([QT,fO],(e,t)=>{if(e!=null)return ff(e.outerRadius,t,t*.8)}),$oe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:i}=e;return[t,i]},PU=Fn([QT],$oe);Fn([hO,PU],JT);var CU=Fn([fO,EU,AU],(e,t,i)=>{if(!(e==null||t==null||i==null))return[t,i]});Fn([dO,CU],JT);var qoe=Fn([Ba,QT,EU,AU,Rg,Lg],(e,t,i,s,f,y)=>{if(!(e!=="centric"&&e!=="radial"||t==null||i==null||s==null)){var{cx:T,cy:o,startAngle:C,endAngle:M}=t;return{cx:ff(T,f,f/2),cy:ff(o,y,y/2),innerRadius:i,outerRadius:s,startAngle:C,endAngle:M,clockWise:!1}}}),Hl=(e,t)=>t,e2=(e,t,i)=>i;function hN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function eT(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?hN(Object(i),!0).forEach(function(s){Hoe(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Hoe(e,t,i){return(t=Goe(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Goe(e){var t=Zoe(e,"string");return typeof t=="symbol"?t:t+""}function Zoe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FP=[0,"auto"],ph={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},vm=(e,t)=>{var i=e.cartesianAxis.xAxis[t];return i??ph},mh={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:FP,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:FT},Bg=(e,t)=>{var i=e.cartesianAxis.yAxis[t];return i??mh},Woe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},pO=(e,t)=>{var i=e.cartesianAxis.zAxis[t];return i??Woe},Xu=(e,t,i)=>{switch(t){case"xAxis":return vm(e,i);case"yAxis":return Bg(e,i);case"zAxis":return pO(e,i);case"angleAxis":return hO(e,i);case"radiusAxis":return dO(e,i);default:throw new Error("Unexpected axis type: ".concat(t))}},Xoe=(e,t,i)=>{switch(t){case"xAxis":return vm(e,i);case"yAxis":return Bg(e,i);default:throw new Error("Unexpected axis type: ".concat(t))}},db=(e,t,i)=>{switch(t){case"xAxis":return vm(e,i);case"yAxis":return Bg(e,i);case"angleAxis":return hO(e,i);case"radiusAxis":return dO(e,i);default:throw new Error("Unexpected axis type: ".concat(t))}},MU=e=>e.graphicalItems.countOfBars>0;function OU(e,t){return i=>{switch(e){case"xAxis":return"xAxisId"in i&&i.xAxisId===t;case"yAxis":return"yAxisId"in i&&i.yAxisId===t;case"zAxis":return"zAxisId"in i&&i.zAxisId===t;case"angleAxis":return"angleAxisId"in i&&i.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in i&&i.radiusAxisId===t;default:return!1}}}var mO=e=>e.graphicalItems.cartesianItems,Yoe=Fn([Hl,e2],OU),IU=(e,t,i)=>e.filter(i).filter(s=>t?.includeHidden===!0?!0:!s.hide),fb=Fn([mO,Xu,Yoe],IU),DU=e=>e.filter(t=>t.stackId===void 0),Koe=Fn([fb],DU),RU=e=>e.map(t=>t.data).filter(Boolean).flat(1),Joe=Fn([fb],RU),LU=(e,t)=>{var{chartData:i=[],dataStartIndex:s,dataEndIndex:f}=t;return e.length>0?e:i.slice(s,f+1)},t2=Fn([Joe,sU],LU),zU=(e,t,i)=>t?.dataKey!=null?e.map(s=>({value:wh(s,t.dataKey)})):i.length>0?i.map(s=>s.dataKey).flatMap(s=>e.map(f=>({value:wh(f,s)}))):e.map(s=>({value:s})),n2=Fn([t2,Xu,fb],zU);function kU(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function py(e){return e.filter(t=>up(t)||t instanceof Date).map(Number).filter(t=>Th(t)===!1)}function Qoe(e,t,i){return!i||typeof t!="number"||Th(t)?[]:i.length?py(i.flatMap(s=>{var f=wh(e,s.dataKey),y,T;if(Array.isArray(f)?[y,T]=f:y=T=f,!(!Ah(y)||!Ah(T)))return[t-y,t+T]})):[]}var NU=(e,t,i)=>{var s={},f=t.reduce((y,T)=>(T.stackId==null||(y[T.stackId]==null&&(y[T.stackId]=[]),y[T.stackId].push(T)),y),s);return Object.fromEntries(Object.entries(f).map(y=>{var[T,o]=y,C=o.map(M=>M.dataKey);return[T,{stackedData:Zee(e,C,i),graphicalItems:o}]}))},UP=Fn([t2,fb,KT],NU),BU=(e,t,i)=>{var{dataStartIndex:s,dataEndIndex:f}=t;if(i!=="zAxis"){var y=Kee(e,s,f);if(!(y!=null&&y[0]===0&&y[1]===0))return y}},eae=Fn([UP,qv,Hl],BU),jU=(e,t,i,s)=>i.length>0?e.flatMap(f=>i.flatMap(y=>{var T,o,C=(T=y.errorBars)===null||T===void 0?void 0:T.filter(I=>kU(s,I)),M=wh(f,(o=t.dataKey)!==null&&o!==void 0?o:y.dataKey);return{value:M,errorDomain:Qoe(f,M,C)}})).filter(Boolean):t?.dataKey!=null?e.map(f=>({value:wh(f,t.dataKey),errorDomain:[]})):e.map(f=>({value:f,errorDomain:[]})),tae=Fn(t2,Xu,Koe,Hl,jU);function nae(e){var{value:t}=e;if(up(t)||t instanceof Date)return t}var iae=e=>{var t=e.flatMap(s=>[s.value,s.errorDomain]).flat(1),i=py(t);if(i.length!==0)return[Math.min(...i),Math.max(...i)]},rae=(e,t,i)=>{var s=e.map(nae).filter(f=>f!=null);return i&&(t.dataKey==null||t.allowDuplicatedCategory&&c5(s))?A4(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},gO=e=>{var t;if(e==null||!("domain"in e))return FP;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var i=py(e.ticks);return[Math.min(...i),Math.max(...i)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:FP},_O=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];var f=i.filter(Boolean);if(f.length!==0){var y=f.flat(),T=Math.min(...y),o=Math.max(...y);return[T,o]}},FU=e=>e.referenceElements.dots,Zv=(e,t,i)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===i:s.yAxisId===i),oae=Fn([FU,Hl,e2],Zv),UU=e=>e.referenceElements.areas,aae=Fn([UU,Hl,e2],Zv),VU=e=>e.referenceElements.lines,sae=Fn([VU,Hl,e2],Zv),$U=(e,t)=>{var i=py(e.map(s=>t==="xAxis"?s.x:s.y));if(i.length!==0)return[Math.min(...i),Math.max(...i)]},lae=Fn(oae,Hl,$U),qU=(e,t)=>{var i=py(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(i.length!==0)return[Math.min(...i),Math.max(...i)]},cae=Fn([aae,Hl],qU),HU=(e,t)=>{var i=py(e.map(s=>t==="xAxis"?s.x:s.y));if(i.length!==0)return[Math.min(...i),Math.max(...i)]},uae=Fn(sae,Hl,HU),hae=Fn(lae,uae,cae,(e,t,i)=>_O(e,i,t)),dae=Fn([Xu],gO),GU=(e,t,i,s,f)=>{var y=Soe(t,e.allowDataOverflow);return y??Eoe(t,_O(i,f,iae(s)),e.allowDataOverflow)},fae=Fn([Xu,dae,eae,tae,hae],GU),pae=[0,1],ZU=(e,t,i,s,f,y,T)=>{if(!(e==null||i==null||i.length===0)){var{dataKey:o,type:C}=e,M=hy(t,y);return M&&o==null?A4(0,i.length):C==="category"?rae(s,e,M):f==="expand"?pae:T}},yO=Fn([Xu,Ba,t2,n2,KT,Hl,fae],ZU),WU=(e,t,i,s,f)=>{if(e!=null){var{scale:y,type:T}=e;if(y==="auto")return t==="radial"&&f==="radiusAxis"?"band":t==="radial"&&f==="angleAxis"?"linear":T==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!i)?"point":T==="category"?"band":"linear";if(typeof y=="string"){var o="scale".concat(ob(y));return o in vx?o:"point"}}},pb=Fn([Xu,Ba,MU,lO,Hl],WU);function mae(e){if(e!=null){if(e in vx)return vx[e]();var t="scale".concat(ob(e));if(t in vx)return vx[t]()}}function vO(e,t,i,s){if(!(i==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(i).range(s);var f=mae(t);if(f!=null){var y=f.domain(i).range(s);return Vee(y),y}}}var XU=(e,t,i)=>{var s=gO(t);if(!(i!=="auto"&&i!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&Lv(e))return zoe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Lv(e))return koe(e,t.tickCount,t.allowDecimals)}},xO=Fn([yO,db,pb],XU),YU=(e,t,i,s)=>{if(s!=="angleAxis"&&e?.type==="number"&&Lv(t)&&Array.isArray(i)&&i.length>0){var f=t[0],y=i[0],T=t[1],o=i[i.length-1];return[Math.min(f,y),Math.max(T,o)]}return t},gae=Fn([Xu,yO,xO,Hl],YU),_ae=Fn(n2,Xu,(e,t)=>{if(!(!t||t.type!=="number")){var i=1/0,s=Array.from(py(e.map(o=>o.value))).sort((o,C)=>o-C);if(s.length<2)return 1/0;var f=s[s.length-1]-s[0];if(f===0)return 1/0;for(var y=0;y<s.length-1;y++){var T=s[y+1]-s[y];i=Math.min(i,T)}return i/f}}),KU=Fn(_ae,Ba,TU,nc,(e,t,i,s)=>s,(e,t,i,s,f)=>{if(!Ah(e))return 0;var y=t==="vertical"?s.height:s.width;if(f==="gap")return e*y/2;if(f==="no-gap"){var T=ff(i,e*y),o=e*y/2;return o-T-(o-T)/y*T}return 0}),yae=(e,t)=>{var i=vm(e,t);return i==null||typeof i.padding!="string"?0:KU(e,"xAxis",t,i.padding)},vae=(e,t)=>{var i=Bg(e,t);return i==null||typeof i.padding!="string"?0:KU(e,"yAxis",t,i.padding)},xae=Fn(vm,yae,(e,t)=>{var i,s;if(e==null)return{left:0,right:0};var{padding:f}=e;return typeof f=="string"?{left:t,right:t}:{left:((i=f.left)!==null&&i!==void 0?i:0)+t,right:((s=f.right)!==null&&s!==void 0?s:0)+t}}),bae=Fn(Bg,vae,(e,t)=>{var i,s;if(e==null)return{top:0,bottom:0};var{padding:f}=e;return typeof f=="string"?{top:t,bottom:t}:{top:((i=f.top)!==null&&i!==void 0?i:0)+t,bottom:((s=f.bottom)!==null&&s!==void 0?s:0)+t}}),wae=Fn([nc,xae,VT,UT,(e,t,i)=>i],(e,t,i,s,f)=>{var{padding:y}=s;return f?[y.left,i.width-y.right]:[e.left+t.left,e.left+e.width-t.right]}),Tae=Fn([nc,Ba,bae,VT,UT,(e,t,i)=>i],(e,t,i,s,f,y)=>{var{padding:T}=f;return y?[s.height-T.bottom,T.top]:t==="horizontal"?[e.top+e.height-i.bottom,e.top+i.top]:[e.top+i.top,e.top+e.height-i.bottom]}),mb=(e,t,i,s)=>{var f;switch(t){case"xAxis":return wae(e,i,s);case"yAxis":return Tae(e,i,s);case"zAxis":return(f=pO(e,i))===null||f===void 0?void 0:f.range;case"angleAxis":return PU(e);case"radiusAxis":return CU(e,i);default:return}},JU=Fn([Xu,mb],JT),Wv=Fn([Xu,pb,gae,JU],vO);Fn(fb,Hl,(e,t)=>e.flatMap(i=>{var s;return(s=i.errorBars)!==null&&s!==void 0?s:[]}).filter(i=>kU(t,i)));function QU(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var i2=(e,t)=>t,r2=(e,t,i)=>i,Sae=Fn(MM,i2,r2,(e,t,i)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===i).sort(QU)),Eae=Fn(OM,i2,r2,(e,t,i)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===i).sort(QU)),eV=(e,t)=>({width:e.width,height:t.height}),Aae=(e,t)=>{var i=typeof t.width=="number"?t.width:FT;return{width:i,height:e.height}},tV=Fn(nc,vm,eV),Pae=(e,t,i)=>{switch(t){case"top":return e.top;case"bottom":return i-e.bottom;default:return 0}},Cae=(e,t,i)=>{switch(t){case"left":return e.left;case"right":return i-e.right;default:return 0}},Mae=Fn(Lg,nc,Sae,i2,r2,(e,t,i,s,f)=>{var y={},T;return i.forEach(o=>{var C=eV(t,o);T==null&&(T=Pae(t,s,e));var M=s==="top"&&!f||s==="bottom"&&f;y[o.id]=T-Number(M)*C.height,T+=(M?-1:1)*C.height}),y}),Oae=Fn(Rg,nc,Eae,i2,r2,(e,t,i,s,f)=>{var y={},T;return i.forEach(o=>{var C=Aae(t,o);T==null&&(T=Cae(t,s,e));var M=s==="left"&&!f||s==="right"&&f;y[o.id]=T-Number(M)*C.width,T+=(M?-1:1)*C.width}),y}),Iae=(e,t)=>{var i=nc(e),s=vm(e,t);if(s!=null){var f=Mae(e,s.orientation,s.mirror),y=f[t];return y==null?{x:i.left,y:0}:{x:i.left,y}}},Dae=(e,t)=>{var i=nc(e),s=Bg(e,t);if(s!=null){var f=Oae(e,s.orientation,s.mirror),y=f[t];return y==null?{x:0,y:i.top}:{x:y,y:i.top}}},nV=Fn(nc,Bg,(e,t)=>{var i=typeof t.width=="number"?t.width:FT;return{width:i,height:e.height}}),dN=(e,t,i)=>{switch(t){case"xAxis":return tV(e,i).width;case"yAxis":return nV(e,i).height;default:return}},iV=(e,t,i,s)=>{if(i!=null){var{allowDuplicatedCategory:f,type:y,dataKey:T}=i,o=hy(e,s),C=t.map(M=>M.value);if(T&&o&&y==="category"&&f&&c5(C))return C}},bO=Fn([Ba,n2,Xu,Hl],iV),rV=(e,t,i,s)=>{if(!(i==null||i.dataKey==null)){var{type:f,scale:y}=i,T=hy(e,s);if(T&&(f==="number"||y!=="auto"))return t.map(o=>o.value)}},wO=Fn([Ba,n2,db,Hl],rV),fN=Fn([Ba,Xoe,pb,Wv,bO,wO,mb,xO,Hl],(e,t,i,s,f,y,T,o,C)=>{if(t==null)return null;var M=hy(e,C);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:C,categoricalDomain:y,duplicateDomain:f,isCategorical:M,niceTicks:o,range:T,realScaleType:i,scale:s}}),Rae=(e,t,i,s,f,y,T,o,C)=>{if(!(t==null||s==null)){var M=hy(e,C),{type:I,ticks:j,tickCount:q}=t,K=i==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,J=I==="category"&&s.bandwidth?s.bandwidth()/K:0;J=C==="angleAxis"&&y!=null&&y.length>=2?Vu(y[0]-y[1])*2*J:J;var te=j||f;if(te){var oe=te.map((ce,de)=>{var ue=T?T.indexOf(ce):ce;return{index:de,coordinate:s(ue)+J,value:ce,offset:J}});return oe.filter(ce=>!Th(ce.coordinate))}return M&&o?o.map((ce,de)=>({coordinate:s(ce)+J,value:ce,index:de,offset:J})):s.ticks?s.ticks(q).map(ce=>({coordinate:s(ce)+J,value:ce,offset:J})):s.domain().map((ce,de)=>({coordinate:s(ce)+J,value:T?T[ce]:ce,index:de,offset:J}))}},oV=Fn([Ba,db,pb,Wv,xO,mb,bO,wO,Hl],Rae),Lae=(e,t,i,s,f,y,T)=>{if(!(t==null||i==null||s==null||s[0]===s[1])){var o=hy(e,T),{tickCount:C}=t,M=0;return M=T==="angleAxis"&&s?.length>=2?Vu(s[0]-s[1])*2*M:M,o&&y?y.map((I,j)=>({coordinate:i(I)+M,value:I,index:j,offset:M})):i.ticks?i.ticks(C).map(I=>({coordinate:i(I)+M,value:I,offset:M})):i.domain().map((I,j)=>({coordinate:i(I)+M,value:f?f[I]:I,index:j,offset:M}))}},zv=Fn([Ba,db,Wv,mb,bO,wO,Hl],Lae),Mg=Fn(Xu,Wv,(e,t)=>{if(!(e==null||t==null))return eT(eT({},e),{},{scale:t})}),zae=Fn([Xu,pb,yO,JU],vO);Fn((e,t,i)=>pO(e,i),zae,(e,t)=>{if(!(e==null||t==null))return eT(eT({},e),{},{scale:t})});var kae=Fn([Ba,MM,OM],(e,t,i)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return i.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),aV=e=>e.options.defaultTooltipEventType,sV=e=>e.options.validateTooltipEventTypes;function lV(e,t,i){if(e==null)return t;var s=e?"axis":"item";return i==null?t:i.includes(s)?s:t}function TO(e,t){var i=aV(e),s=sV(e);return lV(t,i,s)}function Nae(e){return gr(t=>TO(t,e))}var cV=(e,t)=>{var i,s=Number(t);if(!(Th(s)||t==null))return s>=0?e==null||(i=e[s])===null||i===void 0?void 0:i.value:void 0},Bae=e=>e.tooltip.settings,bg={active:!1,index:null,dataKey:void 0,coordinate:void 0},jae={itemInteraction:{click:bg,hover:bg},axisInteraction:{click:bg,hover:bg},keyboardInteraction:bg,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},uV=Sd({name:"tooltip",initialState:jae,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var i=Sg(e).tooltipItemPayloads.indexOf(t.payload);i>-1&&e.tooltipItemPayloads.splice(i,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:Fae,removeTooltipEntrySettings:Uae,setTooltipSettingsState:Vae,setActiveMouseOverItemIndex:hV,mouseLeaveItem:$ae,mouseLeaveChart:dV,setActiveClickItemIndex:qae,setMouseOverAxisIndex:fV,setMouseClickAxisIndex:Hae,setSyncInteraction:VP,setKeyboardInteraction:$P}=uV.actions,Gae=uV.reducer;function pN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Jw(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?pN(Object(i),!0).forEach(function(s){Zae(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):pN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Zae(e,t,i){return(t=Wae(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Wae(e){var t=Xae(e,"string");return typeof t=="symbol"?t:t+""}function Xae(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yae(e,t,i){return t==="axis"?i==="click"?e.axisInteraction.click:e.axisInteraction.hover:i==="click"?e.itemInteraction.click:e.itemInteraction.hover}function Kae(e){return e.index!=null}var pV=(e,t,i,s)=>{if(t==null)return bg;var f=Yae(e,t,i);if(f==null)return bg;if(f.active)return f;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var y=e.settings.active===!0;if(Kae(f)){if(y)return Jw(Jw({},f),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return Jw(Jw({},bg),{},{coordinate:f.coordinate})},SO=(e,t)=>{var i=e?.index;if(i==null)return null;var s=Number(i);if(!Ah(s))return i;var f=0,y=1/0;return t.length>0&&(y=t.length-1),String(Math.max(f,Math.min(s,y)))},mV=(e,t,i,s,f,y,T,o)=>{if(!(y==null||o==null)){var C=T[0],M=C==null?void 0:o(C.positions,y);if(M!=null)return M;var I=f?.[Number(y)];if(I)switch(i){case"horizontal":return{x:I.coordinate,y:(s.top+t)/2};default:return{x:(s.left+e)/2,y:I.coordinate}}}},gV=(e,t,i,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var f;return i==="hover"?f=e.itemInteraction.hover.dataKey:f=e.itemInteraction.click.dataKey,f==null&&s!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(y=>{var T;return((T=y.settings)===null||T===void 0?void 0:T.dataKey)===f})},o2=e=>e.options.tooltipPayloadSearcher,Xv=e=>e.tooltip,Gl=e=>{var t=Ba(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Yv=e=>e.tooltip.settings.axisId,zc=e=>{var t=Gl(e),i=Yv(e);return db(e,t,i)},EO=Fn([zc,Ba,MU,lO,Gl],WU),Jae=Fn([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Qae=Fn([Gl,Yv],OU),a2=Fn([Jae,zc,Qae],IU),ese=Fn([a2],RU),my=Fn([ese,qv],LU),AO=Fn([my,zc,a2],zU),tse=Fn([zc],gO),nse=Fn([my,a2,KT],NU),ise=Fn([nse,qv,Gl],BU),rse=Fn([a2],DU),ose=Fn([my,zc,rse,Gl],jU),ase=Fn([FU,Gl,Yv],Zv),sse=Fn([ase,Gl],$U),lse=Fn([UU,Gl,Yv],Zv),cse=Fn([lse,Gl],qU),use=Fn([VU,Gl,Yv],Zv),hse=Fn([use,Gl],HU),dse=Fn([sse,hse,cse],_O),fse=Fn([zc,tse,ise,ose,dse],GU),_V=Fn([zc,Ba,my,AO,KT,Gl,fse],ZU),pse=Fn([_V,zc,EO],XU),mse=Fn([zc,_V,pse,Gl],YU),yV=e=>{var t=Gl(e),i=Yv(e),s=!1;return mb(e,t,i,s)},vV=Fn([zc,yV],JT),xV=Fn([zc,EO,mse,vV],vO),gse=Fn([Ba,AO,zc,Gl],iV),_se=Fn([Ba,AO,zc,Gl],rV),yse=(e,t,i,s,f,y,T,o)=>{if(t){var{type:C}=t,M=hy(e,o);if(s){var I=i==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,j=C==="category"&&s.bandwidth?s.bandwidth()/I:0;return j=o==="angleAxis"&&f!=null&&f?.length>=2?Vu(f[0]-f[1])*2*j:j,M&&T?T.map((q,K)=>({coordinate:s(q)+j,value:q,index:K,offset:j})):s.domain().map((q,K)=>({coordinate:s(q)+j,value:y?y[q]:q,index:K,offset:j}))}}},xm=Fn([Ba,zc,EO,xV,yV,gse,_se,Gl],yse),bV=Fn([aV,sV,Bae],(e,t,i)=>lV(i.shared,e,t)),wV=e=>e.tooltip.settings.trigger,PO=e=>e.tooltip.settings.defaultIndex,s2=Fn([Xv,bV,wV,PO],pV),Gx=Fn([s2,my],SO),vse=Fn([xm,Gx],cV),TV=Fn([s2],e=>{if(e)return e.dataKey}),xse=Fn([Xv,bV,wV,PO],gV),bse=Fn([Rg,Lg,Ba,nc,xm,PO,xse,o2],mV),wse=Fn([s2,bse],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Tse=Fn([s2],e=>e.active);function mN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function gN(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?mN(Object(i),!0).forEach(function(s){Sse(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Sse(e,t,i){return(t=Ese(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ese(e){var t=Ase(e,"string");return typeof t=="symbol"?t:t+""}function Ase(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pse=()=>gr(zc),Cse=()=>{var e=Pse(),t=gr(xm),i=gr(xV);return CM(gN(gN({},e),{},{scale:i}),t)};function _N(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function yN(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?_N(Object(i),!0).forEach(function(s){Mse(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_N(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Mse(e,t,i){return(t=Ose(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ose(e){var t=Ise(e,"string");return typeof t=="symbol"?t:t+""}function Ise(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dse=()=>gr(lO),CO=(e,t)=>t,SV=(e,t,i)=>i,MO=(e,t,i,s)=>s;function Rse(e,t,i){return Array.isArray(e)&&e&&t+i!==0?e.slice(t,i+1):e}var Lse=Fn(xm,e=>RT(e,t=>t.coordinate)),OO=Fn([Xv,CO,SV,MO],pV),EV=Fn([OO,my],SO),zse=(e,t,i)=>{if(t!=null){var s=Xv(e);return t==="axis"?i==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:i==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},AV=Fn([Xv,CO,SV,MO],gV),tT=Fn([Rg,Lg,Ba,nc,xm,MO,AV,o2],mV),kse=Fn([OO,tT],(e,t)=>{var i;return(i=e.coordinate)!==null&&i!==void 0?i:t}),PV=Fn(xm,EV,cV);function Nse(e,t){return e??t}var Bse=(e,t,i,s,f,y,T)=>{if(!(t==null||y==null)){var{chartData:o,computedData:C,dataStartIndex:M,dataEndIndex:I}=i,j=[];return e.reduce((q,K)=>{var J,{dataDefinedOnItem:te,settings:oe}=K,ce=Nse(te,o),de=Rse(ce,M,I),ue=(J=oe?.dataKey)!==null&&J!==void 0?J:s?.dataKey,Pe=oe?.nameKey,Oe;if(s!=null&&s.dataKey&&!(s!=null&&s.allowDuplicatedCategory)&&Array.isArray(de)&&T==="axis"?Oe=DK(de,s.dataKey,f):Oe=y(de,t,C,Pe),Array.isArray(Oe))Oe.forEach(Qe=>{var tt=yN(yN({},oe),{},{name:Qe.name,unit:Qe.unit,color:void 0,fill:void 0});q.push(Yk({tooltipEntrySettings:tt,dataKey:Qe.dataKey,payload:Qe.payload,value:wh(Qe.payload,Qe.dataKey),name:Qe.name}))});else{var xe;q.push(Yk({tooltipEntrySettings:oe,dataKey:ue,payload:Oe,value:wh(Oe,ue),name:(xe=wh(Oe,Pe))!==null&&xe!==void 0?xe:oe?.name}))}return q},j)}},jse=Fn([AV,EV,qv,zc,PV,o2,CO],Bse),Fse=Fn([OO],e=>({isActive:e.active,activeIndex:e.index})),Use=(e,t,i,s,f,y,T,o)=>{if(!(!e||!t||!s||!f||!y)){var C=Jee(e.chartX,e.chartY,t,i,o);if(C){var M=ete(C,t),I=Fee(M,T,y,s,f),j=Qee(t,y,I,C);return{activeIndex:String(I),activeCoordinate:j}}}};function qP(){return qP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},qP.apply(null,arguments)}function vN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Qw(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?vN(Object(i),!0).forEach(function(s){Vse(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Vse(e,t,i){return(t=$se(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $se(e){var t=qse(e,"string");return typeof t=="symbol"?t:t+""}function qse(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hse(e){var{coordinate:t,payload:i,index:s,offset:f,tooltipAxisBandSize:y,layout:T,cursor:o,tooltipEventType:C,chartName:M}=e,I=t,j=i,q=s;if(!o||!I||M!=="ScatterChart"&&C!=="axis")return null;var K,J;if(M==="ScatterChart")K=I,J=nne;else if(M==="BarChart")K=ine(T,I,f,y),J=w4;else if(T==="radial"){var{cx:te,cy:oe,radius:ce,startAngle:de,endAngle:ue}=T4(I);K={cx:te,cy:oe,startAngle:de,endAngle:ue,innerRadius:ce,outerRadius:ce},J=E4}else K={points:$ne(T,I,f)},J=Zte;var Pe=typeof o=="object"&&"className"in o?o.className:void 0,Oe=Qw(Qw(Qw(Qw({stroke:"#ccc",pointerEvents:"none"},f),K),gs(o,!1)),{},{payload:j,payloadIndex:q,className:Ya("recharts-tooltip-cursor",Pe)});return me.isValidElement(o)?me.cloneElement(o,Oe):me.createElement(J,Oe)}function Gse(e){var t=Cse(),i=$T(),s=LM(),f=Dse();return me.createElement(Hse,qP({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:i,layout:s,tooltipAxisBandSize:t,chartName:f}))}var CV=me.createContext(null),Zse=()=>me.useContext(CV),pA={exports:{}},xN;function Wse(){return xN||(xN=1,function(e){var t=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function f(C,M,I){this.fn=C,this.context=M,this.once=I||!1}function y(C,M,I,j,q){if(typeof I!="function")throw new TypeError("The listener must be a function");var K=new f(I,j||C,q),J=i?i+M:M;return C._events[J]?C._events[J].fn?C._events[J]=[C._events[J],K]:C._events[J].push(K):(C._events[J]=K,C._eventsCount++),C}function T(C,M){--C._eventsCount===0?C._events=new s:delete C._events[M]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var M=[],I,j;if(this._eventsCount===0)return M;for(j in I=this._events)t.call(I,j)&&M.push(i?j.slice(1):j);return Object.getOwnPropertySymbols?M.concat(Object.getOwnPropertySymbols(I)):M},o.prototype.listeners=function(M){var I=i?i+M:M,j=this._events[I];if(!j)return[];if(j.fn)return[j.fn];for(var q=0,K=j.length,J=new Array(K);q<K;q++)J[q]=j[q].fn;return J},o.prototype.listenerCount=function(M){var I=i?i+M:M,j=this._events[I];return j?j.fn?1:j.length:0},o.prototype.emit=function(M,I,j,q,K,J){var te=i?i+M:M;if(!this._events[te])return!1;var oe=this._events[te],ce=arguments.length,de,ue;if(oe.fn){switch(oe.once&&this.removeListener(M,oe.fn,void 0,!0),ce){case 1:return oe.fn.call(oe.context),!0;case 2:return oe.fn.call(oe.context,I),!0;case 3:return oe.fn.call(oe.context,I,j),!0;case 4:return oe.fn.call(oe.context,I,j,q),!0;case 5:return oe.fn.call(oe.context,I,j,q,K),!0;case 6:return oe.fn.call(oe.context,I,j,q,K,J),!0}for(ue=1,de=new Array(ce-1);ue<ce;ue++)de[ue-1]=arguments[ue];oe.fn.apply(oe.context,de)}else{var Pe=oe.length,Oe;for(ue=0;ue<Pe;ue++)switch(oe[ue].once&&this.removeListener(M,oe[ue].fn,void 0,!0),ce){case 1:oe[ue].fn.call(oe[ue].context);break;case 2:oe[ue].fn.call(oe[ue].context,I);break;case 3:oe[ue].fn.call(oe[ue].context,I,j);break;case 4:oe[ue].fn.call(oe[ue].context,I,j,q);break;default:if(!de)for(Oe=1,de=new Array(ce-1);Oe<ce;Oe++)de[Oe-1]=arguments[Oe];oe[ue].fn.apply(oe[ue].context,de)}}return!0},o.prototype.on=function(M,I,j){return y(this,M,I,j,!1)},o.prototype.once=function(M,I,j){return y(this,M,I,j,!0)},o.prototype.removeListener=function(M,I,j,q){var K=i?i+M:M;if(!this._events[K])return this;if(!I)return T(this,K),this;var J=this._events[K];if(J.fn)J.fn===I&&(!q||J.once)&&(!j||J.context===j)&&T(this,K);else{for(var te=0,oe=[],ce=J.length;te<ce;te++)(J[te].fn!==I||q&&!J[te].once||j&&J[te].context!==j)&&oe.push(J[te]);oe.length?this._events[K]=oe.length===1?oe[0]:oe:T(this,K)}return this},o.prototype.removeAllListeners=function(M){var I;return M?(I=i?i+M:M,this._events[I]&&T(this,I)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o}(pA)),pA.exports}var Xse=Wse();const Yse=Zu(Xse);var Zx=new Yse,HP="recharts.syncEvent.tooltip",bN="recharts.syncEvent.brush";function Kse(e,t){if(t){var i=Number.parseInt(t,10);if(!Th(i))return e?.[i]}}var Jse={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},MV=Sd({name:"options",initialState:Jse,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Qse=MV.reducer,{createEventEmitter:ele}=MV.actions;function tle(e){return e.tooltip.syncInteraction}var nle={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},OV=Sd({name:"chartData",initialState:nle,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:i,endIndex:s}=t.payload;i!=null&&(e.dataStartIndex=i),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:wN,setDataStartEndIndexes:ile,setComputedData:Lye}=OV.actions,rle=OV.reducer,IV=()=>{};function ole(){var e=gr(cO),t=gr(uO),i=rl(),s=gr(SU),f=gr(xm),y=LM(),T=IM(),o=gr(C=>C.rootProps.className);me.useEffect(()=>{if(e==null)return IV;var C=(M,I,j)=>{if(t!==j&&e===M){if(s==="index"){i(I);return}if(f!=null){var q;if(typeof s=="function"){var K={activeTooltipIndex:I.payload.index==null?void 0:Number(I.payload.index),isTooltipActive:I.payload.active,activeIndex:I.payload.index==null?void 0:Number(I.payload.index),activeLabel:I.payload.label,activeDataKey:I.payload.dataKey,activeCoordinate:I.payload.coordinate},J=s(f,K);q=f[J]}else s==="value"&&(q=f.find(xe=>String(xe.value)===I.payload.label));var{coordinate:te}=I.payload;if(q==null||I.payload.active===!1||te==null||T==null){i(VP({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:oe,y:ce}=te,de=Math.min(oe,T.x+T.width),ue=Math.min(ce,T.y+T.height),Pe={x:y==="horizontal"?q.coordinate:de,y:y==="horizontal"?ue:q.coordinate},Oe=VP({active:I.payload.active,coordinate:Pe,dataKey:I.payload.dataKey,index:String(q.index),label:I.payload.label});i(Oe)}}};return Zx.on(HP,C),()=>{Zx.off(HP,C)}},[o,i,t,e,s,f,y,T])}function ale(){var e=gr(cO),t=gr(uO),i=rl();me.useEffect(()=>{if(e==null)return IV;var s=(f,y,T)=>{t!==T&&e===f&&i(ile(y))};return Zx.on(bN,s),()=>{Zx.off(bN,s)}},[i,t,e])}function sle(){var e=rl();me.useEffect(()=>{e(ele())},[e]),ole(),ale()}function lle(e,t,i,s,f,y){var T=gr(q=>zse(q,e,t)),o=gr(uO),C=gr(cO),M=gr(SU),I=gr(tle),j=I?.active;me.useEffect(()=>{if(!j&&C!=null&&o!=null){var q=VP({active:y,coordinate:i,dataKey:T,index:f,label:typeof s=="number"?String(s):s});Zx.emit(HP,C,q,o)}},[j,i,T,f,s,o,C,M,y])}function TN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function SN(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?TN(Object(i),!0).forEach(function(s){cle(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):TN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function cle(e,t,i){return(t=ule(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ule(e){var t=hle(e,"string");return typeof t=="symbol"?t:t+""}function hle(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dle(e){return e.dataKey}function fle(e,t){return me.isValidElement(e)?me.cloneElement(e,t):typeof e=="function"?me.createElement(e,t):me.createElement(Rte,t)}var EN=[],ple={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!sb.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function AN(e){var t=zg(e,ple),{active:i,allowEscapeViewBox:s,animationDuration:f,animationEasing:y,content:T,filterNull:o,isAnimationActive:C,offset:M,payloadUniqBy:I,position:j,reverseDirection:q,useTranslate3d:K,wrapperStyle:J,cursor:te,shared:oe,trigger:ce,defaultIndex:de,portal:ue,axisId:Pe}=t,Oe=rl(),xe=typeof de=="number"?String(de):de;me.useEffect(()=>{Oe(Vae({shared:oe,trigger:ce,axisId:Pe,active:i,defaultIndex:xe}))},[Oe,oe,ce,Pe,i,xe]);var Qe=IM(),tt=y4(),Ge=Nae(oe),{activeIndex:Je,isActive:Ve}=gr(ct=>Fse(ct,Ge,ce,xe)),xt=gr(ct=>jse(ct,Ge,ce,xe)),yt=gr(ct=>PV(ct,Ge,ce,xe)),ot=gr(ct=>kse(ct,Ge,ce,xe)),zt=xt,rt=Zse(),Bt=i??Ve,[Vt,Ln]=F5([zt,Bt]),$e=Ge==="axis"?yt:void 0;lle(Ge,ce,ot,$e,Je,Bt);var Pt=ue??rt;if(Pt==null)return null;var $t=zt??EN;Bt||($t=EN),o&&$t.length&&($t=z5(zt.filter(ct=>ct.value!=null&&(ct.hide!==!0||t.includeHidden)),I,dle));var on=$t.length>0,An=me.createElement(Fte,{allowEscapeViewBox:s,animationDuration:f,animationEasing:y,isAnimationActive:C,active:Bt,coordinate:ot,hasPayload:on,offset:M,position:j,reverseDirection:q,useTranslate3d:K,viewBox:Qe,wrapperStyle:J,lastBoundingBox:Vt,innerRef:Ln,hasPortalFromProps:!!ue},fle(T,SN(SN({},t),{},{payload:$t,label:$e,active:Bt,coordinate:ot,accessibilityLayer:tt})));return me.createElement(me.Fragment,null,eM.createPortal(An,Pt),Bt&&me.createElement(Gse,{cursor:te,tooltipEventType:Ge,coordinate:ot,payload:zt,index:Je}))}var mA={},gA={},PN;function mle(){return PN||(PN=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i,s=0,f={}){typeof f!="object"&&(f={});let y=null,T=null,o=null,C=0,M=null,I;const{leading:j=!1,trailing:q=!0,maxWait:K}=f,J="maxWait"in f,te=J?Math.max(Number(K)||0,s):0,oe=Qe=>(y!==null&&(I=i.apply(T,y)),y=T=null,C=Qe,I),ce=Qe=>(C=Qe,M=setTimeout(Oe,s),j&&y!==null?oe(Qe):I),de=Qe=>(M=null,q&&y!==null?oe(Qe):I),ue=Qe=>{if(o===null)return!0;const tt=Qe-o,Ge=tt>=s||tt<0,Je=J&&Qe-C>=te;return Ge||Je},Pe=Qe=>{const tt=o===null?0:Qe-o,Ge=s-tt,Je=te-(Qe-C);return J?Math.min(Ge,Je):Ge},Oe=()=>{const Qe=Date.now();if(ue(Qe))return de(Qe);M=setTimeout(Oe,Pe(Qe))},xe=function(...Qe){const tt=Date.now(),Ge=ue(tt);if(y=Qe,T=this,o=tt,Ge){if(M===null)return ce(tt);if(J)return clearTimeout(M),M=setTimeout(Oe,s),oe(tt)}return M===null&&(M=setTimeout(Oe,s)),I};return xe.cancel=()=>{M!==null&&clearTimeout(M),C=0,o=y=T=M=null},xe.flush=()=>M===null?I:de(Date.now()),xe}e.debounce=t}(gA)),gA}var CN;function gle(){return CN||(CN=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mle();function i(s,f=0,y={}){const{leading:T=!0,trailing:o=!0}=y;return t.debounce(s,f,{leading:T,maxWait:f,trailing:o})}e.throttle=i}(mA)),mA}var _A,MN;function _le(){return MN||(MN=1,_A=gle().throttle),_A}var yle=_le();const vle=Zu(yle);var Ex=function(t,i){for(var s=arguments.length,f=new Array(s>2?s-2:0),y=2;y<s;y++)f[y-2]=arguments[y]};function ON(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function yA(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ON(Object(i),!0).forEach(function(s){xle(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ON(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function xle(e,t,i){return(t=ble(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ble(e){var t=wle(e,"string");return typeof t=="symbol"?t:t+""}function wle(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IN=me.forwardRef((e,t)=>{var{aspect:i,initialDimension:s={width:-1,height:-1},width:f="100%",height:y="100%",minWidth:T=0,minHeight:o,maxHeight:C,children:M,debounce:I=0,id:j,className:q,onResize:K,style:J={}}=e,te=me.useRef(null),oe=me.useRef();oe.current=K,me.useImperativeHandle(t,()=>te.current);var[ce,de]=me.useState({containerWidth:s.width,containerHeight:s.height}),ue=me.useCallback((Oe,xe)=>{de(Qe=>{var tt=Math.round(Oe),Ge=Math.round(xe);return Qe.containerWidth===tt&&Qe.containerHeight===Ge?Qe:{containerWidth:tt,containerHeight:Ge}})},[]);me.useEffect(()=>{var Oe=Ge=>{var Je,{width:Ve,height:xt}=Ge[0].contentRect;ue(Ve,xt),(Je=oe.current)===null||Je===void 0||Je.call(oe,Ve,xt)};I>0&&(Oe=vle(Oe,I,{trailing:!0,leading:!1}));var xe=new ResizeObserver(Oe),{width:Qe,height:tt}=te.current.getBoundingClientRect();return ue(Qe,tt),xe.observe(te.current),()=>{xe.disconnect()}},[ue,I]);var Pe=me.useMemo(()=>{var{containerWidth:Oe,containerHeight:xe}=ce;if(Oe<0||xe<0)return null;Ex(V_(f)||V_(y),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,f,y),Ex(!i||i>0,"The aspect(%s) must be greater than zero.",i);var Qe=V_(f)?Oe:f,tt=V_(y)?xe:y;return i&&i>0&&(Qe?tt=Qe/i:tt&&(Qe=tt*i),C&&tt>C&&(tt=C)),Ex(Qe>0||tt>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Qe,tt,f,y,T,o,i),me.Children.map(M,Ge=>me.cloneElement(Ge,{width:Qe,height:tt,style:yA({height:"100%",width:"100%",maxHeight:tt,maxWidth:Qe},Ge.props.style)}))},[i,M,y,C,o,T,ce,f]);return me.createElement("div",{id:j?"".concat(j):void 0,className:Ya("recharts-responsive-container",q),style:yA(yA({},J),{},{width:f,height:y,minWidth:T,minHeight:o,maxHeight:C}),ref:te},Pe)}),DV=e=>null;DV.displayName="Cell";function DN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function GP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?DN(Object(i),!0).forEach(function(s){Tle(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Tle(e,t,i){return(t=Sle(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Sle(e){var t=Ele(e,"string");return typeof t=="symbol"?t:t+""}function Ele(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hv={widthCache:{},cacheCount:0},Ale=2e3,Ple={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},RN="recharts_measurement_span";function Cle(e){var t=GP({},e);return Object.keys(t).forEach(i=>{t[i]||delete t[i]}),t}var Ax=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||sb.isSsr)return{width:0,height:0};var s=Cle(i),f=JSON.stringify({text:t,copyStyle:s});if(hv.widthCache[f])return hv.widthCache[f];try{var y=document.getElementById(RN);y||(y=document.createElement("span"),y.setAttribute("id",RN),y.setAttribute("aria-hidden","true"),document.body.appendChild(y));var T=GP(GP({},Ple),s);Object.assign(y.style,T),y.textContent="".concat(t);var o=y.getBoundingClientRect(),C={width:o.width,height:o.height};return hv.widthCache[f]=C,++hv.cacheCount>Ale&&(hv.cacheCount=0,hv.widthCache={}),C}catch{return{width:0,height:0}}},LN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,zN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Mle=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Ole=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,RV={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Ile=Object.keys(RV),yv="NaN";function Dle(e,t){return e*RV[t]}class Fu{static parse(t){var i,[,s,f]=(i=Ole.exec(t))!==null&&i!==void 0?i:[];return new Fu(parseFloat(s),f??"")}constructor(t,i){this.num=t,this.unit=i,this.num=t,this.unit=i,Th(t)&&(this.unit=""),i!==""&&!Mle.test(i)&&(this.num=NaN,this.unit=""),Ile.includes(i)&&(this.num=Dle(t,i),this.unit="px")}add(t){return this.unit!==t.unit?new Fu(NaN,""):new Fu(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Fu(NaN,""):new Fu(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Fu(NaN,""):new Fu(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Fu(NaN,""):new Fu(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Th(this.num)}}function LV(e){if(e.includes(yv))return yv;for(var t=e;t.includes("*")||t.includes("/");){var i,[,s,f,y]=(i=LN.exec(t))!==null&&i!==void 0?i:[],T=Fu.parse(s??""),o=Fu.parse(y??""),C=f==="*"?T.multiply(o):T.divide(o);if(C.isNaN())return yv;t=t.replace(LN,C.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var M,[,I,j,q]=(M=zN.exec(t))!==null&&M!==void 0?M:[],K=Fu.parse(I??""),J=Fu.parse(q??""),te=j==="+"?K.add(J):K.subtract(J);if(te.isNaN())return yv;t=t.replace(zN,te.toString())}return t}var kN=/\(([^()]*)\)/;function Rle(e){for(var t=e,i;(i=kN.exec(t))!=null;){var[,s]=i;t=t.replace(kN,LV(s))}return t}function Lle(e){var t=e.replace(/\s+/g,"");return t=Rle(t),t=LV(t),t}function zle(e){try{return Lle(e)}catch{return yv}}function vA(e){var t=zle(e.slice(5,-1));return t===yv?"":t}var kle=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Nle=["dx","dy","angle","className","breakAll"];function ZP(){return ZP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},ZP.apply(null,arguments)}function NN(e,t){if(e==null)return{};var i,s,f=Ble(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function Ble(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var zV=/[ \f\n\r\t\v\u2028\u2029]+/,kV=e=>{var{children:t,breakAll:i,style:s}=e;try{var f=[];vl(t)||(i?f=t.toString().split(""):f=t.toString().split(zV));var y=f.map(o=>({word:o,width:Ax(o,s).width})),T=i?0:Ax(" ",s).width;return{wordsWithComputedWidth:y,spaceWidth:T}}catch{return null}},jle=(e,t,i,s,f)=>{var{maxLines:y,children:T,style:o,breakAll:C}=e,M=Hi(y),I=T,j=function(){var Ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ve.reduce((xt,yt)=>{var{word:ot,width:zt}=yt,rt=xt[xt.length-1];if(rt&&(s==null||f||rt.width+zt+i<Number(s)))rt.words.push(ot),rt.width+=zt+i;else{var Bt={words:[ot],width:zt};xt.push(Bt)}return xt},[])},q=j(t),K=Je=>Je.reduce((Ve,xt)=>Ve.width>xt.width?Ve:xt);if(!M||f)return q;var J=q.length>y||K(q).width>Number(s);if(!J)return q;for(var te="…",oe=Je=>{var Ve=I.slice(0,Je),xt=kV({breakAll:C,style:o,children:Ve+te}).wordsWithComputedWidth,yt=j(xt),ot=yt.length>y||K(yt).width>Number(s);return[ot,yt]},ce=0,de=I.length-1,ue=0,Pe;ce<=de&&ue<=I.length-1;){var Oe=Math.floor((ce+de)/2),xe=Oe-1,[Qe,tt]=oe(xe),[Ge]=oe(Oe);if(!Qe&&!Ge&&(ce=Oe+1),Qe&&Ge&&(de=Oe-1),!Qe&&Ge){Pe=tt;break}ue++}return Pe||q},BN=e=>{var t=vl(e)?[]:e.toString().split(zV);return[{words:t}]},Fle=e=>{var{width:t,scaleToFit:i,children:s,style:f,breakAll:y,maxLines:T}=e;if((t||i)&&!sb.isSsr){var o,C,M=kV({breakAll:y,children:s,style:f});if(M){var{wordsWithComputedWidth:I,spaceWidth:j}=M;o=I,C=j}else return BN(s);return jle({breakAll:y,children:s,maxLines:T,style:f},o,C,t,i)}return BN(s)},jN="#808080",IO=me.forwardRef((e,t)=>{var{x:i=0,y:s=0,lineHeight:f="1em",capHeight:y="0.71em",scaleToFit:T=!1,textAnchor:o="start",verticalAnchor:C="end",fill:M=jN}=e,I=NN(e,kle),j=me.useMemo(()=>Fle({breakAll:I.breakAll,children:I.children,maxLines:I.maxLines,scaleToFit:T,style:I.style,width:I.width}),[I.breakAll,I.children,I.maxLines,T,I.style,I.width]),{dx:q,dy:K,angle:J,className:te,breakAll:oe}=I,ce=NN(I,Nle);if(!up(i)||!up(s))return null;var de=i+(Hi(q)?q:0),ue=s+(Hi(K)?K:0),Pe;switch(C){case"start":Pe=vA("calc(".concat(y,")"));break;case"middle":Pe=vA("calc(".concat((j.length-1)/2," * -").concat(f," + (").concat(y," / 2))"));break;default:Pe=vA("calc(".concat(j.length-1," * -").concat(f,")"));break}var Oe=[];if(T){var xe=j[0].width,{width:Qe}=I;Oe.push("scale(".concat(Hi(Qe)?Qe/xe:1,")"))}return J&&Oe.push("rotate(".concat(J,", ").concat(de,", ").concat(ue,")")),Oe.length&&(ce.transform=Oe.join(" ")),me.createElement("text",ZP({},gs(ce,!0),{ref:t,x:de,y:ue,className:Ya("recharts-text",te),textAnchor:o,fill:M.includes("url")?jN:M}),j.map((tt,Ge)=>{var Je=tt.words.join(oe?"":" ");return me.createElement("tspan",{x:de,dy:Ge===0?Pe:f,key:"".concat(Je,"-").concat(Ge)},Je)}))});IO.displayName="Text";var Ule=["offset"],Vle=["labelRef"];function FN(e,t){if(e==null)return{};var i,s,f=$le(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function $le(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function UN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function gl(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?UN(Object(i),!0).forEach(function(s){qle(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):UN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function qle(e,t,i){return(t=Hle(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Hle(e){var t=Gle(e,"string");return typeof t=="symbol"?t:t+""}function Gle(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sm(){return sm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},sm.apply(null,arguments)}var Zle=e=>{var{value:t,formatter:i}=e,s=vl(e.children)?t:e.children;return typeof i=="function"?i(s):s},DO=e=>e!=null&&typeof e=="function",Wle=(e,t)=>{var i=Vu(t-e),s=Math.min(Math.abs(t-e),360);return i*s},Xle=(e,t,i)=>{var{position:s,viewBox:f,offset:y,className:T}=e,{cx:o,cy:C,innerRadius:M,outerRadius:I,startAngle:j,endAngle:q,clockWise:K}=f,J=(M+I)/2,te=Wle(j,q),oe=te>=0?1:-1,ce,de;s==="insideStart"?(ce=j+oe*y,de=K):s==="insideEnd"?(ce=q-oe*y,de=!K):s==="end"&&(ce=q+oe*y,de=K),de=te<=0?de:!de;var ue=ec(o,C,J,ce),Pe=ec(o,C,J,ce+(de?1:-1)*359),Oe="M".concat(ue.x,",").concat(ue.y,`
    A`).concat(J,",").concat(J,",0,1,").concat(de?0:1,`,
    `).concat(Pe.x,",").concat(Pe.y),xe=vl(e.id)?kx("recharts-radial-line-"):e.id;return me.createElement("text",sm({},i,{dominantBaseline:"central",className:Ya("recharts-radial-bar-label",T)}),me.createElement("defs",null,me.createElement("path",{id:xe,d:Oe})),me.createElement("textPath",{xlinkHref:"#".concat(xe)},t))},Yle=e=>{var{viewBox:t,offset:i,position:s}=e,{cx:f,cy:y,innerRadius:T,outerRadius:o,startAngle:C,endAngle:M}=t,I=(C+M)/2;if(s==="outside"){var{x:j,y:q}=ec(f,y,o+i,I);return{x:j,y:q,textAnchor:j>=f?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:f,y,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:f,y,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:f,y,textAnchor:"middle",verticalAnchor:"end"};var K=(T+o)/2,{x:J,y:te}=ec(f,y,K,I);return{x:J,y:te,textAnchor:"middle",verticalAnchor:"middle"}},Kle=(e,t)=>{var{parentViewBox:i,offset:s,position:f}=e,{x:y,y:T,width:o,height:C}=t,M=C>=0?1:-1,I=M*s,j=M>0?"end":"start",q=M>0?"start":"end",K=o>=0?1:-1,J=K*s,te=K>0?"end":"start",oe=K>0?"start":"end";if(f==="top"){var ce={x:y+o/2,y:T-M*s,textAnchor:"middle",verticalAnchor:j};return gl(gl({},ce),i?{height:Math.max(T-i.y,0),width:o}:{})}if(f==="bottom"){var de={x:y+o/2,y:T+C+I,textAnchor:"middle",verticalAnchor:q};return gl(gl({},de),i?{height:Math.max(i.y+i.height-(T+C),0),width:o}:{})}if(f==="left"){var ue={x:y-J,y:T+C/2,textAnchor:te,verticalAnchor:"middle"};return gl(gl({},ue),i?{width:Math.max(ue.x-i.x,0),height:C}:{})}if(f==="right"){var Pe={x:y+o+J,y:T+C/2,textAnchor:oe,verticalAnchor:"middle"};return gl(gl({},Pe),i?{width:Math.max(i.x+i.width-Pe.x,0),height:C}:{})}var Oe=i?{width:o,height:C}:{};return f==="insideLeft"?gl({x:y+J,y:T+C/2,textAnchor:oe,verticalAnchor:"middle"},Oe):f==="insideRight"?gl({x:y+o-J,y:T+C/2,textAnchor:te,verticalAnchor:"middle"},Oe):f==="insideTop"?gl({x:y+o/2,y:T+I,textAnchor:"middle",verticalAnchor:q},Oe):f==="insideBottom"?gl({x:y+o/2,y:T+C-I,textAnchor:"middle",verticalAnchor:j},Oe):f==="insideTopLeft"?gl({x:y+J,y:T+I,textAnchor:oe,verticalAnchor:q},Oe):f==="insideTopRight"?gl({x:y+o-J,y:T+I,textAnchor:te,verticalAnchor:q},Oe):f==="insideBottomLeft"?gl({x:y+J,y:T+C-I,textAnchor:oe,verticalAnchor:j},Oe):f==="insideBottomRight"?gl({x:y+o-J,y:T+C-I,textAnchor:te,verticalAnchor:j},Oe):f&&typeof f=="object"&&(Hi(f.x)||V_(f.x))&&(Hi(f.y)||V_(f.y))?gl({x:y+ff(f.x,o),y:T+ff(f.y,C),textAnchor:"end",verticalAnchor:"end"},Oe):gl({x:y+o/2,y:T+C/2,textAnchor:"middle",verticalAnchor:"middle"},Oe)},Jle=e=>"cx"in e&&Hi(e.cx);function vh(e){var{offset:t=5}=e,i=FN(e,Ule),s=gl({offset:t},i),{viewBox:f,position:y,value:T,children:o,content:C,className:M="",textBreakAll:I,labelRef:j}=s,q=IM(),K=f||q;if(!K||vl(T)&&vl(o)&&!me.isValidElement(C)&&typeof C!="function")return null;if(me.isValidElement(C)){var{labelRef:J}=s,te=FN(s,Vle);return me.cloneElement(C,te)}var oe;if(typeof C=="function"){if(oe=me.createElement(C,s),me.isValidElement(oe))return oe}else oe=Zle(s);var ce=Jle(K),de=gs(s,!0);if(ce&&(y==="insideStart"||y==="insideEnd"||y==="end"))return Xle(s,oe,de);var ue=ce?Yle(s):Kle(s,K);return me.createElement(IO,sm({ref:j,className:Ya("recharts-label",M)},de,ue,{breakAll:I}),oe)}vh.displayName="Label";var NV=e=>{var{cx:t,cy:i,angle:s,startAngle:f,endAngle:y,r:T,radius:o,innerRadius:C,outerRadius:M,x:I,y:j,top:q,left:K,width:J,height:te,clockWise:oe,labelViewBox:ce}=e;if(ce)return ce;if(Hi(J)&&Hi(te)){if(Hi(I)&&Hi(j))return{x:I,y:j,width:J,height:te};if(Hi(q)&&Hi(K))return{x:q,y:K,width:J,height:te}}if(Hi(I)&&Hi(j))return{x:I,y:j,width:0,height:0};if(Hi(t)&&Hi(i))return{cx:t,cy:i,startAngle:f||s||0,endAngle:y||s||0,innerRadius:C||0,outerRadius:M||o||T||0,clockWise:oe};if(e.viewBox)return e.viewBox},Qle=(e,t,i)=>{if(!e)return null;var s={viewBox:t,labelRef:i};return e===!0?me.createElement(vh,sm({key:"label-implicit"},s)):up(e)?me.createElement(vh,sm({key:"label-implicit",value:e},s)):me.isValidElement(e)?e.type===vh?me.cloneElement(e,gl({key:"label-implicit"},s)):me.createElement(vh,sm({key:"label-implicit",content:e},s)):DO(e)?me.createElement(vh,sm({key:"label-implicit",content:e},s)):e&&typeof e=="object"?me.createElement(vh,sm({},e,{key:"label-implicit"},s)):null},ece=function(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&s&&!t.label)return null;var{children:f,labelRef:y}=t,T=NV(t),o=cM(f,vh).map((M,I)=>me.cloneElement(M,{viewBox:i||T,key:"label-".concat(I)}));if(!s)return o;var C=Qle(t.label,i||T,y);return[C,...o]};vh.parseViewBox=NV;vh.renderCallByParent=ece;var xA={},bA={},VN;function tce(){return VN||(VN=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return i[i.length-1]}e.last=t}(bA)),bA}var wA={},$N;function nce(){return $N||($N=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return Array.isArray(i)?i:Array.from(i)}e.toArray=t}(wA)),wA}var qN;function ice(){return qN||(qN=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tce(),i=nce(),s=_M();function f(y){if(s.isArrayLike(y))return t.last(i.toArray(y))}e.last=f}(xA)),xA}var TA,HN;function rce(){return HN||(HN=1,TA=ice().last),TA}var oce=rce();const ace=Zu(oce);var sce=["valueAccessor"],lce=["data","dataKey","clockWise","id","textBreakAll"];function nT(){return nT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},nT.apply(null,arguments)}function GN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function ZN(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?GN(Object(i),!0).forEach(function(s){cce(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):GN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function cce(e,t,i){return(t=uce(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function uce(e){var t=hce(e,"string");return typeof t=="symbol"?t:t+""}function hce(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WN(e,t){if(e==null)return{};var i,s,f=dce(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function dce(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var fce=e=>Array.isArray(e.value)?ace(e.value):e.value;function ty(e){var{valueAccessor:t=fce}=e,i=WN(e,sce),{data:s,dataKey:f,clockWise:y,id:T,textBreakAll:o}=i,C=WN(i,lce);return!s||!s.length?null:me.createElement(hp,{className:"recharts-label-list"},s.map((M,I)=>{var j=vl(f)?t(M,I):wh(M&&M.payload,f),q=vl(T)?{}:{id:"".concat(T,"-").concat(I)};return me.createElement(vh,nT({},gs(M,!0),C,q,{parentViewBox:M.parentViewBox,value:j,textBreakAll:o,viewBox:vh.parseViewBox(vl(y)?M:ZN(ZN({},M),{},{clockWise:y})),key:"label-".concat(I),index:I}))}))}ty.displayName="LabelList";function pce(e,t){return e?e===!0?me.createElement(ty,{key:"labelList-implicit",data:t}):me.isValidElement(e)||DO(e)?me.createElement(ty,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?me.createElement(ty,nT({data:t},e,{key:"labelList-implicit"})):null:null}function mce(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&i&&!e.label)return null;var{children:s}=e,f=cM(s,ty).map((T,o)=>me.cloneElement(T,{data:t,key:"labelList-".concat(o)}));if(!i)return f;var y=pce(e.label,t);return[y,...f]}ty.renderCallByParent=mce;var gce={radiusAxis:{},angleAxis:{}},BV=Sd({name:"polarAxis",initialState:gce,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:zye,removeRadiusAxis:kye,addAngleAxis:Nye,removeAngleAxis:Bye}=BV.actions,_ce=BV.reducer,yce={countOfBars:0,cartesianItems:[],polarItems:[]},jV=Sd({name:"graphicalItems",initialState:yce,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},removeCartesianGraphicalItem(e,t){var i=Sg(e).cartesianItems.indexOf(t.payload);i>-1&&e.cartesianItems.splice(i,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var i=Sg(e).polarItems.indexOf(t.payload);i>-1&&e.polarItems.splice(i,1)}}}),{addBar:vce,removeBar:xce,addCartesianGraphicalItem:bce,removeCartesianGraphicalItem:wce,addPolarGraphicalItem:jye,removePolarGraphicalItem:Fye}=jV.actions,Tce=jV.reducer;function XN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function YN(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?XN(Object(i),!0).forEach(function(s){Sce(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):XN(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Sce(e,t,i){return(t=Ece(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ece(e){var t=Ace(e,"string");return typeof t=="symbol"?t:t+""}function Ace(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pce(e){var t=rl();return me.useEffect(()=>{var i=YN(YN({},e),{},{stackId:f4(e.stackId)});return t(bce(i)),()=>{t(wce(i))}},[t,e]),null}var SA={},KN;function Cce(){return KN||(KN=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){if(typeof i!="object"||i==null)return!1;if(Object.getPrototypeOf(i)===null)return!0;if(Object.prototype.toString.call(i)!=="[object Object]"){const f=i[Symbol.toStringTag];return f==null||!Object.getOwnPropertyDescriptor(i,Symbol.toStringTag)?.writable?!1:i.toString()===`[object ${f}]`}let s=i;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(i)===s}e.isPlainObject=t}(SA)),SA}var EA,JN;function Mce(){return JN||(JN=1,EA=Cce().isPlainObject),EA}var Oce=Mce();const Ice=Zu(Oce);function iT(){return iT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},iT.apply(null,arguments)}var QN=(e,t,i,s,f)=>{var y=i-s,T;return T="M ".concat(e,",").concat(t),T+="L ".concat(e+i,",").concat(t),T+="L ".concat(e+i-y/2,",").concat(t+f),T+="L ".concat(e+i-y/2-s,",").concat(t+f),T+="L ".concat(e,",").concat(t," Z"),T},Dce={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Rce=e=>{var t=zg(e,Dce),i=me.useRef(),[s,f]=me.useState(-1);me.useEffect(()=>{if(i.current&&i.current.getTotalLength)try{var oe=i.current.getTotalLength();oe&&f(oe)}catch{}},[]);var{x:y,y:T,upperWidth:o,lowerWidth:C,height:M,className:I}=t,{animationEasing:j,animationDuration:q,animationBegin:K,isUpdateAnimationActive:J}=t;if(y!==+y||T!==+T||o!==+o||C!==+C||M!==+M||o===0&&C===0||M===0)return null;var te=Ya("recharts-trapezoid",I);return J?me.createElement(Ov,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:M,x:y,y:T},to:{upperWidth:o,lowerWidth:C,height:M,x:y,y:T},duration:q,animationEasing:j,isActive:J},oe=>{var{upperWidth:ce,lowerWidth:de,height:ue,x:Pe,y:Oe}=oe;return me.createElement(Ov,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:K,duration:q,easing:j},me.createElement("path",iT({},gs(t,!0),{className:te,d:QN(Pe,Oe,ce,de,ue),ref:i})))}):me.createElement("g",null,me.createElement("path",iT({},gs(t,!0),{className:te,d:QN(y,T,o,C,M)})))},Lce=["option","shapeType","propTransformer","activeClassName","isActive"];function zce(e,t){if(e==null)return{};var i,s,f=kce(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function kce(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function eB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function rT(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?eB(Object(i),!0).forEach(function(s){Nce(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):eB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Nce(e,t,i){return(t=Bce(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bce(e){var t=jce(e,"string");return typeof t=="symbol"?t:t+""}function jce(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fce(e,t){return rT(rT({},t),e)}function Uce(e,t){return e==="symbols"}function tB(e){var{shapeType:t,elementProps:i}=e;switch(t){case"rectangle":return me.createElement(w4,i);case"trapezoid":return me.createElement(Rce,i);case"sector":return me.createElement(E4,i);case"symbols":if(Uce(t))return me.createElement(pM,i);break;default:return null}}function Vce(e){return me.isValidElement(e)?e.props:e}function $ce(e){var{option:t,shapeType:i,propTransformer:s=Fce,activeClassName:f="recharts-active-shape",isActive:y}=e,T=zce(e,Lce),o;if(me.isValidElement(t))o=me.cloneElement(t,rT(rT({},T),Vce(t)));else if(typeof t=="function")o=t(T);else if(Ice(t)&&typeof t!="boolean"){var C=s(t,T);o=me.createElement(tB,{shapeType:i,elementProps:C})}else{var M=T;o=me.createElement(tB,{shapeType:i,elementProps:M})}return y?me.createElement(hp,{className:f},o):o}var FV=(e,t)=>{var i=rl();return(s,f)=>y=>{e?.(s,f,y),i(hV({activeIndex:String(f),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}},UV=e=>{var t=rl();return(i,s)=>f=>{e?.(i,s,f),t($ae())}},VV=(e,t)=>{var i=rl();return(s,f)=>y=>{e?.(s,f,y),i(qae({activeIndex:String(f),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}};function qce(e){var{fn:t,args:i}=e,s=rl(),f=Wu();return me.useEffect(()=>{if(!f){var y=t(i);return s(Fae(y)),()=>{s(Uae(y))}}},[t,i,s,f]),null}var Hce=()=>{};function Gce(e){var{legendPayload:t}=e,i=rl(),s=Wu();return me.useEffect(()=>s?Hce:(i(mte(t)),()=>{i(gte(t))}),[i,s,t]),null}function Zce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",i=me.useRef(kx(t)),s=me.useRef(e);return s.current!==e&&(i.current=kx(t),s.current=e),i.current}var Wce=()=>{var e=rl();return me.useEffect(()=>(e(vce()),()=>{e(xce())})),null},Xce=["children"];function Yce(e,t){if(e==null)return{};var i,s,f=Kce(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function Kce(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var nB=()=>{},$V=me.createContext({addErrorBar:nB,removeErrorBar:nB}),Jce={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},qV=me.createContext(Jce);function Qce(e){var{children:t}=e,i=Yce(e,Xce);return me.createElement(qV.Provider,{value:i},t)}var eue=()=>me.useContext(qV),tue=e=>{var{children:t,xAxisId:i,yAxisId:s,zAxisId:f,dataKey:y,data:T,stackId:o,hide:C,type:M,barSize:I}=e,[j,q]=me.useState([]),K=me.useCallback(oe=>{q(ce=>[...ce,oe])},[q]),J=me.useCallback(oe=>{q(ce=>ce.filter(de=>de!==oe))},[q]),te=Wu();return me.createElement($V.Provider,{value:{addErrorBar:K,removeErrorBar:J}},me.createElement(Pce,{type:M,data:T,xAxisId:i,yAxisId:s,zAxisId:f,dataKey:y,errorBars:j,stackId:o,hide:C,barSize:I,isPanorama:te}),t)};function nue(e){var{addErrorBar:t,removeErrorBar:i}=me.useContext($V);return me.useEffect(()=>(t(e),()=>{i(e)}),[t,i,e]),null}var iue=e=>{var t=Wu();return gr(i=>Mg(i,"xAxis",e,t))},rue=e=>{var t=Wu();return gr(i=>Mg(i,"yAxis",e,t))},oue=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function HV(e,t,i){return(t=aue(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function aue(e){var t=sue(e,"string");return typeof t=="symbol"?t:t+""}function sue(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wx(){return Wx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Wx.apply(null,arguments)}function lue(e,t){if(e==null)return{};var i,s,f=cue(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function cue(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function uue(e){var{direction:t,width:i,dataKey:s,isAnimationActive:f,animationBegin:y,animationDuration:T,animationEasing:o}=e,C=lue(e,oue),M=gs(C,!1),{data:I,dataPointFormatter:j,xAxisId:q,yAxisId:K,errorBarOffset:J}=eue(),te=iue(q),oe=rue(K);if(te?.scale==null||oe?.scale==null||I==null||t==="x"&&te.type!=="number")return null;var ce=I.map(de=>{var{x:ue,y:Pe,value:Oe,errorVal:xe}=j(de,s,t);if(!xe)return null;var Qe=[],tt,Ge;if(Array.isArray(xe)?[tt,Ge]=xe:tt=Ge=xe,t==="x"){var{scale:Je}=te,Ve=Pe+J,xt=Ve+i,yt=Ve-i,ot=Je(Oe-tt),zt=Je(Oe+Ge);Qe.push({x1:zt,y1:xt,x2:zt,y2:yt}),Qe.push({x1:ot,y1:Ve,x2:zt,y2:Ve}),Qe.push({x1:ot,y1:xt,x2:ot,y2:yt})}else if(t==="y"){var{scale:rt}=oe,Bt=ue+J,Vt=Bt-i,Ln=Bt+i,$e=rt(Oe-tt),Pt=rt(Oe+Ge);Qe.push({x1:Vt,y1:Pt,x2:Ln,y2:Pt}),Qe.push({x1:Bt,y1:$e,x2:Bt,y2:Pt}),Qe.push({x1:Vt,y1:$e,x2:Ln,y2:$e})}var $t="".concat(ue+J,"px ").concat(Pe+J,"px");return me.createElement(hp,Wx({className:"recharts-errorBar",key:"bar-".concat(Qe.map(on=>"".concat(on.x1,"-").concat(on.x2,"-").concat(on.y1,"-").concat(on.y2)))},M),Qe.map(on=>{var An=f?{transformOrigin:"".concat(on.x1-5,"px")}:void 0;return me.createElement(Ov,{from:{transform:"scaleY(0)",transformOrigin:$t},to:{transform:"scaleY(1)",transformOrigin:$t},begin:y,easing:o,isActive:f,duration:T,key:"line-".concat(on.x1,"-").concat(on.x2,"-").concat(on.y1,"-").concat(on.y2),style:{transformOrigin:$t}},me.createElement("line",Wx({},on,{style:An})))}))});return me.createElement(hp,{className:"recharts-errorBars"},ce)}var GV=me.createContext(void 0);function hue(e){var t=me.useContext(GV);return e??t??"x"}function due(e){var{direction:t,children:i}=e;return me.createElement(GV.Provider,{value:t},i)}var ZV={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function fue(e){var t=hue(e.direction),{width:i,isAnimationActive:s,animationBegin:f,animationDuration:y,animationEasing:T}=zg(e,ZV);return me.createElement(me.Fragment,null,me.createElement(nue,{dataKey:e.dataKey,direction:t}),me.createElement(uue,Wx({},e,{direction:t,width:i,isAnimationActive:s,animationBegin:f,animationDuration:y,animationEasing:T})))}class WV extends me.Component{render(){return me.createElement(fue,this.props)}}HV(WV,"defaultProps",ZV);HV(WV,"displayName","ErrorBar");var pue="Invariant failed";function mue(e,t){throw new Error(pue)}var gue=["x","y"];function WP(){return WP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},WP.apply(null,arguments)}function iB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function dx(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?iB(Object(i),!0).forEach(function(s){_ue(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):iB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function _ue(e,t,i){return(t=yue(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yue(e){var t=vue(e,"string");return typeof t=="symbol"?t:t+""}function vue(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xue(e,t){if(e==null)return{};var i,s,f=bue(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function bue(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function wue(e,t){var{x:i,y:s}=e,f=xue(e,gue),y="".concat(i),T=parseInt(y,10),o="".concat(s),C=parseInt(o,10),M="".concat(t.height||f.height),I=parseInt(M,10),j="".concat(t.width||f.width),q=parseInt(j,10);return dx(dx(dx(dx(dx({},t),f),T?{x:T}:{}),C?{y:C}:{}),{},{height:I,width:q,name:t.name,radius:t.radius})}function XV(e){return me.createElement($ce,WP({shapeType:"rectangle",propTransformer:wue,activeClassName:"recharts-active-bar"},e))}var Tue=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,f)=>{if(Hi(t))return t;var y=Hi(s)||vl(s);return y?t(s,f):(y||mue(),i)}};function YV(e,t){var i,s,f=gr(M=>vm(M,e)),y=gr(M=>Bg(M,t)),T=(i=f?.allowDataOverflow)!==null&&i!==void 0?i:ph.allowDataOverflow,o=(s=y?.allowDataOverflow)!==null&&s!==void 0?s:mh.allowDataOverflow,C=T||o;return{needClip:C,needClipX:T,needClipY:o}}function Sue(e){var{xAxisId:t,yAxisId:i,clipPathId:s}=e,f=$T(),{needClipX:y,needClipY:T,needClip:o}=YV(t,i);if(!o)return null;var{left:C,top:M,width:I,height:j}=f;return me.createElement("clipPath",{id:"clipPath-".concat(s)},me.createElement("rect",{x:y?C:C-I/2,y:T?M:M-j/2,width:y?I:I*2,height:T?j:j*2}))}var Eue=["onMouseEnter","onMouseLeave","onClick"],Aue=["value","background","tooltipPosition"],Pue=["onMouseEnter","onClick","onMouseLeave"];function Xx(){return Xx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Xx.apply(null,arguments)}function rB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Oc(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?rB(Object(i),!0).forEach(function(s){l2(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):rB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function l2(e,t,i){return(t=Cue(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Cue(e){var t=Mue(e,"string");return typeof t=="symbol"?t:t+""}function Mue(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XP(e,t){if(e==null)return{};var i,s,f=Oue(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function Oue(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var Iue=e=>{var{dataKey:t,name:i,fill:s,legendType:f,hide:y}=e;return[{inactive:y,dataKey:t,type:f,color:s,value:p4(i,t),payload:e}]};function Due(e){var{dataKey:t,stroke:i,strokeWidth:s,fill:f,name:y,hide:T,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:i,strokeWidth:s,fill:f,dataKey:t,nameKey:void 0,name:p4(y,t),hide:T,type:e.tooltipType,color:e.fill,unit:o}}}function Rue(e){var t=gr(Gx),{data:i,dataKey:s,background:f,allOtherBarProps:y}=e,{onMouseEnter:T,onMouseLeave:o,onClick:C}=y,M=XP(y,Eue),I=FV(T,s),j=UV(o),q=VV(C,s);if(!f||i==null)return null;var K=gs(f,!1);return me.createElement(me.Fragment,null,i.map((J,te)=>{var{value:oe,background:ce,tooltipPosition:de}=J,ue=XP(J,Aue);if(!ce)return null;var Pe=I(J,te),Oe=j(J,te),xe=q(J,te),Qe=Oc(Oc(Oc(Oc(Oc({option:f,isActive:String(te)===t},ue),{},{fill:"#eee"},ce),K),MT(M,J,te)),{},{onMouseEnter:Pe,onMouseLeave:Oe,onClick:xe,dataKey:s,index:te,className:"recharts-bar-background-rectangle"});return me.createElement(XV,Xx({key:"background-bar-".concat(te)},Qe))}))}function KV(e){var{data:t,props:i,showLabels:s}=e,f=gs(i,!1),{shape:y,dataKey:T,activeBar:o}=i,C=gr(Gx),M=gr(TV),{onMouseEnter:I,onClick:j,onMouseLeave:q}=i,K=XP(i,Pue),J=FV(I,T),te=UV(q),oe=VV(j,T);return t?me.createElement(me.Fragment,null,t.map((ce,de)=>{var ue=o&&String(de)===C&&(M==null||T===M),Pe=ue?o:y,Oe=Oc(Oc(Oc({},f),ce),{},{isActive:ue,option:Pe,index:de,dataKey:T});return me.createElement(hp,Xx({className:"recharts-bar-rectangle"},MT(K,ce,de),{onMouseEnter:J(ce,de),onMouseLeave:te(ce,de),onClick:oe(ce,de),key:"rectangle-".concat(ce?.x,"-").concat(ce?.y,"-").concat(ce?.value,"-").concat(de)}),me.createElement(XV,Oe))}),s&&ty.renderCallByParent(i,t)):null}function Lue(e){var{props:t,previousRectanglesRef:i}=e,{data:s,layout:f,isAnimationActive:y,animationBegin:T,animationDuration:o,animationEasing:C,onAnimationEnd:M,onAnimationStart:I}=t,j=i.current,q=Zce(t,"recharts-bar-"),[K,J]=me.useState(!1),te=me.useCallback(()=>{typeof M=="function"&&M(),J(!1)},[M]),oe=me.useCallback(()=>{typeof I=="function"&&I(),J(!0)},[I]);return me.createElement(Ov,{begin:T,duration:o,isActive:y,easing:C,from:{t:0},to:{t:1},onAnimationEnd:te,onAnimationStart:oe,key:q},ce=>{var{t:de}=ce,ue=de===1?s:s.map((Pe,Oe)=>{var xe=j&&j[Oe];if(xe){var Qe=cv(xe.x,Pe.x),tt=cv(xe.y,Pe.y),Ge=cv(xe.width,Pe.width),Je=cv(xe.height,Pe.height);return Oc(Oc({},Pe),{},{x:Qe(de),y:tt(de),width:Ge(de),height:Je(de)})}if(f==="horizontal"){var Ve=cv(0,Pe.height),xt=Ve(de);return Oc(Oc({},Pe),{},{y:Pe.y+Pe.height-xt,height:xt})}var yt=cv(0,Pe.width),ot=yt(de);return Oc(Oc({},Pe),{},{width:ot})});return de>0&&(i.current=ue),me.createElement(hp,null,me.createElement(KV,{props:t,data:ue,showLabels:!K}))})}function zue(e){var{data:t,isAnimationActive:i}=e,s=me.useRef(null);return i&&t&&t.length&&(s.current==null||s.current!==t)?me.createElement(Lue,{previousRectanglesRef:s,props:e}):me.createElement(KV,{props:e,data:t,showLabels:!0})}var JV=0,kue=(e,t)=>{var i=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:i,errorVal:wh(e,t)}};class Nue extends me.PureComponent{constructor(){super(...arguments),l2(this,"id",kx("recharts-bar-"))}render(){var{hide:t,data:i,dataKey:s,className:f,xAxisId:y,yAxisId:T,needClip:o,background:C,id:M,layout:I}=this.props;if(t)return null;var j=Ya("recharts-bar",f),q=vl(M)?this.id:M;return me.createElement(hp,{className:j},o&&me.createElement("defs",null,me.createElement(Sue,{clipPathId:q,xAxisId:y,yAxisId:T})),me.createElement(hp,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(q,")"):null},me.createElement(Rue,{data:i,dataKey:s,background:C,allOtherBarProps:this.props}),me.createElement(zue,this.props)),me.createElement(due,{direction:I==="horizontal"?"y":"x"},this.props.children))}}var QV={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!sb.isSsr,legendType:"rect",minPointSize:JV,xAxisId:0,yAxisId:0};function Bue(e){var{xAxisId:t,yAxisId:i,hide:s,legendType:f,minPointSize:y,activeBar:T,animationBegin:o,animationDuration:C,animationEasing:M,isAnimationActive:I}=zg(e,QV),{needClip:j}=YV(t,i),q=LM(),K=Wu(),J=me.useMemo(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:y,stackId:f4(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,y,e.stackId]),te=cM(e.children,DV),oe=gr(ue=>dhe(ue,t,i,K,J,te));if(q!=="vertical"&&q!=="horizontal")return null;var ce,de=oe?.[0];return de==null||de.height==null||de.width==null?ce=0:ce=q==="vertical"?de.height/2:de.width/2,me.createElement(Qce,{xAxisId:t,yAxisId:i,data:oe,dataPointFormatter:kue,errorBarOffset:ce},me.createElement(Nue,Xx({},e,{layout:q,needClip:j,data:oe,xAxisId:t,yAxisId:i,hide:s,legendType:f,minPointSize:y,activeBar:T,animationBegin:o,animationDuration:C,animationEasing:M,isAnimationActive:I})))}function jue(e){var{layout:t,barSettings:{dataKey:i,minPointSize:s},pos:f,bandSize:y,xAxis:T,yAxis:o,xAxisTicks:C,yAxisTicks:M,stackedData:I,displayedData:j,offset:q,cells:K}=e,J=t==="horizontal"?o:T,te=I?J.scale.domain():null,oe=Wee({numericAxis:J});return j.map((ce,de)=>{var ue,Pe,Oe,xe,Qe,tt;I?ue=$ee(I[de],te):(ue=wh(ce,i),Array.isArray(ue)||(ue=[oe,ue]));var Ge=Tue(s,JV)(ue[1],de);if(t==="horizontal"){var Je,[Ve,xt]=[o.scale(ue[0]),o.scale(ue[1])];Pe=Zk({axis:T,ticks:C,bandSize:y,offset:f.offset,entry:ce,index:de}),Oe=(Je=xt??Ve)!==null&&Je!==void 0?Je:void 0,xe=f.size;var yt=Ve-xt;if(Qe=Th(yt)?0:yt,tt={x:Pe,y:q.top,width:xe,height:q.height},Math.abs(Ge)>0&&Math.abs(Qe)<Math.abs(Ge)){var ot=Vu(Qe||Ge)*(Math.abs(Ge)-Math.abs(Qe));Oe-=ot,Qe+=ot}}else{var[zt,rt]=[T.scale(ue[0]),T.scale(ue[1])];if(Pe=zt,Oe=Zk({axis:o,ticks:M,bandSize:y,offset:f.offset,entry:ce,index:de}),xe=rt-zt,Qe=f.size,tt={x:q.left,y:Oe,width:q.width,height:Qe},Math.abs(Ge)>0&&Math.abs(xe)<Math.abs(Ge)){var Bt=Vu(xe||Ge)*(Math.abs(Ge)-Math.abs(xe));xe+=Bt}}return Oc(Oc({},ce),{},{x:Pe,y:Oe,width:xe,height:Qe,value:I?ue:ue[1],payload:ce,background:tt,tooltipPosition:{x:Pe+xe/2,y:Oe+Qe/2}},K&&K[de]&&K[de].props)})}class oT extends me.PureComponent{render(){return me.createElement(tue,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},me.createElement(Wce,null),me.createElement(Gce,{legendPayload:Iue(this.props)}),me.createElement(qce,{fn:Due,args:this.props}),me.createElement(Bue,this.props))}}l2(oT,"displayName","Bar");l2(oT,"defaultProps",QV);function oB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function e1(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?oB(Object(i),!0).forEach(function(s){Fue(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Fue(e,t,i){return(t=Uue(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Uue(e){var t=Vue(e,"string");return typeof t=="symbol"?t:t+""}function Vue(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ue=(e,t)=>t,que=(e,t,i)=>i,Hue=(e,t,i,s)=>s,RO=(e,t,i,s,f)=>f,Gue=(e,t,i,s,f)=>f.maxBarSize,Zue=(e,t,i,s,f,y)=>y,aB=(e,t,i)=>{var s=i??e;if(!vl(s))return ff(s,t,0)},Wue=Fn([Ba,mO,$ue,que,Hue],(e,t,i,s,f)=>t.filter(y=>e==="horizontal"?y.xAxisId===i:y.yAxisId===s).filter(y=>y.isPanorama===f).filter(y=>y.hide===!1).filter(y=>y.type==="bar")),Xue=(e,t,i,s)=>{var f=Ba(e);return f==="horizontal"?UP(e,"yAxis",i,s):UP(e,"xAxis",t,s)},Yue=(e,t,i)=>{var s=Ba(e);return s==="horizontal"?dN(e,"xAxis",t):dN(e,"yAxis",i)};function Kue(e){return e.stackId!=null&&e.dataKey!=null}var Jue=(e,t,i)=>{var s={},f=e.filter(Kue),y=e.filter(M=>M.stackId==null),T=f.reduce((M,I)=>(M[I.stackId]||(M[I.stackId]=[]),M[I.stackId].push(I),M),s),o=Object.entries(T).map(M=>{var[I,j]=M,q=j.map(J=>J.dataKey),K=aB(t,i,j[0].barSize);return{stackId:I,dataKeys:q,barSize:K}}),C=y.map(M=>{var I=[M.dataKey].filter(q=>q!=null),j=aB(t,i,M.barSize);return{stackId:void 0,dataKeys:I,barSize:j}});return[...o,...C]},Que=Fn([Wue,Boe,Yue],Jue),ehe=(e,t,i,s,f)=>{var y,T,o=Ba(e),C=wU(e),{maxBarSize:M}=f,I=vl(M)?C:M,j,q;return o==="horizontal"?(j=Mg(e,"xAxis",t,s),q=zv(e,"xAxis",t,s)):(j=Mg(e,"yAxis",i,s),q=zv(e,"yAxis",i,s)),(y=(T=CM(j,q,!0))!==null&&T!==void 0?T:I)!==null&&y!==void 0?y:0},e6=(e,t,i,s)=>{var f=Ba(e),y,T;return f==="horizontal"?(y=Mg(e,"xAxis",t,s),T=zv(e,"xAxis",t,s)):(y=Mg(e,"yAxis",i,s),T=zv(e,"yAxis",i,s)),CM(y,T)};function the(e,t,i,s,f){var y=s.length;if(!(y<1)){var T=ff(e,i,0,!0),o,C=[];if(Ah(s[0].barSize)){var M=!1,I=i/y,j=s.reduce((ce,de)=>ce+(de.barSize||0),0);j+=(y-1)*T,j>=i&&(j-=(y-1)*T,T=0),j>=i&&I>0&&(M=!0,I*=.9,j=y*I);var q=(i-j)/2>>0,K={offset:q-T,size:0};o=s.reduce((ce,de)=>{var ue,Pe={stackId:de.stackId,dataKeys:de.dataKeys,position:{offset:K.offset+K.size+T,size:M?I:(ue=de.barSize)!==null&&ue!==void 0?ue:0}},Oe=[...ce,Pe];return K=Oe[Oe.length-1].position,Oe},C)}else{var J=ff(t,i,0,!0);i-2*J-(y-1)*T<=0&&(T=0);var te=(i-2*J-(y-1)*T)/y;te>1&&(te>>=0);var oe=Ah(f)?Math.min(te,f):te;o=s.reduce((ce,de,ue)=>[...ce,{stackId:de.stackId,dataKeys:de.dataKeys,position:{offset:J+(te+T)*ue+(te-oe)/2,size:oe}}],C)}return o}}var nhe=(e,t,i,s,f,y,T)=>{var o=vl(T)?t:T,C=the(i,s,f!==y?f:y,e,o);return f!==y&&C!=null&&(C=C.map(M=>e1(e1({},M),{},{position:e1(e1({},M.position),{},{offset:M.position.offset-f/2})}))),C},ihe=Fn([Que,wU,Noe,TU,ehe,e6,Gue],nhe),rhe=(e,t,i,s)=>Mg(e,"xAxis",t,s),ohe=(e,t,i,s)=>Mg(e,"yAxis",i,s),ahe=(e,t,i,s)=>zv(e,"xAxis",t,s),she=(e,t,i,s)=>zv(e,"yAxis",i,s),lhe=Fn([ihe,RO],(e,t)=>{if(e!=null){var i=e.find(s=>s.stackId===t.stackId&&s.dataKeys.includes(t.dataKey));if(i!=null)return i.position}}),che=(e,t)=>{if(!(!e||t?.dataKey==null)){var{stackId:i}=t;if(i!=null){var s=e[i];if(s){var{stackedData:f}=s;if(f){var y=f.find(T=>T.key===t.dataKey);return y}}}}},uhe=Fn([mO,RO],(e,t)=>{if(e.some(i=>i.type==="bar"&&t.dataKey===i.dataKey&&t.stackId===i.stackId&&t.stackId===i.stackId))return t}),hhe=Fn([Xue,RO],che),dhe=Fn([nc,rhe,ohe,ahe,she,lhe,Ba,sU,e6,hhe,uhe,Zue],(e,t,i,s,f,y,T,o,C,M,I,j)=>{var{chartData:q,dataStartIndex:K,dataEndIndex:J}=o;if(!(I==null||y==null||T!=="horizontal"&&T!=="vertical"||t==null||i==null||s==null||f==null||C==null)){var{data:te}=I,oe;if(te!=null&&te.length>0?oe=te:oe=q?.slice(K,J+1),oe!=null)return jue({layout:T,barSettings:I,pos:y,bandSize:C,xAxis:t,yAxis:i,xAxisTicks:s,yAxisTicks:f,stackedData:M,displayedData:oe,offset:e,cells:j})}}),fhe=e=>{var{chartData:t}=e,i=rl(),s=Wu();return me.useEffect(()=>s?()=>{}:(i(wN(t)),()=>{i(wN(void 0))}),[t,i,s]),null},sB={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},t6=Sd({name:"brush",initialState:sB,reducers:{setBrushSettings(e,t){return t.payload==null?sB:t.payload}}}),{setBrushSettings:Uye}=t6.actions,phe=t6.reducer;function mhe(e,t,i){return(t=ghe(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ghe(e){var t=_he(e,"string");return typeof t=="symbol"?t:t+""}function _he(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class LO{static create(t){return new LO(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:i,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+f}case"end":{var y=this.bandwidth?this.bandwidth():0;return this.scale(t)+y}default:return this.scale(t)}if(i){var T=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+T}return this.scale(t)}}isInRange(t){var i=this.range(),s=i[0],f=i[i.length-1];return s<=f?t>=s&&t<=f:t>=f&&t<=s}}mhe(LO,"EPS",1e-4);function yhe(e){return(e%180+180)%180}var vhe=function(t){var{width:i,height:s}=t,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=yhe(f),T=y*Math.PI/180,o=Math.atan(s/i),C=T>o&&T<Math.PI-o?s/Math.sin(T):i/Math.cos(T);return Math.abs(C)},xhe={dots:[],areas:[],lines:[]},n6=Sd({name:"referenceElements",initialState:xhe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var i=Sg(e).dots.findIndex(s=>s===t.payload);i!==-1&&e.dots.splice(i,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var i=Sg(e).areas.findIndex(s=>s===t.payload);i!==-1&&e.areas.splice(i,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var i=Sg(e).lines.findIndex(s=>s===t.payload);i!==-1&&e.lines.splice(i,1)}}}),{addDot:Vye,removeDot:$ye,addArea:qye,removeArea:Hye,addLine:Gye,removeLine:Zye}=n6.actions,bhe=n6.reducer,whe=me.createContext(void 0),The=e=>{var{children:t}=e,[i]=me.useState("".concat(kx("recharts"),"-clip")),s=$T();if(s==null)return null;var{left:f,top:y,height:T,width:o}=s;return me.createElement(whe.Provider,{value:i},me.createElement("defs",null,me.createElement("clipPath",{id:i},me.createElement("rect",{x:f,y,height:T,width:o}))),t)};function AA(e,t){for(var i in e)if({}.hasOwnProperty.call(e,i)&&(!{}.hasOwnProperty.call(t,i)||e[i]!==t[i]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function i6(e,t,i){if(t<1)return[];if(t===1&&i===void 0)return e;for(var s=[],f=0;f<e.length;f+=t)s.push(e[f]);return s}function She(e,t,i){var s={width:e.width+t.width,height:e.height+t.height};return vhe(s,i)}function Ehe(e,t,i){var s=i==="width",{x:f,y,width:T,height:o}=e;return t===1?{start:s?f:y,end:s?f+T:y+o}:{start:s?f+T:y+o,end:s?f:y}}function aT(e,t,i,s,f){if(e*t<e*s||e*t>e*f)return!1;var y=i();return e*(t-e*y/2-s)>=0&&e*(t+e*y/2-f)<=0}function Ahe(e,t){return i6(e,t+1)}function Phe(e,t,i,s,f){for(var y=(s||[]).slice(),{start:T,end:o}=t,C=0,M=1,I=T,j=function(){var J=s?.[C];if(J===void 0)return{v:i6(s,M)};var te=C,oe,ce=()=>(oe===void 0&&(oe=i(J,te)),oe),de=J.coordinate,ue=C===0||aT(e,de,ce,I,o);ue||(C=0,I=T,M+=1),ue&&(I=de+e*(ce()/2+f),C+=M)},q;M<=y.length;)if(q=j(),q)return q.v;return[]}function lB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Mc(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?lB(Object(i),!0).forEach(function(s){Che(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):lB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Che(e,t,i){return(t=Mhe(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Mhe(e){var t=Ohe(e,"string");return typeof t=="symbol"?t:t+""}function Ohe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ihe(e,t,i,s,f){for(var y=(s||[]).slice(),T=y.length,{start:o}=t,{end:C}=t,M=function(q){var K=y[q],J,te=()=>(J===void 0&&(J=i(K,q)),J);if(q===T-1){var oe=e*(K.coordinate+e*te()/2-C);y[q]=K=Mc(Mc({},K),{},{tickCoord:oe>0?K.coordinate-oe*e:K.coordinate})}else y[q]=K=Mc(Mc({},K),{},{tickCoord:K.coordinate});var ce=aT(e,K.tickCoord,te,o,C);ce&&(C=K.tickCoord-e*(te()/2+f),y[q]=Mc(Mc({},K),{},{isShow:!0}))},I=T-1;I>=0;I--)M(I);return y}function Dhe(e,t,i,s,f,y){var T=(s||[]).slice(),o=T.length,{start:C,end:M}=t;if(y){var I=s[o-1],j=i(I,o-1),q=e*(I.coordinate+e*j/2-M);T[o-1]=I=Mc(Mc({},I),{},{tickCoord:q>0?I.coordinate-q*e:I.coordinate});var K=aT(e,I.tickCoord,()=>j,C,M);K&&(M=I.tickCoord-e*(j/2+f),T[o-1]=Mc(Mc({},I),{},{isShow:!0}))}for(var J=y?o-1:o,te=function(de){var ue=T[de],Pe,Oe=()=>(Pe===void 0&&(Pe=i(ue,de)),Pe);if(de===0){var xe=e*(ue.coordinate-e*Oe()/2-C);T[de]=ue=Mc(Mc({},ue),{},{tickCoord:xe<0?ue.coordinate-xe*e:ue.coordinate})}else T[de]=ue=Mc(Mc({},ue),{},{tickCoord:ue.coordinate});var Qe=aT(e,ue.tickCoord,Oe,C,M);Qe&&(C=ue.tickCoord+e*(Oe()/2+f),T[de]=Mc(Mc({},ue),{},{isShow:!0}))},oe=0;oe<J;oe++)te(oe);return T}function zO(e,t,i){var{tick:s,ticks:f,viewBox:y,minTickGap:T,orientation:o,interval:C,tickFormatter:M,unit:I,angle:j}=e;if(!f||!f.length||!s)return[];if(Hi(C)||sb.isSsr){var q;return(q=Ahe(f,Hi(C)?C:0))!==null&&q!==void 0?q:[]}var K=[],J=o==="top"||o==="bottom"?"width":"height",te=I&&J==="width"?Ax(I,{fontSize:t,letterSpacing:i}):{width:0,height:0},oe=(ue,Pe)=>{var Oe=typeof M=="function"?M(ue.value,Pe):ue.value;return J==="width"?She(Ax(Oe,{fontSize:t,letterSpacing:i}),te,j):Ax(Oe,{fontSize:t,letterSpacing:i})[J]},ce=f.length>=2?Vu(f[1].coordinate-f[0].coordinate):1,de=Ehe(y,ce,J);return C==="equidistantPreserveStart"?Phe(ce,de,oe,f,T):(C==="preserveStart"||C==="preserveStartEnd"?K=Dhe(ce,de,oe,f,T,C==="preserveStartEnd"):K=Ihe(ce,de,oe,f,T),K.filter(ue=>ue.isShow))}var Rhe=["viewBox"],Lhe=["viewBox"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},vv.apply(null,arguments)}function cB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Il(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?cB(Object(i),!0).forEach(function(s){kO(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):cB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function uB(e,t){if(e==null)return{};var i,s,f=zhe(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function zhe(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function kO(e,t,i){return(t=khe(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function khe(e){var t=Nhe(e,"string");return typeof t=="symbol"?t:t+""}function Nhe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class jg extends me.Component{constructor(t){super(t),this.tickRefs=me.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,i){var{viewBox:s}=t,f=uB(t,Rhe),y=this.props,{viewBox:T}=y,o=uB(y,Lhe);return!AA(s,T)||!AA(f,o)||!AA(i,this.state)}getTickLineCoord(t){var{x:i,y:s,width:f,height:y,orientation:T,tickSize:o,mirror:C,tickMargin:M}=this.props,I,j,q,K,J,te,oe=C?-1:1,ce=t.tickSize||o,de=Hi(t.tickCoord)?t.tickCoord:t.coordinate;switch(T){case"top":I=j=t.coordinate,K=s+ +!C*y,q=K-oe*ce,te=q-oe*M,J=de;break;case"left":q=K=t.coordinate,j=i+ +!C*f,I=j-oe*ce,J=I-oe*M,te=de;break;case"right":q=K=t.coordinate,j=i+ +C*f,I=j+oe*ce,J=I+oe*M,te=de;break;default:I=j=t.coordinate,K=s+ +C*y,q=K+oe*ce,te=q+oe*M,J=de;break}return{line:{x1:I,y1:q,x2:j,y2:K},tick:{x:J,y:te}}}getTickTextAnchor(){var{orientation:t,mirror:i}=this.props,s;switch(t){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}getTickVerticalAnchor(){var{orientation:t,mirror:i}=this.props;switch(t){case"left":case"right":return"middle";case"top":return i?"start":"end";default:return i?"end":"start"}}renderAxisLine(){var{x:t,y:i,width:s,height:f,orientation:y,mirror:T,axisLine:o}=this.props,C=Il(Il(Il({},gs(this.props,!1)),gs(o,!1)),{},{fill:"none"});if(y==="top"||y==="bottom"){var M=+(y==="top"&&!T||y==="bottom"&&T);C=Il(Il({},C),{},{x1:t,y1:i+M*f,x2:t+s,y2:i+M*f})}else{var I=+(y==="left"&&!T||y==="right"&&T);C=Il(Il({},C),{},{x1:t+I*s,y1:i,x2:t+I*s,y2:i+f})}return me.createElement("line",vv({},C,{className:Ya("recharts-cartesian-axis-line",ry(o,"className"))}))}static renderTickItem(t,i,s){var f,y=Ya(i.className,"recharts-cartesian-axis-tick-value");if(me.isValidElement(t))f=me.cloneElement(t,Il(Il({},i),{},{className:y}));else if(typeof t=="function")f=t(Il(Il({},i),{},{className:y}));else{var T="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(T=Ya(T,t.className)),f=me.createElement(IO,vv({},i,{className:T}),s)}return f}renderTicks(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:f,stroke:y,tick:T,tickFormatter:o,unit:C}=this.props,M=zO(Il(Il({},this.props),{},{ticks:s}),t,i),I=this.getTickTextAnchor(),j=this.getTickVerticalAnchor(),q=gs(this.props,!1),K=gs(T,!1),J=Il(Il({},q),{},{fill:"none"},gs(f,!1)),te=M.map((oe,ce)=>{var{line:de,tick:ue}=this.getTickLineCoord(oe),Pe=Il(Il(Il(Il({textAnchor:I,verticalAnchor:j},q),{},{stroke:"none",fill:y},K),ue),{},{index:ce,payload:oe,visibleTicksCount:M.length,tickFormatter:o});return me.createElement(hp,vv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(oe.value,"-").concat(oe.coordinate,"-").concat(oe.tickCoord)},MT(this.props,oe,ce)),f&&me.createElement("line",vv({},J,de,{className:Ya("recharts-cartesian-axis-tick-line",ry(f,"className"))})),T&&jg.renderTickItem(T,Pe,"".concat(typeof o=="function"?o(oe.value,ce):oe.value).concat(C||"")))});return te.length>0?me.createElement("g",{className:"recharts-cartesian-axis-ticks"},te):null}render(){var{axisLine:t,width:i,height:s,className:f,hide:y}=this.props;if(y)return null;var{ticks:T}=this.props;return i!=null&&i<=0||s!=null&&s<=0?null:me.createElement(hp,{className:Ya("recharts-cartesian-axis",f),ref:o=>{if(o){var C=o.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(C);var M=C[0];if(M){var I=window.getComputedStyle(M).fontSize,j=window.getComputedStyle(M).letterSpacing;(I!==this.state.fontSize||j!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(M).fontSize,letterSpacing:window.getComputedStyle(M).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,T),vh.renderCallByParent(this.props))}}kO(jg,"displayName","CartesianAxis");kO(jg,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Bhe=["x1","y1","x2","y2","key"],jhe=["offset"],Fhe=["xAxisId","yAxisId"],Uhe=["xAxisId","yAxisId"];function hB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function Ic(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?hB(Object(i),!0).forEach(function(s){Vhe(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Vhe(e,t,i){return(t=$he(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $he(e){var t=qhe(e,"string");return typeof t=="symbol"?t:t+""}function qhe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G_(){return G_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},G_.apply(null,arguments)}function sT(e,t){if(e==null)return{};var i,s,f=Hhe(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function Hhe(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var Ghe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:i,x:s,y:f,width:y,height:T,ry:o}=e;return me.createElement("rect",{x:s,y:f,ry:o,width:y,height:T,stroke:"none",fill:t,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function r6(e,t){var i;if(me.isValidElement(e))i=me.cloneElement(e,t);else if(typeof e=="function")i=e(t);else{var{x1:s,y1:f,x2:y,y2:T,key:o}=t,C=sT(t,Bhe),M=gs(C,!1),{offset:I}=M,j=sT(M,jhe);i=me.createElement("line",G_({},j,{x1:s,y1:f,x2:y,y2:T,fill:"none",key:o}))}return i}function Zhe(e){var{x:t,width:i,horizontal:s=!0,horizontalPoints:f}=e;if(!s||!f||!f.length)return null;var{xAxisId:y,yAxisId:T}=e,o=sT(e,Fhe),C=f.map((M,I)=>{var j=Ic(Ic({},o),{},{x1:t,y1:M,x2:t+i,y2:M,key:"line-".concat(I),index:I});return r6(s,j)});return me.createElement("g",{className:"recharts-cartesian-grid-horizontal"},C)}function Whe(e){var{y:t,height:i,vertical:s=!0,verticalPoints:f}=e;if(!s||!f||!f.length)return null;var{xAxisId:y,yAxisId:T}=e,o=sT(e,Uhe),C=f.map((M,I)=>{var j=Ic(Ic({},o),{},{x1:M,y1:t,x2:M,y2:t+i,key:"line-".concat(I),index:I});return r6(s,j)});return me.createElement("g",{className:"recharts-cartesian-grid-vertical"},C)}function Xhe(e){var{horizontalFill:t,fillOpacity:i,x:s,y:f,width:y,height:T,horizontalPoints:o,horizontal:C=!0}=e;if(!C||!t||!t.length)return null;var M=o.map(j=>Math.round(j+f-f)).sort((j,q)=>j-q);f!==M[0]&&M.unshift(0);var I=M.map((j,q)=>{var K=!M[q+1],J=K?f+T-j:M[q+1]-j;if(J<=0)return null;var te=q%t.length;return me.createElement("rect",{key:"react-".concat(q),y:j,x:s,height:J,width:y,stroke:"none",fill:t[te],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},I)}function Yhe(e){var{vertical:t=!0,verticalFill:i,fillOpacity:s,x:f,y,width:T,height:o,verticalPoints:C}=e;if(!t||!i||!i.length)return null;var M=C.map(j=>Math.round(j+f-f)).sort((j,q)=>j-q);f!==M[0]&&M.unshift(0);var I=M.map((j,q)=>{var K=!M[q+1],J=K?f+T-j:M[q+1]-j;if(J<=0)return null;var te=q%i.length;return me.createElement("rect",{key:"react-".concat(q),x:j,y,width:J,height:o,stroke:"none",fill:i[te],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},I)}var Khe=(e,t)=>{var{xAxis:i,width:s,height:f,offset:y}=e;return h4(zO(Ic(Ic(Ic({},jg.defaultProps),i),{},{ticks:d4(i),viewBox:{x:0,y:0,width:s,height:f}})),y.left,y.left+y.width,t)},Jhe=(e,t)=>{var{yAxis:i,width:s,height:f,offset:y}=e;return h4(zO(Ic(Ic(Ic({},jg.defaultProps),i),{},{ticks:d4(i),viewBox:{x:0,y:0,width:s,height:f}})),y.top,y.top+y.height,t)},Qhe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function YP(e){var t=DM(),i=RM(),s=$T(),f=Ic(Ic({},zg(e,Qhe)),{},{x:Hi(e.x)?e.x:s.left,y:Hi(e.y)?e.y:s.top,width:Hi(e.width)?e.width:s.width,height:Hi(e.height)?e.height:s.height}),{xAxisId:y,yAxisId:T,x:o,y:C,width:M,height:I,syncWithTicks:j,horizontalValues:q,verticalValues:K}=f,J=Wu(),te=gr(Ge=>fN(Ge,"xAxis",y,J)),oe=gr(Ge=>fN(Ge,"yAxis",T,J));if(!Hi(M)||M<=0||!Hi(I)||I<=0||!Hi(o)||o!==+o||!Hi(C)||C!==+C)return null;var ce=f.verticalCoordinatesGenerator||Khe,de=f.horizontalCoordinatesGenerator||Jhe,{horizontalPoints:ue,verticalPoints:Pe}=f;if((!ue||!ue.length)&&typeof de=="function"){var Oe=q&&q.length,xe=de({yAxis:oe?Ic(Ic({},oe),{},{ticks:Oe?q:oe.ticks}):void 0,width:t,height:i,offset:s},Oe?!0:j);Ex(Array.isArray(xe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof xe,"]")),Array.isArray(xe)&&(ue=xe)}if((!Pe||!Pe.length)&&typeof ce=="function"){var Qe=K&&K.length,tt=ce({xAxis:te?Ic(Ic({},te),{},{ticks:Qe?K:te.ticks}):void 0,width:t,height:i,offset:s},Qe?!0:j);Ex(Array.isArray(tt),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof tt,"]")),Array.isArray(tt)&&(Pe=tt)}return me.createElement("g",{className:"recharts-cartesian-grid"},me.createElement(Ghe,{fill:f.fill,fillOpacity:f.fillOpacity,x:f.x,y:f.y,width:f.width,height:f.height,ry:f.ry}),me.createElement(Xhe,G_({},f,{horizontalPoints:ue})),me.createElement(Yhe,G_({},f,{verticalPoints:Pe})),me.createElement(Zhe,G_({},f,{offset:s,horizontalPoints:ue,xAxis:te,yAxis:oe})),me.createElement(Whe,G_({},f,{offset:s,verticalPoints:Pe,xAxis:te,yAxis:oe})))}YP.displayName="CartesianGrid";function dB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function fB(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?dB(Object(i),!0).forEach(function(s){ede(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):dB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function ede(e,t,i){return(t=tde(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function tde(e){var t=nde(e,"string");return typeof t=="symbol"?t:t+""}function nde(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ide={xAxis:{},yAxis:{},zAxis:{}},o6=Sd({name:"cartesianAxis",initialState:ide,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:i,width:s}=t.payload;e.yAxis[i]&&(e.yAxis[i]=fB(fB({},e.yAxis[i]),{},{width:s}))}}}),{addXAxis:rde,removeXAxis:ode,addYAxis:ade,removeYAxis:sde,addZAxis:Wye,removeZAxis:Xye,updateYAxisWidth:lde}=o6.actions,cde=o6.reducer,ude=["children"],hde=["dangerouslySetInnerHTML","ticks"];function a6(e,t,i){return(t=dde(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function dde(e){var t=fde(e,"string");return typeof t=="symbol"?t:t+""}function fde(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KP(){return KP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},KP.apply(null,arguments)}function s6(e,t){if(e==null)return{};var i,s,f=pde(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function pde(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function mde(e){var t=rl(),i=me.useMemo(()=>{var{children:y}=e,T=s6(e,ude);return T},[e]),s=gr(y=>vm(y,i.id)),f=i===s;return me.useEffect(()=>(t(rde(i)),()=>{t(ode(i))}),[i,t]),f?e.children:null}var gde=e=>{var{xAxisId:t,className:i}=e,s=gr(g4),f=Wu(),y="xAxis",T=gr(K=>Wv(K,y,t,f)),o=gr(K=>oV(K,y,t,f)),C=gr(K=>tV(K,t)),M=gr(K=>Iae(K,t));if(C==null||M==null)return null;var{dangerouslySetInnerHTML:I,ticks:j}=e,q=s6(e,hde);return me.createElement(jg,KP({},q,{scale:T,x:M.x,y:M.y,width:C.width,height:C.height,className:Ya("recharts-".concat(y," ").concat(y),i),viewBox:s,ticks:o}))},_de=e=>{var t,i,s,f,y;return me.createElement(mde,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(i=e.includeHidden)!==null&&i!==void 0?i:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(s=e.angle)!==null&&s!==void 0?s:0,minTickGap:(f=e.minTickGap)!==null&&f!==void 0?f:5,tick:(y=e.tick)!==null&&y!==void 0?y:!0,tickFormatter:e.tickFormatter},me.createElement(gde,e))};class lT extends me.Component{render(){return me.createElement(_de,this.props)}}a6(lT,"displayName","XAxis");a6(lT,"defaultProps",{allowDataOverflow:ph.allowDataOverflow,allowDecimals:ph.allowDecimals,allowDuplicatedCategory:ph.allowDuplicatedCategory,height:ph.height,hide:!1,mirror:ph.mirror,orientation:ph.orientation,padding:ph.padding,reversed:ph.reversed,scale:ph.scale,tickCount:ph.tickCount,type:ph.type,xAxisId:0});var yde=e=>{var{ticks:t,label:i,labelGapWithTick:s=5,tickSize:f=0,tickMargin:y=0}=e,T=0;if(t){t.forEach(I=>{if(I){var j=I.getBoundingClientRect();j.width>T&&(T=j.width)}});var o=i?i.getBoundingClientRect().width:0,C=f+y,M=T+C+o+(i?s:0);return Math.round(M)}return 0},vde=["dangerouslySetInnerHTML","ticks"];function l6(e,t,i){return(t=xde(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function xde(e){var t=bde(e,"string");return typeof t=="symbol"?t:t+""}function bde(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JP(){return JP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},JP.apply(null,arguments)}function wde(e,t){if(e==null)return{};var i,s,f=Tde(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function Tde(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function Sde(e){var t=rl();return me.useEffect(()=>(t(ade(e)),()=>{t(sde(e))}),[e,t]),null}var Ede=e=>{var t,{yAxisId:i,className:s,width:f,label:y}=e,T=me.useRef(null),o=me.useRef(null),C=gr(g4),M=Wu(),I=rl(),j="yAxis",q=gr(ue=>Wv(ue,j,i,M)),K=gr(ue=>nV(ue,i)),J=gr(ue=>Dae(ue,i)),te=gr(ue=>oV(ue,j,i,M));if(me.useLayoutEffect(()=>{var ue;if(!(f!=="auto"||!K||DO(y)||me.isValidElement(y))){var Pe=T.current,Oe=Pe==null||(ue=Pe.tickRefs)===null||ue===void 0?void 0:ue.current,{tickSize:xe,tickMargin:Qe}=Pe.props,tt=yde({ticks:Oe,label:o.current,labelGapWithTick:5,tickSize:xe,tickMargin:Qe});Math.round(K.width)!==Math.round(tt)&&I(lde({id:i,width:tt}))}},[T,T==null||(t=T.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,K?.width,K,I,y,i,f]),K==null||J==null)return null;var{dangerouslySetInnerHTML:oe,ticks:ce}=e,de=wde(e,vde);return me.createElement(jg,JP({},de,{ref:T,labelRef:o,scale:q,x:J.x,y:J.y,width:K.width,height:K.height,className:Ya("recharts-".concat(j," ").concat(j),s),viewBox:C,ticks:te}))},Ade=e=>{var t,i,s,f,y;return me.createElement(me.Fragment,null,me.createElement(Sde,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(i=e.includeHidden)!==null&&i!==void 0?i:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(s=e.angle)!==null&&s!==void 0?s:0,minTickGap:(f=e.minTickGap)!==null&&f!==void 0?f:5,tick:(y=e.tick)!==null&&y!==void 0?y:!0,tickFormatter:e.tickFormatter}),me.createElement(Ede,e))},Pde={allowDataOverflow:mh.allowDataOverflow,allowDecimals:mh.allowDecimals,allowDuplicatedCategory:mh.allowDuplicatedCategory,hide:!1,mirror:mh.mirror,orientation:mh.orientation,padding:mh.padding,reversed:mh.reversed,scale:mh.scale,tickCount:mh.tickCount,type:mh.type,width:mh.width,yAxisId:0};class cT extends me.Component{render(){return me.createElement(Ade,this.props)}}l6(cT,"displayName","YAxis");l6(cT,"defaultProps",Pde);var PA={exports:{}},CA={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pB;function Cde(){if(pB)return CA;pB=1;var e=Bv();function t(C,M){return C===M&&(C!==0||1/C===1/M)||C!==C&&M!==M}var i=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,f=e.useRef,y=e.useEffect,T=e.useMemo,o=e.useDebugValue;return CA.useSyncExternalStoreWithSelector=function(C,M,I,j,q){var K=f(null);if(K.current===null){var J={hasValue:!1,value:null};K.current=J}else J=K.current;K=T(function(){function oe(Oe){if(!ce){if(ce=!0,de=Oe,Oe=j(Oe),q!==void 0&&J.hasValue){var xe=J.value;if(q(xe,Oe))return ue=xe}return ue=Oe}if(xe=ue,i(de,Oe))return xe;var Qe=j(Oe);return q!==void 0&&q(xe,Qe)?(de=Oe,xe):(de=Oe,ue=Qe)}var ce=!1,de,ue,Pe=I===void 0?null:I;return[function(){return oe(M())},Pe===null?void 0:function(){return oe(Pe())}]},[M,I,j,q]);var te=s(C,K[0],K[1]);return y(function(){J.hasValue=!0,J.value=te},[te]),o(te),te},CA}var mB;function Mde(){return mB||(mB=1,PA.exports=Cde()),PA.exports}Mde();function Ode(e){e()}function Ide(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Ode(()=>{let i=e;for(;i;)i.callback(),i=i.next})},get(){const i=[];let s=e;for(;s;)i.push(s),s=s.next;return i},subscribe(i){let s=!0;const f=t={callback:i,next:null,prev:t};return f.prev?f.prev.next=f:e=f,function(){!s||e===null||(s=!1,f.next?f.next.prev=f.prev:t=f.prev,f.prev?f.prev.next=f.next:e=f.next)}}}}var gB={notify(){},get:()=>[]};function Dde(e,t){let i,s=gB,f=0,y=!1;function T(te){I();const oe=s.subscribe(te);let ce=!1;return()=>{ce||(ce=!0,oe(),j())}}function o(){s.notify()}function C(){J.onStateChange&&J.onStateChange()}function M(){return y}function I(){f++,i||(i=e.subscribe(C),s=Ide())}function j(){f--,i&&f===0&&(i(),i=void 0,s.clear(),s=gB)}function q(){y||(y=!0,I())}function K(){y&&(y=!1,j())}const J={addNestedSub:T,notifyNestedSubs:o,handleChangeWrapper:C,isSubscribed:M,trySubscribe:q,tryUnsubscribe:K,getListeners:()=>s};return J}var Rde=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Lde=Rde(),zde=()=>typeof navigator<"u"&&navigator.product==="ReactNative",kde=zde(),Nde=()=>Lde||kde?me.useLayoutEffect:me.useEffect,Bde=Nde(),jde=Symbol.for("react-redux-context"),Fde=typeof globalThis<"u"?globalThis:{};function Ude(){if(!me.createContext)return{};const e=Fde[jde]??=new Map;let t=e.get(me.createContext);return t||(t=me.createContext(null),e.set(me.createContext,t)),t}var Vde=Ude();function $de(e){const{children:t,context:i,serverState:s,store:f}=e,y=me.useMemo(()=>{const C=Dde(f);return{store:f,subscription:C,getServerState:s?()=>s:void 0}},[f,s]),T=me.useMemo(()=>f.getState(),[f]);Bde(()=>{const{subscription:C}=y;return C.onStateChange=C.notifyNestedSubs,C.trySubscribe(),T!==f.getState()&&C.notifyNestedSubs(),()=>{C.tryUnsubscribe(),C.onStateChange=void 0}},[y,T]);const o=i||Vde;return me.createElement(o.Provider,{value:y},t)}var qde=$de,Hde=(e,t)=>t,NO=Fn([Hde,Ba,qoe,Gl,vV,xm,Lse,nc],Use),BO=e=>{var t=e.currentTarget.getBoundingClientRect(),i=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/i),chartY:Math.round((e.clientY-t.top)/s)}},c6=bd("mouseClick"),u6=ab();u6.startListening({actionCreator:c6,effect:(e,t)=>{var i=e.payload,s=NO(t.getState(),BO(i));s?.activeIndex!=null&&t.dispatch(Hae({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var QP=bd("mouseMove"),h6=ab();h6.startListening({actionCreator:QP,effect:(e,t)=>{var i=e.payload,s=t.getState(),f=TO(s,s.tooltip.settings.shared),y=NO(s,BO(i));f==="axis"&&(y?.activeIndex!=null?t.dispatch(fV({activeIndex:y.activeIndex,activeDataKey:void 0,activeCoordinate:y.activeCoordinate})):t.dispatch(dV()))}});function Gde(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var _B={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},d6=Sd({name:"rootProps",initialState:_B,reducers:{updateOptions:(e,t)=>{var i;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(i=t.payload.barGap)!==null&&i!==void 0?i:_B.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),Zde=d6.reducer,{updateOptions:Wde}=d6.actions,f6=Sd({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Yye}=f6.actions,Xde=f6.reducer,p6=bd("keyDown"),m6=bd("focus"),jO=ab();jO.startListening({actionCreator:p6,effect:(e,t)=>{var i=t.getState(),s=i.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:f}=i.tooltip,y=e.payload;if(!(y!=="ArrowRight"&&y!=="ArrowLeft"&&y!=="Enter")){var T=Number(SO(f,my(i))),o=xm(i);if(y==="Enter"){var C=tT(i,"axis","hover",String(f.index));t.dispatch($P({active:!f.active,activeIndex:f.index,activeDataKey:f.dataKey,activeCoordinate:C}));return}var M=kae(i),I=M==="left-to-right"?1:-1,j=y==="ArrowRight"?1:-1,q=T+j*I;if(!(o==null||q>=o.length||q<0)){var K=tT(i,"axis","hover",String(q));t.dispatch($P({active:!0,activeIndex:q.toString(),activeDataKey:void 0,activeCoordinate:K}))}}}}});jO.startListening({actionCreator:m6,effect:(e,t)=>{var i=t.getState(),s=i.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:f}=i.tooltip;if(!f.active&&f.index==null){var y="0",T=tT(i,"axis","hover",String(y));t.dispatch($P({activeDataKey:void 0,active:!0,activeIndex:y,activeCoordinate:T}))}}}});var dd=bd("externalEvent"),g6=ab();g6.startListening({actionCreator:dd,effect:(e,t)=>{if(e.payload.handler!=null){var i=t.getState(),s={activeCoordinate:wse(i),activeDataKey:TV(i),activeIndex:Gx(i),activeLabel:vse(i),activeTooltipIndex:Gx(i),isTooltipActive:Tse(i)};e.payload.handler(s,e.payload.reactEvent)}}});var Yde=Fn([Xv],e=>e.tooltipItemPayloads),Kde=Fn([Yde,o2,(e,t,i)=>t,(e,t,i)=>i],(e,t,i,s)=>{var f=e.find(o=>o.settings.dataKey===s);if(f!=null){var{positions:y}=f;if(y!=null){var T=t(y,i);return T}}}),_6=bd("touchMove"),y6=ab();y6.startListening({actionCreator:_6,effect:(e,t)=>{var i=e.payload,s=t.getState(),f=TO(s,s.tooltip.settings.shared);if(f==="axis"){var y=NO(s,BO({clientX:i.touches[0].clientX,clientY:i.touches[0].clientY,currentTarget:i.currentTarget}));y?.activeIndex!=null&&t.dispatch(fV({activeIndex:y.activeIndex,activeDataKey:void 0,activeCoordinate:y.activeCoordinate}))}else if(f==="item"){var T,o=i.touches[0],C=document.elementFromPoint(o.clientX,o.clientY);if(!C||!C.getAttribute)return;var M=C.getAttribute(nte),I=(T=C.getAttribute(ite))!==null&&T!==void 0?T:void 0,j=Kde(t.getState(),M,I);t.dispatch(hV({activeDataKey:I,activeIndex:M,activeCoordinate:j}))}}});var Jde=V5({brush:phe,cartesianAxis:cde,chartData:rle,graphicalItems:Tce,layout:Aee,legend:_te,options:Qse,polarAxis:_ce,polarOptions:Xde,referenceElements:bhe,rootProps:Zde,tooltip:Gae}),Qde=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return KQ({reducer:Jde,preloadedState:t,middleware:s=>s({serializableCheck:!1}).concat([u6.middleware,h6.middleware,jO.middleware,g6.middleware,y6.middleware]),devTools:{serialize:{replacer:Gde},name:"recharts-".concat(i)}})};function efe(e){var{preloadedState:t,children:i,reduxStoreName:s}=e,f=Wu(),y=me.useRef(null);if(f)return i;y.current==null&&(y.current=Qde(t,s));var T=wM;return me.createElement(qde,{context:T,store:y.current},i)}function tfe(e){var{layout:t,width:i,height:s,margin:f}=e,y=rl(),T=Wu();return me.useEffect(()=>{T||(y(Tee(t)),y(See({width:i,height:s})),y(wee(f)))},[y,T,t,i,s,f]),null}function nfe(e){var t=rl();return me.useEffect(()=>{t(Wde(e))},[t,e]),null}var ife=["children"];function rfe(e,t){if(e==null)return{};var i,s,f=ofe(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function ofe(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function uT(){return uT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},uT.apply(null,arguments)}var afe={width:"100%",height:"100%"},sfe=me.forwardRef((e,t)=>{var i=DM(),s=RM(),f=y4();if(!F1(i)||!F1(s))return null;var{children:y,otherAttributes:T,title:o,desc:C}=e,M,I;return typeof T.tabIndex=="number"?M=T.tabIndex:M=f?0:void 0,typeof T.role=="string"?I=T.role:I=f?"application":void 0,me.createElement(uM,uT({},T,{title:o,desc:C,role:I,tabIndex:M,width:i,height:s,style:afe,ref:t}),y)}),lfe=e=>{var{children:t}=e,i=gr(VT);if(!i)return null;var{width:s,height:f,y,x:T}=i;return me.createElement(uM,{width:s,height:f,x:T,y},t)},yB=me.forwardRef((e,t)=>{var{children:i}=e,s=rfe(e,ife),f=Wu();return f?me.createElement(lfe,null,i):me.createElement(sfe,uT({ref:t},s),i)});function cfe(){var e=rl(),[t,i]=me.useState(null),s=gr(tte);return me.useEffect(()=>{if(t!=null){var f=t.getBoundingClientRect(),y=f.width/t.offsetWidth;Ah(y)&&y!==s&&e(Eee(y))}},[t,e,s]),i}function vB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function ufe(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?vB(Object(i),!0).forEach(function(s){hfe(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function hfe(e,t,i){return(t=dfe(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function dfe(e){var t=ffe(e,"string");return typeof t=="symbol"?t:t+""}function ffe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pfe=me.forwardRef((e,t)=>{var{children:i,className:s,height:f,onClick:y,onContextMenu:T,onDoubleClick:o,onMouseDown:C,onMouseEnter:M,onMouseLeave:I,onMouseMove:j,onMouseUp:q,onTouchEnd:K,onTouchMove:J,onTouchStart:te,style:oe,width:ce}=e,de=rl(),[ue,Pe]=me.useState(null),[Oe,xe]=me.useState(null);sle();var Qe=cfe(),tt=me.useCallback($t=>{Qe($t),typeof t=="function"&&t($t),Pe($t),xe($t)},[Qe,t,Pe,xe]),Ge=me.useCallback($t=>{de(c6($t)),de(dd({handler:y,reactEvent:$t}))},[de,y]),Je=me.useCallback($t=>{de(QP($t)),de(dd({handler:M,reactEvent:$t}))},[de,M]),Ve=me.useCallback($t=>{de(dV()),de(dd({handler:I,reactEvent:$t}))},[de,I]),xt=me.useCallback($t=>{de(QP($t)),de(dd({handler:j,reactEvent:$t}))},[de,j]),yt=me.useCallback(()=>{de(m6())},[de]),ot=me.useCallback($t=>{de(p6($t.key))},[de]),zt=me.useCallback($t=>{de(dd({handler:T,reactEvent:$t}))},[de,T]),rt=me.useCallback($t=>{de(dd({handler:o,reactEvent:$t}))},[de,o]),Bt=me.useCallback($t=>{de(dd({handler:C,reactEvent:$t}))},[de,C]),Vt=me.useCallback($t=>{de(dd({handler:q,reactEvent:$t}))},[de,q]),Ln=me.useCallback($t=>{de(dd({handler:te,reactEvent:$t}))},[de,te]),$e=me.useCallback($t=>{de(_6($t)),de(dd({handler:J,reactEvent:$t}))},[de,J]),Pt=me.useCallback($t=>{de(dd({handler:K,reactEvent:$t}))},[de,K]);return me.createElement(CV.Provider,{value:ue},me.createElement(h5.Provider,{value:Oe},me.createElement("div",{className:Ya("recharts-wrapper",s),style:ufe({position:"relative",cursor:"default",width:ce,height:f},oe),role:"application",onClick:Ge,onContextMenu:zt,onDoubleClick:rt,onFocus:yt,onKeyDown:ot,onMouseDown:Bt,onMouseEnter:Je,onMouseLeave:Ve,onMouseMove:xt,onMouseUp:Vt,onTouchEnd:Pt,onTouchMove:$e,onTouchStart:Ln,ref:tt},i)))}),mfe=["children","className","width","height","style","compact","title","desc"];function gfe(e,t){if(e==null)return{};var i,s,f=_fe(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function _fe(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var yfe=me.forwardRef((e,t)=>{var{children:i,className:s,width:f,height:y,style:T,compact:o,title:C,desc:M}=e,I=gfe(e,mfe),j=gs(I,!1);return o?me.createElement(yB,{otherAttributes:j,title:C,desc:M},i):me.createElement(pfe,{className:s,style:T,width:f,height:y,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},me.createElement(yB,{otherAttributes:j,title:C,desc:M,ref:t},me.createElement(The,null,i)))}),vfe=["width","height"];function eC(){return eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},eC.apply(null,arguments)}function xfe(e,t){if(e==null)return{};var i,s,f=bfe(e,t);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(s=0;s<y.length;s++)i=y[s],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(f[i]=e[i])}return f}function bfe(e,t){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var wfe={top:5,right:5,bottom:5,left:5},Tfe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:wfe,reverseStackOrder:!1,syncMethod:"index"},Sfe=me.forwardRef(function(t,i){var s,f=zg(t.categoricalChartProps,Tfe),{width:y,height:T}=f,o=xfe(f,vfe);if(!F1(y)||!F1(T))return null;var{chartName:C,defaultTooltipEventType:M,validateTooltipEventTypes:I,tooltipPayloadSearcher:j,categoricalChartProps:q}=t,K={chartName:C,defaultTooltipEventType:M,validateTooltipEventTypes:I,tooltipPayloadSearcher:j,eventEmitter:void 0};return me.createElement(efe,{preloadedState:{options:K},reduxStoreName:(s=q.id)!==null&&s!==void 0?s:C},me.createElement(fhe,{chartData:q.data}),me.createElement(tfe,{width:y,height:T,layout:f.layout,margin:f.margin}),me.createElement(nfe,{accessibilityLayer:f.accessibilityLayer,barCategoryGap:f.barCategoryGap,maxBarSize:f.maxBarSize,stackOffset:f.stackOffset,barGap:f.barGap,barSize:f.barSize,syncId:f.syncId,syncMethod:f.syncMethod,className:f.className}),me.createElement(yfe,eC({},o,{width:y,height:T,ref:i})))}),Efe=["axis","item"],xB=me.forwardRef((e,t)=>me.createElement(Sfe,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Efe,tooltipPayloadSearcher:Kse,categoricalChartProps:e,ref:t}));const Afe=[{name:"ممرات الجمال",value:20},{name:"صخور ",value:25},{name:"حفرة ",value:15},{name:"منطقة ",value:30},{name:" مقطوعة",value:40}],Pfe=[{name:"الطائف",value:1800},{name:"ابها",value:3900},{name:"حائل",value:1100},{name:"جازان",value:1600},{name:"الباحة",value:2200}],Cfe=[{position:"وادي الدواسر",city:"الرياض",image:"/assets/camell.png",tag:" ممر جمال "},{position:"مرتفعات السودة ",city:"ابها",image:"/assets/dangers-road.png",tag:" منحدر  جبلي وعر  "},{position:"  جبل نهران ",city:"ابها",image:"/assets/rock.png",tag:" انهيارات صخرية"},{position:" النفوذ ",city:"الجوف - حائل ",image:"/assets/desert.png",tag:"  طريق مقطوعة"}],Mfe=()=>ie.jsxs("div",{className:"min-h-screen bg-gray-50 flex text-gray-800",children:[ie.jsx(oM,{}),ie.jsxs("main",{className:"flex-1 p-6 space-y-6",children:[ie.jsxs("div",{className:"flex justify-between items-start flex-wrap gap-4",children:[ie.jsxs("div",{children:[ie.jsx("h2",{className:"text-xl font-bold",children:"مرحبا Admin  👋"}),ie.jsx("p",{className:"text-sm text-gray-500",children:"بصّـار | لتكن على بصيرة "})]}),ie.jsx(Vl,{className:"bg-yellow-400 text-black rounded-full flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]}),ie.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"}),ie.jsx("h3",{className:"text-2xl font-bold",children:"12,450"}),ie.jsxs("p",{className:"text-xs text-green-500 flex items-center gap-1",children:[ie.jsx(wj,{size:14})," 12% last month"]})]})}),ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("p",{className:"text-sm text-gray-500",children:"مجموع المناطق الخطرة  "}),ie.jsx("h3",{className:"text-2xl font-bold",children:"3,210"}),ie.jsx("p",{className:"text-xs text-red-500",children:"-2%  last month"})]})}),ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("p",{className:"text-sm text-gray-500",children:"المساعدين النشطيين "}),ie.jsx("h3",{className:"text-2xl font-bold",children:"520"}),ie.jsx("p",{className:"text-xs text-green-500",children:"+2%  last month"})]})})]}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"text-lg font-semibold mb-4",children:"المناطق الخطرة"}),ie.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Cfe.map(e=>ie.jsxs("div",{className:"rounded-xl overflow-hidden border border-yellow-200 shadow-md",children:[ie.jsx("div",{className:"relative",children:ie.jsx("img",{src:e.image,alt:"dangers-zone",className:"w-100 h-42 object-cover"})}),ie.jsxs("div",{className:"p-4 text-right border border-yellow-200",children:[ie.jsxs("h3",{className:"text-sm font-bold",children:[" ",e.position]}),ie.jsx("p",{className:"text-sm text-gray-500",children:e.city}),ie.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-gray-100 rounded text-xs",children:e.tag})]})]}))})]}),ie.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("h4",{className:"font-semibold",children:"الأعلى خطورة "}),ie.jsx("div",{className:"h-64",children:ie.jsx(IN,{width:"100%",height:"100%",children:ie.jsxs(xB,{data:Afe,children:[ie.jsx(YP,{strokeDasharray:"3 3"}),ie.jsx(lT,{dataKey:"name",reversed:!0}),ie.jsx(cT,{orientation:"right",tickFormatter:e=>e.toLocaleString("en-EG")}),ie.jsx(AN,{}),ie.jsx(jx,{}),ie.jsx(oT,{dataKey:"value",fill:"#f97316",radius:[4,4,0,0]})]})})})]})}),ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("h4",{className:"font-semibold",children:"المدن الأعلى في مستوى الخطورة  "}),ie.jsx("div",{className:"h-64",children:ie.jsx(IN,{width:"100%",height:"100%",children:ie.jsxs(xB,{data:Pfe,children:[ie.jsx(YP,{strokeDasharray:"3 3"}),ie.jsx(lT,{dataKey:"name",reversed:!0}),ie.jsx(cT,{orientation:"right"}),ie.jsx(AN,{}),ie.jsx(jx,{}),ie.jsx(oT,{dataKey:"value",fill:"#e11d48",radius:[4,4,0,0]})]})})})]})})]})]})]});function Ofe(){const[e,t]=me.useState(!1),[i,s]=me.useState(!1),[f,y]=me.useState(""),[T,o]=me.useState(""),[C,M]=me.useState(""),[I,j]=me.useState(""),[q,K]=me.useState(""),J=jv(),te=async oe=>{if(oe.preventDefault(),I!==q){alert("كلمة المرور غير متطابقة");return}try{const ce=await fetch("http://localhost:3000/api/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:f,phone:T,email:C,password:I})}),de=await ce.json();ce.ok&&de.token?(alert("تم التسجيل بنجاح!"),localStorage.setItem("token",de.token),J("/map")):alert(de.message||"حدث خطأ أثناء التسجيل")}catch(ce){console.error(ce),alert("فشل الاتصال بالخادم")}};return ie.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-r from-yellow-90 via-yellow-100 to-white-200 px-4",children:ie.jsxs("div",{className:"relative bg-white/60 backdrop-blur-xl border border-white/70 rounded-3xl shadow-xl w-full max-w-md p-8 md:p-10",children:[ie.jsxs("div",{className:"flex flex-col justify-center items-center",children:[ie.jsx("img",{src:"/assets/logo-remove.png",alt:"logo",className:"w-30"}),ie.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-gray-800 text-center",children:"بصّار"})]}),ie.jsx("p",{className:"text-[#272343] text-center mt-1 mb-6 text-sm",children:"لتكن على بصيرة"}),ie.jsxs("form",{className:"space-y-4",onSubmit:te,children:[ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"الإسم"}),ie.jsx("input",{type:"text",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",value:f,onChange:oe=>y(oe.target.value),required:!0})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"رقم الجوال"}),ie.jsx("input",{type:"tel",placeholder:"+966",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",value:T,onChange:oe=>o(oe.target.value),required:!0})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"البريد الإلكتروني"}),ie.jsx("input",{type:"email",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",value:C,onChange:oe=>M(oe.target.value),required:!0})]}),ie.jsxs("div",{className:"relative",children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"كلمة السر"}),ie.jsx("input",{type:e?"text":"password",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",value:I,onChange:oe=>j(oe.target.value),required:!0}),ie.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute left-3 top-9 text-[#272343] hover:text-gray-700",children:e?ie.jsx(A1,{className:"w-5 h-5 cursor-pointer"}):ie.jsx(E1,{className:"w-5 h-5 cursor-pointer"})})]}),ie.jsxs("div",{className:"relative",children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"تأكيد كلمة السر"}),ie.jsx("input",{type:i?"text":"password",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",value:q,onChange:oe=>K(oe.target.value),required:!0}),ie.jsx("button",{type:"button",onClick:()=>s(!i),className:"absolute left-3 top-9 text-[#272343] hover:text-gray-700",children:i?ie.jsx(A1,{className:"w-5 h-5 cursor-pointer"}):ie.jsx(E1,{className:"w-5 h-5 cursor-pointer"})})]}),ie.jsx("button",{type:"submit",className:"w-full mt-5 bg-[#F8D203] hover:bg-[#f8d30381] text-[#272343] font-semibold py-2 rounded-xl transition",children:"تسجيل"}),ie.jsxs("div",{className:"flex justify-center items-center",children:[ie.jsx("p",{className:"p-1 text-[#272343]",children:" لديك حساب ؟! "}),ie.jsx(ss,{className:"underline text-[#272343]",to:"/signin",children:"تسجيل الدخول"})]}),ie.jsxs("div",{className:"flex justify-center items-center",children:[ie.jsx("p",{className:"p-1 text-[#272343]",children:"   سجل كمساعد او مقدم خدمة    "}),ie.jsx(ss,{className:"underline text-[#272343]",to:"/signuphelper",children:"تسجيل"})]})]})]})})}function v6(){const[e,t]=me.useState(!1),s=mp().pathname,f=()=>{t(!1)};return ie.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e&&ie.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-30 md:hidden",onClick:f}),ie.jsxs("aside",{className:"w-64 bg-white p-6 border-r border-[#d8d0d090] hidden md:block",children:[ie.jsx("div",{className:"flex justify-center items-center",children:ie.jsx("img",{src:"/assets/logo.png",className:" w-25 mb-9"})}),ie.jsxs("nav",{className:"space-y-3 relative",children:[ie.jsx(ss,{to:"/helper",children:ie.jsx(Vl,{variant:s==="/helper"?"default":"ghost",className:`w-full ${s==="/helper"?"bg-yellow-400 text-black":"justify-start"}`,children:"لوحة التحكم"})}),ie.jsx(ss,{to:"/helplist",children:ie.jsx(Vl,{variant:s==="/helplist"?"default":"ghost",className:`w-full ${s==="/helplist"?"bg-yellow-400 text-black":"justify-start"}`,children:"المساعدات"})}),ie.jsx(ss,{to:"/helphistory",children:ie.jsx(Vl,{variant:s==="/helphistory"?"default":"ghost",className:`w-full ${s==="/helphistory"?"bg-yellow-400 text-black":"justify-start"}`,children:"السجل"})}),ie.jsxs("div",{className:"absolute mt-10 right-6 flex items-center space-x-3",children:[ie.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center font-bold text-green-700",children:"A"}),ie.jsxs("div",{children:[ie.jsx("p",{className:"font-semibold",children:"Helper"}),ie.jsx("p",{className:"text-xs text-gray-400",children:"helper@helper.com"})]}),ie.jsx(xC,{className:"mr-auto text-red-500 cursor-pointer"})]})]})]})]})}const Ife=[{position:"وادي الدواسر",city:"الرياض",image:"/assets/camell.png",tag:" ممر جمال "},{position:"مرتفعات السودة ",city:"ابها",image:"/assets/dangers-road.png",tag:" منحدر  جبلي وعر  "},{position:"  جبل نهران ",city:"ابها",image:"/assets/rock.png",tag:" انهيارات صخرية"},{position:" النفوذ ",city:"الجوف - حائل ",image:"/assets/desert.png",tag:"  طريق مقطوعة"}],Dfe=()=>ie.jsxs("div",{className:"min-h-screen bg-gray-50 flex text-gray-800",children:[ie.jsx(v6,{}),ie.jsxs("main",{className:"flex-1 p-6 space-y-6",children:[ie.jsxs("div",{className:"flex justify-between items-start flex-wrap gap-4",children:[ie.jsxs("div",{children:[ie.jsx("h2",{className:"text-xl font-bold",children:"Welcome Helper 👋"}),ie.jsx("p",{className:"text-sm text-gray-500",children:"لتكن على بصيرة"})]}),ie.jsx(Vl,{className:"bg-yellow-400 text-black rounded-full flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]}),ie.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"}),ie.jsx("h3",{className:"text-2xl font-bold",children:"12,450"}),ie.jsxs("p",{className:"text-xs text-green-500 flex items-center gap-1",children:[ie.jsx(wj,{size:14})," 12% vs last month"]})]})}),ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("p",{className:"text-sm text-gray-500",children:"Total danger zones"}),ie.jsx("h3",{className:"text-2xl font-bold",children:"3,210"}),ie.jsx("p",{className:"text-xs text-red-500",children:"-2% vs last month"})]})}),ie.jsx(vg,{children:ie.jsxs(xg,{className:"p-4",children:[ie.jsx("p",{className:"text-sm text-gray-500",children:"Active helpers"}),ie.jsx("h3",{className:"text-2xl font-bold",children:"520"}),ie.jsx("p",{className:"text-xs text-green-500",children:"+2% vs last month"})]})})]}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Trips"}),ie.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Ife.map(e=>ie.jsxs("div",{className:"rounded-xl overflow-hidden border border-yellow-200 shadow-md",children:[ie.jsxs("div",{className:"relative",children:[ie.jsx("img",{src:e.image,alt:"dangers-zone",className:"w-90 h-42 object-cover"}),ie.jsx("span",{className:"absolute top-2 right-2 bg-yellow-400 text-black text-sm font-bold px-2 py-1 rounded-full",children:"New"})]}),ie.jsxs("div",{className:"p-4 text-right",children:[ie.jsxs("h3",{className:"text-sm font-bold",children:[" ",e.position]}),ie.jsx("p",{className:"text-sm text-gray-500",children:e.city}),ie.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-gray-100 rounded text-xs",children:e.tag})]})]}))})]})]})]});function gb(){const[e,t]=me.useState(!1),s=mp().pathname;jv();const f=()=>{t(!1)};return ie.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e&&ie.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-30 md:hidden",onClick:f}),ie.jsxs("aside",{className:"w-64 bg-white p-6 border-r border-[#d8d0d090] hidden md:block",children:[ie.jsx("div",{className:"flex justify-center items-center",children:ie.jsx("img",{src:"/assets/logo.png",className:" w-25 mb-9"})}),ie.jsxs("nav",{className:"space-y-3 relative",children:[ie.jsx(ss,{to:"/user",children:ie.jsx(Vl,{variant:s==="/user"?"default":"ghost",className:`w-full ${s==="/user"?"bg-yellow-400 text-black":"justify-start"}`,children:"لوحة التحكم"})}),ie.jsx(ss,{to:"/userlist",children:ie.jsx(Vl,{variant:s==="/userlist"?"default":"ghost",className:`w-full ${s==="/userlist"?"bg-yellow-400 text-black":"justify-start"}`,children:"طلب المساعدة"})}),ie.jsx(ss,{to:"/dangerlist",children:ie.jsx(Vl,{variant:s==="/dangerlist"?"default":"ghost",className:`w-full ${s==="/dangerlist"?"bg-yellow-400 text-black":"justify-start"}`,children:"التحذيرات المضافة"})}),ie.jsx(ss,{to:"/userhistory",children:ie.jsx(Vl,{variant:s==="/userhistory"?"default":"ghost",className:`w-full ${s==="/userhistory"?"bg-yellow-400 text-black":"justify-start"}`,children:"السجل"})}),ie.jsxs("div",{className:"absolute mt-10 right-6 flex items-center space-x-3",children:[ie.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center font-bold text-green-700",children:"A"}),ie.jsxs("div",{children:[ie.jsx("p",{className:"font-semibold",children:"User"}),ie.jsx("p",{className:"text-xs text-gray-400",children:"user@user.com"})]}),ie.jsx(xC,{className:"mr-auto text-red-500 cursor-pointer"})]})]})]})]})}const Rfe=[{position:"وادي الدواسر",city:"الرياض",image:"/assets/camell.png",tag:" ممر جمال "},{position:"مرتفعات السودة ",city:"ابها",image:"/assets/dangers-road.png",tag:" منحدر  جبلي وعر  "},{position:"  جبل نهران ",city:"ابها",image:"/assets/rock.png",tag:" انهيارات صخرية"},{position:" النفوذ ",city:"الجوف - حائل ",image:"/assets/desert.png",tag:"  طريق مقطوعة"}],Lfe=()=>ie.jsxs("div",{className:"min-h-screen bg-gray-50 flex text-gray-800",children:[ie.jsx(gb,{}),ie.jsxs("main",{className:"flex-1 p-6 space-y-6",children:[ie.jsxs("div",{className:"flex justify-between items-start flex-wrap gap-4",children:[ie.jsxs("div",{children:[ie.jsx("h2",{className:"text-xl font-bold",children:"Welcome User 👋"}),ie.jsx("p",{className:"text-sm text-gray-500",children:"لتكن على بصيرة"})]}),ie.jsx(Vl,{className:"bg-yellow-400 text-black rounded-full flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Trips"}),ie.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Rfe.map(e=>ie.jsxs("div",{className:"rounded-xl overflow-hidden border border-yellow-200 shadow-md",children:[ie.jsx("div",{className:"relative",children:ie.jsx("img",{src:e.image,alt:"dangers-zone",className:"w-60 h-42 object-cover"})}),ie.jsxs("div",{className:"p-4 text-right",children:[ie.jsxs("h3",{className:"text-sm font-bold",children:[" ",e.position]}),ie.jsx("p",{className:"text-sm text-gray-500",children:e.city}),ie.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-gray-100 rounded text-xs",children:e.tag})]})]}))})]})]})]}),zfe=[{id:1,title:"سطحة",price:"200",image:"/assets/tow-truck.png"},{id:2,title:"وقود",price:"50",image:"/assets/gas-pump.png"},{id:3,title:"بطارية سيارة",price:"300",image:"/assets/accumulator.png"},{id:4,title:"شخص للمساعدة ",price:"50-500",image:"/assets/man.png"}];function kfe(){return ie.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[ie.jsx(v6,{}),ie.jsxs("main",{className:" flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex justify-between items-start flex-wrap mb-5 gap-4",children:[ie.jsx("div",{children:ie.jsx("h2",{className:"text-xl font-bold",children:"Welcome Helper 👋"})}),ie.jsx(Vl,{className:"bg-yellow-400 text-black rounded-full flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]}),ie.jsx("div",{className:"mt-5 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:zfe.map(e=>ie.jsxs("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:[ie.jsx("div",{className:"flex justify-center items-center m-3",children:ie.jsx("img",{src:e.image,className:"w-20 h-20 "})}),ie.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:ie.jsxs("div",{className:"p-4",children:[ie.jsx("h2",{className:"text-lg font-semibold",children:e.title}),ie.jsxs("div",{className:"mt-2 flex flex-row justify-between items-center",children:[ie.jsx("p",{className:"text-lg text-gray-500",children:e.price}),ie.jsx(W_,{color:"#f8d203"})]})]})}),ie.jsx("span",{className:"absolute top-2 right-2 text-xs bg-yellow-400 text-black px-2 py-0.5 rounded-full",children:"New"})]},e.id))})]})]})}const Nfe=[{id:1,title:"سطحة",price:"200",image:"/assets/tow-truck.png"},{id:2,title:"وقود",price:"50",image:"/assets/gas-pump.png"},{id:3,title:"بطارية سيارة",price:"300",image:"/assets/accumulator.png"},{id:4,title:"شخص للمساعدة ",price:"50-500",image:"/assets/man.png"}],Bfe=()=>ie.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[ie.jsx(gb,{}),ie.jsxs("main",{className:"flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-2",children:[ie.jsxs("div",{children:[ie.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"التحذيرات المضافة "}),ie.jsx("p",{className:"text-gray-500 text-sm",children:"اضف التحذيرات التي واجهتك على الطريق لتنبيه غيرك"})]}),ie.jsxs("div",{className:"flex flex-row gap-3",children:[ie.jsx("button",{className:"bg-[#F8D203] hover:bg-yellow-500 text-white px-4 py-2 rounded font-medium w-full md:w-auto",children:ie.jsxs("div",{className:"flex flex-row",children:[ie.jsx("p",{children:"اضافة تحذير "}),"  ",ie.jsx(bC,{className:"mr-2"})]})}),ie.jsx(Vl,{className:"bg-[#F8D203] rounded flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]})]}),ie.jsx("div",{className:"mt-5 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Nfe.map(e=>ie.jsxs("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:[ie.jsx("div",{className:"flex justify-center items-center m-3",children:ie.jsx("img",{src:e.image,className:"w-20 h-20 "})}),ie.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:ie.jsxs("div",{className:"p-4",children:[ie.jsx("h2",{className:"text-lg font-semibold",children:e.title}),ie.jsx("div",{className:"mt-2 flex flex-row justify-between items-center",children:ie.jsx("p",{className:"text-lg text-gray-500",children:e.price})})]})}),ie.jsx("span",{className:"absolute top-2 right-2 text-xs bg-yellow-400 text-black px-2 py-0.5 rounded-full",children:"New"})]},e.id))})]})]}),jfe=[{id:"1",name:"Michael Johnson",phone:"phoenix@jsmastery.pro",locationUrl:"https://www.google.com/maps?q=24.7136,46.6753",services:"بطارية",rating:5,status:"رفض",date:"2025-07-07"},{id:"2",name:"Jason Wilson",phone:"demi@jsmastery.pro",locationUrl:"https://www.google.com/maps?q=24.774265,46.738586",services:"بطارية",rating:4,status:"قبول",date:"2025-07-07"}];function Ffe(){const[e,t]=me.useState(null),[i,s]=me.useState(0),f=T=>{t(T),s(T.rating)},y=()=>{t(null)};return ie.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[ie.jsx(gb,{}),ie.jsxs("main",{className:" flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex justify-between items-start flex-wrap mb-5 gap-4",children:[ie.jsx("div",{children:ie.jsx("h2",{className:"text-xl font-bold",children:"Welcome User 👋"})}),ie.jsx(Vl,{className:"bg-[#F8D203] text-black rounded-full flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]}),ie.jsx("div",{className:"bg-white shadow rounded overflow-x-auto",children:ie.jsxs("table",{className:"min-w-full text-right text-sm",children:[ie.jsx("thead",{className:"border-b border-[#7a77777e] bg-gray-50",children:ie.jsxs("tr",{children:[ie.jsx("th",{className:"p-4 font-medium",children:"الأسم"}),ie.jsx("th",{className:"p-4 font-medium hidden sm:table-cell",children:"رقم الجوال"}),ie.jsx("th",{className:"p-4 font-medium hidden lg:table-cell",children:"نوع الخدمة"}),ie.jsx("th",{className:"p-4 font-medium hidden lg:table-cell",children:"السعر"}),ie.jsx("th",{className:"p-4 font-medium",children:"الحالة"}),ie.jsx("th",{className:"p-4 font-medium",children:"التقييم"}),ie.jsx("th",{className:"p-4 font-medium"})]})}),ie.jsx("tbody",{children:jfe.map(T=>ie.jsxs("tr",{className:"border-b border-[#c5c1c1a6] hover:bg-gray-50 transition-colors",children:[ie.jsx("td",{className:"p-4 flex items-center gap-3",children:ie.jsx("span",{className:"text-[#272343]",children:T.name})}),ie.jsx("td",{className:"p-4 hidden text-[#272343] sm:table-cell",children:T.phone}),ie.jsx("td",{className:"p-4 hidden lg:table-cell",children:ie.jsx("span",{className:"px-2 py-1  bg-gray-100 rounded text-xs text-[#272343] font-medium",children:T.services})}),ie.jsx("td",{className:"p-4",children:ie.jsx(W_,{size:"20px",color:"#272343"})}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{onClick:()=>{},className:"text-gray-400 hover:text-gray-600",children:ie.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${T.status==="قبول"?"bg-green-100 text-green-600":T.status==="مراجعة"?"bg-yellow-100 text-yellow-600":T.status==="رفض"?"bg-red-100 text-red-600":""}`,children:T.status})})}),ie.jsx("td",{className:"p-2 text-yellow-500",children:"⭐".repeat(T.rating)}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{onClick:()=>f(T),className:"bg-blue-100 text-blue-600 rounded px-2 py-1 hover:bg-gray-400",children:"المزيد"})})]}))})]})}),e&&ie.jsx("div",{className:"fixed inset-0 bg-[#ffffff0b] bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 transition-opacity duration-300",children:ie.jsxs("div",{className:"bg-white p-6 rounded-xl w-[90%] max-w-md relative transform transition-all duration-300 scale-95 opacity-0 animate-fadeIn",children:[ie.jsx("h2",{className:"text-lg font-bold mb-4",children:"تفاصيل المستخدم"}),ie.jsxs("p",{children:[ie.jsx("strong",{children:"رقم الجوال:"})," ",e.phone]}),ie.jsxs("p",{className:"mt-2",children:[ie.jsx("strong",{children:"تاريخ الخدمة:"})," ",e.date]}),ie.jsxs("div",{className:"mt-4",children:[ie.jsx("strong",{children:"الموقع:"}),ie.jsx("iframe",{src:e.locationUrl,width:"100%",height:"200",className:"mt-2 rounded",allowFullScreen:!0})]}),ie.jsxs("div",{className:"mt-4",children:[ie.jsx("strong",{children:"التقييم:"}),ie.jsx("div",{className:"flex gap-1 mt-1",children:[1,2,3,4,5].map(T=>ie.jsx(n9,{size:24,className:`cursor-pointer ${T<=i?"text-yellow-500":"text-gray-300"}`,onClick:()=>s(T),fill:T<=i?"#facc15":"none"},T))})]}),ie.jsxs("div",{className:"flex justify-between mt-6",children:[ie.jsx("button",{onClick:y,className:"px-4 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"إغلاق"}),ie.jsxs("button",{onClick:()=>{alert("تم الحذف"),y()},className:"flex items-center gap-2 px-4 py-1 bg-red-100 text-red-700 hover:bg-red-200 rounded",children:[ie.jsx(FA,{size:18}),"حذف"]})]})]})})]})]})}const Ufe=[{id:1,title:"سطحة",price:"200",image:"/assets/tow-truck.png"},{id:2,title:"وقود",price:"50",image:"/assets/gas-pump.png"},{id:3,title:"بطارية سيارة",price:"300",image:"/assets/accumulator.png"},{id:4,title:"شخص للمساعدة ",price:"50-500",image:"/assets/man.png"}],Vfe=()=>ie.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[ie.jsx(gb,{}),ie.jsxs("main",{className:"flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-2",children:[ie.jsxs("div",{children:[ie.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"التحذيرات المضافة "}),ie.jsx("p",{className:"text-gray-500 text-sm",children:"اضف التحذيرات التي واجهتك على الطريق لتنبيه غيرك"})]}),ie.jsxs("div",{className:"flex flex-row gap-3",children:[ie.jsx("button",{className:"bg-[#F8D203] hover:bg-yellow-500 text-white px-4 py-2 rounded font-medium w-full md:w-auto",children:ie.jsxs("div",{className:"flex flex-row",children:[ie.jsx("p",{children:"اضافة تحذير "}),"  ",ie.jsx(bC,{className:"mr-2"})]})}),ie.jsx(Vl,{className:"bg-[#F8D203] rounded flex gap-2 items-center",children:ie.jsx(Ig,{color:"#ffffff"})})]})]}),ie.jsx("div",{className:"mt-5 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ufe.map(e=>ie.jsxs("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:[ie.jsx("div",{className:"flex justify-center items-center m-3",children:ie.jsx("img",{src:e.image,className:"w-20 h-20 "})}),ie.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden relative",children:ie.jsxs("div",{className:"p-4",children:[ie.jsx("h2",{className:"text-lg font-semibold",children:e.title}),ie.jsx("div",{className:"mt-2 flex flex-row justify-between items-center",children:ie.jsx("p",{className:"text-lg text-gray-500",children:e.price})})]})}),ie.jsx("span",{className:"absolute top-2 right-2 text-xs bg-yellow-400 text-black px-2 py-0.5 rounded-full",children:"New"})]},e.id))})]})]});var d1={exports:{}},$fe=d1.exports,bB;function qfe(){return bB||(bB=1,function(e,t){(function(i,s){e.exports=s()})($fe,function(){var i,s,f;function y(o,C){if(!i)i=C;else if(!s)s=C;else{var M="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",I={};i(I),f=C(I),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([M],{type:"text/javascript"})))}}y(["exports"],function(o){var C=1e-6,M=typeof Float32Array<"u"?Float32Array:Array;function I(c,n){var a=n[0],h=n[1],p=n[2],v=n[3],x=a*v-p*h;return x?(c[0]=v*(x=1/x),c[1]=-h*x,c[2]=-p*x,c[3]=a*x,c):null}function j(){var c=new M(9);return M!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function q(c,n){var a=n[0],h=n[1],p=n[2],v=n[3],x=n[4],E=n[5],O=n[6],D=n[7],B=n[8];return c[0]=x*B-E*D,c[1]=p*D-h*B,c[2]=h*E-p*x,c[3]=E*O-v*B,c[4]=a*B-p*O,c[5]=p*v-a*E,c[6]=v*D-x*O,c[7]=h*O-a*D,c[8]=a*x-h*v,c}function K(c,n,a){var h=n[0],p=n[1],v=n[2],x=n[3],E=n[4],O=n[5],D=n[6],B=n[7],F=n[8],U=a[0],Z=a[1],Y=a[2],re=a[3],he=a[4],_e=a[5],Se=a[6],Ce=a[7],le=a[8];return c[0]=U*h+Z*x+Y*D,c[1]=U*p+Z*E+Y*B,c[2]=U*v+Z*O+Y*F,c[3]=re*h+he*x+_e*D,c[4]=re*p+he*E+_e*B,c[5]=re*v+he*O+_e*F,c[6]=Se*h+Ce*x+le*D,c[7]=Se*p+Ce*E+le*B,c[8]=Se*v+Ce*O+le*F,c}function J(){var c=new M(16);return M!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c}function te(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function oe(c,n){var a=n[0],h=n[1],p=n[2],v=n[3],x=n[4],E=n[5],O=n[6],D=n[7],B=n[8],F=n[9],U=n[10],Z=n[11],Y=n[12],re=n[13],he=n[14],_e=n[15],Se=a*E-h*x,Ce=a*O-p*x,le=a*D-v*x,Te=h*O-p*E,Me=h*D-v*E,Re=p*D-v*O,et=B*re-F*Y,Ye=B*he-U*Y,it=B*_e-Z*Y,dt=F*he-U*re,Ct=F*_e-Z*re,tn=U*_e-Z*he,qt=Se*tn-Ce*Ct+le*dt+Te*it-Me*Ye+Re*et;return qt?(c[0]=(E*tn-O*Ct+D*dt)*(qt=1/qt),c[1]=(p*Ct-h*tn-v*dt)*qt,c[2]=(re*Re-he*Me+_e*Te)*qt,c[3]=(U*Me-F*Re-Z*Te)*qt,c[4]=(O*it-x*tn-D*Ye)*qt,c[5]=(a*tn-p*it+v*Ye)*qt,c[6]=(he*le-Y*Re-_e*Ce)*qt,c[7]=(B*Re-U*le+Z*Ce)*qt,c[8]=(x*Ct-E*it+D*et)*qt,c[9]=(h*it-a*Ct-v*et)*qt,c[10]=(Y*Me-re*le+_e*Se)*qt,c[11]=(F*le-B*Me-Z*Se)*qt,c[12]=(E*Ye-x*dt-O*et)*qt,c[13]=(a*dt-h*Ye+p*et)*qt,c[14]=(re*Ce-Y*Te-he*Se)*qt,c[15]=(B*Te-F*Ce+U*Se)*qt,c):null}function ce(c,n,a){var h=n[0],p=n[1],v=n[2],x=n[3],E=n[4],O=n[5],D=n[6],B=n[7],F=n[8],U=n[9],Z=n[10],Y=n[11],re=n[12],he=n[13],_e=n[14],Se=n[15],Ce=a[0],le=a[1],Te=a[2],Me=a[3];return c[0]=Ce*h+le*E+Te*F+Me*re,c[1]=Ce*p+le*O+Te*U+Me*he,c[2]=Ce*v+le*D+Te*Z+Me*_e,c[3]=Ce*x+le*B+Te*Y+Me*Se,c[4]=(Ce=a[4])*h+(le=a[5])*E+(Te=a[6])*F+(Me=a[7])*re,c[5]=Ce*p+le*O+Te*U+Me*he,c[6]=Ce*v+le*D+Te*Z+Me*_e,c[7]=Ce*x+le*B+Te*Y+Me*Se,c[8]=(Ce=a[8])*h+(le=a[9])*E+(Te=a[10])*F+(Me=a[11])*re,c[9]=Ce*p+le*O+Te*U+Me*he,c[10]=Ce*v+le*D+Te*Z+Me*_e,c[11]=Ce*x+le*B+Te*Y+Me*Se,c[12]=(Ce=a[12])*h+(le=a[13])*E+(Te=a[14])*F+(Me=a[15])*re,c[13]=Ce*p+le*O+Te*U+Me*he,c[14]=Ce*v+le*D+Te*Z+Me*_e,c[15]=Ce*x+le*B+Te*Y+Me*Se,c}function de(c,n,a){var h,p,v,x,E,O,D,B,F,U,Z,Y,re=a[0],he=a[1],_e=a[2];return n===c?(c[12]=n[0]*re+n[4]*he+n[8]*_e+n[12],c[13]=n[1]*re+n[5]*he+n[9]*_e+n[13],c[14]=n[2]*re+n[6]*he+n[10]*_e+n[14],c[15]=n[3]*re+n[7]*he+n[11]*_e+n[15]):(p=n[1],v=n[2],x=n[3],E=n[4],O=n[5],D=n[6],B=n[7],F=n[8],U=n[9],Z=n[10],Y=n[11],c[0]=h=n[0],c[1]=p,c[2]=v,c[3]=x,c[4]=E,c[5]=O,c[6]=D,c[7]=B,c[8]=F,c[9]=U,c[10]=Z,c[11]=Y,c[12]=h*re+E*he+F*_e+n[12],c[13]=p*re+O*he+U*_e+n[13],c[14]=v*re+D*he+Z*_e+n[14],c[15]=x*re+B*he+Y*_e+n[15]),c}function ue(c,n,a){var h=a[0],p=a[1],v=a[2];return c[0]=n[0]*h,c[1]=n[1]*h,c[2]=n[2]*h,c[3]=n[3]*h,c[4]=n[4]*p,c[5]=n[5]*p,c[6]=n[6]*p,c[7]=n[7]*p,c[8]=n[8]*v,c[9]=n[9]*v,c[10]=n[10]*v,c[11]=n[11]*v,c[12]=n[12],c[13]=n[13],c[14]=n[14],c[15]=n[15],c}function Pe(c,n,a){var h=Math.sin(a),p=Math.cos(a),v=n[4],x=n[5],E=n[6],O=n[7],D=n[8],B=n[9],F=n[10],U=n[11];return n!==c&&(c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[12]=n[12],c[13]=n[13],c[14]=n[14],c[15]=n[15]),c[4]=v*p+D*h,c[5]=x*p+B*h,c[6]=E*p+F*h,c[7]=O*p+U*h,c[8]=D*p-v*h,c[9]=B*p-x*h,c[10]=F*p-E*h,c[11]=U*p-O*h,c}function Oe(c,n,a){var h=Math.sin(a),p=Math.cos(a),v=n[0],x=n[1],E=n[2],O=n[3],D=n[8],B=n[9],F=n[10],U=n[11];return n!==c&&(c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7],c[12]=n[12],c[13]=n[13],c[14]=n[14],c[15]=n[15]),c[0]=v*p-D*h,c[1]=x*p-B*h,c[2]=E*p-F*h,c[3]=O*p-U*h,c[8]=v*h+D*p,c[9]=x*h+B*p,c[10]=E*h+F*p,c[11]=O*h+U*p,c}function xe(c,n,a){var h=Math.sin(a),p=Math.cos(a),v=n[0],x=n[1],E=n[2],O=n[3],D=n[4],B=n[5],F=n[6],U=n[7];return n!==c&&(c[8]=n[8],c[9]=n[9],c[10]=n[10],c[11]=n[11],c[12]=n[12],c[13]=n[13],c[14]=n[14],c[15]=n[15]),c[0]=v*p+D*h,c[1]=x*p+B*h,c[2]=E*p+F*h,c[3]=O*p+U*h,c[4]=D*p-v*h,c[5]=B*p-x*h,c[6]=F*p-E*h,c[7]=U*p-O*h,c}function Qe(c,n){return c[0]=n[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=n[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=n[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function tt(c,n,a){var h,p,v,x=a[0],E=a[1],O=a[2],D=Math.hypot(x,E,O);return D<C?null:(x*=D=1/D,E*=D,O*=D,h=Math.sin(n),p=Math.cos(n),c[0]=x*x*(v=1-p)+p,c[1]=E*x*v+O*h,c[2]=O*x*v-E*h,c[3]=0,c[4]=x*E*v-O*h,c[5]=E*E*v+p,c[6]=O*E*v+x*h,c[7]=0,c[8]=x*O*v+E*h,c[9]=E*O*v-x*h,c[10]=O*O*v+p,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}function Ge(c,n){var a=n[0],h=n[1],p=n[2],v=n[3],x=a+a,E=h+h,O=p+p,D=a*x,B=h*x,F=h*E,U=p*x,Z=p*E,Y=p*O,re=v*x,he=v*E,_e=v*O;return c[0]=1-F-Y,c[1]=B+_e,c[2]=U-he,c[3]=0,c[4]=B-_e,c[5]=1-D-Y,c[6]=Z+re,c[7]=0,c[8]=U+he,c[9]=Z-re,c[10]=1-D-F,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}Math.hypot||(Math.hypot=function(){for(var c=0,n=arguments.length;n--;)c+=arguments[n]*arguments[n];return Math.sqrt(c)});var Je=ce;function Ve(){var c=new M(3);return M!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function xt(c){var n=new M(3);return n[0]=c[0],n[1]=c[1],n[2]=c[2],n}function yt(c){return Math.hypot(c[0],c[1],c[2])}function ot(c,n,a){var h=new M(3);return h[0]=c,h[1]=n,h[2]=a,h}function zt(c,n,a){return c[0]=n[0]+a[0],c[1]=n[1]+a[1],c[2]=n[2]+a[2],c}function rt(c,n,a){return c[0]=n[0]-a[0],c[1]=n[1]-a[1],c[2]=n[2]-a[2],c}function Bt(c,n,a){return c[0]=n[0]*a[0],c[1]=n[1]*a[1],c[2]=n[2]*a[2],c}function Vt(c,n,a){return c[0]=Math.min(n[0],a[0]),c[1]=Math.min(n[1],a[1]),c[2]=Math.min(n[2],a[2]),c}function Ln(c,n,a){return c[0]=Math.max(n[0],a[0]),c[1]=Math.max(n[1],a[1]),c[2]=Math.max(n[2],a[2]),c}function $e(c,n,a){return c[0]=n[0]*a,c[1]=n[1]*a,c[2]=n[2]*a,c}function Pt(c,n,a,h){return c[0]=n[0]+a[0]*h,c[1]=n[1]+a[1]*h,c[2]=n[2]+a[2]*h,c}function $t(c,n){var a=n[0]-c[0],h=n[1]-c[1],p=n[2]-c[2];return a*a+h*h+p*p}function on(c){var n=c[0],a=c[1],h=c[2];return n*n+a*a+h*h}function An(c,n){return c[0]=-n[0],c[1]=-n[1],c[2]=-n[2],c}function ct(c,n){var a=n[0],h=n[1],p=n[2],v=a*a+h*h+p*p;return v>0&&(v=1/Math.sqrt(v)),c[0]=n[0]*v,c[1]=n[1]*v,c[2]=n[2]*v,c}function kt(c,n){return c[0]*n[0]+c[1]*n[1]+c[2]*n[2]}function In(c,n,a){var h=n[0],p=n[1],v=n[2],x=a[0],E=a[1],O=a[2];return c[0]=p*O-v*E,c[1]=v*x-h*O,c[2]=h*E-p*x,c}function ti(c,n,a,h){var p=n[0],v=n[1],x=n[2];return c[0]=p+h*(a[0]-p),c[1]=v+h*(a[1]-v),c[2]=x+h*(a[2]-x),c}function Dt(c,n,a){var h=n[0],p=n[1],v=n[2],x=a[3]*h+a[7]*p+a[11]*v+a[15];return c[0]=(a[0]*h+a[4]*p+a[8]*v+a[12])/(x=x||1),c[1]=(a[1]*h+a[5]*p+a[9]*v+a[13])/x,c[2]=(a[2]*h+a[6]*p+a[10]*v+a[14])/x,c}function jn(c,n,a){var h=n[0],p=n[1],v=n[2];return c[0]=h*a[0]+p*a[3]+v*a[6],c[1]=h*a[1]+p*a[4]+v*a[7],c[2]=h*a[2]+p*a[5]+v*a[8],c}function ai(c,n,a){var h=a[0],p=a[1],v=a[2],x=n[0],E=n[1],O=n[2],D=p*O-v*E,B=v*x-h*O,F=h*E-p*x,U=p*F-v*B,Z=v*D-h*F,Y=h*B-p*D,re=2*a[3];return B*=re,F*=re,Z*=2,Y*=2,c[0]=x+(D*=re)+(U*=2),c[1]=E+B+Z,c[2]=O+F+Y,c}function mn(c,n){return c[0]===n[0]&&c[1]===n[1]&&c[2]===n[2]}var ci=rt,Ii=Bt,Mi=yt;function Tr(){var c=new M(4);return M!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c}function kr(c,n,a){return c[0]=n[0]*a,c[1]=n[1]*a,c[2]=n[2]*a,c[3]=n[3]*a,c}function ja(c,n){var a=n[0],h=n[1],p=n[2],v=n[3],x=a*a+h*h+p*p+v*v;return x>0&&(x=1/Math.sqrt(x)),c[0]=a*x,c[1]=h*x,c[2]=p*x,c[3]=v*x,c}function Xr(c,n,a){var h=n[0],p=n[1],v=n[2],x=n[3];return c[0]=a[0]*h+a[4]*p+a[8]*v+a[12]*x,c[1]=a[1]*h+a[5]*p+a[9]*v+a[13]*x,c[2]=a[2]*h+a[6]*p+a[10]*v+a[14]*x,c[3]=a[3]*h+a[7]*p+a[11]*v+a[15]*x,c}function Yr(){var c=new M(4);return M!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function go(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function _a(c,n,a){a*=.5;var h=n[0],p=n[1],v=n[2],x=n[3],E=Math.sin(a),O=Math.cos(a);return c[0]=h*O+x*E,c[1]=p*O+v*E,c[2]=v*O-p*E,c[3]=x*O-h*E,c}function ya(c,n,a){a*=.5;var h=n[0],p=n[1],v=n[2],x=n[3],E=Math.sin(a),O=Math.cos(a);return c[0]=h*O-v*E,c[1]=p*O+x*E,c[2]=v*O+h*E,c[3]=x*O-p*E,c}Ve(),Tr();var aa,qs,Ho,Ar,Fa,Po=ja,bl=(aa=Ve(),qs=ot(1,0,0),Ho=ot(0,1,0),function(c,n,a){var h=kt(n,a);return h<-.999999?(In(aa,qs,n),Mi(aa)<1e-6&&In(aa,Ho,n),ct(aa,aa),function(p,v,x){x*=.5;var E=Math.sin(x);p[0]=E*v[0],p[1]=E*v[1],p[2]=E*v[2],p[3]=Math.cos(x)}(c,aa,Math.PI),c):h>.999999?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(In(aa,n,a),c[0]=aa[0],c[1]=aa[1],c[2]=aa[2],c[3]=1+h,Po(c,c))});function ro(){var c=new M(2);return M!=Float32Array&&(c[0]=0,c[1]=0),c}function Ea(c,n){var a=new M(2);return a[0]=c,a[1]=n,a}function Ua(c,n,a){return c[0]=n[0]+a[0],c[1]=n[1]+a[1],c}function Co(c,n,a){return c[0]=n[0]-a[0],c[1]=n[1]-a[1],c}function ea(c,n,a){return c[0]=n[0]*a,c[1]=n[1]*a,c}function Aa(c){return Math.hypot(c[0],c[1])}function Go(c,n){var a=n[0],h=n[1],p=a*a+h*h;return p>0&&(p=1/Math.sqrt(p)),c[0]=n[0]*p,c[1]=n[1]*p,c}function tr(c,n){return c[0]*n[0]+c[1]*n[1]}function Pa(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}Yr(),Yr(),j(),ro();var Is,ta,al=function(){if(Fa)return Ar;function c(n,a,h,p){this.cx=3*n,this.bx=3*(h-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=h,this.p2y=p}return Fa=1,Ar=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var h=n,p=0;p<8;p++){var v=this.sampleCurveX(h)-n;if(Math.abs(v)<a)return h;var x=this.sampleCurveDerivativeX(h);if(Math.abs(x)<1e-6)break;h-=v/x}var E=0,O=1;for(h=n,p=0;p<20&&(v=this.sampleCurveX(h),!(Math.abs(v-n)<a));p++)n>v?E=h:O=h,h=.5*(O-E)+E;return h},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},Ar}(),ls=Pa(al);function Ca(){if(ta)return Is;function c(n,a){this.x=n,this.y=a}return ta=1,Is=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,a){return this.clone()._rotateAround(n,a)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var a=n.x-this.x,h=n.y-this.y;return a*a+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,a){return Math.atan2(this.x*a-this.y*n,this.x*n+this.y*a)},_matMult:function(n){var a=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var a=Math.cos(n),h=Math.sin(n),p=h*this.x+a*this.y;return this.x=a*this.x-h*this.y,this.y=p,this},_rotateAround:function(n,a){var h=Math.cos(n),p=Math.sin(n),v=a.y+p*(this.x-a.x)+h*(this.y-a.y);return this.x=a.x+h*(this.x-a.x)-p*(this.y-a.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},Is}var hn=Pa(Ca());function vs(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let a=0;a<c.length;a++)if(!vs(c[a],n[a]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const a in c)if(!vs(c[a],n[a]))return!1;return!0}return c===n}const Ja=Math.PI/180,bt=180/Math.PI;function Tt(c){return c*Ja}function je(c){return c*bt}const ae=[[0,0],[1,0],[1,1],[0,1]];function ge(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,a=n*c;return 4*(c<.5?a:3*(c-n)+a-.75)}function Ee(c,n,a,h){const p=new ls(c,n,a,h);return function(v){return p.solve(v)}}const Ne=Ee(.25,.1,.25,1);function be(c,n,a){return Math.min(a,Math.max(n,c))}function We(c,n,a){return(a=be((a-c)/(n-c),0,1))*a*(3-2*a)}function nt(c,n,a){const h=a-n,p=((c-n)%h+h)%h+n;return p===n?a:p}function Xe(c,n,a){if(!c.length)return a(null,[]);let h=c.length;const p=new Array(c.length);let v=null;c.forEach((x,E)=>{n(x,(O,D)=>{O&&(v=O),p[E]=D,--h==0&&a(v,p)})})}function lt(c,...n){for(const a of n)for(const h in a)c[h]=a[h];return c}let gt=1;function ht(){return gt++}function Zt(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function vn(c,n){c.forEach(a=>{n[a]&&(n[a]=n[a].bind(n))})}function _n(c,n,a){const h={};for(const p in c)h[p]=n.call(this,c[p],p,c);return h}function zn(c,n,a){const h={};for(const p in c)n.call(this,c[p],p,c)&&(h[p]=c[p]);return h}function ii(c){return Array.isArray(c)?c.map(ii):typeof c=="object"&&c?_n(c,ii):c}function si(c,n){for(let a=0;a<c.length;a++)if(n.indexOf(c[a])>=0)return!0;return!1}const gi={};function ui(c){gi[c]||(typeof console<"u"&&console.warn(c),gi[c]=!0)}function Wi(c,n,a){return(a.y-c.y)*(n.x-c.x)>(n.y-c.y)*(a.x-c.x)}function _r(c){let n=0;for(let a,h,p=0,v=c.length,x=v-1;p<v;x=p++)a=c[p],h=c[x],n+=(h.x-a.x)*(a.y+h.y);return n}function ir([c,n,a]){const h=Tt(n+90),p=Tt(a);return{x:c*Math.cos(h)*Math.sin(p),y:c*Math.sin(h)*Math.sin(p),z:c*Math.cos(p),azimuthal:n,polar:a}}function ki(c){return(typeof self<"u"||c!==void 0)&&typeof WorkerGlobalScope<"u"&&(c!==void 0?c:self)instanceof WorkerGlobalScope}function Fi(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,p,v)=>{const x=p||v;return n[h]=!x||x.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n}let vi=null;function nr(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function rr(c,n,a,h){for(;n<a;){const p=n+a>>1;c[p]<h?n=p+1:a=p}return n}function Nr(c,n,a,h){for(;n<a;){const p=n+a>>1;c[p]<=h?n=p+1:a=p}return n}function Zo(c){return c>0?1/(1.001-c):1+c}function hr(c){return c>0?1-1/(1.001-c):-c}function Xi(c,n,a){return(c-n.min)*(a.max-a.min)/(n.max-n.min)+a.min}const or={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!or.API_URL)return null;try{const c=new URL(or.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v0.3.0.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Lo(c){return or.API_URL_REGEX.test(c)}function Hs(c){return or.API_SPRITE_REGEX.test(c)}let Ds,sl,cr,Kr,ll,So;function Bo(){return Ds==null&&(Ds=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ds}const xs={now:()=>Kr!==void 0?Kr:performance.now(),setNow(c){Kr=c},restoreNow(){Kr=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:a,height:h}=c;ll||(ll=document.createElement("canvas"));const p=ll.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(a>ll.width||h>ll.height)&&(ll.width=a,ll.height=h),p.clearRect(-n,-n,a+2*n,h+2*n),p.drawImage(c,0,0,a,h),p.getImageData(-n,-n,a+2*n,h+2*n)},resolveURL:c=>(sl||(sl=document.createElement("a")),sl.href=c,sl.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(cr==null&&(cr=window.matchMedia("(prefers-reduced-motion: reduce)")),cr.matches)},hasCanvasFingerprintNoise(){if(So!==void 0)return So;if(!Bo())return So=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let a=0;for(let p=0;p<c.width;++p)n.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,n.fillRect(p,0,1,1);const h=n.getImageData(0,0,c.width,c.height);a=0;for(let p=0;p<h.data.length;++p)if(p%4!=3&&a++!==h.data[p])return So=!0,!0;return So=!1,!1}};function va(c,n){const a=c.indexOf("?");if(a<0)return`${c}?${new URLSearchParams(n).toString()}`;const h=new URLSearchParams(c.slice(a));for(const p in n)h.set(p,n[p]);return`${c.slice(0,a)}?${h.toString()}`}function jo(c,n={persistentParams:[]}){const a=c.indexOf("?");if(a<0)return c;const h=new URLSearchParams,p=new URLSearchParams(c.slice(a));for(const x of n.persistentParams){const E=p.get(x);E&&h.set(x,E)}const v=h.toString();return`${c.slice(0,a)}${v.length>0?`?${v}`:""}`}const uo="mapbox-tiles";let ha=500,da=50;const wl=["language","worldview","jobid"];let bs,Gs;function cs(){try{return caches}catch{}}function us(){const c=cs();c&&bs==null&&(bs=c.open(uo))}let ic=1/0;const St={supported:!1,testSupport:function(c){!Zi&&Vn&&(yr?Ni(c):en=c)}};let en,Vn,Zi=!1,yr=!1;const na=typeof self<"u"?self:{};function Ni(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Vn),c.isContextLost())return;St.supported=!0}catch{}c.deleteTexture(n),Zi=!0}na.document&&(Vn=na.document.createElement("img"),Vn.onload=function(){en&&Ni(en),en=null,yr=!0},Vn.onerror=function(){Zi=!0,en=null},Vn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Sr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Sr);class ri extends Error{constructor(n,a,h){a===401&&Lo(h)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=a,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const zo=ki()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,hs=function(c,n){if(!(/^file:/.test(a=c.url)||/^file:/.test(zo())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,p){const v=new AbortController,x=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:zo(),referrerPolicy:h.referrerPolicy,signal:v.signal});let E=!1,O=!1;const D=(B=x.url).indexOf("sku=")>0&&Lo(B);var B;h.type==="json"&&x.headers.set("Accept","application/json");const F=(Z,Y,re)=>{if(O)return;if(Z&&Z.message!=="SecurityError"&&ui(Z.toString()),Y&&re)return U(Y);const he=Date.now();fetch(x).then(_e=>{if(_e.ok){const Se=D?_e.clone():null;return U(_e,Se,he)}return p(new ri(_e.statusText,_e.status,h.url))}).catch(_e=>{_e.name!=="AbortError"&&p(new Error(`${_e.message} ${h.url}`))})},U=(Z,Y,re)=>{(h.type==="arrayBuffer"?Z.arrayBuffer():h.type==="json"?Z.json():Z.text()).then(he=>{O||(Y&&re&&function(_e,Se,Ce){if(us(),bs==null)return;const le=Fi(Se.headers.get("Cache-Control")||"");if(le["no-store"])return;const Te={status:Se.status,statusText:Se.statusText,headers:new Headers};Se.headers.forEach((et,Ye)=>Te.headers.set(Ye,et)),le["max-age"]&&Te.headers.set("Expires",new Date(Ce+1e3*le["max-age"]).toUTCString());const Me=Te.headers.get("Expires");if(!Me||new Date(Me).getTime()-Ce<42e4)return;let Re=jo(_e.url,{persistentParams:wl});if(Se.status===206){const et=_e.headers.get("Range");if(!et)return;Te.status=200,Re=va(Re,{range:et})}(function(et,Ye){if(Gs===void 0)try{new Response(new ReadableStream),Gs=!0}catch{Gs=!1}Gs?Ye(et.body):et.blob().then(Ye).catch(it=>ui(it.message))})(Se,et=>{const Ye=new Response((it=Se.status)!==200&&it!==404&&[101,103,204,205,304].includes(it)?null:et,Te);var it;us(),bs?.then(dt=>dt.put(Re,Ye)).catch(dt=>ui(dt.message))})}(x,Y,re),E=!0,p(null,he,Z.headers.get("Cache-Control"),Z.headers.get("Expires")))}).catch(he=>{O||p(new Error(he.message))})};return D?function(Z,Y){if(us(),bs==null)return Y(null);bs.then(re=>{let he=jo(Z.url,{persistentParams:wl});const _e=Z.headers.get("Range");_e&&(he=va(he,{range:_e})),re.match(he).then(Se=>{const Ce=function(le){if(!le)return!1;const Te=new Date(le.headers.get("Expires")||0),Me=Fi(le.headers.get("Cache-Control")||"");return Number(Te)>Date.now()&&!Me["no-cache"]}(Se);re.delete(he).catch(Y),Ce&&re.put(he,Se.clone()).catch(Y),Y(null,Se,Ce)}).catch(Y)}).catch(Y)}(x,F):F(null,null),{cancel:()=>{O=!0,E||v.abort()}}}(c,n);if(ki(self)&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var a;return function(h,p){const v=new XMLHttpRequest;v.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const x in h.headers)v.setRequestHeader(x,h.headers[x]);return h.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=h.credentials==="include",v.onerror=()=>{p(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let x=v.response;if(h.type==="json")try{x=JSON.parse(v.response)}catch(E){return p(E)}p(null,x,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else p(new ri(v.statusText,v.status,h.url))},v.send(h.body),{cancel:()=>v.abort()}}(c,n)},ko=function(c,n){return hs(lt(c,{type:"arrayBuffer"}),n)};function Rs(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const ws="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Qa,Ma;Qa=[],Ma=0;const No=function(c,n){if(St.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Ma>=or.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Qa.push(v),v}Ma++;let a=!1;const h=()=>{if(!a)for(a=!0,Ma--;Qa.length&&Ma<or.MAX_PARALLEL_IMAGE_REQUESTS;){const v=Qa.shift(),{requestParameters:x,callback:E,cancelled:O}=v;O||(v.cancel=No(x,E).cancel)}},p=ko(c,(v,x,E,O)=>{h(),v?n(v):x&&(self.createImageBitmap?function(D,B){const F=new Blob([new Uint8Array(D)],{type:"image/png"});createImageBitmap(F).then(U=>{B(null,U)}).catch(U=>{B(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(D,B)=>n(D,B,E,O)):function(D,B){const F=new Image;F.onload=()=>{B(null,F),URL.revokeObjectURL(F.src),F.onload=null,requestAnimationFrame(()=>{F.src=ws})},F.onerror=()=>B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const U=new Blob([new Uint8Array(D)],{type:"image/png"});F.src=D.byteLength?URL.createObjectURL(U):ws}(x,(D,B)=>n(D,B,E,O)))});return{cancel:()=>{p.cancel(),h()}}};var Oa,Ts,Va,$a={exports:{}},Tl={exports:{}},st={exports:{}},Ut=function(){if(Va)return $a.exports;Va=1;var c=(Oa||(Oa=1,Tl.exports=function(a,h){var p,v,x,E,O,D,B,F;for(v=a.length-(p=3&a.length),x=h,O=3432918353,D=461845907,F=0;F<v;)B=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,x=27492+(65535&(E=5*(65535&(x=(x^=B=(65535&(B=(B=(65535&B)*O+(((B>>>16)*O&65535)<<16)&4294967295)<<15|B>>>17))*D+(((B>>>16)*D&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(B=0,p){case 3:B^=(255&a.charCodeAt(F+2))<<16;case 2:B^=(255&a.charCodeAt(F+1))<<8;case 1:x^=B=(65535&(B=(B=(65535&(B^=255&a.charCodeAt(F)))*O+(((B>>>16)*O&65535)<<16)&4294967295)<<15|B>>>17))*D+(((B>>>16)*D&65535)<<16)&4294967295}return x^=a.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),Tl.exports),n=(Ts||(Ts=1,st.exports=function(a,h){for(var p,v=a.length,x=h^v,E=0;v>=4;)p=1540483477*(65535&(p=255&a.charCodeAt(E)|(255&a.charCodeAt(++E))<<8|(255&a.charCodeAt(++E))<<16|(255&a.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),v-=4,++E;switch(v){case 3:x^=(255&a.charCodeAt(E+2))<<16;case 2:x^=(255&a.charCodeAt(E+1))<<8;case 1:x=1540483477*(65535&(x^=255&a.charCodeAt(E)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),st.exports);return $a.exports=c,$a.exports.murmur3=c,$a.exports.murmur2=n,$a.exports}(),kn=Pa(Ut);class qn{constructor(n,...a){lt(this,a[0]||{}),this.type=n}}class oo extends qn{constructor(n,a={}){super("error",lt({error:n},a))}}function Ui(c,n,a){a[c]&&a[c].indexOf(n)!==-1||(a[c]=a[c]||[],a[c].push(n))}function _o(c,n,a){if(a&&a[c]){const h=a[c].indexOf(n);h!==-1&&a[c].splice(h,1)}}class Fo{on(n,a){return this._listeners=this._listeners||{},Ui(n,a,this._listeners),this}off(n,a){return _o(n,a,this._listeners),_o(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ui(n,a,this._oneTimeListeners),this):new Promise(h=>{this.once(n,h)})}fire(n,a){const h=typeof n=="string"?new qn(n,a):n,p=h.type;if(this.listens(p)){h.target=this;const v=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const O of v)O.call(this,h);const x=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const O of x)_o(p,O,this._oneTimeListeners),O.call(this,h);const E=this._eventedParent;E&&(lt(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(h))}else h instanceof oo&&console.error(h.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}class yo{constructor(n){typeof n=="string"?this.name=n:(this.name=n.name,this.iconsetId=n.iconsetId)}static from(n){return new yo(n)}static toString(n){return n.iconsetId?`${n.name}${n.iconsetId}`:n.name}static parse(n){const[a,h]=n.split("");return new yo({name:a,iconsetId:h})}static isEqual(n,a){return n.name===a.name&&n.iconsetId===a.iconsetId}toString(){return yo.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Mo,xa={},qa=function(){if(Mo)return xa;Mo=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(v){return(v=Math.round(v))<0?0:v>255?255:v}function a(v){return n(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function h(v){return(x=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:x>1?1:x;var x}function p(v,x,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?v+(x-v)*E*6:2*E<1?x:3*E<2?v+(x-v)*(2/3-E)*6:v}try{xa.parseCSSColor=function(v){var x,E=v.replace(/ /g,"").toLowerCase();if(E in c)return c[E].slice();if(E[0]==="#")return E.length===4?(x=parseInt(E.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:E.length===7&&(x=parseInt(E.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var O=E.indexOf("("),D=E.indexOf(")");if(O!==-1&&D+1===E.length){var B=E.substr(0,O),F=E.substr(O+1,D-(O+1)).split(","),U=1;switch(B){case"rgba":if(F.length!==4)return null;U=h(F.pop());case"rgb":return F.length!==3?null:[a(F[0]),a(F[1]),a(F[2]),U];case"hsla":if(F.length!==4)return null;U=h(F.pop());case"hsl":if(F.length!==3)return null;var Z=(parseFloat(F[0])%360+360)%360/360,Y=h(F[1]),re=h(F[2]),he=re<=.5?re*(Y+1):re+Y-re*Y,_e=2*re-he;return[n(255*p(_e,he,Z+1/3)),n(255*p(_e,he,Z)),n(255*p(_e,he,Z-1/3)),U];default:return null}}return null}}catch{}return xa}();class Di{constructor(n,a,h,p=1){this.r=n,this.g=a,this.b=h,this.a=p}static parse(n){if(!n)return;if(n instanceof Di)return n;if(typeof n!="string")return;const a=qa.parseCSSColor(n);return a?new Di(a[0]/255,a[1]/255,a[2]/255,a[3]):void 0}toString(){const[n,a,h,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*a)},${Math.round(255*h)},${p})`}toNonPremultipliedRenderColor(n){const{r:a,g:h,b:p,a:v}=this;return new Ls(n,a,h,p,v)}toPremultipliedRenderColor(n){const{r:a,g:h,b:p,a:v}=this;return new Rl(n,a*v,h*v,p*v,v)}clone(){return new Di(this.r,this.g,this.b,this.a)}}class sa{constructor(n,a,h,p,v,x=!1){if(this.premultiplied=!1,this.premultiplied=x,n){const E=n.image.height,O=E*E;this.premultiplied?(a=v===0?0:a/v*(E-1),h=v===0?0:h/v*(E-1),p=v===0?0:p/v*(E-1)):(a*=E-1,h*=E-1,p*=E-1);const D=Math.floor(a),B=Math.floor(h),F=Math.floor(p),U=Math.ceil(a),Z=Math.ceil(h),Y=Math.ceil(p),re=a-D,he=h-B,_e=p-F,Se=n.image.data,Ce=4*(D+B*O+F*E),le=4*(D+B*O+Y*E),Te=4*(D+Z*O+F*E),Me=4*(D+Z*O+Y*E),Re=4*(U+B*O+F*E),et=4*(U+B*O+Y*E),Ye=4*(U+Z*O+F*E),it=4*(U+Z*O+Y*E);if(Ce<0||it>=Se.length)throw new Error("out of range");this.r=Xn(Xn(Xn(Se[Ce],Se[le],_e),Xn(Se[Te],Se[Me],_e),he),Xn(Xn(Se[Re],Se[et],_e),Xn(Se[Ye],Se[it],_e),he),re)/255*(this.premultiplied?v:1),this.g=Xn(Xn(Xn(Se[Ce+1],Se[le+1],_e),Xn(Se[Te+1],Se[Me+1],_e),he),Xn(Xn(Se[Re+1],Se[et+1],_e),Xn(Se[Ye+1],Se[it+1],_e),he),re)/255*(this.premultiplied?v:1),this.b=Xn(Xn(Xn(Se[Ce+2],Se[le+2],_e),Xn(Se[Te+2],Se[Me+2],_e),he),Xn(Xn(Se[Re+2],Se[et+2],_e),Xn(Se[Ye+2],Se[it+2],_e),he),re)/255*(this.premultiplied?v:1),this.a=v}else this.r=a,this.g=h,this.b=p,this.a=v}toArray(){const{r:n,g:a,b:h,a:p}=this;return[255*n,255*a,255*h,p]}toHslaArray(){let{r:n,g:a,b:h,a:p}=this;if(this.premultiplied){if(p===0)return[0,0,0,0];n/=p,a/=p,h/=p}const v=Math.min(Math.max(n,0),1),x=Math.min(Math.max(a,0),1),E=Math.min(Math.max(h,0),1),O=Math.min(v,x,E),D=Math.max(v,x,E),B=(O+D)/2;if(O===D)return[0,0,100*B,p];const F=D-O,U=B>.5?F/(2-D-O):F/(D+O);let Z=0;return D===v?Z=(x-E)/F+(x<E?6:0):D===x?Z=(E-v)/F+2:D===E&&(Z=(v-x)/F+4),Z*=60,[Math.min(Math.max(Z,0),360),Math.min(Math.max(100*U,0),100),Math.min(Math.max(100*B,0),100),p]}toArray01(){const{r:n,g:a,b:h,a:p}=this;return[n,a,h,p]}toArray01Scaled(n){const{r:a,g:h,b:p}=this;return[a*n,h*n,p*n]}toArray01Linear(){const{r:n,g:a,b:h,a:p}=this;return[Math.pow(n,2.2),Math.pow(a,2.2),Math.pow(h,2.2),p]}}class Ls extends sa{constructor(n,a,h,p,v){super(n,a,h,p,v,!1)}}class Rl extends sa{constructor(n,a,h,p,v){super(n,a,h,p,v,!0)}}function Xn(c,n,a){return c*(1-a)+n*a}function Ll(c,n,a){return c.map((h,p)=>Xn(h,n[p],a))}Di.black=new Di(0,0,0,1),Di.white=new Di(1,1,1,1),Di.transparent=new Di(0,0,0,0),Di.red=new Di(1,0,0,1),Di.blue=new Di(0,0,1,1);var kc=Object.freeze({__proto__:null,array:Ll,color:function(c,n,a){return new Di(Xn(c.r,n.r,a),Xn(c.g,n.g,a),Xn(c.b,n.b,a),Xn(c.a,n.a,a))},number:Xn});function es(c,...n){for(const a of n)for(const h in a)c[h]=a[h];return c}class ts extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class Oh{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[h,p]of a)this.bindings[h]=p}concat(n){return new Oh(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const cu={kind:"null"},Jn={kind:"number"},Er={kind:"string"},dr={kind:"boolean"},cl={kind:"color"},Nc={kind:"object"},vr={kind:"value"},_f={kind:"collator"},Ih={kind:"formatted"},Dh={kind:"resolvedImage"};function ns(c,n){return{kind:"array",itemType:c,N:n}}function Eo(c){if(c.kind==="array"){const n=Eo(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const Fg=[cu,Jn,Er,dr,cl,Ih,Nc,ns(vr),Dh];function zl(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!zl(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const a of Fg)if(!zl(a,n))return null}}return`Expected ${Eo(c)} but found ${Eo(n)} instead.`}function fa(c,n){return n.some(a=>a.kind===c.kind)}function Rh(c,n){return n.some(a=>a==="null"?c===null:a==="array"?Array.isArray(c):a==="object"?c&&!Array.isArray(c)&&typeof c=="object":a===typeof c)}function Lh(c,n){return c.kind==="array"&&n.kind==="array"?c.N===n.N&&Lh(c.itemType,n.itemType):c.kind===n.kind}class zh{constructor(n,a,h){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yu{constructor(n,a,h,p,v){this.text=n.normalize?n.normalize():n,this.image=a,this.scale=h,this.fontStack=p,this.textColor=v}}class is{constructor(n){this.sections=n}static fromString(n){return new is([new Yu(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||!!n.image&&n.image.hasPrimary())}static factory(n){return n instanceof is?n:is.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const a of this.sections){if(a.image){const p=a.image.getPrimary().id.toString();n.push(["image",p]);continue}n.push(a.text);const h={};a.fontStack&&(h["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(h["font-scale"]=a.scale),a.textColor&&(h["text-color"]=["rgba"].concat(a.textColor.toNonPremultipliedRenderColor(null).toArray())),n.push(h)}return n}}class rc{constructor(n,a={}){if(this.id=yo.from(n),this.options=Object.assign({},a),a.transform){const{a:h,b:p,c:v,d:x,e:E,f:O}=a.transform;this.options.transform=new DOMMatrix([h,p,v,x,E,O])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:n,b:a,c:h,d:p,e:v,f:x}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:n,b:a,c:h,d:p,e:v,f:x}})}static parse(n){let a,h,p,v;try{({name:a,iconsetId:h,params:p,transform:v}=JSON.parse(n)||{})}catch{return null}if(!a)return null;const{a:x,b:E,c:O,d:D,e:B,f:F}=v||{};return new rc({name:a,iconsetId:h},{params:p,transform:new DOMMatrix([x,E,O,D,B,F])})}scaleSelf(n,a){return this.options.transform.scaleSelf(n,a),this}}class Ha{constructor(n,a,h,p,v=!1){this.primaryId=yo.from(n),this.primaryOptions=a,h&&(this.secondaryId=yo.from(h)),this.secondaryOptions=p,this.available=v}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new rc(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new rc(this.secondaryId,this.secondaryOptions):null}static from(n){return typeof n=="string"?Ha.build({name:n}):n}static build(n,a,h,p){return!n||typeof n=="object"&&!("name"in n)?null:new Ha(n,h,a,p)}}function uu(c,n,a,h){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[c,n,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[c,n,a,h]:[c,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ri(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Di||c instanceof zh||c instanceof is||c instanceof Ha)return!0;if(Array.isArray(c)){for(const n of c)if(!Ri(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Ri(c[n]))return!1;return!0}return!1}function Tn(c){if(c===null)return cu;if(typeof c=="string")return Er;if(typeof c=="boolean")return dr;if(typeof c=="number")return Jn;if(c instanceof Di)return cl;if(c instanceof zh)return _f;if(c instanceof is)return Ih;if(c instanceof Ha)return Dh;if(Array.isArray(c)){const n=c.length;let a;for(const h of c){const p=Tn(h);if(a){if(a===p)continue;a=vr;break}a=p}return ns(a||vr,n)}return Nc}function ds(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof is||c instanceof Ha||c instanceof Di?c.toString():JSON.stringify(c)}class di{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Ri(n[1]))return a.error("invalid value");const h=n[1];let p=Tn(h);const v=a.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new di(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Di?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof is?this.value.serialize():this.value}}class Vr{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Bc={string:Er,number:Jn,boolean:dr,object:Nc};class li{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let h,p=1;const v=n[0];if(v==="array"){let E,O;if(n.length>2){const D=n[1];if(typeof D!="string"||!(D in Bc)||D==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);E=Bc[D],p++}else E=vr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);O=n[2],p++}h=ns(E,O)}else h=Bc[v];const x=[];for(;p<n.length;p++){const E=a.parse(n[p],p,vr);if(!E)return null;x.push(E)}return new li(h,x)}evaluate(n){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(n);if(!zl(this.type,Tn(h)))return h;if(a===this.args.length-1)throw new Vr(`The expression ${JSON.stringify(this.args[a].serialize())} evaluated to ${Eo(Tn(h))} but was expected to be of type ${Eo(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,a=[n.kind];if(n.kind==="array"){const h=n.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){a.push(h.kind);const p=n.N;(typeof p=="number"||this.args.length>1)&&a.push(p)}}return a.concat(this.args.map(h=>h.serialize()))}}class jc{constructor(n){this.type=Ih,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const h=n[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const p=[];let v=!1;for(let x=1;x<=n.length-1;++x){const E=n[x];if(v&&typeof E=="object"&&!Array.isArray(E)){v=!1;let O=null;if(E["font-scale"]&&(O=a.parseObjectValue(E["font-scale"],x,"font-scale",Jn),!O))return null;let D=null;if(E["text-font"]&&(D=a.parseObjectValue(E["text-font"],x,"text-font",ns(Er)),!D))return null;let B=null;if(E["text-color"]&&(B=a.parseObjectValue(E["text-color"],x,"text-color",cl),!B))return null;const F=p[p.length-1];F.scale=O,F.font=D,F.textColor=B}else{const O=a.parse(n[x],x,vr);if(!O)return null;const D=O.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:O,scale:null,font:null,textColor:null})}}return new jc(p)}evaluate(n){return new is(this.sections.map(a=>{const h=a.content.evaluate(n);return Lh(Tn(h),Dh)?new Yu("",h,null,null,null):new Yu(ds(h),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const a of this.sections){n.push(a.content.serialize());const h={};a.scale&&(h["font-scale"]=a.scale.serialize()),a.font&&(h["text-font"]=a.font.serialize()),a.textColor&&(h["text-color"]=a.textColor.serialize()),n.push(h)}return n}}class Zl{constructor(n,a,h,p){this._imageWarnHistory={},this.type=Dh,this.namePrimary=n,this.nameSecondary=a,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(n,a){if(n.length<2)return a.error("Expected two or more arguments.");let h=1;const p=[];function v(){if(h<n.length){const E=a.parse(n[h],h++,Er);return E?(p.push({image:E,options:{}}),!0):(a.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function x(){if(h<n.length){const O=n[h];if((E=O)===null||typeof E!="object"||Array.isArray(E))return!0;const D=O.params,B=O.iconset,F=a.concat(h);if(!D&&!B)return h++,!0;if(D){if(typeof D!="object"||D.constructor!==Object)return F.error('Image options "params" should be an object'),!1;const U={},Z=F.concat(void 0,"params");for(const Y in D){if(!Y)return Z.error("Image parameter name should be non-empty"),!1;const re=Z.concat(void 0,Y).parse(D[Y],void 0,cl,void 0,{typeAnnotation:"coerce"});if(!re)return!1;U[Y]=re}p[p.length-1].options.params=U}if(B){if(typeof B!="object"||B.constructor!==Object)return F.error('Image options "iconset" should be an object'),!1;if(!B.id)return F.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=B}return h++,!0}var E;return!0}for(let E=0;E<2;E++)if(!v()||!x())return;return new Zl(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(n,a){const h={};if(a){for(const p in a)if(a[p])try{h[p]=a[p].evaluate(n)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(n){const a={name:this.namePrimary.evaluate(n),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(n),iconsetId:this.iconsetIdSecondary}:void 0,p=Ha.build(a,h,this.paramsPrimary?this.evaluateParams(n,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(n,this.paramsSecondary):void 0);if(p&&n.availableImages){const v=p.getPrimary().id;if(p.available=n.availableImages.some(x=>yo.isEqual(x,v)),p.available){const x=p.getSecondary()?p.getSecondary().id:null;x&&(p.available=n.availableImages.some(E=>yo.isEqual(E,x)))}}return p}eachChild(n){if(n(this.namePrimary),this.paramsPrimary)for(const a in this.paramsPrimary)this.paramsPrimary[a]&&n(this.paramsPrimary[a]);if(this.nameSecondary&&(n(this.nameSecondary),this.paramsSecondary))for(const a in this.paramsSecondary)this.paramsSecondary[a]&&n(this.paramsSecondary[a])}outputDefined(){return!1}serializeOptions(n,a){const h={};if(a&&(h.iconset={id:a}),n){h.params={};for(const p in n)n[p]&&(h.params[p]=n[p].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const n=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const a=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);a&&n.push(a)}if(this.nameSecondary&&(n.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const a=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);a&&n.push(a)}return n}}function oc(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Ku={"to-boolean":dr,"to-color":cl,"to-number":Jn,"to-string":Er};class ul{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const h=n[0],p=[];let v=cu;if(h==="to-array"){if(!Array.isArray(n[1]))return null;const x=n[1].length;if(a.expectedType){if(a.expectedType.kind!=="array")return a.error(`Expected ${a.expectedType.kind} but found array.`);v=ns(a.expectedType.itemType,x)}else{if(!(x>0&&Ri(n[1][0])))return null;v=ns(Tn(n[1][0]),x)}for(let E=0;E<x;E++){const O=n[1][E];let D;if(oc(O)==="array")D=a.parse(O,void 0,v.itemType);else{const B=oc(O);if(B!==v.itemType.kind)return a.error(`Expected ${v.itemType.kind} but found ${B}.`);D=a.registry.literal.parse(["literal",O===void 0?null:O],a)}if(!D)return null;p.push(D)}}else{if((h==="to-boolean"||h==="to-string")&&n.length!==2)return a.error("Expected one argument.");v=Ku[h];for(let x=1;x<n.length;x++){const E=a.parse(n[x],x,vr);if(!E)return null;p.push(E)}}return new ul(v,p)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let a,h;for(const p of this.args){if(a=p.evaluate(n),h=null,a instanceof Di)return a;if(typeof a=="string"){const v=n.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:uu(a[0],a[1],a[2],a[3]),!h))return new Di(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Vr(h||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const h of this.args){if(a=h.evaluate(n),a===null)return 0;const p=Number(a);if(!isNaN(p))return p}throw new Vr(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?is.fromString(ds(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Ha.build(ds(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(a=>a.evaluate(n)):ds(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new jc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Zl(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{n.push(a.serialize())}),n}}const la=["Unknown","Point","LineString","Polygon"];class Fc{constructor(n,a){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=a}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?la[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:h,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*a-n[0])+this.featureDistanceData.bearing[1]*(p*a-n[1])}return 0}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=Di.parse(n)),a}getConfig(n){return this.options?this.options.get(n):null}}class Ia{constructor(n,a,h,p,v){this.name=n,this.type=a,this._evaluate=h,this.args=p,this._overloadIndex=v}evaluate(n){if(!this._evaluate){const a=Ia.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,a){const h=n[0],p=Ia.definitions[h];if(!p)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=[];let O=null,D=-1;for(const[B,F]of x){if(Array.isArray(B)&&B.length!==n.length-1)continue;E.push(B),D++,O=new Id(a.registry,a.path,null,a.scope,void 0,a._scope,a.options);const U=[];let Z=!1;for(let Y=1;Y<n.length;Y++){const re=n[Y],he=Array.isArray(B)?B[Y-1]:B.type,_e=O.parse(re,1+U.length,he);if(!_e){Z=!0;break}U.push(_e)}if(!Z)if(Array.isArray(B)&&B.length!==U.length)O.error(`Expected ${B.length} arguments, but found ${U.length} instead.`);else{for(let Y=0;Y<U.length;Y++){const re=Array.isArray(B)?B[Y]:B.type,he=U[Y];O.concat(Y+1).checkSubtype(re,he.type)}if(O.errors.length===0)return new Ia(h,v,F,U,D)}}if(E.length===1)a.errors.push(...O.errors);else{const B=(E.length?E:x.map(([U])=>U)).map(Ad).join(" | "),F=[];for(let U=1;U<n.length;U++){const Z=a.parse(n[U],1+F.length);if(!Z)return null;F.push(Eo(Z.type))}a.error(`Expected arguments of type ${B}, but found (${F.join(", ")}) instead.`)}return null}static register(n,a){Ia.definitions=a;for(const h in a)n[h]=Ia}}function Ad(c){return Array.isArray(c)?`(${c.map(Eo).join(", ")})`:`(${Eo(c.type)}...)`}class ac{constructor(n,a,h){this.type=_f,this.locale=h,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const h=n[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const p=h["case-sensitive"]===void 0?a.parse(!1,1,dr):a.parseObjectValue(h["case-sensitive"],1,"case-sensitive",dr);if(!p)return null;const v=h["diacritic-sensitive"]===void 0?a.parse(!1,1,dr):a.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",dr);if(!v)return null;let x=null;return h.locale&&(x=a.parseObjectValue(h.locale,1,"locale",Er),!x)?null:new ac(p,v,x)}evaluate(n){return new zh(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function ia(c,n,a=0,h=c.length-1,p=kh){for(;h>a;){if(h-a>600){const O=h-a+1,D=n-a+1,B=Math.log(O),F=.5*Math.exp(2*B/3),U=.5*Math.sqrt(B*F*(O-F)/O)*(D-O/2<0?-1:1);ia(c,n,Math.max(a,Math.floor(n-D*F/O+U)),Math.min(h,Math.floor(n+(O-D)*F/O+U)),p)}const v=c[n];let x=a,E=h;for(Pd(c,a,n),p(c[h],v)>0&&Pd(c,a,h);x<E;){for(Pd(c,x,E),x++,E--;p(c[x],v)<0;)x++;for(;p(c[E],v)>0;)E--}p(c[a],v)===0?Pd(c,a,E):(E++,Pd(c,E,h)),E<=n&&(a=E+1),n<=E&&(h=E-1)}}function Pd(c,n,a){const h=c[n];c[n]=c[a],c[a]=h}function kh(c,n){return c<n?-1:c>n?1:0}function Sl(c){let n=0;for(let a,h,p=0,v=c.length,x=v-1;p<v;x=p++)a=c[p],h=c[x],n+=(h.x-a.x)*(a.y+h.y);return n}function Ga(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function sc(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function Uc(c,n,a){const h=c[0]-n[0],p=c[1]-n[1],v=c[0]-a[0],x=c[1]-a[1];return h*x-v*p==0&&h*v<=0&&p*x<=0}function Vc(c,n,a=!1){let h=!1;for(let E=0,O=n.length;E<O;E++){const D=n[E];for(let B=0,F=D.length,U=F-1;B<F;U=B++){const Z=D[U],Y=D[B];if(Uc(c,Z,Y))return a;(v=Z)[1]>(p=c)[1]!=(x=Y)[1]>p[1]&&p[0]<(x[0]-v[0])*(p[1]-v[1])/(x[1]-v[1])+v[0]&&(h=!h)}}var p,v,x;return h}function Nh(c,n,a,h){const p=h[0]-a[0],v=h[1]-a[1],x=(c[0]-a[0])*v-p*(c[1]-a[1]),E=(n[0]-a[0])*v-p*(n[1]-a[1]);return x>0&&E<0||x<0&&E>0}function hu(c,n,a,h){return(p=[h[0]-a[0],h[1]-a[1]])[0]*(v=[n[0]-c[0],n[1]-c[1]])[1]-p[1]*v[0]!=0&&!(!Nh(c,n,a,h)||!Nh(a,h,c,n));var p,v}function Bh(c){const n=new hn(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),a=new hn(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of c[0])n.x>h.x&&(n.x=h.x),n.y>h.y&&(n.y=h.y),a.x<h.x&&(a.x=h.x),a.y<h.y&&(a.y=h.y);return{min:n,max:a}}const rs=8192;function jh(c,n){const a=(180+c[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(a*p*rs),Math.round(h*p*rs)]}function Ju(c,n){for(let a=0;a<n.length;a++)if(Vc(c,n[a]))return!0;return!1}function Cd(c,n,a){for(const h of a)for(let p=0,v=h.length,x=v-1;p<v;x=p++)if(hu(c,n,h[x],h[p]))return!0;return!1}function gp(c,n){for(let a=0;a<c.length;++a)if(!Vc(c[a],n))return!1;for(let a=0;a<c.length-1;++a)if(Cd(c[a],c[a+1],n))return!1;return!0}function zs(c,n){for(let a=0;a<n.length;a++)if(gp(c,n[a]))return!0;return!1}function du(c,n,a){const h=[];for(let p=0;p<c.length;p++){const v=[];for(let x=0;x<c[p].length;x++){const E=jh(c[p][x],a);Ga(n,E),v.push(E)}h.push(v)}return h}function Md(c,n,a){const h=[];for(let p=0;p<c.length;p++){const v=du(c[p],n,a);h.push(v)}return h}function Od(c,n,a,h){if(c[0]<a[0]||c[0]>a[2]){const p=.5*h;let v=c[0]-a[0]>p?-h:a[0]-c[0]>p?h:0;v===0&&(v=c[0]-a[2]>p?-h:a[2]-c[0]>p?h:0),c[0]+=v}Ga(n,c)}function lc(c,n,a,h){const p=Math.pow(2,h.z)*rs,v=[h.x*rs,h.y*rs],x=[];if(!c)return x;for(const E of c)for(const O of E){const D=[O.x+v[0],O.y+v[1]];Od(D,n,a,p),x.push(D)}return x}function yf(c,n,a,h){const p=Math.pow(2,h.z)*rs,v=[h.x*rs,h.y*rs],x=[];if(!c)return x;for(const O of c){const D=[];for(const B of O){const F=[B.x+v[0],B.y+v[1]];Ga(n,F),D.push(F)}x.push(D)}if(n[2]-n[0]<=p/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const O of x)for(const D of O)Od(D,n,a,p)}var E;return x}class Uo{constructor(n,a){this.type=dr,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ri(n[1])){const h=n[1];if(h.type==="FeatureCollection")for(let p=0;p<h.features.length;++p){const v=h.features[p].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Uo(h,h.features[p].geometry)}else if(h.type==="Feature"){const p=h.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Uo(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Uo(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,h){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const E=du(h.coordinates,v,x),O=lc(a.geometry(),p,v,x);if(!sc(p,v))return!1;for(const D of O)if(!Vc(D,E))return!1}if(h.type==="MultiPolygon"){const E=Md(h.coordinates,v,x),O=lc(a.geometry(),p,v,x);if(!sc(p,v))return!1;for(const D of O)if(!Ju(D,E))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,h){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const E=du(h.coordinates,v,x),O=yf(a.geometry(),p,v,x);if(!sc(p,v))return!1;for(const D of O)if(!gp(D,E))return!1}if(h.type==="MultiPolygon"){const E=Md(h.coordinates,v,x),O=yf(a.geometry(),p,v,x);if(!sc(p,v))return!1;for(const D of O)if(!zs(D,E))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const $c={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},_p=1/298.257223563,Fh=_p*(2-_p),Uh=Math.PI/180;class fu{static fromTile(n,a,h){const p=Math.PI*(1-2*(n+.5)/Math.pow(2,a)),v=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/Uh;return new fu(v,h)}static get units(){return $c}constructor(n,a){if(n===void 0)throw new Error("No latitude given.");if(a&&!$c[a])throw new Error(`Unknown unit ${a}. Use one of: ${Object.keys($c).join(", ")}`);const h=6378.137*Uh*(a?$c[a]:1),p=Math.cos(n*Uh),v=1/(1-Fh*(1-p*p)),x=Math.sqrt(v);this.kx=h*x*p,this.ky=h*x*v*(1-Fh)}distance(n,a){const h=pa(n[0]-a[0])*this.kx,p=(n[1]-a[1])*this.ky;return Math.sqrt(h*h+p*p)}bearing(n,a){const h=pa(a[0]-n[0])*this.kx;return Math.atan2(h,(a[1]-n[1])*this.ky)/Uh}destination(n,a,h){const p=h*Uh;return this.offset(n,Math.sin(p)*a,Math.cos(p)*a)}offset(n,a,h){return[n[0]+a/this.kx,n[1]+h/this.ky]}lineDistance(n){let a=0;for(let h=0;h<n.length-1;h++)a+=this.distance(n[h],n[h+1]);return a}area(n){let a=0;for(let h=0;h<n.length;h++){const p=n[h];for(let v=0,x=p.length,E=x-1;v<x;E=v++)a+=pa(p[v][0]-p[E][0])*(p[v][1]+p[E][1])*(h?-1:1)}return Math.abs(a)/2*this.kx*this.ky}along(n,a){let h=0;if(a<=0)return n[0];for(let p=0;p<n.length-1;p++){const v=n[p],x=n[p+1],E=this.distance(v,x);if(h+=E,h>a)return cc(v,x,(a-(h-E))/E)}return n[n.length-1]}pointToSegmentDistance(n,a,h){let[p,v]=a,x=pa(h[0]-p)*this.kx,E=(h[1]-v)*this.ky;if(x!==0||E!==0){const O=(pa(n[0]-p)*this.kx*x+(n[1]-v)*this.ky*E)/(x*x+E*E);O>1?(p=h[0],v=h[1]):O>0&&(p+=x/this.kx*O,v+=E/this.ky*O)}return x=pa(n[0]-p)*this.kx,E=(n[1]-v)*this.ky,Math.sqrt(x*x+E*E)}pointOnLine(n,a){let h=1/0,p=n[0][0],v=n[0][1],x=0,E=0;for(let O=0;O<n.length-1;O++){let D=n[O][0],B=n[O][1],F=pa(n[O+1][0]-D)*this.kx,U=(n[O+1][1]-B)*this.ky,Z=0;F===0&&U===0||(Z=(pa(a[0]-D)*this.kx*F+(a[1]-B)*this.ky*U)/(F*F+U*U),Z>1?(D=n[O+1][0],B=n[O+1][1]):Z>0&&(D+=F/this.kx*Z,B+=U/this.ky*Z)),F=pa(a[0]-D)*this.kx,U=(a[1]-B)*this.ky;const Y=F*F+U*U;Y<h&&(h=Y,p=D,v=B,x=O,E=Z)}return{point:[p,v],index:x,t:Math.max(0,Math.min(1,E))}}lineSlice(n,a,h){let p=this.pointOnLine(h,n),v=this.pointOnLine(h,a);if(p.index>v.index||p.index===v.index&&p.t>v.t){const D=p;p=v,v=D}const x=[p.point],E=p.index+1,O=v.index;!vf(h[E],x[0])&&E<=O&&x.push(h[E]);for(let D=E+1;D<=O;D++)x.push(h[D]);return vf(h[O],v.point)||x.push(v.point),x}lineSliceAlong(n,a,h){let p=0;const v=[];for(let x=0;x<h.length-1;x++){const E=h[x],O=h[x+1],D=this.distance(E,O);if(p+=D,p>n&&v.length===0&&v.push(cc(E,O,(n-(p-D))/D)),p>=a)return v.push(cc(E,O,(a-(p-D))/D)),v;p>n&&v.push(O)}return v}bufferPoint(n,a){const h=a/this.ky,p=a/this.kx;return[n[0]-p,n[1]-h,n[0]+p,n[1]+h]}bufferBBox(n,a){const h=a/this.ky,p=a/this.kx;return[n[0]-p,n[1]-h,n[2]+p,n[3]+h]}insideBBox(n,a){return pa(n[0]-a[0])>=0&&pa(n[0]-a[2])<=0&&n[1]>=a[1]&&n[1]<=a[3]}}function vf(c,n){return c[0]===n[0]&&c[1]===n[1]}function cc(c,n,a){const h=pa(n[0]-c[0]);return[c[0]+h*a,c[1]+(n[1]-c[1])*a]}function pa(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class uc{constructor(n=[],a=(h,p)=>h<p?-1:h>p?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:h}=this,p=a[n];for(;n>0;){const v=n-1>>1,x=a[v];if(h(p,x)>=0)break;a[n]=x,n=v}a[n]=p}_down(n){const{data:a,compare:h}=this,p=this.length>>1,v=a[n];for(;n<p;){let x=1+(n<<1);const E=x+1;if(E<this.length&&h(a[E],a[x])<0&&(x=E),h(a[x],v)>=0)break;a[n]=a[x],n=x}a[n]=v}}var fn=8192;function Zs(c,n){return n.dist-c.dist}const Wl=100,ks=50;function qc(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==c[a])return!1;return!0}function Hc(c){return c[1]-c[0]+1}function Ns(c,n){const a=c[1]>=c[0]&&c[1]<n;return a||console.warn("Distance Expression: Index is out of range"),a}function Gc(c,n){if(c[0]>c[1])return[null,null];const a=Hc(c);if(n){if(a===2)return[c,null];const h=Math.floor(a/2);return[[c[0],c[0]+h],[c[0]+h,c[1]]]}{if(a===1)return[c,null];const h=Math.floor(a/2)-1;return[[c[0],c[0]+h],[c[0]+h+1,c[1]]]}}function Bs(c,n){const a=[1/0,1/0,-1/0,-1/0];if(!Ns(n,c.length))return a;for(let h=n[0];h<=n[1];++h)Ga(a,c[h]);return a}function Oi(c){const n=[1/0,1/0,-1/0,-1/0];for(let a=0;a<c.length;++a)for(let h=0;h<c[a].length;++h)Ga(n,c[a][h]);return n}function kl(c,n,a){if(qc(c)||qc(n))return NaN;let h=0,p=0;return c[2]<n[0]&&(h=n[0]-c[2]),c[0]>n[2]&&(h=c[0]-n[2]),c[1]>n[3]&&(p=c[1]-n[3]),c[3]<n[1]&&(p=n[1]-c[3]),a.distance([0,0],[h,p])}function bm(c){return 360*c-180}function El(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Qu(c,n){const a=Math.pow(2,n.z),h=(c.y/fn+n.y)/a;return[bm((c.x/fn+n.x)/a),El(h)]}function hc(c,n){const a=[];for(let h=0;h<c.length;++h)a.push(Qu(c[h],n));return a}function Jr(c,n,a){const h=a.pointOnLine(n,c).point;return a.distance(c,h)}function Vh(c,n,a,h,p){const v=a.slice(h[0],h[1]+1);let x=1/0;for(let E=n[0];E<=n[1];++E)if((x=Math.min(x,Jr(c[E],v,p)))===0)return 0;return x}function dc(c,n,a,h,p){const v=Math.min(p.pointToSegmentDistance(c,a,h),p.pointToSegmentDistance(n,a,h)),x=Math.min(p.pointToSegmentDistance(a,c,n),p.pointToSegmentDistance(h,c,n));return Math.min(v,x)}function yp(c,n,a,h,p){if(!Ns(n,c.length)||!Ns(h,a.length))return NaN;let v=1/0;for(let x=n[0];x<n[1];++x)for(let E=h[0];E<h[1];++E){if(hu(c[x],c[x+1],a[E],a[E+1]))return 0;v=Math.min(v,dc(c[x],c[x+1],a[E],a[E+1],p))}return v}function xf(c,n,a,h,p){if(!Ns(n,c.length)||!Ns(h,a.length))return NaN;let v=1/0;for(let x=n[0];x<=n[1];++x)for(let E=h[0];E<=h[1];++E)if((v=Math.min(v,p.distance(c[x],a[E])))===0)return v;return v}function eh(c,n,a){if(Vc(c,n,!0))return 0;let h=1/0;for(const p of n){const v=p.length;if(v<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[v-1]&&(h=Math.min(h,a.pointToSegmentDistance(c,p[v-1],p[0])))===0||(h=Math.min(h,Jr(c,p,a)))===0)return h}return h}function $h(c,n,a,h){if(!Ns(n,c.length))return NaN;for(let v=n[0];v<=n[1];++v)if(Vc(c[v],a,!0))return 0;let p=1/0;for(let v=n[0];v<n[1];++v)for(const x of a)for(let E=0,O=x.length,D=O-1;E<O;D=E++){if(hu(c[v],c[v+1],x[D],x[E]))return 0;p=Math.min(p,dc(c[v],c[v+1],x[D],x[E],h))}return p}function b(c,n){for(const a of c)for(let h=0;h<=a.length-1;++h)if(Vc(a[h],n,!0))return!0;return!1}function z(c,n,a,h=1/0){const p=Oi(c),v=Oi(n);if(h!==1/0&&kl(p,v,a)>=h)return h;if(sc(p,v)){if(b(c,n))return 0}else if(b(n,c))return 0;let x=h;for(const E of c)for(let O=0,D=E.length,B=D-1;O<D;B=O++)for(const F of n)for(let U=0,Z=F.length,Y=Z-1;U<Z;Y=U++){if(hu(E[B],E[O],F[Y],F[U]))return 0;x=Math.min(x,dc(E[B],E[O],F[Y],F[U],a))}return x}function $(c,n,a,h,p,v,x){if(v===null||x===null)return;const E=kl(Bs(h,v),Bs(p,x),a);E<n&&c.push({dist:E,range1:v,range2:x})}function ne(c,n,a,h,p=1/0){let v=Math.min(h.distance(c[0],a[0][0]),p);if(v===0)return v;const x=new uc([{dist:0,range1:[0,c.length-1],range2:[0,0]}],Zs),E=n?ks:Wl,O=Oi(a);for(;x.length;){const D=x.pop();if(D.dist>=v)continue;const B=D.range1;if(Hc(B)<=E){if(!Ns(B,c.length))return NaN;if(n){const F=$h(c,B,a,h);if((v=Math.min(v,F))===0)return v}else for(let F=B[0];F<=B[1];++F){const U=eh(c[F],a,h);if((v=Math.min(v,U))===0)return v}}else{const F=Gc(B,n);if(F[0]!==null){const U=kl(Bs(c,F[0]),O,h);U<v&&x.push({dist:U,range1:F[0],range2:[0,0]})}if(F[1]!==null){const U=kl(Bs(c,F[1]),O,h);U<v&&x.push({dist:U,range1:F[1],range2:[0,0]})}}}return v}function ve(c,n,a,h,p,v=1/0){let x=Math.min(v,p.distance(c[0],a[0]));if(x===0)return x;const E=new uc([{dist:0,range1:[0,c.length-1],range2:[0,a.length-1]}],Zs),O=n?ks:Wl,D=h?ks:Wl;for(;E.length;){const B=E.pop();if(B.dist>=x)continue;const F=B.range1,U=B.range2;if(Hc(F)<=O&&Hc(U)<=D){if(!Ns(F,c.length)||!Ns(U,a.length))return NaN;if(n&&h?x=Math.min(x,yp(c,F,a,U,p)):n||h?n&&!h?x=Math.min(x,Vh(a,U,c,F,p)):!n&&h&&(x=Math.min(x,Vh(c,F,a,U,p))):x=Math.min(x,xf(c,F,a,U,p)),x===0)return x}else{const Z=Gc(F,n),Y=Gc(U,h);$(E,x,p,c,a,Z[0],Y[0]),$(E,x,p,c,a,Z[0],Y[1]),$(E,x,p,c,a,Z[1],Y[0]),$(E,x,p,c,a,Z[1],Y[1])}}return x}function Be(c,n,a,h,p=1/0){let v=p;const x=Bs(c,[0,c.length-1]);for(const E of a)if(!(v!==1/0&&kl(x,Bs(E,[0,E.length-1]),h)>=v)&&(v=Math.min(v,ve(c,n,E,!0,h,v)),v===0))return v;return v}function _t(c,n,a,h,p=1/0){let v=p;const x=Bs(c,[0,c.length-1]);for(const E of a){if(v!==1/0&&kl(x,Oi(E),h)>=v)continue;const O=ne(c,n,E,h,v);if(isNaN(O))return O;if((v=Math.min(v,O))===0)return v}return v}function Wt(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class ln{constructor(n,a){this.type=Jn,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Ri(n[1])){const h=n[1];if(h.type==="FeatureCollection"){for(let p=0;p<h.features.length;++p)if(Wt(h.features[p].geometry.type))return new ln(h,h.features[p].geometry)}else if(h.type==="Feature"){if(Wt(h.geometry.type))return new ln(h,h.geometry)}else if(Wt(h.type))return new ln(h,h)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const a=n.geometry(),h=n.canonicalID();if(a!=null&&h!=null){if(n.geometryType()==="Point")return function(p,v,x){const E=[];for(const D of p)for(const B of D)E.push(Qu(B,v));const O=new fu(E[0][1],"meters");return x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString"?ve(E,!1,x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",O):x.type==="MultiLineString"?Be(E,!1,x.coordinates,O):x.type==="Polygon"||x.type==="MultiPolygon"?_t(E,!1,x.type==="Polygon"?[x.coordinates]:x.coordinates,O):null}(a,h,this.geometries);if(n.geometryType()==="LineString")return function(p,v,x){const E=[];for(const D of p){const B=[];for(const F of D)B.push(Qu(F,v));E.push(B)}const O=new fu(E[0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return Be(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",E,O);if(x.type==="MultiLineString"){let D=1/0;for(let B=0;B<x.coordinates.length;B++){const F=Be(x.coordinates[B],!0,E,O,D);if(isNaN(F))return F;if((D=Math.min(D,F))===0)return D}return D}if(x.type==="Polygon"||x.type==="MultiPolygon"){let D=1/0;for(let B=0;B<E.length;B++){const F=_t(E[B],!0,x.type==="Polygon"?[x.coordinates]:x.coordinates,O,D);if(isNaN(F))return F;if((D=Math.min(D,F))===0)return D}return D}return null}(a,h,this.geometries);if(n.geometryType()==="Polygon")return function(p,v,x){const E=[];for(const D of function(B,F){const U=B.length;if(U<=1)return[B];const Z=[];let Y,re;for(let he=0;he<U;he++){const _e=Sl(B[he]);_e!==0&&(B[he].area=Math.abs(_e),re===void 0&&(re=_e<0),re===_e<0?(Y&&Z.push(Y),Y=[B[he]]):Y.push(B[he]))}return Y&&Z.push(Y),Z}(p)){const B=[];for(let F=0;F<D.length;++F)B.push(hc(D[F],v));E.push(B)}const O=new fu(E[0][0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return _t(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",E,O);if(x.type==="MultiLineString"){let D=1/0;for(let B=0;B<x.coordinates.length;B++){const F=_t(x.coordinates[B],!0,E,O,D);if(isNaN(F))return F;if((D=Math.min(D,F))===0)return D}return D}return x.type==="Polygon"||x.type==="MultiPolygon"?function(D,B,F){let U=1/0;for(const Z of D)for(const Y of B){const re=z(Z,Y,F,U);if(isNaN(re))return re;if((U=Math.min(U,re))===0)return U}return U}(x.type==="Polygon"?[x.coordinates]:x.coordinates,E,O):null}(a,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Un(c){if(c instanceof Ia&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Uo||c instanceof ln)return!1;if(c instanceof Da)return c.featureConstant;let n=!0;return c.eachChild(a=>{n&&!Un(a)&&(n=!1)}),n}function yi(c){if(c instanceof Ia&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(a=>{n&&!yi(a)&&(n=!1)}),n}function Ti(c){if(c instanceof Da)return new Set([c.key]);let n=new Set;return c.eachChild(a=>{n=new Set([...n,...Ti(a)])}),n}function Ai(c,n){if(c instanceof Ia&&n.indexOf(c.name)>=0)return!1;let a=!0;return c.eachChild(h=>{a&&!Ai(h,n)&&(a=!1)}),a}function br(c,n,a){return[c,n,a].filter(Boolean).join("")}function Wo(c,n){switch(c){case"string":return ds(n);case"number":return+n;case"boolean":return!!n;case"color":return Di.parse(n);case"formatted":return is.fromString(ds(n));case"resolvedImage":return Ha.build(ds(n))}return n}function ba(c,n,a,h){return h!==void 0&&(c=h*Math.round(c/h)),n!==void 0&&c<n&&(c=n),a!==void 0&&c>a&&(c=a),c}class Da{constructor(n,a,h,p=!1){this.type=n,this.key=a,this.scope=h,this.featureConstant=p}static parse(n,a){let h=a.expectedType;if(h==null&&(h=vr),n.length<2||n.length>3)return a.error("Invalid number of arguments for 'config' expression.");const p=a.parse(n[1],1);if(!(p instanceof di))return a.error("Key name of 'config' expression must be a string literal.");let v,x=!0;const E=ds(p.value);if(n.length>=3){const O=a.parse(n[2],2);if(!(O instanceof di))return a.error("Scope of 'config' expression must be a string literal.");v=ds(O.value)}if(a.options){const O=br(E,v,a._scope),D=a.options.get(O);D&&(x=Un(D.value||D.default))}return new Da(h,E,v,x)}evaluate(n){const a=br(this.key,this.scope,n.scope),h=n.getConfig(a);if(!h)return null;const{type:p,value:v,values:x,minValue:E,maxValue:O,stepValue:D}=h,B=h.default.evaluate(n);let F=B;if(v){const U=n.scope;n.scope=(U||"").split("").slice(1).join(""),F=v.evaluate(n),n.scope=U}return p&&(F=Wo(p,F)),F===void 0||E===void 0&&O===void 0&&D===void 0||(typeof F=="number"?F=ba(F,E,O,D):Array.isArray(F)&&(F=F.map(U=>typeof U=="number"?ba(U,E,O,D):U))),v!==void 0&&F!==void 0&&x&&!x.includes(F)&&(F=B,p&&(F=Wo(p,F))),(p&&p!==this.type||F!==void 0&&!Lh(Tn(F),this.type))&&(F=Wo(this.type.kind,F)),F}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.scope),n}}class Ws{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=n[1];return a.scope.has(h)?new Ws(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Id{constructor(n,a=[],h,p=new Oh,v=[],x,E){this.registry=n,this.path=a,this.key=a.map(O=>typeof O=="string"?`['${O}']`:`[${O}]`).join(""),this.scope=p,this.errors=v,this.expectedType=h,this._scope=x,this.options=E}parse(n,a,h,p,v={}){return a||h?this.concat(a,null,h,p)._parse(n,v):this._parse(n,v)}parseObjectValue(n,a,h,p,v,x={}){return this.concat(a,h,p,v)._parse(n,x)}_parse(n,a){function h(p,v,x){return x==="assert"?new li(v,[p]):x==="coerce"?new ul(v,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(p){let v=p.parse(n,this);if(!v)return null;if(this.expectedType){const x=this.expectedType,E=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||E.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(x,E))return null}else v=h(v,x,a.typeAnnotation||"coerce");else v=h(v,x,a.typeAnnotation||"assert")}if(!(v instanceof di)&&v.type.kind!=="resolvedImage"&&bf(v)){const x=new Fc(this._scope,this.options);try{v=new di(v.type,v.evaluate(x))}catch(E){return this.error(E.message),null}}return v}return ul.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,h,p){let v=typeof n=="number"?this.path.concat(n):this.path;v=typeof a=="string"?v.concat(a):v;const x=p?this.scope.concat(p):this.scope;return new Id(this.registry,v,h||null,x,this.errors,this._scope,this.options)}error(n,...a){const h=`${this.key}${a.map(p=>`[${p}]`).join("")}`;this.errors.push(new ts(h,n))}checkSubtype(n,a){const h=zl(n,a);return h&&this.error(h),h}}function bf(c){if(c instanceof Ws)return bf(c.boundExpression);if(c instanceof Ia&&c.name==="error"||c instanceof ac||c instanceof Uo||c instanceof ln||c instanceof Da)return!1;const n=c instanceof ul||c instanceof li;let a=!0;return c.eachChild(h=>{a=n?a&&bf(h):a&&h instanceof di}),!!a&&Un(c)&&Ai(c,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function pu(c,n){const a=c.length-1;let h,p,v=0,x=a,E=0;for(;v<=x;)if(E=Math.floor((v+x)/2),h=c[E],p=c[E+1],h<=n){if(E===a||n<p)return E;v=E+1}else{if(!(h>n))throw new Vr("Input is not a number.");x=E-1}return 0}class fc{constructor(n,a,h){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[p,v]of h)this.labels.push(p),this.outputs.push(v)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(n[1],1,Jn);if(!h)return null;const p=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let x=1;x<n.length;x+=2){const E=x===1?-1/0:n[x],O=n[x+1],D=x,B=x+1;if(typeof E!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(p.length&&p[p.length-1][0]>=E)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const F=a.parse(O,B,v);if(!F)return null;v=v||F.type,p.push([E,F])}return new fc(v,h,p)}evaluate(n){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(n);const p=this.input.evaluate(n);if(p<=a[0])return h[0].evaluate(n);const v=a.length;return p>=a[v-1]?h[v-1].evaluate(n):h[pu(a,p)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&n.push(this.labels[a]),n.push(this.outputs[a].serialize());return n}}const vp=.95047,th=1.08883,ma=4/29,Ss=6/29,pc=3*Ss*Ss,Zc=Ss*Ss*Ss,Wc=Math.PI/180,Dd=180/Math.PI;function qh(c){return c>Zc?Math.pow(c,1/3):c/pc+ma}function mu(c){return c>Ss?c*c*c:pc*(c-ma)}function Rd(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Nl(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function js(c){const n=Nl(c.r),a=Nl(c.g),h=Nl(c.b),p=qh((.4124564*n+.3575761*a+.1804375*h)/vp),v=qh((.2126729*n+.7151522*a+.072175*h)/1);return{l:116*v-16,a:500*(p-v),b:200*(v-qh((.0193339*n+.119192*a+.9503041*h)/th)),alpha:c.a}}function wf(c){let n=(c.l+16)/116,a=isNaN(c.a)?n:n+c.a/500,h=isNaN(c.b)?n:n-c.b/200;return n=1*mu(n),a=vp*mu(a),h=th*mu(h),new Di(Rd(3.2404542*a-1.5371385*n-.4985314*h),Rd(-.969266*a+1.8760108*n+.041556*h),Rd(.0556434*a-.2040259*n+1.0572252*h),c.alpha)}function yy(c,n,a){const h=n-c;return c+a*(h>180||h<-180?h-360*Math.round(h/360):h)}const Ld={forward:js,reverse:wf,interpolate:function(c,n,a){return{l:Xn(c.l,n.l,a),a:Xn(c.a,n.a,a),b:Xn(c.b,n.b,a),alpha:Xn(c.alpha,n.alpha,a)}}},zd={forward:function(c){const{l:n,a,b:h}=js(c),p=Math.atan2(h,a)*Dd;return{h:p<0?p+360:p,c:Math.sqrt(a*a+h*h),l:n,alpha:c.a}},reverse:function(c){const n=c.h*Wc,a=c.c;return wf({l:c.l,a:Math.cos(n)*a,b:Math.sin(n)*a,alpha:c.alpha})},interpolate:function(c,n,a){return{h:yy(c.h,n.h,a),c:Xn(c.c,n.c,a),l:Xn(c.l,n.l,a),alpha:Xn(c.alpha,n.alpha,a)}}};var vy=Object.freeze({__proto__:null,hcl:zd,lab:Ld});class Oo{constructor(n,a,h,p,v){this.type=n,this.operator=a,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[x,E]of v)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(n,a,h,p){let v=0;if(n.name==="exponential")v=Tf(a,n.base,h,p);else if(n.name==="linear")v=Tf(a,1,h,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;v=new ls(x[0],x[1],x[2],x[3]).solve(Tf(a,1,h,p))}return v}static parse(n,a){let[h,p,v,...x]=n;if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const D=p[1];if(typeof D!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:D}}else{if(p[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const D=p.slice(1);if(D.length!==4||D.some(B=>typeof B!="number"||B<0||B>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:D}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,Jn),!v)return null;const E=[];let O=null;h==="interpolate-hcl"||h==="interpolate-lab"?O=cl:a.expectedType&&a.expectedType.kind!=="value"&&(O=a.expectedType);for(let D=0;D<x.length;D+=2){const B=x[D],F=x[D+1],U=D+3,Z=D+4;if(typeof B!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=B)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const Y=a.parse(F,Z,O);if(!Y)return null;O=O||Y.type,E.push([B,Y])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new Oo(O,h,p,v,E):a.error(`Type ${Eo(O)} is not interpolatable.`)}evaluate(n){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(n);const p=this.input.evaluate(n);if(p<=a[0])return h[0].evaluate(n);const v=a.length;if(p>=a[v-1])return h[v-1].evaluate(n);const x=pu(a,p),E=Oo.interpolationFactor(this.interpolation,p,a[x],a[x+1]),O=h[x].evaluate(n),D=h[x+1].evaluate(n);return this.operator==="interpolate"?kc[this.type.kind.toLowerCase()](O,D,E):this.operator==="interpolate-hcl"?zd.reverse(zd.interpolate(zd.forward(O),zd.forward(D),E)):Ld.reverse(Ld.interpolate(Ld.forward(O),Ld.forward(D),E))}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const a=[this.operator,n,this.input.serialize()];for(let h=0;h<this.labels.length;h++)a.push(this.labels[h],this.outputs[h].serialize());return a}}function Tf(c,n,a,h){const p=h-a,v=c-a;return p===0?0:n===1?v/p:(Math.pow(n,v)-1)/(Math.pow(n,p)-1)}class nh{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expectected at least one argument.");let h=null;const p=a.expectedType;p&&p.kind!=="value"&&(h=p);const v=[];for(const E of n.slice(1)){const O=a.parse(E,1+v.length,h,void 0,{typeAnnotation:"omit"});if(!O)return null;h=h||O.type,v.push(O)}const x=p&&v.some(E=>zl(p,E.type));return new nh(x?vr:h,v)}evaluate(n){let a,h=null,p=0;for(const v of this.args){if(p++,h=v.evaluate(n),h&&h instanceof Ha&&!h.available&&(a||(a=h),h=null,p===this.args.length))return a;if(h!==null)break}return h}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class Hh{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const h=[];for(let v=1;v<n.length-1;v+=2){const x=n[v];if(typeof x!="string")return a.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const E=a.parse(n[v+1],v+1);if(!E)return null;h.push([x,E])}const p=a.parse(n[n.length-1],n.length-1,a.expectedType,h);return p?new Hh(h,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[a,h]of this.bindings)n.push(a,h.serialize());return n.push(this.result.serialize()),n}}class xp{constructor(n,a,h){this.type=n,this.index=a,this.input=h}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,Jn),p=a.parse(n[2],2,ns(a.expectedType||vr));return h&&p?new xp(p.type.itemType,h,p):null}evaluate(n){const a=this.index.evaluate(n),h=this.input.evaluate(n);if(a<0)throw new Vr(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new Vr(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new Vr(`Array index must be an integer, but found ${a} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return h[a]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Gh{constructor(n,a,h){this.type=n,this.index=a,this.input=h}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,Jn),p=a.parse(n[2],2,ns(a.expectedType||vr));return h&&p?new Gh(p.type.itemType,h,p):null}evaluate(n){const a=this.index.evaluate(n),h=this.input.evaluate(n);if(a<0)throw new Vr(`Array index out of bounds: ${a} < 0.`);if(a>h.length-1)throw new Vr(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a===Math.floor(a))return h[a];const p=Math.floor(a),v=Math.ceil(a),x=h[p],E=h[v];if(typeof x!="number"||typeof E!="number")throw new Vr(`Cannot interpolate between non-number values at index ${a}.`);const O=a-p;return x*(1-O)+E*O}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class ih{constructor(n,a){this.type=dr,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,vr),p=a.parse(n[2],2,vr);return h&&p?fa(h.type,[dr,Er,Jn,cu,vr])?new ih(h,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Eo(h.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(h==null)return!1;if(!Rh(a,["boolean","string","number","null"]))throw new Vr(`Expected first argument to be of type boolean, string, number or null, but found ${Eo(Tn(a))} instead.`);if(!Rh(h,["string","array"]))throw new Vr(`Expected second argument to be of type array or string, but found ${Eo(Tn(h))} instead.`);return h.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class bp{constructor(n,a,h){this.type=Jn,this.needle=n,this.haystack=a,this.fromIndex=h}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,vr),p=a.parse(n[2],2,vr);if(!h||!p)return null;if(!fa(h.type,[dr,Er,Jn,cu,vr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Eo(h.type)} instead`);if(n.length===4){const v=a.parse(n[3],3,Jn);return v?new bp(h,p,v):null}return new bp(h,p)}evaluate(n){const a=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!Rh(a,["boolean","string","number","null"]))throw new Vr(`Expected first argument to be of type boolean, string, number or null, but found ${Eo(Tn(a))} instead.`);if(!Rh(h,["string","array"]))throw new Vr(`Expected second argument to be of type array or string, but found ${Eo(Tn(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(n);return h.indexOf(a,p)}return h.indexOf(a)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class kd{constructor(n,a,h,p,v,x){this.inputType=n,this.type=a,this.input=h,this.cases=p,this.outputs=v,this.otherwise=x}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let h,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const v={},x=[];for(let D=2;D<n.length-1;D+=2){let B=n[D];const F=n[D+1];Array.isArray(B)||(B=[B]);const U=a.concat(D);if(B.length===0)return U.error("Expected at least one branch label.");for(const Y of B){if(typeof Y!="number"&&typeof Y!="string")return U.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return U.error("Numeric branch labels must be integer values.");if(h){if(U.checkSubtype(h,Tn(Y)))return null}else h=Tn(Y);if(v[String(Y)]!==void 0)return U.error("Branch labels must be unique.");v[String(Y)]=x.length}const Z=a.parse(F,D,p);if(!Z)return null;p=p||Z.type,x.push(Z)}const E=a.parse(n[1],1,vr);if(!E)return null;const O=a.parse(n[n.length-1],n.length-1,p);return O?E.type.kind!=="value"&&a.concat(1).checkSubtype(h,E.type)?null:new kd(h,p,E,v,x,O):null}evaluate(n){const a=this.input.evaluate(n);return(Lh(Tn(a),this.inputType)&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),h=[],p={};for(const x of a){const E=p[this.cases[x]];E===void 0?(p[this.cases[x]]=h.length,h.push([this.cases[x],[x]])):h[E][1].push(x)}const v=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,E]of h)n.push(E.length===1?v(E[0]):E.map(v)),n.push(this.outputs[x].serialize());return n.push(this.otherwise.serialize()),n}}class Ug{constructor(n,a,h){this.type=n,this.branches=a,this.otherwise=h}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const E=a.parse(n[x],x,dr);if(!E)return null;const O=a.parse(n[x+1],x+1,h);if(!O)return null;p.push([E,O]),h=h||O.type}const v=a.parse(n[n.length-1],n.length-1,h);return v?new Ug(h,p,v):null}evaluate(n){for(const[a,h]of this.branches)if(a.evaluate(n))return h.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,h]of this.branches)n(a),n(h);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class Sf{constructor(n,a,h,p){this.type=n,this.input=a,this.beginIndex=h,this.endIndex=p}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,vr),p=a.parse(n[2],2,Jn);if(!h||!p)return null;if(!fa(h.type,[ns(vr),Er,vr]))return a.error(`Expected first argument to be of type array or string, but found ${Eo(h.type)} instead`);if(n.length===4){const v=a.parse(n[3],3,Jn);return v?new Sf(h.type,h,p,v):null}return new Sf(h.type,h,p)}evaluate(n){const a=this.input.evaluate(n),h=this.beginIndex.evaluate(n);if(!Rh(a,["string","array"]))throw new Vr(`Expected first argument to be of type array or string, but found ${Eo(Tn(a))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(n);return a.slice(h,p)}return a.slice(h)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Zh(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function wm(c,n,a,h){return h.compare(n,a)===0}function gu(c,n,a){const h=c!=="=="&&c!=="!=";return class x6{constructor(v,x,E){this.type=dr,this.lhs=v,this.rhs=x,this.collator=E,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const E=v[0];let O=x.parse(v[1],1,vr);if(!O)return null;if(!Zh(E,O.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${Eo(O.type)}'.`);let D=x.parse(v[2],2,vr);if(!D)return null;if(!Zh(E,D.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${Eo(D.type)}'.`);if(O.type.kind!==D.type.kind&&O.type.kind!=="value"&&D.type.kind!=="value")return x.error(`Cannot compare types '${Eo(O.type)}' and '${Eo(D.type)}'.`);h&&(O.type.kind==="value"&&D.type.kind!=="value"?O=new li(D.type,[O]):O.type.kind!=="value"&&D.type.kind==="value"&&(D=new li(O.type,[D])));let B=null;if(v.length===4){if(O.type.kind!=="string"&&D.type.kind!=="string"&&O.type.kind!=="value"&&D.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(B=x.parse(v[3],3,_f),!B)return null}return new x6(O,D,B)}evaluate(v){const x=this.lhs.evaluate(v),E=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){const O=Tn(x),D=Tn(E);if(O.kind!==D.kind||O.kind!=="string"&&O.kind!=="number")throw new Vr(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${O.kind}, ${D.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const O=Tn(x),D=Tn(E);if(O.kind!=="string"||D.kind!=="string")return n(v,x,E)}return this.collator?a(v,x,E,this.collator.evaluate(v)):n(v,x,E)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[c];return this.eachChild(x=>{v.push(x.serialize())}),v}}}const Vg=gu("==",function(c,n,a){return n===a},wm),wp=gu("!=",function(c,n,a){return n!==a},function(c,n,a,h){return!wm(0,n,a,h)}),xy=gu("<",function(c,n,a){return n<a},function(c,n,a,h){return h.compare(n,a)<0}),Tm=gu(">",function(c,n,a){return n>a},function(c,n,a,h){return h.compare(n,a)>0}),Ef=gu("<=",function(c,n,a){return n<=a},function(c,n,a,h){return h.compare(n,a)<=0}),by=gu(">=",function(c,n,a){return n>=a},function(c,n,a,h){return h.compare(n,a)>=0});class Nd{constructor(n,a,h,p,v,x){this.type=Er,this.number=n,this.locale=a,this.currency=h,this.unit=p,this.minFractionDigits=v,this.maxFractionDigits=x}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const h=a.parse(n[1],1,Jn);if(!h)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=a.parseObjectValue(p.locale,2,"locale",Er),!v))return null;let x=null;if(p.currency&&(x=a.parseObjectValue(p.currency,2,"currency",Er),!x))return null;let E=null;if(p.unit&&(E=a.parseObjectValue(p.unit,2,"unit",Er),!E))return null;let O=null;if(p["min-fraction-digits"]&&(O=a.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",Jn),!O))return null;let D=null;return p["max-fraction-digits"]&&(D=a.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",Jn),!D)?null:new Nd(h,v,x,E,O,D)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Sm{constructor(n){this.type=Jn,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const h=a.parse(n[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${Eo(h.type)} instead.`):new Sm(h):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string"||Array.isArray(a))return a.length;throw new Vr(`Expected value to be of type string or array, but found ${Eo(Tn(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(a=>{n.push(a.serialize())}),n}}function Af(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const Wh={"==":Vg,"!=":wp,">":Tm,"<":xy,">=":by,"<=":Ef,array:li,at:xp,"at-interpolated":Gh,boolean:li,case:Ug,coalesce:nh,collator:ac,format:jc,image:Zl,in:ih,"index-of":bp,interpolate:Oo,"interpolate-hcl":Oo,"interpolate-lab":Oo,length:Sm,let:Hh,literal:di,match:kd,number:li,"number-format":Nd,object:li,slice:Sf,step:fc,string:li,"to-boolean":ul,"to-color":ul,"to-number":ul,"to-string":ul,var:Ws,within:Uo,distance:ln,config:Da};function Em(c,[n,a,h,p]){n=n.evaluate(c),a=a.evaluate(c),h=h.evaluate(c);const v=p?p.evaluate(c):1,x=uu(n,a,h,v);if(x)throw new Vr(x);return new Di(n/255,a/255,h/255,v)}function _u(c,[n,a,h,p]){n=n.evaluate(c),a=a.evaluate(c),h=h.evaluate(c);const v=p?p.evaluate(c):1,x=function(D,B,F,U){return typeof D=="number"&&D>=0&&D<=360?typeof B=="number"&&B>=0&&B<=100&&typeof F=="number"&&F>=0&&F<=100?U===void 0||typeof U=="number"&&U>=0&&U<=1?null:`Invalid hsla value [${[D,B,F,U].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof U=="number"?[D,B,F,U]:[D,B,F]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof U=="number"?[D,B,F,U]:[D,B,F]).join(", ")}]: 'h' must be between 0 and 360.`}(n,a,h,v);if(x)throw new Vr(x);const E=`hsla(${n}, ${a}%, ${h}%, ${v})`,O=Di.parse(E);if(!O)throw new Vr(`Failed to parse HSLA color: ${E}`);return O}function Am(c,n){return c in n}function yu(c,n){const a=n[c];return a===void 0?null:a}function Bl(c){return{type:c}}function rh(c){return{result:"success",value:c}}function mc(c){return{result:"error",value:c}}function Pf(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function Bd(c){return c["property-type"]==="data-driven"}function jd(c){return Pf(c.expression,"measure-light")}function Fd(c){return Pf(c.expression,"zoom")}function Cf(c){return!!c.expression&&c.expression.interpolated}function Mf(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Ud(c){return c}function Tp(c,n){const a=n.type==="color",h=c.stops&&typeof c.stops[0][0]=="object",p=h||!(h||c.property!==void 0),v=c.type||(Cf(n)?"exponential":"interval");if(a&&((c=es({},c)).stops&&(c.stops=c.stops.map(D=>[D[0],Di.parse(D[1])])),c.default=Di.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!vy[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let x,E,O;if(v==="exponential")x=vu;else if(v==="interval")x=qg;else if(v==="categorical"){x=$g,E=Object.create(null);for(const D of c.stops)E[D[0]]=D[1];O=typeof c.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);x=$r}if(h){const D={},B=[];for(let Z=0;Z<c.stops.length;Z++){const Y=c.stops[Z],re=Y[0].zoom;D[re]===void 0&&(D[re]={zoom:re,type:c.type,property:c.property,default:c.default,stops:[]},B.push(re)),D[re].stops.push([Y[0].value,Y[1]])}const F=[];for(const Z of B)F.push([D[Z].zoom,Tp(D[Z],n)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Oo.interpolationFactor.bind(void 0,U),zoomStops:F.map(Z=>Z[0]),evaluate:({zoom:Z},Y)=>vu({stops:F,base:c.base},n,Z).evaluate(Z,Y)}}if(p){const D=v==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Oo.interpolationFactor.bind(void 0,D),zoomStops:c.stops.map(B=>B[0]),evaluate:({zoom:B})=>x(c,n,B,E,O)}}return{kind:"source",evaluate(D,B){const F=B&&B.properties?B.properties[c.property]:void 0;return F===void 0?Xl(c.default,n.default):x(c,n,F,E,O)}}}function Xl(c,n,a){return c!==void 0?c:n!==void 0?n:a!==void 0?a:void 0}function $g(c,n,a,h,p){return Xl(typeof a===p?h[a]:void 0,c.default,n.default)}function qg(c,n,a){if(oc(a)!=="number")return Xl(c.default,n.default);const h=c.stops.length;if(h===1||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[h-1][0])return c.stops[h-1][1];const p=pu(c.stops.map(v=>v[0]),a);return c.stops[p][1]}function vu(c,n,a){const h=c.base!==void 0?c.base:1;if(oc(a)!=="number")return Xl(c.default,n.default);const p=c.stops.length;if(p===1||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[p-1][0])return c.stops[p-1][1];const v=pu(c.stops.map(B=>B[0]),a),x=function(B,F,U,Z){const Y=Z-U,re=B-U;return Y===0?0:F===1?re/Y:(Math.pow(F,re)-1)/(Math.pow(F,Y)-1)}(a,h,c.stops[v][0],c.stops[v+1][0]),E=c.stops[v][1],O=c.stops[v+1][1];let D=kc[n.type]||Ud;if(c.colorSpace&&c.colorSpace!=="rgb"){const B=vy[c.colorSpace];D=(F,U)=>B.reverse(B.interpolate(B.forward(F),B.forward(U),x))}return typeof E.evaluate=="function"?{evaluate(...B){const F=E.evaluate.apply(void 0,B),U=O.evaluate.apply(void 0,B);if(F!==void 0&&U!==void 0)return D(F,U,x)}}:D(E,O,x)}function $r(c,n,a){return n.type==="color"?a=Di.parse(a):n.type==="formatted"?a=is.fromString(a.toString()):n.type==="resolvedImage"?a=Ha.build(a.toString()):oc(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0),Xl(a,c.default,n.default)}Ia.register(Wh,{error:[{kind:"error"},[Er],(c,[n])=>{throw new Vr(n.evaluate(c))}],typeof:[Er,[vr],(c,[n])=>Eo(Tn(n.evaluate(c)))],"to-rgba":[ns(Jn,4),[cl],(c,[n])=>n.evaluate(c).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[ns(Jn,4),[cl],(c,[n])=>n.evaluate(c).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[cl,[Jn,Jn,Jn],Em],rgba:[cl,[Jn,Jn,Jn,Jn],Em],hsl:[cl,[Jn,Jn,Jn],_u],hsla:[cl,[Jn,Jn,Jn,Jn],_u],has:{type:dr,overloads:[[[Er],(c,[n])=>Am(n.evaluate(c),c.properties())],[[Er,Nc],(c,[n,a])=>Am(n.evaluate(c),a.evaluate(c))]]},get:{type:vr,overloads:[[[Er],(c,[n])=>yu(n.evaluate(c),c.properties())],[[Er,Nc],(c,[n,a])=>yu(n.evaluate(c),a.evaluate(c))]]},"feature-state":[vr,[Er],(c,[n])=>yu(n.evaluate(c),c.featureState||{})],properties:[Nc,[],c=>c.properties()],"geometry-type":[Er,[],c=>c.geometryType()],worldview:[Er,[],c=>c.globals.worldview||""],id:[vr,[],c=>c.id()],zoom:[Jn,[],c=>c.globals.zoom],pitch:[Jn,[],c=>c.globals.pitch||0],"distance-from-center":[Jn,[],c=>c.distanceFromCenter()],"measure-light":[Jn,[Er],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[Jn,[],c=>c.globals.heatmapDensity||0],"line-progress":[Jn,[],c=>c.globals.lineProgress||0],"raster-value":[Jn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[Jn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[Jn,[],c=>c.globals.skyRadialProgress||0],accumulated:[vr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Jn,Bl(Jn),(c,n)=>{let a=0;for(const h of n)a+=h.evaluate(c);return a}],"*":[Jn,Bl(Jn),(c,n)=>{let a=1;for(const h of n)a*=h.evaluate(c);return a}],"-":{type:Jn,overloads:[[[Jn,Jn],(c,[n,a])=>n.evaluate(c)-a.evaluate(c)],[[Jn],(c,[n])=>-n.evaluate(c)]]},"/":[Jn,[Jn,Jn],(c,[n,a])=>n.evaluate(c)/a.evaluate(c)],"%":[Jn,[Jn,Jn],(c,[n,a])=>n.evaluate(c)%a.evaluate(c)],ln2:[Jn,[],()=>Math.LN2],pi:[Jn,[],()=>Math.PI],e:[Jn,[],()=>Math.E],"^":[Jn,[Jn,Jn],(c,[n,a])=>Math.pow(n.evaluate(c),a.evaluate(c))],sqrt:[Jn,[Jn],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[Jn,[Jn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[Jn,[Jn],(c,[n])=>Math.log(n.evaluate(c))],log2:[Jn,[Jn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[Jn,[Jn],(c,[n])=>Math.sin(n.evaluate(c))],cos:[Jn,[Jn],(c,[n])=>Math.cos(n.evaluate(c))],tan:[Jn,[Jn],(c,[n])=>Math.tan(n.evaluate(c))],asin:[Jn,[Jn],(c,[n])=>Math.asin(n.evaluate(c))],acos:[Jn,[Jn],(c,[n])=>Math.acos(n.evaluate(c))],atan:[Jn,[Jn],(c,[n])=>Math.atan(n.evaluate(c))],min:[Jn,Bl(Jn),(c,n)=>Math.min(...n.map(a=>a.evaluate(c)))],max:[Jn,Bl(Jn),(c,n)=>Math.max(...n.map(a=>a.evaluate(c)))],abs:[Jn,[Jn],(c,[n])=>Math.abs(n.evaluate(c))],round:[Jn,[Jn],(c,[n])=>{const a=n.evaluate(c);return a<0?-Math.round(-a):Math.round(a)}],floor:[Jn,[Jn],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[Jn,[Jn],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[dr,[Er,vr],(c,[n,a])=>c.properties()[n.value]===a.value],"filter-id-==":[dr,[vr],(c,[n])=>c.id()===n.value],"filter-type-==":[dr,[Er],(c,[n])=>c.geometryType()===n.value],"filter-<":[dr,[Er,vr],(c,[n,a])=>{const h=c.properties()[n.value],p=a.value;return typeof h==typeof p&&h<p}],"filter-id-<":[dr,[vr],(c,[n])=>{const a=c.id(),h=n.value;return typeof a==typeof h&&a<h}],"filter->":[dr,[Er,vr],(c,[n,a])=>{const h=c.properties()[n.value],p=a.value;return typeof h==typeof p&&h>p}],"filter-id->":[dr,[vr],(c,[n])=>{const a=c.id(),h=n.value;return typeof a==typeof h&&a>h}],"filter-<=":[dr,[Er,vr],(c,[n,a])=>{const h=c.properties()[n.value],p=a.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[dr,[vr],(c,[n])=>{const a=c.id(),h=n.value;return typeof a==typeof h&&a<=h}],"filter->=":[dr,[Er,vr],(c,[n,a])=>{const h=c.properties()[n.value],p=a.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[dr,[vr],(c,[n])=>{const a=c.id(),h=n.value;return typeof a==typeof h&&a>=h}],"filter-has":[dr,[vr],(c,[n])=>n.value in c.properties()],"filter-has-id":[dr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[dr,[ns(Er)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[dr,[ns(vr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[dr,[Er,ns(vr)],(c,[n,a])=>a.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[dr,[Er,ns(vr)],(c,[n,a])=>function(h,p,v,x){for(;v<=x;){const E=v+x>>1;if(p[E]===h)return!0;p[E]>h?x=E-1:v=E+1}return!1}(c.properties()[n.value],a.value,0,a.value.length-1)],all:{type:dr,overloads:[[[dr,dr],(c,[n,a])=>n.evaluate(c)&&a.evaluate(c)],[Bl(dr),(c,n)=>{for(const a of n)if(!a.evaluate(c))return!1;return!0}]]},any:{type:dr,overloads:[[[dr,dr],(c,[n,a])=>n.evaluate(c)||a.evaluate(c)],[Bl(dr),(c,n)=>{for(const a of n)if(a.evaluate(c))return!0;return!1}]]},"!":[dr,[dr],(c,[n])=>!n.evaluate(c)],"is-supported-script":[dr,[Er],(c,[n])=>{const a=c.globals&&c.globals.isSupportedScript;return!a||a(n.evaluate(c))}],upcase:[Er,[Er],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[Er,[Er],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[Er,Bl(vr),(c,n)=>n.map(a=>ds(a.evaluate(c))).join("")],"resolved-locale":[Er,[_f],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[Jn,[Jn,Jn,vr],(c,n)=>{const[a,h,p]=n.map(x=>x.evaluate(c));if(a>h||a===h)return a;let v;if(typeof p=="string")v=function(x){let E=0;if(x.length===0)return E;for(let O=0;O<x.length;O++)E=(E<<5)-E+x.charCodeAt(O),E|=0;return E}(p);else{if(typeof p!="number")throw new Vr(`Invalid seed input: ${p}`);v=p}return a+Af(v)()*(h-a)}]});class xo{constructor(n,a,h,p){this.expression=n,this._warningHistory={},this._evaluator=new Fc(h,p),this._defaultValue=a?function(v){return v.type==="color"&&(Mf(v.default)||Array.isArray(v.default))?new Di(0,0,0,0):v.type==="color"?Di.parse(v.default)||null:v.default===void 0?null:v.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this.configDependencies=Ti(n)}evaluateWithoutErrorHandling(n,a,h,p,v,x,E,O){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=p||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(n,a,h,p,v,x,E,O){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Vr(`Expected value to be one of ${Object.keys(this._enumValues).map(B=>JSON.stringify(B)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${D.message}`)),this._defaultValue}}}function Ra(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Wh}function gc(c,n,a,h){const p=new Id(Wh,[],n?function(x){const E={color:cl,string:Er,number:Jn,enum:Er,boolean:dr,formatted:Ih,resolvedImage:Dh};return x.type==="array"?ns(E[x.value]||vr,x.length):E[x.type]}(n):void 0,void 0,void 0,a,h),v=p.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?rh(new xo(v,n,a,h)):mc(p.errors)}class xu{constructor(n,a,h,p){this.kind=n,this._styleExpression=a,this.isLightConstant=h,this.isLineProgressConstant=p,this.isStateDependent=n!=="constant"&&!yi(a.expression),this.configDependencies=Ti(a.expression)}evaluateWithoutErrorHandling(n,a,h,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,a,h,p,v,x)}evaluate(n,a,h,p,v,x){return this._styleExpression.evaluate(n,a,h,p,v,x)}}class Xc{constructor(n,a,h,p,v,x){this.kind=n,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!yi(a.expression),this.isLightConstant=v,this.isLineProgressConstant=x,this.configDependencies=Ti(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,a,h,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,a,h,p,v,x)}evaluate(n,a,h,p,v,x){return this._styleExpression.evaluate(n,a,h,p,v,x)}interpolationFactor(n,a,h){return this.interpolationType?Oo.interpolationFactor(this.interpolationType,n,a,h):0}}function Sp(c,n,a,h){if((c=gc(c,n,a,h)).result==="error")return c;const p=c.value.expression,v=Un(p);if(!v&&!Bd(n))return mc([new ts("","data expressions not supported")]);const x=Ai(p,["zoom","pitch","distance-from-center"]);if(!x&&!Fd(n))return mc([new ts("","zoom expressions not supported")]);const E=Ai(p,["measure-light"]);if(!E&&!jd(n))return mc([new ts("","measure-light expression not supported")]);const O=Ai(p,["line-progress"]);if(!O&&!function(F){return Pf(F.expression,"line-progress")}(n))return mc([new ts("","line-progress expression not supported")]);const D=n.expression&&n.expression.relaxZoomRestriction,B=Yc(p);return B||x||D?B instanceof ts?mc([B]):B instanceof Oo&&!Cf(n)?mc([new ts("",'"interpolate" expressions cannot be used with this property')]):rh(B?new Xc(v&&O?"camera":"composite",c.value,B.labels,B instanceof Oo?B.interpolation:void 0,E,O):new xu(v&&O?"constant":"source",c.value,E,O)):mc([new ts("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class bu{constructor(n,a){this._parameters=n,this._specification=a,es(this,Tp(this._parameters,this._specification))}static deserialize(n){return new bu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Yc(c){let n=null;if(c instanceof Hh)n=Yc(c.result);else if(c instanceof nh){for(const a of c.args)if(n=Yc(a),n)break}else(c instanceof fc||c instanceof Oo)&&c.input instanceof Ia&&c.input.name==="zoom"&&(n=c);return n instanceof ts||c.eachChild(a=>{const h=Yc(a);h instanceof ts?n=h:n&&h&&n!==h&&(n=new ts("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var Pm,La,Ep=function(){if(La)return Pm;La=1,Pm=n;var c=3;function n(a,h,p){var v=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var x=new Int32Array(this.arrayBuffer);a=x[0],this.d=(h=x[1])+2*(p=x[2]);for(var E=0;E<this.d*this.d;E++){var O=x[c+E],D=x[c+E+1];v.push(O===D?null:x.subarray(O,D))}var B=x[c+v.length+1];this.keys=x.subarray(x[c+v.length],B),this.bboxes=x.subarray(B),this.insert=this._insertReadonly}else{this.d=h+2*p;for(var F=0;F<this.d*this.d;F++)v.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=p,this.scale=h/a,this.uid=0;var U=p/h*a;this.min=-U,this.max=a+U}return n.prototype.insert=function(a,h,p,v,x){this._forEachCell(h,p,v,x,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(x)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(a,h,p,v,x,E){this.cells[x].push(E)},n.prototype.query=function(a,h,p,v,x){var E=this.min,O=this.max;if(a<=E&&h<=E&&O<=p&&O<=v&&!x)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(a,h,p,v,this._queryCell,D,{},x),D},n.prototype._queryCell=function(a,h,p,v,x,E,O,D){var B=this.cells[x];if(B!==null)for(var F=this.keys,U=this.bboxes,Z=0;Z<B.length;Z++){var Y=B[Z];if(O[Y]===void 0){var re=4*Y;(D?D(U[re+0],U[re+1],U[re+2],U[re+3]):a<=U[re+2]&&h<=U[re+3]&&p>=U[re+0]&&v>=U[re+1])?(O[Y]=!0,E.push(F[Y])):O[Y]=!1}}},n.prototype._forEachCell=function(a,h,p,v,x,E,O,D){for(var B=this._convertToCellCoord(a),F=this._convertToCellCoord(h),U=this._convertToCellCoord(p),Z=this._convertToCellCoord(v),Y=B;Y<=U;Y++)for(var re=F;re<=Z;re++){var he=this.d*re+Y;if((!D||D(this._convertFromCellCoord(Y),this._convertFromCellCoord(re),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(re+1)))&&x.call(this,a,h,p,v,he,E,O,D))return}},n.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},n.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,h=c+this.cells.length+1+1,p=0,v=0;v<this.cells.length;v++)p+=this.cells[v].length;var x=new Int32Array(h+p+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var E=h,O=0;O<a.length;O++){var D=a[O];x[c+O]=E,x.set(D,E),E+=D.length}return x[c+a.length]=E,x.set(this.keys,E),x[c+a.length+1]=E+=this.keys.length,x.set(this.bboxes,E),E+=this.bboxes.length,x.buffer},Pm}(),Kc=Pa(Ep);const wu={};function Nn(c,n,a={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),wu[n]={klass:c,omit:a.omit||[]}}Nn(Object,"Object"),Kc.serialize=function(c,n){const a=c.toArrayBuffer();return n&&n.add(a),{buffer:a}},Kc.deserialize=function(c){return new Kc(c.buffer)},Object.defineProperty(Kc,"name",{value:"Grid"}),Nn(Kc,"Grid"),typeof DOMMatrix<"u"&&Nn(DOMMatrix,"DOMMatrix"),Nn(Di,"Color"),Nn(Error,"Error"),Nn(is,"Formatted"),Nn(Yu,"FormattedSection"),Nn(ri,"AJAXError"),Nn(Ha,"ResolvedImage"),Nn(bu,"StylePropertyFunction"),Nn(xo,"StyleExpression",{omit:["_evaluator"]}),Nn(yo,"ImageId"),Nn(rc,"ImageVariant"),Nn(Xc,"ZoomDependentExpression"),Nn(xu,"ZoomConstantExpression"),Nn(Ia,"CompoundExpression",{omit:["_evaluate"]});for(const c in Wh)wu[Wh[c]._classRegistryKey]||Nn(Wh[c],`Expression${c}`);function wy(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Cm(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Tu(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(wy(c)||Cm(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c))return n&&n.add(c.buffer),c;if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const a=[];for(const h of c)a.push(Tu(h,n));return a}if(c instanceof Map){const a={$name:"Map",entries:[]};for(const[h,p]of c.entries())a.entries.push(Tu(h),Tu(p,n));return a}if(c instanceof Set){const a={$name:"Set"};let h=0;for(const p of c.values())a[++h]=Tu(p);return a}if(c instanceof DOMMatrix){const a={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of h)a[p]=c[p];return a}if(typeof c=="bigint")return{$name:"BigInt",value:c.toString()};if(typeof c=="object"){const a=c.constructor,h=a._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${a.name}".`);const p=a.serialize?a.serialize(c,n):{};if(!a.serialize){for(const v in c)c.hasOwnProperty(v)&&(wu[h].omit.indexOf(v)>=0||(p[v]=Tu(c[v],n)));c instanceof Error&&(p.message=c.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof c)}function Su(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||wy(c)||Cm(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Su);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const p=c.entries||[],v=new Map;for(let x=0;x<p.length;x+=2)v.set(Su(p[x]),Su(p[x+1]));return v}if(n==="Set"){const p=new Set;for(const v of Object.keys(c))v!=="$name"&&p.add(Su(c[v]));return p}if(n==="DOMMatrix"){let p;return p=c.is2D?[c.a,c.b,c.c,c.d,c.e,c.f]:[c.m11,c.m12,c.m13,c.m14,c.m21,c.m22,c.m23,c.m24,c.m31,c.m32,c.m33,c.m34,c.m41,c.m42,c.m43,c.m44],new DOMMatrix(p)}if(n==="BigInt")return BigInt(c.value);const{klass:a}=wu[n];if(!a)throw new Error(`Can't deserialize unregistered class "${n}".`);if(a.deserialize)return a.deserialize(c);const h=Object.create(a.prototype);for(const p of Object.keys(c))p!=="$name"&&(h[p]=Su(c[p]));return h}throw new Error("can't deserialize object of type "+typeof c)}const Qn={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function wa(c){for(const n of c)if(Of(n.charCodeAt(0)))return!0;return!1}function Hg(c){for(const n of c)if(!Ap(n.charCodeAt(0)))return!1;return!0}function Ap(c){return!(Qn.Arabic(c)||Qn["Arabic Supplement"](c)||Qn["Arabic Extended-A"](c)||Qn["Arabic Presentation Forms-A"](c)||Qn["Arabic Presentation Forms-B"](c))}function Of(c){return!(c!==746&&c!==747&&(c<4352||!(Qn["Bopomofo Extended"](c)||Qn.Bopomofo(c)||Qn["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Qn["CJK Compatibility Ideographs"](c)||Qn["CJK Compatibility"](c)||Qn["CJK Radicals Supplement"](c)||Qn["CJK Strokes"](c)||!(!Qn["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Qn["CJK Unified Ideographs Extension A"](c)||Qn["CJK Unified Ideographs"](c)||Qn["Enclosed CJK Letters and Months"](c)||Qn["Hangul Compatibility Jamo"](c)||Qn["Hangul Jamo Extended-A"](c)||Qn["Hangul Jamo Extended-B"](c)||Qn["Hangul Jamo"](c)||Qn["Hangul Syllables"](c)||Qn.Hiragana(c)||Qn["Ideographic Description Characters"](c)||Qn.Kanbun(c)||Qn["Kangxi Radicals"](c)||Qn["Katakana Phonetic Extensions"](c)||Qn.Katakana(c)&&c!==12540||!(!Qn["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Qn["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Qn["Unified Canadian Aboriginal Syllabics"](c)||Qn["Unified Canadian Aboriginal Syllabics Extended"](c)||Qn["Vertical Forms"](c)||Qn["Yijing Hexagram Symbols"](c)||Qn["Yi Syllables"](c)||Qn["Yi Radicals"](c))))}function Mm(c){return!(Of(c)||function(n){return!!(Qn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Qn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Qn["Letterlike Symbols"](n)||Qn["Number Forms"](n)||Qn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Qn["Control Pictures"](n)&&n!==9251||Qn["Optical Character Recognition"](n)||Qn["Enclosed Alphanumerics"](n)||Qn["Geometric Shapes"](n)||Qn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Qn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Qn["CJK Symbols and Punctuation"](n)||Qn.Katakana(n)||Qn["Private Use Area"](n)||Qn["CJK Compatibility Forms"](n)||Qn["Small Form Variants"](n)||Qn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function oh(c){return Qn.Arabic(c)||Qn["Arabic Supplement"](c)||Qn["Arabic Extended-A"](c)||Qn["Arabic Presentation Forms-A"](c)||Qn["Arabic Presentation Forms-B"](c)}function Pp(c){return c>=1424&&c<=2303||Qn["Arabic Presentation Forms-A"](c)||Qn["Arabic Presentation Forms-B"](c)}function Gg(c,n){return!(!n&&Pp(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Qn.Khmer(c))}function Zg(c){for(const n of c)if(Pp(n.charCodeAt(0)))return!0;return!1}const Al={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Om=null,Xs=Al.unavailable,Eu=null;const Xh=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Xs=Al.error),Om&&Om(c)};function Cp(){If.fire(new qn("pluginStateChange",{pluginStatus:Xs,pluginURL:Eu}))}const If=new Fo,Vd=function(){return Xs},Ty=function(){if(Xs!==Al.deferred||!Eu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Xs=Al.loading,Cp(),Eu&&ko({url:Eu},c=>{c?Xh(c):(Xs=Al.loaded,Cp())})},Au={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Xs===Al.loaded||Au.applyArabicShaping!=null,isLoading:()=>Xs===Al.loading,setState(c){Xs=c.pluginStatus,Eu=c.pluginURL},isParsing:()=>Xs===Al.parsing,isParsed:()=>Xs===Al.parsed,getPluginURL:()=>Eu};class Mr{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness,this.worldview=a.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(a,h){for(const p of a)if(!Gg(p.charCodeAt(0),h))return!1;return!0}(n,Au.isLoaded())}}class Df{constructor(n,a,h,p){this.property=n,this.value=a,this.expression=function(v,x,E,O){if(Mf(v))return new bu(v,x);if(Ra(v)||Array.isArray(v)&&v.length>0){const D=Sp(v,x,E,O);if(D.result==="error")throw new Error(D.value.map(B=>`${B.key}: ${B.message}`).join(", "));return D.value}{let D=v;return typeof v=="string"&&x.type==="color"&&(D=Di.parse(v)),{kind:"constant",configDependencies:new Set,evaluate:()=>D}}}(a===void 0?n.specification.default:a,n.specification,h,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,h){return this.property.possiblyEvaluate(this,n,a,h)}}class Pu{constructor(n,a,h){this.property=n,this.value=new Df(n,void 0,a,h)}transitioned(n,a){return new Xg(this.property,this.value,a,lt({},n.transition,this.transition),n.now)}untransitioned(){return new Xg(this.property,this.value,null,{},0)}}class Wg{constructor(n,a,h){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=a,this._options=h,this.configDependencies=new Set}getValue(n){return ii(this._values[n].value.value)}setValue(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new Pu(this._values[n].property,this._scope,this._options)),this._values[n].value=new Df(this._values[n].property,a===null?void 0:ii(a),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,a){a&&(this._options=a);const h=this._properties.properties;if(n)for(const p in n){const v=n[p];if(p.endsWith("-transition")){const x=p.slice(0,-11);h[x]&&this.setTransition(x,v)}else h.hasOwnProperty(p)&&this.setValue(p,v)}}getTransition(n){return ii(this._values[n].transition)}setTransition(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new Pu(this._values[n].property)),this._values[n].transition=ii(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(n[a]=h);const p=this.getTransition(a);p!==void 0&&(n[`${a}-transition`]=p)}return n}transitioned(n,a){const h=new Yg(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(n,a._values[p]);return h}untransitioned(){const n=new Yg(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class Xg{constructor(n,a,h,p,v){const x=p.delay||0,E=p.duration||0;v=v||0,this.property=n,this.value=a,this.begin=v+x,this.end=this.begin+E,n.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(n,a,h){const p=n.now||0,v=this.value.possiblyEvaluate(n,a,h),x=this.prior;if(x){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return x.possiblyEvaluate(n,a,h);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,a,h),v,ge(E))}}return v}}class Yg{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,h){const p=new qd(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,a,h);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Sy{constructor(n,a,h){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=a,this._options=h,this.configDependencies=new Set}getValue(n){return ii(this._values[n].value)}setValue(n,a){this._values[n]=new Df(this._values[n].property,a===null?void 0:ii(a),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(n[a]=h)}return n}possiblyEvaluate(n,a,h){const p=new qd(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,a,h);return p}}class $d{constructor(n,a,h){this.property=n,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,h,p){return this.property.evaluate(this.value,this.parameters,n,a,h,p)}}class qd{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class an{constructor(n){this.specification=n}possiblyEvaluate(n,a){return n.expression.evaluate(a)}interpolate(n,a,h){const p=kc[this.specification.type];return p?p(n,a,h):n}}class bn{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,h,p){return new $d(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},h,p)}:n.expression,a)}interpolate(n,a,h){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new $d(this,{kind:"constant",value:void 0},n.parameters);const p=kc[this.specification.type];return p?new $d(this,{kind:"constant",value:p(n.value.value,a.value.value,h)},n.parameters):n}evaluate(n,a,h,p,v,x){return n.kind==="constant"?n.value:n.evaluate(a,h,p,v,x)}}class Cu{constructor(n){this.specification=n}possiblyEvaluate(n,a,h,p){return!!n.expression.evaluate(a,null,{},h,p)}interpolate(){return!1}}class bo{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Mr(0,{});for(const h in n){const p=n[h];p.specification.overridable&&this.overridableProperties.push(h);const v=this.defaultPropertyValues[h]=new Df(p,void 0),x=this.defaultTransitionablePropertyValues[h]=new Pu(p);this.defaultTransitioningPropertyValues[h]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=v.possiblyEvaluate(a)}}}Nn(bn,"DataDrivenProperty"),Nn(an,"DataConstantProperty"),Nn(Cu,"ColorRampProperty");var ft=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function Pl(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Mp(c){if(Array.isArray(c))return c.map(Mp);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const a in c)n[a]=Mp(c[a]);return n}return Pl(c)}function Op(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!Op(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function Im(c,n="",a=null,h="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Op(c)||(c=Rf(c));const p=c;let v=!0;try{v=function(B){if(!Hd(B))return B;let F=Mp(B);return Jg(F),F=Kg(F),F}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let x=null,E=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){E=ft[`filter_${h}`];const B=gc(v,E,n,a);if(B.result==="error")throw new Error(B.value.map(F=>`${F.key}: ${F.message}`).join(", "));x=(F,U,Z)=>B.value.evaluate(F,U,{},Z)}let O=null,D=null;if(v!==p){const B=gc(p,E,n,a);if(B.result==="error")throw new Error(B.value.map(F=>`${F.key}: ${F.message}`).join(", "));O=(F,U,Z,Y,re)=>B.value.evaluate(F,U,{},Z,void 0,void 0,Y,re),D=!Un(B.value.expression)}return{filter:x,dynamicFilter:O||void 0,needGeometry:e_(v),needFeature:!!D}}function Kg(c){if(!Array.isArray(c))return c;const n=function(a){if(Qg.has(a[0])){for(let h=1;h<a.length;h++)if(Hd(a[h]))return!0}return a}(c);return n===!0?n:n.map(a=>Kg(a))}function Jg(c){let n=!1;const a=[];if(c[0]==="case"){for(let h=1;h<c.length-1;h+=2)n=n||Hd(c[h]),a.push(c[h+1]);a.push(c[c.length-1])}else if(c[0]==="match"){n=n||Hd(c[1]);for(let h=2;h<c.length-1;h+=2)a.push(c[h+1]);a.push(c[c.length-1])}else if(c[0]==="step"){n=n||Hd(c[1]);for(let h=1;h<c.length-1;h+=2)a.push(c[h+1])}n&&(c.length=0,c.push("any",...a));for(let h=1;h<c.length;h++)Jg(c[h])}function Hd(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let a=1;a<c.length;a++)if(Hd(c[a]))return!0;return!1}const Qg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ey(c,n){return c<n?-1:c>n?1:0}function e_(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(e_(c[n]))return!0;return!1}function Rf(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Dm(c[1],c[2],"=="):n==="!="?Lf(Dm(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Dm(c[1],c[2],n):n==="any"?(a=c.slice(1),["any"].concat(a.map(Rf))):n==="all"?["all"].concat(c.slice(1).map(Rf)):n==="none"?["all"].concat(c.slice(1).map(Rf).map(Lf)):n==="in"?Rm(c[1],c.slice(2)):n==="!in"?Lf(Rm(c[1],c.slice(2))):n==="has"?Ay(c[1]):n!=="!has"||Lf(Ay(c[1]));var a}function Dm(c,n,a){switch(c){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,c,n]}}function Rm(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",c,["literal",n.sort(Ey)]]:["filter-in-small",c,["literal",n]]}}function Ay(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Lf(c){return["!",c]}const zf="";function Yh(c,n){return n?`${c}${zf}${n}`:c}const Ip="-transition",ah=new Set(["fill","line","background","hillshade","raster"]);class Fs extends Fo{constructor(n,a,h,p,v){if(super(),this.id=n.id,this.fqid=Yh(this.id,h),this.type=n.type,this.scope=h,this.lut=p,this.options=v,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const x=gc(this.filter,ft[`filter_${n.type}`]);x.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...x.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),a.layout&&(this._unevaluatedLayout=new Sy(a.layout,this.scope,v),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),a.paint){this._transitionablePaint=new Wg(a.paint,this.scope,v);for(const x in n.paint)this.setPaintProperty(x,n.paint[x]);for(const x in n.layout)this.setLayoutProperty(x,n.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qd(a.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D(!0)&&ah.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a){if(this.type==="custom"&&n==="visibility")return void(this.visibility=a);const h=this._unevaluatedLayout;h._properties.properties[n]&&(h.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return n.endsWith(Ip)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a){const h=this._transitionablePaint,p=h._properties.properties;if(n.endsWith(Ip)){const F=n.slice(0,-11);return p[F]&&h.setTransition(F,a||void 0),!1}if(!p[n])return!1;const v=h._values[n],x=v.value.isDataDriven(),E=v.value;h.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const O=h._values[n].value,D=O.isDataDriven(),B=n.endsWith("pattern")||n==="line-dasharray";return D||x||B||this._handleOverridablePaintPropertyUpdate(n,E,O)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,a,h){return null}_handleOverridablePaintPropertyUpdate(n,a,h){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){return zn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}is3D(n){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof $d&&Bd(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=Im(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,a,h,p,v,x,E,O,D){}}const i0={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Dp{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Qr{constructor(){this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&a.add(n.arrayBuffer),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ar(c,n=1){let a=0,h=0;return{members:c.map(p=>{const v=i0[p.type].BYTES_PER_ELEMENT,x=a=Rp(a,Math.max(n,v)),E=p.components||1;return h=Math.max(h,v),a+=v*E,{name:p.name,type:p.type,components:E,offset:x}}),size:Rp(a,Math.max(h,n)),alignment:n}}function Rp(c,n){return Math.ceil(c/n)*n}class _c extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const h=this.length;return this.resize(h+1),this.emplace(h,n,a)}emplace(n,a,h){const p=2*n;return this.int16[p+0]=a,this.int16[p+1]=h,n}}_c.prototype.bytesPerElement=4,Nn(_c,"StructArrayLayout2i4");class kf extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const v=3*n;return this.int16[v+0]=a,this.int16[v+1]=h,this.int16[v+2]=p,n}}kf.prototype.bytesPerElement=6,Nn(kf,"StructArrayLayout3i6");class Gd extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,h,p)}emplace(n,a,h,p,v){const x=4*n;return this.int16[x+0]=a,this.int16[x+1]=h,this.int16[x+2]=p,this.int16[x+3]=v,n}}Gd.prototype.bytesPerElement=8,Nn(Gd,"StructArrayLayout4i8");class Jc extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}Jc.prototype.bytesPerElement=4,Nn(Jc,"StructArrayLayout1f4");class Lm extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const v=4*n,x=2*n;return this.int16[v+0]=a,this.int16[v+1]=h,this.float32[x+1]=p,n}}Lm.prototype.bytesPerElement=8,Nn(Lm,"StructArrayLayout2i1f8");class Lp extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const v=4*n;return this.int16[v+0]=a,this.int16[v+1]=h,this.int16[v+2]=p,n}}Lp.prototype.bytesPerElement=8,Nn(Lp,"StructArrayLayout3i8");class Nf extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,h,p,v)}emplace(n,a,h,p,v,x){const E=5*n;return this.int16[E+0]=a,this.int16[E+1]=h,this.int16[E+2]=p,this.int16[E+3]=v,this.int16[E+4]=x,n}}Nf.prototype.bytesPerElement=10,Nn(Nf,"StructArrayLayout5i10");class Kh extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,a,h,p,v,x,E)}emplace(n,a,h,p,v,x,E,O){const D=6*n,B=12*n,F=3*n;return this.int16[D+0]=a,this.int16[D+1]=h,this.uint8[B+4]=p,this.uint8[B+5]=v,this.uint8[B+6]=x,this.uint8[B+7]=E,this.float32[F+2]=O,n}}Kh.prototype.bytesPerElement=12,Nn(Kh,"StructArrayLayout2i4ub1f12");class jl extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const v=3*n;return this.float32[v+0]=a,this.float32[v+1]=h,this.float32[v+2]=p,n}}jl.prototype.bytesPerElement=12,Nn(jl,"StructArrayLayout3f12");class Qc extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,h,p,v)}emplace(n,a,h,p,v,x){const E=6*n,O=3*n;return this.uint16[E+0]=a,this.uint16[E+1]=h,this.uint16[E+2]=p,this.uint16[E+3]=v,this.float32[O+2]=x,n}}Qc.prototype.bytesPerElement=12,Nn(Qc,"StructArrayLayout4ui1f12");class sh extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,h,p)}emplace(n,a,h,p,v){const x=4*n;return this.uint16[x+0]=a,this.uint16[x+1]=h,this.uint16[x+2]=p,this.uint16[x+3]=v,n}}sh.prototype.bytesPerElement=8,Nn(sh,"StructArrayLayout4ui8");class Zd extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,n,a,h,p,v,x)}emplace(n,a,h,p,v,x,E){const O=6*n;return this.int16[O+0]=a,this.int16[O+1]=h,this.int16[O+2]=p,this.int16[O+3]=v,this.int16[O+4]=x,this.int16[O+5]=E,n}}Zd.prototype.bytesPerElement=12,Nn(Zd,"StructArrayLayout6i12");class Wd extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D,B,F,U){const Z=this.length;return this.resize(Z+1),this.emplace(Z,n,a,h,p,v,x,E,O,D,B,F,U)}emplace(n,a,h,p,v,x,E,O,D,B,F,U,Z){const Y=12*n;return this.int16[Y+0]=a,this.int16[Y+1]=h,this.int16[Y+2]=p,this.int16[Y+3]=v,this.uint16[Y+4]=x,this.uint16[Y+5]=E,this.uint16[Y+6]=O,this.uint16[Y+7]=D,this.int16[Y+8]=B,this.int16[Y+9]=F,this.int16[Y+10]=U,this.int16[Y+11]=Z,n}}Wd.prototype.bytesPerElement=24,Nn(Wd,"StructArrayLayout4i4ui4i24");class Xd extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,n,a,h,p,v,x)}emplace(n,a,h,p,v,x,E){const O=10*n,D=5*n;return this.int16[O+0]=a,this.int16[O+1]=h,this.int16[O+2]=p,this.float32[D+2]=v,this.float32[D+3]=x,this.float32[D+4]=E,n}}Xd.prototype.bytesPerElement=20,Nn(Xd,"StructArrayLayout3i3f20");class Ta extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,h,p)}emplace(n,a,h,p,v){const x=4*n;return this.float32[x+0]=a,this.float32[x+1]=h,this.float32[x+2]=p,this.float32[x+3]=v,n}}Ta.prototype.bytesPerElement=16,Nn(Ta,"StructArrayLayout4f16");class Yd extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}Yd.prototype.bytesPerElement=4,Nn(Yd,"StructArrayLayout1ul4");class Es extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const h=this.length;return this.resize(h+1),this.emplace(h,n,a)}emplace(n,a,h){const p=2*n;return this.uint16[p+0]=a,this.uint16[p+1]=h,n}}Es.prototype.bytesPerElement=4,Nn(Es,"StructArrayLayout2ui4");class yc extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D,B,F,U,Z){const Y=this.length;return this.resize(Y+1),this.emplace(Y,n,a,h,p,v,x,E,O,D,B,F,U,Z)}emplace(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y){const re=20*n,he=10*n;return this.int16[re+0]=a,this.int16[re+1]=h,this.int16[re+2]=p,this.int16[re+3]=v,this.int16[re+4]=x,this.float32[he+3]=E,this.float32[he+4]=O,this.float32[he+5]=D,this.float32[he+6]=B,this.int16[re+14]=F,this.uint32[he+8]=U,this.uint16[re+18]=Z,this.uint16[re+19]=Y,n}}yc.prototype.bytesPerElement=40,Nn(yc,"StructArrayLayout5i4f1i1ul2ui40");class eu extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,a,h,p,v,x,E)}emplace(n,a,h,p,v,x,E,O){const D=8*n;return this.int16[D+0]=a,this.int16[D+1]=h,this.int16[D+2]=p,this.int16[D+4]=v,this.int16[D+5]=x,this.int16[D+6]=E,this.int16[D+7]=O,n}}eu.prototype.bytesPerElement=16,Nn(eu,"StructArrayLayout3i2i2i16");class zm extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,h,p,v)}emplace(n,a,h,p,v,x){const E=4*n,O=8*n;return this.float32[E+0]=a,this.float32[E+1]=h,this.float32[E+2]=p,this.int16[O+6]=v,this.int16[O+7]=x,n}}zm.prototype.bytesPerElement=16,Nn(zm,"StructArrayLayout2f1f2i16");class vc extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,n,a,h,p,v,x)}emplace(n,a,h,p,v,x,E){const O=20*n,D=5*n;return this.uint8[O+0]=a,this.uint8[O+1]=h,this.float32[D+1]=p,this.float32[D+2]=v,this.float32[D+3]=x,this.float32[D+4]=E,n}}vc.prototype.bytesPerElement=20,Nn(vc,"StructArrayLayout2ub4f20");class ra extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const v=3*n;return this.uint16[v+0]=a,this.uint16[v+1]=h,this.uint16[v+2]=p,n}}ra.prototype.bytesPerElement=6,Nn(ra,"StructArrayLayout3ui6");class za extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce,le,Te){const Me=this.length;return this.resize(Me+1),this.emplace(Me,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce,le,Te)}emplace(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce,le,Te,Me){const Re=30*n,et=15*n,Ye=60*n;return this.int16[Re+0]=a,this.int16[Re+1]=h,this.int16[Re+2]=p,this.float32[et+2]=v,this.float32[et+3]=x,this.uint16[Re+8]=E,this.uint16[Re+9]=O,this.uint32[et+5]=D,this.uint32[et+6]=B,this.uint32[et+7]=F,this.uint16[Re+16]=U,this.uint16[Re+17]=Z,this.uint16[Re+18]=Y,this.float32[et+10]=re,this.float32[et+11]=he,this.uint8[Ye+48]=_e,this.uint8[Ye+49]=Se,this.uint8[Ye+50]=Ce,this.uint32[et+13]=le,this.int16[Re+28]=Te,this.uint8[Ye+58]=Me,n}}za.prototype.bytesPerElement=60,Nn(za,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Bf extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce,le,Te,Me,Re,et,Ye,it,dt,Ct,tn,qt,Jt,sn,Ot){const Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce,le,Te,Me,Re,et,Ye,it,dt,Ct,tn,qt,Jt,sn,Ot)}emplace(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce,le,Te,Me,Re,et,Ye,it,dt,Ct,tn,qt,Jt,sn,Ot,Yt){const At=20*n,Mt=40*n,dn=80*n;return this.float32[At+0]=a,this.float32[At+1]=h,this.int16[Mt+4]=p,this.int16[Mt+5]=v,this.int16[Mt+6]=x,this.int16[Mt+7]=E,this.int16[Mt+8]=O,this.int16[Mt+9]=D,this.int16[Mt+10]=B,this.int16[Mt+11]=F,this.int16[Mt+12]=U,this.uint16[Mt+13]=Z,this.uint16[Mt+14]=Y,this.uint16[Mt+15]=re,this.uint16[Mt+16]=he,this.uint16[Mt+17]=_e,this.uint16[Mt+18]=Se,this.uint16[Mt+19]=Ce,this.uint16[Mt+20]=le,this.uint16[Mt+21]=Te,this.uint16[Mt+22]=Me,this.uint16[Mt+23]=Re,this.uint16[Mt+24]=et,this.uint16[Mt+25]=Ye,this.uint16[Mt+26]=it,this.uint16[Mt+27]=dt,this.uint32[At+14]=Ct,this.float32[At+15]=tn,this.float32[At+16]=qt,this.float32[At+17]=Jt,this.float32[At+18]=sn,this.uint8[dn+76]=Ot,this.uint16[Mt+39]=Yt,n}}Bf.prototype.bytesPerElement=80,Nn(Bf,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class zp extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,n,a,h,p,v,x)}emplace(n,a,h,p,v,x,E){const O=6*n;return this.float32[O+0]=a,this.float32[O+1]=h,this.float32[O+2]=p,this.float32[O+3]=v,this.float32[O+4]=x,this.float32[O+5]=E,n}}zp.prototype.bytesPerElement=24,Nn(zp,"StructArrayLayout6f24");class Mu extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,h,p,v)}emplace(n,a,h,p,v,x){const E=5*n;return this.float32[E+0]=a,this.float32[E+1]=h,this.float32[E+2]=p,this.float32[E+3]=v,this.float32[E+4]=x,n}}Mu.prototype.bytesPerElement=20,Nn(Mu,"StructArrayLayout5f20");class jf extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,a,h,p,v,x,E)}emplace(n,a,h,p,v,x,E,O){const D=7*n;return this.float32[D+0]=a,this.float32[D+1]=h,this.float32[D+2]=p,this.float32[D+3]=v,this.float32[D+4]=x,this.float32[D+5]=E,this.float32[D+6]=O,n}}jf.prototype.bytesPerElement=28,Nn(jf,"StructArrayLayout7f28");class km extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D,B,F){const U=this.length;return this.resize(U+1),this.emplace(U,n,a,h,p,v,x,E,O,D,B,F)}emplace(n,a,h,p,v,x,E,O,D,B,F,U){const Z=11*n;return this.float32[Z+0]=a,this.float32[Z+1]=h,this.float32[Z+2]=p,this.float32[Z+3]=v,this.float32[Z+4]=x,this.float32[Z+5]=E,this.float32[Z+6]=O,this.float32[Z+7]=D,this.float32[Z+8]=B,this.float32[Z+9]=F,this.float32[Z+10]=U,n}}km.prototype.bytesPerElement=44,Nn(km,"StructArrayLayout11f44");class Ou extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D){const B=this.length;return this.resize(B+1),this.emplace(B,n,a,h,p,v,x,E,O,D)}emplace(n,a,h,p,v,x,E,O,D,B){const F=9*n;return this.float32[F+0]=a,this.float32[F+1]=h,this.float32[F+2]=p,this.float32[F+3]=v,this.float32[F+4]=x,this.float32[F+5]=E,this.float32[F+6]=O,this.float32[F+7]=D,this.float32[F+8]=B,n}}Ou.prototype.bytesPerElement=36,Nn(Ou,"StructArrayLayout9f36");class Iu extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const h=this.length;return this.resize(h+1),this.emplace(h,n,a)}emplace(n,a,h){const p=2*n;return this.float32[p+0]=a,this.float32[p+1]=h,n}}Iu.prototype.bytesPerElement=8,Nn(Iu,"StructArrayLayout2f8");class Nm extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,h,p)}emplace(n,a,h,p,v){const x=6*n;return this.uint32[3*n+0]=a,this.uint16[x+2]=h,this.uint16[x+3]=p,this.uint16[x+4]=v,n}}Nm.prototype.bytesPerElement=12,Nn(Nm,"StructArrayLayout1ul3ui12");class Ff extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}Ff.prototype.bytesPerElement=2,Nn(Ff,"StructArrayLayout1ui2");class Kd extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he){const _e=this.length;return this.resize(_e+1),this.emplace(_e,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he)}emplace(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e){const Se=16*n;return this.float32[Se+0]=a,this.float32[Se+1]=h,this.float32[Se+2]=p,this.float32[Se+3]=v,this.float32[Se+4]=x,this.float32[Se+5]=E,this.float32[Se+6]=O,this.float32[Se+7]=D,this.float32[Se+8]=B,this.float32[Se+9]=F,this.float32[Se+10]=U,this.float32[Se+11]=Z,this.float32[Se+12]=Y,this.float32[Se+13]=re,this.float32[Se+14]=he,this.float32[Se+15]=_e,n}}Kd.prototype.bytesPerElement=64,Nn(Kd,"StructArrayLayout16f64");class Jh extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,v,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,a,h,p,v,x,E)}emplace(n,a,h,p,v,x,E,O){const D=10*n,B=5*n;return this.uint16[D+0]=a,this.uint16[D+1]=h,this.uint16[D+2]=p,this.uint16[D+3]=v,this.float32[B+2]=x,this.float32[B+3]=E,this.float32[B+4]=O,n}}Jh.prototype.bytesPerElement=20,Nn(Jh,"StructArrayLayout4ui3f20");class Bm extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.int16[1*n+0]=a,n}}Bm.prototype.bytesPerElement=2,Nn(Bm,"StructArrayLayout1i2");class Uf extends Qr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint8[1*n+0]=a,n}}Uf.prototype.bytesPerElement=1,Nn(Uf,"StructArrayLayout1ub1");class t_ extends Dp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}t_.prototype.size=40;class kp extends yc{get(n){return new t_(this,n)}}Nn(kp,"CollisionBoxArray");class Py extends Dp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Py.prototype.size=60;class n_ extends za{get(n){return new Py(this,n)}}Nn(n_,"PlacedSymbolArray");class As extends Dp{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}As.prototype.size=80;class Us extends Bf{get(n){return new As(this,n)}}Nn(Us,"SymbolInstanceArray");class jm extends Jc{getoffsetX(n){return this.float32[1*n+0]}}Nn(jm,"GlyphOffsetArray");class i_ extends _c{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}Nn(i_,"SymbolLineVertexArray");class r_ extends Dp{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}r_.prototype.size=12;class o_ extends Nm{get(n){return new r_(this,n)}}Nn(o_,"FeatureIndexArray");class a_ extends Es{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}Nn(a_,"FillExtrusionCentroidArray");class Np extends Dp{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Np.prototype.size=6;class Fm extends kf{get(n){return new Np(this,n)}}Nn(Fm,"FillExtrusionWallArray");const Cy=ar([{name:"a_pos",components:2,type:"Int16"}],4),My=ar([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),Bp=ar([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class wo{constructor(n=[]){this.segments=n}_prepareSegment(n,a,h,p){let v=this.segments[this.segments.length-1];return n>wo.MAX_VERTEX_ARRAY_LENGTH&&ui(`Max vertices per segment is ${wo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!v||v.vertexLength+n>wo.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p)&&(v={vertexOffset:a,primitiveOffset:h,vertexLength:0,primitiveLength:0},p!==void 0&&(v.sortKey=p),this.segments.push(v)),v}prepareSegment(n,a,h,p){return this._prepareSegment(n,a.length,h.length,p)}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,h,p){return new wo([{vertexOffset:n,primitiveOffset:a,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}function Um(c,n){return 256*(c=be(Math.floor(c),0,255))+be(Math.floor(n),0,255)}wo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nn(wo,"SegmentVector");const Vf=ar([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Vm=ar([{name:"a_pattern_b",components:4,type:"Uint16"}]),$m=ar([{name:"a_dash",components:4,type:"Uint16"}]);class Qh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,a,h,p){this.ids.push(jp(n)),this.positions.push(a,h,p)}eachPosition(n,a){const h=jp(n);let p=0,v=this.ids.length-1;for(;p<v;){const x=p+v>>1;this.ids[x]>=h?v=x:p=x+1}for(;this.ids[p]===h;)a(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(n,a){const h=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Fp(h,p,0,h.length-1),a&&(a.add(h.buffer),a.add(p.buffer)),{ids:h,positions:p}}static deserialize(n){const a=new Qh;let h;a.ids=n.ids,a.positions=n.positions;for(const p of a.ids)p!==h&&a.uniqueIds.push(p),h=p;return a.indexed=!0,a}}function jp(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:kn(String(c))}function Fp(c,n,a,h){for(;a<h;){const p=c[a+h>>1];let v=a-1,x=h+1;for(;;){do v++;while(c[v]<p);do x--;while(c[x]>p);if(v>=x)break;Jd(c,v,x),Jd(n,3*v,3*x),Jd(n,3*v+1,3*x+1),Jd(n,3*v+2,3*x+2)}x-a<h-x?(Fp(c,n,a,x),a=x+1):(Fp(c,n,x+1,h),h=x)}}function Jd(c,n,a){const h=c[n];c[n]=c[a],c[a]=h}Nn(Qh,"FeaturePositionMap");class Du{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,a),this.initialized=!0),!!this.location}set(n,a,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class xc extends Du{constructor(n){super(n),this.current=0}set(n,a,h){this.fetchUniformLocation(n,a)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class Vo extends Du{constructor(n){super(n),this.current=0}set(n,a,h){this.fetchUniformLocation(n,a)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Ru extends Du{constructor(n){super(n),this.current=[0,0]}set(n,a,h){this.fetchUniformLocation(n,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class $f extends Du{constructor(n){super(n),this.current=[0,0,0]}set(n,a,h){this.fetchUniformLocation(n,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class bc extends Du{constructor(n){super(n),this.current=[0,0,0,0]}set(n,a,h){this.fetchUniformLocation(n,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class s_ extends Du{constructor(n){super(n),this.current=Di.transparent.toPremultipliedRenderColor(null)}set(n,a,h){this.fetchUniformLocation(n,a)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const qm=new Float32Array(16);class Lu extends Du{constructor(n){super(n),this.current=qm}set(n,a,h){if(this.fetchUniformLocation(n,a)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let p=1;p<16;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const ga=new Float32Array(9),zu=new Float32Array(4);class Up extends Du{constructor(n){super(n),this.current=zu}set(n,a,h){if(this.fetchUniformLocation(n,a)){for(let p=0;p<4;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function Hm(c){return[Um(255*c.r,255*c.g),Um(255*c.b,255*c.a)]}class lh{constructor(n,a,h,p){this.value=n,this.uniformNames=a.map(v=>`u_${v}`),this.type=h,this.context=p}setUniform(n,a,h,p,v){const x=p.constantOr(this.value);a.set(n,v,x instanceof Di?x.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):x)}getBinding(n,a){return this.type==="color"?new s_(n):new Vo(n)}}class Yl{constructor(n,a){this.uniformNames=a.map(h=>`u_${h}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(n,a){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br),this.patternTransition=a?a.tl.concat(a.br):this.pattern}setUniform(n,a,h,p,v){let x=null;v!=="u_pattern"&&v!=="u_dash"||(x=this.pattern),v==="u_pattern_b"&&(x=this.patternTransition),v==="u_pixel_ratio"&&(x=this.pixelRatio),x&&a.set(n,v,x)}getBinding(n,a){return a==="u_pattern"||a==="u_pattern_b"||a==="u_dash"?new bc(n):new Vo(n)}}class ku{constructor(n,a,h,p){this.expression=n,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,a,h,p,v,x,E,O){const D=this.paintVertexArray.length,B=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Mr(0,{brightness:x,worldview:O}),a,{},v,p,E):this.expression.kind==="constant"&&this.expression.value,F=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Mr(0,{brightness:x,worldview:O}),a,{},v,p,E):this.lutExpression.value)==="none";this.paintVertexArray.resize(n),this._setPaintValue(D,n,B,F?null:this.context.lut)}updatePaintArray(n,a,h,p,v,x,E,O){const D=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:E,worldview:O},h,p,void 0,v):this.expression.kind==="constant"&&this.expression.value,B=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Mr(0,{brightness:E,worldview:O}),h,p,void 0,v):this.lutExpression.value)==="none";this._setPaintValue(n,a,D,B?null:this.context.lut)}_setPaintValue(n,a,h,p){if(this.type==="color"){const v=Hm(h.toPremultipliedRenderColor(p));for(let x=n;x<a;x++)this.paintVertexArray.emplace(x,v[0],v[1])}else{for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class wc{constructor(n,a,h,p,v,x){this.expression=n,this.uniformNames=a.map(E=>`u_${E}_t`),this.type=h,this.useIntegerZoom=p,this.context=v,this.maxValue=0,this.paintVertexAttributes=a.map(E=>({name:`a_${E}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,a,h,p,v,x,E,O){const D=this.expression.evaluate(new Mr(this.context.zoom,{brightness:x,worldview:O}),a,{},v,p,E),B=this.expression.evaluate(new Mr(this.context.zoom+1,{brightness:x,worldview:O}),a,{},v,p,E),F=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Mr(0,{brightness:x,worldview:O}),a,{},v,p,E):this.lutExpression.value)==="none",U=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(U,n,D,B,F?null:this.context.lut)}updatePaintArray(n,a,h,p,v,x,E,O){const D=this.expression.evaluate({zoom:this.context.zoom,brightness:E,worldview:O},h,p,void 0,v),B=this.expression.evaluate({zoom:this.context.zoom+1,brightness:E,worldview:O},h,p,void 0,v),F=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Mr(0,{brightness:E,worldview:O}),h,p,void 0,v):this.lutExpression.value)==="none";this._setPaintValue(n,a,D,B,F?null:this.context.lut)}_setPaintValue(n,a,h,p,v){if(this.type==="color"){const x=Hm(h.toPremultipliedRenderColor(v)),E=Hm(h.toPremultipliedRenderColor(v));for(let O=n;O<a;O++)this.paintVertexArray.emplace(O,x[0],x[1],E[0],E[1])}else{for(let x=n;x<a;x++)this.paintVertexArray.emplace(x,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a,h,p,v){const x=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,E=be(this.expression.interpolationFactor(x,this.context.zoom,this.context.zoom+1),0,1);a.set(n,v,E)}getBinding(n,a){return new Vo(n)}}class hl{constructor(n,a,h,p,v){this.expression=n,this.layerId=v,this.paintVertexAttributes=(h==="array"?$m:Vf).members;for(let x=0;x<a.length;++x);this.paintVertexArray=new p,this.paintTransitionVertexArray=new sh}populatePaintArray(n,a,h,p){const v=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(v,n,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(n,a,h,p,v,x,E){this._setPaintValues(n,a,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(n,a,h,p){if(!p||!h)return;const v=p[h[0]],x=p[h[1]];if(v){if(v){const{tl:E,br:O,pixelRatio:D}=v;for(let B=n;B<a;B++)this.paintVertexArray.emplace(B,E[0],E[1],O[0],O[1],D)}if(x){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:E,br:O}=x;for(let D=n;D<a;D++)this.paintTransitionVertexArray.emplace(D,E[0],E[1],O[0],O[1])}}}upload(n){const a=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,a)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=n.createVertexBuffer(this.paintTransitionVertexArray,Vm.members,a))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Cl{constructor(n,a,h=()=>!0){this.binders={},this._buffers=[],this.context=a;const p=[];for(const v in n.paint._values){const x=n.paint.get(v);if(v.endsWith("-use-theme")||!h(v)||!(x instanceof $d&&Bd(x.property.specification)))continue;const E=u(v,n.type),O=x.value,D=x.property.specification.type,B=!!x.property.useIntegerZoom,F=v==="line-dasharray"||v.endsWith("pattern"),U=n.paint.get(`${v}-use-theme`),Z=v==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant"||U&&U.value.kind!=="constant";if(O.kind!=="constant"||Z)if(O.kind==="source"||Z||F){const Y=S(v,D,"source");this.binders[v]=F?new hl(O,E,D,Y,n.id):new ku(O,E,D,Y),p.push(`/a_${v}`)}else{const Y=S(v,D,"composite");this.binders[v]=new wc(O,E,D,B,a,Y),p.push(`/z_${v}`)}else this.binders[v]=F?new Yl(O.value,E):new lh(O.value,E,D,a),p.push(`/u_${v}`);U&&(this.binders[v].lutExpression=U.value)}this.cacheKey=p.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof ku||a instanceof wc?a.maxValue:0}populatePaintArrays(n,a,h,p,v,x,E,O){for(const D in this.binders){const B=this.binders[D];B.context=this.context,(B instanceof ku||B instanceof wc||B instanceof hl)&&B.populatePaintArray(n,a,h,p,v,x,E,O)}}setConstantPatternPositions(n,a){for(const h in this.binders){const p=this.binders[h];p instanceof Yl&&p.setConstantPatternPositions(n,a)}}getPatternTransitionVertexBuffer(n){const a=this.binders[n];return a instanceof hl?a.paintTransitionVertexBuffer:null}updatePaintArrays(n,a,h,p,v,x,E,O,D,B){let F=!1;const U=Object.keys(n),Z=U.length!==0&&!O,Y=Z?U:a.uniqueIds;this.context.lut=v.lut;for(const re in this.binders){const he=this.binders[re];if(he.context=this.context,(he instanceof ku||he instanceof wc||he instanceof hl)&&he.expression&&he.expression.kind&&he.expression.kind!=="constant"&&(he.expression.isStateDependent===!0||he.expression.isLightConstant===!1)){const _e=v.paint.get(re);he.expression=_e.value;for(const Se of Y){const Ce=n[Se.toString()];a.eachPosition(Se,(le,Te,Me)=>{const Re=p.feature(le);he.updatePaintArray(Te,Me,Re,Ce,x,E,D,B)})}if(!Z)for(const Se of h.uniqueIds){const Ce=n[Se.toString()];h.eachPosition(Se,(le,Te,Me)=>{const Re=p.feature(le);he.updatePaintArray(Te,Me,Re,Ce,x,E,D,B)})}F=!0}}return F}defines(){const n=[];for(const a in this.binders){const h=this.binders[a];(h instanceof lh||h instanceof Yl)&&n.push(...h.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof ku||h instanceof wc||h instanceof hl)for(let p=0;p<h.paintVertexAttributes.length;p++)n.push(h.paintVertexAttributes[p].name);if(h instanceof hl)for(let p=0;p<Vm.members.length;p++)n.push(Vm.members[p].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof lh||h instanceof Yl||h instanceof wc)for(const p of h.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const a=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof lh||p instanceof Yl||p instanceof wc)for(const v of p.uniformNames)a.push({name:v,property:h,binding:p.getBinding(n,v)})}return a}setUniforms(n,a,h,p,v){for(const{name:x,property:E,binding:O}of h)this.binders[E].setUniform(n,O,v,p.get(E),x)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const a=this.binders[n];(a instanceof ku||a instanceof wc||a instanceof hl)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer),a instanceof hl&&a.paintTransitionVertexBuffer&&this._buffers.push(a.paintTransitionVertexBuffer)}}upload(n){for(const a in this.binders){const h=this.binders[a];(h instanceof ku||h instanceof wc||h instanceof hl)&&h.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof ku||a instanceof wc||a instanceof hl)&&a.destroy()}}}class m{constructor(n,a,h=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new Cl(p,a,h);this.needsUpload=!1,this._featureMap=new Qh,this._featureMapWithoutIds=new Qh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,a,h,p,v,x,E,O,D){for(const B in this.programConfigurations)this.programConfigurations[B].populatePaintArrays(n,a,p,v,x,E,O,D);a.id!==void 0?this._featureMap.add(a.id,h,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,h,p,v,x,E,O){for(const D of h)this.needsUpload=this.programConfigurations[D.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,a,D,p,v,x,E||0,O)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const r={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function u(c,n){return r[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const g={"line-pattern":{source:Qc,composite:Qc},"fill-pattern":{source:Qc,composite:Qc},"fill-extrusion-pattern":{source:Qc,composite:Qc},"line-dasharray":{source:sh,composite:sh}},w={color:{source:Iu,composite:Ta},number:{source:Jc,composite:Iu}};function S(c,n,a){const h=g[c];return h&&h[a]||w[n][a]}Nn(lh,"ConstantBinder"),Nn(Yl,"PatternConstantBinder"),Nn(ku,"SourceExpressionBinder"),Nn(hl,"PatternCompositeBinder"),Nn(wc,"CompositeExpressionBinder"),Nn(Cl,"ProgramConfiguration",{omit:["_buffers"]}),Nn(m,"ProgramConfigurationSet");const P=fn/Math.PI/2,R=5,N=6,V=16383,G=64,X=[G,32,16],W=-P,Q=P;function fe(c,n,a,h=P){return a=Tt(a),[c*Math.sin(a)*h,-n*h,c*Math.cos(a)*h]}function se(c,n,a){return fe(Math.cos(Tt(c)),Math.sin(Tt(c)),n,a)}const pe=63710088e-1,ye=2*Math.PI*pe;class we{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new we(nt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,h=this.lat*a,p=n.lat*a,v=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((n.lng-this.lng)*a);return pe*Math.acos(Math.min(v,1))}toBounds(n=0){const a=360*n/40075017,h=a/Math.cos(Math.PI/180*this.lat);return new De({lng:this.lng-h,lat:this.lat-a},{lng:this.lng+h,lat:this.lat+a})}toEcef(n){return se(this.lat,this.lng,P+n*P/pe)}static convert(n){if(n instanceof we)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new we(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new we(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class De{constructor(n,a){if(n)if(a)this.setSouthWest(n).setNorthEast(a);else if(n.length===4){const h=n;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=n;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(n){return this._ne=n instanceof we?new we(n.lng,n.lat):we.convert(n),this}setSouthWest(n){return this._sw=n instanceof we?new we(n.lng,n.lat):we.convert(n),this}extend(n){const a=this._sw,h=this._ne;let p,v;if(n instanceof we)p=n,v=n;else{if(!(n instanceof De))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(De.convert(n)):this.extend(we.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(we.convert(n)):this;if(p=n._sw,v=n._ne,!p||!v)return this}return a||h?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),h.lng=Math.max(v.lng,h.lng),h.lat=Math.max(v.lat,h.lat)):(this._sw=new we(p.lng,p.lat),this._ne=new we(v.lng,v.lat)),this}getCenter(){return new we((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new we(this.getWest(),this.getNorth())}getSouthEast(){return new we(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:h}=we.convert(n);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(n){if(n)return n instanceof De?n:new De(n)}}const Le=0,Ze=25.5;function Ue(c){return ye*Math.cos(c*Math.PI/180)}function Fe(c){return(180+c)/360}function ke(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function qe(c,n){return c/Ue(n)}function Ke(c){return 360*c-180}function pt(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function mt(c,n){return c*Ue(pt(n))}const It=85.051129;function Nt(c){return Math.cos(Tt(be(c,-85.051129,It)))}function Xt(c,n){const a=be(n,Le,Ze),h=Math.pow(2,a);return Nt(c)*ye/(512*h)}function ut(c){return 1/Math.cos(c*Math.PI/180)}function Et(c,n=0){const a=Math.exp(Math.PI*(1-(c.y+n/fn)/(1<<c.z)*2));return 80150034*a/(a*a+1)/fn/(1<<c.z)}class at{constructor(n,a,h=0){this.x=+n,this.y=+a,this.z=+h}static fromLngLat(n,a=0){const h=we.convert(n);return new at(Fe(h.lng),ke(h.lat),qe(a,h.lat))}toLngLat(){return new we(Ke(this.x),pt(this.y))}toAltitude(){return mt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ye*ut(pt(this.y))}}function jt(c,n,a,h,p,v,x,E,O){const D=(n+h)/2,B=(a+p)/2,F=new hn(D,B);E(F),function(U,Z,Y,re,he,_e){const Se=Y-he,Ce=re-_e;return Math.abs((re-Z)*Se-(Y-U)*Ce)/Math.hypot(Se,Ce)}(F.x,F.y,v.x,v.y,x.x,x.y)>=O?(jt(c,n,a,D,B,v,F,E,O),jt(c,D,B,h,p,F,x,E,O)):c.push(x)}function wt(c,n,a){let h=c[0],p=h.x,v=h.y;n(h);const x=[h];for(let E=1;E<c.length;E++){const O=c[E],{x:D,y:B}=O;n(O),jt(x,p,v,D,B,h,O,n,a),p=D,v=B,h=O}return x}function Ht(c,n,a,h){if(h(n,a)){const p=n.add(a)._mult(.5);Ht(c,n,p,h),Ht(c,p,a,h)}else c.push(a)}function pn(c,n){let a=c[0];const h=[a];for(let p=1;p<c.length;p++){const v=c[p];Ht(h,a,v,n),a=v}return h}const Ft=Math.pow(2,14)-1,rn=-Ft-1;function Bn(c,n){const a=Math.round(c.x*n),h=Math.round(c.y*n);return c.x=be(a,rn,Ft),c.y=be(h,rn,Ft),(a<c.x||a>c.x+1||h<c.y||h>c.y+1)&&ui("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function Dn(c,n,a){const h=c.loadGeometry(),p=c.extent,v=fn/p;if(n&&a&&a.projection.isReprojectedInTileSpace){const x=1<<n.z,{scale:E,x:O,y:D,projection:B}=a,F=U=>{const Z=Ke((n.x+U.x/p)/x),Y=pt((n.y+U.y/p)/x),re=B.project(Z,Y);U.x=(re.x*E-O)*p,U.y=(re.y*E-D)*p};for(let U=0;U<h.length;U++)if(c.type!==1)h[U]=wt(h[U],F,1);else{const Z=[];for(const Y of h[U])Y.x<0||Y.x>=p||Y.y<0||Y.y>=p||(F(Y),Z.push(Y));h[U]=Z}}for(const x of h)for(const E of x)Bn(E,v);return h}function On(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?Dn(c):[]}}var Yn,ni,Rn,Kn,ei,_i,Pi,Yi={};function fr(){if(ni)return Yn;ni=1;var c=Ca();function n(p,v,x,E,O){this.properties={},this.extent=x,this.type=0,this._pbf=p,this._geometry=-1,this._keys=E,this._values=O,p.readFields(a,this,v)}function a(p,v,x){p==1?v.id=x.readVarint():p==2?function(E,O){for(var D=E.readVarint()+E.pos;E.pos<D;){var B=O._keys[E.readVarint()],F=O._values[E.readVarint()];O.properties[B]=F}}(x,v):p==3?v.type=x.readVarint():p==4&&(v._geometry=x.pos)}function h(p){for(var v,x,E=0,O=0,D=p.length,B=D-1;O<D;B=O++)E+=((x=p[B]).x-(v=p[O]).x)*(v.y+x.y);return E}return Yn=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var v,x=p.readVarint()+p.pos,E=1,O=0,D=0,B=0,F=[];p.pos<x;){if(O<=0){var U=p.readVarint();E=7&U,O=U>>3}if(O--,E===1||E===2)D+=p.readSVarint(),B+=p.readSVarint(),E===1&&(v&&F.push(v),v=[]),v.push(new c(D,B));else{if(E!==7)throw new Error("unknown command "+E);v&&v.push(v[0].clone())}}return v&&F.push(v),F},n.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var v=p.readVarint()+p.pos,x=1,E=0,O=0,D=0,B=1/0,F=-1/0,U=1/0,Z=-1/0;p.pos<v;){if(E<=0){var Y=p.readVarint();x=7&Y,E=Y>>3}if(E--,x===1||x===2)(O+=p.readSVarint())<B&&(B=O),O>F&&(F=O),(D+=p.readSVarint())<U&&(U=D),D>Z&&(Z=D);else if(x!==7)throw new Error("unknown command "+x)}return[B,U,F,Z]},n.prototype.toGeoJSON=function(p,v,x){var E,O,D=this.extent*Math.pow(2,x),B=this.extent*p,F=this.extent*v,U=this.loadGeometry(),Z=n.types[this.type];function Y(_e){for(var Se=0;Se<_e.length;Se++){var Ce=_e[Se];_e[Se]=[360*(Ce.x+B)/D-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ce.y+F)/D)*Math.PI/180))-90]}}switch(this.type){case 1:var re=[];for(E=0;E<U.length;E++)re[E]=U[E][0];Y(U=re);break;case 2:for(E=0;E<U.length;E++)Y(U[E]);break;case 3:for(U=function(_e){var Se=_e.length;if(Se<=1)return[_e];for(var Ce,le,Te=[],Me=0;Me<Se;Me++){var Re=h(_e[Me]);Re!==0&&(le===void 0&&(le=Re<0),le===Re<0?(Ce&&Te.push(Ce),Ce=[_e[Me]]):Ce.push(_e[Me]))}return Ce&&Te.push(Ce),Te}(U),E=0;E<U.length;E++)for(O=0;O<U[E].length;O++)Y(U[E][O])}U.length===1?U=U[0]:Z="Multi"+Z;var he={type:"Feature",geometry:{type:Z,coordinates:U},properties:this.properties};return"id"in this&&(he.id=this.id),he},Yn}function ho(){if(Kn)return Rn;Kn=1;var c=fr();function n(h,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(a,this,p),this.length=this._features.length}function a(h,p,v){h===15?p.version=v.readVarint():h===1?p.name=v.readString():h===5?p.extent=v.readVarint():h===2?p._features.push(v.pos):h===3?p._keys.push(v.readString()):h===4&&p._values.push(function(x){for(var E=null,O=x.readVarint()+x.pos;x.pos<O;){var D=x.readVarint()>>3;E=D===1?x.readString():D===2?x.readFloat():D===3?x.readDouble():D===4?x.readVarint64():D===5?x.readVarint():D===6?x.readSVarint():D===7?x.readBoolean():null}return E}(v))}return Rn=n,n.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var p=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,p,this.extent,this._keys,this._values)},Rn}function wi(){return Pi||(Pi=1,Yi.VectorTile=function(){if(_i)return ei;_i=1;var c=ho();function n(a,h,p){if(a===3){var v=new c(p,p.readVarint()+p.pos);v.length&&(h[v.name]=v)}}return ei=function(a,h){this.layers=a.readFields(n,{},h)},ei}(),Yi.VectorTileFeature=fr(),Yi.VectorTileLayer=ho()),Yi}var xi=wi();const fi="3d_elevation_id",Pr="level";class Io{constructor(){this._valid=!1}reset(n){return this.feature=n,this._valid=!0,this._geometry=n.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(n,a){return this._valid&&n(a(this._geometry)),this}require(n,a,h){return this.get(n,!0,a,h)}optional(n,a,h){return this.get(n,!1,a,h)}success(){return this._valid}get(n,a,h,p){const v=this.feature.properties.hasOwnProperty(n)?+this.feature.properties[n]:void 0;return this._valid&&v!==void 0&&!Number.isNaN(v)?h(p?p(v):v):a&&(this._valid=!1),this}}class Br{constructor(n,a){this.featureFunc=n,this.vertexFunc=a}parseFeature(n,a,h){return this.featureFunc(n,a,h)}parseVertex(n,a,h){return this.vertexFunc(n,a,h)}}const Gi=new Br((c,n,a)=>c.reset(n).require(fi,h=>{a.id=h}).optional("fixed_height_relative",h=>{a.constantHeight=h},Ki.decodeRelativeHeight).geometry(h=>{a.bounds=h},Bh).success(),(c,n,a)=>c.reset(n).require(fi,h=>{a.id=h}).require("elevation_idx",h=>{a.idx=h}).require("extent",h=>{a.extent=h}).require("height_relative",h=>{a.height=h},Ki.decodeRelativeHeight).geometry(h=>{a.position=h},Ki.getPoint).success()),eo=new Br((c,n,a)=>c.reset(n).require(fi,h=>{a.id=h}).optional("fixed_height",h=>{a.constantHeight=h},Ki.decodeMetricHeight).geometry(h=>{a.bounds=h},Bh).success(),(c,n,a)=>c.reset(n).require(fi,h=>{a.id=h}).require("elevation_idx",h=>{a.idx=h}).require("extent",h=>{a.extent=h}).require("height",h=>{a.height=h},Ki.decodeMetricHeight).geometry(h=>{a.position=h},Ki.getPoint).success());class Ki{static getPoint(n){return Ea(n[0][0].x,n[0][0].y)}static decodeRelativeHeight(n){return 1e-4*n*5}static decodeMetricHeight(n){return 1e-4*n}static parse(n){const a=[],h=[],p=n.length,v=new Io;for(let E=0;E<p;E++){const O=n.feature(E),D=O.properties.hasOwnProperty("version")?String(O.properties.version):void 0,B=(x=D)?x==="1.0.1"?eo:void 0:Gi;if(B===void 0){ui(`Unknown elevation feature version number ${D||"(unknown)"}`);continue}const F=O.properties.hasOwnProperty("type")?O.properties.type:void 0;if(F){if(xi.VectorTileFeature.types[O.type]==="Point"&&F==="curve_point"){const U={};B.parseVertex(v,O,U)&&a.push(U)}else if(xi.VectorTileFeature.types[O.type]==="Polygon"&&F==="curve_meta"){const U={};B.parseFeature(v,O,U)&&h.push(U)}}}var x;return{vertices:a,features:h}}}class jr{constructor(n,a){this.pos=n,this.dir=a}intersectsPlane(n,a,h){const p=tr(a,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((n[0]-this.pos[0])*a[0]+(n[1]-this.pos[1])*a[1])/p;return h[0]=this.pos[0]+this.dir[0]*v,h[1]=this.pos[1]+this.dir[1]*v,!0}}class qr{constructor(n,a){this.pos=n,this.dir=a}intersectsPlane(n,a,h){const p=kt(a,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((n[0]-this.pos[0])*a[0]+(n[1]-this.pos[1])*a[1]+(n[2]-this.pos[2])*a[2])/p;return h[0]=this.pos[0]+this.dir[0]*v,h[1]=this.pos[1]+this.dir[1]*v,h[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(n,a,h){if(function(Z,Y){var re=Z[0],he=Z[1],_e=Z[2],Se=Y[0],Ce=Y[1],le=Y[2];return Math.abs(re-Se)<=C*Math.max(1,Math.abs(re),Math.abs(Se))&&Math.abs(he-Ce)<=C*Math.max(1,Math.abs(he),Math.abs(Ce))&&Math.abs(_e-le)<=C*Math.max(1,Math.abs(_e),Math.abs(le))}(this.pos,n)||a===0)return h[0]=h[1]=h[2]=0,!1;const[p,v,x]=this.dir,E=this.pos[0]-n[0],O=this.pos[1]-n[1],D=this.pos[2]-n[2],B=p*p+v*v+x*x,F=2*(E*p+O*v+D*x),U=F*F-4*B*(E*E+O*O+D*D-a*a);if(U<0){const Z=Math.max(-F/2,0),Y=E+p*Z,re=O+v*Z,he=D+x*Z,_e=Math.hypot(Y,re,he);return h[0]=Y*a/_e,h[1]=re*a/_e,h[2]=he*a/_e,!1}{const Z=(-F-Math.sqrt(U))/(2*B);if(Z<0){const Y=Math.hypot(E,O,D);return h[0]=E*a/Y,h[1]=O*a/Y,h[2]=D*a/Y,!1}return h[0]=E+p*Z,h[1]=O+v*Z,h[2]=D+x*Z,!0}}}class Lr{constructor(n,a,h,p,v){this.TL=n,this.TR=a,this.BR=h,this.BL=p,this.horizon=v}static fromInvProjectionMatrix(n,a,h){const p=[-1,1,1],v=[1,1,1],x=[1,-1,1],E=[-1,-1,1],O=Dt(p,p,n),D=Dt(v,v,n),B=Dt(x,x,n),F=Dt(E,E,n);return new Lr(O,D,B,F,a/h)}}function Fr(c,n,a){let h=1/0,p=-1/0;const v=[];for(const x of c){ci(v,x,n);const E=kt(v,a);h=Math.min(h,E),p=Math.max(p,E)}return[h,p]}function xr(c,n){let a=!0;for(let h=0;h<c.planes.length;h++){const p=c.planes[h];let v=0;for(let x=0;x<n.length;x++)v+=kt(p,n[x])+p[3]>=0;if(v===0)return 0;v!==n.length&&(a=!1)}return a?2:1}function Gr(c,n){for(const a of c.projections){const h=Fr(n,c.points[0],a.axis);if(a.projection[1]<h[0]||a.projection[0]>h[1])return 0}return 1}function fo(c,n){let a=0;const h=[0,0,0,0];for(let x=0;x<c.length;x++)h[0]=c[x][0],h[1]=c[x][1],h[2]=c[x][2],h[3]=1,(p=h)[0]*(v=n)[0]+p[1]*v[1]+p[2]*v[2]+p[3]*v[3]>=0&&a++;var p,v;return a}class Or{constructor(n,a){this.points=n||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=sr.fromPoints(this.points),this.projections=[],this.frustumEdges=[ci([],this.points[2],this.points[3]),ci([],this.points[0],this.points[3]),ci([],this.points[4],this.points[0]),ci([],this.points[5],this.points[1]),ci([],this.points[6],this.points[2]),ci([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const p=[0,-h[2],h[1]],v=[h[2],0,-h[0]];this.projections.push({axis:p,projection:Fr(this.points,this.points[0],p)}),this.projections.push({axis:v,projection:Fr(this.points,this.points[0],v)})}}static fromInvProjectionMatrix(n,a,h,p){const v=Math.pow(2,h),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const B=Xr([],D,n),F=1/B[3]/a*v;return(U=B)[0]=(Z=B)[0]*(Y=[F,F,p?1/B[3]:F,F])[0],U[1]=Z[1]*Y[1],U[2]=Z[2]*Y[2],U[3]=Z[3]*Y[3],U;var U,Z,Y}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const B=ct([],In([],ci([],x[D[0]],x[D[1]]),ci([],x[D[2]],x[D[1]]))),F=-kt(B,x[D[1]]);return B.concat(F)}),O=[];for(let D=0;D<x.length;D++)O.push([x[D][0],x[D][1],x[D][2]]);return new Or(O,E)}intersectsPrecise(n,a,h){for(let p=0;p<a.length;p++)if(!fo(n,a[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!fo(n,this.planes[p]))return 0;for(const p of h)for(const v of this.frustumEdges){const x=In([],p,v),E=yt(x);if(E===0)continue;$e(x,x,1/E);const O=Fr(this.points,this.points[0],x),D=Fr(n,this.points[0],x);if(O[0]>D[1]||D[0]>O[1])return 0}return 1}containsPoint(n){for(const a of this.planes){const h=a[3];if(kt([a[0],a[1],a[2]],n)+h<0)return!1}return!0}}class sr{static fromPoints(n){const a=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const p of n)Vt(a,a,p),Ln(h,h,p);return new sr(a,h)}static fromTileIdAndHeight(n,a,h){const p=1<<n.canonical.z,v=n.canonical.x,x=n.canonical.y;return new sr([v/p,x/p,a],[(v+1)/p,(x+1)/p,h])}static applyTransform(n,a){const h=n.getCorners();for(let p=0;p<h.length;++p)Dt(h[p],h[p],a);return sr.fromPoints(h)}static applyTransformFast(n,a){const h=[a[12],a[13],a[14]],p=[...h];for(let v=0;v<3;v++)for(let x=0;x<3;x++){const E=a[4*x+v],O=E*n.min[x],D=E*n.max[x];h[v]+=Math.min(O,D),p[v]+=Math.max(O,D)}return new sr(h,p)}static projectAabbCorners(n,a){const h=n.getCorners();for(let p=0;p<h.length;++p)Dt(h[p],h[p],a);return h}constructor(n,a){this.min=n,this.max=a,this.center=$e([],zt([],this.min,this.max),.5)}quadrant(n){const a=[n%2==0,n<2],h=xt(this.min),p=xt(this.max);for(let v=0;v<a.length;v++)h[v]=a[v]?this.min[v]:this.center[v],p[v]=a[v]?this.center[v]:this.max[v];return p[2]=this.max[2],new sr(h,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,a=this.max;return[[n[0],n[1],n[2]],[a[0],n[1],n[2]],[a[0],a[1],n[2]],[n[0],a[1],n[2]],[n[0],n[1],a[2]],[a[0],n[1],a[2]],[a[0],a[1],a[2]],[n[0],a[1],a[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?xr(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?xr(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,a){return a||this.intersects(n)?Gr(n,this.getCorners()):0}intersectsPreciseFlat(n,a){return a||this.intersectsFlat(n)?Gr(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let a=0;a<3;++a)if(this.min[a]>n.max[a]||n.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n.min[a]),this.max[a]=Math.max(this.max[a],n.max[a])}encapsulatePoint(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n[a]),this.max[a]=Math.max(this.max[a],n[a])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}Nn(sr,"Aabb");class Ps{constructor(n,a){this.feature=n,this.metersToTile=a,this.index=0}get(){const n=this.feature.vertices[this.index],a=this.feature.vertexProps[this.index].dir,h=a[1],p=-a[0],v=(n.extent+1)*this.metersToTile;return[new hn(Math.trunc(n.position[0]+h*v),Math.trunc(n.position[1]+p*v)),new hn(Math.trunc(n.position[0]-h*v),Math.trunc(n.position[1]-p*v))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Ys{constructor(n,a,h,p,v,x){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=n,this.heightRange={min:h,max:h},this.safeArea=a,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=v,this.edges=this.edges.filter(E=>{return E.a<this.vertices.length&&E.b<this.vertices.length&&!((O=this.vertices[E.a].position)[0]===(D=this.vertices[E.b].position)[0]&&O[1]===D[1]);var O,D}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const E of this.vertices)this.vertexProps.push({dir:Ea(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,E.height),this.heightRange.max=Math.max(this.heightRange.max,E.height);for(const E of this.edges){const O=this.vertices[E.a].position,D=this.vertices[E.b].position,B=Co(ro(),D,O),F=Aa(B),U=ea(ro(),B,1/F);this.edgeProps.push({vec:B,dir:U,len:F});const Z=this.vertexProps[E.a].dir,Y=this.vertexProps[E.b].dir;Ua(Z,Z,U),Ua(Y,Y,U)}for(const E of this.vertexProps)E.dir[0]===0&&E.dir[1]===0||Go(E.dir,E.dir);this.tessellate(x)}}pointElevation(n){if(this.constantHeight!=null)return this.constantHeight;const a=this.getClosestEdge(n);if(a==null)return 0;const[h,p]=a;return Xn(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,p)}computeSlopeNormal(n,a){const h=this.getClosestEdge(n);if(!h)return ot(0,0,1);const p=h[0],v=this.edges[p],x=this.edgeProps[p].vec,E=ot(x[0],x[1],(this.vertices[v.b].height-this.vertices[v.a].height)*a),O=ot(E[1],-E[0],0);In(O,O,E);const D=yt(O);return D>0?$e(O,O,1/D):ot(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(n){if(this.edges.length===0)return;let a=0,h=Number.POSITIVE_INFINITY,p=0;const v=Ea(n.x,n.y);for(let x=0;x<this.edges.length;x++){const E=this.edges[x],O=this.edgeProps[x].dir,D=new jr(v,this.edgeProps[x].dir),B=this.vertices[E.a].position,F=this.vertices[E.b].position,U=ro(),Z=ro(),Y=D.intersectsPlane(B,this.vertexProps[E.a].dir,U),re=D.intersectsPlane(F,this.vertexProps[E.b].dir,Z);if(!Y||!re)continue;const he=Co(ro(),Z,U),_e=Co(ro(),v,U),Se=tr(he,he),Ce=Se>0?tr(_e,he)/Se:0,le=be(Ce,0,1),Te=Math.abs((Ce-le)*this.edgeProps[x].len),Me=Co(ro(),v,B),Re=Te+Math.abs(tr(Me,Ea(O[1],-O[0])));Re<h&&(a=x,h=Re,p=le)}return[a,p]}tessellate(n){for(let a=this.edges.length-1;a>=0;--a){const h=this.edges[a].a,p=this.edges[a].b,{position:v,height:x,extent:E}=this.vertices[h],{position:O,height:D,extent:B}=this.vertices[p],F=this.vertexProps[h].dir,U=this.vertexProps[p].dir,Z=ot(v[0]/n,v[1]/n,x),Y=ot(O[0]/n,O[1]/n,D),re=ot(F[1],-F[0],0);$e(re,re,E);const he=ot(U[1],-U[0],0);if($e(he,he,B),this.distSqLines(ot(Z[0]+.5*re[0],Z[1]+.5*re[1],Z[2]+.5*re[2]),ot(Y[0]-.5*he[0],Y[1]-.5*he[1],Y[2]-.5*he[2]),ot(Z[0]-.5*re[0],Z[1]-.5*re[1],Z[2]-.5*re[2]),ot(Y[0]+.5*he[0],Y[1]+.5*he[1],Y[2]+.5*he[2]))<=.0025000000000000005)continue;const _e=this.vertices.length,Se=Ua(ro(),v,O);this.vertices.push({position:ea(Se,Se,.5),height:.5*(x+D),extent:.5*(E+B)});const Ce=Ua(ro(),F,U);this.vertexProps.push({dir:Go(Ce,Ce)}),this.edges.splice(a,1),this.edgeProps.splice(a,1),this.edges.push({a:h,b:_e}),this.edges.push({a:_e,b:p});const le=Co(ro(),this.vertices[_e].position,v),Te=Aa(le),Me={vec:le,dir:ea(ro(),le,1/Te),len:Te};this.edgeProps.push(Me),this.edgeProps.push(Me)}}distSqLines(n,a,h,p){const v=rt(Ve(),a,n),x=rt(Ve(),p,h),E=rt(Ve(),n,h),O=kt(v,v),D=kt(v,x),B=kt(v,E),F=kt(x,x),U=kt(x,E),Z=O*F-D*D;if(Z===0){const he=kt(E,x)/kt(x,x);return $t(ti(Ve(),h,p,he),n)}const Y=(D*U-B*F)/Z,re=(O*U-D*B)/Z;return $t(ti(Ve(),n,a,Y),ti(Ve(),h,p,re))}}class Ml{static parseFrom(n,a){const h=Ki.parse(n);if(!h)return[];let{vertices:p,features:v}=h;const x=1/Et(a);v.sort((B,F)=>B.id-F.id),p.sort((B,F)=>B.id-F.id||B.idx-F.idx),p=p.filter((B,F,U)=>F===U.findIndex(Z=>Z.id===B.id&&Z.idx===B.idx));const E=new Array;let O=0;const D=p.length;for(const B of v){if(B.constantHeight){E.push(new Ys(B.id,B.bounds,B.constantHeight));continue}for(;O!==D&&p[O].id<B.id;)O++;if(O===D||p[O].id!==B.id)continue;const F=new Array,U=new Array,Z=O;for(;O!==D&&p[O].id===B.id;){const Y=p[O];if(F.push({position:Y.position,height:Y.height,extent:Y.extent}),O!==Z&&p[O-1].idx===Y.idx-1){const re=O-Z;U.push({a:re-1,b:re})}O++}E.push(new Ys(B.id,B.bounds,void 0,F,U,x))}return E}static getElevationFeature(n,a){if(!a)return;const h=+n.properties[fi];return Number.isNaN(h)?void 0:a.find(p=>p.id===h)}}class Tc{constructor(n,a){this.zScale=1,this.xOffset=0,this.yOffset=0,n.equals(a)||(this.zScale=Math.pow(2,a.z-n.z),this.xOffset=(n.x*this.zScale-a.x)*fn,this.yOffset=(n.y*this.zScale-a.y)*fn)}constantElevation(n,a){if(n.constantHeight!=null)return this.computeBiasedHeight(n.constantHeight,a)}pointElevation(n,a,h){const p=this.constantElevation(a,h);return p??(n.x=n.x*this.zScale+this.xOffset,n.y=n.y*this.zScale+this.yOffset,this.computeBiasedHeight(a.pointElevation(n),h))}computeBiasedHeight(n,a){return a<=0?n:n+a*We(0,a,n>=0?n:Math.abs(.5*n))}}Nn(Ys,"ElevationFeature");class dl{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new _c,this.indexArray=new ra,this.segments=new wo,this.programConfigurations=new m(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new Jc),this.worldview=n.worldview}updateFootprints(n,a){}populate(n,a,h,p){const v=this.layers[0],x=[];let E=null;v.type==="circle"&&(E=v.layout.get("circle-sort-key"));for(const{feature:D,id:B,index:F,sourceLayerIndex:U}of n){const Z=this.layers[0]._featureFilter.needGeometry,Y=On(D,Z);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom,{worldview:this.worldview}),Y,h))continue;const re=E?E.evaluate(Y,{},h):void 0,he={id:B,properties:D.properties,type:D.type,sourceLayerIndex:U,index:F,geometry:Z?Y.geometry:Dn(D,h,p),patterns:{},sortKey:re};x.push(he)}E&&x.sort((D,B)=>D.sortKey-B.sortKey);let O=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Zd,O=p.projection);for(const D of x){const{geometry:B,index:F,sourceLayerIndex:U}=D,Z=n[F].feature;this.addFeature(D,B,F,a.availableImages,h,O,a.brightness,a.elevationFeatures),a.featureIndex.insert(Z,B,F,U,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(n,a,h,p,v,x,E){this.programConfigurations.updatePaintArrays(n,a,v,h,p,x,E,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Cy.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,Bp.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=n.createVertexBuffer(this.elevatedLayoutVertexArray,My.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(n,a,h,p,v,x,E,O){let D;this.elevationMode!=="none"&&(D=Ml.getElevationFeature(n,O));for(const B of a)for(const F of B){const U=F.x,Z=F.y;if(U<0||U>=fn||Z<0||Z>=fn)continue;if(x){const he=x.projectTilePoint(U,Z,v),_e=x.upVector(v,U,Z);this.addGlobeExtVertex(he,_e),this.addGlobeExtVertex(he,_e),this.addGlobeExtVertex(he,_e),this.addGlobeExtVertex(he,_e)}const Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),re=Y.vertexLength;if(this.addCircleVertex(U,Z,-1,-1),this.addCircleVertex(U,Z,1,-1),this.addCircleVertex(U,Z,1,1),this.addCircleVertex(U,Z,-1,1),this.elevationMode!=="none"){const he=D?D.pointElevation(new hn(U,Z)):0;this.hasElevation=this.hasElevation||he!==0;for(let _e=0;_e<4;_e++)this.elevatedLayoutVertexArray.emplaceBack(he)}this.indexArray.emplaceBack(re,re+1,re+2),this.indexArray.emplaceBack(re,re+2,re+3),Y.vertexLength+=4,Y.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,{},p,v,E,void 0,this.worldview)}addCircleVertex(n,a,h,p){this.layoutVertexArray.emplaceBack(2*n+(h+1)/2,2*a+(p+1)/2)}addGlobeExtVertex(n,a){this.globeExtVertexArray.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}}function Ks(c,n){for(let a=0;a<c.length;a++)if(tu(n,c[a]))return!0;for(let a=0;a<n.length;a++)if(tu(c,n[a]))return!0;return!!qf(c,n)}function fs(c,n,a){return!!tu(c,n)||!!ed(n,c,a)}function Sc(c,n){if(c.length===1)return ch(n,c[0]);for(let a=0;a<n.length;a++){const h=n[a];for(let p=0;p<h.length;p++)if(tu(c,h[p]))return!0}for(let a=0;a<c.length;a++)if(ch(n,c[a]))return!0;for(let a=0;a<n.length;a++)if(qf(c,n[a]))return!0;return!1}function ps(c,n,a){if(c.length>1){if(qf(c,n))return!0;for(let h=0;h<n.length;h++)if(ed(n[h],c,a))return!0}for(let h=0;h<c.length;h++)if(ed(c[h],n,a))return!0;return!1}function qf(c,n){if(c.length===0||n.length===0)return!1;for(let a=0;a<c.length-1;a++){const h=c[a],p=c[a+1];for(let v=0;v<n.length-1;v++)if(Gm(h,p,n[v],n[v+1]))return!0}return!1}function Gm(c,n,a,h){return Wi(c,a,h)!==Wi(n,a,h)&&Wi(c,n,a)!==Wi(c,n,h)}function Hf(c,n,a){return(c.x-a.x)*(n.y-a.y)-(c.y-a.y)*(n.x-a.x)}function Nu(c,n,a,h){const p=Hf(c,n,h),v=Hf(c,n,a);if(Math.sign(p)===Math.sign(v))return;const x=Hf(a,h,c),E=x+v-p;return Math.sign(x)!==Math.sign(E)?[x/(x-E),v/(v-p)]:void 0}function ed(c,n,a){const h=a*a;if(n.length===1)return c.distSqr(n[0])<h;for(let p=1;p<n.length;p++)if(Gf(c,n[p-1],n[p])<h)return!0;return!1}function Gf(c,n,a){const h=n.distSqr(a);if(h===0)return c.distSqr(n);const p=((c.x-n.x)*(a.x-n.x)+(c.y-n.y)*(a.y-n.y))/h;return c.distSqr(p<0?n:p>1?a:a.sub(n)._mult(p)._add(n))}function ch(c,n){let a,h,p,v=!1;for(let x=0;x<c.length;x++){a=c[x];for(let E=0,O=a.length-1;E<a.length;O=E++)h=a[E],p=a[O],h.y>n.y!=p.y>n.y&&n.x<(p.x-h.x)*(n.y-h.y)/(p.y-h.y)+h.x&&(v=!v)}return v}function tu(c,n){let a=!1;for(let h=0,p=c.length-1;h<c.length;p=h++){const v=c[h],x=c[p];v.y>n.y!=x.y>n.y&&n.x<(x.x-v.x)*(n.y-v.y)/(x.y-v.y)+v.x&&(a=!a)}return a}function Qd(c,n,a,h,p){for(const x of c)if(n<=x.x&&a<=x.y&&h>=x.x&&p>=x.y)return!0;const v=[new hn(n,a),new hn(n,p),new hn(h,p),new hn(h,a)];if(c.length>2){for(const x of v)if(tu(c,x))return!0}for(let x=0;x<c.length-1;x++)if(td(c[x],c[x+1],v))return!0;return!1}function td(c,n,a){const h=a[0],p=a[2];if(c.x<h.x&&n.x<h.x||c.x>p.x&&n.x>p.x||c.y<h.y&&n.y<h.y||c.y>p.y&&n.y>p.y)return!1;const v=Wi(c,n,a[0]);return v!==Wi(c,n,a[1])||v!==Wi(c,n,a[2])||v!==Wi(c,n,a[3])}function Bu(c,n,a,h,p,v){let x=n.y-c.y,E=c.x-n.x;if(v=v||0){const O=x*x+E*E;if(O===0)return!0;const D=Math.sqrt(O);x/=D,E/=D}return!((a.x-c.x)*x+(a.y-c.y)*E-v<0||(h.x-c.x)*x+(h.y-c.y)*E-v<0||(p.x-c.x)*x+(p.y-c.y)*E-v<0)}function l_(c,n,a,h,p,v,x){return!(Bu(c,n,h,p,v,x)||Bu(n,a,h,p,v,x)||Bu(a,c,h,p,v,x)||Bu(h,p,c,n,a,x)||Bu(p,v,c,n,a,x)||Bu(v,h,c,n,a,x))}function Zm(c,n,a){const h=n.paint.get(c).value;return h.kind==="constant"?h.value:a.programConfigurations.get(n.id).getMaxValue(c)}function Oy(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Eb(c,n,a,h,p){if(!n[0]&&!n[1])return c;const v=hn.convert(n)._mult(p);a==="viewport"&&v._rotate(-h);const x=[];for(let E=0;E<c.length;E++)x.push(c[E].sub(v));return x}function r0(c,n,a,h){const p=hn.convert(c)._mult(h);return n==="viewport"&&p._rotate(-a),p}let o0,Vp;function c_(c,n,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[c*h-2*Math.PI*6378137/2,n*h-2*Math.PI*6378137/2]}Nn(dl,"CircleBucket",{omit:["layers"]});class Zf{constructor(n,a,h){this.z=n,this.x=a,this.y=h,this.key=$p(0,n,n,a,h)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a){const h=function(v,x,E){var O=c_(256*v,256*(x=Math.pow(2,E)-x-1),E),D=c_(256*(v+1),256*(x+1),E);return O[0]+","+O[1]+","+D[0]+","+D[1]}(this.x,this.y,this.z),p=function(v,x,E){let O,D="";for(let B=v;B>0;B--)O=1<<B-1,D+=(x&O?1:0)+(E&O?2:0);return D}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class a0{constructor(n,a){this.wrap=n,this.canonical=a,this.key=$p(n,a.z,a.z,a.x,a.y)}}class Js{constructor(n,a,h,p,v){this.overscaledZ=n,this.wrap=a,this.canonical=new Zf(h,+p,+v),this.key=a===0&&n===h?this.canonical.key:$p(a,n,h,p,v)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const a=this.canonical.z-n;return n>this.canonical.z?new Js(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Js(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a=!0){if(this.overscaledZ===n&&a)return this.key;if(n>this.canonical.z)return $p(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-n;return $p(this.wrap*+a,n,n,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new Js(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new Js(a,this.wrap,a,h,p),new Js(a,this.wrap,a,h+1,p),new Js(a,this.wrap,a,h,p+1),new Js(a,this.wrap,a,h+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Js(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Js(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new a0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function $p(c,n,a,h,p){const v=1<<Math.min(a,22);let x=v*(p%v)+h%v;return c&&a<22&&(x+=v*v*((c<0?-2*c-1:2*c)%(1<<2*(22-a)))),16*(32*x+a)+(n-a)}const Ab=[c=>{let n=c.canonical.x-1,a=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,a--),new Js(c.overscaledZ,a,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,a=c.wrap;return n===1<<c.canonical.z&&(n=0,a++),new Js(c.overscaledZ,a,c.canonical.z,n,c.canonical.y)},c=>new Js(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new Js(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];Nn(Zf,"CanonicalTileID"),Nn(Js,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Pb=ar([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:qp}=Pb,Cb=ar([{name:"a_pos_3",components:3,type:"Int16"}]);var s0=ar([{name:"a_pos",type:"Int16",components:2}]);function Xo(c){return c*P/pe}const l0=[new sr([W,W,W],[Q,Q,Q]),new sr([W,W,W],[0,0,Q]),new sr([0,W,W],[Q,0,Q]),new sr([W,0,W],[0,Q,Q]),new sr([0,0,W],[Q,Q,Q])];function Mb(c,n,a,h=!0){const p=$e([],c._camera.position,c.worldSize),v=[n,a,1,1];Xr(v,v,c.pixelMatrixInverse),kr(v,v,1/v[3]);const x=ct([],ci([],v,p)),E=c.globeMatrix,O=[E[12],E[13],E[14]],D=ci([],O,p),B=yt(D),F=ct([],D),U=c.worldSize/(2*Math.PI),Z=kt(F,x),Y=Math.asin(U/B);if(Y<Math.acos(Z)){if(!h)return null;const it=[],dt=[];$e(it,x,B/Z),ct(dt,ci(dt,it,D)),ct(x,zt(x,D,$e(x,dt,Math.tan(Y)*B)))}const re=[];new qr(p,x).closestPointOnSphere(O,U,re);const he=ct([],nr(E,0)),_e=ct([],nr(E,1)),Se=ct([],nr(E,2)),Ce=kt(he,re),le=kt(_e,re),Te=kt(Se,re),Me=je(Math.asin(-le/U));let Re=je(Math.atan2(Ce,Te));Re=c.center.lng+function(it,dt){const Ct=(dt-it+180)%360-180;return Ct<-180?Ct+360:Ct}(c.center.lng,Re);const et=Fe(Re),Ye=be(ke(Me),0,1);return new at(et,Ye)}class Ob{constructor(n,a,h){this.a=ci([],n,h),this.b=ci([],a,h),this.center=h;const p=ct([],this.a),v=ct([],this.b);this.angle=Math.acos(kt(p,v))}}function c0(c,n){if(c.angle===0)return null;let a;return a=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),a<0||a>1?null:function(h,p,v,x){const E=Math.sin(v);return h*(Math.sin((1-x)*v)/E)+p*(Math.sin(x*v)/E)}(c.a[n],c.b[n],c.angle,be(a,0,1))+c.center[n]}function nd(c){if(c.z<=1)return l0[c.z+2*c.y+c.x];const n=Xm(Wm(c));return sr.fromPoints(n)}function ef(c,n,a){return $e(c,c,1-a),Pt(c,c,n,a)}function u_(c,n,a){for(const h of c)Dt(h,h,n),$e(h,h,a)}function Hp(c,n,a,h){const p=n/c.worldSize,v=c.globeMatrix;if(a.z<=1){const Ye=nd(a).getCorners();return u_(Ye,v,p),sr.fromPoints(Ye)}const x=Wm(a,h),E=Xm(x,P+Xo(c._tileCoverLift));u_(E,v,p);const O=Number.MAX_VALUE,D=[-O,-O,-O],B=[O,O,O];if(x.contains(c.center)){for(const dt of E)Vt(B,B,dt),Ln(D,D,dt);D[2]=0;const Ye=c.point,it=[Ye.x*p,Ye.y*p,0];return Vt(B,B,it),Ln(D,D,it),new sr(B,D)}if(c._tileCoverLift>0){for(const Ye of E)Vt(B,B,Ye),Ln(D,D,Ye);return new sr(B,D)}const F=[v[12]*p,v[13]*p,v[14]*p],U=x.getCenter(),Z=be(c.center.lat,-85.051129,It),Y=be(U.lat,-85.051129,It),re=Fe(c.center.lng),he=ke(Z);let _e=re-Fe(U.lng);const Se=he-ke(Y);_e>.5?_e-=1:_e<-.5&&(_e+=1);let Ce=0;Math.abs(_e)>Math.abs(Se)?Ce=_e>=0?1:3:(Ce=Se>=0?0:2,Pt(F,F,[v[4]*p,v[5]*p,v[6]*p],-Math.sin(Tt(Se>=0?x.getSouth():x.getNorth()))*P));const le=E[Ce],Te=E[(Ce+1)%4],Me=new Ob(le,Te,F),Re=[c0(Me,0)||le[0],c0(Me,1)||le[1],c0(Me,2)||le[2]],et=tf(c.zoom);if(et>0){const Ye=function({x:dt,y:Ct,z:tn},qt,Jt,sn,Ot){const Yt=1/(1<<tn);let At=dt*Yt,Mt=At+Yt,dn=Ct*Yt,gn=dn+Yt,oi=0;const Zn=(At+Mt)/2-sn;return Zn>.5?oi=-1:Zn<-.5&&(oi=1),At=((At+oi)*qt-(sn*=qt))*Jt+sn,Mt=((Mt+oi)*qt-sn)*Jt+sn,dn=(dn*qt-(Ot*=qt))*Jt+Ot,gn=(gn*qt-Ot)*Jt+Ot,[[At,gn,0],[Mt,gn,0],[Mt,dn,0],[At,dn,0]]}(a,n,c._pixelsPerMercatorPixel,re,he);for(let dt=0;dt<E.length;dt++)ef(E[dt],Ye[dt],et);const it=zt([],Ye[Ce],Ye[(Ce+1)%4]);$e(it,it,.5),ef(Re,it,et)}for(const Ye of E)Vt(B,B,Ye),Ln(D,D,Ye);return B[2]=Math.min(le[2],Te[2]),Vt(B,B,Re),Ln(D,D,Re),new sr(B,D)}function Wm({x:c,y:n,z:a},h=!1){const p=1/(1<<a),v=new we(Ke(c*p),n===(1<<a)-1&&h?-90:pt((n+1)*p)),x=new we(Ke((c+1)*p),n===0&&h?90:pt(n*p));return new De(v,x)}function Xm(c,n=P){const a=Tt(c.getNorth()),h=Tt(c.getSouth()),p=Math.cos(a),v=Math.cos(h),x=Math.sin(a),E=Math.sin(h),O=c.getWest(),D=c.getEast();return[fe(v,E,O,n),fe(v,E,D,n),fe(p,x,D,n),fe(p,x,O,n)]}function Gp(c,n,a,h){const p=1<<a.z,v=(c/fn+a.x)/p;return se(pt((n/fn+a.y)/p),Ke(v),h)}function id({min:c,max:n}){return V/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const uh=new Float64Array(16);function Wf(c){const n=id(c),a=Qe(uh,[n,n,n]);return de(a,a,An([],c.min))}function u0(c){const n=(h=c.min,(a=uh)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a);var a,h;const p=1/id(c);return ue(n,n,[p,p,p])}function Iy(c){const n=fn/(2*Math.PI);return c/(2*Math.PI)/n}function h0(c,n){return fn/(512*Math.pow(2,c))*id(nd(n))}function d0(c,n,a,h,p){const v=Iy(a),x=[c,n,-a/(2*Math.PI)],E=te(new Float64Array(16));return de(E,E,x),ue(E,E,[v,v,v]),Pe(E,E,Tt(-p)),Oe(E,E,Tt(-h)),E}function tf(c){return We(R,N,c)}function Ib(c,n){const a=se(n.lat,n.lng),h=function(Y){const re=se(Y._center.lat,Y._center.lng);let he=In([],ot(0,1,0),re);const _e=tt([],-Y.angle,re);he=Dt(he,he,_e),tt(_e,-Y._pitch,he);const Se=ct([],re);return $e(Se,Se,Xo(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Dt(Se,Se,_e),zt([],re,Se)}(c);return x=(p=rt([],h,a))[0],E=p[1],O=p[2],D=(v=a)[0],B=v[1],F=v[2],Z=(U=Math.sqrt(x*x+E*E+O*O)*Math.sqrt(D*D+B*B+F*F))&&kt(p,v)/U,Math.acos(Math.min(Math.max(Z,-1),1));var p,v,x,E,O,D,B,F,U,Z}function h_(c,n){return Ib(c,n)>Math.PI/2*1.01}const f0=Tt(85),Db=Math.cos(f0),b2=Math.sin(f0),p0=J(),Dy=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function Rb(c,n,a,h,p,v,x,E,O){if(v&&c.queryGeometry.isAboveHorizon)return!1;v&&(O*=c.pixelToTileUnitsFactor);const D=c.tileID.canonical,B=a.projection.upVectorScale(D,a.center.lat,a.worldSize).metersToTile;for(const F of n)for(const U of F){const Z=U.add(E),Y=p&&a.elevation?a.elevation.exaggeration()*p.getElevationAt(Z.x,Z.y,!0):0,re=a.projection.projectTilePoint(Z.x,Z.y,D);if(Y>0){const Ce=a.projection.upVector(D,Z.x,Z.y);re.x+=Ce[0]*B*Y,re.y+=Ce[1]*B*Y,re.z+=Ce[2]*B*Y}const he=v?Z:w2(re.x,re.y,re.z,h),_e=v?c.tilespaceRays.map(Ce=>Lb(Ce,Y)):c.queryGeometry.screenGeometry,Se=Xr([],[re.x,re.y,re.z,1],h);if(!x&&v?O*=Se[3]/a.cameraToCenterDistance:x&&!v&&(O*=a.cameraToCenterDistance/Se[3]),v){const Ce=pt((U.y/fn+D.y)/(1<<D.z));O/=a.projection.pixelsPerMeter(Ce,1)/qe(1,Ce)}if(fs(_e,he,O))return!0}return!1}function w2(c,n,a,h){const p=Xr([],[c,n,a,1],h);return new hn(p[0]/p[3],p[1]/p[3])}const Ym=ot(0,0,0),T2=ot(0,0,1);function Lb(c,n){const a=Ve();return Ym[2]=n,c.intersectsPlane(Ym,T2,a),new hn(a[0],a[1])}class ao extends dl{}let Ry,d_,Ly,m0;function zy(c,{width:n,height:a},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*a*h)throw new RangeError("mismatched image size")}else p=new Uint8Array(n*a*h);return c.width=n,c.height=a,c.data=p,c}function Km(c,n,a){const{width:h,height:p}=n;h===c.width&&p===c.height||(Jm(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,h),height:Math.min(c.height,p)},a,null),c.width=h,c.height=p,c.data=n.data)}function Jm(c,n,a,h,p,v,x,E){if(p.width===0||p.height===0)return n;if(p.width>c.width||p.height>c.height||a.x>c.width-p.width||a.y>c.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||h.x>n.width-p.width||h.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const O=c.data,D=n.data,B=v===4&&E;for(let F=0;F<p.height;F++){const U=((a.y+F)*c.width+a.x)*v,Z=((h.y+F)*n.width+h.x)*v;if(B)for(let Y=0;Y<p.width;Y++){const re=U+Y*v+3,he=Z+Y*v;D[he+0]=255,D[he+1]=255,D[he+2]=255,D[he+3]=O[re]}else if(x)for(let Y=0;Y<p.width;Y++){const re=U+Y*v,he=Z+Y*v,_e=new Di(O[re+0]/255,O[re+1]/255,O[re+2]/255,O[re+3]).toNonPremultipliedRenderColor(x).toArray();D[he+0]=_e[0],D[he+1]=_e[1],D[he+2]=_e[2],D[he+3]=_e[3]}else for(let Y=0;Y<p.width*v;Y++)D[Z+Y]=O[U+Y]}return n}Nn(ao,"HeatmapBucket",{omit:["layers"]});class nu{constructor(n,a){zy(this,n,1,a)}resize(n){Km(this,new nu(n),1)}clone(){return new nu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,h,p,v){Jm(n,a,h,p,v,1,null)}}class Cs{constructor(n,a){zy(this,n,4,a)}resize(n){Km(this,new Cs(n),4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Cs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,h,p,v,x,E){Jm(n,a,h,p,v,4,x,E)}}class zb{constructor(n,a){this.width=n.width,this.height=n.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}function f_(c){const n={},a=c.resolution||256,h=c.clips?c.clips.length:1,p=c.image||new Cs({width:a,height:h}),v=(x,E,O)=>{n[c.evaluationKey]=O;const D=c.expression.evaluate(n),B=D?D.toNonPremultipliedRenderColor(null):null;B&&(p.data[x+E+0]=Math.floor(255*B.r),p.data[x+E+1]=Math.floor(255*B.g),p.data[x+E+2]=Math.floor(255*B.b),p.data[x+E+3]=Math.floor(255*B.a))};if(c.clips)for(let x=0,E=0;x<h;++x,E+=4*a)for(let O=0,D=0;O<a;O++,D+=4){const B=O/(a-1),{start:F,end:U}=c.clips[x];v(E,D,F*(1-B)+U*B)}else for(let x=0,E=0;x<a;x++,E+=4)v(0,E,x/(a-1));return p}Nn(nu,"AlphaImage"),Nn(Cs,"RGBAImage");const kb=ar([{name:"a_pos",components:2,type:"Int16"}],4),Nb=ar([{name:"a_road_z_offset",components:1,type:"Float32"}],4),ky=ar([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),ca=ar([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Zp(c,n,a=2){const h=n&&n.length,p=h?n[0]*a:c.length;let v=fl(c,0,p,a,!0);const x=[];if(!v||v.next===v.prev)return x;let E,O,D;if(h&&(v=function(B,F,U,Z){const Y=[];for(let re=0,he=F.length;re<he;re++){const _e=fl(B,F[re]*Z,re<he-1?F[re+1]*Z:B.length,Z,!1);_e===_e.next&&(_e.steiner=!0),Y.push(E2(_e))}Y.sort(_0);for(let re=0;re<Y.length;re++)U=y0(Y[re],U);return U}(c,n,v,a)),c.length>80*a){E=1/0,O=1/0;let B=-1/0,F=-1/0;for(let U=a;U<p;U+=a){const Z=c[U],Y=c[U+1];Z<E&&(E=Z),Y<O&&(O=Y),Z>B&&(B=Z),Y>F&&(F=Y)}D=Math.max(B-E,F-O),D=D!==0?32767/D:0}return Xp(v,x,a,E,O,D,0),x}function fl(c,n,a,h,p){let v;if(p===function(x,E,O,D){let B=0;for(let F=E,U=O-D;F<O;F+=D)B+=(x[U]-x[F])*(x[F+1]+x[U+1]),U=F;return B}(c,n,a,h)>0)for(let x=n;x<a;x+=h)v=ju(x/h|0,c[x],c[x+1],v);else for(let x=a-h;x>=n;x-=h)v=ju(x/h|0,c[x],c[x+1],v);return v&&Yp(v,v.next)&&(Jp(v),v=v.next),v}function Wp(c,n){if(!c)return c;n||(n=c);let a,h=c;do if(a=!1,h.steiner||!Yp(h,h.next)&&Yo(h.prev,h,h.next)!==0)h=h.next;else{if(Jp(h),h=n=h.prev,h===h.next)break;a=!0}while(a||h!==n);return n}function Xp(c,n,a,h,p,v,x){if(!c)return;!x&&v&&function(O,D,B,F){let U=O;do U.z===0&&(U.z=By(U.x,U.y,D,B,F)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==O);U.prevZ.nextZ=null,U.prevZ=null,function(Z){let Y,re=1;do{let he,_e=Z;Z=null;let Se=null;for(Y=0;_e;){Y++;let Ce=_e,le=0;for(let Me=0;Me<re&&(le++,Ce=Ce.nextZ,Ce);Me++);let Te=re;for(;le>0||Te>0&&Ce;)le!==0&&(Te===0||!Ce||_e.z<=Ce.z)?(he=_e,_e=_e.nextZ,le--):(he=Ce,Ce=Ce.nextZ,Te--),Se?Se.nextZ=he:Z=he,he.prevZ=Se,Se=he;_e=Ce}Se.nextZ=null,re*=2}while(Y>1)}(U)}(c,h,p,v);let E=c;for(;c.prev!==c.next;){const O=c.prev,D=c.next;if(v?Ny(c,h,p,v):g0(c))n.push(O.i,c.i,D.i),Jp(c),c=D.next,E=D.next;else if((c=D)===E){x?x===1?Xp(c=Bb(Wp(c),n),n,a,h,p,v,2):x===2&&jb(c,n,a,h,p,v):Xp(Wp(c),n,a,h,p,v,1);break}}}function g0(c){const n=c.prev,a=c,h=c.next;if(Yo(n,a,h)>=0)return!1;const p=n.x,v=a.x,x=h.x,E=n.y,O=a.y,D=h.y,B=Math.min(p,v,x),F=Math.min(E,O,D),U=Math.max(p,v,x),Z=Math.max(E,O,D);let Y=h.next;for(;Y!==n;){if(Y.x>=B&&Y.x<=U&&Y.y>=F&&Y.y<=Z&&p_(p,E,v,O,x,D,Y.x,Y.y)&&Yo(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function Ny(c,n,a,h){const p=c.prev,v=c,x=c.next;if(Yo(p,v,x)>=0)return!1;const E=p.x,O=v.x,D=x.x,B=p.y,F=v.y,U=x.y,Z=Math.min(E,O,D),Y=Math.min(B,F,U),re=Math.max(E,O,D),he=Math.max(B,F,U),_e=By(Z,Y,n,a,h),Se=By(re,he,n,a,h);let Ce=c.prevZ,le=c.nextZ;for(;Ce&&Ce.z>=_e&&le&&le.z<=Se;){if(Ce.x>=Z&&Ce.x<=re&&Ce.y>=Y&&Ce.y<=he&&Ce!==p&&Ce!==x&&p_(E,B,O,F,D,U,Ce.x,Ce.y)&&Yo(Ce.prev,Ce,Ce.next)>=0||(Ce=Ce.prevZ,le.x>=Z&&le.x<=re&&le.y>=Y&&le.y<=he&&le!==p&&le!==x&&p_(E,B,O,F,D,U,le.x,le.y)&&Yo(le.prev,le,le.next)>=0))return!1;le=le.nextZ}for(;Ce&&Ce.z>=_e;){if(Ce.x>=Z&&Ce.x<=re&&Ce.y>=Y&&Ce.y<=he&&Ce!==p&&Ce!==x&&p_(E,B,O,F,D,U,Ce.x,Ce.y)&&Yo(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.prevZ}for(;le&&le.z<=Se;){if(le.x>=Z&&le.x<=re&&le.y>=Y&&le.y<=he&&le!==p&&le!==x&&p_(E,B,O,F,D,U,le.x,le.y)&&Yo(le.prev,le,le.next)>=0)return!1;le=le.nextZ}return!0}function Bb(c,n){let a=c;do{const h=a.prev,p=a.next.next;!Yp(h,p)&&jy(h,a,a.next,p)&&Kp(h,p)&&Kp(p,h)&&(n.push(h.i,a.i,p.i),Jp(a),Jp(a.next),a=c=p),a=a.next}while(a!==c);return Wp(a)}function jb(c,n,a,h,p,v){let x=c;do{let E=x.next.next;for(;E!==x.prev;){if(x.i!==E.i&&A2(x,E)){let O=Fb(x,E);return x=Wp(x,x.next),O=Wp(O,O.next),Xp(x,n,a,h,p,v,0),void Xp(O,n,a,h,p,v,0)}E=E.next}x=x.next}while(x!==c)}function _0(c,n){let a=c.x-n.x;return a===0&&(a=c.y-n.y,a===0)&&(a=(c.next.y-c.y)/(c.next.x-c.x)-(n.next.y-n.y)/(n.next.x-n.x)),a}function y0(c,n){const a=function(p,v){let x=v;const E=p.x,O=p.y;let D,B=-1/0;if(Yp(p,x))return x;do{if(Yp(p,x.next))return x.next;if(O<=x.y&&O>=x.next.y&&x.next.y!==x.y){const re=x.x+(O-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(re<=E&&re>B&&(B=re,D=x.x<x.next.x?x:x.next,re===E))return D}x=x.next}while(x!==v);if(!D)return null;const F=D,U=D.x,Z=D.y;let Y=1/0;x=D;do{if(E>=x.x&&x.x>=U&&E!==x.x&&v0(O<Z?E:B,O,U,Z,O<Z?B:E,O,x.x,x.y)){const re=Math.abs(O-x.y)/(E-x.x);Kp(x,p)&&(re<Y||re===Y&&(x.x>D.x||x.x===D.x&&S2(D,x)))&&(D=x,Y=re)}x=x.next}while(x!==F);return D}(c,n);if(!a)return n;const h=Fb(a,c);return Wp(h,h.next),Wp(a,a.next)}function S2(c,n){return Yo(c.prev,c,n.prev)<0&&Yo(n.next,c,c.next)<0}function By(c,n,a,h,p){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-a)*p|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-h)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function E2(c){let n=c,a=c;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==c);return a}function v0(c,n,a,h,p,v,x,E){return(p-x)*(n-E)>=(c-x)*(v-E)&&(c-x)*(h-E)>=(a-x)*(n-E)&&(a-x)*(v-E)>=(p-x)*(h-E)}function p_(c,n,a,h,p,v,x,E){return!(c===x&&n===E)&&v0(c,n,a,h,p,v,x,E)}function A2(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(a,h){let p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==h.i&&p.next.i!==h.i&&jy(p,p.next,a,h))return!0;p=p.next}while(p!==a);return!1}(c,n)&&(Kp(c,n)&&Kp(n,c)&&function(a,h){let p=a,v=!1;const x=(a.x+h.x)/2,E=(a.y+h.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&x<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==a);return v}(c,n)&&(Yo(c.prev,c,n.prev)||Yo(c,n.prev,n))||Yp(c,n)&&Yo(c.prev,c,c.next)>0&&Yo(n.prev,n,n.next)>0)}function Yo(c,n,a){return(n.y-c.y)*(a.x-n.x)-(n.x-c.x)*(a.y-n.y)}function Yp(c,n){return c.x===n.x&&c.y===n.y}function jy(c,n,a,h){const p=Uy(Yo(c,n,a)),v=Uy(Yo(c,n,h)),x=Uy(Yo(a,h,c)),E=Uy(Yo(a,h,n));return p!==v&&x!==E||!(p!==0||!Fy(c,a,n))||!(v!==0||!Fy(c,h,n))||!(x!==0||!Fy(a,c,h))||!(E!==0||!Fy(a,n,h))}function Fy(c,n,a){return n.x<=Math.max(c.x,a.x)&&n.x>=Math.min(c.x,a.x)&&n.y<=Math.max(c.y,a.y)&&n.y>=Math.min(c.y,a.y)}function Uy(c){return c>0?1:c<0?-1:0}function Kp(c,n){return Yo(c.prev,c,c.next)<0?Yo(c,n,c.next)>=0&&Yo(c,c.prev,n)>=0:Yo(c,n,c.prev)<0||Yo(c,c.next,n)<0}function Fb(c,n){const a=Vy(c.i,c.x,c.y),h=Vy(n.i,n.x,n.y),p=c.next,v=n.prev;return c.next=n,n.prev=c,a.next=p,p.prev=a,h.next=a,a.prev=h,v.next=h,h.prev=v,h}function ju(c,n,a,h){const p=Vy(c,n,a);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function Jp(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Vy(c,n,a){return{i:c,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function m_(c,n){const a=c.length;if(a<=1)return[c];const h=[];let p,v;for(let x=0;x<a;x++){const E=_r(c[x]);E!==0&&(c[x].area=Math.abs(E),v===void 0&&(v=E<0),v===E<0?(p&&h.push(p),p=[c[x]]):p.push(c[x]))}if(p&&h.push(p),n>1)for(let x=0;x<h.length;x++)h[x].length<=n||(ia(h[x],n,1,h[x].length-1,g_),h[x]=h[x].slice(0,n));return h}function g_(c,n){return n.area-c.area}function iu(c,n,a=1){if(!c)return null;const h=typeof c=="string"?Ha.from(c).getPrimary():c.getPrimary(),p=typeof c=="string"?null:c.getSecondary();for(const v of[h,p]){if(!v)continue;const x=v.id.toString();n.has(x)||n.set(x,[]),v.scaleSelf(a),n.get(x).push(v)}return{primary:h.toString(),secondary:p?p.toString():null}}function $y(c,n,a,h){const p=h.patternDependencies;let v=!1;for(const x of n){const E=x.paint.get(`${c}-pattern`);E.isConstant()||(v=!0),iu(E.constantOr(null),p,a)&&(v=!0)}return v}function Qm(c,n,a,h,p,v){const x=v.patternDependencies;for(const E of n){const O=E.paint.get(`${c}-pattern`).value;if(O.kind!=="constant"){let D=O.evaluate({zoom:h},a,{},v.availableImages);D=D&&D.name?D.name:D;const B=iu(D,x,p);if(!B)continue;const{primary:F,secondary:U}=B;F&&(a.patterns[E.id]=[F,U].filter(Boolean))}}return a}class rd{constructor(){this.polygons=new Map}add(n,...a){this.polygons.has(n)?this.polygons.get(n).push(...a):this.polygons.set(n,a)}merge(n){for(const[a,h]of n.polygons)this.add(a,...h)}}class Qp{constructor(){this.portals=[]}static evaluate(n){if(n.length===0)return new Qp;let a=[];for(const D of n)a.push(...D.portals);if(a.length===0)return new Qp;const h=(D,B)=>D<=0&&B<=0||D>=fn&&B>=fn;for(const D of a){const B=D.va,F=D.vb;(h(B.x,F.x)||h(B.y,F.y))&&(D.type="border")}const p=a.filter(D=>D.type!=="unevaluated"),v=a.filter(D=>D.type==="unevaluated");if(v.length===0)return new Qp;v.sort((D,B)=>D.hash===B.hash?D.isTunnel===B.isTunnel?0:D.isTunnel?-1:1:D.hash<B.hash?1:-1),a=p.concat(v);let x=p.length,E=x,O=x;do if(E++,E===a.length||a[x].hash!==a[E].hash){if(E-x==2){O<x&&(a[O]=a[x],a[x]=null);const D=a[O],B=a[E-1];D.type=D.isTunnel!==B.isTunnel?"tunnel":"polygon",D.connection={a:D.connection.a,b:B.connection.a},O++}x=E}while(x!==a.length);return a.splice(O),a.sort((D,B)=>D.hash<B.hash?1:-1),{portals:a}}}Nn(Qp,"ElevationPortalGraph"),Nn(rd,"ElevationPolygons");class P2{constructor(n,a,h){this.outPositions=n,this.outNormals=a,this.outIndices=h,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(n,a,h){let p=n[2];h!=null&&(p*=h);const v=this.getVec3Bits(n)<<96n|this.getVec3Bits(a),x=this.vertexLookup.get(v);if(x!=null)return x;const E=this.outPositions.length;this.vertexLookup.set(v,E);const O=Math.trunc(16384*a[0]),D=Math.trunc(16384*a[1]),B=Math.trunc(16384*a[2]);return this.outPositions.emplaceBack(n[0],n[1],p),this.outNormals.emplaceBack(O,D,B),E}addVertices(n,a,...h){const p=[];for(const v of h){const x=this.addVertex(v,n,a);p.push(x)}return p}addTriangles(n,a,h){if(a&&h){const p=h.length===1,v=ot(0,0,0);for(let x=0;x<n.length;x+=3){const E=a[n[x+0]],O=a[n[x+1]],D=a[n[x+2]],B=p?h[0]:h[n[x+1]],F=p?h[0]:h[n[x+2]],U=this.addVertex(ot(E.x,E.y,p?h[0]:h[n[x+0]]),v),Z=this.addVertex(ot(O.x,O.y,B),v),Y=this.addVertex(ot(D.x,D.y,F),v);this.outIndices.emplaceBack(U,Z,Y)}}else for(let p=0;p<n.length;p+=3)this.outIndices.emplaceBack(n[p+0],n[p+1],n[p+2])}addQuad(n,a){const h=this.addVertices(a,void 0,...n.map(O=>ot(O.coord.x,O.coord.y,O.height))),[p,v,x,E]=h;this.addTriangles([p,v,x,x,E,p])}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(n){return this.view.setFloat32(0,n),BigInt(this.view.getUint32(0))}getVec3Bits(n){return this.getBits(n[0])<<64n|this.getBits(n[1])<<32n|this.getBits(n[2])}}class Qs{constructor(n,a,h,p){this.unevaluatedPortals=new Qp,this.portalPolygons=new rd,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Lm,this.vertexNormals=new Lp,this.indexArray=new ra,this.tileToMeters=Et(n),this.bridgeProgramConfigurations=new m(a,{zoom:h,lut:p},v=>v!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new m(a,{zoom:h,lut:p},v=>v!=="fill-bridge-guard-rail-color")}addVertices(n,a){const h=this.unevalVertices.length;for(let p=0;p<n.length;p++)this.unevalVertices.push(n[p]),this.unevalHeights.push(a[p]);return h}addTriangles(n,a,h){const p=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const v of n)p.push(v+a)}addRenderableRing(n,a,h,p,v,x){const E=[new hn(v.min.x,v.min.y),new hn(v.max.x,v.min.y),new hn(v.max.x,v.max.y),new hn(v.min.x,v.max.y)];for(let O=0;O<h-1;O++){const D=a+O,B=D+1,F=this.unevalVertices[D],U=this.unevalVertices[B];if(!(F.x>=v.min.x&&F.x<=v.max.x&&F.y>=v.min.y&&F.y<=v.max.y||U.x>=v.min.x&&U.x<=v.max.x&&U.y>=v.min.y&&U.y<=v.max.y||td(F,U,E))||this.isOnBorder(F.x,U.x)||this.isOnBorder(F.y,U.y))continue;const Z=Qs.computeEdgeHash(this.unevalVertices[D],this.unevalVertices[B]);let Y,re=this.vertexHashLookup.get(Qs.computePosHash(F));re!=null?Y=re.next:(re=this.vertexHashLookup.get(Qs.computePosHash(U)),Y=re!=null?re.prev:Z),this.unevalEdges.push({polygonIdx:n,a:D,b:B,hash:Z,portalHash:Y,isTunnel:p,type:"unevaluated",featureInfo:x})}}addPortalCandidates(n,a,h,p,v){if(a.length===0)return;this.portalPolygons.add(n,{geometry:a,zLevel:v});const x=a[0];this.vertexHashLookup.clear();let E=Qs.computeEdgeHash(x[x.length-2],x[x.length-1]);for(let O=0;O<x.length-1;O++){const D=x[O+0],B=x[O+1],F=Ea(B.x-D.x,B.y-D.y),U=Aa(F);if(U===0)continue;let Z="unevaluated";const Y=p.pointElevation(D),re=p.pointElevation(B);Math.abs(Y)<.01&&Math.abs(re)<.01?Z="entrance":(this.isOnBorder(D.x,B.x)||this.isOnBorder(D.y,B.y))&&(Z="border");const he=Qs.computeEdgeHash(D,B);this.unevaluatedPortals.portals.push({connection:{a:n,b:void 0},va:D,vb:B,vab:F,length:U,hash:he,isTunnel:h,type:Z});const _e=Qs.computePosHash(D);this.vertexHashLookup.set(_e,{prev:E,next:he}),E=he}}construct(n){if(this.unevalVertices.length===0)return;const a=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=U=>{U.primitiveLength=this.indexArray.length-U.primitiveOffset},p=new P2(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(n.portals,this.unevalEdges);const v=a(),x=a(),E=a(),O=(U,Z)=>{U.sort((re,he)=>re.type===Z&&he.type!==Z?-1:re.type!==Z&&he.type===Z?1:0);const Y=U.findIndex(re=>re.type!==Z);return Y>=0?Y:U.length};let D=0;this.unevalEdges.length>0&&(D=O(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:D},this.tileToMeters)),h(E);const B=a(),F=a();if(this.unevalEdges.length>0){const U=this.unevalEdges.splice(D),Z=O(U,"tunnel")+D;this.unevalEdges.push(...U),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:D},{min:D,max:Z})}h(B),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(F),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(x),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(v),this.maskSegments=wo.simpleSegment(0,F.primitiveOffset,0,F.primitiveLength),this.depthSegments=wo.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.renderableBridgeSegments=wo.simpleSegment(0,E.primitiveOffset,0,E.primitiveLength),this.renderableTunnelSegments=wo.simpleSegment(0,B.primitiveOffset,0,B.primitiveLength),this.shadowCasterSegments=wo.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength)}update(n,a,h,p,v,x,E,O){this.bridgeProgramConfigurations.updatePaintArrays(n,a,v,h,p,x,E,O),this.tunnelProgramConfigurations.updatePaintArrays(n,a,v,h,p,x,E,O)}upload(n){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=n.createVertexBuffer(this.vertexPositions,ky.members),this.vertexBufferNormal=n.createVertexBuffer(this.vertexNormals,ca.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(n),this.tunnelProgramConfigurations.upload(n))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(n,a,h,p,v){const x=(E,O)=>{for(let D=0;D<O.length-1;D++){const B=O[D].featureIndex,F=O[D+1].vertexStart,U=n.feature(B);E.populatePaintArrays(F,U,B,{},h,a,p,void 0,v)}};x(this.bridgeProgramConfigurations,this.bridgeFeatureSections),x(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(n,a,h,p,v){const x=new Map;for(let E=p;E<v;E++){const O=h[E],D=O.a,B=O.b,F=Qs.computePosHash(n[D]),U=Qs.computePosHash(n[B]);x.has(F)||x.set(F,{}),x.has(U)||x.set(U,{});const Z=x.get(F),Y=x.get(U);a[D]<=0&&a[B]<=0||(Z.to=B,Y.from=D)}return x}constructBridgeStructures(n,a,h,p,v,x){n.clearVertexLookup();const E=this.computeVertexConnections(a,h,p,v.min,v.max),O=1/x,D=.5*O,B=Z=>ot(a[Z].x,a[Z].y,h[Z]*O),F=Z=>{const Y=E.get(Qs.computePosHash(a[Z])),re=Y.from,he=Y.to;if(!re||!he)return;const _e=B(re),Se=B(Z),Ce=B(he),le=ot(0,0,0);if(!mn(_e,Se)){const Me=ci(Ve(),Se,_e);zt(le,le,ct(Me,Me))}if(!mn(Ce,Se)){const Me=ci(Ve(),Ce,Se);zt(le,le,ct(Me,Me))}const Te=Mi(le);return Te>0?$e(le,le,1/Te):void 0};let U=Number.POSITIVE_INFINITY;this.sortSubarray(p,v.min,v.max,(Z,Y)=>Z.featureInfo.featureIndex-Y.featureInfo.featureIndex);for(let Z=v.min;Z<v.max;Z++){const Y=p[Z];if(!Y.featureInfo.guardRailEnabled)continue;const re=this.prepareEdgePoints(a,h,Y,(bi,Gn)=>bi>Gn);if(re==null)continue;const he=re[0],_e=re[1],Se=ot(he.coord.x,he.coord.y,O*he.height),Ce=ot(_e.coord.x,_e.coord.y,O*_e.height);if(mn(Se,Ce))continue;const le=ci(Ve(),Ce,Se);ct(le,le);const Te=bi=>ct(bi,bi),Me=F(Y.a)||le,Re=F(Y.b)||le,et=Te(ot(Me[1],-Me[0],0)),Ye=Te(ot(Re[1],-Re[0],0)),it=Te(In(Ve(),et,Me)),dt=Te(In(Ve(),Ye,Re)),Ct=Ve(),tn=[zt(Ve(),Se,$e(Ct,ci(Ct,et,it),D)),zt(Ve(),Se,$e(Ct,zt(Ct,et,it),D)),zt(Ve(),Se,$e(Ct,it,D)),Se],qt=[zt(Ve(),Ce,$e(Ct,ci(Ct,Ye,dt),D)),zt(Ve(),Ce,$e(Ct,zt(Ct,Ye,dt),D)),zt(Ve(),Ce,$e(Ct,dt,D)),Ce];U=this.addFeatureSection(Y.featureInfo.featureIndex,U,this.bridgeFeatureSections,n);const[Jt,sn]=n.addVertices(et,x,tn[0],tn[1]),[Ot,Yt]=n.addVertices(Ye,x,qt[0],qt[1]);n.addTriangles([Jt,sn,Ot,sn,Yt,Ot]);const[At,Mt]=n.addVertices(it,x,tn[1],tn[2]),[dn,gn]=n.addVertices(dt,x,qt[1],qt[2]);n.addTriangles([At,Mt,dn,Mt,gn,dn]);const[oi,Zn]=n.addVertices(An(et,et),x,tn[2],tn[3]),[Sn,un]=n.addVertices(An(Ye,Ye),x,qt[2],qt[3]);n.addTriangles([oi,Zn,Sn,Zn,un,Sn])}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:n.getVertexCount()})}constructTunnelStructures(n,a,h,p,v,x){n.clearVertexLookup();let E=Number.POSITIVE_INFINITY;const O=(B,F)=>B.featureInfo.featureIndex-F.featureInfo.featureIndex;this.sortSubarray(p,v.min,v.max,O),this.sortSubarray(p,x.min,x.max,O);const D=B=>ct(B,B);for(let B=v.min;B<v.max;B++){const F=this.prepareEdgePoints(a,h,p[B],(re,he)=>re<he);if(F==null)continue;const[U,Z]=F,Y=D(ot(-(Z.coord.y-U.coord.y),Z.coord.x-U.coord.x,0));E=this.addFeatureSection(p[B].featureInfo.featureIndex,E,this.tunnelFeatureSections,n),n.addQuad([U,Z,{coord:Z.coord,height:p[B].isTunnel?-.1:0},{coord:U.coord,height:p[B].isTunnel?-.1:0}],Y)}for(let B=x.min;B<x.max;B++){const F=p[B];F.isTunnel&&([F.a,F.b]=[F.b,F.a]);const U=a[F.a],Z=a[F.b],Y=D(ot(-(Z.y-U.y),Z.x-U.x,0));E=this.addFeatureSection(F.featureInfo.featureIndex,E,this.tunnelFeatureSections,n),n.addQuad([{coord:Z,height:0},{coord:U,height:0},{coord:U,height:h[F.a]+4},{coord:Z,height:h[F.b]+4}],Y),n.addQuad([{coord:U,height:0},{coord:Z,height:0},{coord:Z,height:h[F.b]+4},{coord:U,height:h[F.a]+4}],Y)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:n.getVertexCount()})}prepareEdgePoints(n,a,h,p){let v=a[h.a],x=a[h.b];const E=p(v,0),O=p(x,0);if(E&&O)return[{coord:n[h.a],height:v},{coord:n[h.b],height:x}];if(!E&&!O)return;const D=n[h.a].clone(),B=n[h.b].clone();if(E){if(!O){const F=x/(x-v);B.x=Xn(B.x,D.x,F),B.y=Xn(B.y,D.y,F),x=Xn(x,v,F)}}else{const F=v/(v-x);D.x=Xn(D.x,B.x,F),D.y=Xn(D.y,B.y,F),v=Xn(v,x,F)}return[{coord:D,height:v},{coord:B,height:x}]}prepareEdges(n,a){if(a.length===0)return;a.sort((E,O)=>E.hash===O.hash?O.polygonIdx-E.polygonIdx:O.hash>E.hash?1:-1);let h=0,p=0,v=0,x=a[h].polygonIdx;do p++,(p===a.length||a[h].hash!==a[p].hash)&&((p-h==1||a[p-1].polygonIdx!==x)&&(v<h&&(a[v]=a[h],a[h]=null),a[v].type="none",v++),h=p,h!==a.length&&(x=a[h].polygonIdx));while(h!==a.length);if(a.splice(v),a.length!==0&&n.length!==0){a.sort((D,B)=>D.portalHash<B.portalHash?1:-1);let E=0,O=0;for(;E!==a.length&&O!==n.length;){const D=a[E],B=n[O];D.portalHash>B.hash?E++:B.hash>D.portalHash?O++:(D.type=B.type,E++)}}}isOnBorder(n,a){return n<=0&&a<=0||n>=fn&&a>=fn}addFeatureSection(n,a,h,p){return n!==a&&(a=n,h.push({featureIndex:n,vertexStart:p.getVertexCount()}),p.clearVertexLookup()),a}sortSubarray(n,a,h,p){const v=n.slice(a,h);v.sort(p),n.splice(a,v.length,...v)}static computeEdgeHash(n,a){return(n.y===a.y&&n.x>a.x||n.y>a.y)&&([n,a]=[a,n]),BigInt(Qs.computePosHash(n))<<32n|BigInt(Qs.computePosHash(a))}static computePosHash(n){return((65535&n.x)<<16|65535&n.y)>>>0}}var x0,Ub={exports:{}},Vb=(x0||(x0=1,function(c,n){(function(a){function h(Ie,ze){return Ie>ze?1:Ie<ze?-1:0}var p=function(Ie,ze){Ie===void 0&&(Ie=h),ze===void 0&&(ze=!1),this._compare=Ie,this._root=null,this._size=0,this._noDuplicates=!!ze},v={size:{configurable:!0}};function x(Ie,ze,Lt,yn,Pn){var wn=Pn-yn;if(wn>0){var Hn=yn+Math.floor(wn/2),pi={key:ze[Hn],data:Lt[Hn],parent:Ie};return pi.left=x(pi,ze,Lt,yn,Hn),pi.right=x(pi,ze,Lt,Hn+1,Pn),pi}return null}function E(Ie,ze,Lt,yn,Pn){if(!(Lt>=yn)){for(var wn=Ie[Lt+yn>>1],Hn=Lt-1,pi=yn+1;;){do Hn++;while(Pn(Ie[Hn],wn)<0);do pi--;while(Pn(Ie[pi],wn)>0);if(Hn>=pi)break;var Ji=Ie[Hn];Ie[Hn]=Ie[pi],Ie[pi]=Ji,Ji=ze[Hn],ze[Hn]=ze[pi],ze[pi]=Ji}E(Ie,ze,Lt,pi,Pn),E(Ie,ze,pi+1,yn,Pn)}}p.prototype.rotateLeft=function(Ie){var ze=Ie.right;ze&&(Ie.right=ze.left,ze.left&&(ze.left.parent=Ie),ze.parent=Ie.parent),Ie.parent?Ie===Ie.parent.left?Ie.parent.left=ze:Ie.parent.right=ze:this._root=ze,ze&&(ze.left=Ie),Ie.parent=ze},p.prototype.rotateRight=function(Ie){var ze=Ie.left;ze&&(Ie.left=ze.right,ze.right&&(ze.right.parent=Ie),ze.parent=Ie.parent),Ie.parent?Ie===Ie.parent.left?Ie.parent.left=ze:Ie.parent.right=ze:this._root=ze,ze&&(ze.right=Ie),Ie.parent=ze},p.prototype._splay=function(Ie){for(;Ie.parent;){var ze=Ie.parent;ze.parent?ze.left===Ie&&ze.parent.left===ze?(this.rotateRight(ze.parent),this.rotateRight(ze)):ze.right===Ie&&ze.parent.right===ze?(this.rotateLeft(ze.parent),this.rotateLeft(ze)):ze.left===Ie&&ze.parent.right===ze?(this.rotateRight(ze),this.rotateLeft(ze)):(this.rotateLeft(ze),this.rotateRight(ze)):ze.left===Ie?this.rotateRight(ze):this.rotateLeft(ze)}},p.prototype.splay=function(Ie){for(var ze,Lt,yn,Pn,wn;Ie.parent;)(Lt=(ze=Ie.parent).parent)&&Lt.parent?((yn=Lt.parent).left===Lt?yn.left=Ie:yn.right=Ie,Ie.parent=yn):(Ie.parent=null,this._root=Ie),Pn=Ie.left,wn=Ie.right,Ie===ze.left?(Lt&&(Lt.left===ze?(ze.right?(Lt.left=ze.right,Lt.left.parent=Lt):Lt.left=null,ze.right=Lt,Lt.parent=ze):(Pn?(Lt.right=Pn,Pn.parent=Lt):Lt.right=null,Ie.left=Lt,Lt.parent=Ie)),wn?(ze.left=wn,wn.parent=ze):ze.left=null,Ie.right=ze,ze.parent=Ie):(Lt&&(Lt.right===ze?(ze.left?(Lt.right=ze.left,Lt.right.parent=Lt):Lt.right=null,ze.left=Lt,Lt.parent=ze):(wn?(Lt.left=wn,wn.parent=Lt):Lt.left=null,Ie.right=Lt,Lt.parent=Ie)),Pn?(ze.right=Pn,Pn.parent=ze):ze.right=null,Ie.left=ze,ze.parent=Ie)},p.prototype.replace=function(Ie,ze){Ie.parent?Ie===Ie.parent.left?Ie.parent.left=ze:Ie.parent.right=ze:this._root=ze,ze&&(ze.parent=Ie.parent)},p.prototype.minNode=function(Ie){if(Ie===void 0&&(Ie=this._root),Ie)for(;Ie.left;)Ie=Ie.left;return Ie},p.prototype.maxNode=function(Ie){if(Ie===void 0&&(Ie=this._root),Ie)for(;Ie.right;)Ie=Ie.right;return Ie},p.prototype.insert=function(Ie,ze){var Lt=this._root,yn=null,Pn=this._compare;if(this._noDuplicates)for(;Lt;){if(yn=Lt,Pn(Lt.key,Ie)===0)return;Lt=Pn(Lt.key,Ie)<0?Lt.right:Lt.left}else for(;Lt;)yn=Lt,Lt=Pn(Lt.key,Ie)<0?Lt.right:Lt.left;return Lt={key:Ie,data:ze,left:null,right:null,parent:yn},yn?Pn(yn.key,Lt.key)<0?yn.right=Lt:yn.left=Lt:this._root=Lt,this.splay(Lt),this._size++,Lt},p.prototype.find=function(Ie){for(var ze=this._root,Lt=this._compare;ze;){var yn=Lt(ze.key,Ie);if(yn<0)ze=ze.right;else{if(!(yn>0))return ze;ze=ze.left}}return null},p.prototype.contains=function(Ie){for(var ze=this._root,Lt=this._compare;ze;){var yn=Lt(Ie,ze.key);if(yn===0)return!0;ze=yn<0?ze.left:ze.right}return!1},p.prototype.remove=function(Ie){var ze=this.find(Ie);if(!ze)return!1;if(this.splay(ze),ze.left)if(ze.right){var Lt=this.minNode(ze.right);Lt.parent!==ze&&(this.replace(Lt,Lt.right),Lt.right=ze.right,Lt.right.parent=Lt),this.replace(ze,Lt),Lt.left=ze.left,Lt.left.parent=Lt}else this.replace(ze,ze.left);else this.replace(ze,ze.right);return this._size--,!0},p.prototype.removeNode=function(Ie){if(!Ie)return!1;if(this.splay(Ie),Ie.left)if(Ie.right){var ze=this.minNode(Ie.right);ze.parent!==Ie&&(this.replace(ze,ze.right),ze.right=Ie.right,ze.right.parent=ze),this.replace(Ie,ze),ze.left=Ie.left,ze.left.parent=ze}else this.replace(Ie,Ie.left);else this.replace(Ie,Ie.right);return this._size--,!0},p.prototype.erase=function(Ie){var ze=this.find(Ie);if(ze){this.splay(ze);var Lt=ze.left,yn=ze.right,Pn=null;Lt&&(Lt.parent=null,Pn=this.maxNode(Lt),this.splay(Pn),this._root=Pn),yn&&(Lt?Pn.right=yn:this._root=yn,yn.parent=Pn),this._size--}},p.prototype.pop=function(){var Ie=this._root,ze=null;if(Ie){for(;Ie.left;)Ie=Ie.left;ze={key:Ie.key,data:Ie.data},this.remove(Ie.key)}return ze},p.prototype.next=function(Ie){var ze=Ie;if(ze)if(ze.right)for(ze=ze.right;ze&&ze.left;)ze=ze.left;else for(ze=Ie.parent;ze&&ze.right===Ie;)Ie=ze,ze=ze.parent;return ze},p.prototype.prev=function(Ie){var ze=Ie;if(ze)if(ze.left)for(ze=ze.left;ze&&ze.right;)ze=ze.right;else for(ze=Ie.parent;ze&&ze.left===Ie;)Ie=ze,ze=ze.parent;return ze},p.prototype.forEach=function(Ie){for(var ze=this._root,Lt=[],yn=!1,Pn=0;!yn;)ze?(Lt.push(ze),ze=ze.left):Lt.length>0?(Ie(ze=Lt.pop(),Pn++),ze=ze.right):yn=!0;return this},p.prototype.range=function(Ie,ze,Lt,yn){for(var Pn=[],wn=this._compare,Hn=this._root;Pn.length!==0||Hn;)if(Hn)Pn.push(Hn),Hn=Hn.left;else{if(wn((Hn=Pn.pop()).key,ze)>0)break;if(wn(Hn.key,Ie)>=0&&Lt.call(yn,Hn))return this;Hn=Hn.right}return this},p.prototype.keys=function(){for(var Ie=this._root,ze=[],Lt=[],yn=!1;!yn;)Ie?(ze.push(Ie),Ie=Ie.left):ze.length>0?(Ie=ze.pop(),Lt.push(Ie.key),Ie=Ie.right):yn=!0;return Lt},p.prototype.values=function(){for(var Ie=this._root,ze=[],Lt=[],yn=!1;!yn;)Ie?(ze.push(Ie),Ie=Ie.left):ze.length>0?(Ie=ze.pop(),Lt.push(Ie.data),Ie=Ie.right):yn=!0;return Lt},p.prototype.at=function(Ie){for(var ze=this._root,Lt=[],yn=!1,Pn=0;!yn;)if(ze)Lt.push(ze),ze=ze.left;else if(Lt.length>0){if(ze=Lt.pop(),Pn===Ie)return ze;Pn++,ze=ze.right}else yn=!0;return null},p.prototype.load=function(Ie,ze,Lt){if(Ie===void 0&&(Ie=[]),ze===void 0&&(ze=[]),Lt===void 0&&(Lt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var yn=Ie.length;return Lt&&E(Ie,ze,0,yn-1,this._compare),this._root=x(null,Ie,ze,0,yn),this._size=yn,this},p.prototype.min=function(){var Ie=this.minNode(this._root);return Ie?Ie.key:null},p.prototype.max=function(){var Ie=this.maxNode(this._root);return Ie?Ie.key:null},p.prototype.isEmpty=function(){return this._root===null},v.size.get=function(){return this._size},p.createTree=function(Ie,ze,Lt,yn,Pn){return new p(Lt,Pn).load(Ie,ze,yn)},Object.defineProperties(p.prototype,v);var O=0,D=1,B=2,F=3,U=0,Z=1,Y=2,re=3;function he(Ie,ze,Lt){ze===null?(Ie.inOut=!1,Ie.otherInOut=!0):(Ie.isSubject===ze.isSubject?(Ie.inOut=!ze.inOut,Ie.otherInOut=ze.otherInOut):(Ie.inOut=!ze.otherInOut,Ie.otherInOut=ze.isVertical()?!ze.inOut:ze.inOut),ze&&(Ie.prevInResult=!_e(ze,Lt)||ze.isVertical()?ze.prevInResult:ze));var yn=_e(Ie,Lt);Ie.resultTransition=yn?function(Pn,wn){var Hn,pi=!Pn.inOut,Ji=!Pn.otherInOut;switch(wn){case U:Hn=pi&&Ji;break;case Z:Hn=pi||Ji;break;case re:Hn=pi^Ji;break;case Y:Hn=Pn.isSubject?pi&&!Ji:Ji&&!pi}return Hn?1:-1}(Ie,Lt):0}function _e(Ie,ze){switch(Ie.type){case O:switch(ze){case U:return!Ie.otherInOut;case Z:return Ie.otherInOut;case Y:return Ie.isSubject&&Ie.otherInOut||!Ie.isSubject&&!Ie.otherInOut;case re:return!0}break;case B:return ze===U||ze===Z;case F:return ze===Y;case D:return!1}return!1}var Se=function(Ie,ze,Lt,yn,Pn){this.left=ze,this.point=Ie,this.otherEvent=Lt,this.isSubject=yn,this.type=Pn||O,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Ce={inResult:{configurable:!0}};function le(Ie,ze){return Ie[0]===ze[0]&&Ie[1]===ze[1]}Se.prototype.isBelow=function(Ie){var ze=this.point,Lt=this.otherEvent.point;return this.left?(ze[0]-Ie[0])*(Lt[1]-Ie[1])-(Lt[0]-Ie[0])*(ze[1]-Ie[1])>0:(Lt[0]-Ie[0])*(ze[1]-Ie[1])-(ze[0]-Ie[0])*(Lt[1]-Ie[1])>0},Se.prototype.isAbove=function(Ie){return!this.isBelow(Ie)},Se.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Ce.inResult.get=function(){return this.resultTransition!==0},Se.prototype.clone=function(){var Ie=new Se(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ie.contourId=this.contourId,Ie.resultTransition=this.resultTransition,Ie.prevInResult=this.prevInResult,Ie.isExteriorRing=this.isExteriorRing,Ie.inOut=this.inOut,Ie.otherInOut=this.otherInOut,Ie},Object.defineProperties(Se.prototype,Ce);var Te=11102230246251565e-32,Me=134217729,Re=(3+8*Te)*Te;function et(Ie,ze,Lt,yn,Pn){var wn,Hn,pi,Ji,Qi=ze[0],zi=yn[0],Rr=0,to=0;zi>Qi==zi>-Qi?(wn=Qi,Qi=ze[++Rr]):(wn=zi,zi=yn[++to]);var er=0;if(Rr<Ie&&to<Lt)for(zi>Qi==zi>-Qi?(pi=wn-((Hn=Qi+wn)-Qi),Qi=ze[++Rr]):(pi=wn-((Hn=zi+wn)-zi),zi=yn[++to]),wn=Hn,pi!==0&&(Pn[er++]=pi);Rr<Ie&&to<Lt;)zi>Qi==zi>-Qi?(pi=wn-((Hn=wn+Qi)-(Ji=Hn-wn))+(Qi-Ji),Qi=ze[++Rr]):(pi=wn-((Hn=wn+zi)-(Ji=Hn-wn))+(zi-Ji),zi=yn[++to]),wn=Hn,pi!==0&&(Pn[er++]=pi);for(;Rr<Ie;)pi=wn-((Hn=wn+Qi)-(Ji=Hn-wn))+(Qi-Ji),Qi=ze[++Rr],wn=Hn,pi!==0&&(Pn[er++]=pi);for(;to<Lt;)pi=wn-((Hn=wn+zi)-(Ji=Hn-wn))+(zi-Ji),zi=yn[++to],wn=Hn,pi!==0&&(Pn[er++]=pi);return wn===0&&er!==0||(Pn[er++]=wn),er}function Ye(Ie){return new Float64Array(Ie)}var it=33306690738754716e-32,dt=22204460492503146e-32,Ct=11093356479670487e-47,tn=Ye(4),qt=Ye(8),Jt=Ye(12),sn=Ye(16),Ot=Ye(4);function Yt(Ie,ze,Lt){var yn=function(Pn,wn,Hn,pi,Ji,Qi){var zi=(wn-Qi)*(Hn-Ji),Rr=(Pn-Ji)*(pi-Qi),to=zi-Rr;if(zi===0||Rr===0||zi>0!=Rr>0)return to;var er=Math.abs(zi+Rr);return Math.abs(to)>=it*er?to:-function(Do,lo,Dr,Ko,po,no,co){var zr,Bi,Ur,Ro,hi,mr,mo,qo,vo,Za,Hr,ka,Ec,pl,tl,Ac,tp,Wa,ms=Do-po,ml=Dr-po,Fl=lo-no,Ol=Ko-no;tn[0]=(tl=(qo=ms-(mo=(mr=Me*ms)-(mr-ms)))*(Za=Ol-(vo=(mr=Me*Ol)-(mr-Ol)))-((pl=ms*Ol)-mo*vo-qo*vo-mo*Za))-((Hr=tl-(tp=(qo=Fl-(mo=(mr=Me*Fl)-(mr-Fl)))*(Za=ml-(vo=(mr=Me*ml)-(mr-ml)))-((Ac=Fl*ml)-mo*vo-qo*vo-mo*Za)))+(hi=tl-Hr))+(hi-tp),tn[1]=(Ec=pl-((ka=pl+Hr)-(hi=ka-pl))+(Hr-hi))-((Hr=Ec-Ac)+(hi=Ec-Hr))+(hi-Ac),tn[2]=ka-((Wa=ka+Hr)-(hi=Wa-ka))+(Hr-hi),tn[3]=Wa;var hg=function(Dye,CR){for(var MR=CR[0],ES=1;ES<4;ES++)MR+=CR[ES];return MR}(0,tn),K0=dt*co;if(hg>=K0||-hg>=K0||(zr=Do-(ms+(hi=Do-ms))+(hi-po),Ur=Dr-(ml+(hi=Dr-ml))+(hi-po),Bi=lo-(Fl+(hi=lo-Fl))+(hi-no),Ro=Ko-(Ol+(hi=Ko-Ol))+(hi-no),zr===0&&Bi===0&&Ur===0&&Ro===0)||(K0=Ct*co+Re*Math.abs(hg),(hg+=ms*Ro+Ol*zr-(Fl*Ur+ml*Bi))>=K0||-hg>=K0))return hg;Ot[0]=(tl=(qo=zr-(mo=(mr=Me*zr)-(mr-zr)))*(Za=Ol-(vo=(mr=Me*Ol)-(mr-Ol)))-((pl=zr*Ol)-mo*vo-qo*vo-mo*Za))-((Hr=tl-(tp=(qo=Bi-(mo=(mr=Me*Bi)-(mr-Bi)))*(Za=ml-(vo=(mr=Me*ml)-(mr-ml)))-((Ac=Bi*ml)-mo*vo-qo*vo-mo*Za)))+(hi=tl-Hr))+(hi-tp),Ot[1]=(Ec=pl-((ka=pl+Hr)-(hi=ka-pl))+(Hr-hi))-((Hr=Ec-Ac)+(hi=Ec-Hr))+(hi-Ac),Ot[2]=ka-((Wa=ka+Hr)-(hi=Wa-ka))+(Hr-hi),Ot[3]=Wa;var sH=et(4,tn,4,Ot,qt);Ot[0]=(tl=(qo=ms-(mo=(mr=Me*ms)-(mr-ms)))*(Za=Ro-(vo=(mr=Me*Ro)-(mr-Ro)))-((pl=ms*Ro)-mo*vo-qo*vo-mo*Za))-((Hr=tl-(tp=(qo=Fl-(mo=(mr=Me*Fl)-(mr-Fl)))*(Za=Ur-(vo=(mr=Me*Ur)-(mr-Ur)))-((Ac=Fl*Ur)-mo*vo-qo*vo-mo*Za)))+(hi=tl-Hr))+(hi-tp),Ot[1]=(Ec=pl-((ka=pl+Hr)-(hi=ka-pl))+(Hr-hi))-((Hr=Ec-Ac)+(hi=Ec-Hr))+(hi-Ac),Ot[2]=ka-((Wa=ka+Hr)-(hi=Wa-ka))+(Hr-hi),Ot[3]=Wa;var lH=et(sH,qt,4,Ot,Jt);Ot[0]=(tl=(qo=zr-(mo=(mr=Me*zr)-(mr-zr)))*(Za=Ro-(vo=(mr=Me*Ro)-(mr-Ro)))-((pl=zr*Ro)-mo*vo-qo*vo-mo*Za))-((Hr=tl-(tp=(qo=Bi-(mo=(mr=Me*Bi)-(mr-Bi)))*(Za=Ur-(vo=(mr=Me*Ur)-(mr-Ur)))-((Ac=Bi*Ur)-mo*vo-qo*vo-mo*Za)))+(hi=tl-Hr))+(hi-tp),Ot[1]=(Ec=pl-((ka=pl+Hr)-(hi=ka-pl))+(Hr-hi))-((Hr=Ec-Ac)+(hi=Ec-Hr))+(hi-Ac),Ot[2]=ka-((Wa=ka+Hr)-(hi=Wa-ka))+(Hr-hi),Ot[3]=Wa;var cH=et(lH,Jt,4,Ot,sn);return sn[cH-1]}(Pn,wn,Hn,pi,Ji,Qi,er)}(Ie[0],Ie[1],ze[0],ze[1],Lt[0],Lt[1]);return yn>0?-1:yn<0?1:0}function At(Ie,ze){var Lt=Ie.point,yn=ze.point;return Lt[0]>yn[0]?1:Lt[0]<yn[0]?-1:Lt[1]!==yn[1]?Lt[1]>yn[1]?1:-1:function(Pn,wn,Hn,pi){return Pn.left!==wn.left?Pn.left?1:-1:Yt(Hn,Pn.otherEvent.point,wn.otherEvent.point)!==0?Pn.isBelow(wn.otherEvent.point)?-1:1:!Pn.isSubject&&wn.isSubject?1:-1}(Ie,ze,Lt)}function Mt(Ie,ze,Lt){var yn=new Se(ze,!1,Ie,Ie.isSubject),Pn=new Se(ze,!0,Ie.otherEvent,Ie.isSubject);return le(Ie.point,Ie.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ie),yn.contourId=Pn.contourId=Ie.contourId,At(Pn,Ie.otherEvent)>0&&(Ie.otherEvent.left=!0,Pn.left=!1),Ie.otherEvent.otherEvent=Pn,Ie.otherEvent=yn,Lt.push(Pn),Lt.push(yn),Lt}function dn(Ie,ze){return Ie[0]*ze[1]-Ie[1]*ze[0]}function gn(Ie,ze){return Ie[0]*ze[0]+Ie[1]*ze[1]}function oi(Ie,ze,Lt){var yn=function(Ji,Qi,zi,Rr,to){var er=[Qi[0]-Ji[0],Qi[1]-Ji[1]],Do=[Rr[0]-zi[0],Rr[1]-zi[1]];function lo(mr,mo,qo){return[mr[0]+mo*qo[0],mr[1]+mo*qo[1]]}var Dr=[zi[0]-Ji[0],zi[1]-Ji[1]],Ko=dn(er,Do),po=Ko*Ko,no=gn(er,er);if(po>0){var co=dn(Dr,Do)/Ko;if(co<0||co>1)return null;var zr=dn(Dr,er)/Ko;return zr<0||zr>1?null:co===0||co===1?[lo(Ji,co,er)]:zr===0||zr===1?[lo(zi,zr,Do)]:[lo(Ji,co,er)]}if((po=(Ko=dn(Dr,er))*Ko)>0)return null;var Bi=gn(er,Dr)/no,Ur=Bi+gn(er,Do)/no,Ro=Math.min(Bi,Ur),hi=Math.max(Bi,Ur);return Ro<=1&&hi>=0?Ro===1?[lo(Ji,Ro>0?Ro:0,er)]:hi===0?[lo(Ji,hi<1?hi:1,er)]:[lo(Ji,Ro>0?Ro:0,er),lo(Ji,hi<1?hi:1,er)]:null}(Ie.point,Ie.otherEvent.point,ze.point,ze.otherEvent.point),Pn=yn?yn.length:0;if(Pn===0||Pn===1&&(le(Ie.point,ze.point)||le(Ie.otherEvent.point,ze.otherEvent.point))||Pn===2&&Ie.isSubject===ze.isSubject)return 0;if(Pn===1)return le(Ie.point,yn[0])||le(Ie.otherEvent.point,yn[0])||Mt(Ie,yn[0],Lt),le(ze.point,yn[0])||le(ze.otherEvent.point,yn[0])||Mt(ze,yn[0],Lt),1;var wn=[],Hn=!1,pi=!1;return le(Ie.point,ze.point)?Hn=!0:At(Ie,ze)===1?wn.push(ze,Ie):wn.push(Ie,ze),le(Ie.otherEvent.point,ze.otherEvent.point)?pi=!0:At(Ie.otherEvent,ze.otherEvent)===1?wn.push(ze.otherEvent,Ie.otherEvent):wn.push(Ie.otherEvent,ze.otherEvent),Hn&&pi||Hn?(ze.type=D,Ie.type=ze.inOut===Ie.inOut?B:F,Hn&&!pi&&Mt(wn[1].otherEvent,wn[0].point,Lt),2):pi?(Mt(wn[0],wn[1].point,Lt),3):wn[0]!==wn[3].otherEvent?(Mt(wn[0],wn[1].point,Lt),Mt(wn[1],wn[2].point,Lt),3):(Mt(wn[0],wn[1].point,Lt),Mt(wn[3].otherEvent,wn[2].point,Lt),3)}function Zn(Ie,ze){if(Ie===ze)return 0;if(Yt(Ie.point,Ie.otherEvent.point,ze.point)!==0||Yt(Ie.point,Ie.otherEvent.point,ze.otherEvent.point)!==0)return le(Ie.point,ze.point)?Ie.isBelow(ze.otherEvent.point)?-1:1:Ie.point[0]===ze.point[0]?Ie.point[1]<ze.point[1]?-1:1:At(Ie,ze)===1?ze.isAbove(Ie.point)?-1:1:Ie.isBelow(ze.point)?-1:1;if(Ie.isSubject!==ze.isSubject)return Ie.isSubject?-1:1;var Lt=Ie.point,yn=ze.point;return Lt[0]===yn[0]&&Lt[1]===yn[1]?(Lt=Ie.otherEvent.point)[0]===(yn=ze.otherEvent.point)[0]&&Lt[1]===yn[1]?0:Ie.contourId>ze.contourId?1:-1:At(Ie,ze)===1?1:-1}var Sn=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function un(Ie,ze,Lt,yn){var Pn,wn=Ie+1,Hn=ze[Ie].point,pi=ze.length;for(wn<pi&&(Pn=ze[wn].point);wn<pi&&Pn[0]===Hn[0]&&Pn[1]===Hn[1];){if(!Lt[wn])return wn;++wn<pi&&(Pn=ze[wn].point)}for(wn=Ie-1;Lt[wn]&&wn>yn;)wn--;return wn}Sn.prototype.isExterior=function(){return this.holeOf==null};var bi=Wn,Gn=Wn;function Wn(Ie,ze){if(!(this instanceof Wn))return new Wn(Ie,ze);if(this.data=Ie||[],this.length=this.data.length,this.compare=ze||mi,this.length>0)for(var Lt=(this.length>>1)-1;Lt>=0;Lt--)this._down(Lt)}function mi(Ie,ze){return Ie<ze?-1:Ie>ze?1:0}Wn.prototype={push:function(Ie){this.data.push(Ie),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ie=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ie}},peek:function(){return this.data[0]},_up:function(Ie){for(var ze=this.data,Lt=this.compare,yn=ze[Ie];Ie>0;){var Pn=Ie-1>>1,wn=ze[Pn];if(Lt(yn,wn)>=0)break;ze[Ie]=wn,Ie=Pn}ze[Ie]=yn},_down:function(Ie){for(var ze=this.data,Lt=this.compare,yn=this.length>>1,Pn=ze[Ie];Ie<yn;){var wn=1+(Ie<<1),Hn=wn+1,pi=ze[wn];if(Hn<this.length&&Lt(ze[Hn],pi)<0&&(wn=Hn,pi=ze[Hn]),Lt(pi,Pn)>=0)break;ze[Ie]=pi,Ie=wn}ze[Ie]=Pn}},bi.default=Gn;var Ci=Math.max,Ei=Math.min,$i=0;function Li(Ie,ze,Lt,yn,Pn,wn){var Hn,pi,Ji,Qi,zi,Rr;for(Hn=0,pi=Ie.length-1;Hn<pi;Hn++)if(Qi=Ie[Hn+1],zi=new Se(Ji=Ie[Hn],!1,void 0,ze),Rr=new Se(Qi,!1,zi,ze),zi.otherEvent=Rr,Ji[0]!==Qi[0]||Ji[1]!==Qi[1]){zi.contourId=Rr.contourId=Lt,wn||(zi.isExteriorRing=!1,Rr.isExteriorRing=!1),At(zi,Rr)>0?Rr.left=!0:zi.left=!0;var to=Ji[0],er=Ji[1];Pn[0]=Ei(Pn[0],to),Pn[1]=Ei(Pn[1],er),Pn[2]=Ci(Pn[2],to),Pn[3]=Ci(Pn[3],er),yn.push(zi),yn.push(Rr)}}var qi=[];function Ir(Ie,ze,Lt){typeof Ie[0][0][0]=="number"&&(Ie=[Ie]),typeof ze[0][0][0]=="number"&&(ze=[ze]);var yn=function(er,Do,lo){var Dr=null;return er.length*Do.length==0&&(lo===U?Dr=qi:lo===Y?Dr=er:lo!==Z&&lo!==re||(Dr=er.length===0?Do:er)),Dr}(Ie,ze,Lt);if(yn)return yn===qi?null:yn;var Pn=[1/0,1/0,-1/0,-1/0],wn=[1/0,1/0,-1/0,-1/0],Hn=function(er,Do,lo,Dr,Ko){var po,no,co,zr,Bi,Ur,Ro=new bi(null,At);for(co=0,zr=er.length;co<zr;co++)for(Bi=0,Ur=(po=er[co]).length;Bi<Ur;Bi++)(no=Bi===0)&&$i++,Li(po[Bi],!0,$i,Ro,lo,no);for(co=0,zr=Do.length;co<zr;co++)for(Bi=0,Ur=(po=Do[co]).length;Bi<Ur;Bi++)no=Bi===0,Ko===Y&&(no=!1),no&&$i++,Li(po[Bi],!1,$i,Ro,Dr,no);return Ro}(Ie,ze,Pn,wn,Lt);if(yn=function(er,Do,lo,Dr,Ko){var po=null;return(lo[0]>Dr[2]||Dr[0]>lo[2]||lo[1]>Dr[3]||Dr[1]>lo[3])&&(Ko===U?po=qi:Ko===Y?po=er:Ko!==Z&&Ko!==re||(po=er.concat(Do))),po}(Ie,ze,Pn,wn,Lt))return yn===qi?null:yn;for(var pi=function(er){var Do,lo,Dr=function(co){var zr,Bi,Ur,Ro,hi=[];for(Bi=0,Ur=co.length;Bi<Ur;Bi++)((zr=co[Bi]).left&&zr.inResult||!zr.left&&zr.otherEvent.inResult)&&hi.push(zr);for(var mr=!1;!mr;)for(mr=!0,Bi=0,Ur=hi.length;Bi<Ur;Bi++)Bi+1<Ur&&At(hi[Bi],hi[Bi+1])===1&&(Ro=hi[Bi],hi[Bi]=hi[Bi+1],hi[Bi+1]=Ro,mr=!1);for(Bi=0,Ur=hi.length;Bi<Ur;Bi++)(zr=hi[Bi]).otherPos=Bi;for(Bi=0,Ur=hi.length;Bi<Ur;Bi++)(zr=hi[Bi]).left||(Ro=zr.otherPos,zr.otherPos=zr.otherEvent.otherPos,zr.otherEvent.otherPos=Ro);return hi}(er),Ko={},po=[],no=function(){if(!Ko[Do]){var co=po.length,zr=function(hi,mr,mo){var qo=new Sn;if(hi.prevInResult!=null){var vo=hi.prevInResult,Za=vo.outputContourId;if(vo.resultTransition>0){var Hr=mr[Za];if(Hr.holeOf!=null){var ka=Hr.holeOf;mr[ka].holeIds.push(mo),qo.holeOf=ka,qo.depth=mr[Za].depth}else mr[Za].holeIds.push(mo),qo.holeOf=Za,qo.depth=mr[Za].depth+1}else qo.holeOf=null,qo.depth=mr[Za].depth}else qo.holeOf=null,qo.depth=0;return qo}(Dr[Do],po,co),Bi=function(hi){Ko[hi]=!0,hi<Dr.length&&Dr[hi]&&(Dr[hi].outputContourId=co)},Ur=Do,Ro=Do;for(zr.points.push(Dr[Do].point);Bi(Ur),Bi(Ur=Dr[Ur].otherPos),zr.points.push(Dr[Ur].point),!((Ur=un(Ur,Dr,Ko,Ro))==Ro||Ur>=Dr.length)&&Dr[Ur];);po.push(zr)}};for(Do=0,lo=Dr.length;Do<lo;Do++)no();return po}(function(er,Do,lo,Dr,Ko,po){for(var no,co,zr,Bi=new p(Zn),Ur=[],Ro=Math.min(Dr[2],Ko[2]);er.length!==0;){var hi=er.pop();if(Ur.push(hi),po===U&&hi.point[0]>Ro||po===Y&&hi.point[0]>Dr[2])break;if(hi.left){co=no=Bi.insert(hi),no=no!==(zr=Bi.minNode())?Bi.prev(no):null,co=Bi.next(co);var mr=no?no.key:null;if(he(hi,mr,po),co&&oi(hi,co.key,er)===2&&(he(hi,mr,po),he(co.key,hi,po)),no&&oi(no.key,hi,er)===2){var mo=no;he(mr,(mo=mo!==zr?Bi.prev(mo):null)?mo.key:null,po),he(hi,mr,po)}}else co=no=Bi.find(hi=hi.otherEvent),no&&co&&(no=no!==zr?Bi.prev(no):null,co=Bi.next(co),Bi.remove(hi),co&&no&&oi(no.key,co.key,er))}return Ur}(Hn,0,0,Pn,wn,Lt)),Ji=[],Qi=0;Qi<pi.length;Qi++){var zi=pi[Qi];if(zi.isExterior()){for(var Rr=[zi.points],to=0;to<zi.holeIds.length;to++)Rr.push(pi[zi.holeIds[to]].points);Ji.push(Rr)}}return Ji}var so={UNION:Z,DIFFERENCE:Y,INTERSECTION:U,XOR:re};a.diff=function(Ie,ze){return Ir(Ie,ze,Y)},a.intersection=function(Ie,ze){return Ir(Ie,ze,U)},a.operations=so,a.union=function(Ie,ze){return Ir(Ie,ze,Z)},a.xor=function(Ie,ze){return Ir(Ie,ze,re)},Object.defineProperty(a,"__esModule",{value:!0})})(n)}(0,Ub.exports)),Ub.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function qy(c,n,a,h){const p=[],v=h===0?(x,E,O,D,B,F)=>{x.push(new hn(F,O+(F-E)/(D-E)*(B-O)))}:(x,E,O,D,B,F)=>{x.push(new hn(E+(F-O)/(B-O)*(D-E),F))};for(const x of c){const E=[];for(const O of x){if(O.length<=2)continue;const D=[];for(let U=0;U<O.length-1;U++){const Z=O[U].x,Y=O[U].y,re=O[U+1].x,he=O[U+1].y,_e=h===0?Z:Y,Se=h===0?re:he;_e<n?Se>n&&v(D,Z,Y,re,he,n):_e>a?Se<a&&v(D,Z,Y,re,he,a):D.push(O[U]),Se<n&&_e>=n&&v(D,Z,Y,re,he,n),Se>a&&_e<=a&&v(D,Z,Y,re,he,a)}let B=O[O.length-1];const F=h===0?B.x:B.y;F>=n&&F<=a&&D.push(B),D.length&&(B=D[D.length-1],D[0].x===B.x&&D[0].y===B.y||D.push(D[0]),E.push(D))}E.length&&p.push(E)}return p}function C2(c,n){const a=b0(c),h=b0([n]),p=Vb.intersection(a,h);return p==null?[]:$b(p)}function M2(c,n){let h=b0(c,65536);for(;n.valid();n.next()){const[p,v]=n.get(),x=p.x*65536,E=p.y*65536,O=v.x*65536,D=v.y*65536,B=O-x,F=D-E,U=Math.hypot(B,F),Z=Math.trunc(F/U*3),Y=-Math.trunc(B/U*3);h=Vb.diff(h,[[[x,E],[O,D],[O+Z,D+Y],[x+Z,E+Y],[x,E]]])}return $b(h,1/65536)}function b0(c,n=1){return[c.map(a=>a.map(h=>[h.x*n,h.y*n]))]}function $b(c,n=1){return c.map(a=>a.map((h,p)=>{const v=h.map(x=>new hn(x[0]*n,x[1]*n).round());return p>0&&v.reverse(),v}))}class Hy{constructor(n,a){this.layoutVertexArray=new _c,this.indexArray=new ra,this.lineIndexArray=new Es,this.triangleSegments=new wo,this.lineSegments=new wo,this.programConfigurations=new m(n.layers,{zoom:n.zoom,lut:n.lut}),this.uploaded=!1,a&&(this.elevatedLayoutVertexArray=new Jc)}update(n,a,h,p,v,x,E,O){this.programConfigurations.updatePaintArrays(n,a,v,h,p,x,E,O)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,kb.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.lineIndexBuffer=n.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=n.createVertexBuffer(this.elevatedLayoutVertexArray,Nb.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(n,a,h,p,v,x,E){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,a,h,p,v,x,void 0,E)}}class Xf{constructor(n){this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=n.lut,this.bufferData=new Hy(n,!1),this.elevationBufferData=new Hy(n,!0),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=n.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=n.sourceLayerIndex,this.worldview=n.worldview}updateFootprints(n,a){}populate(n,a,h,p){this.hasPattern=$y("fill",this.layers,this.pixelRatio,a);const v=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:E,id:O,index:D,sourceLayerIndex:B}of n){const F=this.layers[0]._featureFilter.needGeometry,U=On(E,F);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom,{worldview:this.worldview}),U,h))continue;const Z=v?v.evaluate(U,{},h,a.availableImages):void 0,Y={id:O,properties:E.properties,type:E.type,sourceLayerIndex:B,index:D,geometry:F?U.geometry:Dn(E,h,p),patterns:{},sortKey:Z};x.push(Y)}v&&x.sort((E,O)=>E.sortKey-O.sortKey);for(const E of x){const{geometry:O,index:D,sourceLayerIndex:B}=E;if(this.hasPattern){const F=Qm("fill",this.layers,E,this.zoom,this.pixelRatio,a);this.patternFeatures.push(F)}else this.addFeature(E,O,D,h,{},a.availableImages,a.brightness,a.elevationFeatures);a.featureIndex.insert(n[D].feature,O,D,B,this.index)}}update(n,a,h,p,v,x,E){this.bufferData.update(n,a,h,p,v,x,E,this.worldview),this.elevationBufferData.update(n,a,h,p,v,x,E,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(n,a,h,p,v,x,E,this.worldview)}addFeatures(n,a,h,p,v,x){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,a,h,p,x,n.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(n){this.bufferData.upload(n),this.elevationBufferData.upload(n),this.elevatedStructures&&this.elevatedStructures.upload(n)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(n,a,h,p,v,x=[],E,O){const D=m_(a,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(n,D,p,h,O):this.addGeometry(D,this.bufferData),this.bufferData.populatePaintArrays(n,h,v,x,p,E,this.worldview),this.elevationBufferData.populatePaintArrays(n,h,v,x,p,E,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(n,a,h,p,v){this.elevatedStructures&&(this.elevatedStructures.construct(n),this.elevatedStructures.populatePaintArrays(a,h,p,v,this.worldview))}addElevatedRoadFeature(n,a,h,p,v){const x=new Array,E=Ml.getElevationFeature(n,v);if(!E)return void this.addGeometry(a,this.bufferData);{const D=this.clipPolygonsToTile(a,1);D.length>0&&x.push({polygons:D,elevationFeature:E,elevationTileID:h})}const O={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(n,{},h),featureIndex:p};for(const D of x)if(D.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Qs(D.elevationTileID,this.layers,this.zoom,this.lut));const F=D.elevationFeature.isTunnel();let U=0;n.properties.hasOwnProperty(Pr)&&(U=+n.properties[Pr]);for(const Z of D.polygons)this.elevatedStructures.addPortalCandidates(D.elevationFeature.id,Z,F,D.elevationFeature,U)}D.elevationFeature.constantHeight==null&&(D.polygons=this.prepareElevatedPolygons(D.polygons,D.elevationFeature,D.elevationTileID));const B=new Tc(h,D.elevationTileID);this.addElevatedGeometry(D.polygons,B,D.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p,O)}}addElevatedGeometry(n,a,h,p,v,x){const E={elevation:h,elevationSampler:a,bias:p,index:v,featureInfo:x},[O,D]=this.addGeometry(n,this.elevationBufferData,E);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:O,max:D}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,O),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,D))}addGeometry(n,a,h){let p=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,x=null;h&&(x=h.elevationSampler.constantElevation(h.elevation,h.bias),x!=null&&(p=x,v=x));const E=(O,D,B)=>{if(h!=null)if(D.push(O),x!=null)a.elevatedLayoutVertexArray.emplaceBack(x),B.push(x);else{const F=h.elevationSampler.pointElevation(O,h.elevation,h.bias);a.elevatedLayoutVertexArray.emplaceBack(F),B.push(F),p=Math.min(p,F),v=Math.max(v,F)}};for(const O of n){let D=0;for(const Ce of O)D+=Ce.length;const B=a.triangleSegments.prepareSegment(D,a.layoutVertexArray,a.indexArray),F=B.vertexLength,U=[],Z=[],Y=[],re=[],he=[],_e=a.layoutVertexArray.length;for(const Ce of O){if(Ce.length===0)continue;Ce!==O[0]&&Z.push(U.length/2);const le=a.lineSegments.prepareSegment(Ce.length,a.layoutVertexArray,a.lineIndexArray),Te=le.vertexLength;h&&he.push(a.layoutVertexArray.length-_e),E(Ce[0],Y,re),a.layoutVertexArray.emplaceBack(Ce[0].x,Ce[0].y),a.lineIndexArray.emplaceBack(Te+Ce.length-1,Te),U.push(Ce[0].x),U.push(Ce[0].y);for(let Me=1;Me<Ce.length;Me++)E(Ce[Me],Y,re),a.layoutVertexArray.emplaceBack(Ce[Me].x,Ce[Me].y),a.lineIndexArray.emplaceBack(Te+Me-1,Te+Me),U.push(Ce[Me].x),U.push(Ce[Me].y);le.vertexLength+=Ce.length,le.primitiveLength+=Ce.length}const Se=Zp(U,Z);for(let Ce=0;Ce<Se.length;Ce+=3)a.indexArray.emplaceBack(F+Se[Ce],F+Se[Ce+1],F+Se[Ce+2]);if(Se.length>0&&h&&this.elevationMode==="hd-road-base"){const Ce=h.elevation.isTunnel(),le=h.elevation.safeArea,Te=this.elevatedStructures.addVertices(Y,re);this.elevatedStructures.addTriangles(Se,Te,Ce);const Me=he.length;if(Me>0){for(let Re=0;Re<Me-1;Re++)this.elevatedStructures.addRenderableRing(h.index,he[Re]+Te,he[Re+1]-he[Re],Ce,le,h.featureInfo);this.elevatedStructures.addRenderableRing(h.index,he[Me-1]+Te,Y.length-he[Me-1],Ce,le,h.featureInfo)}}B.vertexLength+=D,B.primitiveLength+=Se.length/3}return[p,v]}prepareElevatedPolygons(n,a,h){const p=1/Et(h),v=[];for(const x of n){const E=M2(x,new Ps(a,p));v.push(...E)}return v}clipPolygonsToTile(n,a){const h=-a,p=-a,v=fn+a,x=fn+a;let E=0;const O=[],D=[];for(;E<n.length;E++){const U=n[E],Z=Bh(U);(Z.min.x>=h&&Z.max.x<=v&&Z.min.y>=p&&Z.max.y<=x?O:D).push(U)}if(O.length===n.length)return n;const B=[new hn(h,p),new hn(v,p),new hn(v,x),new hn(h,x),new hn(h,p)],F=O;for(const U of D)F.push(...C2(U,B));return F}}let eg,w0,qb,em;Nn(Xf,"FillBucket",{omit:["layers","patternFeatures"]}),Nn(Hy,"FillBufferData"),Nn(Qs,"ElevatedStructures");class tm{constructor(n,a,h,p){if(this.triangleCount=a.length/3,this.min=new hn(0,0),this.max=new hn(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[v,x]=[n[0].clone(),n[0].clone()];for(let F=1;F<n.length;++F){const U=n[F];v.x=Math.min(v.x,U.x),v.y=Math.min(v.y,U.y),x.x=Math.max(x.x,U.x),x.y=Math.max(x.y,U.y)}if(p){const F=Math.ceil(Math.max(x.x-v.x,x.y-v.y)/p);h=Math.max(h,F)}if(h===0)return;this.min=v,this.max=x;const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const O=Math.max(E.x,E.y)/h;this.cellsX=Math.max(1,Math.ceil(E.x/O)),this.cellsY=Math.max(1,Math.ceil(E.y/O)),this.xScale=1/O,this.yScale=1/O;const D=[];for(let F=0;F<this.triangleCount;F++){const U=n[a[3*F+0]].sub(this.min),Z=n[a[3*F+1]].sub(this.min),Y=n[a[3*F+2]].sub(this.min),re=hh(Math.floor(Math.min(U.x,Z.x,Y.x)),this.xScale,this.cellsX),he=hh(Math.floor(Math.max(U.x,Z.x,Y.x)),this.xScale,this.cellsX),_e=hh(Math.floor(Math.min(U.y,Z.y,Y.y)),this.yScale,this.cellsY),Se=hh(Math.floor(Math.max(U.y,Z.y,Y.y)),this.yScale,this.cellsY),Ce=new hn(0,0),le=new hn(0,0),Te=new hn(0,0),Me=new hn(0,0);for(let Re=_e;Re<=Se;++Re){Ce.y=le.y=Re*O,Te.y=Me.y=(Re+1)*O;for(let et=re;et<=he;++et)Ce.x=Te.x=et*O,le.x=Me.x=(et+1)*O,(l_(U,Z,Y,Ce,le,Me)||l_(U,Z,Y,Ce,Me,Te))&&D.push({cellIdx:Re*this.cellsX+et,triIdx:F})}}if(D.length===0)return;D.sort((F,U)=>F.cellIdx-U.cellIdx||F.triIdx-U.triIdx);let B=0;for(;B<D.length;){const F=D[B].cellIdx,U={start:this.payload.length,len:0};for(;B<D.length&&D[B].cellIdx===F;)++U.len,this.payload.push(D[B++].triIdx);this.cells[F]=U}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,a){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const h=hh(n.x-this.min.x,this.xScale,this.cellsX),p=hh(n.y-this.min.y,this.yScale,this.cellsY),v=this.cells[p*this.cellsX+h];if(v){this._lazyInitLookup();for(let x=0;x<v.len;x++){const E=this.payload[v.start+x],O=Math.floor(E/8),D=1<<E%8;if(!(this.lookup[O]&D)&&(this.lookup[O]|=D,a.push(E),a.length===this.triangleCount))return}}}query(n,a,h){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>a.x||n.y>this.max.y||this.min.y>a.y)return;this._lazyInitLookup();const p=hh(n.x-this.min.x,this.xScale,this.cellsX),v=hh(a.x-this.min.x,this.xScale,this.cellsX),x=hh(n.y-this.min.y,this.yScale,this.cellsY),E=hh(a.y-this.min.y,this.yScale,this.cellsY);for(let O=x;O<=E;O++)for(let D=p;D<=v;D++){const B=this.cells[O*this.cellsX+D];if(B)for(let F=0;F<B.len;F++){const U=this.payload[B.start+F],Z=Math.floor(U/8),Y=1<<U%8;if(!(this.lookup[Z]&Y)&&(this.lookup[Z]|=Y,h.push(U),h.length===this.triangleCount))return}}}}function hh(c,n,a){return Math.max(0,Math.min(a-1,Math.floor(c*n)))}Nn(tm,"TriangleGridIndex");class __{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.footprints=[],this.worldview=n.worldview}updateFootprints(n,a){for(const h of this.footprints)a.push({footprint:h,id:n})}populate(n,a,h,p){const v=[];for(const{feature:x,id:E,index:O,sourceLayerIndex:D}of n){const B=this.layers[0]._featureFilter.needGeometry,F=On(x,B);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom,{worldview:this.worldview}),F,h))continue;const U={id:E,properties:x.properties,type:x.type,sourceLayerIndex:D,index:O,geometry:B?F.geometry:Dn(x,h,p),patterns:{}};v.push(U)}for(const x of v){const{geometry:E,index:O,sourceLayerIndex:D}=x;this.addFeature(x,E,O,h,{},a.availableImages,a.brightness),a.featureIndex.insert(n[O].feature,E,O,D,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,a,h,p,v,x,E){}destroy(){}addFeature(n,a,h,p,v,x=[],E){for(const O of m_(a,2)){const D=[],B=[],F=[],U=new hn(1/0,1/0),Z=new hn(-1/0,-1/0);for(const he of O)if(he.length!==0){he!==O[0]&&F.push(B.length/2);for(let _e=0;_e<he.length;_e++)B.push(he[_e].x),B.push(he[_e].y),D.push(he[_e]),U.x=Math.min(U.x,he[_e].x),U.y=Math.min(U.y,he[_e].y),Z.x=Math.max(Z.x,he[_e].x),Z.y=Math.max(Z.y,he[_e].y)}const Y=Zp(B,F),re=new tm(D,Y,8,256);this.footprints.push({vertices:D,indices:Y,grid:re,min:U,max:Z})}}}Nn(__,"ClipBucket",{omit:["layers"]});const T0=ar([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),S0=ar([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Gy=ar([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Hb=ar([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Gb=ar([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),O2=ar([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Zb}=T0,Yf=Number.MAX_SAFE_INTEGER;function Wb(c,n,a,h){return c.order<n||c.order===Yf||!(c.clipMask&a)||function(p,v){return v.length!==0&&v.find(x=>x===p)===void 0}(h,c.clipScope)}function Zy(c,n){return c.x-n.x||c.y-n.y}function Xb(c,n){return Zy(c.min,n.min)===0&&Zy(c.max,n.max)===0}function tg(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function ng(c,n){if(c.length!==n.length)return!1;for(let a=0;a<c.length;a++)if(c[a].sourceId!==n[a].sourceId||!Xb(c[a],n[a])||c[a].order!==n[a].order||c[a].clipMask!==n[a].clipMask||!vs(c[a].clipScope,n[a].clipScope))return!1;return!0}function Wy(c,n,a){const h=1/fn,p=1/(1<<a.canonical.z),v=(n.x*h+a.canonical.x)*p+a.wrap,x=(n.y*h+a.canonical.y)*p;return{min:new hn((c.x*h+a.canonical.x)*p+a.wrap,(c.y*h+a.canonical.y)*p),max:new hn(v,x)}}function I2(c,n,a){const h=1<<a.canonical.z,p=((n.x-a.wrap)*h-a.canonical.x)*fn,v=(n.y*h-a.canonical.y)*fn;return{min:new hn(((c.x-a.wrap)*h-a.canonical.x)*fn,(c.y*h-a.canonical.y)*fn),max:new hn(p,v)}}function ig(c,n,a,h,p,v,x){const E=c.indices,O=c.vertices,D=[];for(let B=h;B<h+p;B+=3){const F=n[a[B+0]+v],U=n[a[B+1]+v],Z=n[a[B+2]+v],Y=Math.min(F.x,U.x,Z.x),re=Math.max(F.x,U.x,Z.x),he=Math.min(F.y,U.y,Z.y),_e=Math.max(F.y,U.y,Z.y);D.length=0,c.grid.query(new hn(Y,he),new hn(re,_e),D);for(let Se=0;Se<D.length;Se++){const Ce=D[Se];if(l_(O[E[3*Ce+0]],O[E[3*Ce+1]],O[E[3*Ce+2]],F,U,Z,x))return!0}}return!1}function Yb(c,n,a,h){if(!c||!a)return!1;let p=c.vertices;if(!n.canonical.equals(h.canonical)||n.wrap!==h.wrap){if(a.vertices.length<c.vertices.length)return Yb(a,h,c,n);const v=n.canonical,x=h.canonical,E=Math.pow(2,x.z-v.z);p=c.vertices.map(O=>new hn((O.x+v.x*fn)*E-x.x*fn,(O.y+v.y*fn)*E-x.y*fn))}return ig(a,p,c.indices,0,c.indices.length,0,0)}function E0(c,n,a,h){const p=Math.pow(2,h.z-a.z);return new hn((c+a.x*fn)*p-h.x*fn,(n+a.y*fn)*p-h.y*fn)}function A0(c,n){const a=[];n.grid.queryPoint(c,a);const h=n.indices,p=n.vertices;for(let v=0;v<a.length;v++){const x=a[v];if(tu([p[h[3*x+0]],p[h[3*x+1]],p[h[3*x+2]]],c))return!0}return!1}const Xy=[new hn(0,0),new hn(fn,0),new hn(fn,fn),new hn(0,fn)];function P0(c,n){const a=[];let h=[];if(!n||c.length<2)return[c];if(c.length===2)return td(c[0],c[1],Xy)?[c]:[];for(let p=0;p<c.length+2;p++){const v=c[p%c.length],x=c[(p+1)%c.length],E=td(p===0?c[c.length-1]:c[(p-1)%c.length],v,Xy),O=td(v,x,Xy),D=E||O;D&&h.push(v),D&&O||h.length>0&&(h.length>1&&a.push(h),h=[])}return h.length>1&&a.push(h),a}const y_=xi.VectorTileFeature.types,Kb=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Yy=["fill-extrusion-flood-light-ground-radius"],D2=Math.pow(2,13),R2=Math.pow(2,15)-1,Ky=new hn(0,1),od=2147483648;function Kf(c,n,a,h,p,v,x,E){c.emplaceBack((n<<1)+x,(a<<1)+v,(Math.floor(h*D2)<<1)+p,Math.round(E))}function nm(c,n,a){c.emplaceBack(n.x*fn,n.y*fn,a?1:0)}function v_(c,n,a,h,p,v){c.emplaceBack(n.x,n.y,(a.x<<1)+h,(a.y<<1)+p,v)}function im(c,n,a){c.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class nf{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class rf{constructor(){this.centroidXY=new hn(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new hn(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new hn(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new hn(this.max.x-this.min.x,this.max.y-this.min.y)}}class of{constructor(){this.acc=new hn(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,a){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=a.x,n.min.y=n.max.y=a.y)}appendEdge(n,a,h){this.accCount++,this.acc._add(a);let p=!!this.borders;a.x<n.min.x?(n.min.x=a.x,p=!0):a.x>n.max.x&&(n.max.x=a.x,p=!0),a.y<n.min.y?(n.min.y=a.y,p=!0):a.y>n.max.y&&(n.max.y=a.y,p=!0),((a.x===0||a.x===fn)&&a.x===h.x)!=((a.y===0||a.y===fn)&&a.y===h.y)&&this.processBorderOverlap(a,h),p&&this.checkBorderIntersection(a,h)}checkBorderIntersection(n,a){a.x<0!=n.x<0&&this.addBorderIntersection(0,Xn(a.y,n.y,(0-a.x)/(n.x-a.x))),a.x>fn!=n.x>fn&&this.addBorderIntersection(1,Xn(a.y,n.y,(fn-a.x)/(n.x-a.x))),a.y<0!=n.y<0&&this.addBorderIntersection(2,Xn(a.x,n.x,(0-a.y)/(n.y-a.y))),a.y>fn!=n.y>fn&&this.addBorderIntersection(3,Xn(a.x,n.x,(fn-a.y)/(n.y-a.y)))}addBorderIntersection(n,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[n];a<h[0]&&(h[0]=a),a>h[1]&&(h[1]=a)}processBorderOverlap(n,a){if(n.x===a.x){if(n.y===a.y)return;const h=n.x===0?0:1;this.addBorderIntersection(h,a.y),this.addBorderIntersection(h,n.y)}else{const h=n.y===0?2:3;this.addBorderIntersection(h,a.x),this.addBorderIntersection(h,n.x)}}centroid(){return this.accCount===0?new hn(0,0):new hn(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,a)=>n+ +(a[0]!==Number.MAX_VALUE),0):0}}function rg(c,n){const a=c.add(n)._unit(),h=be(c.x*a.x+c.y*a.y,-1,1);var p,v,x;return p=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(p)))/4*R2*((v=c).x*(x=n).y-v.y*x.x<0?-1:1)}const x_=[c=>c.x<0,c=>c.x>fn,c=>c.y<0,c=>c.y>fn];function Jf(c,n,a,h){const p=[4];if(h===0)return p;a._mult(h);const v=c.sub(a),x=n.sub(a),E=[c,n,v,x];for(let O=0;O<4;O++)for(const D of E)if(x_[O](D)){p.push(O);break}return p}class Jb{constructor(n){this.vertexArray=new Nf,this.indexArray=new ra,this.programConfigurations=new m(n.layers,{zoom:n.zoom,lut:n.lut},a=>Yy.includes(a)),this._segments=new wo,this.hiddenByLandmarkVertexArray=new Uf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new wo}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,a,h,p=!1){const v=n.length;if(v>2){let x=Math.max(0,this._segments.get().length-1);const E=this._segments._prepareSegment(4*v,this.vertexArray.length,2*this._segmentToGroundQuads[x].length);let O;x!==this._segments.get().length-1&&(x++,this._segmentToGroundQuads[x]=[],this._segmentToRegionTriCounts[x]=[0,0,0,0,0]);{const D=n[0],B=n[1];O=rg(D.sub(n[v-1])._perp()._unit(),B.sub(D)._perp()._unit())}for(let D=0;D<v;D++){const B=D===v-1?0:D+1,F=n[D],U=n[B],Z=n[B===v-1?0:B+1],Y=U.sub(F)._perp()._unit(),re=rg(Y,Z.sub(U)._perp()._unit()),he=O,_e=re;if(ag(F,U,a)||p&&M0(F,a)&&M0(U,a)){O=re;continue}const Se=E.vertexLength;v_(this.vertexArray,F,U,1,1,he),v_(this.vertexArray,F,U,1,0,he),v_(this.vertexArray,F,U,0,1,_e),v_(this.vertexArray,F,U,0,0,_e),E.vertexLength+=4;const Ce=Jf(F,U,Y,h);for(const le of Ce)this._segmentToGroundQuads[x].push({id:Se,region:le}),this._segmentToRegionTriCounts[x][le]+=2,E.primitiveLength+=2;O=re}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),a=n.length;for(let h=0;h<a;h++)this._segmentToGroundQuads[h].sort((p,v)=>p.region-v.region);for(let h=0;h<a;h++){const p=this._segmentToGroundQuads[h],v=n[h],x=this._segmentToRegionTriCounts[h];x.reduce((O,D)=>O+D,0);let E=0;for(let O=0;O<=4;O++){const D=x[O];if(D!==0){let B=this.regionSegments[O];B||(B=this.regionSegments[O]=new wo);const F={vertexOffset:v.vertexOffset,primitiveOffset:v.primitiveOffset+E,vertexLength:v.vertexLength,primitiveLength:D};B.get().push(F)}E+=D}for(let O=0;O<p.length;O++){const D=p[O].id;this.indexArray.emplaceBack(D,D+1,D+3),this.indexArray.emplaceBack(D,D+3,D+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,a,h,p,v,x,E){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,a,h,p,v,x,void 0,E)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,S0.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,a,h,p,v,x,E,O){this.hasData()&&this.programConfigurations.updatePaintArrays(n,a,h,p,v,x,E,O)}updateHiddenByLandmark(n){if(!this.hasData())return;const a=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const h=n.flags&od?1:0;for(let p=n.groundVertexArrayOffset;p<a;++p)this.hiddenByLandmarkVertexArray.emplace(p,h);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,Gb.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const a=this.regionSegments[n];a&&a.destroy()}}}}class b_{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.pixelRatio=n.pixelRatio,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ra,this.footprintVertices=new _c,this.footprintSegments=[],this.layoutVertexArray=new Gd,this.centroidVertexArray=new a_,this.wallVertexArray=new Fm,this.indexArray=new ra,this.programConfigurations=new m(n.layers,{zoom:n.zoom,lut:n.lut},a=>Kb.includes(a)),this.segments=new wo,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new Jb(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=n.worldview}updateFootprints(n,a){}populate(n,a,h,p){this.features=[],this.hasPattern=$y("fill-extrusion",this.layers,this.pixelRatio,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Et(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:v,id:x,index:E,sourceLayerIndex:O}of n){const D=this.layers[0]._featureFilter.needGeometry,B=On(v,D);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom,{worldview:this.worldview}),B,h))continue;const F={id:x,sourceLayerIndex:O,index:E,geometry:D?B.geometry:Dn(v,h,p),properties:v.properties,type:v.type,patterns:{}},U=this.layoutVertexArray.length,Z=y_[F.type]==="Polygon";if(this.hasPattern)this.features.push(Qm("fill-extrusion",this.layers,F,this.zoom,this.pixelRatio,a));else if(this.wallMode)for(const Y of F.geometry)for(const re of P0(Y,Z))this.addFeature(F,[re],E,h,{},a.availableImages,p,a.brightness);else this.addFeature(F,F.geometry,E,h,{},a.availableImages,p,a.brightness);a.featureIndex.insert(v,F.geometry,E,O,this.index,U)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,a,h,p,v,x){for(const E of this.features){const O=y_[E.type]==="Polygon",{geometry:D}=E;if(this.wallMode)for(const B of D)for(const F of P0(B,O))this.addFeature(E,[F],E.index,a,h,p,v,x);else this.addFeature(E,D,E.index,a,h,p,v,x)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,a,h,p,v,x,E){this.programConfigurations.updatePaintArrays(n,a,v,h,p,x,E,this.worldview),this.groundEffect.update(n,a,v,h,p,x,E,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Zb),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,Hb.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,O2.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,Gy.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,h,p,v,x,E,O){const D=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,B=[new hn(0,0),new hn(fn,fn)],F=E.projection,U=F.name==="globe",Z=this.wallMode||y_[n.type]==="Polygon",Y=new of;Y.centroidDataIndex=this.centroidData.length;const re=new rf,he=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},p)<=0,_e=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},p);let Se;if(re.height=_e,re.vertexArrayOffset=this.layoutVertexArray.length,re.groundVertexArrayOffset=this.groundEffect.vertexArray.length,U&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Zd),this.wallMode){if(U)return void ui("Non zero fill-extrusion-line-width is not yet supported on globe.");if(a.length!==1)return;Se=function(it){const dt=it[0].x===it[it.length-1].x&&it[0].y===it[it.length-1].y;(function(Sn){let un=0;const bi=Sn.length;for(let Gn=0;Gn<bi;Gn++)un+=(Sn[(Gn+1)%bi].x-Sn[Gn].x)*(Sn[(Gn+1)%bi].y+Sn[Gn].y);return un>=0})(it)||(it=it.reverse());const tn={geometry:[],joinNormals:[],indices:[]},qt=[],Jt=[],sn=[];let Ot=it.length;for(;Ot>=2&&it[Ot-1].equals(it[Ot-2]);)Ot--;if(Ot<(dt?3:2))return tn;let Yt,At,Mt,dn,gn,oi=0;for(;oi<Ot-1&&it[oi].equals(it[oi+1]);)oi++;dt&&(Yt=it[Ot-2],gn=it[oi].sub(Yt)._unit()._perp());for(let Sn=oi;Sn<Ot;Sn++){if(Mt=Sn===Ot-1?dt?it[oi+1]:void 0:it[Sn+1],Mt&&it[Sn].equals(Mt))continue;gn&&(dn=gn),Yt&&(At=Yt),Yt=it[Sn],gn=Mt?Mt.sub(Yt)._unit()._perp():dn,dn=dn||gn;let un=dn.add(gn);un.x===0&&un.y===0||un._unit();const bi=un.x*gn.x+un.y*gn.y,Gn=bi!==0?1/bi:1/0,Wn=dn.x*gn.y-dn.y*gn.x>0;let mi="miter";const Ci=2;mi==="miter"&&Gn>Ci&&(mi="bevel"),mi==="bevel"&&(Gn>100&&(mi="flipbevel"),Gn<Ci&&(mi="miter"));const Ei=($i,Li,qi,Ir)=>{const so=new hn($i.x,$i.y),Ie=new hn($i.x,$i.y);so.x+=Li.x*Ir,so.y+=Li.y*Ir,Ie.x-=Li.x*Math.max(qi,1),Ie.y-=Li.y*Math.max(qi,1),sn.push(Li),qt.push(so),Jt.push(Ie)};if(mi==="miter")un._mult(Gn),Ei(Yt,un,0,0);else if(mi==="flipbevel")un=gn.mult(-1),Ei(Yt,un,0,0),Ei(Yt,un.mult(-1),0,0);else{const $i=-Math.sqrt(Gn*Gn-1),Li=Wn?$i:0,qi=Wn?0:$i;At&&Ei(Yt,dn,Li,qi),Mt&&Ei(Yt,gn,Li,qi)}}tn.geometry=[...qt,...Jt.reverse(),qt[0]],tn.joinNormals=[...sn,...sn.reverse(),sn[sn.length-1]];const Zn=tn.geometry.length-1;for(let Sn=0;Sn<Zn/2;Sn++)if(Sn+1<Zn/2){let un=Sn,bi=Sn+1,Gn=Zn-1-Sn,Wn=Zn-2-Sn;un=un===0?Zn-1:un-1,bi=bi===0?Zn-1:bi-1,Gn=Gn===0?Zn-1:Gn-1,Wn=Wn===0?Zn-1:Wn-1,tn.indices.push(Gn),tn.indices.push(bi),tn.indices.push(un),tn.indices.push(Gn),tn.indices.push(Wn),tn.indices.push(bi)}return tn}(a[0]),a=[Se.geometry]}const Ce=(it,dt)=>it<(dt.length-1)/2||it===dt.length-1,le=this.wallMode?[a]:m_(a,500);for(let it=le.length-1;it>=0;it--){const dt=le[it];(dt.length===0||(Te=dt[0]).every(Ct=>Ct.x<=0)||Te.every(Ct=>Ct.x>=fn)||Te.every(Ct=>Ct.y<=0)||Te.every(Ct=>Ct.y>=fn))&&le.splice(it,1)}var Te;let Me;if(U)Me=O0(le,B,p);else{Me=[];for(const it of le)Me.push({polygon:it,bounds:B})}const Re=Z?this.edgeRadius:0,et=Re>0&&this.zoom<17,Ye=(it,dt)=>{if(it.length===0)return!1;const Ct=it[it.length-1];return dt.x===Ct.x&&dt.y===Ct.y};for(const{polygon:it,bounds:dt}of Me){let Ct=0,tn=0;for(const Ot of it)Z&&!Ot[0].equals(Ot[Ot.length-1])&&Ot.push(Ot[0]),tn+=Z?Ot.length-1:Ot.length;const qt=this.segments.prepareSegment((Z?5:4)*tn,this.layoutVertexArray,this.indexArray);re.footprintSegIdx<0&&(re.footprintSegIdx=this.footprintSegments.length),re.polygonSegIdx<0&&(re.polygonSegIdx=this.polygonSegments.length);const Jt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},sn=new nf;if(sn.vertexOffset=this.footprintVertices.length,sn.indexOffset=3*this.footprintIndices.length,sn.ringIndices=[],Z){const Ot=[],Yt=[];Ct=qt.vertexLength;for(let Mt=0;Mt<it.length;Mt++){const dn=it[Mt];dn.length&&Mt!==0&&Yt.push(Ot.length/2);const gn=[];let oi,Zn;oi=dn[1].sub(dn[0])._perp()._unit(),sn.ringIndices.push(dn.length-1);for(let Sn=1;Sn<dn.length;Sn++){const un=dn[Sn],bi=dn[Sn===dn.length-1?1:Sn+1],Gn=un.clone();if(Re){Zn=bi.sub(un)._perp()._unit();const Wn=oi.add(Zn)._unit(),mi=Re*Math.min(4,1/(oi.x*Wn.x+oi.y*Wn.y));Gn.x+=mi*Wn.x,Gn.y+=mi*Wn.y,Gn.x=Math.round(Gn.x),Gn.y=Math.round(Gn.y),oi=Zn}if(!he||Re!==0&&!et||Ye(gn,Gn)||gn.push(Gn),Kf(this.layoutVertexArray,Gn.x,Gn.y,0,0,1,1,0),this.wallMode){const Wn=Ce(Sn,dn);nm(this.wallVertexArray,Se.joinNormals[Sn],!Wn)}qt.vertexLength++,this.footprintVertices.emplaceBack(un.x,un.y),Ot.push(un.x,un.y),U&&im(this.layoutVertexExtArray,F.projectTilePoint(Gn.x,Gn.y,p),F.upVector(p,Gn.x,Gn.y))}he&&(Re===0||et)&&(gn.length!==0&&Ye(gn,gn[0])&&gn.pop(),this.groundEffect.addData(gn,dt,D))}const At=this.wallMode?Se.indices:Zp(Ot,Yt);for(let Mt=0;Mt<At.length;Mt+=3)this.footprintIndices.emplaceBack(sn.vertexOffset+At[Mt+0],sn.vertexOffset+At[Mt+1],sn.vertexOffset+At[Mt+2]),this.indexArray.emplaceBack(Ct+At[Mt],Ct+At[Mt+2],Ct+At[Mt+1]),qt.primitiveLength++;sn.indexCount+=At.length,sn.vertexCount+=this.footprintVertices.length-sn.vertexOffset}for(let Ot=0;Ot<it.length;Ot++){const Yt=it[Ot];Y.startRing(re,Yt[0]);let At=Yt.length>4&&Qb(Yt[Yt.length-2],Yt[0],Yt[1]),Mt=Re?L2(Yt[Yt.length-2],Yt[0],Yt[1],Re):0;const dn=[];let gn,oi,Zn;oi=Yt[1].sub(Yt[0])._perp()._unit();let Sn=!0;for(let un=1,bi=0;un<Yt.length;un++){let Gn=Yt[un-1],Wn=Yt[un];const mi=Yt[un===Yt.length-1?1:un+1];if(Y.appendEdge(re,Wn,Gn),ag(Wn,Gn,dt)){Re&&(oi=mi.sub(Wn)._perp()._unit(),Sn=!Sn);continue}const Ci=Wn.sub(Gn)._perp(),Ei=Ci.x/(Math.abs(Ci.x)+Math.abs(Ci.y)),$i=Ci.y>0?1:0,Li=Gn.dist(Wn);if(bi+Li>32768&&(bi=0),Re){Zn=mi.sub(Wn)._perp()._unit();let Ie=C0(Gn,Wn,mi,og(oi,Zn),Re);isNaN(Ie)&&(Ie=0);const ze=Wn.sub(Gn)._unit();Gn=Gn.add(ze.mult(Mt))._round(),Wn=Wn.add(ze.mult(-Ie))._round(),Mt=Ie,oi=Zn,he&&this.zoom>=17&&(Ye(dn,Gn)||dn.push(Gn),Ye(dn,Wn)||dn.push(Wn))}const qi=qt.vertexLength,Ir=Yt.length>4&&Qb(Gn,Wn,mi);let so=w_(bi,At,Sn);if(Kf(this.layoutVertexArray,Gn.x,Gn.y,Ei,$i,0,0,so),Kf(this.layoutVertexArray,Gn.x,Gn.y,Ei,$i,0,1,so),this.wallMode){const Ie=Ce(un-1,Yt),ze=Se.joinNormals[un-1];nm(this.wallVertexArray,ze,Ie),nm(this.wallVertexArray,ze,Ie)}if(bi+=Li,so=w_(bi,Ir,!Sn),At=Ir,Kf(this.layoutVertexArray,Wn.x,Wn.y,Ei,$i,0,0,so),Kf(this.layoutVertexArray,Wn.x,Wn.y,Ei,$i,0,1,so),this.wallMode){const Ie=Ce(un,Yt),ze=Se.joinNormals[un];nm(this.wallVertexArray,ze,Ie),nm(this.wallVertexArray,ze,Ie)}if(qt.vertexLength+=4,this.indexArray.emplaceBack(qi+0,qi+1,qi+2),this.indexArray.emplaceBack(qi+1,qi+3,qi+2),qt.primitiveLength+=2,Re){const Ie=Ct+(un===1?Yt.length-2:un-2),ze=un===1?Ct:Ie+1;if(this.indexArray.emplaceBack(qi+1,Ie,qi+3),this.indexArray.emplaceBack(Ie,ze,qi+3),qt.primitiveLength+=2,gn===void 0&&(gn=qi),!ag(mi,Yt[un],dt)){const Lt=un===Yt.length-1?gn:qt.vertexLength;this.indexArray.emplaceBack(qi+2,qi+3,Lt),this.indexArray.emplaceBack(qi+3,Lt+1,Lt),this.indexArray.emplaceBack(qi+3,ze,Lt+1),qt.primitiveLength+=3}Sn=!Sn}if(U){const Ie=this.layoutVertexExtArray,ze=F.projectTilePoint(Gn.x,Gn.y,p),Lt=F.projectTilePoint(Wn.x,Wn.y,p),yn=F.upVector(p,Gn.x,Gn.y),Pn=F.upVector(p,Wn.x,Wn.y);im(Ie,ze,yn),im(Ie,ze,yn),im(Ie,Lt,Pn),im(Ie,Lt,Pn)}}Z&&(Ct+=Yt.length-1),he&&Re&&this.zoom>=17&&(dn.length!==0&&Ye(dn,dn[0])&&dn.pop(),this.groundEffect.addData(dn,dt,D,Re>0))}this.footprintSegments.push(sn),Jt.triangleCount=this.indexArray.length-Jt.triangleArrayOffset,this.polygonSegments.push(Jt),++re.footprintSegLen,++re.polygonSegLen}if(re.vertexCount=this.layoutVertexArray.length-re.vertexArrayOffset,re.groundVertexCount=this.groundEffect.vertexArray.length-re.groundVertexArrayOffset,re.vertexCount!==0){if(re.centroidXY=Y.borders?Ky:this.encodeCentroid(Y,re),this.centroidData.push(re),Y.borders){this.featuresOnBorder.push(Y);const it=this.featuresOnBorder.length-1;for(let dt=0;dt<Y.borders.length;dt++)Y.borders[dt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[dt].push(it)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,v,x,p,O,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(n,h,v,x,p,O,this.worldview),this.maxHeight=Math.max(this.maxHeight,_e)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((a,h)=>this.featuresOnBorder[a].borders[n][0]-this.featuresOnBorder[h].borders[n][0])}splitToSubtiles(){const n=[];for(let E=0;E<this.centroidData.length;E++){const O=this.centroidData[E],D=+(O.min.y+O.max.y>fn),B=2*D+(+(O.min.x+O.max.x>fn)^D);for(let F=0;F<O.polygonSegLen;F++){const U=O.polygonSegIdx+F;n.push({centroidIdx:E,subtile:B,polygonSegmentIdx:U,triangleSegmentIdx:this.polygonSegments[U].triangleSegIdx})}}const a=new ra;n.sort((E,O)=>E.triangleSegmentIdx===O.triangleSegmentIdx?E.subtile-O.subtile:E.triangleSegmentIdx-O.triangleSegmentIdx);let h=0,p=0,v=0;for(const E of n){if(E.triangleSegmentIdx!==h)break;v++}const x=n.length;for(;p!==n.length;){h=n[p].triangleSegmentIdx;let E=0,O=p,D=p;for(let B=O;B<v&&n[B].subtile===E;B++)D++;for(;O!==v;){const B=n[O];E=B.subtile;const F=this.centroidData[B.centroidIdx].min.clone(),U=this.centroidData[B.centroidIdx].max.clone(),Z={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Y=O;Y<D;Y++){const re=n[Y],he=this.polygonSegments[re.polygonSegmentIdx],_e=this.centroidData[re.centroidIdx].min,Se=this.centroidData[re.centroidIdx].max,Ce=this.indexArray.uint16;for(let le=he.triangleArrayOffset;le<he.triangleArrayOffset+he.triangleCount;le++)a.emplaceBack(Ce[3*le],Ce[3*le+1],Ce[3*le+2]);Z.primitiveLength+=he.triangleCount,F.x=Math.min(F.x,_e.x),F.y=Math.min(F.y,_e.y),U.x=Math.max(U.x,Se.x),U.y=Math.max(U.y,Se.y)}Z.primitiveLength>0&&this.triangleSubSegments.push({segment:Z,min:F,max:U}),O=D;for(let Y=O;Y<v&&n[Y].subtile===n[O].subtile;Y++)D++}p=v;for(let B=p;B<x&&n[B].triangleSegmentIdx===n[p].triangleSegmentIdx;B++)v++}a._trim(),this.indexArray=a}getVisibleSegments(n,a,h){const p=new wo;if(this.wallMode){for(const re of this.triangleSubSegments)p.segments.push(re.segment);return p}let v=0,x=0;const E=1<<n.canonical.z;if(a){const re=a.getMinMaxForTile(n);re&&(v=re.min,x=re.max)}x+=this.maxHeight;const O=n.toUnwrapped();let D;const B=[O.canonical.x/E+O.wrap,O.canonical.y/E],F=[(O.canonical.x+1)/E+O.wrap,(O.canonical.y+1)/E],U=(re,he,_e)=>[re[0]*(1-_e[0])+he[0]*_e[0],re[1]*(1-_e[1])+he[1]*_e[1]],Z=[],Y=[];for(const re of this.triangleSubSegments){Z[0]=re.min.x/fn,Z[1]=re.min.y/fn,Y[0]=re.max.x/fn,Y[1]=re.max.y/fn;const he=U(B,F,Z),_e=U(B,F,Y);if(new sr([he[0],he[1],v],[_e[0],_e[1],x]).intersectsPrecise(h)===0){D&&(p.segments.push(D),D=void 0);continue}const Se=re.segment;D&&D.vertexOffset!==Se.vertexOffset&&(p.segments.push(D),D=void 0),D?(D.vertexLength+=Se.vertexLength,D.primitiveLength+=Se.primitiveLength):D={vertexOffset:Se.vertexOffset,primitiveLength:Se.primitiveLength,vertexLength:Se.vertexLength,primitiveOffset:Se.primitiveOffset,sortKey:void 0,vaos:{}}}return D&&p.segments.push(D),p}encodeCentroid(n,a){const h=n.centroid(),p=a.span(),v=Math.min(7,Math.round(p.x*this.tileToMeter/10)),x=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new hn(be(h.x,1,fn-1)<<3|v,be(h.y,1,fn-1)<<3|x)}encodeBorderCentroid(n){if(!n.borders)return new hn(0,0);const a=n.borders,h=Number.MAX_VALUE;if(a[0][0]!==h||a[1][0]!==h){const p=a[0][0]!==h?0:1;return new hn(6|(a[0][0]!==h?0:65528),(a[p][0]+a[p][1])/2<<3|6)}{const p=a[2][0]!==h?2:3;return new hn((a[p][0]+a[p][1])/2<<3|6,6|(a[2][0]!==h?0:65528))}}showCentroid(n){const a=this.centroidData[n.centroidDataIndex];a.flags&=od,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const a=n.vertexArrayOffset,h=n.vertexCount+n.vertexArrayOffset,p=n.flags&od?Ky:n.centroidXY,v=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==p.y||v!==p.x){for(let x=a;x<h;++x)this.centroidVertexArray.emplace(x,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,a,h){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const p=a.getReplacementRegionsForTile(n.toUnwrapped());if(ng(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const x of this.centroidData)x.flags&=2147483647;const v=[];for(const x of this.activeReplacements){if(x.order<h)continue;const E=Math.max(1,Math.pow(2,x.footprintTileId.canonical.z-n.canonical.z));for(const O of this.centroidData)if(!(O.flags&od||x.min.x>O.max.x||O.min.x>x.max.x||x.min.y>O.max.y||O.min.y>x.max.y))for(let D=0;D<O.footprintSegLen;D++){const B=this.footprintSegments[O.footprintSegIdx+D];if(v.length=0,S_(this.footprintVertices,B.vertexOffset,B.vertexCount,x.footprintTileId.canonical,n.canonical,v),ig(x.footprint,v,this.footprintIndices.uint16,B.indexOffset,B.indexCount,-B.vertexOffset,-E)){O.flags|=od;break}}}for(const x of this.centroidData)this.writeCentroidToBuffer(x);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,a,h){let p=!1;for(let v=0;v<h.footprintSegLen;v++){const x=this.footprintSegments[h.footprintSegIdx+v];let E=0;for(const O of x.ringIndices){for(let D=E,B=O+E-1;D<O+E;B=D++){const F=this.footprintVertices.int16[2*(D+x.vertexOffset)+0],U=this.footprintVertices.int16[2*(D+x.vertexOffset)+1],Z=this.footprintVertices.int16[2*(B+x.vertexOffset)+1];U>a!=Z>a&&n<(this.footprintVertices.int16[2*(B+x.vertexOffset)+0]-F)*(a-U)/(Z-U)+F&&(p=!p)}E=O}}return p}getHeightAtTileCoord(n,a){let h=Number.NEGATIVE_INFINITY,p=!0;const v=4*(n+fn)*fn+(a+fn);if(this.partLookup.hasOwnProperty(v)){const x=this.partLookup[v];return x?{height:x.height,hidden:!!(x.flags&od)}:void 0}for(const x of this.centroidData)n>x.max.x||x.min.x>n||a>x.max.y||x.min.y>a||this.footprintContainsPoint(n,a,x)&&x&&x.height>h&&(h=x.height,this.partLookup[v]=x,p=!!(x.flags&od));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:p};this.partLookup[v]=void 0}}function og(c,n){const a=c.add(n)._unit();return c.x*a.x+c.y*a.y}function L2(c,n,a,h){const p=n.sub(c)._perp()._unit(),v=a.sub(n)._perp()._unit();return C0(c,n,a,og(p,v),h)}function C0(c,n,a,h,p){const v=Math.sqrt(1-h*h);return Math.min(c.dist(n)/3,n.dist(a)/3,p*v/h)}function ag(c,n,a){return c.x<a[0].x&&n.x<a[0].x||c.x>a[1].x&&n.x>a[1].x||c.y<a[0].y&&n.y<a[0].y||c.y>a[1].y&&n.y>a[1].y}function M0(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function Qb(c,n,a){if(c.x<0||c.x>=fn||n.x<0||n.x>=fn||a.x<0||a.x>=fn)return!1;const h=a.sub(n),p=h.perp(),v=c.sub(n);return(h.x*v.x+h.y*v.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(v.x*v.x+v.y*v.y))>-.866&&p.x*v.x+p.y*v.y<0}function w_(c,n,a){const h=n?2|c:-3&c;return a?1|h:-2&h}function T_(){const c=Math.PI/32,n=Math.tan(c),a=pe;return a*Math.sqrt(1+2*n*n)-a}function O0(c,n,a){const h=1<<a.z,p=Ke(a.x/h),v=Ke((a.x+1)/h),x=pt(a.y/h),E=pt((a.y+1)/h);return function(O,D,B,F,U=0,Z){const Y=[];if(!O.length||!B||!F)return Y;const re=(Me,Re)=>{for(const et of Me)Y.push({polygon:et,bounds:Re})},he=Math.ceil(Math.log2(B)),_e=Math.ceil(Math.log2(F)),Se=he-_e,Ce=[];for(let Me=0;Me<Math.abs(Se);Me++)Ce.push(Se>0?0:1);for(let Me=0;Me<Math.min(he,_e);Me++)Ce.push(0),Ce.push(1);let le=O;if(le=qy(le,D[0].y-U,D[1].y+U,1),le=qy(le,D[0].x-U,D[1].x+U,0),!le.length)return Y;const Te=[];for(Ce.length?Te.push({polygons:le,bounds:D,depth:0}):re(le,D);Te.length;){const Me=Te.pop(),Re=Me.depth,et=Ce[Re],Ye=Me.bounds[0],it=Me.bounds[1],dt=et===0?Ye.x:Ye.y,Ct=et===0?it.x:it.y,tn=Z?Z(et,dt,Ct):.5*(dt+Ct),qt=qy(Me.polygons,dt-U,tn+U,et),Jt=qy(Me.polygons,tn-U,Ct+U,et);if(qt.length){const sn=[Ye,new hn(et===0?tn:it.x,et===1?tn:it.y)];Ce.length>Re+1?Te.push({polygons:qt,bounds:sn,depth:Re+1}):re(qt,sn)}if(Jt.length){const sn=[new hn(et===0?tn:Ye.x,et===1?tn:Ye.y),it];Ce.length>Re+1?Te.push({polygons:Jt,bounds:sn,depth:Re+1}):re(Jt,sn)}}return Y}(c,n,Math.ceil((v-p)/11.25),Math.ceil((x-E)/11.25),1,(O,D,B)=>{if(O===0)return .5*(D+B);{const F=pt((a.y+D/fn)/h);return(ke(.5*(pt((a.y+B/fn)/h)+F))*h-a.y)*fn}})}function S_(c,n,a,h,p,v){const x=Math.pow(2,h.z-p.z);for(let E=0;E<a;E++){let O=c.int16[2*(E+n)+0],D=c.int16[2*(E+n)+1];O=(O+p.x*fn)*x-h.x*fn,D=(D+p.y*fn)*x-h.y*fn,v.push(new hn(O,D))}}let Jy,E_;Nn(b_,"FillExtrusionBucket",{omit:["layers","features"]}),Nn(rf,"PartData"),Nn(nf,"FootprintSegment"),Nn(of,"BorderCentroidData"),Nn(Jb,"GroundEffect");class Qf extends hn{constructor(n,a,h){super(n,a),this.z=h}}class ew extends Qf{constructor(n,a,h,p){super(n,a,h),this.w=p}}function A_(c,n,a,h){const p=a==="x"?"y":"x",v=(h-c[a])/(n[a]-c[a]);c[p]=Math.round(c[p]+(n[p]-c[p])*v),c[a]=h,c.hasOwnProperty("z")&&(c.z=Xn(c.z,n.z,v)),c.hasOwnProperty("w")&&(c.w=Xn(c.w,n.w,v))}function d(c,n,a,h){const p=a,v=h;for(const x of["x","y"]){let E=c,O=n;E[x]>=O[x]&&(E=n,O=c),E[x]<p&&O[x]>p&&A_(E,O,x,p),E[x]<v&&O[x]>v&&A_(O,E,x,v)}}function _(c,n,a,h,p,v){const x=[];for(let E=0;E<c.length;E++){const O=c[E];let D;const B=x.length;let F=0;for(let U=0;U<O.length-1;U++){let Z=O[U],Y=O[U+1],re=0;const he=F;let _e,Se;v&&(re=Math.hypot(Y.x-Z.x,Y.y-Z.y),F+=re,_e=Z,Se=Y),Z.x<n&&Y.x<n||(Z.x<n?Z=new hn(n,Z.y+(n-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round():Y.x<n&&(Y=new hn(n,Z.y+(n-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round()),Z.y<a&&Y.y<a||(Z.y<a?Z=new hn(Z.x+(a-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),a)._round():Y.y<a&&(Y=new hn(Z.x+(a-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),a)._round()),Z.x>=h&&Y.x>=h||(Z.x>=h?Z=new hn(h,Z.y+(h-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round():Y.x>=h&&(Y=new hn(h,Z.y+(h-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round()),Z.y>=p&&Y.y>=p||(Z.y>=p?Z=new hn(Z.x+(p-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),p)._round():Y.y>=p&&(Y=new hn(Z.x+(p-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),p)._round()),D&&Z.equals(D[D.length-1])||(D=[Z],x.push(D),v&&v.push({progress:{min:he+k(_e,Se,Z)*re,max:1},parentIndex:E,prevPoint:_e,nextPoint:Se})),D.push(Y),v&&(v[v.length-1].progress.max=he+k(_e,Se,Y)*re,v[v.length-1].nextPoint=Se)))))}if(v&&F>0)for(let U=B;U<x.length;U++)v[U].progress.min/=F,v[U].progress.max/=F}return x}function A(c,n,a,h,p){if(c.length<2)return void h.push(c);const v=[];for(;n.valid();){const[D,B]=n.get();for(let F=0;F<c.length-1;F++){const U=c[F],Z=c[F+1],Y=Nu(U,Z,D,B);if(Y){const[re]=Y,he=new hn(Xn(U.x,Z.x,re),Xn(U.y,Z.y,re));v.push({t:F+re,distance:0,point:he})}}n.next()}if(v.length===0)return void h.push(c);v.sort((D,B)=>D.t-B.t);let x=0,E=0,O=[];for(h.push(O);x!==c.length;){if(E===v.length){for(;x!==c.length;)O.length!==0&&O[O.length-1].equals(c[x])||O.push(c[x]),x++;break}v[E].t<=x?(O.length!==0&&O[O.length-1].equals(v[E].point)||O.push(v[E].point),Math.trunc(v[E].t),E++):(O.length!==0&&O[O.length-1].equals(c[x])||O.push(c[x]),x++)}}function k(c,n,a){return c.x!==n.x?(a.x-c.x)/(n.x-c.x):c.y!==n.y?(a.y-c.y)/(n.y-c.y):0}function H(c,n){return c.x*n.x+c.y*n.y}function ee(c,n){if(c.length===1){let a=0;const h=n[a++];let p;for(;!p||h.equals(p);)if(p=n[a++],!p)return 1/0;for(;a<n.length;a++){const v=n[a],x=c[0],E=p.sub(h),O=v.sub(h),D=x.sub(h),B=H(E,E),F=H(E,O),U=H(O,O),Z=H(D,E),Y=H(D,O),re=B*U-F*F,he=(U*Z-F*Y)/re,_e=(B*Y-F*Z)/re,Se=h.z*(1-he-_e)+p.z*he+v.z*_e;if(isFinite(Se))return Se}return 1/0}{let a=1/0;for(const h of n)a=Math.min(a,h.z);return a}}function Ae(c,n,a,h,p,v,x,E){const O=x*p.getElevationAt(c,n,!0,!0),D=v[0]!==0,B=D?v[1]===0?x*(v[0]/7-450):x*function(F,U,Z){const Y=Math.floor(U[0]/8),re=Math.floor(U[1]/8),he=10*(U[0]-8*Y),_e=10*(U[1]-8*re),Se=F.getElevationAt(Y,re,!0,!0),Ce=F.getMeterToDEM(Z),le=Math.floor(.5*(he*Ce-1)),Te=Math.floor(.5*(_e*Ce-1)),Me=F.tileCoordToPixel(Y,re),Re=2*le+1,et=2*Te+1,Ye=function(Jt,sn,Ot,Yt,At){return[Jt.getElevationAtPixel(sn,Ot,!0),Jt.getElevationAtPixel(sn+At,Ot,!0),Jt.getElevationAtPixel(sn,Ot+At,!0),Jt.getElevationAtPixel(sn+Yt,Ot+At,!0)]}(F,Me.x-le,Me.y-Te,Re,et),it=Math.abs(Ye[0]-Ye[1]),dt=Math.abs(Ye[2]-Ye[3]),Ct=Math.abs(Ye[0]-Ye[2])+Math.abs(Ye[1]-Ye[3]),tn=Math.min(.25,.5*Ce*(it+dt)/Re),qt=Math.min(.25,.5*Ce*Ct/et);return Se+Math.max(tn*he,qt*_e)}(p,v,E):O;return{base:O+(a===0?-1:a),top:D?Math.max(B+h,O+a+2):O+h}}class He{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class vt{constructor(){this.tasks={},this.taskQueue=[],vn(["process"],this),this.invoker=new He(this.process),this.nextId=0}add(n,a){const h=this.nextId++,p=function({type:v,isSymbolTile:x,zoom:E}){return E=E||0,v==="message"?0:v!=="maybePrepare"||x?v!=="parseTile"||x?v==="parseTile"&&x?300-E:v==="maybePrepare"&&x?400-E:500:200-E:100-E}(a);if(p===0){try{n()}finally{}return null}return this.tasks[h]={fn:n,metadata:a,priority:p,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const a=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let n=null,a=1/0;for(let p=0;p<this.taskQueue.length;p++){const v=this.tasks[this.taskQueue[p]];v.priority<a&&(a=v.priority,n=p)}if(n===null)return null;const h=this.taskQueue[n];return this.taskQueue.splice(n,1),h}remove(){this.invoker.remove()}}class Qt{constructor(n,a,h){this.target=n,this.parent=a,this.mapId=h,this.callbacks={},this.cancelCallbacks={},vn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new vt}send(n,a,h,p,v=!1,x){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=x,this.callbacks[E]=h);const O=new Set;return this.target.postMessage({id:E,type:n,hasCallback:!!h,targetMapId:p,mustQueue:v,sourceMapId:this.mapId,data:Tu(a,O)},O),{cancel:()=>{h&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(n){const a=n.data;if(!a)return;const h=a.id;if(h&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const p=this.cancelCallbacks[h];delete this.cancelCallbacks[h],p&&p.cancel()}else if(a.mustQueue||ki(self)){const p=this.callbacks[h],v=this.scheduler.add(()=>this.processTask(h,a),p&&p.metadata||{type:"message"});v&&(this.cancelCallbacks[h]=v)}else this.processTask(h,a)}processTask(n,a){if(delete this.cancelCallbacks[n],a.type==="<response>"){const h=this.callbacks[n];delete this.callbacks[n],h&&(a.error?h(Su(a.error)):h(null,Su(a.data)))}else{const h=new Set,p=a.hasCallback?(x,E)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:x?Tu(x):null,data:Tu(E,h)},h)}:()=>{},v=Su(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,v,p);else if(this.parent.getWorkerSource){const x=a.type.split("."),{source:E,scope:O}=v;this.parent.getWorkerSource(a.sourceMapId,x[0],E,O)[x[1]](v,p)}else p(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Mn={workerUrl:"",workerClass:null,workerParams:void 0};const $n="mapboxgl_preloaded_worker_pool";class nn{constructor(){this.active={}}acquire(n,a=nn.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<a;)this.workers.push(Mn.workerClass!=null?new Mn.workerClass:new self.Worker(Mn.workerUrl,Mn.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$n]}numActive(){return Object.keys(this.active).length}}nn.workerCount=2;class cn{constructor(n,a,h="Worker",p=nn.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=ht();const v=this.workerPool.acquire(this.id,p);for(let x=0;x<v.length;x++){const E=new cn.Actor(v[x],a,this.id);E.name=`${h} ${x}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,a,h){Xe(this.actors,(p,v)=>{p.send(n,a,v)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let pr,ur;function $o(){return pr||(pr=new nn),pr}cn.Actor=Qt;class Gt{constructor(n){this.module=n}createIntArray(n){const a=new Int32Array(n),h=this.module.malloc(a.length*a.BYTES_PER_ELEMENT);return this.module.heap32.set(a,h/a.BYTES_PER_ELEMENT),h}createFloatArray(n){const a=new Float32Array(n),h=this.module.malloc(a.length*a.BYTES_PER_ELEMENT);return this.module.heapF32.set(a,h/a.BYTES_PER_ELEMENT),h}createStringBuffer(n){const a=this.module.malloc(n.length+1);for(let h=0;h<n.length;++h)this.module.heapU8[a+h]=n.charCodeAt(h);return this.module.heapU8[a+n.length]=0,a}readStringBuffer(n){let a="";for(;this.module.heapU8[n]!==0;)a+=String.fromCharCode(this.module.heapU8[n]),++n;return a}setStyle(n){const a=n.entranceColorRgb,h=n.facadeGlazingColorRgb,p=n.roofColorRgb,v=n.wallColorRgb,x=n.normalScale;this.module.setStyle(a[0],a[1],a[2],h[0],h[1],h[2],p[0],p[1],p[2],v[0],v[1],v[2],x[0],x[1],x[2],n.tileToMeters)}setAOOptions(n,a){this.module.setAOOptions(n?1:0,a)}setMetricOptions(n,a){this.module.setMetricOptions(n?1:0,a)}setFacadeOptions(n,a,h){this.module.setFacadeOptions(n,a,h)}generateMesh(n,a){for(const E of n){const O=this.createStringBuffer(E.roofType),D=[0],B=[];for(const Z of E.coordinates)if(Array.isArray(Z)){for(const Y of Z)B.push(Y.x),B.push(Y.y);D.push(B.length)}const F=this.createIntArray(D),U=this.createFloatArray(B);this.module.addFeature(E.id,E.sourceId,E.minHeight,E.height,O,E.roofType.length,U,F,D.length-1),this.module.free(O),this.module.free(F),this.module.free(U)}for(const E of a){let O;O=E.entrances?JSON.parse(E.entrances):[];const D=this.createFloatArray(O),B=[];for(const U of E.coordinates)B.push(U.x),B.push(U.y);const F=this.createFloatArray(B);this.module.addFacade(E.sourceId,E.crossPerc,E.distanceToRoad,D,O.length,F,B.length),this.module.free(D),this.module.free(F)}if(!this.module.generateMesh()){const E=this.module.getLastError();return this.readStringBuffer(E)}const h=this.module.getMeshCount(),p=new Array(h);for(let E=0;E<h;E++){const O=this.module.getPositionsPtr(E),D=this.module.getPositionsLength(E),B=new Float32Array(this.module.heapF32.buffer,O,D),F=this.module.getNormalsPtr(E),U=this.module.getNormalsLength(E),Z=new Float32Array(this.module.heapF32.buffer,F,U),Y=this.module.getColorsPtr(E),re=this.module.getColorsLength(E),he=new Uint8Array(this.module.heapU8.buffer,Y,re),_e=this.module.getAOPtr(E),Se=this.module.getAOLength(E),Ce=new Float32Array(this.module.heapF32.buffer,_e,Se),le=this.module.getIndicesPtr(E),Te=this.module.getIndicesLength(E),Me=new Int32Array(this.module.heap32.buffer,le,Te),Re=this.module.getBuildingPart(E),et=this.readStringBuffer(Re);p[E]={positions:B,normals:Z,colors:he,ao:Ce,indices:Me,buildingPart:et}}const v=this.module.getRingCount(),x=[];for(let E=0;E<v;E++){const O=this.module.getRingPtr(E),D=this.module.getRingLength(E),B=new Float32Array(this.module.heapF32.buffer,O,D);x.push(B)}return{meshes:p,modifiedPolygonRings:x}}}let Rt,Kt,Cn,Si,Zr,Vi=null,lr=null,el=null,Ao=null;function af(){return ki(self)&&self.worker.dracoUrl?self.worker.dracoUrl:Kt||or.DRACO_URL}function tw(){if(ki(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Si)return Si;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Si=WebAssembly.validate(c)?or.MESHOPT_SIMD_URL:or.MESHOPT_URL,Si}const nw={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},V8={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},I0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function oI(c,n,a){const h=a.json.bufferViews.length,p=a.buffers.length;n.bufferView=h,a.json.bufferViews[h]={buffer:p,byteLength:c.byteLength},a.buffers[p]=c}const z2="KHR_draco_mesh_compression";function $8(c,n){const a=c.extensions&&c.extensions[z2];if(!a)return;const h=new Cn.Decoder,p=cI(n,a.bufferView),v=new Cn.Mesh;if(!h.DecodeArrayToMesh(p,p.byteLength,v))throw new Error("Failed to decode Draco mesh");const x=n.json.accessors[c.indices],E=nw[x.componentType],O=x.count*E.BYTES_PER_ELEMENT,D=Cn._malloc(O);E===Uint16Array?h.GetTrianglesUInt16Array(v,O,D):h.GetTrianglesUInt32Array(v,O,D),oI(Cn.memory.buffer.slice(D,D+O),x,n),Cn._free(D);for(const B of Object.keys(a.attributes)){const F=h.GetAttributeByUniqueId(v,a.attributes[B]),U=n.json.accessors[c.attributes[B]],Z=V8[U.componentType],Y=U.count*I0[U.type]*nw[U.componentType].BYTES_PER_ELEMENT,re=Cn._malloc(Y);h.GetAttributeDataArrayForAllPoints(v,F,Cn[Z],Y,re),oI(Cn.memory.buffer.slice(re,re+Y),U,n),Cn._free(re)}h.destroy(),v.destroy(),delete c.extensions[z2]}const iw="EXT_meshopt_compression";function q8(c,n){if(!c.extensions||!c.extensions[iw])return;const a=c.extensions[iw],h=new Uint8Array(n.buffers[a.buffer],a.byteOffset||0,a.byteLength||0),p=new Uint8Array(a.count*a.byteStride);Zr.decodeGltfBuffer(p,a.count,a.byteStride,h,a.mode,a.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=p.buffer,delete c.extensions[iw]}const aI=1179937895,sI=new TextDecoder("utf8");function lI(c,n){return new URL(c,n).href}function H8(c,n,a,h){return fetch(lI(c.uri,h)).then(p=>p.arrayBuffer()).then(p=>{n.buffers[a]=p})}function cI(c,n){const a=c.json.bufferViews[n];return new Uint8Array(c.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function G8(c,n,a,h){if(c.uri){const p=lI(c.uri,h);return fetch(p).then(v=>v.blob()).then(v=>createImageBitmap(v)).then(v=>{n.images[a]=v})}if(c.bufferView!==void 0){const p=cI(n,c.bufferView),v=new Blob([p],{type:c.mimeType});return createImageBitmap(v).then(x=>{n.images[a]=x})}}function uI(c,n=0,a){const h={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===aI){const B=new Uint32Array(c,n);let F=2;const U=(B[F++]>>2)-3,Z=B[F++]>>2;if(F++,h.json=JSON.parse(sI.decode(B.subarray(F,F+Z))),F+=Z,F<U){const Y=B[F++];F++;const re=n+(F<<2);h.buffers[0]=c.slice(re,re+Y)}}else h.json=JSON.parse(sI.decode(new Uint8Array(c,n)));const{buffers:p,images:v,meshes:x,extensionsUsed:E,bufferViews:O}=h.json;let D=Promise.resolve();if(p){const B=[];for(let F=0;F<p.length;F++){const U=p[F];U.uri?B.push(H8(U,h,F,a)):h.buffers[F]||(h.buffers[F]=null)}D=Promise.all(B)}return D.then(()=>{const B=[],F=E&&E.includes(z2),U=E&&E.includes(iw);if(F&&B.push(function(){if(!Cn)return Rt??(Rt=function(Z){let Y,re=null;function he(){Y=new Uint8Array(re.buffer)}function _e(){throw new Error("Unexpected Draco error.")}const Se={a:{a:_e,d:function(Ce,le,Te){return Y.copyWithin(Ce,le,le+Te)},c:function(Ce){const le=Y.length,Te=Math.max(Ce>>>0,Math.ceil(1.2*le)),Me=Math.ceil((Te-le)/65536);try{return re.grow(Me),he(),!0}catch{return!1}},b:_e}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(Z,Se):Z.then(Ce=>Ce.arrayBuffer()).then(Ce=>WebAssembly.instantiate(Ce,Se))).then(Ce=>{const{Rb:le,Qb:Te,P:Me,T:Re,X:et,Ja:Ye,La:it,Qa:dt,Va:Ct,Wa:tn,eb:qt,jb:Jt,f:sn,e:Ot,yb:Yt,zb:At,Ab:Mt,Bb:dn,Db:gn,Gb:oi}=Ce.instance.exports;re=Ot;const Zn=(()=>{let Sn=0,un=0,bi=0,Gn=0;return Wn=>{bi&&(le(Gn),le(Sn),un+=bi,bi=Sn=0),Sn||(un+=128,Sn=Te(un));const mi=Wn.length+7&-8;let Ci=Sn;mi>=un&&(bi=mi,Ci=Gn=Te(mi));for(let Ei=0;Ei<Wn.length;Ei++)Y[Ci+Ei]=Wn[Ei];return Ci}})();return he(),sn(),{memory:Ot,_free:le,_malloc:Te,Mesh:class{constructor(){this.ptr=Me()}destroy(){Re(this.ptr)}},Decoder:class{constructor(){this.ptr=Ye()}destroy(){Jt(this.ptr)}DecodeArrayToMesh(Sn,un,bi){const Gn=Zn(Sn),Wn=it(this.ptr,Gn,un,bi.ptr);return!!et(Wn)}GetAttributeByUniqueId(Sn,un){return{ptr:dt(this.ptr,Sn.ptr,un)}}GetTrianglesUInt16Array(Sn,un,bi){Ct(this.ptr,Sn.ptr,un,bi)}GetTrianglesUInt32Array(Sn,un,bi){tn(this.ptr,Sn.ptr,un,bi)}GetAttributeDataArrayForAllPoints(Sn,un,bi,Gn,Wn){qt(this.ptr,Sn.ptr,un.ptr,bi,Gn,Wn)}},DT_INT8:Yt(),DT_UINT8:At(),DT_INT16:Mt(),DT_UINT16:dn(),DT_UINT32:gn(),DT_FLOAT32:oi()}})}(fetch(af())),Rt.then(Z=>{Cn=Z,Rt=void 0}))}()),U&&B.push(function(){if(Zr)return;const Z=function(Y){let re;const he=WebAssembly.instantiateStreaming(Y,{}).then(Ce=>{re=Ce.instance,re.exports.__wasm_call_ctors()}),_e={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Se={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:he,supported:!0,decodeGltfBuffer(Ce,le,Te,Me,Re,et){(function(Ye,it,dt,Ct,tn,qt,Jt){const sn=Ye.exports.sbrk,Ot=Ct+3&-4,Yt=sn(Ot*tn),At=sn(qt.length),Mt=new Uint8Array(Ye.exports.memory.buffer);Mt.set(qt,At);const dn=it(Yt,Ct,tn,At,qt.length);if(dn===0&&Jt&&Jt(Yt,Ot,tn),dt.set(Mt.subarray(Yt,Yt+Ct*tn)),sn(Yt-sn(0)),dn!==0)throw new Error(`Malformed buffer data: ${dn}`)})(re,re.exports[Se[Re]],Ce,le,Te,Me,re.exports[_e[et]])}}}(fetch(tw()));return Z.ready.then(()=>{Zr=Z})}()),v)for(let Z=0;Z<v.length;Z++)B.push(G8(v[Z],h,Z,a));return(B.length?Promise.all(B):Promise.resolve()).then(()=>{if(F&&x)for(const{primitives:Z}of x)for(const Y of Z)$8(Y,h);if(U&&x&&O)for(const Z of O)q8(Z,h);return h})})}class hI{constructor(n){this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.hasPattern=!1,this.worldview=n.worldview}updateFootprints(n,a){}prepare(){return function(){if(Ao!=null||el!=null)return null;if(lr!=null)return lr;const n=fetch(or.BUILDING_GEN_URL);return lr=function(a){let h,p,v,x;function E(){h=new Uint8Array(x.buffer),p=new Int32Array(x.buffer),v=new Float32Array(x.buffer)}function O(){throw new Error("Unexpected BuildingGen error.")}const D=()=>{},B={a:{a:O,f:function(F){const U=h.length,Z=Math.max(F>>>0,Math.ceil(1.2*U)),Y=Math.ceil((Z-U)/65536);try{return x.grow(Y),E(),!0}catch{return!1}},g:O,b:D,c:D,d:D,e:D}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(a,B):a.then(F=>F.arrayBuffer()).then(F=>WebAssembly.instantiate(F,B))).then(F=>{const U=F.instance.exports;return(0,U.g)(),x=U.f,E(),new Gt({setStyle:U.h,setAOOptions:U.i,setMetricOptions:U.j,setFacadeOptions:U.k,addFeature:U.l,addFacade:U.m,generateMesh:U.n,getLastError:U.o,getMeshCount:U.p,getPositionsPtr:U.q,getPositionsLength:U.r,getNormalsPtr:U.s,getNormalsLength:U.t,getColorsPtr:U.u,getColorsLength:U.v,getAOPtr:U.w,getAOLength:U.x,getIndicesPtr:U.y,getIndicesLength:U.z,getBuildingPart:U.A,getRingCount:U.B,getRingPtr:U.C,getRingLength:U.D,free:U.E,malloc:U.F,heapU8:h,heap32:p,heapF32:v})})}(n).then(a=>(lr=null,Ao=a,Ao)).catch(a=>{ui("Could not load building-gen"),lr=null,el=a}),lr}()}populate(n,a,h,p){}update(n,a,h,p,v,x,E){}isEmpty(){return!1}uploadPending(){return!1}upload(n){}destroy(){}getHeightAtTileCoord(n,a){return{height:Number.NEGATIVE_INFINITY,hidden:!0}}}let dI,fI;Nn(hI,"BuildingBucket",{omit:["layers"]});const Z8=ar([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),W8=ar([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:X8}=Z8,Y8=ar([{name:"a_packed",components:3,type:"Float32"}]),{members:K8}=Y8,J8=ar([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Q8}=J8;class pI{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.image=new nu({width:n,height:a}),this.positions={},this.uploaded=!1}getDash(n,a){const h=this.getKey(n,a);return this.positions[h]}trim(){const n=this.width,a=this.height=Zt(this.nextRow);this.image.resize({width:n,height:a})}getKey(n,a){return n.join(",")+a}getDashRanges(n,a,h){const p=[];let v=n.length%2==1?-n[n.length-1]*h:0,x=n[0]*h,E=!0;p.push({left:v,right:x,isDash:E,zeroLength:n[0]===0});let O=n[0];for(let D=1;D<n.length;D++){E=!E;const B=n[D];v=O*h,O+=B,x=O*h,p.push({left:v,right:x,isDash:E,zeroLength:B===0})}return p}addRoundDash(n,a,h){const p=a/2;for(let v=-h;v<=h;v++){const x=this.width*(this.nextRow+h+v);let E=0,O=n[E];for(let D=0;D<this.width;D++){D/O.right>1&&(O=n[++E]);const B=Math.abs(D-O.left),F=Math.abs(D-O.right),U=Math.min(B,F);let Z;const Y=v/h*(p+1);if(O.isDash){const re=p-Math.abs(Y);Z=Math.sqrt(U*U+re*re)}else Z=p-Math.sqrt(U*U+Y*Y);this.image.data[x+D]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(n,a){for(let O=n.length-1;O>=0;--O){const D=n[O],B=n[O+1];D.zeroLength?n.splice(O,1):B&&B.isDash===D.isDash&&(B.left=D.left,n.splice(O,1))}const h=n[0],p=n[n.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const v=this.width*this.nextRow;let x=0,E=n[x];for(let O=0;O<this.width;O++){O/E.right>1&&(E=n[++x]);const D=Math.abs(O-E.left),B=Math.abs(O-E.right),F=Math.min(D,B);this.image.data[v+O]=Math.max(0,Math.min(255,(E.isDash?F:-F)+a+128))}}addDash(n,a){const h=this.getKey(n,a);if(this.positions[h])return this.positions[h];const p=a==="round",v=p?7:0,x=2*v+1;if(this.nextRow+x>this.height)return ui("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let B=0;B<n.length;B++)n[B]<0&&(ui("Negative value is found in line dasharray, replacing values with 0"),n[B]=0),E+=n[B];if(E!==0){const B=this.width/E,F=this.getDashRanges(n,this.width,B);p?this.addRoundDash(F,B,v):this.addRegularDash(F,a==="square"?.5*B:0)}const O=this.nextRow+v;this.nextRow+=x;const D={tl:[O,v],br:[E,0]};return this.positions[h]=D,D}}Nn(pI,"LineAtlas");const e$=xi.VectorTileFeature.types,t$=Math.cos(Math.PI/180*37.5),n$=Math.cos(Math.PI/180*5);class k2{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.pixelRatio=n.pixelRatio,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Kh,this.layoutVertexArray2=new jl,this.patternVertexArray=new jl,this.indexArray=new ra,this.programConfigurations=new m(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new wo,this.maxLineLength=0,this.zOffsetVertexArray=new jl,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:fn/64,this.worldview=n.worldview}updateFootprints(n,a){}populate(n,a,h,p){this.hasPattern=$y("line",this.layers,this.pixelRatio,a);const v=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Et(h);const x=this.layers[0].layout.get("line-elevation-reference");if(x==="hd-road-markup")this.elevationType="road";else{const U=this.layers[0].layout.get("line-z-offset"),Z=U.isConstant()&&!U.constantOr(0);this.elevationType=x!=="sea"&&x!=="ground"&&Z?"none":"offset",this.elevationType==="offset"&&x==="none"&&ui(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const E=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&E!==void 0;const O=[];for(const{feature:U,id:Z,index:Y,sourceLayerIndex:re}of n){const he=this.layers[0]._featureFilter.needGeometry,_e=On(U,he);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom,{worldview:this.worldview}),_e,h))continue;const Se=v?v.evaluate(_e,{},h):void 0,Ce={id:Z,properties:U.properties,type:U.type,sourceLayerIndex:re,index:Y,geometry:he?_e.geometry:Dn(U,h,p),patterns:{},sortKey:Se};O.push(Ce)}v&&O.sort((U,Z)=>U.sortKey-Z.sortKey);const{lineAtlas:D,featureIndex:B}=a,F=this.addConstantDashes(D);for(const U of O){const{geometry:Z,index:Y,sourceLayerIndex:re}=U;if(F&&this.addFeatureDashes(U,D),this.hasPattern){const he=Qm("line",this.layers,U,this.zoom,this.pixelRatio,a);this.patternFeatures.push(he)}else this.addFeature(U,Z,Y,h,D.positions,a.availableImages,a.brightness,a.elevationFeatures);B.insert(n[Y].feature,Z,Y,re,this.index)}}addConstantDashes(n){let a=!1;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(p.kind!=="constant"||v.kind!=="constant")a=!0;else{const x=v.value,E=p.value;if(!E)continue;n.addDash(E,x)}}return a}addFeatureDashes(n,a){const h=this.zoom;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,x=p.layout.get("line-cap").value;if(v.kind==="constant"&&x.kind==="constant")continue;let E,O;if(v.kind==="constant"){if(E=v.value,!E)continue}else E=v.evaluate({zoom:h},n);O=x.kind==="constant"?x.value:x.evaluate({zoom:h},n),a.addDash(E,O),n.patterns[p.id]=[a.getKey(E,O)]}}update(n,a,h,p,v,x,E,O){this.programConfigurations.updatePaintArrays(n,a,v,h,p,x,E,O)}addFeatures(n,a,h,p,v,x){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,a,h,p,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,K8)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,Q8)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,W8.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,X8),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,h,p,v,x,E,O){const D=this.layers[0].layout,B=D.get("line-join").evaluate(n,{}),F=D.get("line-cap").evaluate(n,{}),U=D.get("line-miter-limit"),Z=D.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=D.get("line-z-offset").value;const Y=this.layers[0].paint.get("line-width").value;if(Y.kind!=="constant"&&Y.isLineProgressConstant===!1&&(this.variableWidthValue=Y),this.elevationType==="road"){const re=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(n,a,p,O,B,F,U,Z)){const[he,_e]=this.clipRuntimeLinesToTile(a,1);for(let Se=0;Se<he.length;Se++){const Ce=he[Se],le=_e[Se],Te={progress:{min:le.progress.min,max:le.progress.max},nextDir:this.computeSegNextDir(le,Ce),prevDir:this.computeSegPrevDir(le,Ce)};this.addLine(Ce,n,p,B,F,U,Z,Te)}this.fillNonElevatedRoadSegment(re)}}else for(const re of a)this.addLine(re,n,p,B,F,U,Z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,v,x,p,E,void 0,this.worldview)}computeSegNextDir(n,a){return n.nextPoint.sub(a.at(-2)).unit()}computeSegPrevDir(n,a){return a[1].sub(n.prevPoint).unit()}clipLinesToTile(n,a){return _(n,-a,-a,fn+a,fn+a)}clipRuntimeLinesToTile(n,a){const h=[];return[_(n,-a,-a,fn+a,fn+a,h),h]}addElevatedRoadFeature(n,a,h,p,v,x,E,O){const D=[],B=Ml.getElevationFeature(n,p);if(B){const F=this.clipLinesToTile(a,1),U=this.prepareElevatedLines(F,B,h);for(const Z of U)D.push({geometry:Z,elevation:B,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(D.length===0)return!1;for(const F of D){const U=this.layoutVertexArray.length;this.addLine(F.geometry,n,h,v,x,E,O);const Z=new Tc(h,F.elevationTileID);if(F.elevation)for(let Y=U;Y<this.layoutVertexArray.length;Y++){const re=new hn(this.layoutVertexArray.int16[6*Y]>>1,this.layoutVertexArray.int16[6*Y+1]>>1),he=Z.pointElevation(re,F.elevation,.05);this.updateHeightRange(he),this.zOffsetVertexArray.emplaceBack(he,0,0)}else this.fillNonElevatedRoadSegment(U)}return!0}prepareElevatedLines(n,a,h){if(a.constantHeight!=null)return n;const p=[],v=1/Et(h);for(const x of n)A(x,new Ps(a,v),0,p);return p}fillNonElevatedRoadSegment(n){for(let a=n;a<this.layoutVertexArray.length;a++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(n){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,n),this.heightRange.max=Math.max(this.heightRange.max,n)):this.heightRange={min:n,max:n}}addLine(n,a,h,p,v,x,E,O){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const D=p==="none";this.patternJoinNone=this.hasPattern&&D,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const B=O&&O.progress.min>0,F=O&&O.progress.max<1;if(this.lineClips){let et={min:this.lineClips.start,max:this.lineClips.end},Ye=1;if(O){const Ct=this.lineClips.end-this.lineClips.start;et=function(tn,qt,Jt){return{min:Xi(tn.min,qt,Jt),max:Xi(tn.max,qt,Jt)}}(O.progress,{min:0,max:1},et),Ct>0&&(Ye=(et.max-et.min)/Ct)}const it=+a.properties.mapbox_clip_feature_len,dt=+a.properties.mapbox_clip_seg_len;if(Number.isNaN(it)||Number.isNaN(dt)){for(let tn=0;tn<n.length-1;tn++)this.totalDistance+=n[tn].dist(n[tn+1]);const Ct=this.totalDistance/(et.max-et.min);this.totalFeatureLength=Number.isFinite(Ct)?Ct:0,this.lineClips.start=et.min,this.lineClips.end=et.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=it,this.distance=dt*Ye,this.lineClips.start=et.min,this.lineClips.end=et.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const U=e$[a.type]==="Polygon";let Z=n.length;for(;Z>=2&&n[Z-1].equals(n[Z-2]);)Z--;let Y=0;for(;Y<Z-1&&n[Y].equals(n[Y+1]);)Y++;if(Z<(U?3:2))return;p==="bevel"&&(x=1.05);const re=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let he,_e,Se,Ce,le,Te,Me,Re;O&&O.prevDir&&(Te=O.prevDir.perp()),O&&O.nextDir&&(Me=O.nextDir.perp()),this.e1=this.e2=-1,U&&(he=n[Z-2],le=n[Y].sub(he)._unit()._perp());for(let et=Y;et<Z;et++){if(Se=et===Z-1?U?n[Y+1]:void 0:n[et+1],Se&&n[et].equals(Se))continue;le&&(Ce=le),he&&(_e=he),he=n[et],Re=this.evaluateLineProgressFeatures(_e?_e.dist(he):0),le=Se?Se.sub(he)._unit()._perp():Ce,Ce=Ce||le;const Ye=_e&&Se;let it=Ye?p:U||D?"butt":v;const dt=Ce.x*le.x+Ce.y*le.y;if(D){const At=function(Mt){if(Mt.patternJoinNone){const dn=Mt.segmentPoints.length/2,gn=Mt.lineSoFar-Mt.segmentStart;for(let oi=0;oi<dn;++oi){const Zn=Mt.segmentPoints[2*oi+1],Sn=Math.round(Mt.segmentPoints[2*oi])+.5+.25*Zn;Mt.patternVertexArray.emplaceBack(Sn,gn,Mt.segmentStart),Mt.patternVertexArray.emplaceBack(Sn,gn,Mt.segmentStart)}Mt.segmentPoints.length=0}Mt.e1=Mt.e2=-1};if(Ye&&dt<n$){this.updateDistance(_e,he),this.addCurrentVertex(he,Ce,1,1,re,Re),At(this),this.addCurrentVertex(he,le,-1,-1,re,Re);continue}if(_e){if(!Se){this.updateDistance(_e,he),this.addCurrentVertex(he,Ce,1,1,re,Re),At(this);continue}it="miter"}}let Ct=Ce.add(le);Ct.x===0&&Ct.y===0||Ct._unit();const tn=Ct.x*le.x+Ct.y*le.y,qt=tn!==0?1/tn:1/0,Jt=2*Math.sqrt(2-2*tn),sn=tn<t$&&_e&&Se,Ot=Ce.x*le.y-Ce.y*le.x>0,Yt=this.overscaling<=16?15*fn/(512*this.overscaling):0;if(Ye&&it==="round"){if(qt<E)it="miter";else if(qt<=2){const At=N2(he,-10,fn+10);it=this.elevationType==="offset"&&(At||this.hasCrossSlope)?"miter":"fakeround"}}if(it==="miter"&&qt>x&&(it="bevel"),it==="bevel"&&(qt>2&&(it="flipbevel"),qt<x&&(it="miter")),_e&&!(it==="miter"&&sn)&&this.updateDistance(_e,he),it==="miter")if(sn){const At=he.dist(_e);if(At>2*Yt){const dn=he.sub(he.sub(_e)._mult(Yt/At)._round());this.updateDistance(_e,dn),this.addCurrentVertex(dn,Ce,0,0,re,Re),_e=dn}this.updateDistance(_e,he),Ct._mult(qt),this.addCurrentVertex(he,Ct,0,0,re,Re);const Mt=he.dist(Se);if(Mt>2*Yt){const dn=he.add(Se.sub(he)._mult(Yt/Mt)._round());this.updateDistance(he,dn),this.addCurrentVertex(dn,le,0,0,re,Re),he=dn}}else Ct._mult(qt),this.addCurrentVertex(he,Ct,0,0,re,Re);else if(it==="flipbevel"){if(qt>100)Ct=le.mult(-1);else{const At=qt*Ce.add(le).mag()/Ce.sub(le).mag();Ct._perp()._mult(At*(Ot?-1:1))}this.addCurrentVertex(he,Ct,0,0,re,Re),this.addCurrentVertex(he,Ct.mult(-1),0,0,re,Re)}else if(it==="bevel"||it==="fakeround"){Re!=null&&_e&&this.addCurrentVertex(he,Me||Ce,-1,-1,re,Re);const At=he.dist(_e)<=2*Yt&&it!=="bevel",Mt=Ct.mult(Ot?1:-1);Mt._mult(qt);const dn=le.mult(Ot?-1:1),gn=Ce.mult(Ot?-1:1),oi=this.evaluateLineProgressFeatures(this.distance);if(Re==null&&(this.addHalfVertex(he,Mt.x,Mt.y,!1,!Ot,0,re,oi),At||this.addHalfVertex(he,Mt.x+2*gn.x,Mt.y+2*gn.y,!1,Ot,0,re,oi)),it==="fakeround"){const Zn=Math.round(180*Jt/Math.PI/20);this.addHalfVertex(he,gn.x,gn.y,!1,Ot,0,re,oi);for(let Sn=0;Sn<Zn;Sn++){let un=Sn/Zn;if(un!==.5){const Gn=un-.5;un+=un*Gn*(un-1)*((1.0904+dt*(dt*(3.55645-1.43519*dt)-3.2452))*Gn*Gn+(.848013+dt*(.215638*dt-1.06021)))}const bi=dn.sub(gn)._mult(un)._add(gn)._unit();this.addHalfVertex(he,bi.x,bi.y,!1,Ot,0,re,oi)}this.addHalfVertex(he,dn.x,dn.y,!1,Ot,0,re,oi)}At||Re!=null||this.addHalfVertex(he,Mt.x+2*dn.x,Mt.y+2*dn.y,!1,Ot,0,re,oi),Re!=null&&Se&&this.addCurrentVertex(he,Te||le,1,1,re,Re)}else if(it==="butt")this.addCurrentVertex(he,Ct,0,0,re,Re);else if(it==="square"){if(!_e){const At=B?0:-1;this.addCurrentVertex(he,Ct,At,At,re,Re)}if(this.addCurrentVertex(he,Ct,0,0,re,Re),_e){const At=F?0:1;this.addCurrentVertex(he,Ct,At,At,re,Re)}}else if(it==="round"){if(_e){const At=!Ye&&Me?Me:Ce;this.addCurrentVertex(he,At,0,0,re,Re),!Ye&&F||this.addCurrentVertex(he,At,1,1,re,Re,!0)}if(Se){const At=!Ye&&Te?Te:le;!Ye&&B||this.addCurrentVertex(he,At,-1,-1,re,Re,!0),this.addCurrentVertex(he,At,0,0,re,Re)}}}}addVerticesTo(n,a,h,p,v,x,E,O,D,B){const F=(a.w-n.w)/this.tessellationStep|0;let U=0;const Z=this.scaledDistance;if(F>1){this.lineSoFar=n.w;const re=(a.x-n.x)/F,he=(a.y-n.y)/F,_e=(a.z-n.z)/F,Se=(a.w-n.w)/F;for(let Ce=1;Ce<F;++Ce){n.x+=re,n.y+=he,n.z+=_e,this.lineSoFar+=Se,U+=Se;const le=this.evaluateLineProgressFeatures(this.prevDistance+U);this.scaledDistance=(this.prevDistance+U)/this.totalDistance,this.addHalfVertex(n,h,p,B,!1,E,D,le),this.addHalfVertex(n,v,x,B,!0,-O,D,le)}}this.lineSoFar=a.w,this.scaledDistance=Z;const Y=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(a,h,p,B,!1,E,D,Y),this.addHalfVertex(a,v,x,B,!0,-O,D,Y)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):ui(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let a=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(a=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:a}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:a}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:a}}addCurrentVertex(n,a,h,p,v,x,E=!1){const O=a.x+a.y*h,D=a.y-a.x*h,B=a.y*p-a.x,F=-a.y-a.x*p;if(x!=null){const U=this.elevationType==="offset",Z=-10,Y=fn+10,re=x.zOffset,he=new ew(n.x,n.y,re,this.lineSoFar),_e=!!U&&N2(n,Z,Y),Se=this.lineSoFar,Ce=this.distance;if(this.currentVertex)if(_e){const le=this.currentVertexIsOutside,Te=this.currentVertex,Me=new ew(n.x,n.y,re,this.lineSoFar);if(d(Te,Me,Z,Y),!N2(Me,Z,Y)){if(le){this.e1=this.e2=-1,this.distance-=Te.dist(he),this.lineSoFar=Te.w;const Re=this.evaluateLineProgressFeatures(Te.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Te,O,D,E,!1,h,v,Re),this.addHalfVertex(Te,B,F,E,!0,-p,v,Re),this.prevDistance=this.distance}this.distance=this.prevDistance+Te.dist(Me),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Te,Me,O,D,B,F,h,p,v,E),this.distance=Ce,this.scaledDistance=this.distance/this.totalDistance}}else{const le=this.currentVertex;if(this.currentVertexIsOutside){d(le,he,Z,Y),this.e1=this.e2=-1,this.distance-=le.dist(he),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=le.w;const Te=this.evaluateLineProgressFeatures(le.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(le,O,D,E,!1,h,v,Te),this.addHalfVertex(le,B,F,E,!0,-p,v,Te),this.prevDistance=this.distance,this.distance=Ce,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(le,he,O,D,B,F,h,p,v,E)}else _e||(this.addHalfVertex(n,O,D,E,!1,h,v,x),this.addHalfVertex(n,B,F,E,!0,-p,v,x));this.currentVertex=he,this.currentVertexIsOutside=_e,this.lineSoFar=Se}else this.addHalfVertex(n,O,D,E,!1,h,v,x),this.addHalfVertex(n,B,F,E,!0,-p,v,x)}addHalfVertex({x:n,y:a},h,p,v,x,E,O,D){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),x||this.segmentPoints.push(this.lineSoFar-this.segmentStart,E)),this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(a<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const F=Xn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,F)}const B=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),O.primitiveLength++),x?this.e2=B:this.e1=B,D!=null&&this.zOffsetVertexArray.emplaceBack(D.zOffset,D.variableWidth,D.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,a){this.prevDistance=this.distance,this.distance+=n.dist(a),this.updateScaledDistance()}}function N2(c,n,a){return c.x<n||c.x>a||c.y<n||c.y>a}let mI,gI;function _I(c,n,a){return n*(fn/(c.tileSize*Math.pow(2,a-c.tileID.overscaledZ)))}Nn(k2,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const yI=(c,n,a)=>(1-a)*c+a*n;function vI(c,n){return 1/_I(c,1,n.tileZoom)}function xI(c,n,a,h){return c.translatePosMatrix(h||n.tileID.projMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const bI=c=>{const n=[];wI(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const a=c.paint.get("line-trim-offset");a[0]===0&&a[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const h=c.layout.get("line-join").constantOr("miter")==="none",p=!!c.paint.get("line-pattern").constantOr(1);return h&&p&&n.push("LINE_JOIN_NONE"),n};function wI(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let B2;const TI=()=>B2||(B2={layout:mI||(mI=new bo({"line-cap":new bn(ft.layout_line["line-cap"]),"line-join":new bn(ft.layout_line["line-join"]),"line-miter-limit":new an(ft.layout_line["line-miter-limit"]),"line-round-limit":new an(ft.layout_line["line-round-limit"]),"line-sort-key":new bn(ft.layout_line["line-sort-key"]),"line-z-offset":new bn(ft.layout_line["line-z-offset"]),"line-elevation-reference":new an(ft.layout_line["line-elevation-reference"]),"line-cross-slope":new an(ft.layout_line["line-cross-slope"]),visibility:new an(ft.layout_line.visibility),"line-width-unit":new an(ft.layout_line["line-width-unit"])})),paint:gI||(gI=new bo({"line-opacity":new bn(ft.paint_line["line-opacity"]),"line-color":new bn(ft.paint_line["line-color"]),"line-translate":new an(ft.paint_line["line-translate"]),"line-translate-anchor":new an(ft.paint_line["line-translate-anchor"]),"line-width":new bn(ft.paint_line["line-width"]),"line-gap-width":new bn(ft.paint_line["line-gap-width"]),"line-offset":new bn(ft.paint_line["line-offset"]),"line-blur":new bn(ft.paint_line["line-blur"]),"line-dasharray":new bn(ft.paint_line["line-dasharray"]),"line-pattern":new bn(ft.paint_line["line-pattern"]),"line-pattern-cross-fade":new an(ft.paint_line["line-pattern-cross-fade"]),"line-gradient":new Cu(ft.paint_line["line-gradient"]),"line-trim-offset":new an(ft.paint_line["line-trim-offset"]),"line-trim-fade-range":new an(ft.paint_line["line-trim-fade-range"]),"line-trim-color":new an(ft.paint_line["line-trim-color"]),"line-emissive-strength":new an(ft.paint_line["line-emissive-strength"]),"line-border-width":new bn(ft.paint_line["line-border-width"]),"line-border-color":new bn(ft.paint_line["line-border-color"]),"line-occlusion-opacity":new an(ft.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},B2);class i$ extends bn{possiblyEvaluate(n,a){return a=new Mr(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition,worldview:a.worldview}),super.possiblyEvaluate(n,a)}evaluate(n,a,h,p){return a=lt({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,h,p)}}let D0;function SI(c,n){return n>0?n+2*c:c}const r$=ar([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),o$=ar([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),a$=ar([{name:"a_projected_pos",components:4,type:"Float32"}],4);ar([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const s$=ar([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),l$=ar([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),c$=ar([{name:"a_texb",components:2,type:"Uint16"}]),u$=ar([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),h$=ar([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const EI=ar([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),d$=ar([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ar([{name:"triangle",components:3,type:"Uint16"}]),ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ar([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),ar([{type:"Float32",name:"offsetX"}]),ar([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Vs=24;function f$(c,n,a){return c.sections.forEach(h=>{h.text=function(p,v,x){const E=v.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),Au.applyArabicShaping&&(p=Au.applyArabicShaping(p)),p}(h.text,n,a)}),c}const R0={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function p$(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function m$(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var AI,j2,PI,F2={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function g$(){return AI||(AI=1,F2.read=function(c,n,a,h,p){var v,x,E=8*p-h-1,O=(1<<E)-1,D=O>>1,B=-7,F=a?p-1:0,U=a?-1:1,Z=c[n+F];for(F+=U,v=Z&(1<<-B)-1,Z>>=-B,B+=E;B>0;v=256*v+c[n+F],F+=U,B-=8);for(x=v&(1<<-B)-1,v>>=-B,B+=h;B>0;x=256*x+c[n+F],F+=U,B-=8);if(v===0)v=1-D;else{if(v===O)return x?NaN:1/0*(Z?-1:1);x+=Math.pow(2,h),v-=D}return(Z?-1:1)*x*Math.pow(2,v-h)},F2.write=function(c,n,a,h,p,v){var x,E,O,D=8*v-p-1,B=(1<<D)-1,F=B>>1,U=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=h?0:v-1,Y=h?1:-1,re=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,x=B):(x=Math.floor(Math.log(n)/Math.LN2),n*(O=Math.pow(2,-x))<1&&(x--,O*=2),(n+=x+F>=1?U/O:U*Math.pow(2,1-F))*O>=2&&(x++,O/=2),x+F>=B?(E=0,x=B):x+F>=1?(E=(n*O-1)*Math.pow(2,p),x+=F):(E=n*Math.pow(2,F-1)*Math.pow(2,p),x=0));p>=8;c[a+Z]=255&E,Z+=Y,E/=256,p-=8);for(x=x<<p|E,D+=p;D>0;c[a+Z]=255&x,Z+=Y,x/=256,D-=8);c[a+Z-Y]|=128*re}),F2}function CI(){if(PI)return j2;PI=1,j2=n;var c=g$();function n(le){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(le)?le:new Uint8Array(le||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var a=4294967296,h=1/a,p=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function v(le){return le.type===n.Bytes?le.readVarint()+le.pos:le.pos+1}function x(le,Te,Me){return Me?4294967296*Te+(le>>>0):4294967296*(Te>>>0)+(le>>>0)}function E(le,Te,Me){var Re=Te<=16383?1:Te<=2097151?2:Te<=268435455?3:Math.floor(Math.log(Te)/(7*Math.LN2));Me.realloc(Re);for(var et=Me.pos-1;et>=le;et--)Me.buf[et+Re]=Me.buf[et]}function O(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeVarint(le[Me])}function D(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeSVarint(le[Me])}function B(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeFloat(le[Me])}function F(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeDouble(le[Me])}function U(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeBoolean(le[Me])}function Z(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeFixed32(le[Me])}function Y(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeSFixed32(le[Me])}function re(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeFixed64(le[Me])}function he(le,Te){for(var Me=0;Me<le.length;Me++)Te.writeSFixed64(le[Me])}function _e(le,Te){return(le[Te]|le[Te+1]<<8|le[Te+2]<<16)+16777216*le[Te+3]}function Se(le,Te,Me){le[Me]=Te,le[Me+1]=Te>>>8,le[Me+2]=Te>>>16,le[Me+3]=Te>>>24}function Ce(le,Te){return(le[Te]|le[Te+1]<<8|le[Te+2]<<16)+(le[Te+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(le,Te,Me){for(Me=Me||this.length;this.pos<Me;){var Re=this.readVarint(),et=Re>>3,Ye=this.pos;this.type=7&Re,le(et,Te,this),this.pos===Ye&&this.skip(Re)}return Te},readMessage:function(le,Te){return this.readFields(le,Te,this.readVarint()+this.pos)},readFixed32:function(){var le=_e(this.buf,this.pos);return this.pos+=4,le},readSFixed32:function(){var le=Ce(this.buf,this.pos);return this.pos+=4,le},readFixed64:function(){var le=_e(this.buf,this.pos)+_e(this.buf,this.pos+4)*a;return this.pos+=8,le},readSFixed64:function(){var le=_e(this.buf,this.pos)+Ce(this.buf,this.pos+4)*a;return this.pos+=8,le},readFloat:function(){var le=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,le},readDouble:function(){var le=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,le},readVarint:function(le){var Te,Me,Re=this.buf;return Te=127&(Me=Re[this.pos++]),Me<128?Te:(Te|=(127&(Me=Re[this.pos++]))<<7,Me<128?Te:(Te|=(127&(Me=Re[this.pos++]))<<14,Me<128?Te:(Te|=(127&(Me=Re[this.pos++]))<<21,Me<128?Te:function(et,Ye,it){var dt,Ct,tn=it.buf;if(dt=(112&(Ct=tn[it.pos++]))>>4,Ct<128||(dt|=(127&(Ct=tn[it.pos++]))<<3,Ct<128)||(dt|=(127&(Ct=tn[it.pos++]))<<10,Ct<128)||(dt|=(127&(Ct=tn[it.pos++]))<<17,Ct<128)||(dt|=(127&(Ct=tn[it.pos++]))<<24,Ct<128)||(dt|=(1&(Ct=tn[it.pos++]))<<31,Ct<128))return x(et,dt,Ye);throw new Error("Expected varint not more than 10 bytes")}(Te|=(15&(Me=Re[this.pos]))<<28,le,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var le=this.readVarint();return le%2==1?(le+1)/-2:le/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var le=this.readVarint()+this.pos,Te=this.pos;return this.pos=le,le-Te>=12&&p?function(Me,Re,et){return p.decode(Me.subarray(Re,et))}(this.buf,Te,le):function(Me,Re,et){for(var Ye="",it=Re;it<et;){var dt,Ct,tn,qt=Me[it],Jt=null,sn=qt>239?4:qt>223?3:qt>191?2:1;if(it+sn>et)break;sn===1?qt<128&&(Jt=qt):sn===2?(192&(dt=Me[it+1]))==128&&(Jt=(31&qt)<<6|63&dt)<=127&&(Jt=null):sn===3?(Ct=Me[it+2],(192&(dt=Me[it+1]))==128&&(192&Ct)==128&&((Jt=(15&qt)<<12|(63&dt)<<6|63&Ct)<=2047||Jt>=55296&&Jt<=57343)&&(Jt=null)):sn===4&&(Ct=Me[it+2],tn=Me[it+3],(192&(dt=Me[it+1]))==128&&(192&Ct)==128&&(192&tn)==128&&((Jt=(15&qt)<<18|(63&dt)<<12|(63&Ct)<<6|63&tn)<=65535||Jt>=1114112)&&(Jt=null)),Jt===null?(Jt=65533,sn=1):Jt>65535&&(Jt-=65536,Ye+=String.fromCharCode(Jt>>>10&1023|55296),Jt=56320|1023&Jt),Ye+=String.fromCharCode(Jt),it+=sn}return Ye}(this.buf,Te,le)},readBytes:function(){var le=this.readVarint()+this.pos,Te=this.buf.subarray(this.pos,le);return this.pos=le,Te},readPackedVarint:function(le,Te){if(this.type!==n.Bytes)return le.push(this.readVarint(Te));var Me=v(this);for(le=le||[];this.pos<Me;)le.push(this.readVarint(Te));return le},readPackedSVarint:function(le){if(this.type!==n.Bytes)return le.push(this.readSVarint());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readSVarint());return le},readPackedBoolean:function(le){if(this.type!==n.Bytes)return le.push(this.readBoolean());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readBoolean());return le},readPackedFloat:function(le){if(this.type!==n.Bytes)return le.push(this.readFloat());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readFloat());return le},readPackedDouble:function(le){if(this.type!==n.Bytes)return le.push(this.readDouble());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readDouble());return le},readPackedFixed32:function(le){if(this.type!==n.Bytes)return le.push(this.readFixed32());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readFixed32());return le},readPackedSFixed32:function(le){if(this.type!==n.Bytes)return le.push(this.readSFixed32());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readSFixed32());return le},readPackedFixed64:function(le){if(this.type!==n.Bytes)return le.push(this.readFixed64());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readFixed64());return le},readPackedSFixed64:function(le){if(this.type!==n.Bytes)return le.push(this.readSFixed64());var Te=v(this);for(le=le||[];this.pos<Te;)le.push(this.readSFixed64());return le},skip:function(le){var Te=7&le;if(Te===n.Varint)for(;this.buf[this.pos++]>127;);else if(Te===n.Bytes)this.pos=this.readVarint()+this.pos;else if(Te===n.Fixed32)this.pos+=4;else{if(Te!==n.Fixed64)throw new Error("Unimplemented type: "+Te);this.pos+=8}},writeTag:function(le,Te){this.writeVarint(le<<3|Te)},realloc:function(le){for(var Te=this.length||16;Te<this.pos+le;)Te*=2;if(Te!==this.length){var Me=new Uint8Array(Te);Me.set(this.buf),this.buf=Me,this.length=Te}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(le){this.realloc(4),Se(this.buf,le,this.pos),this.pos+=4},writeSFixed32:function(le){this.realloc(4),Se(this.buf,le,this.pos),this.pos+=4},writeFixed64:function(le){this.realloc(8),Se(this.buf,-1&le,this.pos),Se(this.buf,Math.floor(le*h),this.pos+4),this.pos+=8},writeSFixed64:function(le){this.realloc(8),Se(this.buf,-1&le,this.pos),Se(this.buf,Math.floor(le*h),this.pos+4),this.pos+=8},writeVarint:function(le){(le=+le||0)>268435455||le<0?function(Te,Me){var Re,et;if(Te>=0?(Re=Te%4294967296|0,et=Te/4294967296|0):(et=~(-Te/4294967296),4294967295^(Re=~(-Te%4294967296))?Re=Re+1|0:(Re=0,et=et+1|0)),Te>=18446744073709552e3||Te<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Me.realloc(10),function(Ye,it,dt){dt.buf[dt.pos++]=127&Ye|128,Ye>>>=7,dt.buf[dt.pos++]=127&Ye|128,Ye>>>=7,dt.buf[dt.pos++]=127&Ye|128,Ye>>>=7,dt.buf[dt.pos++]=127&Ye|128,dt.buf[dt.pos]=127&(Ye>>>=7)}(Re,0,Me),function(Ye,it){var dt=(7&Ye)<<4;it.buf[it.pos++]|=dt|((Ye>>>=3)?128:0),Ye&&(it.buf[it.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(it.buf[it.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(it.buf[it.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(it.buf[it.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(it.buf[it.pos++]=127&Ye)))))}(et,Me)}(le,this):(this.realloc(4),this.buf[this.pos++]=127&le|(le>127?128:0),le<=127||(this.buf[this.pos++]=127&(le>>>=7)|(le>127?128:0),le<=127||(this.buf[this.pos++]=127&(le>>>=7)|(le>127?128:0),le<=127||(this.buf[this.pos++]=le>>>7&127))))},writeSVarint:function(le){this.writeVarint(le<0?2*-le-1:2*le)},writeBoolean:function(le){this.writeVarint(!!le)},writeString:function(le){le=String(le),this.realloc(4*le.length),this.pos++;var Te=this.pos;this.pos=function(Re,et,Ye){for(var it,dt,Ct=0;Ct<et.length;Ct++){if((it=et.charCodeAt(Ct))>55295&&it<57344){if(!dt){it>56319||Ct+1===et.length?(Re[Ye++]=239,Re[Ye++]=191,Re[Ye++]=189):dt=it;continue}if(it<56320){Re[Ye++]=239,Re[Ye++]=191,Re[Ye++]=189,dt=it;continue}it=dt-55296<<10|it-56320|65536,dt=null}else dt&&(Re[Ye++]=239,Re[Ye++]=191,Re[Ye++]=189,dt=null);it<128?Re[Ye++]=it:(it<2048?Re[Ye++]=it>>6|192:(it<65536?Re[Ye++]=it>>12|224:(Re[Ye++]=it>>18|240,Re[Ye++]=it>>12&63|128),Re[Ye++]=it>>6&63|128),Re[Ye++]=63&it|128)}return Ye}(this.buf,le,this.pos);var Me=this.pos-Te;Me>=128&&E(Te,Me,this),this.pos=Te-1,this.writeVarint(Me),this.pos+=Me},writeFloat:function(le){this.realloc(4),c.write(this.buf,le,this.pos,!0,23,4),this.pos+=4},writeDouble:function(le){this.realloc(8),c.write(this.buf,le,this.pos,!0,52,8),this.pos+=8},writeBytes:function(le){var Te=le.length;this.writeVarint(Te),this.realloc(Te);for(var Me=0;Me<Te;Me++)this.buf[this.pos++]=le[Me]},writeRawMessage:function(le,Te){this.pos++;var Me=this.pos;le(Te,this);var Re=this.pos-Me;Re>=128&&E(Me,Re,this),this.pos=Me-1,this.writeVarint(Re),this.pos+=Re},writeMessage:function(le,Te,Me){this.writeTag(le,n.Bytes),this.writeRawMessage(Te,Me)},writePackedVarint:function(le,Te){Te.length&&this.writeMessage(le,O,Te)},writePackedSVarint:function(le,Te){Te.length&&this.writeMessage(le,D,Te)},writePackedBoolean:function(le,Te){Te.length&&this.writeMessage(le,U,Te)},writePackedFloat:function(le,Te){Te.length&&this.writeMessage(le,B,Te)},writePackedDouble:function(le,Te){Te.length&&this.writeMessage(le,F,Te)},writePackedFixed32:function(le,Te){Te.length&&this.writeMessage(le,Z,Te)},writePackedSFixed32:function(le,Te){Te.length&&this.writeMessage(le,Y,Te)},writePackedFixed64:function(le,Te){Te.length&&this.writeMessage(le,re,Te)},writePackedSFixed64:function(le,Te){Te.length&&this.writeMessage(le,he,Te)},writeBytesField:function(le,Te){this.writeTag(le,n.Bytes),this.writeBytes(Te)},writeFixed32Field:function(le,Te){this.writeTag(le,n.Fixed32),this.writeFixed32(Te)},writeSFixed32Field:function(le,Te){this.writeTag(le,n.Fixed32),this.writeSFixed32(Te)},writeFixed64Field:function(le,Te){this.writeTag(le,n.Fixed64),this.writeFixed64(Te)},writeSFixed64Field:function(le,Te){this.writeTag(le,n.Fixed64),this.writeSFixed64(Te)},writeVarintField:function(le,Te){this.writeTag(le,n.Varint),this.writeVarint(Te)},writeSVarintField:function(le,Te){this.writeTag(le,n.Varint),this.writeSVarint(Te)},writeStringField:function(le,Te){this.writeTag(le,n.Bytes),this.writeString(Te)},writeFloatField:function(le,Te){this.writeTag(le,n.Fixed32),this.writeFloat(Te)},writeDoubleField:function(le,Te){this.writeTag(le,n.Fixed64),this.writeDouble(Te)},writeBooleanField:function(le,Te){this.writeVarintField(le,!!Te)}},j2}var rw=Pa(CI());const U2=3;function _$(c,n,a){n.glyphs=[],c===1&&a.readMessage(y$,n)}function y$(c,n,a){if(c===3){const{id:h,bitmap:p,width:v,height:x,left:E,top:O,advance:D}=a.readMessage(v$,{});n.glyphs.push({id:h,bitmap:new nu({width:v+2*U2,height:x+2*U2},p),metrics:{width:v,height:x,left:E,top:O,advance:D}})}else c===4?n.ascender=a.readSVarint():c===5&&(n.descender=a.readSVarint())}function v$(c,n,a){c===1?n.id=a.readVarint():c===2?n.bitmap=a.readBytes():c===3?n.width=a.readVarint():c===4?n.height=a.readVarint():c===5?n.left=a.readSVarint():c===6?n.top=a.readSVarint():c===7&&(n.advance=a.readVarint())}const x$=U2,ru={horizontal:1,vertical:2,horizontalOnly:3};class L0{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,a){const h=new L0;return h.scale=n||1,h.fontStack=a,h}static forImage(n){const a=new L0;return a.image=n,a}}class Qy{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a,h){const p=new Qy;for(let v=0;v<n.sections.length;v++){const x=n.sections[v];x.image?p.addImageSection(x,h):p.addTextSection(x,a)}return p}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(a,h){let p="";for(let v=0;v<a.length;v++){const x=a.charCodeAt(v+1)||null,E=a.charCodeAt(v-1)||null;p+=!h&&(x&&Mm(x)&&!R0[a[v+1]]||E&&Mm(E)&&!R0[a[v-1]])||!R0[a[v]]?a[v]:R0[a[v]]}return p}(this.text,n)}trim(){let n=0;for(let h=0;h<this.text.length&&ow[this.text.charCodeAt(h)];h++)n++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=n&&ow[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const h=new Qy;return h.text=this.text.substring(n,a),h.sectionIndex=this.sectionIndex.slice(n,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}addTextSection(n,a){this.text+=n.text,this.sections.push(L0.forText(n.scale,n.fontStack||a));const h=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(h)}addImageSection(n,a){const h=n.image?n.image.getPrimary():null;if(!h)return void ui("Can't add FormattedSection with an empty image.");h.scaleSelf(a);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(L0.forImage(h)),this.sectionIndex.push(this.sections.length-1)):ui("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function V2(c,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re=1){const he=Qy.fromFeature(c,p,re);F===ru.vertical&&he.verticalizePunctuation(U);let _e=[];const Se=function(Re,et,Ye,it,dt,Ct){if(!Re)return[];const tn=[],qt=function(Yt,At,Mt,dn,gn,oi){let Zn=0;for(let Sn=0;Sn<Yt.length();Sn++){const un=Yt.getSection(Sn);Zn+=MI(Yt.getCodePoint(Sn),un,dn,gn,At,oi)}return Zn/Math.max(1,Math.ceil(Zn/Mt))}(Re,et,Ye,it,dt,Ct),Jt=Re.text.indexOf("​")>=0;let sn=0;for(let Yt=0;Yt<Re.length();Yt++){const At=Re.getSection(Yt),Mt=Re.getCodePoint(Yt);if(ow[Mt]||(sn+=MI(Mt,At,it,dt,et,Ct)),Yt<Re.length()-1){const dn=!((Ot=Mt)<11904||!(Qn["Bopomofo Extended"](Ot)||Qn.Bopomofo(Ot)||Qn["CJK Compatibility Forms"](Ot)||Qn["CJK Compatibility Ideographs"](Ot)||Qn["CJK Compatibility"](Ot)||Qn["CJK Radicals Supplement"](Ot)||Qn["CJK Strokes"](Ot)||Qn["CJK Symbols and Punctuation"](Ot)||Qn["CJK Unified Ideographs Extension A"](Ot)||Qn["CJK Unified Ideographs"](Ot)||Qn["Enclosed CJK Letters and Months"](Ot)||Qn["Halfwidth and Fullwidth Forms"](Ot)||Qn.Hiragana(Ot)||Qn["Ideographic Description Characters"](Ot)||Qn["Kangxi Radicals"](Ot)||Qn["Katakana Phonetic Extensions"](Ot)||Qn.Katakana(Ot)||Qn["Vertical Forms"](Ot)||Qn["Yi Radicals"](Ot)||Qn["Yi Syllables"](Ot)));(b$[Mt]||dn||At.image)&&tn.push(II(Yt+1,sn,qt,tn,w$(Mt,Re.getCodePoint(Yt+1),dn&&Jt),!1))}}var Ot;return DI(II(Re.length(),sn,qt,tn,0,!0))}(he,D,v,n,h,Z),{processBidirectionalText:Ce,processStyledBidirectionalText:le}=Au;if(Ce&&he.sections.length===1){const Re=Ce(he.toString(),Se);for(const et of Re){const Ye=new Qy;Ye.text=et,Ye.sections=he.sections;for(let it=0;it<et.length;it++)Ye.sectionIndex.push(0);_e.push(Ye)}}else if(le){const Re=le(he.text,he.sectionIndex,Se);for(const et of Re){const Ye=new Qy;Ye.text=et[0],Ye.sectionIndex=et[1],Ye.sections=he.sections,_e.push(Ye)}}else _e=function(Re,et){const Ye=[],it=Re.text;let dt=0;for(const Ct of et)Ye.push(Re.substring(dt,Ct)),dt=Ct;return dt<it.length&&Ye.push(Re.substring(dt,it.length)),Ye}(he,Se);const Te=[],Me={positionedLines:Te,text:he.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Re,et,Ye,it,dt,Ct,tn,qt,Jt,sn,Ot,Yt){let At=0,Mt=0,dn=0;const gn=qt==="right"?1:qt==="left"?0:.5;let oi=!1;for(const Wn of dt){const mi=Wn.getSections();for(const Ci of mi){if(Ci.image)continue;const Ei=et[Ci.fontStack];if(Ei&&(oi=Ei.ascender!==void 0&&Ei.descender!==void 0,!oi))break}if(!oi)break}let Zn=0;for(const Wn of dt){Wn.trim();const mi=Wn.getMaxScale(),Ci=(mi-1)*Vs,Ei={positionedGlyphs:[],lineOffset:0};Re.positionedLines[Zn]=Ei;const $i=Ei.positionedGlyphs;let Li=0;if(!Wn.length()){Mt+=Ct,++Zn;continue}let qi=0,Ir=0;for(let Ie=0;Ie<Wn.length();Ie++){const ze=Wn.getSection(Ie),Lt=Wn.getSectionIndex(Ie),yn=Wn.getCodePoint(Ie);let Pn=ze.scale,wn=null,Hn=null,pi=null,Ji=Vs,Qi=0;Jt===ru.vertical&&((Sn=yn)===12312||Sn===12313||Sn===12316||Sn===12540||Sn===12448)&&(Jt=ru.horizontal);const zi=!(Jt===ru.horizontal||!Ot&&!Of(yn)||Ot&&(ow[yn]||oh(yn)));if(ze.image){const Rr=it.get(ze.image.toString());if(!Rr)continue;pi=ze.image,Re.iconsInText=Re.iconsInText||!0,Hn=Rr.paddedRect;const to=Rr.displaySize;Pn=Pn*Vs/Yt,wn={width:to[0],height:to[1],left:0,top:-3,advance:zi?to[1]:to[0],localGlyph:!1},Qi=oi?-wn.height*Pn:mi*Vs-17-to[1]*Pn,Ji=wn.advance;const er=(zi?to[0]:to[1])*Pn-Vs*mi;er>0&&er>Li&&(Li=er)}else{const Rr=Ye[ze.fontStack];if(!Rr)continue;Rr[yn]&&(Hn=Rr[yn]);const to=et[ze.fontStack];if(!to)continue;const er=to.glyphs[yn];if(!er)continue;if(wn=er.metrics,Ji=yn!==8203?Vs:0,oi){const Do=to.ascender!==void 0?Math.abs(to.ascender):0,lo=to.descender!==void 0?Math.abs(to.descender):0,Dr=(Do+lo)*Pn;qi<Dr&&(qi=Dr,Ir=(Do-lo)/2*Pn),Qi=-Do*Pn}else Qi=(mi-Pn)*Vs-17}zi?(Re.verticalizable=!0,$i.push({glyph:yn,image:pi,x:At,y:Mt+Qi,vertical:zi,scale:Pn,localGlyph:wn.localGlyph,fontStack:ze.fontStack,sectionIndex:Lt,metrics:wn,rect:Hn}),At+=Ji*Pn+sn):($i.push({glyph:yn,image:pi,x:At,y:Mt+Qi,vertical:zi,scale:Pn,localGlyph:wn.localGlyph,fontStack:ze.fontStack,sectionIndex:Lt,metrics:wn,rect:Hn}),At+=wn.advance*Pn+sn)}$i.length!==0&&(dn=Math.max(At-sn,dn),oi?RI($i,gn,Li,Ir,Ct*mi/2):RI($i,gn,Li,0,Ct/2)),At=0;const so=Ct*mi+Li;Ei.lineOffset=Math.max(Li,Ci),Mt+=so,++Zn}var Sn;const un=Mt,{horizontalAlign:bi,verticalAlign:Gn}=$2(tn);(function(Wn,mi,Ci,Ei,$i,Li){const qi=(mi-Ci)*$i,Ir=-Li*Ei;for(const so of Wn)for(const Ie of so.positionedGlyphs)Ie.x+=qi,Ie.y+=Ir})(Re.positionedLines,gn,bi,Gn,dn,un),Re.top+=-Gn*un,Re.bottom=Re.top+un,Re.left+=-bi*dn,Re.right=Re.left+dn,Re.hasBaseline=oi}(Me,n,a,h,_e,x,E,O,F,D,U,Y),!function(Re){for(const et of Re)if(et.positionedGlyphs.length!==0)return!1;return!0}(Te))return Me}const ow={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},b$={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function MI(c,n,a,h,p,v){if(n.image){const x=h.get(n.image.toString());return x?x.displaySize[0]*n.scale*Vs/v+p:0}{const x=a[n.fontStack],E=x&&x.glyphs[c];return E?E.metrics.advance*n.scale+p:0}}function OI(c,n,a,h){const p=Math.pow(c-n,2);return h?c<n?p/2:2*p:p+Math.abs(a)*a}function w$(c,n,a){let h=0;return c===10&&(h-=1e4),a&&(h+=150),c!==40&&c!==65288||(h+=50),n!==41&&n!==65289||(h+=50),h}function II(c,n,a,h,p,v){let x=null,E=OI(n,a,p,v);for(const O of h){const D=OI(n-O.x,a,p,v)+O.badness;D<=E&&(x=O,E=D)}return{index:c,x:n,priorBreak:x,badness:E}}function DI(c){return c?DI(c.priorBreak).concat(c.index):[]}function $2(c){let n=.5,a=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function RI(c,n,a,h,p){if(!(n||a||h||p))return;const v=c.length-1,x=c[v],E=(x.x+x.metrics.advance*x.scale)*n;for(let O=0;O<=v;O++)c[O].x-=E,c[O].y+=a+h+p}function LI(c){return c.imagePrimary!==void 0&&c.top!==void 0&&c.bottom!==void 0&&c.left!==void 0&&c.right!==void 0}function T$(c,n,a,h){const{horizontalAlign:p,verticalAlign:v}=$2(h),x=a[0]-c.displaySize[0]*p,E=a[1]-c.displaySize[1]*v;return{imagePrimary:c,imageSecondary:n,top:E,bottom:E+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function zI(c,n,a,h,p,v){const x=c.imagePrimary;let E;if(x.content){const he=x.content,_e=x.pixelRatio||1;E=[he[0]/_e,he[1]/_e,x.displaySize[0]-he[2]/_e,x.displaySize[1]-he[3]/_e]}const O=n.left*v,D=n.right*v;let B,F,U,Z;a==="width"||a==="both"?(Z=p[0]+O-h[3],F=p[0]+D+h[1]):(Z=p[0]+(O+D-x.displaySize[0])/2,F=Z+x.displaySize[0]);const Y=n.top*v,re=n.bottom*v;return a==="height"||a==="both"?(B=p[1]+Y-h[0],U=p[1]+re+h[2]):(B=p[1]+(Y+re-x.displaySize[1])/2,U=B+x.displaySize[1]),{imagePrimary:x,imageSecondary:void 0,top:B,right:F,bottom:U,left:Z,collisionPadding:E}}function kI(c){return!c.imagePrimary.stretchX}function NI(c){return!c.imagePrimary.stretchY}function BI(c){return{width:c.right-c.left,height:c.bottom-c.top}}const ep=128;function jI(c,n,a){const{expression:h}=n;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Mr(c+1,{worldview:a}))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=h;let x=0;for(;x<p.length&&p[x]<=c;)x++;x=Math.max(0,x-1);let E=x;for(;E<p.length&&p[E]<c+1;)E++;E=Math.min(p.length-1,E);const O=p[x],D=p[E];return h.kind==="composite"?{kind:"composite",minZoom:O,maxZoom:D,interpolationType:v}:{kind:"camera",minZoom:O,maxZoom:D,minSize:h.evaluate(new Mr(O,{worldview:a})),maxSize:h.evaluate(new Mr(D,{worldview:a})),interpolationType:v}}}function q2(c,{uSize:n,uSizeT:a},{lowerSize:h,upperSize:p}){return c.kind==="source"?h/ep:c.kind==="composite"?Xn(h/ep,p/ep,a):n}function z0(c,n,a=1){let h=0,p=0;if(c.kind==="constant")p=c.layoutSize*a;else if(c.kind!=="source"){const{interpolationType:v,minZoom:x,maxZoom:E}=c,O=v?be(Oo.interpolationFactor(v,n,x,E),0,1):0;c.kind==="camera"?p=Xn(c.minSize,c.maxSize,O)*a:h=O*a}return{uSizeT:h,uSize:p}}class rm extends hn{constructor(n,a,h,p,v){super(n,a),this.angle=p,this.z=h,v!==void 0&&(this.segment=v)}clone(){return new rm(this.x,this.y,this.z,this.angle,this.segment)}}function FI(c,n,a,h,p){if(n.segment===void 0)return!0;let v=n,x=n.segment+1,E=0;for(;E>-a/2;){if(x--,x<0)return!1;E-=c[x].dist(v),v=c[x]}E+=c[x].dist(c[x+1]),x++;const O=[];let D=0;for(;E<a/2;){const B=c[x],F=c[x+1];if(!F)return!1;let U=c[x-1].angleTo(B)-B.angleTo(F);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:E,angleDelta:U}),D+=U;E-O[0].distance>h;)D-=O.shift().angleDelta;if(D>p)return!1;x++,E+=B.dist(F)}return!0}function UI(c){let n=0;for(let a=0;a<c.length-1;a++)n+=c[a].dist(c[a+1]);return n}function VI(c,n,a){return c?.6*n*a:0}function $I(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function S$(c,n,a,h,p,v){const x=VI(a,p,v),E=$I(a,h)*v;let O=0;const D=UI(c)/2;for(let B=0;B<c.length-1;B++){const F=c[B],U=c[B+1],Z=F.dist(U);if(O+Z>D){const Y=(D-O)/Z,re=Xn(F.x,U.x,Y),he=Xn(F.y,U.y,Y),_e=new rm(re,he,0,U.angleTo(F),B);return!x||FI(c,_e,E,x,n)?_e:void 0}O+=Z}}function E$(c,n,a,h,p,v,x,E,O){const D=VI(h,v,x),B=$I(h,p),F=B*x,U=c[0].x===0||c[0].x===O||c[0].y===0||c[0].y===O;return n-F<n/4&&(n=F+n/4),qI(c,U?n/2*E%n:(B/2+2*v)*x*E%n,n,D,a,F,U,!1,O)}function qI(c,n,a,h,p,v,x,E,O){const D=v/2,B=UI(c);let F=0,U=n-a,Z=[];for(let Y=0;Y<c.length-1;Y++){const re=c[Y],he=c[Y+1],_e=re.dist(he),Se=he.angleTo(re);for(;U+a<F+_e;){U+=a;const Ce=(U-F)/_e,le=Xn(re.x,he.x,Ce),Te=Xn(re.y,he.y,Ce);if(le>=0&&le<O&&Te>=0&&Te<O&&U-D>=0&&U+D<=B){const Me=new rm(le,Te,0,Se,Y);h&&!FI(c,Me,v,h,p)||Z.push(Me)}}F+=_e}return E||Z.length||x||(Z=qI(c,F/2,a,h,p,v,x,!0,O)),Z}function HI(c){let n=0,a=0;for(const x of c)n+=x.w*x.h,a=Math.max(a,x.w);c.sort((x,E)=>E.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let p=0,v=0;for(const x of c)for(let E=h.length-1;E>=0;E--){const O=h[E];if(!(x.w>O.w||x.h>O.h)){if(x.x=O.x,x.y=O.y,v=Math.max(v,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===O.w&&x.h===O.h){const D=h.pop();E<h.length&&(h[E]=D)}else x.h===O.h?(O.x+=x.w,O.w-=x.w):x.w===O.w?(O.y+=x.h,O.h-=x.h):(h.push({x:O.x+x.w,y:O.y,w:O.w-x.w,h:x.h}),O.y+=x.h,O.h-=x.h);break}}return{w:p,h:v,fill:n/(p*v)||0}}Nn(rm,"Anchor");const P_=1;class k0{static getImagePositionScale(n,a,h){if(a&&n&&n.options&&n.options.transform){const p=n.options.transform;return{x:p.a,y:p.d}}return{x:h,y:h}}constructor(n,a,h,p){this.paddedRect=n;const{pixelRatio:v,version:x,stretchX:E,stretchY:O,content:D,sdf:B,usvg:F}=a;this.pixelRatio=v,this.stretchX=E,this.stretchY=O,this.content=D,this.version=x,this.padding=h,this.sdf=B,this.usvg=F,this.scale=k0.getImagePositionScale(p,F,v)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function H2(c,n,a){const h=rc.parse(c),p=function(v,x,E=[1,1]){return{x:0,y:0,w:(v.data?v.data.width:v.width*E[0])+2*x,h:(v.data?v.data.height:v.height*E[1])+2*x}}(n,a,[h.options.transform.a,h.options.transform.d]);return{bin:p,imagePosition:new k0(p,n,a,h),imageVariant:h}}class GI{constructor(n,a,h){const p=new Map,v=new Map;this.haveRenderCallbacks=[];const x=[];this.addImages(n,p,P_,x),this.addImages(a,v,2,x);const{w:E,h:O}=HI(x),D=new Cs({width:E||1,height:O||1});for(const[B,F]of n.entries()){const U=p.get(B).paddedRect;Cs.copy(F.data,D,{x:0,y:0},{x:U.x+P_,y:U.y+P_},F.data,h,F.sdf)}for(const[B,F]of a.entries()){const U=v.get(B),Z=U.paddedRect;let Y=U.padding;const re=Z.x+Y,he=Z.y+Y,_e=F.data.width,Se=F.data.height;Y=Y>1?Y-1:Y,Cs.copy(F.data,D,{x:0,y:0},{x:re,y:he},F.data,h),Cs.copy(F.data,D,{x:0,y:Se-Y},{x:re,y:he-Y},{width:_e,height:Y},h),Cs.copy(F.data,D,{x:0,y:0},{x:re,y:he+Se},{width:_e,height:Y},h),Cs.copy(F.data,D,{x:_e-Y,y:0},{x:re-Y,y:he},{width:Y,height:Se},h),Cs.copy(F.data,D,{x:0,y:0},{x:re+_e,y:he},{width:Y,height:Se},h),Cs.copy(F.data,D,{x:_e-Y,y:Se-Y},{x:re-Y,y:he-Y},{width:Y,height:Y},h),Cs.copy(F.data,D,{x:0,y:Se-Y},{x:re+_e,y:he-Y},{width:Y,height:Y},h),Cs.copy(F.data,D,{x:0,y:0},{x:re+_e,y:he+Se},{width:Y,height:Y},h),Cs.copy(F.data,D,{x:_e-Y,y:0},{x:re-Y,y:he+Se},{width:Y,height:Y},h)}this.lut=h,this.image=D,this.iconPositions=p,this.patternPositions=v}addImages(n,a,h,p){for(const[v,x]of n.entries()){const{bin:E,imagePosition:O,imageVariant:D}=H2(v,x,h);a.set(v,O),p.push(E),x.hasRenderCallback&&this.haveRenderCallbacks.push(D.id)}}patchUpdatedImages(n,a,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>n.hasImage(p,h)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const p of n.getUpdatedImages(h)){for(const v of this.iconPositions.keys()){const x=rc.parse(v);if(yo.isEqual(x.id,p)){const E=n.getImage(p,h);this.patchUpdatedImage(this.iconPositions.get(v),E,a)}}for(const v of this.patternPositions.keys()){const x=rc.parse(v);if(yo.isEqual(x.id,p)){const E=n.getImage(p,h);this.patchUpdatedImage(this.patternPositions.get(v),E,a)}}}}patchUpdatedImage(n,a,h){if(!n||!a||n.version===a.version)return;n.version=a.version;const[p,v]=n.tl,x=n.sdf;if(this.lut||x){const E={width:a.data.width,height:a.data.height},O=new Cs(E);Cs.copy(a.data,O,{x:0,y:0},{x:0,y:0},E,this.lut,x),h.update(O,{position:{x:p,y:v}})}else h.update(a.data,{position:{x:p,y:v}})}}Nn(k0,"ImagePosition"),Nn(GI,"ImageAtlas");const aw=1e20;function ZI(c,n,a,h,p,v,x,E,O){for(let D=n;D<n+h;D++)WI(c,a*v+D,v,p,x,E,O);for(let D=a;D<a+p;D++)WI(c,D*v+n,1,h,x,E,O)}function WI(c,n,a,h,p,v,x){v[0]=0,x[0]=-1e20,x[1]=aw,p[0]=c[n];for(let E=1,O=0,D=0;E<h;E++){p[E]=c[n+E*a];const B=E*E;do{const F=v[O];D=(p[E]-p[F]+B-F*F)/(E-F)/2}while(D<=x[O]&&--O>-1);O++,v[O]=E,x[O]=D,x[O+1]=aw}for(let E=0,O=0;E<h;E++){for(;x[O+1]<E;)O++;const D=v[O],B=E-D;c[n+E*a]=p[D]+B*B}}const sf=2,G2={none:0,ideographs:1,all:2};class ev{constructor(n,a,h){this.requestManager=n,this.localGlyphMode=a,this.localFontFamily=h,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,a){this.urls[a]=n}getGlyphs(n,a,h){const p=[],v=this.urls[a]||or.GLYPHS_URL;for(const x in n)for(const E of n[x])p.push({stack:x,id:E});Xe(p,({stack:x,id:E},O)=>{let D=this.entries[x];D||(D=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let B=D.glyphs[E];if(B!==void 0)return void O(null,{stack:x,id:E,glyph:B});if(B=this._tinySDF(D,x,E),B)return D.glyphs[E]=B,void O(null,{stack:x,id:E,glyph:B});const F=Math.floor(E/256);if(256*F>65535)return ui("glyphs > 65535 not supported"),void O(null,{stack:x,id:E,glyph:B});if(D.ranges[F])return void O(null,{stack:x,id:E,glyph:B});let U=D.requests[F];U||(U=D.requests[F]=[],ev.loadGlyphRange(x,F,v,this.requestManager,(Z,Y)=>{if(Y){D.ascender=Y.ascender,D.descender=Y.descender;for(const re in Y.glyphs)this._doesCharSupportLocalGlyph(+re)||(D.glyphs[+re]=Y.glyphs[+re]);D.ranges[F]=!0}for(const re of U)re(Z,Y);delete D.requests[F]})),U.push((Z,Y)=>{Z?O(Z):Y&&O(null,{stack:x,id:E,glyph:Y.glyphs[E]||null})})},(x,E)=>{if(x)h(x);else if(E){const O={};for(const{stack:D,id:B,glyph:F}of E)O[D]===void 0&&(O[D]={}),O[D].glyphs===void 0&&(O[D].glyphs={}),O[D].glyphs[B]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics},O[D].ascender=this.entries[D].ascender,O[D].descender=this.entries[D].descender;h(null,O)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==G2.none&&(this.localGlyphMode===G2.all?!!this.localFontFamily:!!this.localFontFamily&&(Qn["CJK Unified Ideographs"](n)||Qn["Hangul Syllables"](n)||Qn.Hiragana(n)||Qn.Katakana(n)||Qn["CJK Symbols and Punctuation"](n)||Qn["CJK Unified Ideographs Extension A"](n)||Qn["CJK Unified Ideographs Extension B"](n)||Qn.Osage(n)))}_tinySDF(n,a,h){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let v=n.tinySDF;if(!v){let re="400";/bold/i.test(a)?re="900":/medium/i.test(a)?re="500":/light/i.test(a)&&(re="200"),v=n.tinySDF=new ev.TinySDF({fontFamily:p,fontWeight:re,fontSize:24*sf,buffer:3*sf,radius:8*sf}),v.fontWeight=re}if(this.localGlyphs[v.fontWeight][h])return this.localGlyphs[v.fontWeight][h];const x=String.fromCodePoint(h),{data:E,width:O,height:D,glyphWidth:B,glyphHeight:F,glyphLeft:U,glyphTop:Z,glyphAdvance:Y}=v.draw(x);return this.localGlyphs[v.fontWeight][h]={id:h,bitmap:new nu({width:O,height:D},E),metrics:{width:B/sf,height:F/sf,left:U/sf,top:Z/sf-27,advance:Y/sf,localGlyph:!0}}}}ev.loadGlyphRange=function(c,n,a,h,p){const v=256*n,x=v+255,E=h.transformRequest(h.normalizeGlyphsURL(a).replace("{fontstack}",c).replace("{range}",`${v}-${x}`),Sr.Glyphs);ko(E,(O,D)=>{if(O)p(O);else if(D){const B={},F=function(U){return new rw(U).readFields(_$,{})}(D);for(const U of F.glyphs)B[U.id]=U;p(null,{glyphs:B,ascender:F.ascender,descender:F.descender})}})},ev.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:a=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:v="normal",fontStyle:x="normal"}={}){this.buffer=n,this.cutoff=h,this.radius=a;const E=this.size=c+4*n,O=this._createCanvas(E),D=this.ctx=O.getContext("2d",{willReadFrequently:!0});D.font=`${x} ${v} ${c}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:v}=this.ctx.measureText(c),x=Math.ceil(a),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-p))),O=Math.min(this.size-this.buffer,x+Math.ceil(h)),D=E+2*this.buffer,B=O+2*this.buffer,F=Math.max(D*B,0),U=new Uint8ClampedArray(F),Z={data:U,width:D,height:B,glyphWidth:E,glyphHeight:O,glyphTop:x,glyphLeft:0,glyphAdvance:n};if(E===0||O===0)return Z;const{ctx:Y,buffer:re,gridInner:he,gridOuter:_e}=this;Y.clearRect(re,re,E,O),Y.fillText(c,re,re+x);const Se=Y.getImageData(re,re,E,O);_e.fill(aw,0,F),he.fill(0,0,F);for(let Ce=0;Ce<O;Ce++)for(let le=0;le<E;le++){const Te=Se.data[4*(Ce*E+le)+3]/255;if(Te===0)continue;const Me=(Ce+re)*D+le+re;if(Te===1)_e[Me]=0,he[Me]=aw;else{const Re=.5-Te;_e[Me]=Re>0?Re*Re:0,he[Me]=Re<0?Re*Re:0}}ZI(_e,0,0,D,B,D,this.f,this.v,this.z),ZI(he,re,re,E,O,D,this.f,this.v,this.z);for(let Ce=0;Ce<F;Ce++){const le=Math.sqrt(_e[Ce])-Math.sqrt(he[Ce]);U[Ce]=Math.round(255-255*(le/this.radius+this.cutoff))}return Z}};const C_=P_;function XI(c,n){return c+n[1]-n[0]}function YI(c,n,a,h,p=1){const v=[],x=c.imagePrimary,E=x.pixelRatio,O=x.paddedRect.w-2*C_,D=x.paddedRect.h-2*C_,B=(c.right-c.left)*p,F=(c.bottom-c.top)*p,U=x.stretchX||[[0,O]],Z=x.stretchY||[[0,D]],Y=U.reduce(XI,0),re=Z.reduce(XI,0),he=O-Y,_e=D-re;let Se=0,Ce=Y,le=0,Te=re,Me=0,Re=he,et=0,Ye=_e;if(x.content&&h){const dt=x.content;Se=sw(U,0,dt[0]),le=sw(Z,0,dt[1]),Ce=sw(U,dt[0],dt[2]),Te=sw(Z,dt[1],dt[3]),Me=dt[0]-Se,et=dt[1]-le,Re=dt[2]-dt[0]-Ce,Ye=dt[3]-dt[1]-Te}const it=(dt,Ct,tn,qt)=>{const Jt=lw(dt.stretch-Se,Ce,B,c.left*p),sn=cw(dt.fixed-Me,Re,dt.stretch,Y),Ot=lw(Ct.stretch-le,Te,F,c.top*p),Yt=cw(Ct.fixed-et,Ye,Ct.stretch,re),At=lw(tn.stretch-Se,Ce,B,c.left*p),Mt=cw(tn.fixed-Me,Re,tn.stretch,Y),dn=lw(qt.stretch-le,Te,F,c.top*p),gn=cw(qt.fixed-et,Ye,qt.stretch,re),oi=new hn(Jt,Ot),Zn=new hn(At,Ot),Sn=new hn(At,dn),un=new hn(Jt,dn),bi=new hn(sn/E,Yt/E),Gn=new hn(Mt/E,gn/E),Wn=n*Math.PI/180;if(Wn){const qi=Math.sin(Wn),Ir=Math.cos(Wn),so=[Ir,-qi,qi,Ir];oi._matMult(so),Zn._matMult(so),un._matMult(so),Sn._matMult(so)}const mi=dt.stretch+dt.fixed,Ci=tn.stretch+tn.fixed,Ei=Ct.stretch+Ct.fixed,$i=qt.stretch+qt.fixed,Li=c.imageSecondary;return{tl:oi,tr:Zn,bl:un,br:Sn,texPrimary:{x:x.paddedRect.x+C_+mi,y:x.paddedRect.y+C_+Ei,w:Ci-mi,h:$i-Ei},texSecondary:Li?{x:Li.paddedRect.x+C_+mi,y:Li.paddedRect.y+C_+Ei,w:Ci-mi,h:$i-Ei}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:bi,pixelOffsetBR:Gn,minFontScaleX:Re/E/B,minFontScaleY:Ye/E/F,isSDF:a}};if(h&&(x.stretchX||x.stretchY)){const dt=KI(U,he,Y),Ct=KI(Z,_e,re);for(let tn=0;tn<dt.length-1;tn++){const qt=dt[tn],Jt=dt[tn+1];for(let sn=0;sn<Ct.length-1;sn++)v.push(it(qt,Ct[sn],Jt,Ct[sn+1]))}}else v.push(it({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:D+1}));return v}function sw(c,n,a){let h=0;for(const p of c)h+=Math.max(n,Math.min(a,p[1]))-Math.max(n,Math.min(a,p[0]));return h}function KI(c,n,a){const h=[{fixed:-1,stretch:0}];for(const[p,v]of c){const x=h[h.length-1];h.push({fixed:p-x.stretch,stretch:x.stretch}),h.push({fixed:p-x.stretch,stretch:x.stretch+(v-p)})}return h.push({fixed:n+C_,stretch:a}),h}function lw(c,n,a,h){return c/n*a+h}function cw(c,n,a,h){return c-n*a/h}function A$(c,n,a,h){const p=n+c.positionedLines[h].lineOffset;return h===0?a+p/2:a+(p+(n+c.positionedLines[h-1].lineOffset))/2}function P$(c,n=1,a=!1){let h=1/0,p=1/0,v=-1/0,x=-1/0;const E=c[0];for(let Z=0;Z<E.length;Z++){const Y=E[Z];(!Z||Y.x<h)&&(h=Y.x),(!Z||Y.y<p)&&(p=Y.y),(!Z||Y.x>v)&&(v=Y.x),(!Z||Y.y>x)&&(x=Y.y)}const O=Math.min(v-h,x-p);let D=O/2;const B=new uc([],C$);if(O===0)return new hn(h,p);for(let Z=h;Z<v;Z+=O)for(let Y=p;Y<x;Y+=O)B.push(new tv(Z+D,Y+D,D,c));let F=function(Z){let Y=0,re=0,he=0;const _e=Z[0];for(let Se=0,Ce=_e.length,le=Ce-1;Se<Ce;le=Se++){const Te=_e[Se],Me=_e[le],Re=Te.x*Me.y-Me.x*Te.y;re+=(Te.x+Me.x)*Re,he+=(Te.y+Me.y)*Re,Y+=3*Re}return new tv(re/Y,he/Y,0,Z)}(c),U=B.length;for(;B.length;){const Z=B.pop();(Z.d>F.d||!F.d)&&(F=Z,a&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,U)),Z.max-F.d<=n||(D=Z.h/2,B.push(new tv(Z.p.x-D,Z.p.y-D,D,c)),B.push(new tv(Z.p.x+D,Z.p.y-D,D,c)),B.push(new tv(Z.p.x-D,Z.p.y+D,D,c)),B.push(new tv(Z.p.x+D,Z.p.y+D,D,c)),U+=4)}return a&&(console.log(`num probes: ${U}`),console.log(`best distance: ${F.d}`)),F.p}function C$(c,n){return n.max-c.max}class tv{constructor(n,a,h,p){this.p=new hn(n,a),this.h=h,this.d=function(v,x){let E=!1,O=1/0;for(let D=0;D<x.length;D++){const B=x[D];for(let F=0,U=B.length,Z=U-1;F<U;Z=F++){const Y=B[F],re=B[Z];Y.y>v.y!=re.y>v.y&&v.x<(re.x-Y.x)*(v.y-Y.y)/(re.y-Y.y)+Y.x&&(E=!E),O=Math.min(O,Gf(v,Y,re))}}return(E?1:-1)*Math.sqrt(O)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const M$=Object.keys,Z2=Number.POSITIVE_INFINITY,O$=Math.sqrt(2);function JI(c,[n,a]){let h=0,p=0;if(a===Z2){n<0&&(n=0);const v=n/O$;switch(c){case"top-right":case"top-left":p=v-7;break;case"bottom-right":case"bottom-left":p=7-v;break;case"bottom":p=7-n;break;case"top":p=n-7}switch(c){case"top-right":case"bottom-right":h=-v;break;case"top-left":case"bottom-left":h=v;break;case"left":h=n;break;case"right":h=-n}}else{switch(n=Math.abs(n),a=Math.abs(a),c){case"top-right":case"top-left":case"top":p=a-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-a}switch(c){case"top-right":case"bottom-right":case"right":h=-n;break;case"top-left":case"bottom-left":case"left":h=n}}return[h,p]}function uw(c,n,a,h,p,v,x,E,O){if(!n||!n.usvg)return;const D=BI(h),B=BI(p),F=v!=="both"&&v!=="width"||!kI(h)?1:B.width/D.width,U=v!=="both"&&v!=="height"||!NI(h)?1:B.height/D.height;a.scaleSelf(F,U);const Z=a.toString();x.set(Z,a),E.set(Z,n);const{imagePosition:Y}=H2(Z,n,P_);O.set(Z,Y)}function QI(c,n,a,h,p,v,x,E,O){if(!c)return;const D=function(B,F,U,Z,Y,re){if(B.kind==="camera")return B.maxSize;if(B.kind==="composite"){const he=F.possiblyEvaluate(new Mr(B.maxZoom,{worldview:re}),U).evaluate(Y,{},U),_e=F.possiblyEvaluate(new Mr(B.minZoom,{worldview:re}),U).evaluate(Y,{},U);return Math.max(he,_e)}return F.possiblyEvaluate(new Mr(Z,{worldview:re})).evaluate(Y,{},U)}(n,a,h,p,v,O);return c.scaleSelf(D*E*x)}function eD(c,n,a,h,p,v,x,E,O){return{iconPrimary:QI(c.getPrimary(),n,a,h,p,v,x,E,O),iconSecondary:QI(c.getSecondary(),n,a,h,p,v,x,E,O)}}function I$(c,n,a){if(!n)return;const h=a.get(c.toString()),p=a.get(n.toString());p&&(h.paddedRect.w===p.paddedRect.w&&h.paddedRect.h===p.paddedRect.h||ui(`Mismatch in icon variant sizes: ${c.toString()} and ${n.toString()}`),h.usvg!==p.usvg&&ui(`Mismatch in icon variant image types: ${c.id} and ${n.id}`))}function tD(c,n,a,h){if(!c)return;const p=n.get(a.toString());if(c.imagePrimary=p,h){const v=n.get(h.toString());c.imageSecondary=v}}function D$(c,n){for(const a in c.horizontal)nD(c.horizontal[a],n);nD(c.vertical,n)}function nD(c,n){if(c){for(const a of c.positionedLines)for(const h of a.positionedGlyphs)if(h.image!==null){const p=h.image.toString();h.rect=n.get(p).paddedRect}}}function W2(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function R$(c,n,a,h,p,v,x,E,O){const D=X2(v.horizontal)||v.vertical,B=a.get("icon-text-fit-padding").evaluate(h,{},p);let F,U=n;return n&&O!=="none"&&(c.allowVerticalPlacement&&v.vertical&&(F=zI(n,v.vertical,O,B,E,x)),D&&(U=zI(n,D,O,B,E,x))),{defaultShapedIcon:U,verticallyShapedIcon:F}}function L$(c,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e,Se,Ce){let le=x.textMaxSize.evaluate(n,{},U);le===void 0?le=E*x.textScaleFactor:le*=x.textScaleFactor;const Te=c.layers[0].layout,Me=X2(a.horizontal)||a.vertical,Re=Z.name==="globe",et=Vs,Ye=c.tilePixelRatio*le/et,it=(sn=c.overscaling,c.zoom>18&&sn>2&&(sn>>=1),Math.max(fn/(512*sn),1)*Te.get("symbol-spacing")),dt=Te.get("text-padding")*c.tilePixelRatio,Ct=Te.get("icon-padding")*c.tilePixelRatio,tn=Tt(Te.get("text-max-angle")),qt=Te.get("icon-rotation-alignment")==="map"&&Ce!=="point",Jt=it/2;var sn;c.hasAnyIconTextFit===!1&&he!=="none"&&(c.hasAnyIconTextFit=!0);const Ot=n.properties?+n.properties[fi]:null,Yt=Ot&&c.elevationFeatureIdToIndex?c.elevationFeatureIdToIndex.get(Ot):65535,At=(Mt,dn,gn)=>{if(dn.x<0||dn.x>=fn||dn.y<0||dn.y>=fn)return;let oi=null;if(Re){const{x:Zn,y:Sn,z:un}=Z.projectTilePoint(dn.x,dn.y,gn);oi={anchor:new rm(Zn,Sn,un,0,void 0),up:Z.upVector(gn,dn.x,dn.y)}}(function(Zn,Sn,un,bi,Gn,Wn,mi,Ci,Ei,$i,Li,qi,Ir,so,Ie,ze,Lt,yn,Pn,wn,Hn,pi,Ji,Qi,zi,Rr,to,er,Do){const lo=Zn.addToLineVertexArray(Sn,bi);let Dr,Ko,po,no,co,zr,Bi,Ur=0,Ro=0,hi=0,mr=0,mo=-1,qo=-1;const vo={};let Za=kn("");const Hr=un?un.anchor:Sn,ka=er!=="none";let Ec=0,pl=0;if(Ei._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Wa=Ei.layout.get("text-offset").evaluate(Hn,{},zi);Ec=Wa[0]*Vs,pl=Wa[1]*Vs}else Ec=Ei.layout.get("text-radial-offset").evaluate(Hn,{},zi)*Vs,pl=Z2;if(Zn.allowVerticalPlacement&&Gn.vertical){const Wa=Gn.vertical;if(Ie)zr=Y2(Wa),Ci&&(Bi=Y2(Ci));else{const ms=Ei.layout.get("text-rotate").evaluate(Hn,{},zi)+90;po=hw($i,Hr,Sn,Li,qi,Ir,Wa,so,ms,ze),Ci&&(no=hw($i,Hr,Sn,Li,qi,Ir,Ci,yn,ms))}}if(Wn){const Wa=Zn.iconSizeData,ms=Ei.layout.get("icon-rotate").evaluate(Hn,{},zi),ml=YI(Wn,ms,Ji,ka,pi.iconScaleFactor),Fl=Ci?YI(Ci,ms,Ji,ka,pi.iconScaleFactor):void 0;Ko=hw($i,Hr,Sn,Li,qi,Ir,Wn,yn,ms,null),Ur=4*ml.length;let Ol=null;Wa.kind==="source"?(Ol=[ep*Ei.layout.get("icon-size").evaluate(Hn,{},zi)*pi.iconScaleFactor],Ol[0]>sg&&ui(`${Zn.layerIds[0]}: Value for "icon-size" is >= ${N0}. Reduce your "icon-size".`)):Wa.kind==="composite"&&(Ol=[ep*pi.compositeIconSizes[0].evaluate(Hn,{},zi)*pi.iconScaleFactor,ep*pi.compositeIconSizes[1].evaluate(Hn,{},zi)*pi.iconScaleFactor],(Ol[0]>sg||Ol[1]>sg)&&ui(`${Zn.layerIds[0]}: Value for "icon-size" is >= ${N0}. Reduce your "icon-size".`)),Zn.addSymbols(Zn.icon,ml,Ol,wn,Pn,Hn,void 0,un,Sn,lo.lineStartIndex,lo.lineLength,-1,Qi,zi,Rr,to),mo=Zn.icon.placedSymbolArray.length-1,Fl&&(Ro=4*Fl.length,Zn.addSymbols(Zn.icon,Fl,Ol,wn,Pn,Hn,ru.vertical,un,Sn,lo.lineStartIndex,lo.lineLength,-1,Qi,zi,Rr,to),qo=Zn.icon.placedSymbolArray.length-1)}for(const Wa in Gn.horizontal){const ms=Wa,ml=Gn.horizontal[ms];Dr||(Za=kn(ml.text),Ie?co=Y2(ml):Dr=hw($i,Hr,Sn,Li,qi,Ir,ml,so,Ei.layout.get("text-rotate").evaluate(Hn,{},zi),ze));const Fl=ml.positionedLines.length===1;if(hi+=iD(Zn,un,Sn,ml,mi,Ei,Ie,Hn,ze,lo,Gn.vertical?ru.horizontal:ru.horizontalOnly,Fl?M$(Gn.horizontal):[ms],vo,mo,pi,Qi,zi,Rr),Fl)break}Gn.vertical&&(mr+=iD(Zn,un,Sn,Gn.vertical,mi,Ei,Ie,Hn,ze,lo,ru.vertical,["vertical"],vo,qo,pi,Qi,zi,Rr));let tl=-1;const Ac=(Wa,ms)=>Wa?Math.max(Wa,ms):ms;tl=Ac(co,tl),tl=Ac(zr,tl),tl=Ac(Bi,tl);const tp=tl>-1?1:0;Zn.glyphOffsetArray.length>=65535&&ui("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Hn.sortKey!==void 0&&Zn.addToSortKeyRanges(Zn.symbolInstances.length,Hn.sortKey),Zn.symbolInstances.emplaceBack(Sn.x,Sn.y,Hr.x,Hr.y,Hr.z,vo.right>=0?vo.right:-1,vo.center>=0?vo.center:-1,vo.left>=0?vo.left:-1,vo.vertical>=0?vo.vertical:-1,mo,qo,Za,Dr!==void 0?Dr:Zn.collisionBoxArray.length,Dr!==void 0?Dr+1:Zn.collisionBoxArray.length,po!==void 0?po:Zn.collisionBoxArray.length,po!==void 0?po+1:Zn.collisionBoxArray.length,Ko!==void 0?Ko:Zn.collisionBoxArray.length,Ko!==void 0?Ko+1:Zn.collisionBoxArray.length,no||Zn.collisionBoxArray.length,no?no+1:Zn.collisionBoxArray.length,Li,hi,mr,Ur,Ro,tp,0,Ec,pl,tl,0,ka?1:0,Do)})(c,dn,oi,Mt,a,h,v,p,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,dt,Se,D,0,Ct,qt,_e,n,x,B,F,U,Y,re,he,Yt)};if(Ce==="line")for(const Mt of _(n.geometry,0,0,fn,fn)){const dn=E$(Mt,it,tn,a.vertical||Me,h,et,Ye,c.overscaling,fn);for(const gn of dn)Me&&z$(c,Me.text,Jt,gn)||At(Mt,gn,U)}else if(Ce==="line-center"){for(const Mt of n.geometry)if(Mt.length>1){const dn=S$(Mt,tn,a.vertical||Me,h,et,Ye);dn&&At(Mt,dn,U)}}else if(n.type==="Polygon")for(const Mt of m_(n.geometry,0)){const dn=P$(Mt,16);At(Mt[0],new rm(dn.x,dn.y,0,0,void 0),U)}else if(n.type==="LineString")for(const Mt of n.geometry)At(Mt,new rm(Mt[0].x,Mt[0].y,0,0,void 0),U);else if(n.type==="Point")for(const Mt of n.geometry)for(const dn of Mt)At([dn],new rm(dn.x,dn.y,0,0,void 0),U)}const N0=255,sg=N0*ep;function iD(c,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he,_e){const Se=function(Te,Me,Re,et,Ye,it,dt,Ct){const tn=[];if(Me.positionedLines.length===0)return tn;const qt=et.layout.get("text-rotate").evaluate(it,{})*Math.PI/180,Jt=function(Mt){const dn=Mt[0],gn=Mt[1],oi=dn*gn;return oi>0?[dn,-gn]:oi<0?[-dn,gn]:dn===0?[gn,dn]:[gn,-dn]}(Re);let sn=Math.abs(Me.top-Me.bottom);for(const Mt of Me.positionedLines)sn-=Mt.lineOffset;const Ot=Me.positionedLines.length,Yt=sn/Ot;let At=Me.top-Re[1];for(let Mt=0;Mt<Ot;++Mt){const dn=Me.positionedLines[Mt];At=A$(Me,Yt,At,Mt);for(const gn of dn.positionedGlyphs){if(!gn.rect)continue;const oi=gn.rect||{};let Zn=x$+1,Sn=!0,un=1,bi=0;if(gn.image){const Hn=dt.get(gn.image.toString());if(!Hn)continue;if(Hn.sdf){ui("SDF images are not supported in formatted text and will be ignored.");continue}Sn=!1,un=Hn.pixelRatio,Zn=P_/un}const Gn=(Ye||Ct)&&gn.vertical,Wn=gn.metrics.advance*gn.scale/2,mi=gn.metrics,Ci=gn.rect;if(Ci===null)continue;Ct&&Me.verticalizable&&(bi=gn.image?Wn-gn.metrics.width*gn.scale/2:0);const Ei=Ye?[gn.x+Wn,gn.y]:[0,0];let $i=[0,0],Li=[0,0],qi=!1;Ye||(Gn?(Li=[gn.x+Wn+Jt[0],gn.y+Jt[1]-bi],qi=!0):$i=[gn.x+Wn+Re[0],gn.y+Re[1]-bi]);const Ir=Ci.w*gn.scale/(un*(gn.localGlyph?sf:1)),so=Ci.h*gn.scale/(un*(gn.localGlyph?sf:1));let Ie,ze,Lt,yn;if(Gn){const Hn=gn.y-At,pi=new hn(-Wn,Wn-Hn),Ji=-Math.PI/2,Qi=new hn(...Li);Ie=new hn(-Wn+$i[0],$i[1]),Ie._rotateAround(Ji,pi)._add(Qi),Ie.x+=-Hn+Wn,Ie.y-=(mi.left-Zn)*gn.scale;const zi=gn.image?mi.advance*gn.scale:Vs*gn.scale,Rr=String.fromCodePoint(gn.glyph);p$(Rr)?Ie.x+=(1-Zn)*gn.scale:m$(Rr)?Ie.x+=zi-mi.height*gn.scale+(-Zn-1)*gn.scale:Ie.x+=gn.image||mi.width+2*Zn===Ci.w&&mi.height+2*Zn===Ci.h?(zi-so)/2:(zi-(mi.height+2*Zn)*gn.scale)/2,ze=new hn(Ie.x,Ie.y-Ir),Lt=new hn(Ie.x+so,Ie.y),yn=new hn(Ie.x+so,Ie.y-Ir)}else{const Hn=(mi.left-Zn)*gn.scale-Wn+$i[0],pi=(-mi.top-Zn)*gn.scale+$i[1],Ji=Hn+Ir,Qi=pi+so;Ie=new hn(Hn,pi),ze=new hn(Ji,pi),Lt=new hn(Hn,Qi),yn=new hn(Ji,Qi)}if(qt){let Hn;Hn=Ye?new hn(0,0):qi?new hn(Jt[0],Jt[1]):new hn(Re[0],Re[1]),Ie._rotateAround(qt,Hn),ze._rotateAround(qt,Hn),Lt._rotateAround(qt,Hn),yn._rotateAround(qt,Hn)}const Pn=new hn(0,0),wn=new hn(0,0);tn.push({tl:Ie,tr:ze,bl:Lt,br:yn,texPrimary:oi,texSecondary:void 0,writingMode:Me.writingMode,glyphOffset:Ei,sectionIndex:gn.sectionIndex,isSDF:Sn,pixelOffsetTL:Pn,pixelOffsetBR:wn,minFontScaleX:0,minFontScaleY:0})}}return tn}(0,h,O,v,x,E,p,c.allowVerticalPlacement),Ce=c.textSizeData;let le=null;Ce.kind==="source"?(le=[ep*v.layout.get("text-size").evaluate(E,{},he)*Y.textScaleFactor],le[0]>sg&&ui(`${c.layerIds[0]}: Value for "text-size" is >= ${N0}. Reduce your "text-size".`)):Ce.kind==="composite"&&(le=[ep*Y.compositeTextSizes[0].evaluate(E,{},he)*Y.textScaleFactor,ep*Y.compositeTextSizes[1].evaluate(E,{},he)*Y.textScaleFactor],(le[0]>sg||le[1]>sg)&&ui(`${c.layerIds[0]}: Value for "text-size" is >= ${N0}. Reduce your "text-size".`)),c.addSymbols(c.text,Se,le,O,x,E,B,n,a,D.lineStartIndex,D.lineLength,Z,re,he,_e,!1);for(const Te of F)U[Te]=c.text.placedSymbolArray.length-1;return 4*Se.length}function X2(c){for(const n in c)return c[n];return null}function hw(c,n,a,h,p,v,x,E,O,D){let B=x.top,F=x.bottom,U=x.left,Z=x.right;if(LI(x)&&x.collisionPadding){const Y=x.collisionPadding;U-=Y[0],B-=Y[1],Z+=Y[2],F+=Y[3]}if(O){const Y=new hn(U,B),re=new hn(Z,B),he=new hn(U,F),_e=new hn(Z,F),Se=Tt(O);let Ce=new hn(0,0);D&&(Ce=new hn(D[0],D[1])),Y._rotateAround(Se,Ce),re._rotateAround(Se,Ce),he._rotateAround(Se,Ce),_e._rotateAround(Se,Ce),U=Math.min(Y.x,re.x,he.x,_e.x),Z=Math.max(Y.x,re.x,he.x,_e.x),B=Math.min(Y.y,re.y,he.y,_e.y),F=Math.max(Y.y,re.y,he.y,_e.y)}return c.emplaceBack(n.x,n.y,n.z,a.x,a.y,U,B,Z,F,E,h,p,v),c.length-1}function Y2(c){LI(c)&&c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function z$(c,n,a,h){const p=c.compareText;if(n in p){const v=p[n];for(let x=v.length-1;x>=0;x--)if(h.dist(v[x])<a)return!0}else p[n]=[];return p[n].push(h),!1}function rD(c,n){const a=c.fovAboveCenter,h=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,p=(c._camera.position[2]*c.worldSize-h)/Math.cos(c._pitch),v=Math.sin(a)*p/Math.sin(Math.max(Math.PI/2-c._pitch-a,.01));let x=Math.sin(c._pitch)*v+p;const E=p*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let O=Math.max(c.zoom-17,0);c.isOrthographic&&(O/=10),x*=1+O}return Math.min(1.01*x,E)}function B0(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const a=Math.pow(2,-c.z),h=c.x*a,p=(c.x+1)*a,v=c.y*a,x=(c.y+1)*a,E=Ke(h),O=Ke(p),D=pt(v),B=pt(x),F=n.project(E,D),U=n.project(O,D),Z=n.project(O,B),Y=n.project(E,B);let re=Math.min(F.x,U.x,Z.x,Y.x),he=Math.min(F.y,U.y,Z.y,Y.y),_e=Math.max(F.x,U.x,Z.x,Y.x),Se=Math.max(F.y,U.y,Z.y,Y.y);const Ce=a/16;function le(Me,Re,et,Ye,it,dt){const Ct=(et+it)/2,tn=(Ye+dt)/2,qt=n.project(Ke(Ct),pt(tn)),Jt=Math.max(0,re-qt.x,he-qt.y,qt.x-_e,qt.y-Se);re=Math.min(re,qt.x),_e=Math.max(_e,qt.x),he=Math.min(he,qt.y),Se=Math.max(Se,qt.y),Jt>Ce&&(le(Me,qt,et,Ye,Ct,tn),le(qt,Re,Ct,tn,it,dt))}le(F,U,h,v,p,v),le(U,Z,p,v,p,x),le(Z,Y,p,x,h,x),le(Y,F,h,x,h,v),re-=Ce,he-=Ce,_e+=Ce,Se+=Ce;const Te=1/Math.max(_e-re,Se-he);return{scale:Te,x:re*Te,y:he*Te,x2:_e*Te,y2:Se*Te,projection:n}}function oD(c,{x:n,y:a},h=0){return new hn(((n-h)*c.scale-c.x)*fn,(a*c.scale-c.y)*fn)}const k$=te(new Float32Array(16));class lg{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,a){return{x:0,y:0,z:0}}unproject(n,a){return new we(0,0)}projectTilePoint(n,a,h){return{x:n,y:a,z:0}}locationPoint(n,a,h,p=!0){return n._coordinatePoint(n.locationCoordinate(a,h),p)}pixelsPerMeter(n,a){return qe(1,n)*a}pixelSpaceConversion(n,a,h){return 1}farthestPixelDistance(n){return rD(n,n.pixelsPerMeter)}pointCoordinate(n,a,h,p){const v=n.horizonLineFromTop(!1),x=new hn(a,Math.max(v,h));return n.rayIntersectionCoordinate(n.pointRayIntersection(x,p))}pointCoordinate3D(n,a,h){const p=new hn(a,h);if(n.elevation)return n.elevation.pointCoordinate(p);{const v=this.pointCoordinate(n,p.x,p.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(n,a){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,a.x,a.y);const h=n.horizonLineFromTop();return a.y<h}createInversionMatrix(n,a){return k$}createTileMatrix(n,a,h){let p,v,x;const E=h.canonical,O=te(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=B0(E,this);p=1,v=D.x+h.wrap*D.scale,x=D.y,ue(O,O,[p/D.scale,p/D.scale,n.pixelsPerMeter/a])}else p=a/n.zoomScale(E.z),v=(E.x+Math.pow(2,E.z)*h.wrap)*p,x=E.y*p;return de(O,O,[v,x,0]),ue(O,O,[p/fn,p/fn,1]),O}upVector(n,a,h){return[0,0,1]}upVectorScale(n,a,h){return{metersToTile:1}}}class N$ extends lg{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[a,h]=this.parallels=n.parallels||[29.5,45.5],p=Math.sin(Tt(a));this.n=(p+Math.sin(Tt(h)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(n,a){const{n:h,c:p,r0:v}=this,x=Tt(n-this.center[0]),E=Tt(a),O=Math.sqrt(p-2*h*Math.sin(E))/h;return{x:O*Math.sin(x*h),y:O*Math.cos(x*h)-v,z:0}}unproject(n,a){const{n:h,c:p,r0:v}=this,x=v+a;let E=Math.atan2(n,Math.abs(x))*Math.sign(x);x*h<0&&(E-=Math.PI*Math.sign(n)*Math.sign(x));const O=Tt(this.center[0])*h;E=nt(E,-Math.PI-O,Math.PI-O);const D=be(je(E/h)+this.center[0],-180,180),B=Math.asin(be((p-(n*n+x*x)*h*h)/(2*h),-1,1)),F=be(je(B),-85.051129,It);return new we(D,F)}}const j0=1.340264,F0=-.081106,U0=893e-6,V0=.003796,dw=Math.sqrt(3)/2;class B$ extends lg{project(n,a){a=a/180*Math.PI,n=n/180*Math.PI;const h=Math.asin(dw*Math.sin(a)),p=h*h,v=p*p*p;return{x:.5*(n*Math.cos(h)/(dw*(j0+3*F0*p+v*(7*U0+9*V0*p)))/Math.PI+.5),y:1-.5*(h*(j0+F0*p+v*(U0+V0*p))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,p=h*h,v=p*p*p;for(let B,F,U,Z=0;Z<12&&(F=h*(j0+F0*p+v*(U0+V0*p))-a,U=j0+3*F0*p+v*(7*U0+9*V0*p),B=F/U,h=be(h-B,-Math.PI/3,Math.PI/3),p=h*h,v=p*p*p,!(Math.abs(B)<1e-12));++Z);const x=dw*n*(j0+3*F0*p+v*(7*U0+9*V0*p))/Math.cos(h),E=Math.asin(Math.sin(h)/dw),O=be(180*x/Math.PI,-180,180),D=be(180*E/Math.PI,-85.051129,It);return new we(O,D)}}class j$ extends lg{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){return{x:.5+n/360,y:.5-a/360,z:0}}unproject(n,a){const h=360*(n-.5),p=be(360*(.5-a),-85.051129,It);return new we(h,p)}}const nv=Math.PI/2;function fw(c){return Math.tan((nv+c)/2)}class F$ extends lg{constructor(n){super(n),this.center=n.center||[0,30];const[a,h]=this.parallels=n.parallels||[30,30];let p=Tt(a),v=Tt(h);this.southernCenter=p+v<0,this.southernCenter&&(p=-p,v=-v);const x=Math.cos(p),E=fw(p);this.n=p===v?Math.sin(p):Math.log(x/Math.cos(v))/Math.log(fw(v)/E),this.f=x*Math.pow(fw(p),this.n)/this.n}project(n,a){a=Tt(a),this.southernCenter&&(a=-a),n=Tt(n-this.center[0]);const h=1e-6,{n:p,f:v}=this;v>0?a<-nv+h&&(a=-nv+h):a>nv-h&&(a=nv-h);const x=v/Math.pow(fw(a),p);let E=x*Math.sin(p*n),O=v-x*Math.cos(p*n);return E=.5*(E/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:E,y:this.southernCenter?O:1-O,z:0}}unproject(n,a){n=(2*n-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:h,f:p}=this,v=p-a,x=Math.sign(v),E=Math.sign(h)*Math.sqrt(n*n+v*v);let O=Math.atan2(n,Math.abs(v))*x;v*h<0&&(O-=Math.PI*Math.sign(n)*x);const D=be(je(O/h)+this.center[0],-180,180),B=be(je(2*Math.atan(Math.pow(p/E,1/h))-nv),-85.051129,It);return new we(D,this.southernCenter?-B:B)}}class aD extends lg{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,a){return{x:Fe(n),y:ke(a),z:0}}unproject(n,a){const h=Ke(n),p=pt(a);return new we(h,p)}}const sD=Tt(It);class U$ extends lg{project(n,a){const h=(a=Tt(a))*a,p=h*h;return{x:.5*((n=Tt(n))*(.8707-.131979*h+p*(p*(.003971*h-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+h*(.015085+p*(.028874*h-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,p=25,v=0,x=h*h;do{x=h*h;const D=x*x;v=(h*(1.007226+x*(.015085+D*(.028874*x-.044475-.005916*D)))-a)/(1.007226+x*(.045255+D*(.259866*x-.311325-.005916*11*D))),h=be(h-v,-sD,sD)}while(Math.abs(v)>1e-6&&--p>0);x=h*h;const E=be(je(n/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),O=je(h);return new we(E,O)}}const lD=Tt(It);class V$ extends lg{project(n,a){a=Tt(a),n=Tt(n);const h=Math.cos(a),p=2/Math.PI,v=Math.acos(h*Math.cos(n/2)),x=Math.sin(v)/v,E=.5*(n*p+2*h*Math.sin(n/2)/x)||0,O=.5*(a+Math.sin(a)/x)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(n,a){let h=n=(2*n-.5)*Math.PI,p=a=(2*(1-a)-1)*Math.PI,v=25;const x=1e-6;let E=0,O=0;do{const D=Math.cos(p),B=Math.sin(p),F=2*B*D,U=B*B,Z=D*D,Y=Math.cos(h/2),re=Math.sin(h/2),he=2*Y*re,_e=re*re,Se=1-Z*Y*Y,Ce=Se?1/Se:0,le=Se?Math.acos(D*Y)*Math.sqrt(1/Se):0,Te=.5*(2*le*D*re+2*h/Math.PI)-n,Me=.5*(le*B+p)-a,Re=.5*Ce*(Z*_e+le*D*Y*U)+1/Math.PI,et=Ce*(he*F/4-le*B*re),Ye=.125*Ce*(F*re-le*B*Z*he),it=.5*Ce*(U*Y+le*_e*D)+.5,dt=et*Ye-it*Re;E=(Me*et-Te*it)/dt,O=(Te*Ye-Me*Re)/dt,h=be(h-E,-Math.PI,Math.PI),p=be(p-O,-lD,lD)}while((Math.abs(E)>x||Math.abs(O)>x)&&--v>0);return new we(je(h),je(p))}}class cD extends lg{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Tt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){const{scale:h,cosPhi:p}=this;return{x:Tt(n)*p*h+.5,y:-Math.sin(Tt(a))/p*h+.5,z:0}}unproject(n,a){const{scale:h,cosPhi:p}=this,v=-(a-.5)/h,x=be(je((n-.5)/h)/p,-180,180),E=Math.asin(be(v*p,-1,1)),O=be(je(E),-85.051129,It);return new we(x,O)}}class $$ extends aD{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,a,h){const p=Gp(n,a,h);return Dt(p,p,Wf(nd(h))),{x:p[0],y:p[1],z:p[2]}}locationPoint(n,a,h){const p=se(a.lat,a.lng),v=ct([],p),x=h?n._centerAltitude+h:n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(a),n._centerAltitude):n._centerAltitude;Pt(p,p,v,qe(1,0)*fn*x);const E=te(new Float64Array(16));return ce(E,n.pixelMatrix,n.globeMatrix),Dt(p,p,E),new hn(p[0],p[1])}pixelsPerMeter(n,a){return qe(1,0)*a}pixelSpaceConversion(n,a,h){const p=qe(1,n)*a,v=Xn(qe(1,45)*a,p,h);return this.pixelsPerMeter(n,a)/v}createTileMatrix(n,a,h){const p=u0(nd(h.canonical));return ce(new Float64Array(16),n.globeMatrix,p)}createInversionMatrix(n,a){const{center:h}=n,p=Wf(nd(a));return Oe(p,p,Tt(h.lng)),Pe(p,p,Tt(h.lat)),ue(p,p,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(n,a,h,p){return Mb(n,a,h,!0)||new at(0,0)}pointCoordinate3D(n,a,h){const p=this.pointCoordinate(n,a,h,0);return[p.x,p.y,p.z]}isPointAboveHorizon(n,a){return!Mb(n,a.x,a.y,!1)}farthestPixelDistance(n){const a=function(p,v){const x=p.cameraToCenterDistance,E=p._centerAltitude*v,O=p._camera,D=p._camera.forward(),B=zt([],$e([],D,-x),[0,0,E]),F=p.worldSize/(2*Math.PI),U=[0,0,-F],Z=p.width/p.height,Y=Math.tan(p.fovAboveCenter),re=$e([],O.up(),Y),he=$e([],O.right(),Y*Z),_e=ct([],zt([],zt([],D,re),he)),Se=[];let Ce;if(new qr(B,_e).closestPointOnSphere(U,F,Se)){const le=zt([],Se,U),Te=ci([],le,B);Ce=Math.cos(p.fovAboveCenter)*yt(Te)}else{const le=ci([],B,U),Te=ci([],U,B);ct(Te,Te);const Me=yt(le)-F;Ce=Math.sqrt(Me*(Me+2*F));const Re=Math.acos(Ce/(F+Me))-Math.acos(kt(D,Te));Ce*=Math.cos(Re)}return 1.01*Ce}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),h=tf(n.zoom);if(h>0){const p=rD(n,qe(1,n.center.lat)*n.worldSize),v=n.worldSize/(2*Math.PI),x=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Xn(a,p+v*(1-Math.cos(x)),Math.pow(h,10))}return a}upVector(n,a,h){return Gp(a,h,n,1)}upVectorScale(n){return{metersToTile:Xo(id(nd(n)))}}}function uD(c){const n=c.parallels,a=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new aD(c);case"equirectangular":return new j$(c);case"naturalEarth":return new U$(c);case"equalEarth":return new B$(c);case"winkelTripel":return new V$(c);case"albers":return a?new cD(c):new N$(c);case"lambertConformalConic":return a?new cD(c):new F$(c);case"globe":return new $$(c)}throw new Error(`Invalid projection name: ${c.name}`)}const q$=xi.VectorTileFeature.types,H$=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pw(c,n,a,h,p,v,x,E,O,D,B,F,U){const Z=E?Math.min(sg,Math.round(E[0])):0,Y=E?Math.min(sg,Math.round(E[1])):0;c.emplaceBack(n,a,Math.round(32*h),Math.round(32*p),v,x,(Z<<1)+(O?1:0),Y,16*D,16*B,256*F,256*U)}function mw(c,n,a){c.emplaceBack(n,a)}function gw(c,n,a,h,p,v,x){c.emplaceBack(n,a,h,p,v,x)}const _w=(c,n,a,h)=>{for(let p=0;p<n;p++)c.emplaceBack(a[0],a[1],a[2],h[0],h[1],h[2])};function yw(c,n,a,h,p){c.emplaceBack(n,a,h,p),c.emplaceBack(n,a,h,p),c.emplaceBack(n,a,h,p),c.emplaceBack(n,a,h,p)}function G$(c){for(const n of c.sections)if(Zg(n.text))return!0;return!1}class K2{constructor(n){this.layoutVertexArray=new Wd,this.indexArray=new ra,this.programConfigurations=n,this.segments=new wo,this.dynamicLayoutVertexArray=new Ta,this.opacityVertexArray=new Yd,this.placedSymbolArray=new n_,this.iconTransitioningVertexArray=new Es,this.globeExtVertexArray=new Xd,this.zOffsetVertexArray=new Jc,this.orientationVertexArray=new zp}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,a,h,p,v){this.isEmpty()||(h&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,r$.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,a$.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,H$,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,c$.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,o$.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||v)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,s$.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=n.createVertexBuffer(this.orientationVertexArray,l$.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Nn(K2,"SymbolBuffers");class J2{constructor(n,a,h){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new h,this.segments=new wo,this.collisionVertexArray=new vc,this.collisionVertexArrayExt=new Ta}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,u$.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,h$.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Nn(J2,"CollisionBuffers");class vw{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=te([]),this.placementViewportMatrix=te([]);const a=this.layers[0]._unevaluatedLayout._values;this.worldview=n.worldview,this.textSizeData=jI(this.zoom,a["text-size"],this.worldview),this.iconSizeData=jI(this.zoom,a["icon-size"],this.worldview);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),v=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(x=>ru[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new K2(new m(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new K2(new m(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new jm,this.lineVertexArray=new i_,this.symbolInstances=new Us}calculateGlyphDependencies(n,a,h,p,v){for(const x of n){const E=x.codePointAt(0);if(E===void 0)break;if(a[E]=!0,p&&v&&E<=65535){const O=R0[x];O&&(a[O.charCodeAt(0)]=!0)}}}updateFootprints(n,a){}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!ng(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(n,a,h,p){const v=this.layers[0],x=v.layout,E=this.projection.name==="globe",O=x.get("text-font"),D=x.get("text-field"),B=x.get("icon-image"),[F,U]=x.get("icon-size-scale-range"),Z=be(a.scaleFactor||1,F,U),Y=(D.value.kind!=="constant"||D.value.value instanceof is&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),re=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,he=x.get("symbol-sort-key");if(this.features=[],!Y&&!re)return;const _e=a.iconDependencies,Se=a.glyphDependencies,Ce=a.availableImages,le=new Mr(this.zoom,{worldview:this.worldview});for(const{feature:Te,id:Me,index:Re,sourceLayerIndex:et}of n){const Ye=v._featureFilter.needGeometry,it=On(Te,Ye);if(!v._featureFilter.filter(le,it,h))continue;if(Ye||(it.geometry=Dn(Te,h,p)),E&&Te.type!==1&&h.z<=5){const Jt=it.geometry,sn=.98078528056,Ot=(Yt,At)=>kt(Gp(Yt.x,Yt.y,h,1),Gp(At.x,At.y,h,1))<sn;for(let Yt=0;Yt<Jt.length;Yt++)Jt[Yt]=pn(Jt[Yt],Ot)}let dt,Ct;if(Y){const Jt=v.getValueAndResolveTokens("text-field",it,h,Ce),sn=is.factory(Jt);G$(sn)&&(this.hasRTLText=!0),(!this.hasRTLText||Vd()==="unavailable"||this.hasRTLText&&Au.isParsed())&&(dt=f$(sn,v,it))}if(re){const Jt=v.getValueAndResolveTokens("icon-image",it,h,Ce);Ct=typeof Jt=="string"?Ha.build(Jt):Jt}if(!dt&&!Ct)continue;const tn=this.sortFeaturesByKey?he.evaluate(it,{},h):void 0,qt={id:Me,text:dt,icon:Ct,index:Re,sourceLayerIndex:et,geometry:it.geometry,properties:Te.properties,type:q$[Te.type],sortKey:tn};if(this.features.push(qt),Ct){const Jt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:sn,iconSecondary:Ot}=eD(Ct,this.iconSizeData,Jt["icon-size"],h,this.zoom,qt,this.pixelRatio,Z,this.worldview),Yt=sn.id.toString();if(_e.has(Yt)?_e.get(Yt).push(sn):_e.set(Yt,[sn]),Ot){const At=Ot.id.toString();_e.has(At)?_e.get(At).push(Ot):_e.set(At,[Ot])}}if(dt){const Jt=O.evaluate(it,{},h).join(","),sn=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ru.vertical)>=0;for(const Ot of dt.sections)if(Ot.image){const Yt=Ot.image.getPrimary().scaleSelf(this.pixelRatio),At=Yt.id.toString(),Mt=_e.get(At)||[];Mt.push(Yt),_e.set(At,Mt)}else{const Yt=wa(dt.toString()),At=Ot.fontStack||Jt,Mt=Se[At]=Se[At]||{};this.calculateGlyphDependencies(Ot.text,Mt,sn,this.allowVerticalPlacement,Yt)}}}if(x.get("symbol-placement")==="line"&&(this.features=function(Te){const Me={},Re={},et=[];let Ye=0;function it(qt){et.push(Te[qt]),Ye++}function dt(qt,Jt,sn){const Ot=Re[qt];return delete Re[qt],Re[Jt]=Ot,et[Ot].geometry[0].pop(),et[Ot].geometry[0]=et[Ot].geometry[0].concat(sn[0]),Ot}function Ct(qt,Jt,sn){const Ot=Me[Jt];return delete Me[Jt],Me[qt]=Ot,et[Ot].geometry[0].shift(),et[Ot].geometry[0]=sn[0].concat(et[Ot].geometry[0]),Ot}function tn(qt,Jt,sn){const Ot=sn?Jt[0][Jt[0].length-1]:Jt[0][0];return`${qt}:${Ot.x}:${Ot.y}`}for(let qt=0;qt<Te.length;qt++){const Jt=Te[qt],sn=Jt.geometry,Ot=Jt.text?Jt.text.toString():null;if(!Ot){it(qt);continue}const Yt=tn(Ot,sn),At=tn(Ot,sn,!0);if(Yt in Re&&At in Me&&Re[Yt]!==Me[At]){const Mt=Ct(Yt,At,sn),dn=dt(Yt,At,et[Mt].geometry);delete Me[Yt],delete Re[At],Re[tn(Ot,et[dn].geometry,!0)]=dn,et[Mt].geometry=null}else Yt in Re?dt(Yt,At,sn):At in Me?Ct(Yt,At,sn):(it(qt),Me[Yt]=Ye-1,Re[At]=Ye-1)}return et.filter(qt=>qt.geometry)}(this.features)),x.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",a.elevationFeatures){!this.elevationFeatures&&a.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Te of a.elevationFeatures)this.elevationFeatureIdToIndex.set(Te.id,this.elevationFeatures.length),this.elevationFeatures.push(Te)}}else x.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Te,Me)=>Te.sortKey-Me.sortKey)}update(n,a,h,p,v,x,E){this.text.programConfigurations.updatePaintArrays(n,a,v,h,p,x,E,this.worldview),this.icon.programConfigurations.updatePaintArrays(n,a,v,h,p,x,E,this.worldview)}updateRoadElevation(n){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let a=!1;const h=Et(n),p=1/h;let v=!1,x=!1;for(let E=0;E<this.symbolInstances.length;E++){const O=this.symbolInstances.get(E),D=ot(1,0,0),B=ot(0,1,0),{numHorizontalGlyphVertices:F,numVerticalGlyphVertices:U,numIconVertices:Z,numVerticalIconVertices:Y}=O,re=F>0||U>0,he=Z>0,_e=this.elevationFeatures[O.elevationFeatureIndex];if(_e){const Se=new hn(O.tileAnchorX,O.tileAnchorY),Ce=.075+_e.pointElevation(Se);O.zOffset!==Ce&&(a=!0,O.zOffset=Ce);const le=_e.computeSlopeNormal(Se,p),Te=bl(Yr(),ot(0,0,1),le);ai(D,D,Te),ai(B,B,Te),D[2]*=h,B[2]*=h,D[0]===1&&D[1]===0&&D[2]===0&&B[0]===0&&B[1]===1&&B[2]===0||(v=v||re,x=x||he)}if(re&&(_w(this.text.orientationVertexArray,F,D,B),_w(this.text.orientationVertexArray,U,D,B)),he){const{placedIconSymbolIndex:Se,verticalPlacedIconSymbolIndex:Ce}=O;Se>=0&&_w(this.icon.orientationVertexArray,Z,D,B),Ce>=0&&_w(this.icon.orientationVertexArray,Y,D,B)}}v||(this.text.orientationVertexArray=void 0),x||(this.icon.orientationVertexArray=void 0),a&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const n=(v,x,E)=>{h+=x,h>v.length&&v.resize(h);for(let O=-x;O<0;O++)v.emplace(O+h,E)},a=(v,x,E)=>{p+=x,p>v.length&&v.resize(p);for(let O=-x;O<0;O++)v.emplace(O+p,E)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,p=0;for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:O,numIconVertices:D}=x,B=x.zOffset,F=D>0;if((E>0||O>0)&&(n(this.text.zOffsetVertexArray,E,B),n(this.text.zOffsetVertexArray,O,B)),F){const{placedIconSymbolIndex:U,verticalPlacedIconSymbolIndex:Z}=x;U>=0&&a(this.icon.zOffsetVertexArray,D,B),Z>=0&&a(this.icon.zOffsetVertexArray,x.numVerticalIconVertices,B)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=uD(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const h=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:p,y:v}of a)this.lineVertexArray.emplaceBack(p,v);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re,he){const _e=n.indexArray,Se=n.layoutVertexArray,Ce=n.globeExtVertexArray,le=n.segments.prepareSegment(4*a.length,Se,_e,this.canOverlap?x.sortKey:void 0),Te=this.glyphOffsetArray.length,Me=le.vertexLength,Re=this.allowVerticalPlacement&&E===ru.vertical?Math.PI/2:0,et=x.text&&x.text.sections;for(let it=0;it<a.length;it++){const{tl:dt,tr:Ct,bl:tn,br:qt,texPrimary:Jt,texSecondary:sn,pixelOffsetTL:Ot,pixelOffsetBR:Yt,minFontScaleX:At,minFontScaleY:Mt,glyphOffset:dn,isSDF:gn,sectionIndex:oi}=a[it],Zn=le.vertexLength,Sn=dn[1];if(pw(Se,D.x,D.y,dt.x,Sn+dt.y,Jt.x,Jt.y,h,gn,Ot.x,Ot.y,At,Mt),pw(Se,D.x,D.y,Ct.x,Sn+Ct.y,Jt.x+Jt.w,Jt.y,h,gn,Yt.x,Ot.y,At,Mt),pw(Se,D.x,D.y,tn.x,Sn+tn.y,Jt.x,Jt.y+Jt.h,h,gn,Ot.x,Yt.y,At,Mt),pw(Se,D.x,D.y,qt.x,Sn+qt.y,Jt.x+Jt.w,Jt.y+Jt.h,h,gn,Yt.x,Yt.y,At,Mt),O){const{x:un,y:bi,z:Gn}=O.anchor,[Wn,mi,Ci]=O.up;gw(Ce,un,bi,Gn,Wn,mi,Ci),gw(Ce,un,bi,Gn,Wn,mi,Ci),gw(Ce,un,bi,Gn,Wn,mi,Ci),gw(Ce,un,bi,Gn,Wn,mi,Ci),yw(n.dynamicLayoutVertexArray,un,bi,Gn,Re)}else yw(n.dynamicLayoutVertexArray,D.x,D.y,D.z,Re);if(he){const un=sn||Jt;mw(n.iconTransitioningVertexArray,un.x,un.y),mw(n.iconTransitioningVertexArray,un.x+un.w,un.y),mw(n.iconTransitioningVertexArray,un.x,un.y+un.h),mw(n.iconTransitioningVertexArray,un.x+un.w,un.y+un.h)}_e.emplaceBack(Zn,Zn+1,Zn+2),_e.emplaceBack(Zn+1,Zn+2,Zn+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(dn[0]),it!==a.length-1&&oi===a[it+1].sectionIndex||n.programConfigurations.populatePaintArrays(Se.length,x,x.index,{},Z,Y,re,et&&et[oi],this.worldview)}const Ye=O?O.anchor:D;n.placedSymbolArray.emplaceBack(Ye.x,Ye.y,Ye.z,D.x,D.y,Te,this.glyphOffsetArray.length-Te,Me,B,F,D.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],E,0,0,0,U,0)}_commitLayoutVertex(n,a,h,p,v,x,E){n.emplaceBack(a,h,p,v,x,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,a,h,p,v,x,E){const O=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),D=O.vertexLength,B=E.tileAnchorX,F=E.tileAnchorY;for(let Z=0;Z<4;Z++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,a,n.padding,E.zOffset),this._commitLayoutVertex(h.layoutVertexArray,p,v,x,B,F,new hn(n.x1,n.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,v,x,B,F,new hn(n.x2,n.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,v,x,B,F,new hn(n.x2,n.y2)),this._commitLayoutVertex(h.layoutVertexArray,p,v,x,B,F,new hn(n.x1,n.y2)),O.vertexLength+=4;const U=h.indexArray;U.emplaceBack(D,D+1),U.emplaceBack(D+1,D+2),U.emplaceBack(D+2,D+3),U.emplaceBack(D+3,D),O.primitiveLength+=4}_addTextDebugCollisionBoxes(n,a,h,p,v,x){for(let E=p;E<v;E++){const O=h.get(E),D=this.getSymbolInstanceTextSize(n,x,a,E);this._addCollisionDebugVertices(O,D,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(n,a,h,p,v,x){for(let E=p;E<v;E++){const O=h.get(E),D=this.getSymbolInstanceIconSize(n,a,x.placedIconSymbolIndex);this._addCollisionDebugVertices(O,D,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,x)}}generateCollisionDebugBuffers(n,a,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new J2(eu,EI.members,Es),this.iconCollisionBox=new J2(eu,EI.members,Es);const p=z0(this.iconSizeData,n),v=z0(this.textSizeData,n,h);for(let x=0;x<this.symbolInstances.length;x++){const E=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(v,n,a,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(v,n,a,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,n,a,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,n,a,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(n,a,h,p){const v=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:p),x=q2(this.textSizeData,n,v)/Vs;return this.tilePixelRatio*x}getSymbolInstanceIconSize(n,a,h){const p=this.icon.placedSymbolArray.get(h),v=q2(this.iconSizeData,n,p);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(n,a,h,p){n.emplaceBack(a,-h,-h,p),n.emplaceBack(a,h,-h,p),n.emplaceBack(a,h,h,p),n.emplaceBack(a,-h,h,p)}_updateTextDebugCollisionBoxes(n,a,h,p,v,x,E){for(let O=p;O<v;O++){const D=h.get(O),B=this.getSymbolInstanceTextSize(n,x,a,O);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,B,D.padding,x.zOffset)}}_updateIconDebugCollisionBoxes(n,a,h,p,v,x,E){for(let O=p;O<v;O++){const D=h.get(O),B=this.getSymbolInstanceIconSize(n,a,x.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,B,D.padding,x.zOffset)}}updateCollisionDebugBuffers(n,a,h,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const v=z0(this.iconSizeData,n,p),x=z0(this.textSizeData,n,h);for(let E=0;E<this.symbolInstances.length;E++){const O=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(x,n,a,O.textBoxStartIndex,O.textBoxEndIndex,O,h),this._updateTextDebugCollisionBoxes(x,n,a,O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,h),this._updateIconDebugCollisionBoxes(v,n,a,O.iconBoxStartIndex,O.iconBoxEndIndex,O,p),this._updateIconDebugCollisionBoxes(v,n,a,O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,a,h,p,v,x,E,O,D){const B={};if(a<h){const{x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le,featureIndex:Te}=n.get(a);B.textBox={x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le},B.textFeatureIndex=Te}if(p<v){const{x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le,featureIndex:Te}=n.get(p);B.verticalTextBox={x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le},B.verticalTextFeatureIndex=Te}if(x<E){const{x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le,featureIndex:Te}=n.get(x);B.iconBox={x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le},B.iconFeatureIndex=Te}if(O<D){const{x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le,featureIndex:Te}=n.get(O);B.verticalIconBox={x1:F,y1:U,x2:Z,y2:Y,padding:re,projectedAnchorX:he,projectedAnchorY:_e,projectedAnchorZ:Se,tileAnchorX:Ce,tileAnchorY:le},B.verticalIconFeatureIndex=Te}return B}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,a){const h=n.placedSymbolArray.get(a),p=h.vertexStartIndex+4*h.numGlyphs;for(let v=h.vertexStartIndex;v<p;v+=4)n.indexArray.emplaceBack(v,v+1,v+2),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),h=Math.cos(n),p=[],v=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const O=this.symbolInstances.get(E);p.push(0|Math.round(a*O.tileAnchorX+h*O.tileAnchorY)),v.push(O.featureIndex)}return x.sort((E,O)=>p[E]-p[O]||v[O]-v[E]),x}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:D}=h;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&x!==v&&x!==p&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hD,dD,Q2;Nn(vw,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),vw.addDynamicAttributes=yw;class fD{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:cu,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nn(fD,"FormatSectionOverride",{omit:["defaultValue"]});const eS=()=>Q2||(Q2={layout:hD||(hD=new bo({"symbol-placement":new an(ft.layout_symbol["symbol-placement"]),"symbol-spacing":new an(ft.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new an(ft.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bn(ft.layout_symbol["symbol-sort-key"]),"symbol-z-order":new an(ft.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new an(ft.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new an(ft.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new an(ft.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new an(ft.layout_symbol["icon-ignore-placement"]),"icon-optional":new an(ft.layout_symbol["icon-optional"]),"icon-rotation-alignment":new an(ft.layout_symbol["icon-rotation-alignment"]),"icon-size":new bn(ft.layout_symbol["icon-size"]),"icon-size-scale-range":new an(ft.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new bn(ft.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bn(ft.layout_symbol["icon-text-fit-padding"]),"icon-image":new bn(ft.layout_symbol["icon-image"]),"icon-rotate":new bn(ft.layout_symbol["icon-rotate"]),"icon-padding":new an(ft.layout_symbol["icon-padding"]),"icon-keep-upright":new an(ft.layout_symbol["icon-keep-upright"]),"icon-offset":new bn(ft.layout_symbol["icon-offset"]),"icon-anchor":new bn(ft.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new an(ft.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new an(ft.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new an(ft.layout_symbol["text-rotation-alignment"]),"text-field":new bn(ft.layout_symbol["text-field"]),"text-font":new bn(ft.layout_symbol["text-font"]),"text-size":new bn(ft.layout_symbol["text-size"]),"text-size-scale-range":new an(ft.layout_symbol["text-size-scale-range"]),"text-max-width":new bn(ft.layout_symbol["text-max-width"]),"text-line-height":new bn(ft.layout_symbol["text-line-height"]),"text-letter-spacing":new bn(ft.layout_symbol["text-letter-spacing"]),"text-justify":new bn(ft.layout_symbol["text-justify"]),"text-radial-offset":new bn(ft.layout_symbol["text-radial-offset"]),"text-variable-anchor":new an(ft.layout_symbol["text-variable-anchor"]),"text-anchor":new bn(ft.layout_symbol["text-anchor"]),"text-max-angle":new an(ft.layout_symbol["text-max-angle"]),"text-writing-mode":new an(ft.layout_symbol["text-writing-mode"]),"text-rotate":new bn(ft.layout_symbol["text-rotate"]),"text-padding":new an(ft.layout_symbol["text-padding"]),"text-keep-upright":new an(ft.layout_symbol["text-keep-upright"]),"text-transform":new bn(ft.layout_symbol["text-transform"]),"text-offset":new bn(ft.layout_symbol["text-offset"]),"text-allow-overlap":new an(ft.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new an(ft.layout_symbol["text-ignore-placement"]),"text-optional":new an(ft.layout_symbol["text-optional"]),visibility:new an(ft.layout_symbol.visibility)})),paint:dD||(dD=new bo({"icon-opacity":new bn(ft.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new bn(ft.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new bn(ft.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new bn(ft.paint_symbol["text-emissive-strength"]),"icon-color":new bn(ft.paint_symbol["icon-color"]),"icon-halo-color":new bn(ft.paint_symbol["icon-halo-color"]),"icon-halo-width":new bn(ft.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bn(ft.paint_symbol["icon-halo-blur"]),"icon-translate":new an(ft.paint_symbol["icon-translate"]),"icon-translate-anchor":new an(ft.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new an(ft.paint_symbol["icon-image-cross-fade"]),"text-opacity":new bn(ft.paint_symbol["text-opacity"]),"text-occlusion-opacity":new bn(ft.paint_symbol["text-occlusion-opacity"]),"text-color":new bn(ft.paint_symbol["text-color"],{runtimeType:cl,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new bn(ft.paint_symbol["text-halo-color"]),"text-halo-width":new bn(ft.paint_symbol["text-halo-width"]),"text-halo-blur":new bn(ft.paint_symbol["text-halo-blur"]),"text-translate":new an(ft.paint_symbol["text-translate"]),"text-translate-anchor":new an(ft.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new an(ft.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new an(ft.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new an(ft.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new an(ft.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new bn(ft.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},Q2);class xw extends Fs{constructor(n,a,h,p){super(n,eS(),a,h,p),this._colorAdjustmentMatrix=te([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,a){super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const v of h)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,a,h,p){return this._saturation===n&&this._contrast===a&&this._brightnessMin===h&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(v,x,E,O){v=hr(v),x=Zo(x);const D=J(),B=v/3,F=1-2*B,U=[F,B,B,0,B,F,B,0,B,B,F,0,0,0,0,1],Z=.5-.5*x,Y=O-E;return ce(D,[Y,0,0,0,0,Y,0,0,0,0,Y,0,E,E,E,1],[x,0,0,0,0,x,0,0,0,0,x,0,Z,Z,Z,1]),ce(D,D,U),D}(n,a,h,p),this._saturation=n,this._contrast=a,this._brightnessMin=h,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,a,h,p){const v=this.layout.get(n).evaluate(a,{},h,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||Ra(x.value)||!v?v:function(E,O){return O.replace(/{([^{}]+)}/g,(D,B)=>B in E?String(E[B]):"")}(a.properties,v)}createBucket(n){return new vw(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of eS().paint.overridableProperties){if(!xw.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),h=new fD(a),p=new xo(h,a.property.specification,this.scope,this.options);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new xu("source",p):new Xc("composite",p,a.value.zoomStops,a.value.interpolationType),this.paint._values[n]=new $d(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&xw.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const h=n.get("text-field"),p=eS().paint.properties[a];let v=!1;const x=E=>{for(const O of E)if(p.overrides&&p.overrides.hasOverride(O))return void(v=!0)};if(h.value.kind==="constant"&&h.value.value instanceof is)x(h.value.value.sections);else if(h.value.kind==="source"){const E=D=>{v||(D instanceof di&&Tn(D.value)===Ih?x(D.value.sections):D instanceof jc?x(D.sections):D.eachChild(E))},O=h.value;O._styleExpression&&E(O._styleExpression.expression)}return v}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,a,h){return{config:new Cl(this,{zoom:a,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let pD,mD,gD,_D;var tS=ar([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function nS(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function iS(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class rS{constructor(n,a,h,p){this.context=n,this.format=h,this.useMipmap=p&&p.useMipmap,this.texture=n.gl.createTexture(),this.update(a,{premultiply:p&&p.premultiply})}update(n,a){const h=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,p=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:v}=this,{gl:x}=v,{x:E,y:O}=a&&a.position?a.position:{x:0,y:0},D=E+h,B=O+p;!this.size||this.size[0]===D&&this.size[1]===B||(x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(this.texture),this.texture=x.createTexture(),this.size=null),x.bindTexture(x.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA8&&(!a||a.premultiply!==!1));const F=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&D>0&&B>0){const U=this.useMipmap?Math.floor(Math.log2(Math.max(D,B)))+1:1;x.texStorage2D(x.TEXTURE_2D,U,this.format,D,B),this.size=[D,B]}if(this.size)if(F)x.texSubImage2D(x.TEXTURE_2D,0,E,O,nS(this.format),iS(this.format),n);else{const U=n.data;U&&x.texSubImage2D(x.TEXTURE_2D,0,E,O,h,p,nS(this.format),iS(this.format),U)}this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(n,a,h=!1){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap&&!h?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),a!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,a),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(n,a,h,p,v){const{context:x}=this,{gl:E}=x;E.bindTexture(E.TEXTURE_2D,this.texture),a!==this.magFilter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,a),this.magFilter=a),n!==this.minFilter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,this.useMipmap?n===E.NEAREST?E.NEAREST_MIPMAP_NEAREST:E.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),h!==this.wrapS&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,h),this.wrapS=h),p!==this.wrapT&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,p),this.wrapT=p),v!==this.compareMode&&(v?(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_COMPARE_MODE,E.COMPARE_REF_TO_TEXTURE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_COMPARE_FUNC,v)):E.texParameteri(E.TEXTURE_2D,E.TEXTURE_COMPARE_MODE,E.NONE),this.compareMode=v)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class bw{constructor(n,a){this.context=n,this.texture=a}bind(n,a){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),n!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,n),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,n),this.minFilter=n),a!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,a),this.wrapS=a)}}function ww(c,n,a,h,p,v,x,E){const O=[c,n,1,a,h,1,p,v,1],D=[x,E,1],B=q([],O),[F,U,Z]=jn(D,D,B);return K(O,O,[F,0,0,0,U,0,0,0,Z])}function yD(c,n,a,h,p,v,x,E){const O=function(D,B,F,U,Z,Y,re,he){const _e=ww(0,0,1,0,1,1,0,1),Se=ww(D,B,F,U,Z,Y,re,he);return K(Se,Se,q([],_e))}(c,n,a,h,p,v,x,E);return[O[2]/O[8]/fn,O[5]/O[8]/fn]}function Tw(c){return[c[0],Math.min(Math.max(c[1],-85.051129),It)]}class vD extends Fo{constructor(n,a,h,p){super(),this.id=n,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=a,this._dirty=!1}load(n,a){if(this._loaded=a||!1,this.fire(new qn("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=No(this.map._requestManager.transformRequest(this.url,Sr.Image),(h,p)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new oo(h)):p&&(this.image=p instanceof HTMLImageElement?xs.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new bw(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new qn("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof bw||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=n[0][1],h=n[0][1];for(const v of n)v[1]>h&&(h=v[1]),v[1]<a&&(a=v[1]);const p=(h+a)/2;if(p>It?this.onNorthPole=!0:p<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const v=n.map(at.fromLngLat);this.tileID=function(x){let E=1/0,O=1/0,D=-1/0,B=-1/0;for(const re of x)E=Math.min(E,re.x),O=Math.min(O,re.y),D=Math.max(D,re.x),B=Math.max(B,re.y);const F=Math.max(D-E,B-O),U=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),Z=Math.pow(2,U);let Y=Math.floor((E+D)/2*Z);return Y>1&&(Y-=1),new Zf(U,Y,Math.floor((O+B)/2*Z))}(v),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new qn("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const _e in this.tiles){const Se=this.tiles[_e];Se.state!=="loaded"&&(Se.state="loaded",Se.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=B0(new Zf(0,0,0),this.map.transform.projection),h=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(_e){const Se=_e[1].x-_e[0].x,Ce=_e[1].y-_e[0].y,le=_e[2].x-_e[1].x,Te=_e[2].y-_e[1].y,Me=_e[3].x-_e[2].x,Re=_e[3].y-_e[2].y,et=_e[0].x-_e[3].x,Ye=_e[0].y-_e[3].y,it=Se*Te-le*Ce,dt=le*Re-Me*Te,Ct=Me*Ye-et*Re,tn=et*Ce-Se*Ye;return it>0&&dt>0&&Ct>0&&tn>0||it<0&&dt<0&&Ct<0&&tn<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=B0(this.tileID,this.map.transform.projection),[v,x,E,O]=this.coordinates.map(_e=>{const Se=p.projection.project(_e[0],_e[1]);return oD(p,Se)._round()});this.perspectiveTransform=yD(v.x,v.y,x.x,x.y,E.x,E.y,O.x,O.y);const D=this._boundsArray=new Gd;D.emplaceBack(v.x,v.y,0,0),D.emplaceBack(x.x,x.y,fn,0),D.emplaceBack(O.x,O.y,0,fn),D.emplaceBack(E.x,E.y,fn,fn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(D,tS.members),this.boundsSegments=wo.simpleSegment(0,0,4,2);const B=[],F=[Tw((U=this.coordinates)[0]),Tw(U[1]),Tw(U[2]),Tw(U[3])];var U;const[Z,Y,re,he]=function(_e){let Se=_e[0][0],Ce=Se,le=_e[0][1],Te=le;for(let Me=1;Me<_e.length;Me++)_e[Me][0]<Se?Se=_e[Me][0]:_e[Me][0]>Ce&&(Ce=_e[Me][0]),_e[Me][1]<le?le=_e[Me][1]:_e[Me][1]>Te&&(Te=_e[Me][1]);return[Se,le,Ce-Se,Te-le]}(F);{const _e=new Gd,[Se,Ce,le,Te]=function(Ot){let Yt=Ot[0].x,At=Yt,Mt=Ot[0].y,dn=Mt;for(let gn=1;gn<Ot.length;gn++)Ot[gn].x<Yt?Yt=Ot[gn].x:Ot[gn].x>At&&(At=Ot[gn].x),Ot[gn].y<Mt?Mt=Ot[gn].y:Ot[gn].y>dn&&(dn=Ot[gn].y);return[Yt,Mt,At-Yt,dn-Mt]}(h),Me=Ot=>[(Ot.x-Se)/le,(Ot.y-Ce)/Te],[Re,et,Ye,it]=h.map(Me),dt=function(Ot,Yt,At,Mt,dn,gn,oi,Zn){const Sn=ww(0,0,1,0,1,1,0,1);return K(Sn,Sn,q([],ww(Ot,Yt,At,Mt,dn,gn,oi,Zn)))}(Re[0],Re[1],et[0],et[1],Ye[0],Ye[1],it[0],it[1]);this.elevatedGlobePerspectiveTransform=yD(Re[0],Re[1],et[0],et[1],Ye[0],Ye[1],it[0],it[1]);const Ct=(Ot,Yt)=>{B.push(Ot.lng);const At=Math.round((Ot.lng-Z)/re*fn),Mt=Math.round((Ot.lat-Y)/he*fn),dn=Me(Yt),gn=jn([],[dn[0],dn[1],1],dt),oi=Math.round(gn[0]/gn[2]*fn),Zn=Math.round(gn[1]/gn[2]*fn);_e.emplaceBack(At,Mt,oi,Zn)},tn=h[3].x-h[0].x,qt=h[3].y-h[0].y,Jt=h[2].x-h[1].x,sn=h[2].y-h[1].y;for(let Ot=0;Ot<65;Ot++){const Yt=Ot/64,At=[h[0].x+Yt*tn,h[0].y+Yt*qt],Mt=[h[1].x+Yt*Jt,h[1].y+Yt*sn],dn=Mt[0]-At[0],gn=Mt[1]-At[1];for(let oi=0;oi<65;oi++){const Zn=oi/64,Sn={x:At[0]+dn*Zn,y:At[1]+gn*Zn};Ct(a.projection.unproject(Sn.x,Sn.y),Sn)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(_e,tS.members)}{this.maxLongitudeTriangleSize=0;let _e=[],Se=new ra;const Ce=(le,Te,Me)=>{Se.emplaceBack(le,Te,Me);const Re=B[le],et=B[Te],Ye=B[Me],it=Math.min(Math.min(Re,et),Ye),dt=Math.max(Math.max(Re,et),Ye)-it;dt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=dt),_e.push(it+dt/2)};for(let le=0;le<64;le++)for(let Te=0;Te<64;Te++){const Me=65*le+Te,Re=Me+1,et=Me+65,Ye=et+1;Ce(Me,et,Re),Ce(Re,et,Ye)}[_e,Se]=function(le,Te){const Me=Array.from({length:le.length},(Ye,it)=>it);Me.sort((Ye,it)=>le[Ye]-le[it]);const Re=[],et=new ra;for(let Ye=0;Ye<Me.length;Ye++){const it=Me[Ye];Re.push(le[it]);const dt=3*it,Ct=dt+1;et.emplaceBack(Te.uint16[dt],Te.uint16[Ct],Te.uint16[Ct+1])}return[Re,et]}(_e,Se),this.elevatedGlobeTrianglesCenterLongitudes=_e,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(Se)}this.elevatedGlobeSegments=wo.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,re/fn,0,he/fn,0,0,Y,Z,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const a=this.map.painter.context,h=a.gl;!this._dirty||this.texture instanceof bw||(this.texture?this.texture.update(this.image):(this.texture=new rS(a,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(a)}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let p=(v=n+180)+360*Math.round((h[0]-v)/360);var v;const x=new wo,E=(F,U)=>{x.segments.push({vertexOffset:0,primitiveOffset:F,vertexLength:a.segments[0].vertexLength,primitiveLength:U,sortKey:void 0,vaos:{}})},O=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-p)<=O){const F=Nr(h,0,h.length,p+O);return F===h.length||E(F,rr(h,F+1,h.length,p+360-O)-F),x}p<h[0]&&(p+=360);const D=rr(h,0,h.length,p-O);if(D===h.length)return E(0,h.length),x;E(0,D-0);const B=Nr(h,D+1,h.length,p+O);return B!==h.length&&E(B,h.length-B),x}}const Z$=(Math.pow(256,2)-1)/16907520;class xD extends Fs{constructor(n,a,h,p){super(n,{layout:gD||(gD=new bo({visibility:new an(ft.layout_raster.visibility)})),paint:_D||(_D=new bo({"raster-opacity":new an(ft.paint_raster["raster-opacity"]),"raster-color":new Cu(ft.paint_raster["raster-color"]),"raster-color-mix":new an(ft.paint_raster["raster-color-mix"]),"raster-color-range":new an(ft.paint_raster["raster-color-range"]),"raster-hue-rotate":new an(ft.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new an(ft.paint_raster["raster-brightness-min"]),"raster-brightness-max":new an(ft.paint_raster["raster-brightness-max"]),"raster-saturation":new an(ft.paint_raster["raster-saturation"]),"raster-contrast":new an(ft.paint_raster["raster-contrast"]),"raster-resampling":new an(ft.paint_raster["raster-resampling"]),"raster-fade-duration":new an(ft.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new an(ft.paint_raster["raster-emissive-strength"]),"raster-array-band":new an(ft.paint_raster["raster-array-band"]),"raster-elevation":new an(ft.paint_raster["raster-elevation"]),"raster-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},a,h,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof vD&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const a=this._transitionablePaint._values["raster-color"].value.expression,[h,p]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(p)||h===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=f_({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,p])}}let bD,wD,TD,SD,ED;class AD extends Fs{constructor(n,a,h,p){super(n,{layout:bD||(bD=new bo({visibility:new an(ft["layout_raster-particle"].visibility)})),paint:wD||(wD=new bo({"raster-particle-array-band":new an(ft["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new an(ft["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Cu(ft["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new an(ft["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new an(ft["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new an(ft["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new an(ft["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new an(ft["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},a,h,p),this._updateColorRamp(),this.lastInvalidatedAt=xs.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,a=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=f_({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:a}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=xs.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class W$ extends Fs{constructor(n,a){super(n,{},a,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(n){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function oS(c,n,a){const h=[0,0,1],p=go([]);return ya(p,p,a?-Tt(c)+Math.PI:Tt(c)),_a(p,p,-Tt(n)),ai(h,h,p),ct(h,h)}function PD(c,n){const a=Sw(c.projection,c.zoom,c.width,c.height),h=function(v,x,E,O,D){const B=new we(E.lng-180*cg,E.lat),F=new we(E.lng+180*cg,E.lat),U=v.project(B.lng,B.lat),Z=v.project(F.lng,F.lat),Y=-Math.atan2(Z.y-U.y,Z.x-U.x),re=at.fromLngLat(E);re.y=be(re.y,-1+cg,1-cg);const he=re.toLngLat(),_e=v.project(he.lng,he.lat),Se=at.fromLngLat(he);Se.x+=cg;const Ce=Se.toLngLat(),le=v.project(Ce.lng,Ce.lat),Te=MD(le.x-_e.x,le.y-_e.y,Y),Me=at.fromLngLat(he);Me.y+=cg;const Re=Me.toLngLat(),et=v.project(Re.lng,Re.lat),Ye=MD(et.x-_e.x,et.y-_e.y,Y),it=Math.abs(Te.x)/Math.abs(Ye.y),dt=te([]);xe(dt,dt,-Y*(1-(D?0:O)));const Ct=te([]);return ue(Ct,Ct,[1,1-(1-it)*O,1]),Ct[4]=-Ye.x/Ye.y*O,xe(Ct,Ct,Y),ce(Ct,dt,Ct),Ct}(c.projection,0,c.center,a,n),p=CD(c);return ue(h,h,[p,p,1]),h}function CD(c){const n=c.projection,a=Sw(c.projection,c.zoom,c.width,c.height),h=aS(n,c.center),p=aS(n,we.convert(n.center));return Math.pow(2,h*a+(1-a)*p)}function Sw(c,n,a,h,p=1/0){const v=c.range;if(!v)return 0;const x=Math.min(p,Math.max(a,h)),E=Math.log(x/1024)/Math.LN2;return We(v[0]+E,v[1]+E,n)}const cg=1/4e4;function aS(c,n){const a=be(n.lat,-85.051129,It),h=new we(n.lng-180*cg,a),p=new we(n.lng+180*cg,a),v=c.project(h.lng,a),x=c.project(p.lng,a),E=at.fromLngLat(h),O=at.fromLngLat(p),D=x.x-v.x,B=x.y-v.y,F=O.x-E.x,U=O.y-E.y,Z=Math.sqrt((F*F+U*U)/(D*D+B*B));return Math.log(Z)/Math.LN2}function MD(c,n,a){const h=Math.cos(a),p=Math.sin(a);return{x:c*h-n*p,y:c*p+n*h}}function OD(c,n,a){te(c),xe(c,c,Tt(n[2])),Pe(c,c,Tt(n[0])),Oe(c,c,Tt(n[1])),ue(c,c,a),ce(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ew(c,n,a,h,p,v,x,E){const O=[a[0]-n[0],a[1]-n[1],0],D=[h[0]-n[0],h[1]-n[1],0];if(yt(O)<1e-12||yt(D)<1e-12)return go(c);const B=In([],O,D);ct(B,B),rt(D,h,n),O[2]=(v-p)*E,D[2]=(x-p)*E;const F=O;return In(F,O,D),ct(F,F),bl(c,B,F)}function sS(c,n,a=!1){const h=tf(n.zoom),p=function(v,x,E){const O=x.worldSize,D=[v[12],v[13],v[14]],B=pt(D[1]/O),F=Ke(D[0]/O),U=te([]),Z=qe(1,B)*O,Y=qe(1,0)*O*Xt(B,x.zoom),re=1/Iy(O);let he=Y*re;if(E){const le=Sw(x.projection,x.zoom,x.width,x.height,1024);he=re*x.projection.pixelSpaceConversion(x.center.lat,O,le)}const _e=se(B,F);zt(_e,_e,$e([],ct([],_e),Z*he*D[2]));const Se=function(le){const Te=[le[0],le[1],le[2]];let Me=[0,1,0];const Re=In([],Me,Te);return In(Me,Te,Re),on(Me)===0&&(Me=[0,1,0],In(Re,Te,Me)),ct(Re,Re),ct(Me,Me),ct(Te,Te),[Re[0],Re[1],Re[2],0,Me[0],Me[1],Me[2],0,Te[0],Te[1],Te[2],0,le[0],le[1],le[2],1]}(_e);ue(U,U,[he,he,he*Z]),de(U,U,[-D[0],-D[1],-D[2]]);const Ce=ce([],x.globeMatrix,Se);return ce(Ce,Ce,U),ce(Ce,Ce,v),Ce}(c,n,a);if(h>0){const v=function(x,E){const O=E.worldSize,D=qe(1,0)*O*Xt(E.center.lat,E.zoom)/Iy(O),B=qe(1,E.center.lat)*O,F=te([]);return Oe(F,F,Tt(E.center.lng)),Pe(F,F,Tt(E.center.lat)),de(F,F,[0,0,P]),ue(F,F,[D,D,D*B]),de(F,F,[E.point.x-.5*O,E.point.y-.5*O,0]),ce(F,F,x),ce(F,E.globeMatrix,F)}(c,n);return function(x,E,O){const D=(Y,re,he)=>{const _e=yt(Y),Se=yt(re),Ce=ef(Y,re,he);return $e(Ce,Ce,1/yt(Ce)*Xn(_e,Se,he))},B=D([x[0],x[1],x[2]],[E[0],E[1],E[2]],O),F=D([x[4],x[5],x[6]],[E[4],E[5],E[6]],O),U=D([x[8],x[9],x[10]],[E[8],E[9],E[10]],O),Z=ef([x[12],x[13],x[14]],[E[12],E[13],E[14]],O);return[B[0],B[1],B[2],0,F[0],F[1],F[2],0,U[0],U[1],U[2],0,Z[0],Z[1],Z[2],1]}(p,v,h)}return p}function ID(c,n,a,h){const p=sr.projectAabbCorners(h,a);let v=Number.MAX_VALUE,x=-1;for(let D=0;D<p.length;++D){const B=p[D];B[0]=(.5*B[0]+.5)*n.width,B[1]=(.5-.5*B[1])*n.height,B[2]<v&&(x=D,v=B[2])}const E=D=>new hn(p[D][0],p[D][1]);let O;switch(x){case 0:case 6:O=[E(1),E(5),E(4),E(7),E(3),E(2),E(1)];break;case 1:case 7:O=[E(0),E(4),E(5),E(6),E(2),E(3),E(0)];break;case 3:case 5:O=[E(1),E(0),E(4),E(7),E(6),E(2),E(1)];break;default:O=[E(1),E(5),E(6),E(7),E(3),E(0),E(1)]}if(Ks(c,O))return v}const X$=ar([{name:"a_pos_3f",components:3,type:"Float32"}]),Y$=ar([{name:"a_color_3f",components:3,type:"Float32"}]),K$=ar([{name:"a_color_4f",components:4,type:"Float32"}]),J$=ar([{name:"a_uv_2f",components:2,type:"Float32"}]),Q$=ar([{name:"a_normal_3f",components:3,type:"Float32"}]),eq=ar([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),tq=ar([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),DD={None:0,Model:1,Symbol:2,FillExtrusion:4};class Aw{constructor(n,a,h,p){this.message=(n?`${n}: `:"")+h,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)}}function lS(c,n){const a=c.indexOf("://")===-1;try{return new URL(c,a&&n?"http://example.com":void 0),!0}catch{return!1}}class RD{constructor(n,a){this.feature=n,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class LD{constructor(){this.instancedDataArray=new Kd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class cS{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=n.projection,this.index=n.index,this.worldview=n.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=n.styleDefinedModelURLs}updateFootprints(n,a){}populate(n,a,h,p){this.tileToMeter=Et(h);const v=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:x,id:E,index:O,sourceLayerIndex:D}of n){const B=E??(x.properties&&x.properties.hasOwnProperty("id")?x.properties.id:void 0),F=On(x,v);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom,{worldview:this.worldview}),F,h))continue;const U={id:B,sourceLayerIndex:D,index:O,geometry:v?F.geometry:Dn(x,h,p),properties:x.properties,type:x.type,patterns:{}},Z=this.addFeature(U,U.geometry,F);Z&&a.featureIndex.insert(x,U.geometry,O,D,this.index,this.instancesPerModel[Z].instancedDataArray.length,fn/32)}this.lookup=null}update(n,a,h,p){for(const v in this.instancesPerModel){const x=this.instancesPerModel[v];for(const E in n)x.idToFeaturesIndex.hasOwnProperty(E)&&(this.evaluate(x.features[x.idToFeaturesIndex[E]],n[E],x,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const a in this.instancesPerModel){const h=this.instancesPerModel[a];for(const p of h.features){const v=this.layers[0],x=p.feature,E=this.canonical,O=v.paint.get("model-rotation").evaluate(x,{},E),D=v.paint.get("model-scale").evaluate(x,{},E),B=v.paint.get("model-translation").evaluate(x,{},E);mn(p.rotation,O)&&mn(p.scale,D)&&mn(p.translation,B)||(this.evaluate(p,p.featureStates,h,!0),n=!0)}}return n}updateReplacement(n,a,h,p){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const v=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(ng(this.activeReplacements,v))return!1;this.activeReplacements=v;let x=!1;for(const E in this.instancesPerModel){const O=this.instancesPerModel[E],D=O.instancedDataArray;for(const B of O.features){const F=B.instancedDataOffset,U=B.instancedDataCount;for(let Z=0;Z<U;Z++){const Y=16*(Z+F);let re=D.float32[Y+0];const he=re>fn;re=he?re-fn:re;const _e=Math.floor(re),Se=D.float32[Y+1];let Ce=!1;for(const le of this.activeReplacements)if(!Wb(le,h,DD.Model,p)&&!(le.min.x>_e||_e>le.max.x||le.min.y>Se||Se>le.max.y)&&(Ce=A0(E0(_e,Se,n.canonical,le.footprintTileId.canonical),le.footprint),Ce))break;D.float32[Y]=Ce?re+fn:re,x=x||Ce!==he}}}return x}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const a in this.instancesPerModel){const h=this.instancesPerModel[a];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=n.createVertexBuffer(h.instancedDataArray,eq.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const a in this.instancesPerModel){const h=this.instancesPerModel[a];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris&&this.modelsRequested)for(const a of this.modelUris)n.removeModel(a,"",!0)}addFeature(n,a,h){const p=this.layers[0],v=p.layout.get("model-id").evaluate(h,{},this.canonical);if(!v)return ui(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),v;(lS(v,!1)||this.styleDefinedModelURLs[v]!==void 0)&&(this.modelUris.includes(v)||this.modelUris.push(v)),this.instancesPerModel[v]||(this.instancesPerModel[v]=new LD);const x=this.instancesPerModel[v],E=x.instancedDataArray,O=new RD(h,E.length);for(const D of a)for(const B of D){if(B.x<0||B.x>=fn||B.y<0||B.y>=fn)continue;const F=(this.lookupDim-1)/fn,U=this.lookupDim*(B.y*F|0)+B.x*F|0;if(this.lookup){if(this.lookup[U]!==0)continue;this.lookup[U]=1}this.instanceCount++;const Z=E.length;E.resize(Z+1),x.instancesEvaluatedElevation.push(0),E.float32[16*Z]=B.x,E.float32[16*Z+1]=B.y}return O.instancedDataCount=x.instancedDataArray.length-O.instancedDataOffset,O.instancedDataCount>0&&(n.id&&(x.idToFeaturesIndex[n.id]=x.features.length),x.features.push(O),this.evaluate(O,{},x,!1)),v}getModelUris(){return this.modelUris}evaluate(n,a,h,p){const v=this.layers[0],x=n.feature,E=this.canonical,O=n.rotation=v.paint.get("model-rotation").evaluate(x,a,E),D=n.scale=v.paint.get("model-scale").evaluate(x,a,E),B=n.translation=v.paint.get("model-translation").evaluate(x,a,E),F=v.paint.get("model-color").evaluate(x,a,E);F.a=v.paint.get("model-color-mix-intensity").evaluate(x,a,E);const U=[];this.maxVerticalOffset<B[2]&&(this.maxVerticalOffset=B[2]),this.maxScale=Math.max(Math.max(this.maxScale,D[0]),Math.max(D[1],D[2])),OD(U,O,D);const Z=Math.round(100*F.a)+F.b/1.05;for(let Y=0;Y<n.instancedDataCount;++Y){const re=n.instancedDataOffset+Y,he=16*re,_e=h.instancedDataArray.float32;let Se=0;p&&(Se=_e[he+6]-h.instancesEvaluatedElevation[re]);const Ce=0|_e[he+1];_e[he]=(0|_e[he])+F.r/1.05,_e[he+1]=Ce+F.g/1.05,_e[he+2]=Z,_e[he+3]=1/(E.z>10?this.tileToMeter:Et(E,Ce)),_e[he+4]=B[0],_e[he+5]=B[1],_e[he+6]=B[2]+Se,_e[he+7]=U[0],_e[he+8]=U[1],_e[he+9]=U[2],_e[he+10]=U[4],_e[he+11]=U[5],_e[he+12]=U[6],_e[he+13]=U[8],_e[he+14]=U[9],_e[he+15]=U[10],h.instancesEvaluatedElevation[re]=B[2]}}}let zD,kD;Nn(cS,"ModelBucket",{omit:["layers"]}),Nn(LD,"PerModelAttributes"),Nn(RD,"ModelFeature");const M_=64,iv={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function ND(c,n,a,h,p,v,x,E,O,D=!1){const B=a.zoom,F=a.project(h),U=Xt(h.lat,B),Z=1/U;te(c),de(c,c,[F.x+x[0]*Z,F.y+x[1]*Z,x[2]]);let Y=1,re=1;const he=a.worldSize;if(D){if(a.projection.name==="mercator"){let le=0;a.elevation&&(le=a.elevation.getAtPointOrZero(new at(F.x/he,F.y/he),0));const Te=Xr([],[F.x,F.y,le,1],a.projMatrix)[3]/a.cameraToCenterDistance;Y=Te,re=Te*Xt(a.center.lat,B)}else if(a.projection.name==="globe"){const le=sS(c,a),Te=[0,0,0,1];Xr(Te,Te,ce([],a.projMatrix,le));const Me=Te[3]/a.cameraToCenterDistance,Re=tf(B),et=a.projection.pixelsPerMeter(h.lat,he)*Xt(h.lat,B),Ye=a.projection.pixelsPerMeter(a.center.lat,he)*Xt(a.center.lat,B);Y=Me/Xn(et,Nt(a.center.lat),Re),re=Me*U/et,Y*=Ye,re*=Ye}}else Y=Z;ue(c,c,[Y,Y,re]);const _e=[...c],Se=n.orientation,Ce=[];if(OD(Ce,[Se[0]+p[0],Se[1]+p[1],Se[2]+p[2]],v),ce(c,_e,Ce),E&&a.elevation){let le=0;const Te=[];if(O&&a.elevation){le=function(Re,et,Ye,it,dt){const Ct=et.elevation;if(!Ct)return 0;const tn=sr.projectAabbCorners(Ye,it),qt=qe(1,dt.lat)*et.worldSize,Jt=function(un,bi){const Gn=[0,0,1],Wn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const mi of Wn){const Ci=un[mi.corners[0]],Ei=un[mi.corners[1]],$i=un[mi.corners[2]],Li=[Ei[0]-Ci[0],Ei[1]-Ci[1],bi*(Ei[2]-Ci[2])],qi=In(Li,Li,[$i[0]-Ci[0],$i[1]-Ci[1],bi*($i[2]-Ci[2])]);ct(qi,qi),mi.dotProductWithUp=kt(qi,Gn)}return Wn.sort((mi,Ci)=>mi.dotProductWithUp-Ci.dotProductWithUp),Wn[0].corners}(tn,qt),sn=tn[Jt[0]],Ot=tn[Jt[1]],Yt=tn[Jt[2]],At=tn[Jt[3]],Mt=Ct.getAtPointOrZero(new at(sn[0]/et.worldSize,sn[1]/et.worldSize),0),dn=Ct.getAtPointOrZero(new at(Ot[0]/et.worldSize,Ot[1]/et.worldSize),0),gn=Ct.getAtPointOrZero(new at(Yt[0]/et.worldSize,Yt[1]/et.worldSize),0),oi=Ct.getAtPointOrZero(new at(At[0]/et.worldSize,At[1]/et.worldSize),0),Zn=(Mt+oi)/2,Sn=(dn+gn)/2;return Zn>Sn?dn<gn?Ew(Re,Ot,At,sn,dn,oi,Mt,qt):Ew(Re,Yt,sn,At,gn,Mt,oi,qt):Mt<oi?Ew(Re,sn,Ot,Yt,Mt,dn,gn,qt):Ew(Re,At,Yt,Ot,oi,gn,dn,qt),Math.max(Zn,Sn)}(Te,a,n.aabb,c,h);const Me=ce([],Ge([],Te),Ce);ce(c,_e,Me)}else le=a.elevation.getAtPointOrZero(new at(F.x/he,F.y/he),0);le!==0&&(c[14]+=le)}}function $0(c,n,a=!1){c.uploaded||(c.gfxTexture=new rS(n,c.image,a?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function nq(c,n,a){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,X$.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,Q$.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,J$.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?Y$:K$).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,tq.members,!0)),c.segments=wo.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const h=c.material;h.pbrMetallicRoughness.baseColorTexture&&$0(h.pbrMetallicRoughness.baseColorTexture,n),h.pbrMetallicRoughness.metallicRoughnessTexture&&$0(h.pbrMetallicRoughness.metallicRoughnessTexture,n),h.normalTexture&&$0(h.normalTexture,n),h.occlusionTexture&&$0(h.occlusionTexture,n,a),h.emissionTexture&&$0(h.emissionTexture,n)}function uS(c,n,a){if(c.meshes)for(const h of c.meshes)nq(h,n,a);if(c.children)for(const h of c.children)uS(h,n,a)}function Pw(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)Pw(n)}function hS(c){if(c.meshes)for(const a of c.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((n=a.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const a of c.children)hS(a)}class rv{constructor(n,a,h){this._demTile=n,this._dem=this._demTile.dem,this._scale=a,this._offset=h}static create(n,a,h){const p=h||n.findDEMTileFor(a);if(!p||!p.dem)return;const v=p.dem,x=p.tileID,E=1<<a.canonical.z-x.canonical.z;return new rv(p,v.dim/fn/E,[(a.canonical.x/E-x.canonical.x)*v.dim,(a.canonical.y/E-x.canonical.y)*v.dim])}tileCoordToPixel(n,a){const h=a*this._scale+this._offset[1],p=Math.floor(n*this._scale+this._offset[0]),v=Math.floor(h);return new hn(p,v)}getElevationAt(n,a,h,p){const v=n*this._scale+this._offset[0],x=a*this._scale+this._offset[1],E=Math.floor(v),O=Math.floor(x),D=this._dem;return p=!!p,h?Xn(Xn(D.get(E,O,p),D.get(E,O+1,p),x-O),Xn(D.get(E+1,O,p),D.get(E+1,O+1,p),x-O),v-E):D.get(E,O,p)}getElevationAtPixel(n,a,h){return this._dem.get(n,a,!!h)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*qe(1,n)*this._dem.stride}}const dS=new Float32Array(262144),O_=new Uint8Array(262144);function BD(c){let n=0;if(c.meshes)for(const a of c.meshes)n=Math.max(n,a.aabb.max[2]);if(c.children)for(const a of c.children)n=Math.max(n,BD(a));return n}function jD(c,n,a){if(c.meshes)for(const h of c.meshes){if(h.aabb.min[0]===1/0)continue;const p=sr.applyTransform(h.aabb,c.matrix);a.insert(n,p.min[0],p.min[1],p.max[0],p.max[1])}if(c.children)for(const h of c.children)jD(h,n,a)}const FD=["","wall","door","roof","window","lamp","logo"];class UD{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:BD(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const a=new sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==n&&(h.transformedAabb=sr.applyTransformFast(h.aabb,this.node.matrix),a.encapsulate(h.transformedAabb)),n++;this.aabb=a}return this.aabb}}class Cw{constructor(n,a,h,p,v,x,E,O){this.id=h,this.layers=n,this.layerIds=this.layers.map(D=>D.fqid),this.stateDependentLayerIds=this.layers.filter(D=>D.isStateDependent()).map(D=>D.id),this.modelTraits|=iv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=iv.HasMapboxMeshFeatures),v&&(this.modelTraits|=iv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.worldview=O,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const D of a)this.nodesInfo.push(new UD(D)),jD(D,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,a){for(const h of this.getNodesInfo()){const p=h.node;p.footprint&&a.push({footprint:p.footprint,id:n})}}update(n){const a=Object.keys(n).length!==0;if(a&&!this.stateDependentLayers.length)return;const h=a?this.stateDependentLayers:this.layers;if(!vs(n,this.states))for(const p of h)this.evaluate(p,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const h of a){const p=h.node;this.uploaded?this.updatePbrBuffer(p):uS(p,n,!0)}for(const h of a)Pw(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let a=!1;if(!n.meshes)return a;for(const h of n.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),a=!0);return a}needsReEvaluation(n,a,h){const p=n.transform.projectionOptions,v=n.style.getBrightness(),x=this.brightness!==v;if(!this.uploaded||this.dirty||p.name!==this.projection.name||q0(h.paint.get("model-color").value,x)||q0(h.paint.get("model-color-mix-intensity").value,x)||q0(h.paint.get("model-roughness").value,x)||q0(h.paint.get("model-emissive-strength").value,x)||q0(h.paint.get("model-height-based-emissive-strength-multiplier").value,x)){this.projection=p,this.brightness=v;const E=this.getNodesInfo();for(const O of E)O.state=null;return!0}return!1}evaluateTransform(n,a){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const h=this.getNodesInfo(),p=this.id.canonical;for(const v of h){const x=v.feature;v.evaluatedTranslation=a.paint.get("model-translation").evaluate(x,{},p),v.evaluatedScale=a.paint.get("model-scale").evaluate(x,{},p)}}evaluate(n,a){const h=this.getNodesInfo();for(const p of h){if(!p.node.meshes)continue;const v=p.feature,x=a&&a[v.id];if(vs(x,p.state))continue;p.state=structuredClone(x);const E=p.node.meshes&&p.node.meshes[0].featureData,O=p.evaluatedColor[2],D=p.evaluatedRMEA[2],B=this.id.canonical;if(p.hasTranslucentParts=!1,E){for(let F=0;F<FD.length;F++){const U=FD[F];U.length&&(v.properties.part=U);const Z=n.paint.get("model-color").evaluate(v,x,B).toPremultipliedRenderColor(null),Y=n.paint.get("model-color-mix-intensity").evaluate(v,x,B);p.evaluatedColor[F]=[Z.r,Z.g,Z.b,Y],p.evaluatedRMEA[F][0]=n.paint.get("model-roughness").evaluate(v,x,B),p.evaluatedRMEA[F][2]=n.paint.get("model-emissive-strength").evaluate(v,x,B),p.evaluatedRMEA[F][3]=Z.a,p.emissionHeightBasedParams[F]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(v,x,B),!p.hasTranslucentParts&&Z.a<1&&(p.hasTranslucentParts=!0)}delete v.properties.part,rq(p,O!==p.evaluatedColor[2]||D!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(v,x,B);p.evaluatedTranslation=n.paint.get("model-translation").evaluate(v,x,B),p.evaluatedScale=n.paint.get("model-scale").evaluate(v,x,B),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,a,h,p){const v=n.findDEMTileFor(h);if(v&&(v.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(v.dem&&v.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=v.tileID.overscaledZ;const x=rv.create(n,h,v);if(!x)return;this.modelTraits&iv.HasMapboxMeshFeatures&&this.updateDEM(n,x,h,p);for(const E of this.getNodesInfo()){const O=E.node;if(!O.footprint||!O.footprint.vertices||!O.footprint.vertices.length)continue;const D=O.footprint.vertices;let B=x.getElevationAt(D[0].x,D[0].y,!0,!0);for(let F=1;F<D.length;F++)B=Math.min(B,x.getElevationAt(D[F].x,D[F].y,!0,!0));O.elevation=B}}this.terrainTile=v.tileID.canonical,this.terrainExaggeration=a}}updateDEM(n,a,h,p){let v=a._dem._modifiedForSources[p];if(v===void 0&&(a._dem._modifiedForSources[p]=[],v=a._dem._modifiedForSources[p]),v.includes(h.canonical))return;const x=a._dem.dim;v.push(h.canonical);let E=!1;for(const O of this.getNodesInfo()){const D=O.node;if(!D.footprint||!D.footprint.grid)continue;const B=D.footprint.grid,F=a.tileCoordToPixel(B.min.x,B.min.y),U=a.tileCoordToPixel(B.max.x,B.max.y),Z=Math.min(Math.min(x-U.y,F.x),Math.min(F.y,x-U.x));if(Z<0)continue;const Y=be(Z,2,5);let re=Math.max(0,F.x-Y),he=Math.max(0,F.y-Y),_e=Math.min(U.x+Y,x-1),Se=Math.min(U.y+Y,x-1);for(let Me=he;Me<=Se;++Me)for(let Re=re;Re<=_e;++Re)O_[Me*x+Re]=255;let Ce=0,le=0;for(let Me=0;Me<B.cellsY;++Me)for(let Re=0;Re<B.cellsX;++Re){if(!B.cells[Me*B.cellsX+Re])continue;const et=a.tileCoordToPixel(B.min.x+Re/B.xScale,B.min.y+Me/B.yScale),Ye=a.tileCoordToPixel(B.min.x+(Re+1)/B.xScale,B.min.y+(Me+1)/B.yScale);for(let it=et.y;it<=Math.min(Ye.y+1,x-1);++it)for(let dt=et.x;dt<=Math.min(Ye.x+1,x-1);++dt)O_[it*x+dt]===255&&(O_[it*x+dt]=0,Ce+=a.getElevationAtPixel(dt,it),le++)}const Te=Ce/le;re=Math.max(1,F.x-Y),he=Math.max(1,F.y-Y),_e=Math.min(U.x+Y,x-2),Se=Math.min(U.y+Y,x-2),E=!0;for(let Me=he;Me<=Se;++Me)for(let Re=re;Re<=_e;++Re)O_[Me*x+Re]===0&&(dS[Me*x+Re]=a._dem.set(Re,Me,Te));for(let Me=1;Me<Y;++Me){re=Math.max(1,F.x-Me),he=Math.max(1,F.y-Me),_e=Math.min(U.x+Me,x-2),Se=Math.min(U.y+Me,x-2);for(let Re=he;Re<=Se;++Re)for(let et=re;et<=_e;++et){const Ye=Re*x+et;if(O_[Ye]===255){let it=0,dt=0,Ct=-1,tn=-1;for(let qt=-1;qt<=1;++qt)for(let Jt=-1;Jt<=1;++Jt){const sn=(Re+qt)*x+et+Jt;if(O_[sn]>=Me)continue;const Ot=dS[sn],Yt=Math.abs(Ot);Yt>dt&&(it=Ot,dt=Yt,Ct=Jt,tn=qt)}if(dt>.1){const qt=1-(Me+.5*Math.abs(Ct*tn))/Y;let Jt=a._dem.get(et,Re)+it*qt;const sn=a._dem.get(et+Ct,Re+tn),Ot=a._dem.get(et-Ct,Re-tn,!0);(Jt-sn)*(Jt-Ot)>0&&(Jt=(sn+Ot)/2),dS[Ye]=a._dem.set(et,Re,Jt),O_[Ye]=Me}}}}}E&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=xs.now())}setFilter(n){this.filter=n?Im(n):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(n=>this.filter.filter(new Mr(this.id.overscaledZ,{worldview:this.worldview}),n.feature,this.id.canonical)):this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const a of n)Pw(a.node),hS(a.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(n.toUnwrapped());for(const p of this.getNodesInfo()){const v=p.node.footprint;p.hiddenByReplacement=!!v&&!h.find(x=>x.footprint===v)}}getHeightAtTileCoord(n,a){const h=[],p=[0,0,0],v=te([]);for(const x of this.getNodesInfo()){const E=x.node.meshes[0],O=E.transformedAabb;if(n<O.min[0]||a<O.min[1]||n>O.max[0]||a>O.max[1])continue;if(x.node.hidden===!0)return{height:1/0,maxHeight:x.feature.properties.height,hidden:!1,verticalScale:x.evaluatedScale[2]};oe(v,x.node.matrix),p[0]=n,p[1]=a,Dt(p,p,v);const D=(p[0]-E.aabb.min[0])/(E.aabb.max[0]-E.aabb.min[0])*M_|0,B=Math.min(63,(p[1]-E.aabb.min[1])/(E.aabb.max[1]-E.aabb.min[1])*M_|0)*M_+Math.min(63,D),F=E.heightmap[B];if(!(F<0&&x.node.footprint))return x.hiddenByReplacement?void 0:{height:F,maxHeight:x.feature.properties.height,hidden:!1,verticalScale:x.evaluatedScale[2]};if(x.node.footprint.grid.query(new hn(n,a),new hn(n,a),h),h.length>0)return{height:void 0,maxHeight:x.feature.properties.height,hidden:x.hiddenByReplacement,verticalScale:x.evaluatedScale[2]}}}}function q0(c,n){return c instanceof xu&&!c.isLightConstant&&n}function iq(c,n,a,h,p,v,x,E){let O=(61440&n|(61440&n)>>4)>>8,D=(3840&n|(3840&n)>>4)>>4,B=240&n|(240&n)>>4;a[3]>0&&(O=Xn(O,255*a[0],a[3]),D=Xn(D,255*a[1],a[3]),B=Xn(B,255*a[2],a[3]));const F=O<<8|D,U=B<<8|Math.floor(255*h[3]),Z=function(Me){const Re=be(Me,0,2);return Math.min(Math.round(.5*Re*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],Y=be(p[0],0,1),re=be(p[1],0,1),he=be(p[2],0,1),_e=be(p[3],0,1);let Se,Ce,le,Te;if(Y!==re&&x!==v&&re!==Y){const Me=x-v;Ce=1/(Me*(re-Y)),le=-(v+Me*Y)/(Me*(re-Y));const Re=be(p[4],-1,1);Te=Math.pow(10,Re),Se=255*he<<8|255*_e}else Se=65535,Ce=0,le=1,Te=1;if(c.emplaceBack(F,U,Z,Se,Ce,le,Te),E){const Me=E.length;E.clear();for(let Re=0;Re<Me;Re++)E.emplaceBack(F,U,Z,Se,Ce,le,Te)}}function rq(c,n,a){const h=c.node;let p=0;const v=a&iv.HasMeshoptCompression;for(const x of h.meshes){if(h.lights&&h.lightMeshIndex===p||!x.featureData)continue;x.featureArray=new Jh,x.featureArray.reserve(x.featureData.length);let E=n;for(const O of x.featureData){const D=v?65535&O:O>>16&65535,B=v?O>>16&65535:65535&O,F=(15&B)<8?15&B:0,U=c.evaluatedRMEA[F],Z=c.evaluatedColor[F],Y=c.emissionHeightBasedParams[F];let re;if(E&&F===2&&h.lights&&(re=new Jh,re.resize(10*h.lights.length)),iq(x.featureArray,D,Z,U,Y,x.aabb.min[2],x.aabb.max[2],re),re&&E){E=!1;const he=h.meshes[h.lightMeshIndex];he.featureArray=re,he.featureArray._trim()}}x.featureArray._trim(),p++}}function VD(c,n,a,h){const p=1<<c.z;n.lat=pt((h/fn+c.y)/p),n.lng=Ke((a/fn+c.x)/p)}function oq(c,n,a,h){const p=c.getNodesInfo()[n];if(!p||p.hiddenByReplacement||!p.node.meshes)return;let v=Number.MAX_VALUE;const x=p.node,E=a.tile,O=h.calculatePosMatrix(E.tileID.toUnwrapped(),h.worldSize),D=p.evaluatedScale;let B=0;h.elevation&&x.elevation&&(B=x.elevation*h.elevation.exaggeration()),de(O,O,[(x.anchor?x.anchor[0]:0)*(D[0]-1),(x.anchor?x.anchor[1]:0)*(D[1]-1),B]),ue(O,O,D);const F=a.queryGeometry,U=F.isPointQuery()?F.screenBounds:F.screenGeometry,Z=function(re){const he=ce([],O,re.matrix);ce(he,h.expandedFarZProjMatrix,he);for(let _e=0;_e<re.meshes.length;++_e){const Se=re.meshes[_e];if(_e===re.lightMeshIndex)continue;const Ce=ID(U,h,he,Se.aabb);Ce!=null&&(v=Math.min(Ce,v))}if(re.children)for(const _e of re.children)Z(_e)};if(Z(x),v===Number.MAX_VALUE)return;const Y=new we(0,0);return VD(E.tileID.canonical,Y,p.node.anchor[0],p.node.anchor[1]),{intersectionZ:v,position:Y,feature:p.feature}}Nn(Cw,"Tiled3dModelBucket",{omit:["layers"]}),Nn(UD,"Tiled3dModelFeature");const aq={circle:class extends Fs{constructor(c,n,a,h){super(c,{layout:o0||(o0=new bo({"circle-sort-key":new bn(ft.layout_circle["circle-sort-key"]),"circle-elevation-reference":new an(ft.layout_circle["circle-elevation-reference"]),visibility:new an(ft.layout_circle.visibility)})),paint:Vp||(Vp=new bo({"circle-radius":new bn(ft.paint_circle["circle-radius"]),"circle-color":new bn(ft.paint_circle["circle-color"]),"circle-blur":new bn(ft.paint_circle["circle-blur"]),"circle-opacity":new bn(ft.paint_circle["circle-opacity"]),"circle-translate":new an(ft.paint_circle["circle-translate"]),"circle-translate-anchor":new an(ft.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new an(ft.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new an(ft.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bn(ft.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bn(ft.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bn(ft.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new an(ft.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h)}createBucket(c){return new dl(c)}queryRadius(c){const n=c;return Zm("circle-radius",this,n)+Zm("circle-stroke-width",this,n)+Oy(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,a,h,p,v,x,E){const O=r0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a);return Rb(c,h,v,x,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,D)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,a){const h=Dy(this);return{config:new Cl(this,{zoom:n,lut:a}),defines:h,overrideFog:!1}}is3D(c){return!c&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Fs{createBucket(c){return new ao(c)}constructor(c,n,a,h){super(c,{layout:Ry||(Ry=new bo({visibility:new an(ft.layout_heatmap.visibility)})),paint:d_||(d_=new bo({"heatmap-radius":new bn(ft.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bn(ft.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new an(ft.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Cu(ft.paint_heatmap["heatmap-color"]),"heatmap-opacity":new an(ft.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=f_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Zm("heatmap-radius",this,c)}queryIntersectsFeature(c,n,a,h,p,v,x,E){const O=this.paint.get("heatmap-radius").evaluate(n,a);return Rb(c,h,v,x,E,!0,!0,new hn(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,a){return c==="heatmap"?{config:new Cl(this,{zoom:n,lut:a}),overrideFog:!1}:{}}},hillshade:class extends Fs{constructor(c,n,a,h){super(c,{layout:Ly||(Ly=new bo({visibility:new an(ft.layout_hillshade.visibility)})),paint:m0||(m0=new bo({"hillshade-illumination-direction":new an(ft.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new an(ft.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new an(ft.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new an(ft.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new an(ft.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new an(ft.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new an(ft.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,a){return{overrideFog:!1}}},fill:class extends Fs{constructor(c,n,a,h){super(c,{layout:eg||(eg=new bo({"fill-sort-key":new bn(ft.layout_fill["fill-sort-key"]),visibility:new an(ft.layout_fill.visibility),"fill-elevation-reference":new an(ft.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new bn(ft.layout_fill["fill-construct-bridge-guard-rail"])})),paint:w0||(w0=new bo({"fill-antialias":new an(ft.paint_fill["fill-antialias"]),"fill-opacity":new bn(ft.paint_fill["fill-opacity"]),"fill-color":new bn(ft.paint_fill["fill-color"]),"fill-outline-color":new bn(ft.paint_fill["fill-outline-color"]),"fill-translate":new an(ft.paint_fill["fill-translate"]),"fill-translate-anchor":new an(ft.paint_fill["fill-translate-anchor"]),"fill-pattern":new bn(ft.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new an(ft.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new an(ft.paint_fill["fill-emissive-strength"]),"fill-z-offset":new bn(ft.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new bn(ft.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new bn(ft.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),a=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(c,n,a){return{config:new Cl(this,{zoom:n,lut:a}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new Xf(c)}queryRadius(){return Oy(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,a,h,p,v){return!c.queryGeometry.isAboveHorizon&&Sc(Eb(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(c){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const n=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return c!=null?n&&!c:n}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Fs{constructor(c,n,a,h){super(c,{layout:Jy||(Jy=new bo({visibility:new an(ft["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new an(ft["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:E_||(E_=new bo({"fill-extrusion-opacity":new an(ft["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bn(ft["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new an(ft["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new an(ft["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bn(ft["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new an(ft["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new bn(ft["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bn(ft["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new an(ft["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new an(ft["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new an(ft["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new an(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new an(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new an(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new an(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new an(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new an(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new an(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new bn(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new bn(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new an(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new an(ft["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new an(ft["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new an(ft["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new bn(ft["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new bn(ft["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new an(ft["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new b_(c)}queryRadius(){return Oy(this.paint.get("fill-extrusion-translate"))}is3D(c){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,a,h,p,v,x,E,O){const D=r0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),B=this.paint.get("fill-extrusion-height").evaluate(n,a),F=this.paint.get("fill-extrusion-base").evaluate(n,a),U=[0,0],Z=E&&v.elevation,Y=v.elevation?v.elevation.exaggeration():1,re=c.tile.getBucket(this);if(Z&&re instanceof b_){const le=re.centroidVertexArray,Te=O+1;Te<le.length&&(U[0]=le.geta_centroid_pos0(Te),U[1]=le.geta_centroid_pos1(Te))}if(U[0]===0&&U[1]===1)return!1;v.projection.name==="globe"&&(h=O0([h],[new hn(0,0),new hn(fn,fn)],c.tileID.canonical).map(le=>le.polygon).flat());const he=Z?E:null,[_e,Se]=function(le,Te,Me,Re,et,Ye,it,dt,Ct,tn,qt){return le.projection.name==="globe"?function(Jt,sn,Ot,Yt,At,Mt,dn,gn,oi,Zn,Sn){const un=[],bi=[],Gn=Jt.projection.upVectorScale(Sn,Jt.center.lat,Jt.worldSize).metersToTile,Wn=[0,0,0,1],mi=[0,0,0,1],Ci=($i,Li,qi,Ir)=>{$i[0]=Li,$i[1]=qi,$i[2]=Ir,$i[3]=1},Ei=T_();Ot>0&&(Ot+=Ei),Yt+=Ei;for(const $i of sn){const Li=[],qi=[];for(const Ir of $i){const so=Ir.x+At.x,Ie=Ir.y+At.y,ze=Jt.projection.projectTilePoint(so,Ie,Sn),Lt=Jt.projection.upVector(Sn,Ir.x,Ir.y);let yn=Ot,Pn=Yt;if(dn){const wn=Ae(so,Ie,Ot,Yt,dn,gn,oi,Zn);yn+=wn.base,Pn+=wn.top}Ot!==0?Ci(Wn,ze.x+Lt[0]*Gn*yn,ze.y+Lt[1]*Gn*yn,ze.z+Lt[2]*Gn*yn):Ci(Wn,ze.x,ze.y,ze.z),Ci(mi,ze.x+Lt[0]*Gn*Pn,ze.y+Lt[1]*Gn*Pn,ze.z+Lt[2]*Gn*Pn),Dt(Wn,Wn,Mt),Dt(mi,mi,Mt),Li.push(new Qf(Wn[0],Wn[1],Wn[2])),qi.push(new Qf(mi[0],mi[1],mi[2]))}un.push(Li),bi.push(qi)}return[un,bi]}(le,Te,Me,Re,et,Ye,it,dt,Ct,tn,qt):it?function(Jt,sn,Ot,Yt,At,Mt,dn,gn,oi){const Zn=[],Sn=[],un=[0,0,0,1];for(const bi of Jt){const Gn=[],Wn=[];for(const mi of bi){const Ci=mi.x+Yt.x,Ei=mi.y+Yt.y,$i=Ae(Ci,Ei,sn,Ot,Mt,dn,gn,oi);un[0]=Ci,un[1]=Ei,un[2]=$i.base,un[3]=1,Xr(un,un,At),un[3]=Math.max(un[3],1e-5);const Li=new Qf(un[0]/un[3],un[1]/un[3],un[2]/un[3]);un[0]=Ci,un[1]=Ei,un[2]=$i.top,un[3]=1,Xr(un,un,At),un[3]=Math.max(un[3],1e-5);const qi=new Qf(un[0]/un[3],un[1]/un[3],un[2]/un[3]);Gn.push(Li),Wn.push(qi)}Zn.push(Gn),Sn.push(Wn)}return[Zn,Sn]}(Te,Me,Re,et,Ye,it,dt,Ct,tn):function(Jt,sn,Ot,Yt,At){const Mt=[],dn=[],gn=At[8]*sn,oi=At[9]*sn,Zn=At[10]*sn,Sn=At[11]*sn,un=At[8]*Ot,bi=At[9]*Ot,Gn=At[10]*Ot,Wn=At[11]*Ot;for(const mi of Jt){const Ci=[],Ei=[];for(const $i of mi){const Li=$i.x+Yt.x,qi=$i.y+Yt.y,Ir=At[0]*Li+At[4]*qi+At[12],so=At[1]*Li+At[5]*qi+At[13],Ie=At[2]*Li+At[6]*qi+At[14],ze=At[3]*Li+At[7]*qi+At[15],Lt=Ir+gn,yn=so+oi,Pn=Ie+Zn,wn=Math.max(ze+Sn,1e-5),Hn=Ir+un,pi=so+bi,Ji=Ie+Gn,Qi=Math.max(ze+Wn,1e-5);Ci.push(new Qf(Lt/wn,yn/wn,Pn/wn)),Ei.push(new Qf(Hn/Qi,pi/Qi,Ji/Qi))}Mt.push(Ci),dn.push(Ei)}return[Mt,dn]}(Te,Me,Re,et,Ye)}(v,h,F,B,D,x,he,U,Y,v.center.lat,c.tileID.canonical),Ce=c.queryGeometry;return function(le,Te,Me){let Re=1/0;Sc(Me,Te)&&(Re=ee(Me,Te[0]));for(let et=0;et<Te.length;et++){const Ye=Te[et],it=le[et];for(let dt=0;dt<Ye.length-1;dt++){const Ct=Ye[dt],tn=[Ct,Ye[dt+1],it[dt+1],it[dt],Ct];Ks(Me,tn)&&(Re=Math.min(Re,ee(Me,tn)))}}return Re!==1/0&&Re}(_e,Se,Ce.isPointQuery()?Ce.screenBounds:Ce.screenGeometry)}},building:class extends Fs{constructor(c,n,a,h){super(c,{layout:dI||(dI=new bo({visibility:new an(ft.layout_building.visibility),"building-roof-shape":new bn(ft.layout_building["building-roof-shape"]),"building-height":new bn(ft.layout_building["building-height"]),"building-base":new bn(ft.layout_building["building-base"])})),paint:fI||(fI=new bo({"building-opacity":new an(ft.paint_building["building-opacity"]),"building-ambient-occlusion-wall-intensity":new an(ft.paint_building["building-ambient-occlusion-wall-intensity"]),"building-ambient-occlusion-ground-intensity":new an(ft.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new an(ft.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new an(ft.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new an(ft.paint_building["building-vertical-scale"]),"building-cast-shadows":new an(ft.paint_building["building-cast-shadows"]),"building-color":new bn(ft.paint_building["building-color"]),"building-emissive-strength":new bn(ft.paint_building["building-emissive-strength"]),"building-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new hI(c)}},line:class extends Fs{constructor(c,n,a,h){const p=TI();super(c,p,n,a,h),p.layout&&(this.layout=new qd(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof fc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(D0)return D0;const a=TI();return D0=new i$(a.paint.properties["line-width"].specification),D0.useIntegerZoom=!0,D0})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new k2(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,a){const h=bI(this);return{config:new Cl(this,{zoom:n,lut:a}),defines:h,overrideFog:!1}}queryRadius(c){const n=c,a=SI(Zm("line-width",this,n),Zm("line-gap-width",this,n)),h=Zm("line-offset",this,n);return a/2+Math.abs(h)+Oy(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,a,h,p,v){if(c.queryGeometry.isAboveHorizon)return!1;const x=Eb(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),E=c.pixelToTileUnitsFactor/2*SI(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),O=this.paint.get("line-offset").evaluate(n,a);return O&&(h=function(D,B){const F=[],U=new hn(0,0);for(let Z=0;Z<D.length;Z++){const Y=D[Z],re=[];for(let he=0;he<Y.length;he++){const _e=Y[he],Se=Y[he+1],Ce=he===0?U:_e.sub(Y[he-1])._unit()._perp(),le=he===Y.length-1?U:Se.sub(_e)._unit()._perp(),Te=Ce._add(le)._unit();Te._mult(1/(Te.x*le.x+Te.y*le.y)),re.push(Te._mult(B)._add(_e))}F.push(re)}return F}(h,O*c.pixelToTileUnitsFactor)),function(D,B,F){for(let U=0;U<B.length;U++){const Z=B[U];if(D.length>=3){for(let Y=0;Y<Z.length;Y++)if(tu(D,Z[Y]))return!0}if(ps(D,Z,F))return!0}return!1}(x,h,E)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(c){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:xw,background:class extends Fs{constructor(c,n,a,h){super(c,{layout:pD||(pD=new bo({visibility:new an(ft.layout_background.visibility)})),paint:mD||(mD=new bo({"background-pitch-alignment":new an(ft.paint_background["background-pitch-alignment"]),"background-color":new an(ft.paint_background["background-color"]),"background-pattern":new an(ft.paint_background["background-pattern"]),"background-opacity":new an(ft.paint_background["background-opacity"]),"background-emissive-strength":new an(ft.paint_background["background-emissive-strength"]),"background-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,a){return{overrideFog:!1}}is3D(c){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:xD,"raster-particle":AD,sky:class extends Fs{constructor(c,n,a,h){super(c,{layout:TD||(TD=new bo({visibility:new an(ft.layout_sky.visibility)})),paint:SD||(SD=new bo({"sky-type":new an(ft.paint_sky["sky-type"]),"sky-atmosphere-sun":new an(ft.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new an(ft.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new an(ft.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new an(ft.paint_sky["sky-gradient-radius"]),"sky-gradient":new Cu(ft.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new an(ft.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new an(ft.paint_sky["sky-atmosphere-color"]),"sky-opacity":new an(ft.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=f_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),p=!h,v=c.style.light,x=v.properties.get("position");return p&&v.properties.get("anchor")==="viewport"&&ui("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?oS(x.azimuthal,90-x.polar,n):oS(h[0],90-h[1],n)}const a=this.paint.get("sky-gradient-center");return oS(a[0],90-a[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Fs{constructor(c,n,a,h){super(c,{paint:ED||(ED=new bo({}))},n,null)}},model:class extends Fs{constructor(c,n,a,h){super(c,{layout:zD||(zD=new bo({visibility:new an(ft.layout_model.visibility),"model-id":new bn(ft.layout_model["model-id"])})),paint:kD||(kD=new bo({"model-opacity":new bn(ft.paint_model["model-opacity"]),"model-rotation":new bn(ft.paint_model["model-rotation"]),"model-scale":new bn(ft.paint_model["model-scale"]),"model-translation":new bn(ft.paint_model["model-translation"]),"model-color":new bn(ft.paint_model["model-color"]),"model-color-mix-intensity":new bn(ft.paint_model["model-color-mix-intensity"]),"model-type":new an(ft.paint_model["model-type"]),"model-cast-shadows":new an(ft.paint_model["model-cast-shadows"]),"model-receive-shadows":new an(ft.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new an(ft.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new bn(ft.paint_model["model-emissive-strength"]),"model-roughness":new bn(ft.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new bn(ft.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new an(ft.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new an(ft.paint_model["model-front-cutoff"]),"model-color-use-theme":new bn({type:"string",default:"default","property-type":"data-driven"})}))},n,a,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new cS(c)}getProgramIds(){return["model"]}is3D(c){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof Cw?fn-1:0}queryIntersectsFeature(c,n,a,h,p,v){if(!this.modelManager)return!1;const x=this.modelManager,E=c.tile.getBucket(this);if(!(E&&E instanceof cS))return!1;for(const O in E.instancesPerModel){const D=E.instancesPerModel[O],B=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(D.idToFeaturesIndex.hasOwnProperty(B)){const F=D.features[D.idToFeaturesIndex[B]],U=x.getModel(O,this.scope);if(!U)return!1;let Z=J();const Y=new we(0,0),re=E.canonical;let he=Number.MAX_VALUE;for(let _e=0;_e<F.instancedDataCount;++_e){const Se=16*(F.instancedDataOffset+_e),Ce=D.instancedDataArray.float32,le=[Ce[Se+4],Ce[Se+5],Ce[Se+6]];VD(re,Y,Ce[Se],0|Ce[Se+1]),ND(Z,U,v,Y,F.rotation,F.scale,le,!1,!1,!1),v.projection.name==="globe"&&(Z=sS(Z,v));const Te=ce([],v.projMatrix,Z),Me=c.queryGeometry,Re=ID(Me.isPointQuery()?Me.screenBounds:Me.screenGeometry,v,Te,U.aabb);Re!=null&&(he=Math.min(Re,he))}return he!==Number.MAX_VALUE&&he}}return!1}_handleOverridablePaintPropertyUpdate(c,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Xc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Fs{constructor(c,n,a,h){super(c,{layout:qb||(qb=new bo({"clip-layer-types":new an(ft.layout_clip["clip-layer-types"]),"clip-layer-scope":new an(ft.layout_clip["clip-layer-scope"])})),paint:em||(em=new bo({}))},n,a,h)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new __(c)}is3D(c){return!0}}},fS=new Di(0,0,0),pS={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},mS={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},Mw={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},sq={PAINT_ORDER_FILL_AND_STROKE:1},H0={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},$D={MASK_TYPE_LUMINANCE:1};function lq(c,n,a){c===1&&n.icons.push(function(h,p){return function(v){if(v.usvg_tree.height||(v.usvg_tree.height=v.usvg_tree.width),!v.metadata)return v;const{metadata:x}=v;if(x.content_area){const{content_area:E}=x;E.top==null&&(E.top=E.left),E.width==null&&(E.width=v.usvg_tree.width),E.height==null&&(E.height=E.width)}return x.stretch_x&&x.stretch_x.length&&qD(x,"x"),x.stretch_y&&x.stretch_y.length&&qD(x,"y"),v}(h.readFields(cq,{name:void 0},p))}(a,a.readVarint()+a.pos))}function qD(c,n){const a=[],h=c[`stretch_${n}`];let p=null;for(let v=0;v<h.length;v++)p===null?p=a.length===0?h[0]:a[a.length-1][1]+h[v]:(a.push([p,p+h[v]]),p=null);c[`stretch_${n}_areas`]=a}function cq(c,n,a){c===1?n.name=a.readString():c===2?n.metadata=function(h,p){return h.readFields(uq,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(a,a.readVarint()+a.pos):c===3&&(n.usvg_tree=function(h,p){return h.readFields(fq,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(a,a.readVarint()+a.pos),n.data="usvg_tree")}function uq(c,n,a){c===1?n.stretch_x=a.readPackedVarint():c===2?n.stretch_y=a.readPackedVarint():c===3?n.content_area=function(h,p){return h.readFields(hq,{left:0},p)}(a,a.readVarint()+a.pos):c===4&&n.variables.push(function(h,p){return h.readFields(dq,{name:void 0},p)}(a,a.readVarint()+a.pos))}function hq(c,n,a){c===1?n.left=a.readVarint():c===2?n.width=a.readVarint():c===3?n.top=a.readVarint():c===4&&(n.height=a.readVarint())}function dq(c,n,a){c===1?n.name=a.readString():c===2&&(n.rgb_color=Dw(a.readVarint()),n.value="rgb_color")}function fq(c,n,a){c===1?n.width=n.height=a.readVarint():c===2?n.height=a.readVarint():c===3?n.children.push(Ow(a,a.readVarint()+a.pos)):c===4?n.linear_gradients.push(function(h,p){return h.readFields(xq,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(a,a.readVarint()+a.pos)):c===5?n.radial_gradients.push(function(h,p){return h.readFields(wq,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(a,a.readVarint()+a.pos)):c===7?n.clip_paths.push(function(h,p){return h.readFields(Tq,{children:[]},p)}(a,a.readVarint()+a.pos)):c===8&&n.masks.push(function(h,p){const v=h.readFields(Sq,{left:0,width:20,mask_type:$D.MASK_TYPE_LUMINANCE,children:[]},p);return v.height==null&&(v.height=v.width),v.top==null&&(v.top=v.left),v}(a,a.readVarint()+a.pos))}function Ow(c,n){return c.readFields(pq,{},n)}function pq(c,n,a){c===1?(n.group=function(h,p){return h.readFields(mq,{opacity:255,children:[]},p)}(a,a.readVarint()+a.pos),n.node="group"):c===2&&(n.path=function(h,p){return h.readFields(_q,{paint_order:1,commands:[],step:1,diffs:[],rule:pS.PATH_RULE_NON_ZERO},p)}(a,a.readVarint()+a.pos),n.node="path")}function mq(c,n,a){c===1?n.transform=Iw(a,a.readVarint()+a.pos):c===2?n.opacity=a.readVarint():c===5?n.clip_path_idx=a.readVarint():c===6?n.mask_idx=a.readVarint():c===7&&n.children.push(Ow(a,a.readVarint()+a.pos))}function Iw(c,n){return c.readFields(gq,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function gq(c,n,a){c===1?n.sx=a.readFloat():c===2?n.ky=a.readFloat():c===3?n.kx=a.readFloat():c===4?n.sy=a.readFloat():c===5?n.tx=a.readFloat():c===6&&(n.ty=a.readFloat())}function _q(c,n,a){c===1?n.fill=function(h,p){return h.readFields(yq,{rgb_color:fS,paint:"rgb_color",opacity:255},p)}(a,a.readVarint()+a.pos):c===2?n.stroke=function(h,p){return h.readFields(vq,{rgb_color:fS,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(a,a.readVarint()+a.pos):c===3?n.paint_order=a.readVarint():c===5?a.readPackedVarint(n.commands):c===6?n.step=a.readFloat():c===7?a.readPackedSVarint(n.diffs):c===8&&(n.rule=a.readVarint())}function yq(c,n,a){c===1?(n.rgb_color=Dw(a.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=a.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=a.readVarint(),n.paint="radial_gradient_idx"):c===5&&(n.opacity=a.readVarint())}function Dw(c){return new Di((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function vq(c,n,a){c===1?(n.rgb_color=Dw(a.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=a.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=a.readVarint(),n.paint="radial_gradient_idx"):c===5?a.readPackedFloat(n.dasharray):c===6?n.dashoffset=a.readFloat():c===7?n.miterlimit=a.readFloat():c===8?n.opacity=a.readVarint():c===9?n.width=a.readFloat():c===10?n.linecap=a.readVarint():c===11&&(n.linejoin=a.readVarint())}function xq(c,n,a){c===1?n.transform=Iw(a,a.readVarint()+a.pos):c===2?n.spread_method=a.readVarint():c===3?n.stops.push(HD(a,a.readVarint()+a.pos)):c===4?n.x1=a.readFloat():c===5?n.y1=a.readFloat():c===6?n.x2=a.readFloat():c===7&&(n.y2=a.readFloat())}function HD(c,n){return c.readFields(bq,{offset:0,opacity:255,rgb_color:fS},n)}function bq(c,n,a){c===1?n.offset=a.readFloat():c===2?n.opacity=a.readVarint():c===3&&(n.rgb_color=Dw(a.readVarint()))}function wq(c,n,a){c===1?n.transform=Iw(a,a.readVarint()+a.pos):c===2?n.spread_method=a.readVarint():c===3?n.stops.push(HD(a,a.readVarint()+a.pos)):c===4?n.cx=a.readFloat():c===5?n.cy=a.readFloat():c===6?n.r=a.readFloat():c===7?n.fx=a.readFloat():c===8?n.fy=a.readFloat():c===9&&(n.fr=a.readFloat())}function Tq(c,n,a){c===1?n.transform=Iw(a,a.readVarint()+a.pos):c===2?n.clip_path_idx=a.readVarint():c===3&&n.children.push(Ow(a,a.readVarint()+a.pos))}function Sq(c,n,a){c===1?n.left=n.top=a.readFloat():c===2?n.width=n.height=a.readFloat():c===3?n.top=a.readFloat():c===4?n.height=a.readFloat():c===5?n.mask_type=a.readVarint():c===6?n.mask_idx=a.readVarint():c===7&&n.children.push(Ow(a,a.readVarint()+a.pos))}class Eq{static calculate(n={},a=[]){const h=new Map,p=new Map;if(Object.keys(n).length===0)return h;a.forEach(v=>{p.set(v.name,v.rgb_color||new Di(0,0,0))});for(const[v,x]of Object.entries(n))p.has(v)?h.set(p.get(v).toString(),x):console.warn(`Ignoring unknown image variable "${v}"`);return h}}function ov(c,n=255,a){const h=n/255,p=c.toString(),v=a.has(p)?a.get(p).clone():c.clone();return v.a*=h,v.toString()}function G0(c,n){if(!Bo()){const a=document.createElement("canvas");return a.width=c,a.height=n,a}return new OffscreenCanvas(c,n)}function Aq(c,n){const a=Eq.calculate(n.params,c.metadata?c.metadata.variables:[]),h=c.usvg_tree,p=h.width,v=h.height,x=n.transform?n.transform:new DOMMatrix,E=Math.max(1,Math.round(p*x.a)),O=Math.max(1,Math.round(v*x.d)),D=new DOMMatrix([E/p,0,0,O/v,0,0]),B=G0(E,O).getContext("2d");return gS(B,D,h,h,a),B.getImageData(0,0,E,O)}function gS(c,n,a,h,p){for(const v of h.children)GD(c,n,a,v,p)}function GD(c,n,a,h,p){h.group?(c.save(),function(v,x,E,O,D){const B=O.mask_idx!=null?E.masks[O.mask_idx]:null,F=O.clip_path_idx!=null?E.clip_paths[O.clip_path_idx]:null;if(O.transform&&(x=av(O.transform).preMultiplySelf(x)),!function(Y,re,he){return Y.opacity!==255||re||he}(O,F!=null,B!=null))return void gS(v,x,E,O,D);const U=G0(v.canvas.width,v.canvas.height),Z=U.getContext("2d");gS(Z,x,E,O,D),F&&QD(Z,x,E,F),B&&eR(Z,x,E,B,D),v.globalAlpha=O.opacity/255,v.drawImage(U,0,0)}(c,n,a,h.group,p),c.restore()):h.path&&(c.save(),function(v,x,E,O,D){v.setTransform(x),O.paint_order===sq.PAINT_ORDER_FILL_AND_STROKE?(ZD(v,E,O,D),XD(v,E,O,D)):(XD(v,E,O,D),ZD(v,E,O,D))}(c,n,a,h.path,p),c.restore())}function ZD(c,n,a,h){const p=a.fill;if(!p)return;const v=p.opacity/255;switch(c.save(),c.beginPath(),tR(a,c),p.paint){case"rgb_color":c.fillStyle=ov(p.rgb_color,p.opacity,h);break;case"linear_gradient_idx":{const x=n.linear_gradients[p.linear_gradient_idx];x.transform&&c.setTransform(av(x.transform).preMultiplySelf(c.getTransform())),c.fillStyle=YD(c,x,v,h);break}case"radial_gradient_idx":{const x=n.radial_gradients[p.radial_gradient_idx];x.transform&&c.setTransform(av(x.transform).preMultiplySelf(c.getTransform())),c.fillStyle=KD(c,x,v,h)}}c.fill(WD(a)),c.restore()}function WD(c){return c.rule===pS.PATH_RULE_NON_ZERO?"nonzero":c.rule===pS.PATH_RULE_EVEN_ODD?"evenodd":void 0}function XD(c,n,a,h){const p=a.stroke;if(!p)return;const v=nR(a);c.lineWidth=p.width,c.miterLimit=p.miterlimit,c.setLineDash(p.dasharray),c.lineDashOffset=p.dashoffset;const x=p.opacity/255;switch(p.paint){case"rgb_color":c.strokeStyle=ov(p.rgb_color,p.opacity,h);break;case"linear_gradient_idx":c.strokeStyle=YD(c,n.linear_gradients[p.linear_gradient_idx],x,h,!0);break;case"radial_gradient_idx":c.strokeStyle=KD(c,n.radial_gradients[p.radial_gradient_idx],x,h,!0)}switch(p.linejoin){case Mw.LINE_JOIN_MITER_CLIP:case Mw.LINE_JOIN_MITER:c.lineJoin="miter";break;case Mw.LINE_JOIN_ROUND:c.lineJoin="round";break;case Mw.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(p.linecap){case mS.LINE_CAP_BUTT:c.lineCap="butt";break;case mS.LINE_CAP_ROUND:c.lineCap="round";break;case mS.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(v)}function YD(c,n,a,h,p=!1){if(n.stops.length===1){const U=n.stops[0];return ov(U.rgb_color,U.opacity*a,h)}const{x1:v,y1:x,x2:E,y2:O}=n;let D=new DOMPoint(v,x),B=new DOMPoint(E,O);if(p){const U=av(n.transform);D=U.transformPoint(D),B=U.transformPoint(B)}const F=c.createLinearGradient(D.x,D.y,B.x,B.y);for(const U of n.stops)F.addColorStop(U.offset,ov(U.rgb_color,U.opacity*a,h));return F}function KD(c,n,a,h,p=!1){if(n.stops.length===1){const _e=n.stops[0];return ov(_e.rgb_color,_e.opacity*a,h)}const v=av(n.transform),{fx:x,fy:E,fr:O,cx:D,cy:B,r:F}=n;let U=new DOMPoint(x,E),Z=new DOMPoint(D,B),Y=O,re=F;if(p){U=v.transformPoint(U),Z=v.transformPoint(Z);const _e=(v.a+v.d)/2;Y=O*_e,re=n.r*_e}const he=c.createRadialGradient(U.x,U.y,Y,Z.x,Z.y,re);for(const _e of n.stops)he.addColorStop(_e.offset,ov(_e.rgb_color,_e.opacity*a,h));return he}function JD(c,n,a,h){const p=h.transform?av(h.transform).preMultiplySelf(n):n,v=G0(c.canvas.width,c.canvas.height),x=v.getContext("2d");for(const O of h.children)if(O.group)JD(x,p,a,O.group);else if(O.path){const D=O.path,B=new Path2D;B.addPath(nR(D),p),x.fill(B,WD(D))}const E=h.clip_path_idx!=null?a.clip_paths[h.clip_path_idx]:null;E&&QD(x,p,a,E),c.globalCompositeOperation="source-over",c.drawImage(v,0,0)}function QD(c,n,a,h){const p=G0(c.canvas.width,c.canvas.height);JD(p.getContext("2d"),n,a,h),c.globalCompositeOperation="destination-in",c.drawImage(p,0,0)}function eR(c,n,a,h,p){if(h.children.length===0)return;const v=h.mask_idx!=null?a.masks[h.mask_idx]:null;v&&eR(c,n,a,v,p);const x=c.canvas.width,E=c.canvas.height,O=G0(x,E),D=O.getContext("2d"),B=h.width,F=h.height,U=h.left,Z=h.top,Y=new Path2D,re=new Path2D;re.rect(U,Z,B,F),Y.addPath(re,n),D.clip(Y);for(const Se of h.children)GD(D,n,a,Se,p);const he=D.getImageData(0,0,x,E),_e=he.data;if(h.mask_type===$D.MASK_TYPE_LUMINANCE)for(let Se=0;Se<_e.length;Se+=4)_e[Se+3]=_e[Se+3]/255*(.2126*_e[Se]+.7152*_e[Se+1]+.0722*_e[Se+2]);D.putImageData(he,0,0),c.globalCompositeOperation="destination-in",c.drawImage(O,0,0)}function av(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function tR(c,n){const a=c.step;let h=c.diffs[0]*a,p=c.diffs[1]*a;n.moveTo(h,p);for(let v=0,x=2;v<c.commands.length;v++)switch(c.commands[v]){case H0.PATH_COMMAND_MOVE:h+=c.diffs[x++]*a,p+=c.diffs[x++]*a,n.moveTo(h,p);break;case H0.PATH_COMMAND_LINE:h+=c.diffs[x++]*a,p+=c.diffs[x++]*a,n.lineTo(h,p);break;case H0.PATH_COMMAND_QUAD:{const E=h+c.diffs[x++]*a,O=p+c.diffs[x++]*a;h=E+c.diffs[x++]*a,p=O+c.diffs[x++]*a,n.quadraticCurveTo(E,O,h,p);break}case H0.PATH_COMMAND_CUBIC:{const E=h+c.diffs[x++]*a,O=p+c.diffs[x++]*a,D=E+c.diffs[x++]*a,B=O+c.diffs[x++]*a;h=D+c.diffs[x++]*a,p=B+c.diffs[x++]*a,n.bezierCurveTo(E,O,D,B,h,p);break}case H0.PATH_COMMAND_CLOSE:n.closePath()}return n}function nR(c){return tR(c,new Path2D)}class Rw{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const a=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,a),a}put(n,a){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,a)}delete(n){this.cache.delete(n)}}Nn(Rw,"LRUCache");class _S{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new Cs(n,n.data)}getFromCache(n,a,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new Rw(150)),this.cacheMap.get(h).get(Yh(n.toString(),a))}setInCache(n,a,h,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new Rw(150));const v=this.cacheDependenciesMap.get(p),x=Yh(n.id.toString(),h);v.get(x)||v.set(x,new Set);const E=this.cacheMap.get(p),O=n.toString();v.get(x).add(O),E.put(Yh(n.toString(),h),a)}removeImagesFromCacheByIds(n,a,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const p=this.cacheMap.get(h),v=this.cacheDependenciesMap.get(h);for(const x of n){const E=Yh(x.toString(),a);if(v.has(E)){for(const O of v.get(E))p.delete(O);v.delete(E)}}}rasterize(n,a,h,p,v=Aq){const x=this.getFromCache(n,h,p);if(x)return x.clone();const E=v(a.icon,n.options),O=_S._getImage(E);return this.setInCache(n,O,h,p),O.clone()}}class iR{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,a){const h=this.toIdx(n,a);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(n,a){return this.leaves[this.toIdx(n,a)]}toIdx(n,a){return a*this.size+n}}function rR(c,n,a,h){let p=0,v=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(h[x])<1e-15){if(a[x]<c[x]||a[x]>n[x])return null}else{const E=1/h[x];let O=(c[x]-a[x])*E,D=(n[x]-a[x])*E;if(O>D){const B=O;O=D,D=B}if(O>p&&(p=O),D<v&&(v=D),p>v)return null}return p}function oR(c,n,a,h,p,v,x,E,O,D,B){const F=h-c,U=p-n,Z=v-a,Y=x-c,re=E-n,he=O-a,_e=B[1]*he-B[2]*re,Se=B[2]*Y-B[0]*he,Ce=B[0]*re-B[1]*Y,le=F*_e+U*Se+Z*Ce;if(Math.abs(le)<1e-15)return null;const Te=1/le,Me=D[0]-c,Re=D[1]-n,et=D[2]-a,Ye=(Me*_e+Re*Se+et*Ce)*Te;if(Ye<0||Ye>1)return null;const it=Re*Z-et*U,dt=et*F-Me*Z,Ct=Me*U-Re*F,tn=(B[0]*it+B[1]*dt+B[2]*Ct)*Te;return tn<0||Ye+tn>1?null:(Y*it+re*dt+he*Ct)*Te}function aR(c,n,a){return(c-n)/(a-n)}function sR(c,n,a,h,p,v,x,E,O){const D=1<<a,B=v-h,F=x-p,U=(c+1)/D*B+h,Z=(n+0)/D*F+p,Y=(n+1)/D*F+p;E[0]=(c+0)/D*B+h,E[1]=Z,O[0]=U,O[1]=Y}class lR{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(v){const x=Math.ceil(Math.log2(v.dim/8)),E=[];let O=Math.ceil(Math.pow(2,x));const D=1/O,B=(Z,Y,re,he,_e)=>{const Se=he?1:0,Ce=(Z+1)*re-Se,le=Y*re,Te=(Y+1)*re-Se;_e[0]=Z*re,_e[1]=le,_e[2]=Ce,_e[3]=Te};let F=new iR(O);const U=[];for(let Z=0;Z<O*O;Z++){B(Z%O,Math.floor(Z/O),D,!1,U);const Y=ug(U[0],U[1],v),re=ug(U[2],U[1],v),he=ug(U[2],U[3],v),_e=ug(U[0],U[3],v);F.minimums.push(Math.min(Y,re,he,_e)),F.maximums.push(Math.max(Y,re,he,_e)),F.leaves.push(1)}for(E.push(F),O/=2;O>=1;O/=2){const Z=E[E.length-1];F=new iR(O);for(let Y=0;Y<O*O;Y++){B(Y%O,Math.floor(Y/O),2,!0,U);const re=Z.getElevation(U[0],U[1]),he=Z.getElevation(U[2],U[1]),_e=Z.getElevation(U[2],U[3]),Se=Z.getElevation(U[0],U[3]),Ce=Z.isLeaf(U[0],U[1]),le=Z.isLeaf(U[2],U[1]),Te=Z.isLeaf(U[2],U[3]),Me=Z.isLeaf(U[0],U[3]),Re=Math.min(re.min,he.min,_e.min,Se.min),et=Math.max(re.max,he.max,_e.max,Se.max),Ye=Ce&&le&&Te&&Me;F.maximums.push(et),F.minimums.push(Re),F.leaves.push(et-Re<=5&&Ye?1:0)}E.push(F)}return E}(this.dem),h=a.length-1,p=a[h];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(a,0,0,h,0)}raycastRoot(n,a,h,p,v,x,E=1){return rR([n,a,-100],[h,p,this.maximums[0]*E],v,x)}raycast(n,a,h,p,v,x,E=1){if(!this.nodeCount)return null;const O=this.raycastRoot(n,a,h,p,v,x,E);if(O==null)return null;const D=[],B=[],F=[],U=[],Z=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;Z.length>0;){const{idx:Y,t:re,nodex:he,nodey:_e,depth:Se}=Z.pop();if(this.leaves[Y]){sR(he,_e,Se,n,a,h,p,F,U);const le=1<<Se,Te=(he+0)/le,Me=(he+1)/le,Re=(_e+0)/le,et=(_e+1)/le,Ye=ug(Te,Re,this.dem)*E,it=ug(Me,Re,this.dem)*E,dt=ug(Me,et,this.dem)*E,Ct=ug(Te,et,this.dem)*E,tn=oR(F[0],F[1],Ye,U[0],F[1],it,U[0],U[1],dt,v,x),qt=oR(U[0],U[1],dt,F[0],U[1],Ct,F[0],F[1],Ye,v,x),Jt=Math.min(tn!==null?tn:Number.MAX_VALUE,qt!==null?qt:Number.MAX_VALUE);if(Jt!==Number.MAX_VALUE)return Jt;{const sn=Pt([],v,x,re);if(cR(Ye,it,Ct,dt,aR(sn[0],F[0],U[0]),aR(sn[1],F[1],U[1]))>=sn[2])return re}continue}let Ce=0;for(let le=0;le<this._siblingOffset.length;le++){sR((he<<1)+this._siblingOffset[le][0],(_e<<1)+this._siblingOffset[le][1],Se+1,n,a,h,p,F,U),F[2]=-100,U[2]=this.maximums[this.childOffsets[Y]+le]*E;const Te=rR(F,U,v,x);if(Te!=null){const Me=Te;D[le]=Me;let Re=!1;for(let et=0;et<Ce&&!Re;et++)Me>=D[B[et]]&&(B.splice(et,0,le),Re=!0);Re||(B[Ce]=le),Ce++}}for(let le=0;le<Ce;le++){const Te=B[le];Z.push({idx:this.childOffsets[Y]+Te,t:D[Te],nodex:(he<<1)+this._siblingOffset[Te][0],nodey:(_e<<1)+this._siblingOffset[Te][1],depth:Se+1})}}return null}_addNode(n,a,h){return this.minimums.push(n),this.maximums.push(a),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(n,a,h,p,v){if(n[p].isLeaf(a,h)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const x=p-1,E=n[x];let O=0,D=0;for(let B=0;B<this._siblingOffset.length;B++){const F=2*a+this._siblingOffset[B][0],U=2*h+this._siblingOffset[B][1],Z=E.getElevation(F,U),Y=E.isLeaf(F,U),re=this._addNode(Z.min,Z.max,Y);Y&&(O|=1<<B),D||(D=re)}for(let B=0;B<this._siblingOffset.length;B++)O&1<<B||this._construct(n,2*a+this._siblingOffset[B][0],2*h+this._siblingOffset[B][1],x,D+B)}}function cR(c,n,a,h,p,v){return Xn(Xn(c,a,v),Xn(n,h,v),p)}function ug(c,n,a){const h=a.dim,p=be(c*h-.5,0,h-1),v=be(n*h-.5,0,h-1),x=Math.floor(p),E=Math.floor(v),O=Math.min(x+1,h-1),D=Math.min(E+1,h-1);return cR(a.get(x,E),a.get(O,E),a.get(x,D),a.get(O,D),p-x,v-E)}const Pq={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Cq(c,n,a){return(256*c*256+256*n+a)/10-1e4}function Mq(c,n,a){return 256*c+n+a/256-32768}class Lw{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,a,h,p=!1){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void ui(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const v=this.dim=a.height-2,x=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let O=0;O<v;O++)x[this._idx(-1,O)]=x[this._idx(0,O)],x[this._idx(v,O)]=x[this._idx(v-1,O)],x[this._idx(O,-1)]=x[this._idx(O,0)],x[this._idx(O,v)]=x[this._idx(O,v-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(v,-1)]=x[this._idx(v-1,0)],x[this._idx(-1,v)]=x[this._idx(0,v-1)],x[this._idx(v,v)]=x[this._idx(v-1,v-1)]}const E=h==="terrarium"?Mq:Cq;for(let O=0;O<x.length;++O){const D=4*O;this.floatView[O]=E(this.pixels[D],this.pixels[D+1],this.pixels[D+2])}this._timestamp=xs.now()}_buildQuadTree(){this._tree=new lR(this)}get(n,a,h=!1){h&&(n=be(n,-1,this.dim),a=be(a,-1,this.dim));const p=this._idx(n,a);return this.floatView[p]}set(n,a,h){const p=this._idx(n,a),v=this.floatView[p];return this.floatView[p]=h,h-v}static getUnpackVector(n){return Pq[n]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}static pack(n,a){const h=[0,0,0,0],p=Lw.getUnpackVector(a);let v=Math.floor((n+p[3])/p[2]);return h[2]=v%256,v=Math.floor(v/256),h[1]=v%256,v=Math.floor(v/256),h[0]=v,h}getPixels(){return new zb({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,a,h){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,v=a*this.dim+this.dim,x=h*this.dim,E=h*this.dim+this.dim;switch(a){case-1:p=v-1;break;case 1:v=p+1}switch(h){case-1:x=E-1;break;case 1:E=x+1}const O=-a*this.dim,D=-h*this.dim;for(let B=x;B<E;B++)for(let F=p;F<v;F++){const U=4*this._idx(F,B),Z=4*this._idx(F+O,B+D);this.pixels[U+0]=n.pixels[Z+0],this.pixels[U+1]=n.pixels[Z+1],this.pixels[U+2]=n.pixels[Z+2],this.pixels[U+3]=n.pixels[Z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Oq(c,n,a){c===1?n.headerLength=a.readFixed32():c===2?n.x=a.readVarint():c===3?n.y=a.readVarint():c===4?n.z=a.readVarint():c===5&&n.layers.push(function(h,p){return h.readFields(zq,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(a,a.readVarint()+a.pos))}function Iq(c,n,a){c===1?(n.delta_filter=function(h,p){return h.readFields(Dq,{blockSize:0},p)}(a,a.readVarint()+a.pos),n.filter="delta_filter"):c===2?(a.readVarint(),n.filter="zigzag_filter"):c===3?(a.readVarint(),n.filter="bitshuffle_filter"):c===4&&(a.readVarint(),n.filter="byteshuffle_filter")}function Dq(c,n,a){c===1&&(n.blockSize=a.readVarint())}function Rq(c,n,a){c===1?(a.readVarint(),n.codec="gzip_data"):c===2?(a.readVarint(),n.codec="jpeg_image"):c===3?(a.readVarint(),n.codec="webp_image"):c===4&&(a.readVarint(),n.codec="png_image")}function Lq(c,n,a){let h=0,p=0;c===1?n.firstByte=a.readFixed64():c===2?n.lastByte=a.readFixed64():c===3?n.filters.push(function(v,x){return v.readFields(Iq,{},x)}(a,a.readVarint()+a.pos)):c===4?n.codec=function(v,x){return v.readFields(Rq,{},x)}(a,a.readVarint()+a.pos):c===5?p=a.readFloat():c===6?h=a.readFloat():c===7?n.bands.push(a.readString()):c===8?n.offset=a.readDouble():c===9&&(n.scale=a.readDouble()),n.offset===0&&(n.offset=p),n.scale===0&&(n.scale=h)}function zq(c,n,a){c===1?n.version=a.readVarint():c===2?n.name=a.readString():c===3?n.units=a.readString():c===4?n.tileSize=a.readVarint():c===5?n.buffer=a.readVarint():c===6?n.pixelFormat=a.readVarint():c===7&&n.dataIndex.push(function(h,p){return h.readFields(Lq,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(a,a.readVarint()+a.pos))}function kq(c,n,a){if(c===2)(function(h,p,v){h.readFields(Nq,v,p)})(a,a.readVarint()+a.pos,n);else if(c===3)throw new Error("Not implemented")}function Nq(c,n,a){if(c===1){let h=0;const p=a.readVarint()+a.pos;for(;a.pos<p;)n[h++]=a.readVarint()}}function Bq(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let a=n[3];for(let h=2;h>=1;h--){const p=h===1?1:0,v=h===2?1:0;for(let x=0;x<n[0];x++){const E=n[1]*x;for(let O=p;O<n[1];O++){const D=n[2]*(O+E);for(let B=v;B<n[2];B++){const F=n[3]*(B+D);for(let U=0;U<n[3];U++){const Z=F+U;c[Z]+=c[Z-a]}}}}a*=n[h]}return c}function jq(c){for(let n=0,a=c.length;n<a;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function Fq(c,n){switch(n){case"uint32":return c;case"uint16":for(let a=0;a<c.length;a+=2){const h=c[a],p=c[a+1];c[a]=(240&h)>>4|(61440&h)>>8|(240&p)<<4|61440&p,c[a+1]=15&h|(3840&h)>>4|(15&p)<<8|(3840&p)<<4}return c;case"uint8":for(let a=0;a<c.length;a+=4){const h=c[a],p=c[a+1],v=c[a+2],x=c[a+3];c[a+0]=(192&h)>>6|(192&p)>>4|(192&v)>>2|192&x,c[a+1]=(48&h)>>4|(48&p)>>2|48&v|(48&x)<<2,c[a+2]=(12&h)>>2|12&p|(12&v)<<2|(12&x)<<4,c[a+3]=3&h|(3&p)<<2|(3&v)<<4|(3&x)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}Nn(Lw,"DEMData"),Nn(lR,"DemMinMaxQuadTree",{omit:["dem"]});var dh=Uint8Array,Z0=Uint16Array,Uq=Int32Array,uR=new dh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hR=new dh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Vq=new dh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dR=function(c,n){for(var a=new Z0(31),h=0;h<31;++h)a[h]=n+=1<<c[h-1];var p=new Uq(a[30]);for(h=1;h<30;++h)for(var v=a[h];v<a[h+1];++v)p[v]=v-a[h]<<5|h;return{b:a,r:p}},fR=dR(uR,2),pR=fR.b,$q=fR.r;pR[28]=258,$q[258]=28;for(var qq=dR(hR,0).b,mR=new Z0(32768),os=0;os<32768;++os){var sv=(43690&os)>>1|(21845&os)<<1;mR[os]=((65280&(sv=(61680&(sv=(52428&sv)>>2|(13107&sv)<<2))>>4|(3855&sv)<<4))>>8|(255&sv)<<8)>>1}var W0=function(c,n,a){for(var h=c.length,p=0,v=new Z0(n);p<h;++p)c[p]&&++v[c[p]-1];var x,E=new Z0(n);for(p=1;p<n;++p)E[p]=E[p-1]+v[p-1]<<1;x=new Z0(1<<n);var O=15-n;for(p=0;p<h;++p)if(c[p])for(var D=p<<4|c[p],B=n-c[p],F=E[c[p]-1]++<<B,U=F|(1<<B)-1;F<=U;++F)x[mR[F]>>O]=D;return x},X0=new dh(288);for(os=0;os<144;++os)X0[os]=8;for(os=144;os<256;++os)X0[os]=9;for(os=256;os<280;++os)X0[os]=7;for(os=280;os<288;++os)X0[os]=8;var gR=new dh(32);for(os=0;os<32;++os)gR[os]=5;var Hq=W0(X0,9),Gq=W0(gR,5),yS=function(c){for(var n=c[0],a=1;a<c.length;++a)c[a]>n&&(n=c[a]);return n},lf=function(c,n,a){var h=n/8|0;return(c[h]|c[h+1]<<8)>>(7&n)&a},vS=function(c,n){var a=n/8|0;return(c[a]|c[a+1]<<8|c[a+2]<<16)>>(7&n)},Zq=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],cf=function(c,n,a){var h=new Error(n||Zq[c]);if(h.code=c,Error.captureStackTrace&&Error.captureStackTrace(h,cf),!a)throw h;return h},Wq=new dh(0),Xq=typeof TextDecoder<"u"&&new TextDecoder;try{Xq.decode(Wq,{stream:!0})}catch{}const Yq={gzip_data:"gzip"};class ad extends Error{constructor(n){super(n),this.name="MRTError"}}const Kq={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},_R={uint32:1,uint16:2,uint8:4},Jq={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let xS;class zw{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const a=this.layers[n];if(!a)throw new ad(`Layer '${n}' not found`);return a}getHeaderLength(n){const a=new Uint8Array(n),h=new DataView(n);if(a[0]!==13)throw new ad("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(n){const a=new Uint8Array(n),h=this.getHeaderLength(n);if(a.length<h)throw new ad(`Expected header with length >= ${h} but got buffer of length ${a.length}`);const p=function(v,x){return v.readFields(Oq,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new xS(a.subarray(0,h)));if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new ad(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const v of p.layers)this.layers[v.name]=new yR(v,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const a=[],h=this.getLayer(n.layerName);for(let p of n.blockIndices){const v=h.dataIndex[p],x=v.firstByte-n.firstByte,E=v.lastByte-n.firstByte;if(h._blocksInProgress.has(p))continue;const O={layerName:h.name,firstByte:x,lastByte:E,pixelFormat:h.pixelFormat,blockIndex:p,blockShape:[v.bands.length].concat(h.bandShape),buffer:h.buffer,codec:v.codec.codec,filters:v.filters.map(D=>D.filter)};h._blocksInProgress.add(p),a.push(O)}return new vR(a,()=>{a.forEach(p=>h._blocksInProgress.delete(p.blockIndex))},(p,v)=>{if(a.forEach(x=>h._blocksInProgress.delete(x.blockIndex)),p)throw p;v.forEach(x=>{this.getLayer(x.layerName).processDecodedData(x)})})}}class yR{constructor({version:n,name:a,units:h,tileSize:p,pixelFormat:v,buffer:x,dataIndex:E},O){if(this.version=n,this.version!==1)throw new ad(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=a,this.units=h,this.tileSize=p,this.buffer=x,this.pixelFormat=Kq[v],this.dataIndex=E,this.bandShape=[p+2*x,p+2*x,_R[this.pixelFormat]],this._decodedBlocks=new Rw(O?O.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return _R[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const a=n.blockIndex.toString();this._decodedBlocks.get(a)||this._decodedBlocks.put(a,n.data)}getBlockForBand(n){let a=0;switch(typeof n){case"string":for(const[h,p]of this.dataIndex.entries()){for(const[v,x]of p.bands.entries())if(x===n)return{bandIndex:a+v,blockIndex:h,blockBandIndex:v};a+=p.bands.length}break;case"number":for(const[h,p]of this.dataIndex.entries()){if(n>=a&&n<a+p.bands.length)return{bandIndex:n,blockIndex:h,blockBandIndex:n-a};a+=p.bands.length}break;default:throw new ad(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(n){let a=1/0,h=-1/0;const p=[],v=new Set;for(const x of n){const{blockIndex:E}=this.getBlockForBand(x);if(E<0)throw new ad(`Invalid band: ${JSON.stringify(x)}`);const O=this.dataIndex[E];p.includes(E)||p.push(E),v.add(E),a=Math.min(a,O.firstByte),h=Math.max(h,O.lastByte)}if(v.size>this.cacheSize)throw new ad(`Number of blocks to decode (${v.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:a,lastByte:h,blockIndices:p}}hasBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0}hasDataForBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0&&!!this._decodedBlocks.get(a.toString())}getBandView(n){const{blockIndex:a,blockBandIndex:h}=this.getBlockForBand(n);if(a<0)throw new ad(`Band not found: ${JSON.stringify(n)}`);const p=this._decodedBlocks.get(a.toString());if(!p)throw new ad(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const v=this.dataIndex[a],x=this.bandShape.reduce((D,B)=>D*B,1),E=h*x,O=p.subarray(E,E+x);return{data:O,bytes:new Uint8Array(O.buffer).subarray(O.byteOffset,O.byteOffset+O.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:v.offset,scale:v.scale}}}zw.setPbf=function(c){xS=c};class vR{constructor(n,a,h){this.tasks=n,this._onCancel=a,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,a){this._finalized||(this._onComplete(n,a),this._finalized=!0)}}function I_(c,n){const a=c.json.bufferViews[n.bufferView],h=nw[n.componentType];return new h(c.buffers[a.buffer],(n.byteOffset||0)+(a.byteOffset||0),n.count*(a.byteStride&&a.byteStride!==I0[n.type]*h.BYTES_PER_ELEMENT?a.byteStride/h.BYTES_PER_ELEMENT:I0[n.type]))}function bS(c,n,a,h){const p=nw[n.componentType],v=function(B){switch(B){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),x=c.json.bufferViews[n.bufferView],E=x.byteStride?x.byteStride/p.BYTES_PER_ELEMENT:I0[n.type],O=a.float32,D=O.length/a.capacity;for(let B=0,F=0;B<n.count*E;B+=E,F+=D)for(let U=0;U<D;U++)O[F+U]=h[B+U]*v;a._trim()}function Qq(c,n,a){const h=c.indices,p=c.attributes,v={};v.indexArray=new ra;const x=n.json.accessors[h],E=x.count/3;v.indexArray.reserve(E);const O=I_(n,x);for(let U=0;U<E;U++)v.indexArray.emplaceBack(O[3*U],O[3*U+1],O[3*U+2]);v.indexArray._trim(),v.vertexArray=new jl;const D=n.json.accessors[p.POSITION];v.vertexArray.reserve(D.count);const B=I_(n,D);for(let U=0;U<D.count;U++)v.vertexArray.emplaceBack(B[3*U],B[3*U+1],B[3*U+2]);if(v.vertexArray._trim(),v.aabb=new sr(D.min,D.max),v.centroid=function(U,Z){const Y=[0,0,0],re=U.length;if(re>0){for(let he=0;he<re;he++){const _e=3*U[he];Y[0]+=Z[_e],Y[1]+=Z[_e+1],Y[2]+=Z[_e+2]}Y[0]/=re,Y[1]/=re,Y[2]/=re}return Y}(O,B),p.COLOR_0!==void 0){const U=n.json.accessors[p.COLOR_0],Z=I0[U.type],Y=I_(n,U);v.colorArray=Z===3?new jl:new Ta,v.colorArray.resize(U.count),bS(n,U,v.colorArray,Y)}if(p.NORMAL!==void 0){v.normalArray=new jl;const U=n.json.accessors[p.NORMAL];v.normalArray.resize(U.count);const Z=I_(n,U);bS(n,U,v.normalArray,Z)}if(p.TEXCOORD_0!==void 0&&a.length>0){v.texcoordArray=new Iu;const U=n.json.accessors[p.TEXCOORD_0];v.texcoordArray.resize(U.count);const Z=I_(n,U);bS(n,U,v.texcoordArray,Z)}if(p._FEATURE_ID_RGBA4444!==void 0){const U=n.json.accessors[p._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(v.featureData=I_(n,U))}p._FEATURE_RGBA4444!==void 0&&(v.featureData=new Uint32Array(I_(n,n.json.accessors[p._FEATURE_RGBA4444]).buffer));const F=c.material;return v.material=function(U,Z){const{emissiveFactor:Y=[0,0,0],alphaMode:re="OPAQUE",alphaCutoff:he=.5,normalTexture:_e,occlusionTexture:Se,emissiveTexture:Ce,doubleSided:le}=U,{baseColorFactor:Te=[1,1,1,1],metallicFactor:Me=1,roughnessFactor:Re=1,baseColorTexture:et,metallicRoughnessTexture:Ye}=U.pbrMetallicRoughness||{},it=Se?Z[Se.index]:void 0;if(Se&&Se.extensions&&Se.extensions.KHR_texture_transform&&it){const dt=Se.extensions.KHR_texture_transform;it.offsetScale=[dt.offset[0],dt.offset[1],dt.scale[0],dt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Di(...Te),metallicFactor:Me,roughnessFactor:Re,baseColorTexture:et?Z[et.index]:void 0,metallicRoughnessTexture:Ye?Z[Ye.index]:void 0},doubleSided:le,emissiveFactor:new Di(...Y),alphaMode:re,alphaCutoff:he,normalTexture:_e?Z[_e.index]:void 0,occlusionTexture:it,emissionTexture:Ce?Z[Ce.index]:void 0,defined:U.defined===void 0}}(F!==void 0?n.json.materials[F]:{defined:!1},a),v}function xR(c,n,a){const{matrix:h,rotation:p,translation:v,scale:x,mesh:E,extras:O,children:D}=c,B={};if(B.matrix=h||function(F,U,Z,Y){var re=U[0],he=U[1],_e=U[2],Se=U[3],Ce=re+re,le=he+he,Te=_e+_e,Me=re*Ce,Re=re*le,et=re*Te,Ye=he*le,it=he*Te,dt=_e*Te,Ct=Se*Ce,tn=Se*le,qt=Se*Te,Jt=Y[0],sn=Y[1],Ot=Y[2];return F[0]=(1-(Ye+dt))*Jt,F[1]=(Re+qt)*Jt,F[2]=(et-tn)*Jt,F[3]=0,F[4]=(Re-qt)*sn,F[5]=(1-(Me+dt))*sn,F[6]=(it+Ct)*sn,F[7]=0,F[8]=(et+tn)*Ot,F[9]=(it-Ct)*Ot,F[10]=(1-(Me+Ye))*Ot,F[11]=0,F[12]=Z[0],F[13]=Z[1],F[14]=Z[2],F[15]=1,F}([],p||[0,0,0,1],v||[0,0,0],x||[1,1,1]),E!==void 0){B.meshes=a[E];const F=B.anchor=[0,0];for(const U of B.meshes){const{min:Z,max:Y}=U.aabb;F[0]+=Z[0]+Y[0],F[1]+=Z[1]+Y[1]}F[0]=Math.floor(F[0]/B.meshes.length/2),F[1]=Math.floor(F[1]/B.meshes.length/2)}if(O&&(O.id&&(B.id=O.id),O.lights&&(B.lights=function(F){if(!F.length)return[];const U=function(_e){const Se=atob(_e),Ce=new Uint8Array(Se.length);for(let le=0;le<Se.length;le++)Ce[le]=Se.codePointAt(le);return Ce}(F),Z=[],Y=U.length/24,re=new Uint16Array(U.buffer),he=new Float32Array(U.buffer);for(let _e=0;_e<Y;_e++){const Se=re[2*_e*6]/30,Ce=re[2*_e*6+1]/30,le=re[2*_e*6+10]/100,Te=he[6*_e+1],Me=he[6*_e+2],Re=he[6*_e+3],et=he[6*_e+4],Ye=Re-Te,it=et-Me,dt=Math.hypot(Ye,it);Z.push({pos:[Te+.5*Ye,Me+.5*it,Ce],normal:[it/dt,-Ye/dt,0],width:dt,height:Se,depth:le,points:[Te,Me,Re,et]})}return Z}(O.lights))),D){const F=[];for(const U of D)F.push(xR(n.json.nodes[U],n,a));B.children=F}return B}function eH(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new tm(c.vertices,c.indices,8,256),[a,h]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:a,max:h}}function tH(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const a=n[0];if(!a||!Array.isArray(a)||a.length===0)return null;const h=[];for(const x of a){if(!Array.isArray(x)||x.length!==2)continue;const E=x[0],O=x[1];typeof E=="number"&&typeof O=="number"&&h.push(new hn(E,O))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let p=0;for(let x=0;x<h.length;x++){const E=h[x],O=h[(x+1)%h.length],D=h[(x+2)%h.length];p+=(E.x-O.x)*(D.y-O.y)-(D.x-O.x)*(E.y-O.y)}p>0&&h.reverse();const v=Zp(h.flatMap(x=>[x.x,x.y]),[]);return v.length===0?null:{vertices:h,indices:v}}function nH(c,n){const a=[],h=[];let p=0;const v=[];for(const x of c){p=a.length;const E=x.vertexArray.float32,O=x.indexArray.uint16;for(let D=0;D<x.vertexArray.length;D++)v[0]=E[3*D+0],v[1]=E[3*D+1],v[2]=E[3*D+2],Dt(v,v,n),a.push(new hn(v[0],v[1]));for(let D=0;D<3*x.indexArray.length;D++)h.push(O[D]+p)}if(h.length%3!=0)return null;for(let x=0;x<h.length;x+=3){const E=a[h[x+0]],O=a[h[x+1]],D=a[h[x+2]];(E.x-O.x)*(D.y-O.y)-(D.x-O.x)*(E.y-O.y)>0&&([h[x+1],h[x+2]]=[h[x+2],h[x+1]])}return{vertices:a,indices:h}}function bR(c){const n=function(O,D){const B=[],F=WebGL2RenderingContext;if(O.json.textures)for(const U of O.json.textures){const Z={magFilter:F.LINEAR,minFilter:F.NEAREST,wrapS:F.REPEAT,wrapT:F.REPEAT};U.sampler!==void 0&&Object.assign(Z,O.json.samplers[U.sampler]),B.push({image:D[U.source],sampler:Z,uploaded:!1})}return B}(c,c.images),a=function(O,D){const B=[];for(const F of O.json.meshes){const U=[];for(const Z of F.primitives)U.push(Qq(Z,O,D));B.push(U)}return B}(c,n),{scenes:h,scene:p,nodes:v}=c.json,x=h?h[p||0].nodes:v,E=[];for(const O of x)E.push(xR(v[O],c,a));return function(O,D,B){const F={},U=new Set;for(let Z=0;Z<O.length;Z++){const Y=B[D[Z]];if(!Y.extras)continue;const re=Y.extras["mapbox:footprint:version"],he=Y.extras["mapbox:footprint:id"];(re||he)&&U.add(Z),re==="1.0.0"&&he&&(F[he]=Z)}for(let Z=0;Z<O.length;Z++){if(U.has(Z))continue;const Y=O[Z],re=B[D[Z]];if(!re.extras)continue;let he=null;Y.id in F&&(he=nH(O[F[Y.id]].meshes,Y.matrix)),he||(he=tH(re)),he&&(Y.footprint=eH(he))}if(U.size>0){const Z=Array.from(U.values()).sort((Y,re)=>Y-re);for(let Y=Z.length-1;Y>=0;Y--)O.splice(Z[Y],1)}}(E,x,c.json.nodes),E}function iH(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,a=c.aabb.min[0]-1,h=c.aabb.min[1]-1,p=M_/(c.aabb.max[0]-a+2),v=M_/(c.aabb.max[1]-h+2);for(let x=0;x<n.length;x+=3){const E=n[x+2],O=(n[x+0]-a)*p|0,D=(n[x+1]-h)*v|0;E>c.heightmap[D*M_+O]&&(c.heightmap[D*M_+O]=E)}}function rH(c,n){const a={};a.indexArray=new ra,a.indexArray.reserve(4*c.length),a.vertexArray=new jl,a.vertexArray.reserve(10*c.length),a.colorArray=new Ta,a.vertexArray.reserve(10*c.length);let h=0;for(const x of c){const E=Math.min(10,Math.max(4,1.3*x.height))*n,O=[-x.normal[1],x.normal[0],0],D=Math.min(.29,.1*x.width/x.depth),B=x.width-2*x.depth*n*(D+.01),F=Pt([],x.pos,O,B/2),U=Pt([],x.pos,O,-B/2),Z=[F[0],F[1],F[2]+x.height],Y=[U[0],U[1],U[2]+x.height],re=Pt([],x.normal,O,D);$e(re,re,E);const he=Pt([],x.normal,O,-D);$e(he,he,E),zt(re,F,re),zt(he,U,he),F[2]+=.1,U[2]+=.1,a.vertexArray.emplaceBack(re[0],re[1],re[2]),a.vertexArray.emplaceBack(he[0],he[1],he[2]),a.vertexArray.emplaceBack(F[0],F[1],F[2]),a.vertexArray.emplaceBack(U[0],U[1],U[2]),a.vertexArray.emplaceBack(Z[0],Z[1],Z[2]),a.vertexArray.emplaceBack(Y[0],Y[1],Y[2]),a.vertexArray.emplaceBack(F[0],F[1],F[2]),a.vertexArray.emplaceBack(U[0],U[1],U[2]),a.vertexArray.emplaceBack(re[0],re[1],re[2]),a.vertexArray.emplaceBack(he[0],he[1],he[2]);const _e=B/E/2;a.colorArray.emplaceBack(-_e-D,-1,_e,.8),a.colorArray.emplaceBack(_e+D,-1,_e,.8),a.colorArray.emplaceBack(-_e,0,_e,1.3),a.colorArray.emplaceBack(_e,0,_e,1.3),a.colorArray.emplaceBack(_e+D,-.8,_e,.7),a.colorArray.emplaceBack(_e+D,-.8,_e,.7),a.colorArray.emplaceBack(0,0,_e,1.3),a.colorArray.emplaceBack(0,0,_e,1.3),a.colorArray.emplaceBack(_e+D,-1.2,_e,.8),a.colorArray.emplaceBack(_e+D,-1.2,_e,.8),a.indexArray.emplaceBack(6+h,4+h,8+h),a.indexArray.emplaceBack(7+h,9+h,5+h),a.indexArray.emplaceBack(0+h,1+h,2+h),a.indexArray.emplaceBack(1+h,3+h,2+h),h+=10}const p={defined:!0};p.emissiveFactor=Di.black;const v={};return v.baseColorFactor=Di.white,p.pbrMetallicRoughness=v,a.material=p,a.aabb=new sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}zw.performDecoding=function(c,n){const a=new Uint8Array(c);return Promise.all(n.tasks.map(h=>{const{layerName:p,firstByte:v,lastByte:x,pixelFormat:E,blockShape:O,blockIndex:D,filters:B,codec:F}=h,U=a.subarray(v,x+1),Z=new Uint32Array(O[0]*O[1]*O[2]);let Y;if(F!=="gzip_data")throw new ad(`Unhandled codec: ${F}`);return Y=function(re,he){if(!globalThis.DecompressionStream&&he==="gzip_data")return Promise.resolve(((le=function(Re){Re[0]==31&&Re[1]==139&&Re[2]==8||cf(6,"invalid gzip data");var et=Re[3],Ye=10;4&et&&(Ye+=2+(Re[10]|Re[11]<<8));for(var it=(et>>3&1)+(et>>4&1);it>0;it-=!Re[Ye++]);return Ye+(2&et)}(Ce=re))+8>Ce.length&&cf(6,"invalid gzip data"),function(Re,et,Ye,it){var dt=Re.length;if(!dt||et.f&&!et.l)return Ye||new dh(0);var Ct=!Ye,tn=Ct||et.i!=2,qt=et.i;Ct&&(Ye=new dh(3*dt));var Jt,sn,Ot=function(Ko){var po=Ye.length;if(Ko>po){var no=new dh(Math.max(2*po,Ko));no.set(Ye),Ye=no}},Yt=et.f||0,At=et.p||0,Mt=et.b||0,dn=et.l,gn=et.d,oi=et.m,Zn=et.n,Sn=8*dt;do{if(!dn){Yt=lf(Re,At,1);var un=lf(Re,At+1,3);if(At+=3,!un){var bi=Re[(Ie=4+((At+7)/8|0))-4]|Re[Ie-3]<<8,Gn=Ie+bi;if(Gn>dt){qt&&cf(0);break}tn&&Ot(Mt+bi),Ye.set(Re.subarray(Ie,Gn),Mt),et.b=Mt+=bi,et.p=At=8*Gn,et.f=Yt;continue}if(un==1)dn=Hq,gn=Gq,oi=9,Zn=5;else if(un==2){var Wn=lf(Re,At,31)+257,mi=lf(Re,At+10,15)+4,Ci=Wn+lf(Re,At+5,31)+1;At+=14;for(var Ei=new dh(Ci),$i=new dh(19),Li=0;Li<mi;++Li)$i[Vq[Li]]=lf(Re,At+3*Li,7);At+=3*mi;var qi=yS($i),Ir=(1<<qi)-1,so=W0($i,qi);for(Li=0;Li<Ci;){var Ie,ze=so[lf(Re,At,Ir)];if(At+=15&ze,(Ie=ze>>4)<16)Ei[Li++]=Ie;else{var Lt=0,yn=0;for(Ie==16?(yn=3+lf(Re,At,3),At+=2,Lt=Ei[Li-1]):Ie==17?(yn=3+lf(Re,At,7),At+=3):Ie==18&&(yn=11+lf(Re,At,127),At+=7);yn--;)Ei[Li++]=Lt}}var Pn=Ei.subarray(0,Wn),wn=Ei.subarray(Wn);oi=yS(Pn),Zn=yS(wn),dn=W0(Pn,oi),gn=W0(wn,Zn)}else cf(1);if(At>Sn){qt&&cf(0);break}}tn&&Ot(Mt+131072);for(var Hn=(1<<oi)-1,pi=(1<<Zn)-1,Ji=At;;Ji=At){var Qi=(Lt=dn[vS(Re,At)&Hn])>>4;if((At+=15&Lt)>Sn){qt&&cf(0);break}if(Lt||cf(2),Qi<256)Ye[Mt++]=Qi;else{if(Qi==256){Ji=At,dn=null;break}var zi=Qi-254;Qi>264&&(zi=lf(Re,At,(1<<(er=uR[Li=Qi-257]))-1)+pR[Li],At+=er);var Rr=gn[vS(Re,At)&pi],to=Rr>>4;if(Rr||cf(3),At+=15&Rr,wn=qq[to],to>3){var er=hR[to];wn+=vS(Re,At)&(1<<er)-1,At+=er}if(At>Sn){qt&&cf(0);break}tn&&Ot(Mt+131072);var Do=Mt+zi;if(Mt<wn){var lo=0-wn,Dr=Math.min(wn,Do);for(lo+Mt<0&&cf(3);Mt<Dr;++Mt)Ye[Mt]=(void 0)[lo+Mt]}for(;Mt<Do;++Mt)Ye[Mt]=Ye[Mt-wn]}}et.l=dn,et.p=Ji,et.b=Mt,et.f=Yt,dn&&(Yt=1,et.m=oi,et.d=gn,et.n=Zn)}while(!Yt);return Mt!=Ye.length&&Ct?(Jt=Ye,((sn=Mt)==null||sn>Jt.length)&&(sn=Jt.length),new dh(Jt.subarray(0,sn))):Ye.subarray(0,Mt)}(Ce.subarray(le,-8),{i:2},new dh(((_e=Ce)[(Se=_e.length)-4]|_e[Se-3]<<8|_e[Se-2]<<16|_e[Se-1]<<24)>>>0))));var _e,Se,Ce,le;const Te=Yq[he];if(!Te)throw new Error(`Unhandled codec: ${he}`);const Me=new globalThis.DecompressionStream(Te);return new Response(new Blob([re]).stream().pipeThrough(Me)).arrayBuffer().then(Re=>new Uint8Array(Re))}(U,F).then(re=>(function(he,_e){he.readFields(kq,_e)}(new xS(re),Z),new Jq[E](Z.buffer))),Y.then(re=>{for(let he=B.length-1;he>=0;he--)switch(B[he]){case"delta_filter":Bq(re,O);break;case"zigzag_filter":jq(re);break;case"bitshuffle_filter":Fq(re,E);break;default:throw new ad(`Unhandled filter "${B[he]}"`)}return{layerName:p,blockIndex:D,data:re}}).catch(re=>{throw re})}))},Nn(vR,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Nn(zw,"MapboxRasterTile"),Nn(yR,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class wR{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const h=n[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const oH=["id","tile","layer","source","sourceLayer","state"];class lv{constructor(n,a,h,p,v){this.type="Feature",this._vectorTileFeature=n,this._z=a,this._x=h,this._y=p,this.properties=n.properties,this.id=v}clone(){const n=new lv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state=Object.assign({},this.state)),this.layer&&(n.layer=Object.assign({},this.layer)),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const a of oH)this[a]!==void 0&&(n[a]=this[a]);return n}}class TR{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Kc(fn,16,0),this.featureIndexArray=new o_,this.promoteId=a,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,a,h,p,v,x=0,E=0){const O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,v,x);const D=this.grid;for(let B=0;B<a.length;B++){const F=a[B],U=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<F.length;Z++){const Y=F[Z];U[0]=Math.min(U[0],Y.x),U[1]=Math.min(U[1],Y.y),U[2]=Math.max(U[2],Y.x),U[3]=Math.max(U[3],Y.y)}E!==0&&(U[0]-=E,U[1]-=E,U[2]+=E,U[3]+=E),U[0]<fn&&U[1]<fn&&U[2]>=0&&U[3]>=0&&D.insert(O,U[0],U[1],U[2],U[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new xi.VectorTile(new rw(this.rawTileData)).layers,this.sourceLayerCoder=new wR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,a){const{tilespaceGeometry:h,transform:p,tileTransform:v,pixelPosMatrix:x,availableImages:E,worldview:O}=a;this.loadVTLayers(),this.serializedLayersCache.clear();const D=h.bufferedTilespaceBounds,B=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(Y,re,he,_e)=>Qd(h.bufferedTilespaceGeometry,Y,re,he,_e));B.sort(aH);let F=null;p.elevation&&B.length>0&&(F=rv.create(p.elevation,this.tileID));const U={};let Z;for(let Y=0;Y<B.length;Y++){const re=B[Y];if(re===Z)continue;Z=re;const he=this.featureIndexArray.get(re);let _e=null;this.is3DTile?this.loadMatchingModelFeature(U,he,n,h,p,O):this.loadMatchingFeature(U,he,n,E,O,(Se,Ce,le,Te=0)=>(_e||(_e=Dn(Se,this.tileID.canonical,v)),Ce.queryIntersectsFeature(h,Se,le,_e,this.z,p,x,F,Te)))}return U}loadMatchingFeature(n,a,h,p,v,x){const{featureIndex:E,bucketIndex:O,sourceLayerIndex:D,layoutVertexArrayOffset:B}=a,F=this.bucketLayerIDs[O],U=h.layers,Z=Object.keys(U);if(Z.length&&!si(Z,F))return;const Y=h.sourceCache,re=this.sourceLayerCoder.decode(D),he=this.vtLayers[re].feature(E),_e=this.getId(he,re);for(let Se=0;Se<F.length;Se++){const Ce=F[Se];if(!U[Ce])continue;const{styleLayer:le,targets:Te}=U[Ce];let Me={};_e!==void 0&&(Me=Y.getFeatureState(le.sourceLayer,_e));const Re=!x||x(he,le,Me,B);if(!Re)continue;const et=new lv(he,this.z,this.x,this.y,_e);et.tile=this.tileID.canonical,et.state=Me;let Ye=this.serializedLayersCache.get(Ce);Ye||(Ye=le.serialize(),Ye.id=Ce,this.serializedLayersCache.set(Ce,Ye)),et.source=Ye.source,et.sourceLayer=Ye["source-layer"],et.layer=lt({},Ye),et.layer.paint=SR(Ye.paint,le.paint,he,Me,p),et.layer.layout=SR(Ye.layout,le.layout,he,Me,p);let it=!1;for(const dt of Te){this.updateFeatureProperties(et,dt);const{filter:Ct}=dt;if(Ct){if(he.properties=et.properties,Ct.needGeometry){const tn=On(he,!0);if(!Ct.filter(new Mr(this.tileID.overscaledZ,{worldview:v}),tn,this.tileID.canonical))continue}else if(!Ct.filter(new Mr(this.tileID.overscaledZ,{worldview:v}),he))continue}it=!0,dt.targetId&&this.addFeatureVariant(et,dt)}it&&this.appendToResult(n,Ce,E,et,Re)}}loadMatchingModelFeature(n,a,h,p,v,x){const{featureIndex:E,bucketIndex:O}=a,D=this.bucketLayerIDs[O],B=h.layers,F=Object.keys(B);if(!F.length||si(F,D))for(let U=0;U<D.length;U++){const Z=D[U],{styleLayer:Y,targets:re}=B[Z];if(Y.type!=="model")continue;const he=p.tile,_e=he.getBucket(Y);if(!(_e&&_e instanceof Cw))continue;const Se=oq(_e,E,p,v);if(!Se)continue;const{z:Ce,x:le,y:Te}=he.tileID.canonical,{feature:Me,intersectionZ:Re,position:et}=Se;let Ye={};Me.id!==void 0&&(Ye=h.sourceCache.getFeatureState(Y.sourceLayer,Me.id));const it=new lv({},Ce,le,Te,Me.id);it.tile=this.tileID.canonical,it.state=Ye,it.properties=Me.properties,it.geometry={type:"Point",coordinates:[et.lng,et.lat]};let dt=this.serializedLayersCache.get(Z);dt||(dt=Y.serialize(),dt.id=Z,this.serializedLayersCache.set(Z,dt)),it.source=dt.source,it.sourceLayer=dt["source-layer"],it.layer=lt({},dt);let Ct=!1;for(const tn of re){this.updateFeatureProperties(it,tn);const{filter:qt}=tn;if(qt){if(Me.properties=it.properties,qt.needGeometry){if(!qt.filter(new Mr(this.tileID.overscaledZ,{worldview:x}),Me,this.tileID.canonical))continue}else if(!qt.filter(new Mr(this.tileID.overscaledZ,{worldview:x}),Me))continue}Ct=!0,tn.targetId&&this.addFeatureVariant(it,tn)}Ct&&this.appendToResult(n,Z,E,it,Re)}}updateFeatureProperties(n,a,h){if(a.properties){const p={};for(const v in a.properties){const x=a.properties[v].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,h);x!=null&&(p[v]=x)}n.properties=p}}addFeatureVariant(n,a,h){const p={target:a.target,namespace:a.namespace,uniqueFeatureID:a.uniqueFeatureID};a.properties&&(p.properties=n.properties),n.variants=n.variants||{},n.variants[a.targetId]=n.variants[a.targetId]||[],n.variants[a.targetId].push(p)}appendToResult(n,a,h,p,v){let x=n[a];x===void 0&&(x=n[a]=[]),x.push({featureIndex:h,feature:p,intersectionZ:v})}lookupSymbolFeatures(n,a,h,p,v,x){const E={};this.loadVTLayers();for(const O of n)this.loadMatchingFeature(E,{bucketIndex:a,sourceLayerIndex:h,featureIndex:O,layoutVertexArrayOffset:0},p,v,x);return E}loadFeature(n){const{featureIndex:a,sourceLayerIndex:h}=n;this.loadVTLayers();const p=this.sourceLayerCoder.decode(h),v=this.vtFeatures[p];if(v[a])return v[a];const x=this.vtLayers[p].feature(a);return v[a]=x,x}hasLayer(n){for(const a of this.bucketLayerIDs)for(const h of a)if(n===h)return!0;return!1}getId(n,a){let h=n.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[a];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const v=gc(p);if(v.result!=="success"){const x=v.value.map(E=>`${E.key}: ${E.message}`).join(", ");return void ui(`Failed to create expression for promoteId: ${x}`)}this.promoteIdExpression=v.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Fc),h=this.promoteIdExpression.evaluate({zoom:0},n)}else h=n.properties[p];typeof h=="boolean"&&(h=Number(h))}return h}}function SR(c,n,a,h,p){return _n(c,(v,x)=>{const E=n instanceof qd?n.get(x):null;return E&&E.evaluate?E.evaluate(a,h,void 0,p):E})}function aH(c,n){return n-c}Nn(TR,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const ER=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wS{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,h]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=h>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=ER[15&h];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new wS(E,x,v,n)}constructor(n,a=64,h=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=h,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=ER.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-E%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${h}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+O,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+E+O),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+O,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=n,this.coords[this._pos++]=a,h}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return TS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:E}=this,O=[0,v.length-1,0],D=[];for(;O.length;){const B=O.pop()||0,F=O.pop()||0,U=O.pop()||0;if(F-U<=E){for(let he=U;he<=F;he++){const _e=x[2*he],Se=x[2*he+1];_e>=n&&_e<=h&&Se>=a&&Se<=p&&D.push(v[he])}continue}const Z=U+F>>1,Y=x[2*Z],re=x[2*Z+1];Y>=n&&Y<=h&&re>=a&&re<=p&&D.push(v[Z]),(B===0?n<=Y:a<=re)&&(O.push(U),O.push(Z-1),O.push(1-B)),(B===0?h>=Y:p>=re)&&(O.push(Z+1),O.push(F),O.push(1-B))}return D}within(n,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:x}=this,E=[0,p.length-1,0],O=[],D=h*h;for(;E.length;){const B=E.pop()||0,F=E.pop()||0,U=E.pop()||0;if(F-U<=x){for(let he=U;he<=F;he++)PR(v[2*he],v[2*he+1],n,a)<=D&&O.push(p[he]);continue}const Z=U+F>>1,Y=v[2*Z],re=v[2*Z+1];PR(Y,re,n,a)<=D&&O.push(p[Z]),(B===0?n-h<=Y:a-h<=re)&&(E.push(U),E.push(Z-1),E.push(1-B)),(B===0?n+h>=Y:a+h>=re)&&(E.push(Z+1),E.push(F),E.push(1-B))}return O}}function TS(c,n,a,h,p,v){if(p-h<=a)return;const x=h+p>>1;AR(c,n,x,h,p,v),TS(c,n,a,h,x-1,1-v),TS(c,n,a,x+1,p,1-v)}function AR(c,n,a,h,p,v){for(;p>h;){if(p-h>600){const D=p-h+1,B=a-h+1,F=Math.log(D),U=.5*Math.exp(2*F/3),Z=.5*Math.sqrt(F*U*(D-U)/D)*(B-D/2<0?-1:1);AR(c,n,a,Math.max(h,Math.floor(a-B*U/D+Z)),Math.min(p,Math.floor(a+(D-B)*U/D+Z)),v)}const x=n[2*a+v];let E=h,O=p;for(Y0(c,n,h,a),n[2*p+v]>x&&Y0(c,n,h,p);E<O;){for(Y0(c,n,E,O),E++,O--;n[2*E+v]<x;)E++;for(;n[2*O+v]>x;)O--}n[2*h+v]===x?Y0(c,n,h,O):(O++,Y0(c,n,O,p)),O<=a&&(h=O+1),a<=O&&(p=O-1)}}function Y0(c,n,a,h){SS(c,a,h),SS(n,2*a,2*h),SS(n,2*a+1,2*h+1)}function SS(c,n,a){const h=c[n];c[n]=c[a],c[a]=h}function PR(c,n,a,h){const p=c-a,v=n-h;return p*p+v*v}o.$=Ia,o.A=qn,o.B=rc,o.C=Yh,o.D=cn,o.E=Fo,o.F=2,o.G=k0,o.H=HI,o.I=yo,o.J=oc,o.K=class extends Aw{},o.L=es,o.M=Pl,o.N=Cf,o.O=Bd,o.P=hn,o.Q=Fd,o.R=Sr,o.S=Ra,o.T=rS,o.U=Mp,o.V=Aw,o.W=Sp,o.X=gc,o.Y=yi,o.Z=Ai,o._=Un,o.a=function(c){return or.API_CDN_URL_REGEX.test(c)},o.a$=ht,o.a0=qa,o.a1=Op,o.a2=Mf,o.a3=jd,o.a4=function(c){const n=c.value;let a=[];if(!n)return a;const h=oc(n);return h!=="string"?(a=a.concat([new Aw(c.key,n,`string expected, "${h}" found`)]),a):(lS(n,!0)||(a=a.concat([new Aw(c.key,n,`invalid url "${n}"`)])),a)},o.a5=ft,o.a6=Wg,o.a7=bo,o.a8=an,o.a9=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return ir(c.expression.evaluate(n))}interpolate(c,n,a){return{x:Xn(c.x,n.x,a),y:Xn(c.y,n.y,a),z:Xn(c.z,n.z,a),azimuthal:Xn(c.azimuthal,n.azimuthal,a),polar:Xn(c.polar,n.polar,a)}}},o.aA=Xr,o.aB=P,o.aC=tu,o.aD=Fe,o.aE=wt,o.aF=function(c,n){const a={};for(let h=0;h<n.length;h++){const p=n[h];p in c&&(a[p]=c[p])}return a},o.aG=De,o.aH=ke,o.aI=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,a,h){const p=this.entries[c]=this.entries[c]||{callbacks:[]};if(p.result){const[v,x]=p.result;return this.scheduler?this.scheduler.add(()=>{h(v,x)},n):h(v,x),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=a((v,x)=>{p.result=[v,x];for(const E of p.callbacks)this.scheduler?this.scheduler.add(()=>{E(v,x)},n):E(v,x);setTimeout(()=>delete this.entries[c],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(v=>v!==h),p.callbacks.length||(p.cancel(),delete this.entries[c]))}}},o.aJ=function(c,n,a){const h=JSON.stringify(c.request);return c.data&&(this.deduped.entries[h]={result:[null,c.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},p=>{const v=ko(c.request,(x,E,O,D)=>{x?p(x):E&&p(null,{vectorTile:a?void 0:new xi.VectorTile(new rw(E)),rawData:E,cacheControl:O,expires:D})});return()=>{v.cancel(),p()}},n)},o.aK=function(c){ic++,ic>da&&(c.getActor().send("enforceCacheSizeLimit",ha),ic=0)},o.aL=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},o.aM=Js,o.aN=xD,o.aO=AD,o.aP=vD,o.aQ=function(c,n){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){n(null,a)};for(let h=0;h<c.length;h++){const p=document.createElement("source");Rs(c[h])||(a.crossOrigin="Anonymous"),p.src=c[h],a.appendChild(p)}return{cancel:()=>{}}},o.aR=bw,o.aS=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>uI(n,0,c))},o.aT=bR,o.aU=class{constructor(c,n,a,h){this.id=c,this.position=n!=null?new we(n[0],n[1]):new we(0,0),this.orientation=a??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(ce(c.matrix,n,c.matrix),c.meshes)for(const a of c.meshes){const h=sr.applyTransformFast(a.aabb,c.matrix);this.aabb.encapsulate(h)}if(c.children)for(const a of c.children)this._applyTransformations(a,c.matrix)}computeBoundsAndApplyParent(){const c=te([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,a,h,p,v,x=!1){ND(this.matrix,this,c.transform,this.position,n,a,h,p,v,x)}upload(c){if(!this.uploaded){for(const n of this.nodes)uS(n,c);for(const n of this.nodes)Pw(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)hS(c)}},o.aV=vn,o.aW=B0,o.aX=Ke,o.aY=pt,o.aZ=Gd,o.a_=ra,o.aa=Mr,o.ab=Xc,o.ac=at,o.ad=Dt,o.ae=yt,o.af=We,o.ag=qd,o.ah=tf,o.ai=Xn,o.aj=fn,o.ak=Ll,o.al=Tt,o.am=Di,o.an=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([a,h]){const p=ir([1,a,h]);return{x:p.x,y:p.y,z:p.z}}(c.expression.evaluate(n))}interpolate(c,n,a){return{x:Xn(c.x,n.x,a),y:Xn(c.y,n.y,a),z:Xn(c.z,n.z,a)}}},o.ao=function(c,n,a=0,h=!0){const p=new hn(a,a),v=c.sub(p),x=n.add(p),E=[v,new hn(x.x,v.y),x,new hn(v.x,x.y)];return h&&E.push(v.clone()),E},o.ap=function(c,n){const a=[];for(let h=0;h<c.length;h++){const p=nt(h-1,-1,c.length-1),v=nt(h+1,-1,c.length-1),x=c[h],E=c[v],O=c[p].sub(x).unit(),D=E.sub(x).unit(),B=D.angleWithSep(O.x,O.y),F=O.add(D).unit().mult(-1*n/Math.sin(B/2));a.push(x.add(F))}return a},o.aq=oD,o.ar=Qd,o.as=function(c,n,a=0){return ot(((n.x-a)*c.scale-c.x)*fn,(n.y*c.scale-c.y)*fn,mt(n.z,n.y))},o.at=ci,o.au=ct,o.av=qr,o.aw=_I,o.ax=function(c){let n=1/0,a=1/0,h=-1/0,p=-1/0;for(const v of c)n=Math.min(n,v.x),a=Math.min(a,v.y),h=Math.max(h,v.x),p=Math.max(p,v.y);return{min:new hn(n,a),max:new hn(h,p)}},o.ay=be,o.az=ce,o.b=function(c){return or.API_FONTS_REGEX.test(c)},o.b$=function(c,n,a){a*=.5;var h=n[0],p=n[1],v=n[2],x=n[3],E=Math.sin(a),O=Math.cos(a);return c[0]=h*O+p*E,c[1]=p*O-h*E,c[2]=v*O+x*E,c[3]=x*O-v*E,c},o.b0=kp,o.b1=vw,o.b2=function(){Au.isLoading()||Au.isLoaded()||Vd()!=="deferred"||Ty()},o.b3=Im,o.b4=On,o.b5=lv,o.b6=Fi,o.b7=k2,o.b8=Xf,o.b9=Dn,o.bA=function(c,n){const{x:a,y:h}=c.point,p=d0(a,h,c.worldSize/c._pixelsPerMercatorPixel,0,0);return ce(p,p,u0(nd(n)))},o.bB=I,o.bC=function(c){return c[0]=0,c[1]=0,c[2]=0,c},o.bD=function(c,n){return Math.hypot(n[0]-c[0],n[1]-c[1],n[2]-c[2])},o.bE=Pt,o.bF=In,o.bG=kt,o.bH=z0,o.bI=ru,o.bJ=q2,o.bK=function(c,n,a,h,p){const v=5*n+2;c.float32[v+0]=a,c.float32[v+1]=h,c.float32[v+2]=p},o.bL=yw,o.bM=_,o.bN=Ks,o.bO=Vs,o.bP=Wb,o.bQ=DD,o.bR=E0,o.bS=A0,o.bT=$2,o.bU=JI,o.bV=W2,o.bW=wS,o.bX=nt,o.bY=$e,o.bZ=Mi,o.b_=go,o.ba=_c,o.bb=Ff,o.bc=s0,o.bd=wo,o.be=Zp,o.bf=tS,o.bg=function(c,n){const a=tf(n.zoom);if(a===0)return nd(c);const h=Wm(c),p=Xm(h),v=Fe(h.getWest())*n.worldSize,x=Fe(h.getEast())*n.worldSize,E=ke(h.getNorth())*n.worldSize,O=ke(h.getSouth())*n.worldSize,D=[v,E,0],B=[x,E,0],F=[v,O,0],U=[x,O,0],Z=oe([],n.globeMatrix);return Dt(D,D,Z),Dt(B,B,Z),Dt(F,F,Z),Dt(U,U,Z),p[0]=ef(p[0],F,a),p[1]=ef(p[1],U,a),p[2]=ef(p[2],B,a),p[3]=ef(p[3],D,a),sr.fromPoints(p)},o.bh=Wf,o.bi=oe,o.bj=Gp,o.bk=ef,o.bl=kf,o.bm=Cb,o.bn=Qe,o.bo=de,o.bp=zw,o.bq=rw,o.br=ko,o.bs=function(c,n){const a=[];for(const h in c)h in n||a.push(h);return a},o.bt=Xe,o.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bv=vs,o.bw=function(c){var n=new M(16);return n[0]=c[0],n[1]=c[1],n[2]=c[2],n[3]=c[3],n[4]=c[4],n[5]=c[5],n[6]=c[6],n[7]=c[7],n[8]=c[8],n[9]=c[9],n[10]=c[10],n[11]=c[11],n[12]=c[12],n[13]=c[13],n[14]=c[14],n[15]=c[15],n},o.bx=te,o.by=xe,o.bz=J,o.c=Hs,o.c$=$o,o.c0=_a,o.c1=nr,o.c2=function(c,n){return c[0]=-n[0],c[1]=-n[1],c[2]=-n[2],c[3]=n[3],c},o.c3=Ge,o.c4=function(c,n,a,h,p){var v,x=1/Math.tan(n/2);return c[0]=x/a,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=x,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,p!=null&&p!==1/0?(c[10]=(p+h)*(v=1/(h-p)),c[14]=2*p*h*v):(c[10]=-1,c[14]=-2*h),c},o.c5=function(c,n,a,h,p,v,x){var E=1/(n-a),O=1/(h-p),D=1/(v-x);return c[0]=-2*E,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*O,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*D,c[11]=0,c[12]=(n+a)*E,c[13]=(p+h)*O,c[14]=(x+v)*D,c[15]=1,c},o.c6=qe,o.c7=function(c,n,a){c[4*n+0]=a[0],c[4*n+1]=a[1],c[4*n+2]=a[2],c[4*n+3]=a[3]},o.c8=xc,o.c9=$f,o.cA=Sw,o.cB=Je,o.cC=PD,o.cD=function(c){const n=PD(c,!0);return I([],[n[0],n[1],n[4],n[5]])},o.cE=ue,o.cF=Lr,o.cG=Pe,o.cH=function(c){const{x:n,y:a}=c.point,{lng:h,lat:p}=c._center;return d0(n,a,c.worldSize,h,p)},o.cI=Bt,o.cJ=je,o.cK=$p,o.cL=R,o.cM=function(c,n,a){let h=0;for(let p=0;p<2;++p)c[p]>0&&(h+=(c[p]-0)*(c[p]-0)),n[p]<0&&(h+=(0-n[p])*(0-n[p]));return h},o.cN=function(c){return c*c*c*c*c},o.cO=Ue,o.cP=45,o.cQ=bc,o.cR=function(c,n,a){const h=Math.sqrt(c*c+n*n+a*a),p=h>0?Math.acos(a/h)*bt:0;let v=c!==0||n!==0?Math.atan2(-n,-c)*bt+90:0;return v<0&&(v+=360),[h,v,p]},o.cS=ot,o.cT=ir,o.cU=Et,o.cV=zt,o.cW=sr,o.cX=rt,o.cY=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},o.cZ=lS,o.c_=function(c,n){return c.readFields(lq,{icons:[]},n)},o.ca=Vo,o.cb=Ru,o.cc=Lu,o.cd=we,o.ce=uD,o.cf=function(){var c=new M(4);return M!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},o.cg=function(c,n,a){var h=n[0],p=n[1],v=n[2],x=n[3],E=Math.sin(a),O=Math.cos(a);return c[0]=h*O+v*E,c[1]=p*O+x*E,c[2]=h*-E+v*O,c[3]=p*-E+x*O,c},o.ch=function(c,n){return c[0]===n[0]&&c[1]===n[1]&&c[2]===n[2]&&c[3]===n[3]},o.ci=mn,o.cj=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},o.ck=Po,o.cl=ai,o.cm=a0,o.cn=Or,o.co=CD,o.cp=Zf,o.cq=Hp,o.cr=function(c,n,a,h,p,v,x,E,O){if(O.name==="globe")return Hp(c,n,new Zf(a,h,p),!1);const D=B0({z:a,x:h,y:p},O);return new sr([(v+D.x/D.scale)*n,n*(D.y/D.scale),x],[(v+D.x2/D.scale)*n,n*(D.y2/D.scale),E])},o.cs=function(c,n,a){return c[0]=Math.min(n[0],a[0]),c[1]=Math.min(n[1],a[1]),c[2]=Math.min(n[2],a[2]),c[3]=Math.min(n[3],a[3]),c},o.ct=function(c,n,a){return c[0]=Math.max(n[0],a[0]),c[1]=Math.max(n[1],a[1]),c[2]=Math.max(n[2],a[2]),c[3]=Math.max(n[3],a[3]),c},o.cu=function(c){const n=Math.round((c+45+360)%360/90)%4;return ae[n]},o.cv=It,o.cw=kr,o.cx=N,o.cy=function(c){const n=te(new Float64Array(16));ce(n,c.pixelMatrix,c.globeMatrix);const a=[0,W,0],h=[0,Q,0];return Dt(a,a,n),Dt(h,h,n),[a[0]>0&&a[0]<=c.width&&a[1]>0&&a[1]<=c.height&&!h_(c,new we(c.center.lat,90)),h[0]>0&&h[0]<=c.width&&h[1]>0&&h[1]<=c.height&&!h_(c,new we(c.center.lat,-90))]},o.cz=function(c,n){const{scale:a}=c.tileTransform,h=a*fn/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return function(p,v,x){var E=v[1],O=v[2],D=v[3],B=x[0],F=x[1];return p[0]=v[0]*B,p[1]=E*B,p[2]=O*F,p[3]=D*F,p}(new Float32Array(4),n.inverseAdjustmentMatrix,[h,h])},o.d=function(c){return or.API_TILEJSON_REGEX.test(c)},o.d$=Bm,o.d0=ev,o.d1=G2,o.d2=zo,o.d3=Xh,o.d4=jo,o.d5=kn,o.d6=ii,o.d7=function(c){const n=c.indexOf(zf);return n>=0?c.slice(0,n):c},o.d8=function(c){return c.indexOf(zf)>=0},o.d9=function(c){const n=c.lastIndexOf(zf);return n>=0?c.slice(n+1):""},o.dA=h0,o.dB=Zo,o.dC=hr,o.dD=256,o.dE=function(c,n){const a=[0,0,0];return Dt(a,a,Wf(nd(n.canonical))),Dt(a,a,c),a},o.dF=c=>({u_matrix:new Lu(c),u_texsize:new Ru(c),u_pixels_to_tile_units:new Up(c),u_device_pixel_ratio:new Vo(c),u_width_scale:new Vo(c),u_floor_width_scale:new Vo(c),u_image:new xc(c),u_units_to_pixels:new Ru(c),u_tile_units_to_pixels:new Vo(c),u_alpha_discard_threshold:new Vo(c),u_trim_offset:new Ru(c),u_trim_fade_range:new Ru(c),u_trim_color:new bc(c),u_emissive_strength:new Vo(c),u_zbias_factor:new Vo(c),u_tile_to_meter:new Vo(c),u_ground_shadow_factor:new $f(c),u_pattern_transition:new Vo(c)}),o.dG=c=>({u_matrix:new Lu(c),u_pixels_to_tile_units:new Up(c),u_device_pixel_ratio:new Vo(c),u_width_scale:new Vo(c),u_floor_width_scale:new Vo(c),u_units_to_pixels:new Ru(c),u_dash_image:new xc(c),u_gradient_image:new xc(c),u_image_height:new Vo(c),u_texsize:new Ru(c),u_tile_units_to_pixels:new Vo(c),u_alpha_discard_threshold:new Vo(c),u_trim_offset:new Ru(c),u_trim_fade_range:new Ru(c),u_trim_color:new bc(c),u_emissive_strength:new Vo(c),u_zbias_factor:new Vo(c),u_tile_to_meter:new Vo(c),u_ground_shadow_factor:new $f(c)}),o.dH=c=>({u_camera_to_center_distance:new Vo(c),u_extrude_scale:new Up(c),u_device_pixel_ratio:new Vo(c),u_matrix:new Lu(c),u_inv_rot_matrix:new Lu(c),u_merc_center:new Ru(c),u_tile_id:new $f(c),u_zoom_transition:new Vo(c),u_up_dir:new $f(c),u_emissive_strength:new Vo(c)}),o.dI=zm,o.dJ=d$,o.dK=Dy,o.dL=(c,n,a,h,p,v)=>{const x=c.transform,E=x.projection.name==="globe";let O;if(v.paint.get("circle-pitch-alignment")==="map")if(E){const B=h0(x.zoom,n.canonical)*x._pixelsPerMercatorPixel;O=Float32Array.from([B,0,0,B])}else O=x.calculatePixelsToTileUnitsMatrix(a);else O=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const D={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(x.projection),u_matrix:c.translatePosMatrix(n.projMatrix,a,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_device_pixel_ratio:xs.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:p0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:v.paint.get("circle-emissive-strength")};if(E){D.u_inv_rot_matrix=h,D.u_merc_center=p,D.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],D.u_zoom_transition=tf(x.zoom);const B=p[0]*fn,F=p[1]*fn;D.u_up_dir=x.projection.upVector(new Zf(0,0,0),B,F)}return D},o.dM=bI,o.dN=Ha,o.dO=(c,n,a,h,p,v,x,E,O,D)=>{const B=c.transform,F=B.pitch<15?yI(.07,.7,be((14-B.zoom)/5,0,1)):.07,U=a.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:xI(c,n,a,h),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:B.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:p,u_width_scale:v,u_floor_width_scale:x,u_image:0,u_tile_units_to_pixels:vI(n,B),u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toPremultipliedRenderColor(U?null:a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:F,u_tile_to_meter:Et(n.tileID.canonical,0),u_ground_shadow_factor:O,u_pattern_transition:D}},o.dP=(c,n,a,h,p,v,x,E,O,D)=>{const B=c.transform,F=B.calculatePixelsToTileUnitsMatrix(n),U=a.paint.get("line-trim-color-use-theme").constantOr("default")==="none",Z=B.pitch<15?yI(.07,.7,be((14-B.zoom)/5,0,1)):.07;return{u_matrix:xI(c,n,a,h),u_pixels_to_tile_units:F,u_device_pixel_ratio:v,u_width_scale:x,u_floor_width_scale:E,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:wI(a)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:vI(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:O,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toPremultipliedRenderColor(U?null:a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:Z,u_tile_to_meter:Et(n.tileID.canonical,0),u_ground_shadow_factor:D}},o.dQ=Zt,o.dR=f_,o.dS=mt,o.dT=Ab,o.dU=b_,o.dV=T_,o.dW=od,o.dX=450,o.dY=7,o.dZ=Z$,o.d_=ar,o.da=function(c){const n=[],a=c.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},o.db=function(c,n,a,h){return c.type==="custom"?new W$(c,n):new aq[c.type](c,n,a,h)},o.dc=zn,o.dd=function(c){const n=c.indexOf(zf);return n>=0?c.slice(n+1):""},o.de=class extends lv{constructor(c,n){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},o.df=If,o.dg=hs,o.dh=function(c){return c({pluginStatus:Xs,pluginURL:Eu}),If.on("pluginStateChange",c),c},o.di=s_,o.dj=class extends Du{constructor(c){super(c),this.current=ga}set(c,n,a){if(this.fetchUniformLocation(c,n)){for(let h=0;h<9;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},o.dk=ge,o.dl=function(c,n,a){const h=tf(a.zoom),p=c.style.map._antialias,v=c.terrain&&c.terrain.exaggeration()>0;return h===0&&!p&&!v},o.dm=function(c){const n=c.pixelsPerMeter,a=n/qe(1,c.center.lat),h=te(new Float64Array(16));return de(h,h,[c.point.x,c.point.y,0]),ue(h,h,[a,a,n]),Float32Array.from(h)},o.dn=Wm,o.dp=function(c){const n=It-5;c=be(c,-80.051129,n)/n*90;const a=Math.pow(Math.abs(Math.sin(Tt(c))),3);return Math.round(a*(X.length-1))},o.dq=function(c,n,a,h){const p=n.getNorth(),v=n.getSouth(),x=n.getWest(),E=n.getEast(),O=1<<c.z,D=E-x,B=p-v,F=D/G,U=-B/X[a],Z=[0,F,0,U,0,0,p,x,0];if(c.z>0){const Y=180/h;K(Z,Z,[Y/D+1,0,0,0,Y/B+1,0,-.5*Y/F,.5*Y/U,1])}return Z[2]=O,Z[5]=c.x,Z[8]=c.y,Z},o.dr=nd,o.ds=function(c,n,a){const h=te(new Float64Array(16)),p=(n/(1<<c)-.5)*Math.PI*2;return Oe(h,a.globeMatrix,p),Float32Array.from(h)},o.dt=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const a=n.getSource().maxzoom,h=1<<a,p=Math.floor(c.x),v=Math.floor((c.x-p)*h),x=Math.floor(c.y*h),E=this.findDEMTileFor(new Js(a,p,a,v,x));return!(!E||!E.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,a=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const h=this._source();if(!h||c.y<0||c.y>1)return n;const p=h.getSource().maxzoom,v=1<<p,x=Math.floor(c.x),E=c.x-x,O=new Js(p,x,p,Math.floor(E*v),Math.floor(c.y*v)),D=this.findDEMTileFor(O);if(!D||!D.dem)return n;const B=D.dem,F=1<<D.tileID.canonical.z,U=(E*F-D.tileID.canonical.x)*B.dim,Z=(c.y*F-D.tileID.canonical.y)*B.dim,Y=Math.floor(U),re=Math.floor(Z);return(a?this.exaggeration():1)*Xn(Xn(B.get(Y,re),B.get(Y,re+1),Z-re),Xn(B.get(Y+1,re),B.get(Y+1,re+1),Z-re),U-Y)}getAtTileOffset(c,n,a){const h=1<<c.canonical.z;return this.getAtPointOrZero(new at(c.wrap+(c.canonical.x+n/fn)/h,(c.canonical.y+a/fn)/h))}getAtTileOffsetFunc(c,n,a,h){return p=>{const v=this.getAtTileOffset(c,p.x,p.y),x=h.upVector(c.canonical,p.x,p.y);return $e(x,x,v*h.upVectorScale(c.canonical,n,a).metersToTile),x}}getForTilePoints(c,n,a,h){if(this.isUsingMockSource())return!1;const p=rv.create(this,c,h);return!!p&&(n.forEach(v=>{v[2]=this.exaggeration()*p.getElevationAt(v[0],v[1],a)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const a=n.dem.tree,h=n.tileID,p=1<<c.canonical.z-h.canonical.z;let v=c.canonical.x/p-h.canonical.x,x=c.canonical.y/p-h.canonical.y,E=0;for(let O=0;O<c.canonical.z-h.canonical.z&&!a.leaves[E];O++){v*=2,x*=2;const D=2*Math.floor(x)+Math.floor(v);E=a.childOffsets[E]+D,v%=1,x%=1}return{min:this.exaggeration()*a.minimums[E],max:this.exaggeration()*a.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,a){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,a=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const p of c){const v=this.getMinMaxForTile(p.tileID);v&&(a=Math.min(a,v.min),h=Math.max(h,v.max),n=!0)}return n?{min:a,max:h}:null}},o.du=zb,o.dv=Xo,o.dw=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},o.dx=j,o.dy=function(c,n){var a=Math.sin(n),h=Math.cos(n);return c[0]=h,c[1]=a,c[2]=0,c[3]=-a,c[4]=h,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},o.dz=jn,o.e=or,o.e$=wR,o.e0=256,o.e1=u0,o.e2=jl,o.e3=Oe,o.e4=function(c,n){return c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[4],c[4]=n[5],c[5]=n[6],c[6]=n[8],c[7]=n[9],c[8]=n[10],c},o.e5=Mu,o.e6=jf,o.e7=Af,o.e8=function(c,n,a,h,p){return be((c-n)/(a-n)*(p-h)+h,h,p)},o.e9=ya,o.eA=function(c,n,a){return c[0]=n[0]/a[0],c[1]=n[1]/a[1],c[2]=n[2]/a[2],c},o.eB=Ii,o.eC=se,o.eD=on,o.eE=function(c,n,a,h){return c[0]=n,c[1]=a,c[2]=h,c},o.eF=function([c,n,a]){const h=Math.hypot(c,n,a),p=Math.atan2(c,a),v=.5*Math.PI-Math.acos(-n/h);return new we(je(p),je(v))},o.eG=ja,o.eH=aS,o.eI=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(a){if(vi==null){const h=a.navigator?a.navigator.userAgent:null;vi=!!a.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return vi}(c)&&!(!n||!(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},o.eJ=function(c,n){ha=c,da=n},o.eK=h_,o.eL=Ib,o.eM=function(c){const n=[0,0,0],a=te(new Float64Array(16));return ce(a,c.pixelMatrix,c.globeMatrix),Dt(n,n,a),new hn(n[0],n[1])},o.eN=function(){const c=pr;c&&(c.isPreloaded()&&c.numActive()===1?(c.release($n),pr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.eO=function(){$o().acquire($n)},o.eP=Vd,o.eQ=function(c,n,a=!1){if(Xs===Al.deferred||Xs===Al.loading||Xs===Al.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Eu=xs.resolveURL(c),Xs=Al.deferred,Om=n,Cp(),a||Ty()},o.eR=function(c){Si=xs.resolveURL(c),Vi||(Vi=new cn($o(),new Fo)),Vi.broadcast("setMeshoptUrl",Si)},o.eS=tw,o.eT=function(c){Kt=xs.resolveURL(c),Vi||(Vi=new cn($o(),new Fo)),Vi.broadcast("setDracoUrl",Kt)},o.eU=af,o.eV=Mn,o.eW=function(c){const n=cs();if(!n)return;const a=n.delete(uo);c&&a.then(()=>c()).catch(c)},o.eX=nn,o.eY=Nn,o.eZ=nu,o.e_=sf,o.ea=function(c,n){var a=n[0],h=n[1],p=n[2],v=n[3],x=n[4],E=n[5],O=n[6],D=n[7],B=n[8],F=B*x-E*D,U=-B*v+E*O,Z=D*v-x*O,Y=a*F+h*U+p*Z;return Y?(c[0]=F*(Y=1/Y),c[1]=(-B*h+p*D)*Y,c[2]=(E*h-p*x)*Y,c[3]=U*Y,c[4]=(B*a-p*O)*Y,c[5]=(-E*a+p*v)*Y,c[6]=Z*Y,c[7]=(-D*a+h*O)*Y,c[8]=(x*a-h*v)*Y,c):null},o.eb=An,o.ec=Xt,o.ed=sS,o.ee=function(c,n){if(c===n){var a=n[1],h=n[2],p=n[3],v=n[6],x=n[7],E=n[11];c[1]=n[4],c[2]=n[8],c[3]=n[12],c[4]=a,c[6]=n[9],c[7]=n[13],c[8]=h,c[9]=v,c[11]=n[14],c[12]=p,c[13]=x,c[14]=E}else c[0]=n[0],c[1]=n[4],c[2]=n[8],c[3]=n[12],c[4]=n[1],c[5]=n[5],c[6]=n[9],c[7]=n[13],c[8]=n[2],c[9]=n[6],c[10]=n[10],c[11]=n[14],c[12]=n[3],c[13]=n[7],c[14]=n[11],c[15]=n[15];return c},o.ef=Ve,o.eg=[1,1,1],o.eh=class{constructor(c,n,a,h){this.context=c,this.format=h,this.size=a,this.texture=c.gl.createTexture();const[p,v,x]=this.size,{gl:E}=c;E.bindTexture(E.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),E.texImage3D(E.TEXTURE_3D,0,this.format,p,v,x,0,nS(this.format),iS(this.format),n.data)}bind(c,n){const{context:a}=this,{gl:h}=a;h.bindTexture(h.TEXTURE_3D,this.texture),c!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,c),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},o.ei=rv,o.ej=function(c,n,a,h){var p=new M(4);return p[0]=c,p[1]=n,p[2]=a,p[3]=h,p},o.ek=Tr,o.el=function(c,n,a,h){var p=n[0],v=n[1],x=n[2],E=n[3];return c[0]=p+h*(a[0]-p),c[1]=v+h*(a[1]-v),c[2]=x+h*(a[2]-x),c[3]=E+h*(a[3]-E),c},o.em=iv,o.en=Es,o.eo=Iu,o.ep=function(c,n,a,h,p,v,x,E,O,D,B,F,U,Z,Y,re){var he=new M(16);return he[0]=c,he[1]=n,he[2]=a,he[3]=h,he[4]=p,he[5]=v,he[6]=x,he[7]=E,he[8]=O,he[9]=D,he[10]=B,he[11]=F,he[12]=U,he[13]=Z,he[14]=Y,he[15]=re,he},o.eq=pe,o.er=Ou,o.es=km,o.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new hn(1/0,1/0),max:new hn(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const a=Wy(new hn(0,0),new hn(fn,fn),c),h=[];if(n&&!tg(a,this._globalClipBounds))return h;for(const p of this._activeRegions){if(p.hiddenByOverlap||!tg(a,p))continue;const v=I2(p.min,p.max,c);h.push({min:v.min,max:v.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return h}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const a=[];for(const h of n.cache.getVisibleCoordinates()){const p=n.cache.getTile(h).buckets[n.layer];p&&p.updateFootprints(h.toUnwrapped(),a)}return a},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const a=c.getOrder(),h=c.getClipMask(),p=c.getClipScope();for(const v of n){if(!v.footprint)continue;const x=Wy(v.footprint.min,v.footprint.max,v.id);this._activeRegions.push({min:x.min,max:x.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:v.id,footprint:v.footprint,order:a,clipMask:h,clipScope:p})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,a)=>n.priority-a.priority||Zy(n.min,a.min)||Zy(n.max,a.max)||n.order-a.order||n.clipMask-a.clipMask||function(h,p){const v=(x,E)=>x+E;return h.length-p.length||h.reduce(v,"").localeCompare(p.reduce(v,""))}(n.clipScope,a.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const a=this._activeRegions[n],h=this._prevRegions[n];c=a.priority!==h.priority||!Xb(a,h)||a.order!==h.order||a.clipMask!==h.clipMask||!vs(a.clipScope,h.clipScope),++n}}if(c){++this._updateTime;for(const a of this._activeRegions)a.order!==Yf&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,a.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,a.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,a.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,a.max.y));const n=a=>{const h=this._activeRegions;if(a>=h.length)return a;const p=h[a].priority;for(;a<h.length&&h[a].priority===p;)++a;return a};if(this._sourceIds.length>1){let a=0,h=n(a);for(;a!==h;){let p=a;const v=a;for(;p!==h;){const x=this._activeRegions[p];x.hiddenByOverlap=!1;for(let E=0;E<v;E++){const O=this._activeRegions[E];if(!O.hiddenByOverlap&&x.order===Yf&&tg(x,O)&&(x.hiddenByOverlap=Yb(x.footprint,x.tileId,O.footprint,O.tileId),x.hiddenByOverlap))break}++p}a=h,h=n(a)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},o.eu=Yf,o.ev=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const a=new _c,h=new ra,p=[],v=c+1+2,x=n[0]+1,E=n[0]+1+(1+n.length),O=(D,B,F)=>{let U=D===v-1?D-2:D===0?D:D-1;return U+=F?24575:0,[U,B]};for(let D=0;D<v;++D)a.emplaceBack(...O(D,0,!0));for(let D=0;D<x;++D)for(let B=0;B<v;++B)a.emplaceBack(...O(B,D,(B===0||B===v-1)&&!0));for(let D=0;D<n.length;++D){const B=n[D];for(let F=0;F<v;++F)a.emplaceBack(...O(F,B,!0))}for(let D=0;D<n.length;++D){const B=h.length,F=n[D]+1+2,U=new ra;for(let re=0;re<F-1;re++){const he=re===F-2,_e=he?v*(E-n.length+D-re):v;for(let Se=0;Se<v-1;Se++){const Ce=re*v+Se;re===0||he||Se===0||Se===v-2?(U.emplaceBack(Ce+1,Ce,Ce+_e),U.emplaceBack(Ce+_e,Ce+_e+1,Ce+1)):(h.emplaceBack(Ce+1,Ce,Ce+_e),h.emplaceBack(Ce+_e,Ce+_e+1,Ce+1))}}const Z=wo.simpleSegment(0,B,a.length,h.length-B);for(let re=0;re<U.uint16.length;re+=3)h.emplaceBack(U.uint16[re],U.uint16[re+1],U.uint16[re+2]);const Y=wo.simpleSegment(0,B,a.length,h.length-B);p.push({withoutSkirts:Z,withSkirts:Y})}return{vertices:a,indices:h,segments:p}}_createGrid(c){const n=this._fillGridMeshWithLods(G,X);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,s0.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new ra;for(let x=0;x<=G;x++)n.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const a=new Mu,h=new Mu,p=new Mu,v=new Mu;this._poleSegments=[];for(let x=0,E=0;x<R;x++){const O=360/(1<<x);a.emplaceBack(0,-P,0,.5,0),h.emplaceBack(0,-P,0,.5,1),p.emplaceBack(0,-P,0,.5,.5),v.emplaceBack(0,-P,0,.5,.5);for(let D=0;D<=G;D++){let B=D/G,F=0;const U=Xn(0,O,B),[Z,Y,re]=fe(Db,b2,U,P);a.emplaceBack(Z,Y,re,B,F),h.emplaceBack(Z,Y,re,B,1-F);const he=Tt(U);B=.5+.5*Math.sin(he),F=.5+.5*Math.cos(he),p.emplaceBack(Z,Y,re,B,F),v.emplaceBack(Z,Y,re,B,1-F)}this._poleSegments.push(wo.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(a,qp,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(h,qp,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(p,qp,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(v,qp,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},o.ew=Ee,o.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.ey=Ne,o.ez=ut,o.f=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,a)=>String.fromCharCode(+("0x"+a))))},o.f0=TR,o.f1=pI,o.f2=fi,o.f3="hd_road_elevation",o.f4=Ml,o.f5=_n,o.f6=Qp,o.f7=H2,o.f8=P_,o.f9=function(c,n,a,h,p,v,x,E=1,O,D,B){c.createArrays(),c.tilePixelRatio=fn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const F=c.layers[0].layout,U=c.layers[0]._unevaluatedLayout._values,Z={};Z.scaleFactor=E,Z.textSizeScaleRange=F.get("text-size-scale-range"),Z.iconSizeScaleRange=F.get("icon-size-scale-range");const[Y,re]=Z.textSizeScaleRange,[he,_e]=Z.iconSizeScaleRange;Z.textScaleFactor=be(Z.scaleFactor,Y,re),Z.iconScaleFactor=be(Z.scaleFactor,he,_e);const Se=U["text-size"],Ce=U["icon-size"];if(c.textSizeData.kind==="composite"){const{minZoom:Ye,maxZoom:it}=c.textSizeData;Z.compositeTextSizes=[Se.possiblyEvaluate(new Mr(Ye,{worldview:B}),v),Se.possiblyEvaluate(new Mr(it,{worldview:B}),v)]}if(c.iconSizeData.kind==="composite"){const{minZoom:Ye,maxZoom:it}=c.iconSizeData;Z.compositeIconSizes=[Ce.possiblyEvaluate(new Mr(Ye,{worldview:B}),v),Ce.possiblyEvaluate(new Mr(it,{worldview:B}),v)]}Z.layoutTextSize=Se.possiblyEvaluate(new Mr(x+1,{worldview:B}),v),Z.layoutIconSize=Ce.possiblyEvaluate(new Mr(x+1,{worldview:B}),v),Z.textMaxSize=Se.possiblyEvaluate(new Mr(18,{worldview:B}),v);const le=F.get("symbol-placement"),Te=F.get("text-rotation-alignment")==="map"&&le!=="point",Me=F.get("text-size");let Re=!1;const et=[];for(const Ye of c.features){const it=F.get("text-font").evaluate(Ye,{},v).join(","),dt=Me.evaluate(Ye,{},v)*Z.textScaleFactor,Ct=Z.layoutTextSize.evaluate(Ye,{},v)*Z.textScaleFactor,tn=Z.layoutIconSize.evaluate(Ye,{},v)*Z.iconScaleFactor,qt={horizontal:{},vertical:void 0},Jt=Ye.text;let sn,Ot=[0,0];if(Jt){const mi=Jt.toString(),Ci=F.get("text-letter-spacing").evaluate(Ye,{},v)*Vs,Ei=F.get("text-line-height").evaluate(Ye,{},v)*Vs,$i=Hg(mi)?Ci:0,Li=F.get("text-anchor").evaluate(Ye,{},v),qi=F.get("text-variable-anchor");if(!qi){const Lt=F.get("text-radial-offset").evaluate(Ye,{},v);if(Lt)Ot=JI(Li,[Lt*Vs,Z2]);else{const yn=F.get("text-offset").evaluate(Ye,{},v);Ot=[yn[0]*Vs,yn[1]*Vs]}}let Ir=Te?"center":F.get("text-justify").evaluate(Ye,{},v);const so=le==="point",Ie=so?F.get("text-max-width").evaluate(Ye,{},v)*Vs:1/0,ze=Lt=>{c.allowVerticalPlacement&&wa(mi)&&(qt.vertical=V2(Jt,n,a,p,it,Ie,Ei,Li,Lt,$i,Ot,ru.vertical,!0,Ct,dt,O))};if(!Te&&qi){const Lt=Ir==="auto"?qi.map(Pn=>W2(Pn)):[Ir];let yn=!1;for(let Pn=0;Pn<Lt.length;Pn++){const wn=Lt[Pn];if(!qt.horizontal[wn])if(yn)qt.horizontal[wn]=qt.horizontal[0];else{const Hn=V2(Jt,n,a,p,it,Ie,Ei,"center",wn,$i,Ot,ru.horizontal,!1,Ct,dt,O);Hn&&(qt.horizontal[wn]=Hn,yn=Hn.positionedLines.length===1)}}ze("left")}else{if(Ir==="auto"&&(Ir=W2(Li)),so||F.get("text-writing-mode").indexOf("horizontal")>=0||!wa(mi)){const Lt=V2(Jt,n,a,p,it,Ie,Ei,Li,Ir,$i,Ot,ru.horizontal,!1,Ct,dt,O);Lt&&(qt.horizontal[Ir]=Lt)}ze(so?"left":Ir)}}let Yt,At,Mt,dn,gn,oi,Zn=!1;const Sn=F.get("icon-text-fit").evaluate(Ye,{},v);if(Ye.icon&&Ye.icon.hasPrimary()){const mi=eD(Ye.icon,c.iconSizeData,U["icon-size"],v,c.zoom,Ye,O,Z.iconScaleFactor,B);Yt=mi.iconPrimary,Mt=mi.iconSecondary;const Ci=Yt.toString();if(At=h.get(Ci),At&&(gn=F.get("icon-offset").evaluate(Ye,{},v),oi=F.get("icon-anchor").evaluate(Ye,{},v),sn=T$(p.get(Ci),Mt?p.get(Mt.toString()):void 0,gn,oi),Zn=At.sdf,c.sdfIcons===void 0?c.sdfIcons=At.sdf:c.sdfIcons!==At.sdf&&ui("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(At.pixelRatio!==c.pixelRatio||F.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0)),Mt){const Ei=Mt.toString();dn=h.get(Ei)}}Re=Re||!(!Ye.icon||!Ye.icon.hasSecondary());const un=X2(qt.horizontal)||qt.vertical;c.iconsInText||(c.iconsInText=!!un&&un.iconsInText);const bi=Ct*Z.textScaleFactor/Vs,{defaultShapedIcon:Gn,verticallyShapedIcon:Wn}=R$(c,sn,F,Ye,v,qt,bi,gn,Sn);Sn!=="none"&&sn&&(kI(sn)||NI(sn))&&(uw(0,At,Yt,sn,Gn,Sn,D,h,p),uw(0,dn,Mt,sn,Gn,Sn,D,h,p),Wn&&(uw(0,At,Yt,sn,Wn,Sn,D,h,p),uw(0,dn,Mt,sn,Wn,Sn,D,h,p))),sn=Gn,et.push({feature:Ye,shapedTextOrientations:qt,shapedText:un,shapedIcon:sn,iconPrimary:Yt,iconSecondary:Mt,iconOffset:gn,iconAnchor:oi,verticallyShapedIcon:Wn,layoutTextSize:Ct,layoutIconSize:tn,textOffset:Ot,isSDFIcon:Zn,iconTextFit:Sn})}return{featureData:et,sizes:Z,hasAnySecondaryIcon:Re,textAlongLine:Te,symbolPlacement:le}},o.fa=GI,o.fb=function(c,n,a,h,p,v,x,E,O,D){const{featureData:B,hasAnySecondaryIcon:F,sizes:U,textAlongLine:Z,symbolPlacement:Y}=n;for(const re of B){const{shapedIcon:he,verticallyShapedIcon:_e,feature:Se,shapedTextOrientations:Ce,shapedText:le,layoutTextSize:Te,textOffset:Me,isSDFIcon:Re,iconPrimary:et,iconSecondary:Ye,iconTextFit:it,iconOffset:dt}=re;tD(he,D.iconPositions,et,Ye),tD(_e,D.iconPositions,et,Ye),D$(Ce,D.iconPositions),I$(et,Ye,D.iconPositions),(le||he)&&L$(c,Se,Ce,he,_e,O,U,Te,0,Me,Re,h,p,x,E,F,it,dt,Z,Y)}a&&c.generateCollisionDebugBuffers(v,c.collisionBoxArray,U.textScaleFactor)},o.fc=xi,o.fd=Lw,o.fe=Ca,o.ff=wi,o.fg=CI,o.fh=Pa,o.fi=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==aI){const a=new Uint32Array(c,0,7),[,,h,p,v,x]=a;n=a.byteLength+p+v+x+v,(h!==c.byteLength||n>=c.byteLength)&&ui("Invalid b3dm header information.")}return uI(c,n)},o.fj=function(c,n){const a=bR(c);for(const h of a){for(const p of h.meshes)iH(p);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(rH(h.lights,n)))}return a},o.fk=Cw,o.fl=ki,o.fm=Qt,o.fn=Au,o.fo=Al,o.fp=function(c){us(),bs?.then(n=>{n.keys().then(a=>{for(let h=0;h<a.length-c;h++)n.delete(a[h]).catch(p=>ui(p.message))}).catch(a=>ui(a.message))}).catch(n=>ui(n.message))},o.g=function(c,n){return hs(lt(c,{method:"GET"}),n)},o.h=lt,o.i=function(c){return or.API_STYLE_REGEX.test(c)&&!Hs(c)},o.j=function(c){return c.indexOf("mapbox:")===0},o.k=Lo,o.l=St,o.m=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.n=function(c,n){return hs(lt(c,{type:"json"}),n)},o.o=No,o.p=function(c,n){return hs(lt(c,{method:"POST"}),n)},o.q=xs,o.r=Cs,o.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=Bo,o.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},o.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},o.w=ui,o.x=function(){return ur||(ur=new nn),ur},o.y=_S,o.z=oo}),y(["./shared"],function(o){function C(je){const ae=je?je.url.toString():void 0;return ae?performance.getEntriesByName(ae):[]}function M(je){if(typeof je=="number"||typeof je=="boolean"||typeof je=="string"||je==null)return JSON.stringify(je);if(Array.isArray(je)){let ge="[";for(const Ee of je)ge+=`${M(Ee)},`;return`${ge}]`}let ae="{";for(const ge of Object.keys(je).sort())ae+=`${ge}:${M(je[ge])},`;return`${ae}}`}function I(je){let ae="";for(const ge of o.bu)ae+=`/${M(je[ge])}`;return ae}class j{constructor(ae){this.keyCache={},this._layers={},this._layerConfigs={},ae&&this.replace(ae)}replace(ae,ge){this._layerConfigs={},this._layers={},this.update(ae,[],ge)}update(ae,ge,Ee){this._options=Ee;for(const be of ae)this._layerConfigs[be.id]=be,(this._layers[be.id]=o.db(be,this.scope,null,this._options)).compileFilter(Ee),this.keyCache[be.id]&&delete this.keyCache[be.id];for(const be of ge)delete this.keyCache[be],delete this._layerConfigs[be],delete this._layers[be];this.familiesBySource={};const Ne=function(be,We){const nt={};for(let lt=0;lt<be.length;lt++){const gt=be[lt];let ht=We&&We[gt.id];ht||(gt.type==="symbol"?ht=gt.id:(ht=I(gt),gt.type==="line"&&gt.paint&&function vn(_n){return typeof _n=="string"&&_n==="line-progress"||(Array.isArray(_n)?_n.some(vn):!(!_n||typeof _n!="object")&&Object.values(_n).some(vn))}(gt.paint["line-width"])&&(ht+=`/${M(gt.paint["line-width"])}`))),We&&(We[gt.id]=ht);let Zt=nt[ht];Zt||(Zt=nt[ht]=[]),Zt.push(gt)}const Xe=[];for(const lt in nt)Xe.push(nt[lt]);return Xe}(Object.values(this._layerConfigs),this.keyCache);for(const be of Ne){const We=be.map(Zt=>this._layers[Zt.id]),nt=We[0];if(nt.visibility==="none")continue;const Xe=nt.source||"";let lt=this.familiesBySource[Xe];lt||(lt=this.familiesBySource[Xe]={});const gt=nt.sourceLayer||"_geojsonTileLayer";let ht=lt[gt];ht||(ht=lt[gt]=[]),ht.push(We)}}}const q=1*o.e_;class K{constructor(ae){const ge={},Ee=[];for(const nt in ae){const Xe=ae[nt],lt=ge[nt]={};for(const gt in Xe.glyphs){const ht=Xe.glyphs[+gt];if(!ht||ht.bitmap.width===0||ht.bitmap.height===0)continue;const Zt=ht.metrics.localGlyph?q:1,vn={x:0,y:0,w:ht.bitmap.width+2*Zt,h:ht.bitmap.height+2*Zt};Ee.push(vn),lt[gt]=vn}}const{w:Ne,h:be}=o.H(Ee),We=new o.eZ({width:Ne||1,height:be||1});for(const nt in ae){const Xe=ae[nt];for(const lt in Xe.glyphs){const gt=Xe.glyphs[+lt];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const ht=ge[nt][lt],Zt=gt.metrics.localGlyph?q:1;o.eZ.copy(gt.bitmap,We,{x:0,y:0},{x:ht.x+Zt,y:ht.y+Zt},gt.bitmap)}}this.image=We,this.positions=ge}}o.eY(K,"GlyphAtlas");class J{constructor(ae){this.tileID=new o.aM(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.tileZoom=ae.tileZoom,this.uid=ae.uid,this.zoom=ae.zoom,this.lut=ae.lut,this.canonical=ae.tileID.canonical,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.scope=ae.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.request&&ae.request.collectResourceTiming,this.promoteId=ae.promoteId,this.isSymbolTile=ae.isSymbolTile,this.tileTransform=o.aW(ae.tileID.canonical,ae.projection),this.projection=ae.projection,this.worldview=ae.worldview,this.localizableLayerIds=ae.localizableLayerIds,this.brightness=ae.brightness,this.extraShadowCaster=!!ae.extraShadowCaster,this.tessellationStep=ae.tessellationStep,this.scaleFactor=ae.scaleFactor,this.worldview=ae.worldview}parse(ae,ge,Ee,Ne,be,We){this.status="parsing",this.data=ae,this.collisionBoxArray=new o.b0;const nt=new o.e$(Object.keys(ae.layers).sort()),Xe=new o.f0(this.tileID,this.promoteId);Xe.bucketLayerIDs=[];const lt={},gt=new o.f1(256,256),ht={featureIndex:Xe,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:gt,availableImages:Ee,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Zt=[],vn=ge.familiesBySource[this.source];for(const zn in vn){const ii=ae.layers[zn];if(!ii)continue;let si=!1,gi=!1,ui=!1;for(const ki of vn[zn])ki[0].type==="symbol"?si=!0:gi=!0,ki[0].is3D()&&ki[0].type!=="model"&&(ui=!0);if(this.extraShadowCaster&&!ui||this.isSymbolTile===!0&&!si||this.isSymbolTile===!1&&!gi)continue;ii.version===1&&o.w(`Vector tile source "${this.source}" layer "${zn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Wi=nt.encode(zn),_r=[];let ir=!1;for(let ki=0,Fi=0;ki<ii.length;ki++){const vi=ii.feature(ki),nr=Xe.getId(vi,zn);if(this.localizableLayerIds&&this.localizableLayerIds.has(zn)){const rr=vi.properties?vi.properties.worldview:null;if(this.worldview&&typeof rr=="string")if(rr==="all")vi.properties.$localized=!0;else{if(!rr.split(",").includes(this.worldview))continue;vi.properties.$localized=!0,vi.properties.worldview=this.worldview}}!ir&&vi.properties&&vi.properties.hasOwnProperty(o.f2)&&(ir=!0),_r.push({feature:vi,id:nr,index:Fi,sourceLayerIndex:Wi}),Fi++}ir&&!ht.elevationFeatures&&ae.layers.hasOwnProperty(o.f3)&&(ht.elevationFeatures=o.f4.parseFrom(ae.layers[o.f3],this.canonical));for(const ki of vn[zn]){const Fi=ki[0];if(this.extraShadowCaster&&(!Fi.is3D()||Fi.type==="model")||this.isSymbolTile!==void 0&&Fi.type==="symbol"!==this.isSymbolTile||Fi.minzoom&&this.zoom<Math.floor(Fi.minzoom)||Fi.maxzoom&&this.zoom>=Fi.maxzoom||Fi.visibility==="none")continue;te(ki,this.zoom,ht.brightness,Ee,this.worldview);const vi=lt[Fi.id]=Fi.createBucket({index:Xe.bucketLayerIDs.length,layers:ki,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Wi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Ne,worldview:this.worldview});Xe.bucketLayerIDs.push(ki.map(rr=>o.C(rr.id,rr.scope)));let nr=vi.prepare?vi.prepare():null;nr!=null?(nr=nr.then(()=>vi.populate(_r,ht,this.tileID.canonical,this.tileTransform)),Zt.push(nr)):vi.populate(_r,ht,this.tileID.canonical,this.tileTransform)}}const _n=()=>{let zn,ii,si,gi,ui,Wi;gt.trim();const _r={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ir=()=>{if(zn)return this.status="done",We(zn);if(this.extraShadowCaster)this.status="done",We(null,{buckets:Object.values(lt).filter(Fi=>!Fi.isEmpty()),featureIndex:Xe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:ht.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(ii&&si&&gi){const Fi=new K(ii),vi=new Map;for(const[Nr,Zo]of si.entries()){const{imagePosition:hr}=o.f7(Nr,Zo,o.f8);vi.set(Nr,hr)}const nr={};for(const Nr in lt){const Zo=lt[Nr];Zo instanceof o.b1&&(te(Zo.layers,this.zoom,ht.brightness,Ee,this.worldview),nr[Nr]=o.f9(Zo,ii,Fi.positions,si,vi,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,ui,this.worldview))}const rr={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(be,si,ui,()=>{rr.iconsPending=!1,ki(nr,Fi,rr)}),this.rasterizeIfNeeded(be,gi,Wi,()=>{rr.patternsPending=!1,ki(nr,Fi,rr)})}},ki=(Fi,vi,nr,rr)=>{if(nr.iconsPending||nr.patternsPending)return;const Nr=new o.fa(si,gi,this.lut);for(const Zo in lt){const hr=lt[Zo];if(Zo in Fi)o.fb(hr,Fi[Zo],this.showCollisionBoxes,Ee,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,si,Nr);else if(hr.hasPattern&&(hr instanceof o.b7||hr instanceof o.b8||hr instanceof o.dU)){te(hr.layers,this.zoom,ht.brightness,Ee,this.worldview);const Xi=Object.fromEntries(Nr.patternPositions);hr.addFeatures(ht,this.tileID.canonical,Xi,Ee,this.tileTransform,this.brightness)}}this.status="done",We(null,{buckets:Object.values(lt).filter(Zo=>!Zo.isEmpty()),featureIndex:Xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vi.image,lineAtlas:gt,imageAtlas:Nr,brightness:ht.brightness})};if(!this.extraShadowCaster){const Fi=o.f5(ht.glyphDependencies,rr=>Object.keys(rr).map(Number));Object.keys(Fi).length?be.send("getGlyphs",{uid:this.uid,stacks:Fi,scope:this.scope},(rr,Nr)=>{zn||(zn=rr,ii=Nr,ir())},void 0,!1,_r):ii={};const vi=Array.from(ht.iconDependencies.keys()).map(rr=>o.I.parse(rr));vi.length?be.send("getImages",{images:vi,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(rr,Nr)=>{zn||(zn=rr,si=new Map,ui=this.updateImageMapAndGetImageTaskQueue(si,Nr,ht.iconDependencies),ir())},void 0,!1,_r):(si=new Map,ui=new Map);const nr=Array.from(ht.patternDependencies.keys()).map(rr=>o.I.parse(rr));nr.length?be.send("getImages",{images:nr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(rr,Nr)=>{zn||(zn=rr,gi=new Map,Wi=this.updateImageMapAndGetImageTaskQueue(gi,Nr,ht.patternDependencies),ir())},void 0,!1,_r):(gi=new Map,Wi=new Map)}if(ht.elevationFeatures&&ht.elevationFeatures.length>0){const Fi=[];for(const nr of Object.values(lt))if(nr instanceof o.b8){const rr=nr.getUnevaluatedPortalGraph();rr&&Fi.push(rr)}const vi=o.f6.evaluate(Fi);for(const nr of Object.values(lt))if(nr instanceof o.b8){const rr=ae.layers[nt.decode(nr.sourceLayerIndex)];nr.setEvaluatedPortalGraph(vi,rr,this.tileID.canonical,ht.availableImages,ht.brightness)}}ir()};Zt.length>0?Promise.allSettled(Zt).then(_n).catch(We):_n()}rasterizeIfNeeded(ae,ge,Ee,Ne){Array.from(ge.values()).some(be=>be.usvg)?this.rasterize(ae,ge,Ee,Ne):Ne()}updateImageMapAndGetImageTaskQueue(ae,ge,Ee){const Ne=new Map;for(const be of ge.keys()){const We=Ee.get(be)||[];for(const nt of We){const Xe=nt.toString(),lt=ge.get(nt.id.toString());lt.usvg?Ne.has(Xe)||(Ne.set(Xe,nt),ae.set(Xe,Object.assign({},lt))):ae.set(Xe,lt)}}return Ne}rasterize(ae,ge,Ee,Ne){this.rasterizeTask=ae.send("rasterizeImages",{scope:this.scope,tasks:Ee},(be,We)=>{if(!be)for(const[nt,Xe]of We.entries()){const lt=Object.assign(ge.get(nt),{data:Xe});ge.set(nt,lt)}Ne()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function te(je,ae,ge,Ee,Ne){const be=new o.aa(ae,{brightness:ge,worldview:Ne});for(const We of je)We.recalculate(be,Ee)}class oe extends o.E{constructor(ae,ge,Ee,Ne,be,We,nt){super(),this.actor=ae,this.layerIndex=ge,this.availableImages=Ee,this.availableModels=Ne,this.loadVectorData=We||o.aJ,this.loading={},this.loaded={},this.deduped=new o.aI(ae.scheduler),this.isSpriteLoaded=be,this.scheduler=ae.scheduler,this.brightness=nt}loadTile(ae,ge){const Ee=ae.uid,Ne=ae&&ae.request,be=Ne&&Ne.collectResourceTiming,We=this.loading[Ee]=new J(ae);We.abort=this.loadVectorData(ae,(nt,Xe)=>{const lt=!this.loading[Ee];if(delete this.loading[Ee],We.cancelRasterize(),lt||nt||!Xe)return We.status="done",lt||(this.loaded[Ee]=We),ge(nt);const gt=Xe.rawData,ht={};Xe.expires&&(ht.expires=Xe.expires),Xe.cacheControl&&(ht.cacheControl=Xe.cacheControl),We.vectorTile=Xe.vectorTile||new o.fc.VectorTile(new o.bq(gt));const Zt=()=>{We.parse(We.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(vn,_n)=>{if(vn||!_n)return ge(vn);const zn={};if(be){const ii=C(Ne);ii.length>0&&(zn.resourceTiming=JSON.parse(JSON.stringify(ii)))}ge(null,o.h({rawTileData:gt.slice(0)},_n,ht,zn))})};this.isSpriteLoaded?Zt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Zt,{type:"parseTile",isSymbolTile:ae.isSymbolTile,zoom:ae.tileZoom}):Zt()}),this.loaded=this.loaded||{},this.loaded[Ee]=We})}reloadTile(ae,ge){const Ee=this.loaded,Ne=ae.uid;if(Ee&&Ee[Ne]){const be=Ee[Ne];be.scaleFactor=ae.scaleFactor,be.showCollisionBoxes=ae.showCollisionBoxes,be.projection=ae.projection,be.brightness=ae.brightness,be.tileTransform=o.aW(ae.tileID.canonical,ae.projection),be.extraShadowCaster=ae.extraShadowCaster,be.lut=ae.lut,be.worldview=ae.worldview;const We=(nt,Xe)=>{const lt=be.reloadCallback;lt&&(delete be.reloadCallback,be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,lt)),ge(nt,Xe)};be.status==="parsing"?be.reloadCallback=We:be.status==="done"&&(be.vectorTile?be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,We):We())}else ge(null,void 0)}abortTile(ae,ge){const Ee=ae.uid,Ne=this.loading[Ee];Ne&&(Ne.abort&&Ne.abort(),delete this.loading[Ee]),ge()}removeTile(ae,ge){const Ee=this.loaded,Ne=ae.uid;Ee&&Ee[Ne]&&delete Ee[Ne],ge()}}class ce{loadTile(ae,ge){const{uid:Ee,encoding:Ne,rawImageData:be,padding:We}=ae,nt=ImageBitmap&&be instanceof ImageBitmap?this.getImageData(be,We):be;ge(null,new o.fd(Ee,nt,Ne,We<1))}reloadTile(ae,ge){ge(null,null)}abortTile(ae,ge){ge()}removeTile(ae,ge){ge()}getImageData(ae,ge){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ae.width,ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ae.width,this.offscreenCanvas.height=ae.height,this.offscreenCanvasContext.drawImage(ae,0,0,ae.width,ae.height);const Ee=this.offscreenCanvasContext.getImageData(-ge,-ge,ae.width+2*ge,ae.height+2*ge);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ee}}o.bp.setPbf(o.bq);class de{constructor(ae){this._mrt=new o.bp(ae.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ae.uid,this.tileID=ae.tileID,this.source=ae.source}parse(ae,ge){const Ee=this._mrt;this.status="parsing",this._entireBuffer=ae;try{Ee.parseHeader(ae),this._isHeaderLoaded=!0;const Ne=[];for(const be in Ee.layers){const We=Ee.getLayer(be),nt=We.getDataRange(We.getBandList()),Xe=Ee.createDecodingTask(nt),lt=ae.slice(nt.firstByte,nt.lastByte+1),gt=o.bp.performDecoding(lt,Xe).then(ht=>Xe.complete(null,ht)).catch(ht=>Xe.complete(ht,null));Ne.push(gt)}Promise.allSettled(Ne).then(()=>ge(null,Ee)).catch(be=>ge(be))}catch(Ne){ge(Ne)}}}class ue{constructor(ae){this.actor=ae,this.loading={},this.loaded={}}loadTile(ae,ge){const Ee=ae.uid,Ne=ae.request,be=this.loading[Ee]=new de(ae),{cancel:We}=o.br(Ne,(nt,Xe,lt,gt)=>{const ht=!this.loading[Ee];if(delete this.loading[Ee],ht||nt||!Xe)return be.status="done",ht||(this.loaded[Ee]=be),ge(nt);be.parse(Xe,(Zt,vn)=>{if(Zt||!vn)return ge(Zt);ge(null,vn,lt,gt)}),this.loaded[Ee]=be});be.abort=We}reloadTile(ae,ge){ge(null,void 0)}abortTile(ae,ge){const Ee=ae.uid,Ne=this.loading[Ee];Ne&&(Ne.abort&&Ne.abort(),delete this.loading[Ee]),ge()}removeTile(ae,ge){const Ee=ae.uid;this.loaded[Ee]&&delete this.loaded[Ee],ge()}decodeRasterArray(ae,ge){o.bp.performDecoding(ae.buffer,ae.task).then(Ee=>ge(null,Ee)).catch(Ee=>ge(Ee))}}const Pe=o.fc.VectorTileFeature.prototype.toGeoJSON;class Oe{constructor(ae){this._feature=ae,this.extent=o.aj,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const ge of this._feature.geometry)ae.push([new o.P(ge[0],ge[1])]);return ae}{const ae=[];for(const ge of this._feature.geometry){const Ee=[];for(const Ne of ge)Ee.push(new o.P(Ne[0],Ne[1]));ae.push(Ee)}return ae}}toGeoJSON(ae,ge,Ee){return Pe.call(this,ae,ge,Ee)}}class xe{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.aj,this.length=ae.length,this._features=ae}feature(ae){return new Oe(this._features[ae])}}class Qe{constructor(ae,ge){this.name=ae,this.extent=o.aj,this.length=ge.length,this._features=ge}feature(ae){return new Oe(this._features[ae])}}class tt extends xe{constructor(ae){super([]),this.layers={};for(const ge in ae)this.layers[ge]=new Qe(ge,ae[ge])}}const Ge=64/4096,Je=128;class Ve{constructor(){this.features=new Map}clear(){this.features.clear()}load(ae=[],ge){for(const Ee of ae){const Ne=Ee.id;if(Ne==null)continue;let be=this.features.get(Ne);be&&this.updateCache(be,ge),Ee.geometry?(be=yt(Ee),this.updateCache(be,ge),this.features.set(Ne,be)):this.features.delete(Ne),this.updateCache(be,ge)}}updateCache(ae,ge){for(const{canonical:Ee,uid:Ne}of Object.values(ge)){const{z:be,x:We,y:nt}=Ee;xt(ae,Math.pow(2,be),We,nt)&&delete ge[Ne]}}getTile(ae,ge,Ee){const Ne=Math.pow(2,ae),be=[];for(const We of this.features.values())xt(We,Ne,ge,Ee)&&be.push(Bt(We,Ne,ge,Ee));return{features:be}}getFeatures(){return[...this.features.values()]}}function xt({minX:je,minY:ae,maxX:ge,maxY:Ee},Ne,be,We){return je<(be+1+Ge)/Ne&&ae<(We+1+Ge)/Ne&&ge>(be-Ge)/Ne&&Ee>(We-Ge)/Ne}function yt(je){const{id:ae,geometry:ge,properties:Ee}=je;if(!ge)return;if(ge.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ne,coordinates:be}=ge,We={id:ae,type:1,geometry:[],tags:Ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},nt=We.geometry;if(Ne==="Point")ot(be,nt,We);else if(Ne==="MultiPoint")for(const Xe of be)ot(Xe,nt,We);else if(Ne==="LineString")We.type=2,zt(be,nt,We);else if(Ne==="MultiLineString")We.type=2,rt(be,nt,We);else if(Ne==="Polygon")We.type=3,rt(be,nt,We,!0);else{if(Ne!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");We.type=3;for(const Xe of be)rt(Xe,nt,We,!0)}return We}function ot([je,ae],ge,Ee){const Ne=o.aD(je);let be=o.aH(ae);be=be<0?0:be>1?1:be,ge.push(Ne,be),Ee.minX=Math.min(Ee.minX,Ne),Ee.minY=Math.min(Ee.minY,be),Ee.maxX=Math.max(Ee.maxX,Ne),Ee.maxY=Math.max(Ee.maxY,be)}function zt(je,ae,ge,Ee=!1,Ne=!1){const be=[];for(const We of je)ot(We,be,ge);ae.push(be),Ee&&function(We,nt){let Xe=0;for(let lt=0,gt=We.length,ht=gt-2;lt<gt;ht=lt,lt+=2)Xe+=(We[lt]-We[ht])*(We[lt+1]+We[ht+1]);if(Xe>0===nt)for(let lt=0,gt=We.length;lt<gt/2;lt+=2){const ht=We[lt],Zt=We[lt+1];We[lt]=We[gt-2-lt],We[lt+1]=We[gt-1-lt],We[gt-2-lt]=ht,We[gt-1-lt]=Zt}}(be,Ne)}function rt(je,ae,ge,Ee=!1){for(let Ne=0;Ne<je.length;Ne++)zt(je[Ne],ae,ge,Ee,Ne===0)}function Bt(je,ae,ge,Ee){const{id:Ne,type:be,geometry:We,tags:nt}=je,Xe=[];if(be===1)(function(lt,gt,ht,Zt,vn){for(let _n=0;_n<lt.length;_n+=2){const zn=Math.round(o.aj*(lt[_n+0]*gt-ht)),ii=Math.round(o.aj*(lt[_n+1]*gt-Zt));vn.push([zn,ii])}})(We,ae,ge,Ee,Xe);else for(const lt of We)Vt(lt,ae,ge,Ee,Xe);return{id:Ne,type:be,geometry:Xe,tags:nt}}function Vt(je,ae,ge,Ee,Ne){const We=o.aj+Je;let nt;for(let Xe=0;Xe<je.length-2;Xe+=2){let lt=Math.round(o.aj*(je[Xe+0]*ae-ge)),gt=Math.round(o.aj*(je[Xe+1]*ae-Ee)),ht=Math.round(o.aj*(je[Xe+2]*ae-ge)),Zt=Math.round(o.aj*(je[Xe+3]*ae-Ee));const vn=ht-lt,_n=Zt-gt;lt<-128&&ht<-128||(lt<-128?(gt+=Math.round(_n*((-128-lt)/vn)),lt=-128):ht<-128&&(Zt=gt+Math.round(_n*((-128-lt)/vn)),ht=-128),gt<-128&&Zt<-128||(gt<-128?(lt+=Math.round(vn*((-128-gt)/_n)),gt=-128):Zt<-128&&(ht=lt+Math.round(vn*((-128-gt)/_n)),Zt=-128),lt>=We&&ht>=We||(lt>=We?(gt+=Math.round(_n*((We-lt)/vn)),lt=We):ht>=We&&(Zt=gt+Math.round(_n*((We-lt)/vn)),ht=We),gt>=We&&Zt>=We||(gt>=We?(lt+=Math.round(vn*((We-gt)/_n)),gt=We):Zt>=We&&(ht=lt+Math.round(vn*((We-gt)/_n)),Zt=We),nt&&lt===nt[nt.length-1][0]&&gt===nt[nt.length-1][1]||(nt=[[lt,gt]],Ne.push(nt)),nt.push([ht,Zt])))))}}var Ln,$e,Pt,$t={exports:{}},on=function(){if(Pt)return $t.exports;Pt=1;var je=o.fg(),ae=function(){if($e)return Ln;$e=1;var gt=o.fe(),ht=o.ff().VectorTileFeature;function Zt(_n,zn){this.options=zn||{},this.features=_n,this.length=_n.length}function vn(_n,zn){this.id=typeof _n.id=="number"?_n.id:void 0,this.type=_n.type,this.rawGeometry=_n.type===1?[_n.geometry]:_n.geometry,this.properties=_n.tags,this.extent=zn||4096}return Ln=Zt,Zt.prototype.feature=function(_n){return new vn(this.features[_n],this.options.extent)},vn.prototype.loadGeometry=function(){var _n=this.rawGeometry;this.geometry=[];for(var zn=0;zn<_n.length;zn++){for(var ii=_n[zn],si=[],gi=0;gi<ii.length;gi++)si.push(new gt(ii[gi][0],ii[gi][1]));this.geometry.push(si)}return this.geometry},vn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _n=this.geometry,zn=1/0,ii=-1/0,si=1/0,gi=-1/0,ui=0;ui<_n.length;ui++)for(var Wi=_n[ui],_r=0;_r<Wi.length;_r++){var ir=Wi[_r];zn=Math.min(zn,ir.x),ii=Math.max(ii,ir.x),si=Math.min(si,ir.y),gi=Math.max(gi,ir.y)}return[zn,si,ii,gi]},vn.prototype.toGeoJSON=ht.prototype.toGeoJSON,Ln}();function ge(gt){var ht=new je;return function(Zt,vn){for(var _n in Zt.layers)vn.writeMessage(3,Ee,Zt.layers[_n])}(gt,ht),ht.finish()}function Ee(gt,ht){var Zt;ht.writeVarintField(15,gt.version||1),ht.writeStringField(1,gt.name||""),ht.writeVarintField(5,gt.extent||4096);var vn={keys:[],values:[],keycache:{},valuecache:{}};for(Zt=0;Zt<gt.length;Zt++)vn.feature=gt.feature(Zt),ht.writeMessage(2,Ne,vn);var _n=vn.keys;for(Zt=0;Zt<_n.length;Zt++)ht.writeStringField(3,_n[Zt]);var zn=vn.values;for(Zt=0;Zt<zn.length;Zt++)ht.writeMessage(4,lt,zn[Zt])}function Ne(gt,ht){var Zt=gt.feature;Zt.id!==void 0&&ht.writeVarintField(1,Zt.id),ht.writeMessage(2,be,gt),ht.writeVarintField(3,Zt.type),ht.writeMessage(4,Xe,Zt)}function be(gt,ht){var Zt=gt.feature,vn=gt.keys,_n=gt.values,zn=gt.keycache,ii=gt.valuecache;for(var si in Zt.properties){var gi=Zt.properties[si],ui=zn[si];if(gi!==null){ui===void 0&&(vn.push(si),zn[si]=ui=vn.length-1),ht.writeVarint(ui);var Wi=typeof gi;Wi!=="string"&&Wi!=="boolean"&&Wi!=="number"&&(gi=JSON.stringify(gi));var _r=Wi+":"+gi,ir=ii[_r];ir===void 0&&(_n.push(gi),ii[_r]=ir=_n.length-1),ht.writeVarint(ir)}}}function We(gt,ht){return(ht<<3)+(7&gt)}function nt(gt){return gt<<1^gt>>31}function Xe(gt,ht){for(var Zt=gt.loadGeometry(),vn=gt.type,_n=0,zn=0,ii=Zt.length,si=0;si<ii;si++){var gi=Zt[si],ui=1;vn===1&&(ui=gi.length),ht.writeVarint(We(1,ui));for(var Wi=vn===3?gi.length-1:gi.length,_r=0;_r<Wi;_r++){_r===1&&vn!==1&&ht.writeVarint(We(2,Wi-1));var ir=gi[_r].x-_n,ki=gi[_r].y-zn;ht.writeVarint(nt(ir)),ht.writeVarint(nt(ki)),_n+=ir,zn+=ki}vn===3&&ht.writeVarint(We(7,1))}}function lt(gt,ht){var Zt=typeof gt;Zt==="string"?ht.writeStringField(1,gt):Zt==="boolean"?ht.writeBooleanField(7,gt):Zt==="number"&&(gt%1!=0?ht.writeDoubleField(3,gt):gt<0?ht.writeSVarintField(6,gt):ht.writeVarintField(5,gt))}return $t.exports=ge,$t.exports.fromVectorTileJs=ge,$t.exports.fromGeojsonVt=function(gt,ht){ht=ht||{};var Zt={};for(var vn in gt)Zt[vn]=new ae(gt[vn].features,ht),Zt[vn].name=vn,Zt[vn].version=ht.version,Zt[vn].extent=ht.extent;return ge({layers:Zt})},$t.exports.GeoJSONWrapper=ae,$t.exports}(),An=o.fh(on);const ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:je=>je},kt=Math.fround||(In=new Float32Array(1),je=>(In[0]=+je,In[0]));var In;const ti=3,Dt=5,jn=6;class ai{constructor(ae){this.options=Object.assign(Object.create(ct),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:ge,minZoom:Ee,maxZoom:Ne}=this.options;ge&&console.time("total time");const be=`prepare ${ae.length} points`;ge&&console.time(be),this.points=ae;const We=[];for(let Xe=0;Xe<ae.length;Xe++){const lt=ae[Xe];if(!lt.geometry)continue;const[gt,ht]=lt.geometry.coordinates,Zt=kt(Ii(gt)),vn=kt(Mi(ht));We.push(Zt,vn,1/0,Xe,-1,1),this.options.reduce&&We.push(0)}let nt=this.trees[Ne+1]=this._createTree(We);ge&&console.timeEnd(be);for(let Xe=Ne;Xe>=Ee;Xe--){const lt=+Date.now();nt=this.trees[Xe]=this._createTree(this._cluster(nt,Xe)),ge&&console.log("z%d: %d clusters in %dms",Xe,nt.numItems,+Date.now()-lt)}return ge&&console.timeEnd("total time"),this}getClusters(ae,ge){let Ee=((ae[0]+180)%360+360)%360-180;const Ne=Math.max(-90,Math.min(90,ae[1]));let be=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)Ee=-180,be=180;else if(Ee>be){const ht=this.getClusters([Ee,Ne,180,We],ge),Zt=this.getClusters([-180,Ne,be,We],ge);return ht.concat(Zt)}const nt=this.trees[this._limitZoom(ge)],Xe=nt.range(Ii(Ee),Mi(We),Ii(be),Mi(Ne)),lt=nt.data,gt=[];for(const ht of Xe){const Zt=this.stride*ht;gt.push(lt[Zt+Dt]>1?mn(lt,Zt,this.clusterProps):this.points[lt[Zt+ti]])}return gt}getChildren(ae){const ge=this._getOriginId(ae),Ee=this._getOriginZoom(ae),Ne="No cluster with the specified id.",be=this.trees[Ee];if(!be)throw new Error(Ne);const We=be.data;if(ge*this.stride>=We.length)throw new Error(Ne);const nt=this.options.radius/(this.options.extent*Math.pow(2,Ee-1)),Xe=be.within(We[ge*this.stride],We[ge*this.stride+1],nt),lt=[];for(const gt of Xe){const ht=gt*this.stride;We[ht+4]===ae&&lt.push(We[ht+Dt]>1?mn(We,ht,this.clusterProps):this.points[We[ht+ti]])}if(lt.length===0)throw new Error(Ne);return lt}getLeaves(ae,ge,Ee){const Ne=[];return this._appendLeaves(Ne,ae,ge=ge||10,Ee=Ee||0,0),Ne}getTile(ae,ge,Ee){const Ne=this.trees[this._limitZoom(ae)],be=Math.pow(2,ae),{extent:We,radius:nt}=this.options,Xe=nt/We,lt=(Ee-Xe)/be,gt=(Ee+1+Xe)/be,ht={features:[]};return this._addTileFeatures(Ne.range((ge-Xe)/be,lt,(ge+1+Xe)/be,gt),Ne.data,ge,Ee,be,ht),ge===0&&this._addTileFeatures(Ne.range(1-Xe/be,lt,1,gt),Ne.data,be,Ee,be,ht),ge===be-1&&this._addTileFeatures(Ne.range(0,lt,Xe/be,gt),Ne.data,-1,Ee,be,ht),ht.features.length?ht:null}getClusterExpansionZoom(ae){let ge=this._getOriginZoom(ae)-1;for(;ge<=this.options.maxZoom;){const Ee=this.getChildren(ae);if(ge++,Ee.length!==1)break;ae=Ee[0].properties.cluster_id}return ge}_appendLeaves(ae,ge,Ee,Ne,be){const We=this.getChildren(ge);for(const nt of We){const Xe=nt.properties;if(Xe&&Xe.cluster?be+Xe.point_count<=Ne?be+=Xe.point_count:be=this._appendLeaves(ae,Xe.cluster_id,Ee,Ne,be):be<Ne?be++:ae.push(nt),ae.length===Ee)break}return be}_createTree(ae){const ge=new o.bW(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ee=0;Ee<ae.length;Ee+=this.stride)ge.add(ae[Ee],ae[Ee+1]);return ge.finish(),ge.data=ae,ge}_addTileFeatures(ae,ge,Ee,Ne,be,We){for(const nt of ae){const Xe=nt*this.stride,lt=ge[Xe+Dt]>1;let gt,ht,Zt;if(lt)gt=ci(ge,Xe,this.clusterProps),ht=ge[Xe],Zt=ge[Xe+1];else{const zn=this.points[ge[Xe+ti]];gt=zn.properties;const[ii,si]=zn.geometry.coordinates;ht=Ii(ii),Zt=Mi(si)}const vn={type:1,geometry:[[Math.round(this.options.extent*(ht*be-Ee)),Math.round(this.options.extent*(Zt*be-Ne))]],tags:gt};let _n;_n=lt||this.options.generateId?ge[Xe+ti]:this.points[ge[Xe+ti]].id,_n!==void 0&&(vn.id=_n),We.features.push(vn)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,ge){const{radius:Ee,extent:Ne,reduce:be,minPoints:We}=this.options,nt=Ee/(Ne*Math.pow(2,ge)),Xe=ae.data,lt=[],gt=this.stride;for(let ht=0;ht<Xe.length;ht+=gt){if(Xe[ht+2]<=ge)continue;Xe[ht+2]=ge;const Zt=Xe[ht],vn=Xe[ht+1],_n=ae.within(Xe[ht],Xe[ht+1],nt),zn=Xe[ht+Dt];let ii=zn;for(const si of _n){const gi=si*gt;Xe[gi+2]>ge&&(ii+=Xe[gi+Dt])}if(ii>zn&&ii>=We){let si,gi=Zt*zn,ui=vn*zn,Wi=-1;const _r=(ht/gt<<5)+(ge+1)+this.points.length;for(const ir of _n){const ki=ir*gt;if(Xe[ki+2]<=ge)continue;Xe[ki+2]=ge;const Fi=Xe[ki+Dt];gi+=Xe[ki]*Fi,ui+=Xe[ki+1]*Fi,Xe[ki+4]=_r,be&&(si||(si=this._map(Xe,ht,!0),Wi=this.clusterProps.length,this.clusterProps.push(si)),be(si,this._map(Xe,ki)))}Xe[ht+4]=_r,lt.push(gi/ii,ui/ii,1/0,_r,-1,ii),be&&lt.push(Wi)}else{for(let si=0;si<gt;si++)lt.push(Xe[ht+si]);if(ii>1)for(const si of _n){const gi=si*gt;if(!(Xe[gi+2]<=ge)){Xe[gi+2]=ge;for(let ui=0;ui<gt;ui++)lt.push(Xe[gi+ui])}}}}return lt}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,ge,Ee){if(ae[ge+Dt]>1){const We=this.clusterProps[ae[ge+jn]];return Ee?Object.assign({},We):We}const Ne=this.points[ae[ge+ti]].properties,be=this.options.map(Ne);return Ee&&be===Ne?Object.assign({},be):be}}function mn(je,ae,ge){return{type:"Feature",id:je[ae+ti],properties:ci(je,ae,ge),geometry:{type:"Point",coordinates:[(Ee=je[ae],360*(Ee-.5)),Tr(je[ae+1])]}};var Ee}function ci(je,ae,ge){const Ee=je[ae+Dt],Ne=Ee>=1e4?`${Math.round(Ee/1e3)}k`:Ee>=1e3?Math.round(Ee/100)/10+"k":Ee,be=je[ae+jn],We=be===-1?{}:Object.assign({},ge[be]);return Object.assign(We,{cluster:!0,cluster_id:je[ae+ti],point_count:Ee,point_count_abbreviated:Ne})}function Ii(je){return je/360+.5}function Mi(je){const ae=Math.sin(je*Math.PI/180),ge=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return ge<0?0:ge>1?1:ge}function Tr(je){const ae=(180-360*je)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function kr(je,ae,ge,Ee){let Ne=Ee;const be=ae+(ge-ae>>1);let We,nt=ge-ae;const Xe=je[ae],lt=je[ae+1],gt=je[ge],ht=je[ge+1];for(let Zt=ae+3;Zt<ge;Zt+=3){const vn=ja(je[Zt],je[Zt+1],Xe,lt,gt,ht);if(vn>Ne)We=Zt,Ne=vn;else if(vn===Ne){const _n=Math.abs(Zt-be);_n<nt&&(We=Zt,nt=_n)}}Ne>Ee&&(We-ae>3&&kr(je,ae,We,Ee),je[We+2]=Ne,ge-We>3&&kr(je,We,ge,Ee))}function ja(je,ae,ge,Ee,Ne,be){let We=Ne-ge,nt=be-Ee;if(We!==0||nt!==0){const Xe=((je-ge)*We+(ae-Ee)*nt)/(We*We+nt*nt);Xe>1?(ge=Ne,Ee=be):Xe>0&&(ge+=We*Xe,Ee+=nt*Xe)}return We=je-ge,nt=ae-Ee,We*We+nt*nt}function Xr(je,ae,ge,Ee){const Ne={id:je??null,type:ae,geometry:ge,tags:Ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")Yr(Ne,ge);else if(ae==="Polygon")Yr(Ne,ge[0]);else if(ae==="MultiLineString")for(const be of ge)Yr(Ne,be);else if(ae==="MultiPolygon")for(const be of ge)Yr(Ne,be[0]);return Ne}function Yr(je,ae){for(let ge=0;ge<ae.length;ge+=3)je.minX=Math.min(je.minX,ae[ge]),je.minY=Math.min(je.minY,ae[ge+1]),je.maxX=Math.max(je.maxX,ae[ge]),je.maxY=Math.max(je.maxY,ae[ge+1])}function go(je,ae,ge,Ee){if(!ae.geometry)return;const Ne=ae.geometry.coordinates;if(Ne&&Ne.length===0)return;const be=ae.geometry.type,We=Math.pow(ge.tolerance/((1<<ge.maxZoom)*ge.extent),2);let nt=[],Xe=ae.id;if(ge.promoteId?Xe=ae.properties[ge.promoteId]:ge.generateId&&(Xe=Ee||0),be==="Point")_a(Ne,nt);else if(be==="MultiPoint")for(const lt of Ne)_a(lt,nt);else if(be==="LineString")ya(Ne,nt,We,!1);else if(be==="MultiLineString"){if(ge.lineMetrics){for(const lt of Ne)nt=[],ya(lt,nt,We,!1),je.push(Xr(Xe,"LineString",nt,ae.properties));return}aa(Ne,nt,We,!1)}else if(be==="Polygon")aa(Ne,nt,We,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(const lt of ae.geometry.geometries)go(je,{id:Xe,geometry:lt,properties:ae.properties},ge,Ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const lt of Ne){const gt=[];aa(lt,gt,We,!0),nt.push(gt)}}je.push(Xr(Xe,be,nt,ae.properties))}function _a(je,ae){ae.push(qs(je[0]),Ho(je[1]),0)}function ya(je,ae,ge,Ee){let Ne,be,We=0;for(let Xe=0;Xe<je.length;Xe++){const lt=qs(je[Xe][0]),gt=Ho(je[Xe][1]);ae.push(lt,gt,0),Xe>0&&(We+=Ee?(Ne*gt-lt*be)/2:Math.sqrt(Math.pow(lt-Ne,2)+Math.pow(gt-be,2))),Ne=lt,be=gt}const nt=ae.length-3;ae[2]=1,kr(ae,0,nt,ge),ae[nt+2]=1,ae.size=Math.abs(We),ae.start=0,ae.end=ae.size}function aa(je,ae,ge,Ee){for(let Ne=0;Ne<je.length;Ne++){const be=[];ya(je[Ne],be,ge,Ee),ae.push(be)}}function qs(je){return je/360+.5}function Ho(je){const ae=Math.sin(je*Math.PI/180),ge=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return ge<0?0:ge>1?1:ge}function Ar(je,ae,ge,Ee,Ne,be,We,nt){if(Ee/=ae,be>=(ge/=ae)&&We<Ee)return je;if(We<ge||be>=Ee)return null;const Xe=[];for(const lt of je){const gt=lt.geometry;let ht=lt.type;const Zt=Ne===0?lt.minX:lt.minY,vn=Ne===0?lt.maxX:lt.maxY;if(Zt>=ge&&vn<Ee){Xe.push(lt);continue}if(vn<ge||Zt>=Ee)continue;let _n=[];if(ht==="Point"||ht==="MultiPoint")Fa(gt,_n,ge,Ee,Ne);else if(ht==="LineString")Po(gt,_n,ge,Ee,Ne,!1,nt.lineMetrics);else if(ht==="MultiLineString")ro(gt,_n,ge,Ee,Ne,!1);else if(ht==="Polygon")ro(gt,_n,ge,Ee,Ne,!0);else if(ht==="MultiPolygon")for(const zn of gt){const ii=[];ro(zn,ii,ge,Ee,Ne,!0),ii.length&&_n.push(ii)}if(_n.length){if(nt.lineMetrics&&ht==="LineString"){for(const zn of _n)Xe.push(Xr(lt.id,ht,zn,lt.tags));continue}ht!=="LineString"&&ht!=="MultiLineString"||(_n.length===1?(ht="LineString",_n=_n[0]):ht="MultiLineString"),ht!=="Point"&&ht!=="MultiPoint"||(ht=_n.length===3?"Point":"MultiPoint"),Xe.push(Xr(lt.id,ht,_n,lt.tags))}}return Xe.length?Xe:null}function Fa(je,ae,ge,Ee,Ne){for(let be=0;be<je.length;be+=3){const We=je[be+Ne];We>=ge&&We<=Ee&&Ea(ae,je[be],je[be+1],je[be+2])}}function Po(je,ae,ge,Ee,Ne,be,We){let nt=bl(je);const Xe=Ne===0?Ua:Co;let lt,gt,ht=je.start;for(let ii=0;ii<je.length-3;ii+=3){const si=je[ii],gi=je[ii+1],ui=je[ii+2],Wi=je[ii+3],_r=je[ii+4],ir=Ne===0?si:gi,ki=Ne===0?Wi:_r;let Fi=!1;We&&(lt=Math.sqrt(Math.pow(si-Wi,2)+Math.pow(gi-_r,2))),ir<ge?ki>ge&&(gt=Xe(nt,si,gi,Wi,_r,ge),We&&(nt.start=ht+lt*gt)):ir>Ee?ki<Ee&&(gt=Xe(nt,si,gi,Wi,_r,Ee),We&&(nt.start=ht+lt*gt)):Ea(nt,si,gi,ui),ki<ge&&ir>=ge&&(gt=Xe(nt,si,gi,Wi,_r,ge),Fi=!0),ki>Ee&&ir<=Ee&&(gt=Xe(nt,si,gi,Wi,_r,Ee),Fi=!0),!be&&Fi&&(We&&(nt.end=ht+lt*gt),ae.push(nt),nt=bl(je)),We&&(ht+=lt)}let Zt=je.length-3;const vn=je[Zt],_n=je[Zt+1],zn=Ne===0?vn:_n;zn>=ge&&zn<=Ee&&Ea(nt,vn,_n,je[Zt+2]),Zt=nt.length-3,be&&Zt>=3&&(nt[Zt]!==nt[0]||nt[Zt+1]!==nt[1])&&Ea(nt,nt[0],nt[1],nt[2]),nt.length&&ae.push(nt)}function bl(je){const ae=[];return ae.size=je.size,ae.start=je.start,ae.end=je.end,ae}function ro(je,ae,ge,Ee,Ne,be){for(const We of je)Po(We,ae,ge,Ee,Ne,be,!1)}function Ea(je,ae,ge,Ee){je.push(ae,ge,Ee)}function Ua(je,ae,ge,Ee,Ne,be){const We=(be-ae)/(Ee-ae);return Ea(je,be,ge+(Ne-ge)*We,1),We}function Co(je,ae,ge,Ee,Ne,be){const We=(be-ge)/(Ne-ge);return Ea(je,ae+(Ee-ae)*We,be,1),We}function ea(je,ae){const ge=[];for(let Ee=0;Ee<je.length;Ee++){const Ne=je[Ee],be=Ne.type;let We;if(be==="Point"||be==="MultiPoint"||be==="LineString")We=Aa(Ne.geometry,ae);else if(be==="MultiLineString"||be==="Polygon"){We=[];for(const nt of Ne.geometry)We.push(Aa(nt,ae))}else if(be==="MultiPolygon"){We=[];for(const nt of Ne.geometry){const Xe=[];for(const lt of nt)Xe.push(Aa(lt,ae));We.push(Xe)}}ge.push(Xr(Ne.id,be,We,Ne.tags))}return ge}function Aa(je,ae){const ge=[];ge.size=je.size,je.start!==void 0&&(ge.start=je.start,ge.end=je.end);for(let Ee=0;Ee<je.length;Ee+=3)ge.push(je[Ee]+ae,je[Ee+1],je[Ee+2]);return ge}function Go(je,ae){if(je.transformed)return je;const ge=1<<je.z,Ee=je.x,Ne=je.y;for(const be of je.features){const We=be.geometry,nt=be.type;if(be.geometry=[],nt===1)for(let Xe=0;Xe<We.length;Xe+=2)be.geometry.push(tr(We[Xe],We[Xe+1],ae,ge,Ee,Ne));else for(let Xe=0;Xe<We.length;Xe++){const lt=[];for(let gt=0;gt<We[Xe].length;gt+=2)lt.push(tr(We[Xe][gt],We[Xe][gt+1],ae,ge,Ee,Ne));be.geometry.push(lt)}}return je.transformed=!0,je}function tr(je,ae,ge,Ee,Ne,be){return[Math.round(ge*(je*Ee-Ne)),Math.round(ge*(ae*Ee-be))]}function Pa(je,ae,ge,Ee,Ne){const be=ae===Ne.maxZoom?0:Ne.tolerance/((1<<ae)*Ne.extent),We={features:[],numPoints:0,numSimplified:0,numFeatures:je.length,source:null,x:ge,y:Ee,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const nt of je)Is(We,nt,be,Ne);return We}function Is(je,ae,ge,Ee){const Ne=ae.geometry,be=ae.type,We=[];if(je.minX=Math.min(je.minX,ae.minX),je.minY=Math.min(je.minY,ae.minY),je.maxX=Math.max(je.maxX,ae.maxX),je.maxY=Math.max(je.maxY,ae.maxY),be==="Point"||be==="MultiPoint")for(let nt=0;nt<Ne.length;nt+=3)We.push(Ne[nt],Ne[nt+1]),je.numPoints++,je.numSimplified++;else if(be==="LineString")ta(We,Ne,je,ge,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(let nt=0;nt<Ne.length;nt++)ta(We,Ne[nt],je,ge,be==="Polygon",nt===0);else if(be==="MultiPolygon")for(let nt=0;nt<Ne.length;nt++){const Xe=Ne[nt];for(let lt=0;lt<Xe.length;lt++)ta(We,Xe[lt],je,ge,!0,lt===0)}if(We.length){let nt=ae.tags||null;if(be==="LineString"&&Ee.lineMetrics){nt={};for(const lt in ae.tags)nt[lt]=ae.tags[lt];nt.mapbox_clip_start=Ne.start/Ne.size,nt.mapbox_clip_end=Ne.end/Ne.size}const Xe={geometry:We,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:nt};ae.id!==null&&(Xe.id=ae.id),je.features.push(Xe)}}function ta(je,ae,ge,Ee,Ne,be){const We=Ee*Ee;if(Ee>0&&ae.size<(Ne?We:Ee))return void(ge.numPoints+=ae.length/3);const nt=[];for(let Xe=0;Xe<ae.length;Xe+=3)(Ee===0||ae[Xe+2]>We)&&(ge.numSimplified++,nt.push(ae[Xe],ae[Xe+1])),ge.numPoints++;Ne&&function(Xe,lt){let gt=0;for(let ht=0,Zt=Xe.length,vn=Zt-2;ht<Zt;vn=ht,ht+=2)gt+=(Xe[ht]-Xe[vn])*(Xe[ht+1]+Xe[vn+1]);if(gt>0===lt)for(let ht=0,Zt=Xe.length;ht<Zt/2;ht+=2){const vn=Xe[ht],_n=Xe[ht+1];Xe[ht]=Xe[Zt-2-ht],Xe[ht+1]=Xe[Zt-1-ht],Xe[Zt-2-ht]=vn,Xe[Zt-1-ht]=_n}}(nt,be),je.push(nt)}const al={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ls{constructor(ae,ge){const Ee=(ge=this.options=function(be,We){for(const nt in We)be[nt]=We[nt];return be}(Object.create(al),ge)).debug;if(Ee&&console.time("preprocess data"),ge.maxZoom<0||ge.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ge.promoteId&&ge.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ne=function(be,We){const nt=[];if(be.type==="FeatureCollection")for(let Xe=0;Xe<be.features.length;Xe++)go(nt,be.features[Xe],We,Xe);else go(nt,be.type==="Feature"?be:{geometry:be},We);return nt}(ae,ge);this.tiles={},this.tileCoords=[],Ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ge.indexMaxZoom,ge.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=function(be,We){const nt=We.buffer/We.extent;let Xe=be;const lt=Ar(be,1,-1-nt,nt,0,-1,2,We),gt=Ar(be,1,1-nt,2+nt,0,-1,2,We);return(lt||gt)&&(Xe=Ar(be,1,-nt,1+nt,0,-1,2,We)||[],lt&&(Xe=ea(lt,1).concat(Xe)),gt&&(Xe=Xe.concat(ea(gt,-1)))),Xe}(Ne,ge),Ne.length&&this.splitTile(Ne,0,0,0),Ee&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ae,ge,Ee,Ne,be,We,nt){const Xe=[ae,ge,Ee,Ne],lt=this.options,gt=lt.debug;for(;Xe.length;){Ne=Xe.pop(),Ee=Xe.pop(),ge=Xe.pop(),ae=Xe.pop();const ht=1<<ge,Zt=Ca(ge,Ee,Ne);let vn=this.tiles[Zt];if(!vn&&(gt>1&&console.time("creation"),vn=this.tiles[Zt]=Pa(ae,ge,Ee,Ne,lt),this.tileCoords.push({z:ge,x:Ee,y:Ne}),gt)){gt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ge,Ee,Ne,vn.numFeatures,vn.numPoints,vn.numSimplified),console.timeEnd("creation"));const Fi=`z${ge}`;this.stats[Fi]=(this.stats[Fi]||0)+1,this.total++}if(vn.source=ae,be==null){if(ge===lt.indexMaxZoom||vn.numPoints<=lt.indexMaxPoints)continue}else{if(ge===lt.maxZoom||ge===be)continue;if(be!=null){const Fi=be-ge;if(Ee!==We>>Fi||Ne!==nt>>Fi)continue}}if(vn.source=null,ae.length===0)continue;gt>1&&console.time("clipping");const _n=.5*lt.buffer/lt.extent,zn=.5-_n,ii=.5+_n,si=1+_n;let gi=null,ui=null,Wi=null,_r=null,ir=Ar(ae,ht,Ee-_n,Ee+ii,0,vn.minX,vn.maxX,lt),ki=Ar(ae,ht,Ee+zn,Ee+si,0,vn.minX,vn.maxX,lt);ae=null,ir&&(gi=Ar(ir,ht,Ne-_n,Ne+ii,1,vn.minY,vn.maxY,lt),ui=Ar(ir,ht,Ne+zn,Ne+si,1,vn.minY,vn.maxY,lt),ir=null),ki&&(Wi=Ar(ki,ht,Ne-_n,Ne+ii,1,vn.minY,vn.maxY,lt),_r=Ar(ki,ht,Ne+zn,Ne+si,1,vn.minY,vn.maxY,lt),ki=null),gt>1&&console.timeEnd("clipping"),Xe.push(gi||[],ge+1,2*Ee,2*Ne),Xe.push(ui||[],ge+1,2*Ee,2*Ne+1),Xe.push(Wi||[],ge+1,2*Ee+1,2*Ne),Xe.push(_r||[],ge+1,2*Ee+1,2*Ne+1)}}getTile(ae,ge,Ee){ae=+ae,ge=+ge,Ee=+Ee;const Ne=this.options,{extent:be,debug:We}=Ne;if(ae<0||ae>24)return null;const nt=1<<ae,Xe=Ca(ae,ge=ge+nt&nt-1,Ee);if(this.tiles[Xe])return Go(this.tiles[Xe],be);We>1&&console.log("drilling down to z%d-%d-%d",ae,ge,Ee);let lt,gt=ae,ht=ge,Zt=Ee;for(;!lt&&gt>0;)gt--,ht>>=1,Zt>>=1,lt=this.tiles[Ca(gt,ht,Zt)];return lt&&lt.source?(We>1&&(console.log("found parent tile z%d-%d-%d",gt,ht,Zt),console.time("drilling down")),this.splitTile(lt.source,gt,ht,Zt,ae,ge,Ee),We>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Go(this.tiles[Xe],be):null):null}}function Ca(je,ae,ge){return 32*((1<<je)*ge+ae)+je}function hn(je,ae){const ge=je.tileID.canonical;if(!this._geoJSONIndex)return void ae(null,null);const Ee=this._geoJSONIndex.getTile(ge.z,ge.x,ge.y);if(!Ee)return void ae(null,null);const Ne=Xe=>Xe.tags&&"3d_elevation_id"in Xe.tags&&"source"in Xe.tags&&Xe.tags.source==="elevation",be=Ee.features.filter(Xe=>Ne(Xe));let We;if(be.length>0){const Xe=Ee.features.filter(lt=>!Ne(lt));We=new tt({_geojsonTileLayer:Xe,hd_road_elevation:be})}else We=new xe(Ee.features);let nt=An(We);nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),ae(null,{vectorTile:We,rawData:nt.buffer})}class vs extends oe{constructor(ae,ge,Ee,Ne,be,We,nt){super(ae,ge,Ee,Ne,be,hn,nt),We&&(this.loadGeoJSON=We),this._dynamicIndex=new Ve}loadData(ae,ge){const Ee=ae&&ae.request,Ne=Ee&&Ee.collectResourceTiming;this.loadGeoJSON(ae,(be,We)=>{if(be||!We)return ge(be);if(typeof We!="object")return ge(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));{try{if(ae.filter){const Xe=o.X(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Xe.result==="error")throw new Error(Xe.value.map(lt=>`${lt.key}: ${lt.message}`).join(", "));We.features=We.features.filter(lt=>Xe.value.evaluate({zoom:0},lt))}ae.dynamic?(We.type==="Feature"&&(We={type:"FeatureCollection",features:[We]}),ae.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(We.features,this.loaded),ae.cluster&&(We.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ae.cluster?new ai(function({superclusterOptions:Xe,clusterProperties:lt}){if(!lt||!Xe)return Xe;const gt={},ht={},Zt={accumulated:null,zoom:0},vn={properties:null},_n=Object.keys(lt);for(const zn of _n){const[ii,si]=lt[zn],gi=o.X(si),ui=o.X(typeof ii=="string"?[ii,["accumulated"],["get",zn]]:ii);gt[zn]=gi.value,ht[zn]=ui.value}return Xe.map=zn=>{vn.properties=zn;const ii={};for(const si of _n)ii[si]=gt[si].evaluate(Zt,vn);return ii},Xe.reduce=(zn,ii)=>{vn.properties=ii;for(const si of _n)Zt.accumulated=zn[si],zn[si]=ht[si].evaluate(Zt,vn)},Xe}(ae)).load(We.features):ae.dynamic?this._dynamicIndex:function(Xe,lt){return new ls(Xe,lt)}(We,ae.geojsonVtOptions)}catch(Xe){return ge(Xe)}const nt={};if(Ne){const Xe=C(Ee);Xe&&(nt.resourceTiming={},nt.resourceTiming[ae.source]=JSON.parse(JSON.stringify(Xe)))}ge(null,nt)}})}reloadTile(ae,ge){const Ee=this.loaded;return Ee&&Ee[ae.uid]?ae.partial?ge(null,void 0):super.reloadTile(ae,ge):this.loadTile(ae,ge)}loadGeoJSON(ae,ge){if(ae.request)o.n(ae.request,ge);else{if(typeof ae.data!="string")return ge(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));try{return ge(null,JSON.parse(ae.data))}catch{return ge(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ae,ge){try{ge(null,this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId))}catch(Ee){ge(Ee)}}getClusterChildren(ae,ge){try{ge(null,this._geoJSONIndex.getChildren(ae.clusterId))}catch(Ee){ge(Ee)}}getClusterLeaves(ae,ge){try{ge(null,this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset))}catch(Ee){ge(Ee)}}}class Ja{constructor(ae,ge,Ee){this.tileID=new o.aM(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.tileZoom=ae.tileZoom,this.uid=ae.uid,this.zoom=ae.zoom,this.canonical=ae.tileID.canonical,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ae.projection,this.brightness=ge,this.worldview=Ee}parse(ae,ge,Ee,Ne){this.status="parsing";const be=new o.aM(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),We=[],nt=ge.familiesBySource[Ee.source],Xe=new o.f0(be,Ee.promoteId);Xe.bucketLayerIDs=[],Xe.is3DTile=!0,o.fi(ae).then(lt=>{if(!lt)return Ne(new Error("Could not parse tile"));const gt=lt.json.extensionsUsed&&lt.json.extensionsUsed.includes("MAPBOX_mesh_features")||lt.json.asset.extras&&lt.json.asset.extras.MAPBOX_mesh_features,ht=lt.json.extensionsUsed&&lt.json.extensionsUsed.includes("EXT_meshopt_compression"),Zt=new o.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const vn in nt)for(const _n of nt[vn]){const zn=_n[0];Xe.bucketLayerIDs.push(_n.map(gi=>o.C(gi.id,gi.scope))),zn.recalculate(Zt,[]);const ii=o.fj(lt,1/o.cU(Ee.tileID.canonical)),si=new o.fk(_n,ii,be,gt,ht,this.brightness,Xe,this.worldview);gt||(si.needsUpload=!0),We.push(si),si.evaluate(zn)}this.status="done",Ne(null,{buckets:We,featureIndex:Xe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(lt=>Ne(new Error(lt.message)))}}class bt{constructor(ae,ge,Ee,Ne,be,We,nt,Xe){this.actor=ae,this.layerIndex=ge,this.availableImages=Ee,this.availableModels=Ne,this.brightness=nt,this.loading={},this.loaded={},this.worldview=Xe}loadTile(ae,ge){const Ee=ae.uid,Ne=this.loading[Ee]=new Ja(ae,this.brightness,this.worldview);o.br(ae.request,(be,We)=>{const nt=!this.loading[Ee];return delete this.loading[Ee],nt||be?(Ne.status="done",nt||(this.loaded[Ee]=Ne),ge(be)):We&&We.byteLength!==0?void Ne.parse(We,this.layerIndex,ae,(Xe,lt)=>{Ne.status="done",this.loaded=this.loaded||{},this.loaded[Ee]=Ne,Xe||!lt?ge(Xe):ge(null,lt)}):(Ne.status="done",this.loaded[Ee]=Ne,ge())})}reloadTile(ae,ge){const Ee=this.loaded,Ne=ae.uid;if(Ee&&Ee[Ne]){const be=Ee[Ne];be.projection=ae.projection,be.brightness=ae.brightness;const We=(nt,Xe)=>{be.reloadCallback&&(delete be.reloadCallback,this.loadTile(ae,ge)),ge(nt,Xe)};be.status==="parsing"?be.reloadCallback=We:be.status==="done"&&this.loadTile(ae,ge)}}abortTile(ae,ge){const Ee=ae.uid;this.loading[Ee]&&delete this.loading[Ee],ge()}removeTile(ae,ge){const Ee=this.loaded,Ne=ae.uid;Ee&&Ee[Ne]&&delete Ee[Ne],ge()}}class Tt{constructor(ae){this.self=ae,this.actor=new o.fm(ae,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new o.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=o.ce({name:"mercator"}),this.workerSourceTypes={vector:oe,geojson:vs,"raster-dem":ce,"raster-array":ue,"batched-model":bt},this.workerSources={},this.self.registerWorkerSource=(ge,Ee)=>{if(this.workerSourceTypes[ge])throw new Error(`Worker source with name "${ge}" already registered.`);this.workerSourceTypes[ge]=Ee},this.self.registerRTLTextPlugin=ge=>{if(o.fn.isParsed())throw new Error("RTL text plugin already registered.");o.fn.setState({pluginStatus:o.fo.parsed,pluginURL:o.fn.getPluginURL()}),o.fn.applyArabicShaping=ge.applyArabicShaping,o.fn.processBidirectionalText=ge.processBidirectionalText,o.fn.processStyledBidirectionalText=ge.processStyledBidirectionalText;for(const Ee of this.rtlPluginParsingListeners)Ee(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(ae,ge,Ee){delete this.layerIndexes[ae],delete this.availableImages[ae],delete this.availableModels[ae],delete this.workerSources[ae],Ee()}checkIfReady(ae,ge,Ee){Ee()}setReferrer(ae,ge){this.referrer=ge}spriteLoaded(ae,ge){this.isSpriteLoaded[ae]||(this.isSpriteLoaded[ae]={});const{scope:Ee,isLoaded:Ne}=ge;if(this.isSpriteLoaded[ae][Ee]=Ne,this.workerSources[ae]&&this.workerSources[ae][Ee])for(const be in this.workerSources[ae][Ee]){const We=this.workerSources[ae][Ee][be];for(const nt in We){const Xe=We[nt];Xe instanceof oe&&(Xe.isSpriteLoaded=Ne,Xe.fire(new o.A("isSpriteLoaded")))}}}setImages(ae,ge,Ee){this.availableImages[ae]||(this.availableImages[ae]={});const{scope:Ne,images:be}=ge;if(this.availableImages[ae][Ne]=be,this.workerSources[ae]&&this.workerSources[ae][Ne]){for(const We in this.workerSources[ae][Ne]){const nt=this.workerSources[ae][Ne][We];for(const Xe in nt)nt[Xe].availableImages=be}Ee()}else Ee()}setModels(ae,{scope:ge,models:Ee},Ne){if(this.availableModels[ae]||(this.availableModels[ae]={}),this.availableModels[ae][ge]=Ee,this.workerSources[ae]&&this.workerSources[ae][ge]){for(const be in this.workerSources[ae][ge]){const We=this.workerSources[ae][ge][be];for(const nt in We)We[nt].availableModels=Ee}Ne()}else Ne()}setProjection(ae,ge){this.projections[ae]=o.ce(ge)}setBrightness(ae,ge,Ee){this.brightness=ge,Ee()}setWorldview(ae,ge,Ee){this.worldview=ge,Ee()}setLayers(ae,ge,Ee){this.getLayerIndex(ae,ge.scope).replace(ge.layers,ge.options),Ee()}updateLayers(ae,ge,Ee){this.getLayerIndex(ae,ge.scope).update(ge.layers,ge.removedIds,ge.options),Ee()}loadTile(ae,ge,Ee){ge.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,ge.type,ge.source,ge.scope).loadTile(ge,Ee)}decodeRasterArray(ae,ge,Ee){this.getWorkerSource(ae,ge.type,ge.source,ge.scope).decodeRasterArray(ge,Ee)}reloadTile(ae,ge,Ee){ge.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,ge.type,ge.source,ge.scope).reloadTile(ge,Ee)}abortTile(ae,ge,Ee){this.getWorkerSource(ae,ge.type,ge.source,ge.scope).abortTile(ge,Ee)}removeTile(ae,ge,Ee){this.getWorkerSource(ae,ge.type,ge.source,ge.scope).removeTile(ge,Ee)}removeSource(ae,ge,Ee){if(!(this.workerSources[ae]&&this.workerSources[ae][ge.scope]&&this.workerSources[ae][ge.scope][ge.type]&&this.workerSources[ae][ge.scope][ge.type][ge.source]))return;const Ne=this.workerSources[ae][ge.scope][ge.type][ge.source];delete this.workerSources[ae][ge.scope][ge.type][ge.source],Ne.removeSource!==void 0?Ne.removeSource(ge,Ee):Ee()}loadWorkerSource(ae,ge,Ee){try{this.self.importScripts(ge.url),Ee()}catch(Ne){Ee(Ne.toString())}}syncRTLPluginState(ae,ge,Ee){if(o.fn.isParsed())Ee(null,!0);else if(o.fn.isParsing())this.rtlPluginParsingListeners.push(Ee);else try{o.fn.setState(ge);const Ne=o.fn.getPluginURL();!o.fn.isLoaded()||o.fn.isParsed()||o.fn.isParsing()||Ne==null||(o.fn.setState({pluginStatus:o.fo.parsing,pluginURL:o.fn.getPluginURL()}),this.self.importScripts(Ne),o.fn.isParsed()?Ee(null,!0):this.rtlPluginParsingListeners.push(Ee))}catch(Ne){Ee(Ne.toString())}}setDracoUrl(ae,ge){this.dracoUrl=ge}getAvailableImages(ae,ge){this.availableImages[ae]||(this.availableImages[ae]={});let Ee=this.availableImages[ae][ge];return Ee||(Ee=[]),Ee}getAvailableModels(ae,ge){this.availableModels[ae]||(this.availableModels[ae]={});let Ee=this.availableModels[ae][ge];return Ee||(Ee={}),Ee}getLayerIndex(ae,ge){this.layerIndexes[ae]||(this.layerIndexes[ae]={});let Ee=this.layerIndexes[ae][ge];return Ee||(Ee=this.layerIndexes[ae][ge]=new j,Ee.scope=ge),Ee}getWorkerSource(ae,ge,Ee,Ne){const be=this.workerSources;return be[ae]||(be[ae]={}),be[ae][Ne]||(be[ae][Ne]={}),be[ae][Ne][ge]||(be[ae][Ne][ge]={}),this.isSpriteLoaded[ae]||(this.isSpriteLoaded[ae]={}),be[ae][Ne][ge][Ee]||(be[ae][Ne][ge][Ee]=new this.workerSourceTypes[ge]({send:(We,nt,Xe,lt,gt,ht)=>this.actor.send(We,nt,Xe,ae,gt,ht),scheduler:this.actor.scheduler},this.getLayerIndex(ae,Ne),this.getAvailableImages(ae,Ne),this.getAvailableModels(ae,Ne),this.isSpriteLoaded[ae][Ne],void 0,this.brightness,this.worldview)),be[ae][Ne][ge][Ee]}rasterizeImagesWorker(ae,ge,Ee){const Ne=new Map;for(const[be,{image:We,imageVariant:nt}]of ge.tasks.entries()){const Xe=this.imageRasterizer.rasterize(nt,We,ge.scope,ae);Ne.set(be,Xe)}Ee(void 0,Ne)}removeRasterizedImages(ae,ge,Ee){this.imageRasterizer.removeImagesFromCacheByIds(ge.imageIds,ge.scope,ae),Ee()}enforceCacheSizeLimit(ae,ge){o.fp(ge)}getWorkerPerformanceMetrics(ae,ge,Ee){Ee(void 0,void 0)}}return o.fl(self)&&(self.worker=new Tt(self)),Tt}),y(["./shared"],function(o){var C="3.13.0";const M={create:"create",load:"load",fullLoad:"fullLoad"},I={mark(m){performance.mark(m)},measure(m,r,u){performance.measure(m,r,u)}};function j(m){const r=m.name.split("?")[0];return o.a(r)&&r.includes("mapbox-gl.js")?"javascript":o.a(r)&&r.includes("mapbox-gl.css")?"css":o.b(r)?"fontRange":o.c(r)?"sprite":o.i(r)?"style":o.d(r)?"tilejson":"other"}var q,K={},J=function(){if(q)return K;function m(g){return!r(g)}function r(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,P,R=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(R);try{P=new Worker(N),S=!0}catch{S=!1}return P&&P.terminate(),URL.revokeObjectURL(N),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var P=S.getContext("2d");if(!P)return!1;var R=P.getImageData(0,0,1,1);return R&&R.width===S.width}()?(u[w=g&&g.failIfMajorPerformanceCaveat]===void 0&&(u[w]=function(S){var P,R=function(N){var V=document.createElement("canvas"),G=Object.create(m.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=N,V.getContext("webgl2",G)}(S);if(!R)return!1;try{P=R.createShader(R.VERTEX_SHADER)}catch{return!1}return!(!P||R.isContextLost())&&(R.shaderSource(P,"void main() {}"),R.compileShader(P),R.getShaderParameter(P,R.COMPILE_STATUS)===!0)}(w)),u[w]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var w}q=1,K.supported=m,K.notSupportedReason=r;var u={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},K}();function te(m,r,u){const g=document.createElement(m);return r!=null&&(g.className=r),u&&u.appendChild(g),g}function oe(m,r,u){const g=document.createElementNS("http://www.w3.org/2000/svg",m);for(const w of Object.keys(r))g.setAttributeNS(null,w,String(r[w]));return u&&u.appendChild(g),g}const ce=typeof document<"u"?document.documentElement&&document.documentElement.style:null,de=ce&&ce.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ue;function Pe(){ce&&de&&(ue=ce[de],ce[de]="none")}function Oe(){ce&&de&&(ce[de]=ue)}function xe(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",xe,!0)}function Qe(){window.addEventListener("click",xe,!0),window.setTimeout(()=>{window.removeEventListener("click",xe,!0)},0)}function tt(m,r){const u=m.getBoundingClientRect();return Ve(m,u,r)}function Ge(m,r){const u=m.getBoundingClientRect(),g=[];for(let w=0;w<r.length;w++)g.push(Ve(m,u,r[w]));return g}function Je(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function Ve(m,r,u){const g=m.offsetWidth===r.width?1:m.offsetWidth/r.width;return new o.P((u.clientX-r.left)*g,(u.clientY-r.top)*g)}const xt="01",yt="NO_ACCESS_TOKEN";class ot{constructor(r,u,g){this._transformRequestFn=r,this._customAccessToken=u,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const r=function(){let u="";for(let g=0;g<10;g++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",xt,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,u){return this._transformRequestFn&&this._transformRequestFn(r,u)||{url:r}}normalizeStyleURL(r,u){if(!o.j(r))return r;const g=rt(r);return g.params.push(`sdk=js-${C}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeGlyphsURL(r,u){if(!o.j(r))return r;const g=rt(r);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeModelURL(r,u){if(!o.j(r))return r;const g=rt(r);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeSourceURL(r,u,g,w){if(!o.j(r))return r;const S=rt(r);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),g&&S.params.push(`language=${g}`),w&&S.params.push(`worldview=${w}`),this._makeAPIURL(S,this._customAccessToken||u)}normalizeIconsetURL(r,u){const g=rt(r);return o.j(r)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||u)):Bt(g)}normalizeSpriteURL(r,u,g,w){const S=rt(r);return o.j(r)?(S.path=`/styles/v1${S.path}/sprite${u}${g}`,this._makeAPIURL(S,this._customAccessToken||w)):(S.path+=`${u}${g}`,Bt(S))}normalizeTileURL(r,u,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!o.j(r))return r;const w=rt(r);w.path=w.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||g&&w.authority!=="raster"&&g===512?"@2x":""}${o.l.supported?".webp":"$1"}`),w.authority==="raster"?w.path=`/${o.e.RASTER_URL_PREFIX}${w.path}`:w.authority==="rasterarrays"?w.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${w.path}`:w.authority==="3dtiles"?w.path=`/${o.e.TILES3D_URL_PREFIX}${w.path}`:(w.path=w.path.replace(/^.+\/v4\//,"/"),w.path=`/${o.e.TILE_URL_VERSION}${w.path}`);const S=this._customAccessToken||function(P){for(const R of P){const N=R.match(/^access_token=(.*)$/);if(N)return N[1]}return null}(w.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&w.params.push(`sku=${this._skuToken}`),this._makeAPIURL(w,S)}canonicalizeTileURL(r,u){const g=rt(r);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return r;let w="mapbox://";g.path.match(/^\/raster\/v1\//)?w+=`raster/${g.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?w+=`rasterarrays/${g.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:w+=`tiles/${g.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let S=g.params;return u&&(S=S.filter(P=>!P.match(/^access_token=/))),S.length&&(w+=`?${S.join("&")}`),w}canonicalizeTileset(r,u){const g=!!u&&o.j(u),w=[];for(const S of r.tiles||[])o.k(S)?w.push(this.canonicalizeTileURL(S,g)):w.push(S);return w}_makeAPIURL(r,u){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",w=rt(o.e.API_URL);if(r.protocol=w.protocol,r.authority=w.authority,r.protocol==="http"){const S=r.params.indexOf("secure");S>=0&&r.params.splice(S,1)}if(w.path!=="/"&&(r.path=`${w.path}${r.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Bt(r);if(u=u||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return r.params=r.params.filter(S=>S.indexOf("access_token")===-1),r.params.push(`access_token=${u||""}`),Bt(r)}}const zt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function rt(m){const r=m.match(zt);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Bt(m){const r=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${r}`}const Vt="mapbox.eventData";function Ln(m){if(!m)return null;const r=m.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(o.m(r[1]))}catch{return null}}class $e{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const u=Ln(o.e.ACCESS_TOKEN);let g="";return g=u&&u.u?o.f(u.u):o.e.ACCESS_TOKEN||"",r?`${Vt}.${r}:${g}`:`${Vt}:${g}`}fetchEventData(){const r=o.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid");if(r)try{const w=localStorage.getItem(u);w&&(this.eventData=JSON.parse(w));const S=localStorage.getItem(g);S&&(this.anonId=S)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const r=o.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),w=this.anonId;if(r&&w)try{localStorage.setItem(g,w),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,u,g,w){if(!o.e.EVENTS_URL)return;const S=rt(o.e.EVENTS_URL);S.params.push(`access_token=${w||o.e.ACCESS_TOKEN||""}`);const P={event:this.type,created:new Date(r).toISOString()},R=u?o.h(P,u):P,N={url:Bt(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([R])};this.pendingRequest=o.p(N,V=>{this.pendingRequest=null,g(V),this.saveEventData(),this.processRequests(w)})}queueRequest(r,u){this.queue.push(r),this.processRequests(u)}}const Pt=new class extends $e{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,r){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(u=>o.j(u)||o.k(u))&&this.queueRequest(Date.now(),r)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Ln(o.e.ACCESS_TOKEN),u=r?r.u:o.e.ACCESS_TOKEN;let g=u!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),g=!0);const w=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),P=new Date(w),R=(w-this.eventData.lastSuccess)/864e5;g=g||R>=1||R<-1||S.getDate()!==P.getDate()}else g=!0;g?this.postEvent(w,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:xt,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=w,this.eventData.tokenU=u)},m):this.processRequests()}},$t=Pt.postTurnstileEvent.bind(Pt),on=new class extends $e{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,r,u,g){this.skuToken=r,this.errorCb=g,o.e.EVENTS_URL&&(u||o.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},u):this.errorCb(new Error(yt)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:u}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:xt,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):r&&(this.success[r]=!0)},m))}remove(){this.errorCb=null}},An=on.postMapLoadEvent.bind(on),ct=new class extends $e{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let r=this.mapInstanceIdMap.get(m);return r||(r=o.u(),this.mapInstanceIdMap.set(m,r)),r}getEventId(m){const r=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,r+1),r}postStyleLoadEvent(m,r){const{map:u,style:g,importedStyles:w}=r;if(!o.e.EVENTS_URL||!m&&!o.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(u),P={mapInstanceId:S,eventId:this.getEventId(S),style:g};w.length&&(P.importedStyles=w),this.queueRequest({timestamp:Date.now(),payload:P},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:u}=this.queue.shift();this.postEvent(r,u,()=>{},m)}},kt=ct.postStyleLoadEvent.bind(ct),In=new class extends $e{constructor(){super("gljs.performance")}postPerformanceEvent(m,r){o.e.EVENTS_URL&&(m||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:u}=this.queue.shift(),g=function(w){const S=performance.getEntriesByType("resource"),P=performance.getEntriesByType("mark"),R=function(Q){const fe={};if(Q){for(const se in Q)if(se!=="other")for(const pe of Q[se]){const ye=`${se}ResolveRangeMin`,we=`${se}ResolveRangeMax`,De=`${se}RequestCount`,Le=`${se}RequestCachedCount`;fe[ye]=Math.min(fe[ye]||1/0,pe.startTime),fe[we]=Math.max(fe[we]||-1/0,pe.responseEnd);const Ze=Ue=>{fe[Ue]===void 0&&(fe[Ue]=0),++fe[Ue]};pe.transferSize!==void 0&&pe.transferSize===0&&Ze(Le),Ze(De)}}return fe}(function(Q,fe){const se={};if(Q)for(const pe of Q){const ye=fe(pe);se[ye]===void 0&&(se[ye]=[]),se[ye].push(pe)}return se}(S,j)),N=window.devicePixelRatio,V=navigator.connection||navigator.mozConnection||navigator.webkitConnection,G=V?V.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},W=(Q,fe,se)=>{se!=null&&Q.push({name:fe,value:se.toString()})};for(const Q in R)W(X.counters,Q,R[Q]);if(w.interactionRange[0]!==1/0&&w.interactionRange[1]!==-1/0&&(W(X.counters,"interactionRangeMin",w.interactionRange[0]),W(X.counters,"interactionRangeMax",w.interactionRange[1])),P)for(const Q of Object.keys(M)){const fe=M[Q],se=P.find(pe=>pe.name===fe);se&&W(X.counters,fe,se.startTime)}return W(X.counters,"visibilityHidden",w.visibilityHidden),W(X.attributes,"style",function(Q){if(Q)for(const fe of Q){const se=fe.name.split("?")[0];if(o.i(se)){const pe=se.split("/").slice(-2);if(pe.length===2)return`mapbox://styles/${pe[0]}/${pe[1]}`}}}(S)),W(X.attributes,"terrainEnabled",w.terrainEnabled?"true":"false"),W(X.attributes,"fogEnabled",w.fogEnabled?"true":"false"),W(X.attributes,"projection",w.projection),W(X.attributes,"zoom",w.zoom),W(X.metadata,"devicePixelRatio",N),W(X.metadata,"connectionEffectiveType",G),W(X.metadata,"navigatorUserAgent",navigator.userAgent),W(X.metadata,"screenWidth",window.screen.width),W(X.metadata,"screenHeight",window.screen.height),W(X.metadata,"windowWidth",window.innerWidth),W(X.metadata,"windowHeight",window.innerHeight),W(X.metadata,"mapWidth",w.width/N),W(X.metadata,"mapHeight",w.height/N),W(X.metadata,"webglRenderer",w.renderer),W(X.metadata,"webglVendor",w.vendor),W(X.metadata,"sdkVersion",C),W(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(u);for(const w of g.metadata);for(const w of g.counters);for(const w of g.attributes);this.postEvent(r,g,()=>{},m)}},ti=In.postPerformanceEvent.bind(In),Dt=new class extends $e{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,r,u,g){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const w=rt(o.e.API_URL+o.e.SESSION_PATH);w.params.push(`sku=${r||""}`),w.params.push(`access_token=${g||o.e.ACCESS_TOKEN||""}`);const S={url:Bt(w),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(S,P=>{this.pendingRequest=null,u(P),this.saveEventData(),this.processRequests(g)})}getSessionAPI(m,r,u,g){this.skuToken=r,this.errorCb=g,o.e.SESSION_PATH&&o.e.API_URL&&(u||o.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},u):this.errorCb(new Error(yt)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:u}=this.queue.shift();r&&this.success[r]||this.getSession(u,this.skuToken,g=>{g?this.errorCb(g):r&&(this.success[r]=!0)},m)}remove(){this.errorCb=null}},jn=Dt.getSessionAPI.bind(Dt),ai=new Set;function mn(m,r){r?ai.add(m):ai.delete(m)}class ci{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,u){this._updatedSourceCaches[r]=u,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const u=r.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(r.id),this.setDirty()}removeLayer(r){const u=r.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][r.id]=r,this._updatedLayers[u].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const u in this._updatedLayers)r[u]=r[u]||{},r[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)r[u]=r[u]||{},r[u].removedIds=Object.keys(this._removedLayers[u]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(r){return this._updatedImages[r]?Array.from(this._updatedImages[r].values()):[]}updateImage(r,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(o.I.toString(r)),this.setDirty()}resetUpdatedImages(r){this._updatedImages[r]&&this._updatedImages[r].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Ii(m){const{userImage:r}=m;return!!(r&&r.render&&r.render())&&(m.data.replace(new Uint8Array(r.data.buffer)),!0)}class Mi extends o.E{constructor(r){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=r,r!=="raster"&&o.t()&&(this.imageRasterizerDispatcher=new o.D(o.x(),this,"Image Rasterizer Worker",1))}addScope(r){this.loaded.set(r,!1),this.imageProviders.set(r,new Map),this.images.set(r,new Map),this.updatedImages.set(r,new Set),this.callbackDispatchedThisFrame.set(r,new Set),this.patterns.set(r,new Map),this.atlasImage.set(r,new o.r({width:1,height:1}))}removeScope(r){this.loaded.delete(r),this.imageProviders.delete(r),this.images.delete(r),this.updatedImages.delete(r),this.callbackDispatchedThisFrame.delete(r),this.patterns.delete(r),this.atlasImage.delete(r);const u=this.atlasTexture.get(r);u&&(u.destroy(),this.atlasTexture.delete(r))}addImageProvider(r,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(r.id,r)}removeImageProvider(r,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(r)}getPendingImageProviders(){const r=[];for(const u of this.imageProviders.values())for(const g of u.values())g.hasPendingRequests()&&r.push(g);return r}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new o.y),this._imageRasterizer}isLoaded(){for(const r of this.loaded.keys())if(!this.loaded.get(r))return!1;return!0}setLoaded(r,u){if(this.loaded.get(u)!==r&&(this.loaded.set(u,r),r)){for(const{ids:g,callback:w}of this.requestors)this._notify(g,u,w);this.requestors=[]}}hasImage(r,u){return!!this.getImage(r,u)}getImage(r,u){return this.images.get(u).get(r.toString())}addImage(r,u,g){this._validate(r,g)&&this.images.get(u).set(r.toString(),g)}_validate(r,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new o.z(new Error(`Image "${r.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new o.z(new Error(`Image "${r.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new o.z(new Error(`Image "${r.name}" has invalid "content" value`))),g=!1),g}_validateStretch(r,u){if(!r)return!0;let g=0;for(const w of r){if(w[0]<g||w[1]<w[0]||u<w[1])return!1;g=w[1]}return!0}_validateContent(r,u){return r?r.length!==4||!u.usvg&&(r[0]<0||u.data.width<r[0]||r[1]<0||u.data.height<r[1]||r[2]<0||u.data.width<r[2]||r[3]<0||u.data.height<r[3])?!1:!(r[2]<r[0]||r[3]<r[1]):!0}updateImage(r,u,g){const w=this.images.get(u).get(r.toString());g.version=w.version+1,this.images.get(u).set(r.toString(),g),this.updatedImages.get(u).add(r),this.removeFromImageRasterizerCache(r,u)}clearUpdatedImages(r){this.updatedImages.get(r).clear()}removeFromImageRasterizerCache(r,u){this.spriteFormat!=="raster"&&(o.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[r],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([r],u))}removeImage(r,u){const g=this.images.get(u),w=g.get(r.toString());g.delete(r.toString()),this.patterns.get(u).delete(r.toString()),this.removeFromImageRasterizerCache(r,u),w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(r){return Array.from(this.images.get(r).keys()).map(u=>o.I.from(u))}getImages(r,u,g){const w=[],S=[],P=this.imageProviders.get(u);for(const G of r){if(!G.iconsetId){w.push(G);continue}const X=P.get(G.iconsetId);X&&(this.getImage(G,u)?S.push(G):X.addPendingRequest(G))}if(w.length===0)return void this._notify(S,u,g);let R=!0;const N=!!this.loaded.get(u),V=this.images.get(u);if(!N)for(const G of w)V.has(G.toString())||(R=!1);N||R?this._notify(w,u,g):this.requestors.push({ids:w,scope:u,callback:g})}rasterizeImages(r,u){const g=new Map,{tasks:w,scope:S}=r;for(const[P,R]of w.entries()){const N=this.getImage(R.id,S);N&&g.set(P,{image:N,imageVariant:R})}this._rasterizeImages(S,g,u)}_rasterizeImages(r,u,g){if(o.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:r},g);else{const w=new Map;for(const[S,{image:P,imageVariant:R}]of u.entries())w.set(S,this.imageRasterizer.rasterize(R,P,r,0));g(void 0,w)}}getUpdatedImages(r){return this.updatedImages.get(r)||new Set}_notify(r,u,g){const w=this.images.get(u),S=new Map;for(const P of r){if(!w.get(P.toString())){if(P.iconsetId)continue;this.fire(new o.A("styleimagemissing",{id:P.name}))}const R=w.get(P.toString());if(!R){o.w(`Image "${P.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const N={data:R.usvg?null:R.data.clone(),pixelRatio:R.pixelRatio,sdf:R.sdf,usvg:R.usvg,version:R.version,stretchX:R.stretchX,stretchY:R.stretchY,content:R.content,hasRenderCallback:!!(R.userImage&&R.userImage.render)};R.usvg&&Object.assign(N,{width:R.icon.usvg_tree.width,height:R.icon.usvg_tree.height}),S.set(o.I.toString(P),N)}g(null,S)}getPixelSize(r){const{width:u,height:g}=this.atlasImage.get(r);return{width:u,height:g}}getPattern(r,u,g){const w=r.toString(),S=this.patterns.get(u),P=S.get(w),R=this.getImage(r,u);if(!R)return null;if(P){if(P.position.version===R.version)return P.position;P.position.version=R.version}else{if(R.usvg&&!R.data){const N=this.getPatternInFlightId(w,u);if(this.patternsInFlight.has(N))return null;this.patternsInFlight.add(N);const V=new o.B(r).scaleSelf(o.q.devicePixelRatio),G=new Map([[V.toString(),{image:R,imageVariant:V}]]);return this._rasterizeImages(u,G,(X,W)=>this.storePatternImage(V,u,R,g,W)),null}this.storePattern(r,u,R)}return this._updatePatternAtlas(u,g),S.get(w).position}getPatternInFlightId(r,u){return o.C(r,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(r,u,g,w,S){const P=r.toString(),R=S?S.get(P):void 0;R&&(g.data=R,this.storePattern(r.id,u,g),this._updatePatternAtlas(u,w),this.patternsInFlight.delete(this.getPatternInFlightId(r.id.toString(),u)))}storePattern(r,u,g){const w={w:g.data.width+2*o.F,h:g.data.height+2*o.F,x:0,y:0},S=new o.G(w,g,o.F);this.patterns.get(u).set(r.toString(),{bin:w,position:S})}bind(r,u){const g=r.gl;let w=this.atlasTexture.get(u);w?this.dirty&&(w.update(this.atlasImage.get(u)),this.dirty=!1):(w=new o.T(r,this.atlasImage.get(u),g.RGBA8),this.atlasTexture.set(u,w)),w.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(r,u){const g=this.patterns.get(r),w=Array.from(g.values()).map(({bin:V})=>V),{w:S,h:P}=o.H(w),R=this.atlasImage.get(r);R.resize({width:S||1,height:P||1});const N=this.images.get(r);for(const[V,{bin:G,position:X}]of g.entries()){let W=X.padding;const Q=G.x+W,fe=G.y+W,se=N.get(V).data,pe=se.width,ye=se.height;W=W>1?W-1:W,o.r.copy(se,R,{x:0,y:0},{x:Q,y:fe},{width:pe,height:ye},u),o.r.copy(se,R,{x:0,y:ye-W},{x:Q,y:fe-W},{width:pe,height:W},u),o.r.copy(se,R,{x:0,y:0},{x:Q,y:fe+ye},{width:pe,height:W},u),o.r.copy(se,R,{x:pe-W,y:0},{x:Q-W,y:fe},{width:W,height:ye},u),o.r.copy(se,R,{x:0,y:0},{x:Q+pe,y:fe},{width:W,height:ye},u),o.r.copy(se,R,{x:pe-W,y:ye-W},{x:Q-W,y:fe-W},{width:W,height:W},u),o.r.copy(se,R,{x:0,y:ye-W},{x:Q+pe,y:fe-W},{width:W,height:W},u),o.r.copy(se,R,{x:0,y:0},{x:Q+pe,y:fe+ye},{width:W,height:W},u),o.r.copy(se,R,{x:pe-W,y:0},{x:Q-W,y:fe+ye},{width:W,height:W},u)}this.dirty=!0}beginFrame(){for(const r of this.images.keys())this.callbackDispatchedThisFrame.set(r,new Set)}dispatchRenderCallbacks(r,u){const g=this.images.get(u);for(const w of r){if(this.callbackDispatchedThisFrame.get(u).has(w.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(w.toString());const S=g.get(w.toString());Ii(S)&&this.updateImage(w,u,S)}}}function Tr(m){const r=m.key,u=m.value,g=m.valueSpec||{},w=m.objectElementValidators||{},S=m.style,P=m.styleSpec;let R=[];const N=o.J(u);if(N!=="object")return[new o.V(r,u,`object expected, ${N} found`)];for(const V in u){const G=V.split(".")[0];let X;w[G]?X=w[G]:g[G]?X=tr:w["*"]?X=w["*"]:g["*"]&&(X=tr),X?R=R.concat(X({key:(r&&`${r}.`)+V,value:u[V],valueSpec:g[G]||g["*"],style:S,styleSpec:P,object:u,objectKey:V},u)):R.push(new o.K(r,u[V],`unknown property "${V}"`))}for(const V in g)w[V]||g[V].required&&g[V].default===void 0&&u[V]===void 0&&R.push(new o.V(r,u,`missing required property "${V}"`));return R}function kr(m){const r=m.value,u=m.valueSpec,g=m.style,w=m.styleSpec,S=m.key,P=m.arrayElementValidator||tr;if(o.J(r)!=="array")return[new o.V(S,r,`array expected, ${o.J(r)} found`)];if(u.length&&r.length!==u.length)return[new o.V(S,r,`array length ${u.length} expected, length ${r.length} found`)];if(u["min-length"]&&r.length<u["min-length"])return[new o.V(S,r,`array length at least ${u["min-length"]} expected, length ${r.length} found`)];let R={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};w.$version<7&&(R.function=u.function),o.J(u.value)==="object"&&(R=u.value);let N=[];for(let V=0;V<r.length;V++)N=N.concat(P({array:r,arrayIndex:V,value:r[V],valueSpec:R,style:g,styleSpec:w,key:`${S}[${V}]`},!0));return N}function ja(m){const r=m.key,u=m.value,g=m.valueSpec;let w=o.J(u);if(w==="number"&&u!=u&&(w="NaN"),w!=="number")return[new o.V(r,u,`number expected, ${w} found`)];if("minimum"in g){let S=g.minimum;if(o.J(g.minimum)==="array"&&(S=g.minimum[m.arrayIndex]),u<S)return[new o.V(r,u,`${u} is less than the minimum value ${S}`)]}if("maximum"in g){let S=g.maximum;if(o.J(g.maximum)==="array"&&(S=g.maximum[m.arrayIndex]),u>S)return[new o.V(r,u,`${u} is greater than the maximum value ${S}`)]}return[]}function Xr(m){const r=m.valueSpec,u=o.M(m.value.type);let g,w,S,P={};const R=u!=="categorical"&&m.value.property===void 0,N=!R,V=o.J(m.value.stops)==="array"&&o.J(m.value.stops[0])==="array"&&o.J(m.value.stops[0][0])==="object",G=Tr({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(Q){if(u==="identity")return[new o.V(Q.key,Q.value,'identity function may not have a "stops" property')];let fe=[];const se=Q.value;return fe=fe.concat(kr({key:Q.key,value:se,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:X})),o.J(se)==="array"&&se.length===0&&fe.push(new o.V(Q.key,se,"array must have at least one stop")),fe},default:function(Q){return tr({key:Q.key,value:Q.value,valueSpec:r,style:Q.style,styleSpec:Q.styleSpec})}}});return u==="identity"&&R&&G.push(new o.V(m.key,m.value,'missing required property "property"')),u==="identity"||m.value.stops||G.push(new o.V(m.key,m.value,'missing required property "stops"')),u==="exponential"&&m.valueSpec.expression&&!o.N(m.valueSpec)&&G.push(new o.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(N&&!o.O(m.valueSpec)?G.push(new o.V(m.key,m.value,"property functions not supported")):R&&!o.Q(m.valueSpec)&&G.push(new o.V(m.key,m.value,"zoom functions not supported"))),u!=="categorical"&&!V||m.value.property!==void 0||G.push(new o.V(m.key,m.value,'"property" property is required')),G;function X(Q){let fe=[];const se=Q.value,pe=Q.key;if(o.J(se)!=="array")return[new o.V(pe,se,`array expected, ${o.J(se)} found`)];if(se.length!==2)return[new o.V(pe,se,`array length 2 expected, length ${se.length} found`)];if(V){if(o.J(se[0])!=="object")return[new o.V(pe,se,`object expected, ${o.J(se[0])} found`)];if(se[0].zoom===void 0)return[new o.V(pe,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new o.V(pe,se,"object stop key must have value")];const ye=o.M(se[0].zoom);if(typeof ye!="number")return[new o.V(pe,se[0].zoom,"stop zoom values must be numbers")];if(S&&S>ye)return[new o.V(pe,se[0].zoom,"stop zoom values must appear in ascending order")];ye!==S&&(S=ye,w=void 0,P={}),fe=fe.concat(Tr({key:`${pe}[0]`,value:se[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:ja,value:W}}))}else fe=fe.concat(W({key:`${pe}[0]`,value:se[0],style:Q.style,styleSpec:Q.styleSpec},se));return o.S(o.U(se[1]))?fe.concat([new o.V(`${pe}[1]`,se[1],"expressions are not allowed in function stops.")]):fe.concat(tr({key:`${pe}[1]`,value:se[1],valueSpec:r,style:Q.style,styleSpec:Q.styleSpec}))}function W(Q,fe){const se=o.J(Q.value),pe=o.M(Q.value),ye=Q.value!==null?Q.value:fe;if(g){if(se!==g)return[new o.V(Q.key,ye,`${se} stop domain type must match previous stop domain type ${g}`)]}else g=se;if(se!=="number"&&se!=="string"&&se!=="boolean"&&typeof pe!="number"&&typeof pe!="string"&&typeof pe!="boolean")return[new o.V(Q.key,ye,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&u!=="categorical"){let we=`number expected, ${se} found`;return o.O(r)&&u===void 0&&(we+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(Q.key,ye,we)]}return u!=="categorical"||se!=="number"||typeof pe=="number"&&isFinite(pe)&&Math.floor(pe)===pe?u!=="categorical"&&se==="number"&&typeof pe=="number"&&typeof w=="number"&&w!==void 0&&pe<w?[new o.V(Q.key,ye,"stop domain values must appear in ascending order")]:(w=pe,u==="categorical"&&pe in P?[new o.V(Q.key,ye,"stop domain values must be unique")]:(P[pe]=!0,[])):[new o.V(Q.key,ye,`integer expected, found ${String(pe)}`)]}}function Yr(m){const r=(m.expressionContext==="property"?o.W:o.X)(o.U(m.value),m.valueSpec);if(r.result==="error")return r.value.map(g=>new o.V(`${m.key}${g.key}`,m.value,g.message));const u=r.value.expression||r.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!u.outputDefined())return[new o.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!o.Y(u))return[new o.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return go(u,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!o.Z(u,["zoom","feature-state"]))return[new o.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!o._(u))return[new o.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function go(m,r){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const w of r.valueSpec.expression.parameters)u.delete(w);if(u.size===0)return[];const g=[];return m instanceof o.$&&u.has(m.name)?[new o.V(r.key,r.value,`["${m.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(m.eachChild(w=>{g.push(...go(w,r))}),g)}function _a(m){const r=m.key,u=m.value,g=m.valueSpec,w=[];return Array.isArray(g.values)?g.values.indexOf(o.M(u))===-1&&w.push(new o.V(r,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(o.M(u))===-1&&w.push(new o.V(r,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),w}function ya(m){return o.a1(o.U(m.value))?Yr(o.L({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):aa(m)}function aa(m){const r=m.value,u=m.key;if(o.J(r)!=="array")return[new o.V(u,r,`array expected, ${o.J(r)} found`)];const g=m.styleSpec;let w,S=[];if(r.length<1)return[new o.V(u,r,"filter array must have at least 1 element")];switch(S=S.concat(_a({key:`${u}[0]`,value:r[0],valueSpec:g.filter_operator,style:m.style,styleSpec:m.styleSpec})),o.M(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&o.M(r[1])==="$type"&&S.push(new o.V(u,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&S.push(new o.V(u,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(w=o.J(r[1]),w!=="string"&&S.push(new o.V(`${u}[1]`,r[1],`string expected, ${w} found`)));for(let P=2;P<r.length;P++)w=o.J(r[P]),o.M(r[1])==="$type"?S=S.concat(_a({key:`${u}[${P}]`,value:r[P],valueSpec:g.geometry_type,style:m.style,styleSpec:m.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&S.push(new o.V(`${u}[${P}]`,r[P],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let P=1;P<r.length;P++)S=S.concat(aa({key:`${u}[${P}]`,value:r[P],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":w=o.J(r[1]),r.length!==2?S.push(new o.V(u,r,`filter array for "${r[0]}" operator must have 2 elements`)):w!=="string"&&S.push(new o.V(`${u}[1]`,r[1],`string expected, ${w} found`))}return S}function qs(m,r){const u=m.key,g=m.style,w=m.layer,S=m.styleSpec,P=m.value,R=m.objectKey,N=S[`${r}_${m.layerType}`];if(!N)return[];const V=R.match(/^(.*)-use-theme$/);if(r==="paint"&&V&&N[V[1]])return o.S(P)?[].concat(tr({key:m.key,value:P,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:S,expressionContext:"property",propertyType:r,propertyKey:R})):tr({key:u,value:P,valueSpec:{type:"string"},style:g,styleSpec:S});const G=R.match(/^(.*)-transition$/);if(r==="paint"&&G&&N[G[1]]&&N[G[1]].transition)return tr({key:u,value:P,valueSpec:S.transition,style:g,styleSpec:S});const X=m.valueSpec||N[R];if(!X)return[new o.K(u,P,`unknown property "${R}"`)];let W;if(o.J(P)==="string"&&o.O(X)&&!X.tokens&&(W=/^{([^}]+)}$/.exec(P))){const fe=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new o.V(u,P,`"${R}" does not support interpolation syntax
Use an identity property function instead: ${fe}.`)]}const Q=[];if(m.layerType==="symbol")R!=="text-field"||!g||g.glyphs||g.imports||Q.push(new o.V(u,P,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&o.a2(o.U(P))&&o.M(P.type)==="identity"&&Q.push(new o.V(u,P,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&r==="paint"&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&o.O(X)&&(o.a3(X)||o.Q(X))){const fe=o.W(o.U(P),X),se=fe.value.expression||fe.value._styleExpression.expression;se&&!o.Z(se,["measure-light"])&&(R==="model-emissive-strength"&&o._(se)&&o.Y(se)||Q.push(new o.V(u,P,`${R} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Q.concat(tr({key:m.key,value:P,valueSpec:X,style:g,styleSpec:S,expressionContext:"property",propertyType:r,propertyKey:R}))}function Ho(m){return qs(m,"paint")}function Ar(m){return qs(m,"layout")}function Fa(m){let r=[];const u=m.value,g=m.key,w=m.style,S=m.styleSpec;u.type||u.ref||r.push(new o.V(g,u,'either "type" or "ref" is required'));let P=o.M(u.type);const R=o.M(u.ref);if(u.id){const N=o.M(u.id);for(let V=0;V<m.arrayIndex;V++){const G=w.layers[V];o.M(G.id)===N&&r.push(new o.V(g,u.id,`duplicate layer id "${u.id}", previously used at line ${G.id.__line__}`))}}if("ref"in u){let N;["type","source","source-layer","filter","layout"].forEach(V=>{V in u&&r.push(new o.V(g,u[V],`"${V}" is prohibited for ref layers`))}),w.layers.forEach(V=>{o.M(V.id)===R&&(N=V)}),N?N.ref?r.push(new o.V(g,u.ref,"ref cannot reference another ref layer")):P=o.M(N.type):typeof R=="string"&&r.push(new o.V(g,u.ref,`ref layer "${R}" not found`))}else if(P!=="background"&&P!=="sky"&&P!=="slot")if(u.source){const N=w.sources&&w.sources[u.source],V=N&&o.M(N.type);N?V==="vector"&&P==="raster"?r.push(new o.V(g,u.source,`layer "${u.id}" requires a raster source`)):V==="raster"&&P!=="raster"?r.push(new o.V(g,u.source,`layer "${u.id}" requires a vector source`)):V!=="vector"||u["source-layer"]?V==="raster-dem"&&P!=="hillshade"?r.push(new o.V(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):V!=="raster-array"||["raster","raster-particle"].includes(P)?P==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&V==="geojson"&&!N.lineMetrics?r.push(new o.V(g,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):P==="raster-particle"&&V!=="raster-array"&&r.push(new o.V(g,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):r.push(new o.V(g,u.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new o.V(g,u,`layer "${u.id}" must specify a "source-layer"`)):r.push(new o.V(g,u.source,`source "${u.source}" not found`))}else r.push(new o.V(g,u,'missing required property "source"'));return r=r.concat(Tr({key:g,value:u,valueSpec:S.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>tr({key:`${g}.type`,value:u.type,valueSpec:S.layer.type,style:m.style,styleSpec:m.styleSpec,object:u,objectKey:"type"}),filter:N=>ya(o.L({layerType:P},N)),layout:N=>Tr({layer:u,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":V=>Ar(o.L({layerType:P},V))}}),paint:N=>Tr({layer:u,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":V=>Ho(o.L({layerType:P,layer:u},V))}})}})),r}function Po(m){const r=m.value,u=m.key,g=o.J(r);return g!=="string"?[new o.V(u,r,`string expected, ${g} found`)]:[]}const bl={promoteId:function m({key:r,value:u}){if(o.J(u)==="string")return Po({key:r,value:u});if(Array.isArray(u)){const g=[],w=o.U(u),S=o.X(w);return S.result==="error"&&S.value.forEach(P=>{g.push(new o.V(`${r}${P.key}`,null,`${P.message}`))}),o.Z(S.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new o.V(`${r}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const w in u)g.push(...m({key:`${r}.${w}`,value:u[w]}));return g}}};function ro(m){const r=m.value,u=m.key,g=m.styleSpec,w=m.style;if(!r.type)return[new o.V(u,r,'"type" is required')];const S=o.M(r.type);let P=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&(r.url||r.tiles||P.push(new o.K(u,r,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return P=P.concat(Tr({key:u,value:r,valueSpec:g[`source_${S.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:bl})),P;case"geojson":if(P=Tr({key:u,value:r,valueSpec:g.source_geojson,style:w,styleSpec:g,objectElementValidators:bl}),r.cluster)for(const R in r.clusterProperties){const[N,V]=r.clusterProperties[R],G=typeof N=="string"?[N,["accumulated"],["get",R]]:N;P.push(...Yr({key:`${u}.${R}.map`,value:V,expressionContext:"cluster-map"})),P.push(...Yr({key:`${u}.${R}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return P;case"video":return Tr({key:u,value:r,valueSpec:g.source_video,style:w,styleSpec:g});case"image":return Tr({key:u,value:r,valueSpec:g.source_image,style:w,styleSpec:g});case"canvas":return[new o.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _a({key:`${u}.type`,value:r.type,valueSpec:{values:Ea(g)}})}}function Ea(m){return m.source.reduce((r,u)=>{const g=m[u];return g.type.type==="enum"&&(r=r.concat(Object.keys(g.type.values))),r},[])}function Ua(m){const r=m.value,u=m.styleSpec,g=u.light,w=m.style;let S=[];const P=o.J(r);if(r===void 0)return S;if(P!=="object")return S=S.concat([new o.V("light",r,`object expected, ${P} found`)]),S;for(const R in r){const N=R.match(/^(.*)-transition$/),V=R.match(/^(.*)-use-theme$/);S=S.concat(V&&g[V[1]]?tr({key:R,value:r[R],valueSpec:{type:"string"},style:w,styleSpec:u}):N&&g[N[1]]&&g[N[1]].transition?tr({key:R,value:r[R],valueSpec:u.transition,style:w,styleSpec:u}):g[R]?tr({key:R,value:r[R],valueSpec:g[R],style:w,styleSpec:u}):[new o.V(R,r[R],`unknown property "${R}"`)])}return S}function Co(m){const r=m.value;let u=[];if(!r)return u;const g=o.J(r);if(g!=="object")return u=u.concat([new o.V("light-3d",r,`object expected, ${g} found`)]),u;const w=m.styleSpec,S=w["light-3d"],P=m.key,R=m.style,N=m.style.lights;for(const X of["type","id"])if(!(X in r))return u=u.concat([new o.V("light-3d",r,`missing property ${X} on light`)]),u;if(r.type&&N)for(let X=0;X<m.arrayIndex;X++){const W=o.M(r.type),Q=N[X];o.M(Q.type)===W&&u.push(new o.V(P,r.id,`duplicate light type "${r.type}", previously defined at line ${Q.id.__line__}`))}const V=`properties_light_${r.type}`;if(!(V in w))return u=u.concat([new o.V("light-3d",r,`Invalid light type ${r.type}`)]),u;const G=w[V];for(const X in r)if(X==="properties"){const W=r[X],Q=o.J(W);if(Q!=="object")return u=u.concat([new o.V("properties",W,`object expected, ${Q} found`)]),u;for(const fe in W){const se=fe.match(/^(.*)-transition$/),pe=fe.match(/^(.*)-use-theme$/);u=u.concat(pe&&G[pe[1]]?tr({key:X,value:W[fe],valueSpec:{type:"string"},style:R,styleSpec:w}):se&&G[se[1]]&&G[se[1]].transition?tr({key:X,value:r[X],valueSpec:w.transition,style:R,styleSpec:w}):G[fe]?tr({key:fe,value:W[fe],valueSpec:G[fe],style:R,styleSpec:w}):[new o.K(m.key,W[fe],`unknown property "${fe}"`)])}}else u=u.concat(S[X]?tr({key:X,value:r[X],valueSpec:S[X],style:R,styleSpec:w}):[new o.K(X,r[X],`unknown property "${X}"`)]);return u}function ea(m){const r=m.value,u=m.key,g=m.style,w=m.styleSpec,S=w.terrain;let P=[];const R=o.J(r);if(r===void 0||R==="null")return P;if(R!=="object")return P=P.concat([new o.V("terrain",r,`object expected, ${R} found`)]),P;for(const N in r){const V=N.match(/^(.*)-transition$/),G=N.match(/^(.*)-use-theme$/);P=P.concat(G&&S[G[1]]?tr({key:N,value:r[N],valueSpec:{type:"string"},style:g,styleSpec:w}):V&&S[V[1]]&&S[V[1]].transition?tr({key:N,value:r[N],valueSpec:w.transition,style:g,styleSpec:w}):S[N]?tr({key:N,value:r[N],valueSpec:S[N],style:g,styleSpec:w}):[new o.K(N,r[N],`unknown property "${N}"`)])}if(r.source){const N=g.sources&&g.sources[r.source],V=N&&o.M(N.type);N?V!=="raster-dem"&&P.push(new o.V(u,r.source,`terrain cannot be used with a source of type ${String(V)}, it only be used with a "raster-dem" source type`)):P.push(new o.V(u,r.source,`source "${r.source}" not found`))}else P.push(new o.V(u,r,'terrain is missing required property "source"'));return P}function Aa(m){const r=m.value,u=m.style,g=m.styleSpec,w=g.fog;let S=[];const P=o.J(r);if(r===void 0)return S;if(P!=="object")return S=S.concat([new o.V("fog",r,`object expected, ${P} found`)]),S;for(const R in r){const N=R.match(/^(.*)-transition$/),V=R.match(/^(.*)-use-theme$/);S=S.concat(V&&w[V[1]]?tr({key:R,value:r[R],valueSpec:{type:"string"},style:u,styleSpec:g}):N&&w[N[1]]&&w[N[1]].transition?tr({key:R,value:r[R],valueSpec:g.transition,style:u,styleSpec:g}):w[R]?tr({key:R,value:r[R],valueSpec:w[R],style:u,styleSpec:g}):[new o.K(R,r[R],`unknown property "${R}"`)])}return S}const Go={"*":()=>[],array:kr,boolean:function(m){const r=m.value,u=m.key,g=o.J(r);return g!=="boolean"?[new o.V(u,r,`boolean expected, ${g} found`)]:[]},number:ja,color:function(m){const r=m.key,u=m.value,g=o.J(u);return g!=="string"?[new o.V(r,u,`color expected, ${g} found`)]:o.a0.parseCSSColor(u)===null?[new o.V(r,u,`color expected, "${u}" found`)]:[]},enum:_a,filter:ya,function:Xr,layer:Fa,object:Tr,source:ro,model:o.a4,light:Ua,"light-3d":Co,terrain:ea,fog:Aa,string:Po,formatted:function(m){return Po(m).length===0?[]:Yr(m)},resolvedImage:function(m){return Po(m).length===0?[]:Yr(m)},projection:function(m){const r=m.value,u=m.styleSpec,g=u.projection,w=m.style;let S=[];const P=o.J(r);if(P==="object")for(const R in r)S=S.concat(tr({key:R,value:r[R],valueSpec:g[R],style:w,styleSpec:u}));else P!=="string"&&(S=S.concat([new o.V("projection",r,`object or string expected, ${P} found`)]));return S},import:function(m){const{value:r,styleSpec:u}=m,{data:g,...w}=r;Object.defineProperty(w,"__line__",{value:r.__line__,enumerable:!1});let S=Tr(o.L({},m,{value:w,valueSpec:u.import}));return o.M(w.id)===""&&S.push(new o.V(`${m.key}.id`,w,"import id can't be an empty string")),g&&(S=S.concat(Is(g,u,{key:`${m.key}.data`}))),S},iconset:function(m){const r=m.value,u=m.key,g=m.styleSpec,w=m.style;if(!r.type)return[new o.V(u,r,'"type" is required')];const S=o.M(r.type);let P=[];if(P=P.concat(Tr({key:u,value:r,valueSpec:g[`iconset_${S}`],style:w,styleSpec:g})),S==="source"&&r.source){const R=w.sources&&w.sources[r.source],N=R&&o.M(R.type);R?N!=="raster-array"&&P.push(new o.V(u,r.source,`iconset cannot be used with a source of type ${String(N)}, it only be used with a "raster-array" source type`)):P.push(new o.V(u,r.source,`source "${r.source}" not found`))}return P}};function tr(m,r=!1){const u=m.value,g=m.valueSpec,w=m.styleSpec;if(g.expression&&o.a2(o.M(u)))return Xr(m);if(g.expression&&o.S(o.U(u)))return Yr(m);if(g.type&&Go[g.type]){const S=Go[g.type](m);return r===!0&&S.length>0&&o.J(m.value)==="array"?Yr(m):S}return Tr(o.L({},m,{valueSpec:g.type?w[g.type]:g}))}function Pa(m){const r=m.value,u=m.key,g=Po(m);return g.length||(r.indexOf("{fontstack}")===-1&&g.push(new o.V(u,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&g.push(new o.V(u,r,'"glyphs" url must include a "{range}" token'))),g}function Is(m,r=o.a5,u={}){return tr({key:u.key||"",value:m,valueSpec:r.$root,styleSpec:r,style:m,objectElementValidators:{glyphs:Pa,"*":()=>[]}})}function ta(m,r=o.a5){return Ne(Is(m,r))}const al=m=>Ne(ro(m)),ls=m=>Ne(Ua(m)),Ca=m=>Ne(Co(m)),hn=m=>Ne(ea(m)),vs=m=>Ne(Aa(m)),Ja=m=>Ne(function(r){const u=r.value,g=r.style,w=r.styleSpec,S=w.snow;let P=[];const R=o.J(u);if(u===void 0)return P;if(R!=="object")return P=P.concat([new o.V("snow",u,`object expected, ${R} found`)]),P;for(const N in u){const V=N.match(/^(.*)-transition$/);P=P.concat(V&&S[V[1]]&&S[V[1]].transition?tr({key:N,value:u[N],valueSpec:w.transition,style:g,styleSpec:w}):S[N]?tr({key:N,value:u[N],valueSpec:S[N],style:g,styleSpec:w}):[new o.K(N,u[N],`unknown property "${N}"`)])}return P}(m)),bt=m=>Ne(function(r){const u=r.value,g=r.style,w=r.styleSpec,S=w.rain;let P=[];const R=o.J(u);if(u===void 0)return P;if(R!=="object")return P=P.concat([new o.V("rain",u,`object expected, ${R} found`)]),P;for(const N in u){const V=N.match(/^(.*)-transition$/);P=P.concat(V&&S[V[1]]&&S[V[1]].transition?tr({key:N,value:u[N],valueSpec:w.transition,style:g,styleSpec:w}):S[N]?tr({key:N,value:u[N],valueSpec:S[N],style:g,styleSpec:w}):[new o.K(N,u[N],`unknown property "${N}"`)])}return P}(m)),Tt=m=>Ne(Fa(m)),je=m=>Ne(ya(m)),ae=m=>Ne(Ho(m)),ge=m=>Ne(Ar(m)),Ee=m=>Ne(o.a4(m));function Ne(m){return m.slice().sort((r,u)=>r.line&&u.line?r.line-u.line:0)}function be(m,r){let u=!1;if(r&&r.length)for(const g of r)g instanceof o.K?o.w(g.message):(m.fire(new o.z(new Error(g.message))),u=!0);return u}let We;class nt extends o.E{constructor(r,u="flat"){super(),this._transitionable=new o.a6(We||(We=new o.a7({anchor:new o.a8(o.a5.light.anchor),position:new o.a9(o.a5.light.position),color:new o.a8(o.a5.light.color),intensity:new o.a8(o.a5.light.intensity)}))),this.setLight(r,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u,g={}){this._validate(ls,r,g)||(this._transitionable.setTransitionOrValue(r),this.id=u)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,g){return(!g||g.validate!==!1)&&be(this,r.call(ta,o.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.a5})))}}let Xe=class extends o.E{constructor(m,r,u,g,w){super(),this.scope=u,this._transitionable=new o.a6(new o.a7({source:new o.a8(o.a5.terrain.source),exaggeration:new o.a8(o.a5.terrain.exaggeration)}),u,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r,this.worldview=w}get(){return this._transitionable.serialize()}set(m,r){this._transitionable.setTransitionOrValue(m,r)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new o.aa(m,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const m=this._transitionable._values.exaggeration;if(!m)return null;const r=m.value.expression;if(!r)return null;let u=-1,g=-1,w=1;for(const S of r.zoomStops)w=r.evaluate(new o.aa(S,{worldview:this.worldview})),w>.01?(u=S,g=-1):g=S;return w<.01&&u>0&&g>u?[u,g]:null}isZoomDependent(){const m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof o.ab}};const lt=45,gt=65,ht=.05;function Zt(m,r,u,g){const w=o.af(lt,gt,u),[S,P]=vn(m,g);let R=1-Math.min(1,Math.exp((r-S)/(P-S)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*w*m.alpha}function vn(m,r){const u=.5/Math.tan(.5*r);return[m.range[0]+u,m.range[1]+u]}function _n(m,r,u,g,w){const S=o.ad([],[r,u,g],w.mercatorFogMatrix);return Zt(m,o.ae(S),w.pitch,w._fov)}function zn(m,r,u,g,w,S,P){const R=[[u,g,0],[w,g,0],[w,S,0],[u,S,0]];let N=Number.MAX_VALUE,V=-Number.MAX_VALUE;for(const G of R){const X=o.ad([],G,r),W=o.ae(X);N=Math.min(N,W),V=Math.max(V,W)}return[Zt(m,N,P.pitch,P._fov),Zt(m,V,P.pitch,P._fov)]}class ii extends o.E{constructor(r,u,g,w){super();const S=new o.a7({range:new o.a8(o.a5.fog.range),color:new o.a8(o.a5.fog.color),"color-use-theme":new o.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new o.a8(o.a5.fog["high-color"]),"high-color-use-theme":new o.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new o.a8(o.a5.fog["space-color"]),"space-color-use-theme":new o.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new o.a8(o.a5.fog["horizon-blend"]),"star-intensity":new o.a8(o.a5.fog["star-intensity"]),"vertical-range":new o.a8(o.a5.fog["vertical-range"])});this._transitionable=new o.a6(S,g,new Map(w)),this.set(r,w),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new o.ag(S),this.scope=g}get state(){const r=this._transform,u=r.projection.name==="globe",g=o.ah(r.zoom),w=this.properties.get("range"),S=[.5,3];return{range:u?[o.ai(S[0],w[0],g),o.ai(S[1],w[1],g)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,u,g={}){if(this._validate(vs,r,g))return;const w=o.h({},r);for(const S of Object.keys(o.a5.fog))w[S]===void 0&&(w[S]=o.a5.fog[S].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.af(lt,gt,r))*u.a}getOpacityAtLatLng(r,u){return this._transform.projection.supportsFog?function(g,w,S){const P=o.ac.fromLngLat(w),R=S.elevation?S.elevation.getAtPointOrZero(P):0;return _n(g,P.x,P.y,R,S)}(this.state,r,u):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(r.toUnwrapped());return zn(this.state,u,0,0,o.aj,o.aj,this._transform)}getOpacityForBounds(r,u,g,w,S){return this._transform.projection.supportsFog?zn(this.state,r,u,g,w,S,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?vn(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const g of u){const w=r.points[g];let S;if(w[2]>=0)S=w;else{const P=r.points[g-4];S=o.ak(P,w,P[2]/(P[2]-w[2]))}if(_n(this.state,S[0],S[1],0,this._transform)>=ht)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,g){return(!g||g.validate!==!1)&&be(this,r.call(ta,o.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.a5})))}}let si,gi,ui,Wi,_r=class extends o.E{constructor(m,r,u,g){super();const w=si||(si=new o.a7({density:new o.a8(o.a5.snow.density),intensity:new o.a8(o.a5.snow.intensity),color:new o.a8(o.a5.snow.color),opacity:new o.a8(o.a5.snow.opacity),vignette:new o.a8(o.a5.snow.vignette),"vignette-color":new o.a8(o.a5.snow["vignette-color"]),"center-thinning":new o.a8(o.a5.snow["center-thinning"]),direction:new o.a8(o.a5.snow.direction),"flake-size":new o.a8(o.a5.snow["flake-size"])}));this._transitionable=new o.a6(w,u,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new o.ag(w),this.scope=u}get state(){const m=this.properties.get("opacity"),r=this.properties.get("color"),u=this.properties.get("direction"),g=o.al(u[0]),w=-Math.max(o.al(u[1]),.01),S=[Math.cos(g)*Math.cos(w),Math.sin(g)*Math.cos(w),Math.sin(w)],P=this.properties.get("vignette"),R=this.properties.get("vignette-color");return R.a=P,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new o.am(r.r,r.g,r.b,r.a*m),direction:S,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:R}}get(){return this._transitionable.serialize()}set(m,r,u={}){if(this._validate(Ja,m,u))return;const g=o.h({},m);for(const w of Object.keys(o.a5.snow))g[w]===void 0&&(g[w]=o.a5.snow[w].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,r,u){return(!u||u.validate!==!1)&&be(this,m.call(ta,o.h({value:r,style:{glyphs:!0,sprite:!0},styleSpec:o.a5})))}},ir=class extends o.E{constructor(m,r,u,g){super();const w=gi||(gi=new o.a7({density:new o.a8(o.a5.rain.density),intensity:new o.a8(o.a5.rain.intensity),color:new o.a8(o.a5.rain.color),opacity:new o.a8(o.a5.rain.opacity),vignette:new o.a8(o.a5.rain.vignette),"vignette-color":new o.a8(o.a5.rain["vignette-color"]),"center-thinning":new o.a8(o.a5.rain["center-thinning"]),direction:new o.a8(o.a5.rain.direction),"droplet-size":new o.a8(o.a5.rain["droplet-size"]),"distortion-strength":new o.a8(o.a5.rain["distortion-strength"])}));this._transitionable=new o.a6(w,u,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new o.ag(w),this.scope=u}get state(){const m=this.properties.get("opacity"),r=this.properties.get("color"),u=this.properties.get("direction"),g=o.al(u[0]),w=-Math.max(o.al(u[1]),.01),S=[Math.cos(g)*Math.cos(w),Math.sin(g)*Math.cos(w),Math.sin(w)],P=this.properties.get("vignette-color");return P.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new o.am(r.r,r.g,r.b,r.a*m),direction:S,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:P}}get(){return this._transitionable.serialize()}set(m,r,u={}){if(this._validate(bt,m,u))return;const g=o.h({},m);for(const w of Object.keys(o.a5.rain))g[w]===void 0&&(g[w]=o.a5.rain[w].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,r,u){return(!u||u.validate!==!1)&&be(this,m.call(ta,o.h({value:r,style:{glyphs:!0,sprite:!0},styleSpec:o.a5})))}};class ki extends o.E{constructor(r,u,g,w){super(),this.scope=g,this._options=r,this.properties=new o.ag(u),this._transitionable=new o.a6(u,g,new Map(w)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,u){this._options=r,this._transitionable.setTransitionOrValue(r.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Fi{constructor(r,u,g,w){this.screenBounds=r,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(r,u){let g,w;if(r instanceof o.P||typeof r[0]=="number"){const S=o.P.convert(r);g=[S],w=u.isPointAboveHorizon(S)}else{const S=o.P.convert(r[0]),P=o.P.convert(r[1]),R=S.add(P)._div(2);g=[S,P],w=o.ao(S,P).every(N=>u.isPointAboveHorizon(N))&&u.isPointAboveHorizon(R)}return new Fi(g,u.getCameraPoint(),w,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],w=o.ao(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?w[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(w[3]=this.cameraPoint)),o.ap(w,r)}bufferedCameraGeometryGlobe(r){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],w=o.ao(u,g,r),S=this.cameraPoint.clone();switch(3*((S.y>u.y)+(S.y>g.y))+((S.x>u.x)+(S.x>g.x))){case 0:w[0]=S,w[4]=S.clone();break;case 1:w.splice(1,0,S);break;case 2:w[1]=S;break;case 3:w.splice(4,0,S);break;case 5:w.splice(2,0,S);break;case 6:w[3]=S;break;case 7:w.splice(3,0,S);break;case 8:w[2]=S}return w}containsTile(r,u,g,w=0){const S=r.queryPadding/u._pixelsPerMercatorPixel+1,P=g?this._bufferedCameraMercator(S,u):this._bufferedScreenMercator(S,u);let R=r.tileID.wrap+(P.unwrapped?w:0);const N=P.polygon.map(pe=>o.aq(r.tileTransform,pe,R));if(!o.ar(N,0,0,o.aj,o.aj))return;R=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const V=this.screenGeometryMercator.polygon.map(pe=>o.as(r.tileTransform,pe,R)),G=V.map(pe=>new o.P(pe[0],pe[1])),X=u.getFreeCameraOptions().position||new o.ac(0,0,0),W=o.as(r.tileTransform,X,R),Q=V.map(pe=>{const ye=o.at(pe,pe,W);return o.au(ye,ye),new o.av(W,ye)}),fe=o.aw(r,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:G,tilespaceRays:Q,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(se=o.ax(N),se.min.x=o.ay(se.min.x,0,o.aj),se.min.y=o.ay(se.min.y,0,o.aj),se.max.x=o.ay(se.max.x,0,o.aj),se.max.y=o.ay(se.max.y,0,o.aj),se),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:fe};var se}_bufferedScreenMercator(r,u){const g=rr(r);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let w;return w=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),u):{polygon:this.bufferedScreenGeometry(r).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[g]=w,w}}_bufferedCameraMercator(r,u){const g=rr(r);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let w;return w=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),u):{polygon:this.bufferedCameraGeometry(r).map(S=>u.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[g]=w,w}}_projectAndResample(r,u){const g=function(S,P){const R=o.az([],P.pixelMatrix,P.globeMatrix),N=[0,-o.aB,0,1],V=[0,o.aB,0,1],G=[0,0,0,1];o.aA(N,N,R),o.aA(V,V,R),o.aA(G,G,R);const X=new o.P(N[0]/N[3],N[1]/N[3]),W=new o.P(V[0]/V[3],V[1]/V[3]),Q=o.aC(S,X)&&N[3]<G[3],fe=o.aC(S,W)&&V[3]<G[3];if(!Q&&!fe)return null;const se=function(Fe,ke,qe){for(let Ke=1;Ke<Fe.length;Ke++){const pt=nr(ke.pointCoordinate3D(Fe[Ke-1]).x),mt=nr(ke.pointCoordinate3D(Fe[Ke]).x);if(qe<0){if(pt<mt)return{idx:Ke,t:-pt/(mt-1-pt)}}else if(mt<pt)return{idx:Ke,t:(1-pt)/(mt+1-pt)}}return null}(S,P,Q?-1:1);if(!se)return null;const{idx:pe,t:ye}=se;let we=pe>1?vi(S.slice(0,pe),P):[],De=pe<S.length?vi(S.slice(pe),P):[];we=we.map(Fe=>new o.P(nr(Fe.x),Fe.y)),De=De.map(Fe=>new o.P(nr(Fe.x),Fe.y));const Le=[...we];Le.length===0&&Le.push(De[De.length-1]);const Ze=o.ai(Le[Le.length-1].y,(De.length===0?we[0]:De[0]).y,ye);let Ue;return Ue=Q?[new o.P(0,Ze),new o.P(0,0),new o.P(1,0),new o.P(1,Ze)]:[new o.P(1,Ze),new o.P(1,1),new o.P(0,1),new o.P(0,Ze)],Le.push(...Ue),De.length===0?Le.push(we[0]):Le.push(...De),{polygon:Le.map(Fe=>new o.ac(Fe.x,Fe.y)),unwrapped:!1}}(r,u);if(g)return g;const w=function(S,P){let R=!1,N=-1/0,V=0;for(let X=0;X<S.length-1;X++)S[X].x>N&&(N=S[X].x,V=X);for(let X=0;X<S.length-1;X++){const W=(V+X)%(S.length-1),Q=S[W],fe=S[W+1];Math.abs(Q.x-fe.x)>.5&&(Q.x<fe.x?(Q.x+=1,W===0&&(S[S.length-1].x+=1)):(fe.x+=1,W+1===S.length-1&&(S[0].x+=1)),R=!0)}const G=o.aD(P.center.lng);return R&&G<Math.abs(G-1)&&S.forEach(X=>{X.x-=1}),{polygon:S,unwrapped:R}}(vi(r,u).map(S=>new o.P(nr(S.x),S.y)),u);return{polygon:w.polygon.map(S=>new o.ac(S.x,S.y)),unwrapped:w.unwrapped}}}function vi(m,r){return o.aE(m,u=>{const g=r.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function nr(m){return m<0?1+m%1:m%1}function rr(m){return 100*m|0}function Nr(m,r,u,g,w){const S=function(R,N){if(R)return w(R);if(N){if(m.url&&N.tiles&&m.tiles&&delete m.tiles,N.variants){if(!Array.isArray(N.variants))return w(new Error("variants must be an array"));for(const G of N.variants){if(G==null||typeof G!="object"||G.constructor!==Object)return w(new Error("variant must be an object"));if(!Array.isArray(G.capabilities))return w(new Error("capabilities must be an array"));if(G.capabilities.length===1&&G.capabilities[0]==="meshopt"){N=o.h(N,G);break}}}const V=o.aF(o.h({},N,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);V.tiles=r.canonicalizeTileset(V,m.url),w(null,V)}},P=function(R,N,V){if(!R)return null;if(!N&&!V)return R;V=V||R.worldview_default;const G=Object.values(R.language||{});if(G.length===0)return null;const X=Object.values(R.worldview||{});if(X.length===0)return null;const W=G.every(fe=>fe===N),Q=X.every(fe=>fe===V);return W&&Q?R:N in(R.language_options||{})||V in(R.worldview_options||{})?null:R.language_options&&R.worldview_options?R:null}(m.data,u,g);return P?o.q.frame(()=>S(null,P)):m.url?o.n(r.transformRequest(r.normalizeSourceURL(m.url,null,u,g),o.R.Source),S):o.q.frame(()=>{const{data:R,...N}=m;S(null,N)})}function Zo(m,r){const u=Math.pow(2,r.z),g=Math.floor(o.aD(m.getWest())*u),w=Math.floor(o.aH(m.getNorth())*u),S=Math.ceil(o.aD(m.getEast())*u),P=Math.ceil(o.aH(m.getSouth())*u);return r.x>=g&&r.x<S&&r.y>=w&&r.y<P}class hr{constructor(r,u,g){this.bounds=r?o.aG.convert(this.validateBounds(r)):null,this.minzoom=u||0,this.maxzoom=g||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}addExtraBounds(r){if(r){this.extraBounds||(this.extraBounds=[]);for(const u of r)this.extraBounds.push(o.aG.convert(this.validateBounds(u)))}}contains(r){if(r.z>this.maxzoom||r.z<this.minzoom||this.bounds&&!Zo(this.bounds,r))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(Zo(u,r))return!0;return!1}static fromTileJSON(r){if(!r.bounds&&!r.extra_bounds)return null;const u=new hr(r.bounds,r.minzoom,r.maxzoom);return u.addExtraBounds(r.extra_bounds),u}}class Xi extends o.E{constructor(r,u,g,w){if(super(),this.id=r,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.h(this,o.aF(u,["url","scheme","tileSize","promoteId"])),this._options=o.h({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new o.aI}load(r){this._loaded=!1,this.fire(new o.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Nr(this._options,this.map._requestManager,u,g,(w,S)=>{if(this._tileJSONRequest=null,this._loaded=!0,w)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new o.z(w));else if(S){if(o.h(this,S),this.hasWorldviews=!!S.worldview_options,S.worldview_default&&(this.worldviewDefault=S.worldview_default),S.vector_layers){this.vectorLayers=S.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const P of S.vector_layers)this.vectorLayerIds.push(P.id),S.worldview&&S.worldview[P.source]&&this.localizableLayerIds.add(P.id)}this.tileBounds=hr.fromTileJSON(S),$t(S.tiles,this.map._requestManager._customAccessToken),this.fire(new o.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.A("data",{dataType:"source",sourceDataType:"content"}))}r&&r(w)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.h({},this._options)}loadTile(r,u){const g=r.tileID.canonical.url(this.tiles,this.scheme),w=this.map._requestManager.normalizeTileURL(g),S=this.map._requestManager.transformRequest(w,o.R.Tile),P=this.map.style?this.map.style.getLut(this.scope):null,R=P?{image:P.image.clone()}:null,N={request:S,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:R,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&o.j(g)&&(N.localizableLayerIds=this.localizableLayerIds),N.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=u:r.request=r.actor.send("reloadTile",N,V.bind(this));else if(r.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",N,V.bind(this),void 0,!0);else{const G=o.aJ.call({deduped:this._deduped},N,(X,W)=>{X||!W?V.call(this,X):(N.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},r.actor&&r.actor.send("loadTile",N,V.bind(this),void 0,!0))},!0);r.request={cancel:G}}function V(G,X){return delete r.request,r.aborted?u(null):G&&G.status!==404?u(G):(X&&X.resourceTiming&&(r.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&r.setExpiryData(X),r.loadVectorData(X,this.map.painter),o.aK(this.dispatcher),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,u){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class or extends o.E{constructor(r,u,g,w){super(),this.id=r,this.dispatcher=g,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.h({type:"raster"},u),o.h(this,o.aF(u,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.A("dataloading",{dataType:"source"}));const u=this.map.getWorldview();this._tileJSONRequest=Nr(this._options,this.map._requestManager,null,u,(g,w)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new o.z(g)):w&&(o.h(this,w),w.raster_layers&&(this.rasterLayers=w.raster_layers,this.rasterLayerIds=this.rasterLayers.map(S=>S.id)),this.tileBounds=hr.fromTileJSON(w),$t(w.tiles),this.fire(new o.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.A("data",{dataType:"source",sourceDataType:"content"}))),r&&r(g)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.h({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const g=o.q.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);r.request=o.o(this.map._requestManager.transformRequest(w,o.R.Tile),(S,P,R,N)=>(delete r.request,r.aborted?(r.state="unloaded",u(null)):S?(r.state="errored",u(S)):P?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:R,expires:N}),r.setTexture(P,this.map.painter),r.state="loaded",o.aK(this.dispatcher),void u(null)):u(null)))}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u&&u()}unloadTile(r,u){r.texture&&r.texture instanceof o.T?(r.destroy(!0),r.texture&&r.texture instanceof o.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Lo extends or{constructor(r,u,g,w){super(r,u,g,w),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=o.h({type:"raster-array"},u)}triggerRepaint(r){const u=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);u&&u.enabled&&g&&u._clearRenderCacheForTile(g.id,r.tileID),this.map.triggerRepaint()}loadTile(r,u){const g=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(g,o.R.Tile),S={request:w,uid:r.uid,tileID:r.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};r.source=this.id,r.scope=this.scope,r.requestParams=w,r.actor||(r.actor=this.dispatcher.getActor());const P=(R,N,V,G)=>{if(delete r.request,r.aborted)return r.state="unloaded",u(null);if(R)return R.name==="AbortError"?void 0:(r.state="errored",u(R));if(this.map._refreshExpiredTiles&&N&&r.setExpiryData({cacheControl:V,expires:G}),this.partial)r.state="empty";else{if(!N)return u(null);r.state="loaded",r._isHeaderLoaded=!0,r._mrt=N}u(null)};r.request=this.partial?r.fetchHeader(void 0,P.bind(this)):r.actor.send("loadTile",S,P.bind(this),void 0,!0)}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,u){const g=r.texture;g&&g instanceof o.T?(r.destroy(!0),this.map.painter.saveTileTexture(g)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,u,g){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(u,g,(w,S)=>{if(w)return r.state="errored",this.fire(new o.z(w)),void this.triggerRepaint(r);S&&(r._isHeaderLoaded=!0,r.setTexture(S,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:S})=>S===r),g=u&&u.fields,w=g&&g.bands&&g.bands;return w?w[0]:0}getTextureDescriptor(r,u,g){if(!r)return;const w=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let S=null;u instanceof o.aN?S=u.paint.get("raster-array-band"):u instanceof o.aO&&(S=u.paint.get("raster-particle-array-band"));const P=S||this.getInitialBand(w);if(P!=null)if(r.textureDescriptor){if(!r.updateNeeded(w,P)||g)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,w,P)}getImages(r,u){const g=new Map;for(const w of r)for(const S of u){const[P,R]=S.split("/"),N=w.getLayer(P);if(!N||!N.hasBand(R)||!N.hasDataForBand(R))continue;const{bytes:V,tileSize:G,buffer:X}=N.getBandView(R),W=G+2*X,Q={data:new o.r({width:W,height:W},V),pixelRatio:2,sdf:!1,usvg:!1,version:0};g.set(S,Q)}return g}}const Hs={vector:Xi,raster:or,"raster-dem":class extends or{constructor(m,r,u,g){super(m,r,u,g),this.type="raster-dem",this.maxzoom=22,this._options=o.h({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(m,r){const u=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(w,S){w&&(m.state="errored",r(w)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",r(null))}m.request=o.o(this.map._requestManager.transformRequest(u,o.R.Tile),(function(w,S,P,R){if(delete m.request,m.aborted)m.state="unloaded",r(null);else if(w)m.state="errored",r(w);else if(S){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:P,expires:R});const N=ImageBitmap&&S instanceof ImageBitmap&&o.t(),V=1-(S.width-o.aL(S.width))/2;V<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const G=N?S:o.q.getImageData(S,V),X={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:G,encoding:this.encoding,padding:V};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",X,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const r=m.canonical,u=Math.pow(2,r.z),g=(r.x-1+u)%u,w=r.x===0?m.wrap-1:m.wrap,S=(r.x+1+u)%u,P=r.x+1===u?m.wrap+1:m.wrap,R={};return R[new o.aM(m.overscaledZ,w,r.z,g,r.y).key]={backfilled:!1},R[new o.aM(m.overscaledZ,P,r.z,S,r.y).key]={backfilled:!1},r.y>0&&(R[new o.aM(m.overscaledZ,w,r.z,g,r.y-1).key]={backfilled:!1},R[new o.aM(m.overscaledZ,m.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},R[new o.aM(m.overscaledZ,P,r.z,S,r.y-1).key]={backfilled:!1}),r.y+1<u&&(R[new o.aM(m.overscaledZ,w,r.z,g,r.y+1).key]={backfilled:!1},R[new o.aM(m.overscaledZ,m.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},R[new o.aM(m.overscaledZ,P,r.z,S,r.y+1).key]={backfilled:!1}),R}},"raster-array":Lo,geojson:class extends o.E{constructor(m,r,u,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=r.data,this._options=o.h({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const w=o.aj/this.tileSize;this.workerOptions=o.h({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*w,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*w,extent:o.aj,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.aj,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*w,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new o.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new o.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const u of this._data.features)r.set(u.id,u);for(const u of m.features)r.set(u.id,u);this._data.features=[...r.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},r),this}getClusterChildren(m,r){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},r),this}getClusterLeaves(m,r,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:r,offset:u},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.A("dataloading",{dataType:"source"})),this._loaded=!1;const r=o.h({append:m},this.workerOptions);r.scope=this.scope;const u=this._data;typeof u=="string"?(r.request=this.map._requestManager.transformRequest(o.q.resolveURL(u),o.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(g,w)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new o.z(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(S.resourceTiming=w.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new o.A("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const m=o.C(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,r){const u=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,w=g?{image:g.image.clone()}:null,S=this._partialReload,P={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:m.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:S,worldview:this.map.getWorldview()};m.request=this.actor.send(u,P,(R,N)=>S&&!N?(m.state="loaded",r(null)):(delete m.request,m.destroy(),m.aborted?r(null):R?r(R):(m.loadVectorData(N,this.map.painter,u==="reloadTile"),r(null))),void 0,u==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,r){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aP{constructor(m,r,u,g){super(m,r,u,g),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const r of m.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.R.Source).url);o.aQ(this.urls,(r,u)=>{this._loaded=!0,r?this.fire(new o.z(r)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const r=this.video.seekable;m<r.start(0)||m>r.end(0)?this.fire(new o.z(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,r=m.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(m,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aP,model:class extends o.E{constructor(m,r,u,g){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const m=[];for(const r in this._options.models){const u=this._options.models[r],g=o.aS(this.map._requestManager.transformRequest(u.uri,o.R.Model).url).then(w=>{if(!w)return;const S=o.aT(w),P=new o.aU(r,u.position,u.orientation,S);P.computeBoundsAndApplyParent(),this.models.push(P)}).catch(w=>{this.fire(new o.z(new Error(`Could not load model ${r} from ${u.uri}: ${w.message}`)))});m.push(g)}Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new o.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this._loaded=!0,this.fire(new o.z(new Error(`Could not load models: ${r.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,r){}serialize(){return this._options}},"batched-model":class extends o.E{constructor(m,r,u,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();const m=o.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(m))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new o.A("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Nr(this._options,this.map._requestManager,r,u,(g,w)=>{this._tileJSONRequest=null,this._loaded=!0,g?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new o.z(g))):w&&(o.h(this,w),w.bounds&&(this.tileBounds=new hr(w.bounds,this.minzoom,this.maxzoom)),$t(w.tiles,this.map._requestManager._customAccessToken),this.fire(new o.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.A("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,r){const u=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,o.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:o.q.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=r;else{if(m.buckets){const S=Object.values(m.buckets);for(const P of S)P.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,w.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,w.bind(this),void 0,!0);function w(S,P){return m.aborted?r(null):S&&S.status!==404?r(S):(this.map._refreshExpiredTiles&&P&&m.setExpiryData(P),m.loadModelData(P,this.map.painter),m.state="loaded",void r(null))}}serialize(){return o.h({},this._options)}},canvas:class extends o.aP{constructor(m,r,u,g){super(m,r,u,g),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(S=>typeof S!="number"))||this.fire(new o.z(new o.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.z(new o.V(`sources.${m}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.z(new o.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.z(new o.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.z(new o.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof o.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends o.E{constructor(m,r,u,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=r,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new hr(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.h(this,o.aF(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new o.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:r,y:u,z:g}=m.canonical;return this._implementation.hasTile({x:r,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,r){const{x:u,y:g,z:w}=m.tileID.canonical,S=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:w},{signal:S.signal})).then((function(P){return delete m.request,m.aborted?(m.state="unloaded",r(null)):P===void 0?(m.state="errored",r(null)):P===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",r(null)):function(R){return R instanceof ImageData||R instanceof HTMLCanvasElement||R instanceof ImageBitmap||R instanceof HTMLImageElement}(P)?(this.loadTileData(m,P),m.state="loaded",void r(null)):(m.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(P=>{P.name!=="AbortError"&&(m.state="errored",r(P))}),m.request.cancel=()=>S.abort()}loadTileData(m,r){m.setTexture(r,this.map.painter)}unloadTile(m,r){if(m.texture&&m.texture instanceof o.T?(m.destroy(!0),m.texture&&m.texture instanceof o.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:u,y:g,z:w}=m.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:w})}r&&r()}abortTile(m,r){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){const m=o.C(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new o.A("data",{dataType:"source",sourceDataType:"content"}))}}},Ds=function(m,r,u,g){const w=new Hs[r.type](m,r,u,g);if(w.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${w.id}`);return o.aV(["load","abort","unload","serialize","prepare"],w),w};function sl(m,r,u=""){return`${u}:${r.id||""}:${r.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:w,importId:S}=g;return`featureset:${w}${S?`:import:${S}`:""}`}}(m.target)}`}function cr(m,r,u,g=""){if(m.uniqueFeatureID){const w=sl(m,r,g);if(u.has(w))return!0;u.add(w)}return!1}function Kr(m,r,u,g,w=!1){const S=r.sourceCache.transform,P=r.sourceCache.tilesIn(m,r.has3DLayers,w);P.sort(Bo);const R=[];for(const N of P){const V=N.tile.queryRenderedFeatures(r,N,u,g,S,w);Object.keys(V).length&&R.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:V})}return R.length===0?{}:function(N){const V={},G={};for(const X of N){const W=X.queryResults,Q=X.wrappedTileID,fe=G[Q]=G[Q]||{};for(const se in W){const pe=W[se],ye=fe[se]=fe[se]||{},we=V[se]=V[se]||[];for(const De of pe)ye[De.featureIndex]||(ye[De.featureIndex]=!0,we.push(De))}}return V}(R)}function ll(m,r,u,g,w,S){const P={},R=g.queryRenderedSymbols(m),N=[];for(const V of Object.keys(R).map(Number))N.push(w[V]);N.sort(Bo);for(const V of N){const G=V.featureIndex.lookupSymbolFeatures(R[V.bucketInstanceId],V.bucketIndex,V.sourceLayerIndex,r,u,S);for(const X in G){const W=P[X]=P[X]||[],Q=G[X];Q.sort((fe,se)=>{const pe=V.featureSortOrder;if(pe){const ye=pe.indexOf(fe.featureIndex);return pe.indexOf(se.featureIndex)-ye}return se.featureIndex-fe.featureIndex});for(const fe of Q)W.push(fe)}}return P}function So(m,r){const u=m.getRenderableIds().map(S=>m.getTileByID(S)),g=[],w={};for(let S=0;S<u.length;S++){const P=u[S],R=P.tileID.canonical.key;w[R]||(w[R]=!0,P.querySourceFeatures(g,r))}return g}function Bo(m,r){const u=m.tileID,g=r.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function xs(m,r){const u={};if(!r)return u;for(const g of m){const w=g.layerIds.map(S=>r.getLayer(S)).filter(Boolean);if(w.length!==0){g.layers=w,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(S=>w.filter(P=>P.id===S)[0]));for(const S of w)u[S.fqid]=g}}return u}const va=32,jo=33,uo=new Uint16Array(8184);for(let m=0;m<2046;m++){let r=m+2,u=0,g=0,w=0,S=0,P=0,R=0;for(1&r?w=S=P=va:u=g=R=va;(r>>=1)>1;){const V=u+w>>1,G=g+S>>1;1&r?(w=u,S=g,u=P,g=R):(u=w,g=S,w=P,S=R),P=V,R=G}const N=4*m;uo[N+0]=u,uo[N+1]=g,uo[N+2]=w,uo[N+3]=S}const ha=new Uint16Array(2178),da=new Uint8Array(1089),wl=new Uint16Array(1089);function bs(m){return m===0?-.03125:m===32?.03125:0}const Gs={type:2,extent:o.aj,loadGeometry:()=>[[new o.P(0,0),new o.P(o.aj+1,0),new o.P(o.aj+1,o.aj+1),new o.P(0,o.aj+1),new o.P(0,0)]]};class cs{constructor(r,u,g,w,S,P){this.tileID=r,this.uid=o.a$(),this.uses=0,this.tileSize=u,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,w&&w.style&&(this._lastUpdatedBrightness=w.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",w&&w.transform&&(this.projection=w.transform.projection),this.worldview=P}registerFadeDuration(r){const u=r+this.timeAdded;u<o.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,u,g){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=xs(r.buckets,u.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const S=this.buckets[w];if(S instanceof o.b1){if(this.hasSymbolBuckets=!0,!g)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const S=this.buckets[w];if(S instanceof o.b1&&S.hasRTLText){this.hasRTLText=!0,o.b2();break}}this.queryPadding=0;for(const w in this.buckets){const S=this.buckets[w],P=u.style.getOwnLayer(w);if(!P)continue;const R=P.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,R)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new o.b0}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,u,g){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets=Object.assign({},this.buckets,xs(r.buckets,u.style)),r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const w in this.buckets){const S=this.buckets[w];S.uploadPending()&&S.upload(r)}const u=r.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new o.T(r,g.image,u.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(r,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(r,u,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,g),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const w=u.style.getBrightness();(this._lastUpdatedBrightness||w)&&(this._lastUpdatedBrightness&&w&&Math.abs(this._lastUpdatedBrightness-w)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==w),this._lastUpdatedBrightness=w))}queryRenderedFeatures(r,u,g,w,S,P){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const R=function(N,V){const G=o.bn([],[.5*N.width,.5*-N.height,1]);return o.bo(G,G,[1,-1,0]),o.az(G,G,N.calculateProjMatrix(V.toUnwrapped())),Float32Array.from(G)}(S,this.tileID);return this.latestFeatureIndex.query(r,{tilespaceGeometry:u,pixelPosMatrix:R,transform:w,availableImages:g,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(r,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const w=g.loadVTLayers(),S=u?u.sourceLayer:"",P=w._geojsonTileLayer||w[S];if(!P)return;const R=o.b3(u&&u.filter),{z:N,x:V,y:G}=this.tileID.canonical,X={z:N,x:V,y:G};for(let W=0;W<P.length;W++){const Q=P.feature(W);if(R.needGeometry){const pe=o.b4(Q,!0);if(!R.filter(new o.aa(this.tileID.overscaledZ,{worldview:this.worldview}),pe,this.tileID.canonical))continue}else if(!R.filter(new o.aa(this.tileID.overscaledZ,{worldview:this.worldview}),Q))continue;const fe=g.getId(Q,S),se=new o.b5(Q,N,V,G,fe);se.tile=X,r.push(se)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(r){const u=this.expirationTime;if(r.cacheControl){const g=o.b6(r.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const g=Date.now();let w=!1;if(this.expirationTime>g)w=!1;else if(u)if(this.expirationTime<u)w=!0;else{const S=this.expirationTime-u;S?this.expirationTime=g+Math.max(S,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r,u){if(!this.latestFeatureIndex||!r.style)return;const g=this.latestFeatureIndex.loadVTLayers(),w=r.style.listImages(),S=r.style.getBrightness();for(const P in this.buckets){if(!r.style.hasLayer(P))continue;const R=this.buckets[P],N=R.layers[0],V=N.sourceLayer||"_geojsonTileLayer",G=g[V],X=r.style.getLayerSourceCache(N);let W={};X&&(W=X._state.getState(V,void 0));const Q=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},fe=Object.keys(W).length>0&&!u;fe&&!R.stateDependentLayers.length&&!u||R.update(W,G,w,Q,fe?R.stateDependentLayers:R.layers,u,S),(R instanceof o.b7||R instanceof o.b8)&&r._terrain&&r._terrain.enabled&&X&&R.uploadPending()&&r._terrain._clearRenderCacheForTile(X.id,this.tileID);const se=r&&r.style&&r.style.getOwnLayer(P);se&&(this.queryPadding=Math.max(this.queryPadding,se.queryRadius(R)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.q.now()+r}setTexture(r,u){const g=u.context,w=g.gl;this.texture=this.texture||u.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r):(this.texture=new o.T(g,r,w.RGBA8,{useMipmap:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE))}setDependencies(r,u){const g={};for(const w of u)g[w]=!0;this.dependencies[r]=g}hasDependency(r,u){for(const g of r){const w=this.dependencies[g];if(w){for(const S of u)if(w[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const g=o.b9(Gs,this.tileID.canonical,this.tileTransform)[0],w=new o.ba,S=new o.bb;for(let P=0;P<g.length;P++){const{x:R,y:N}=g[P];w.emplaceBack(R,N),S.emplaceBack(P)}S.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(S),this._tileDebugBuffer=r.createVertexBuffer(w,o.bc.members),this._tileDebugSegments=o.bd.simpleSegment(0,0,w.length,S.length)}_makeTileBoundsBuffers(r,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const g=o.b9(Gs,this.tileID.canonical,this.tileTransform)[0];let w,S;if(this.isRaster){const P=function(R,N){const V=o.aW(R,N),G=Math.pow(2,R.z);for(let pe=0;pe<jo;pe++)for(let ye=0;ye<jo;ye++){const we=o.aX((R.x+(ye+bs(ye))/va)/G),De=o.aY((R.y+(pe+bs(pe))/va)/G),Le=N.project(we,De),Ze=pe*jo+ye;ha[2*Ze+0]=Math.round((Le.x*V.scale-V.x)*o.aj),ha[2*Ze+1]=Math.round((Le.y*V.scale-V.y)*o.aj)}da.fill(0),wl.fill(0);for(let pe=2045;pe>=0;pe--){const ye=4*pe,we=uo[ye+0],De=uo[ye+1],Le=uo[ye+2],Ze=uo[ye+3],Ue=we+Le>>1,Fe=De+Ze>>1,ke=Ue+Fe-De,qe=Fe+we-Ue,Ke=De*jo+we,pt=Ze*jo+Le,mt=Fe*jo+Ue,It=Math.hypot((ha[2*Ke+0]+ha[2*pt+0])/2-ha[2*mt+0],(ha[2*Ke+1]+ha[2*pt+1])/2-ha[2*mt+1])>=16;da[mt]=da[mt]||(It?1:0),pe<1022&&(da[mt]=da[mt]||da[(De+qe>>1)*jo+(we+ke>>1)]||da[(Ze+qe>>1)*jo+(Le+ke>>1)])}const X=new o.aZ,W=new o.a_;let Q=0;function fe(pe,ye){const we=ye*jo+pe;return wl[we]===0&&(X.emplaceBack(ha[2*we+0],ha[2*we+1],pe*o.aj/va,ye*o.aj/va),wl[we]=++Q),wl[we]-1}function se(pe,ye,we,De,Le,Ze){const Ue=pe+we>>1,Fe=ye+De>>1;if(Math.abs(pe-Le)+Math.abs(ye-Ze)>1&&da[Fe*jo+Ue])se(Le,Ze,pe,ye,Ue,Fe),se(we,De,Le,Ze,Ue,Fe);else{const ke=fe(pe,ye),qe=fe(we,De),Ke=fe(Le,Ze);W.emplaceBack(ke,qe,Ke)}}return se(0,0,va,va,va,0),se(va,va,0,0,0,va),{vertices:X,indices:W}}(this.tileID.canonical,u);w=P.vertices,S=P.indices}else{w=new o.aZ,S=new o.a_;for(const{x:R,y:N}of g)w.emplaceBack(R,N,0,0);const P=o.be(w.int16.subarray(0,4*w.length),void 0,4);for(let R=0;R<P.length;R+=3)S.emplaceBack(P[R],P[R+1],P[R+2])}this._tileBoundsBuffer=r.createVertexBuffer(w,o.bf.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(S),this._tileBoundsSegments=o.bd.simpleSegment(0,0,w.length,S.length)}_makeGlobeTileDebugBuffers(r,u){const g=u.projection;if(!g||g.name!=="globe"||u.freezeTileCoverage)return;const w=this.tileID.canonical,S=o.bg(w,u),P=o.bh(S),R=o.ah(u.zoom);let N;R>0&&(N=o.bi(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,w,u,P,N,R),this._makeGlobeTileDebugTextBuffer(r,w,u,P,N,R)}_globePoint(r,u,g,w,S,P,R){let N=o.bj(r,u,g);if(P){const V=1<<g.z,G=o.aD(w.center.lng),X=o.aH(w.center.lat),W=(g.x+.5)/V-G;let Q=0;W>.5?Q=-1:W<-.5&&(Q=1);let fe=(r/o.aj+g.x)/V+Q,se=(u/o.aj+g.y)/V;fe=(fe-G)*w._pixelsPerMercatorPixel+G,se=(se-X)*w._pixelsPerMercatorPixel+X;const pe=[fe*w.worldSize,se*w.worldSize,0];o.ad(pe,pe,P),N=o.bk(N,pe,R)}return o.ad(N,N,S)}_makeGlobeTileDebugBorderBuffer(r,u,g,w,S,P){const R=new o.ba,N=new o.bb,V=new o.bl,G=(W,Q,fe,se,pe)=>{const ye=(fe-W)/(pe-1),we=(se-Q)/(pe-1),De=R.length;for(let Le=0;Le<pe;Le++){const Ze=W+Le*ye,Ue=Q+Le*we;R.emplaceBack(Ze,Ue);const Fe=this._globePoint(Ze,Ue,u,g,w,S,P);V.emplaceBack(Fe[0],Fe[1],Fe[2]),N.emplaceBack(De+Le)}},X=o.aj;G(0,0,X,0,16),G(X,0,X,X,16),G(X,X,0,X,16),G(0,X,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(N),this._tileDebugBuffer=r.createVertexBuffer(R,o.bc.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(V,o.bm.members),this._tileDebugSegments=o.bd.simpleSegment(0,0,R.length,N.length)}_makeGlobeTileDebugTextBuffer(r,u,g,w,S,P){const R=o.aj/4,N=new o.ba,V=new o.a_,G=new o.bl,X=25;V.reserve(32),N.reserve(X),G.reserve(X);const W=(Q,fe)=>X*Q+fe;for(let Q=0;Q<X;Q++){const fe=Q*R;for(let se=0;se<X;se++){const pe=se*R;N.emplaceBack(pe,fe);const ye=this._globePoint(pe,fe,u,g,w,S,P);G.emplaceBack(ye[0],ye[1],ye[2])}}for(let Q=0;Q<4;Q++)for(let fe=0;fe<4;fe++){const se=W(Q,fe),pe=W(Q,fe+1),ye=W(Q+1,fe),we=W(Q+1,fe+1);V.emplaceBack(se,pe,ye),V.emplaceBack(ye,pe,we)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(V),this._tileDebugTextBuffer=r.createVertexBuffer(N,o.bc.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(G,o.bm.members),this._tileDebugTextSegments=o.bd.simpleSegment(0,0,X,32)}destroy(r=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.bp.setPbf(o.bq);class us extends cs{constructor(r,u,g,w,S){super(r,u,g,w,S),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(r){return this._mrt&&this._mrt.getLayer(r)}setTexture(r,u){const g=u.context,w=g.gl;this.texture=this.texture||u.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r,{premultiply:!1}):this.texture=new o.T(g,r,w.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,u){const g=this._mrt=new o.bp(30),w=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=o.br(w,(S,P,R,N)=>{if(S)u(S);else try{const V=g.getHeaderLength(P);if(V>r)return void(this.request=this.fetchHeader(V,u));g.parseHeader(P),this._isHeaderLoaded=!0;let G=0;for(const X of Object.values(g.layers))G=Math.max(G,X.dataIndex[X.dataIndex.length-1].lastByte);P.byteLength>=G&&(this.entireBuffer=P),u(null,this.entireBuffer||P,R,N)}catch(V){u(V)}}),this.request}fetchBand(r,u,g){const w=this._mrt;if(!this._isHeaderLoaded||!w)return void g(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void g(new Error("Can't fetch tile band without an actor"));let P;const R=(X,W)=>{P.complete(X,W),X?g(X):(this.updateTextureDescriptor(r,u),g(null,this.textureDescriptor&&this.textureDescriptor.img))},N=(X,W)=>{if(X)return g(X);const Q=S.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:W,task:P},R,void 0,!0);this._workQueue.push(()=>{Q&&Q.cancel(),P.cancel()})},V=w.getLayer(r);if(!V)return void g(new Error(`Unknown sourceLayer "${r}"`));if(V.hasDataForBand(u))return this.updateTextureDescriptor(r,u),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const G=V.getDataRange([u]);if(P=w.createDecodingTask(G),!P||P.tasks.length)if(this.flushQueues(),this.entireBuffer)N(null,this.entireBuffer.slice(G.firstByte,G.lastByte+1));else{const X=Object.assign({},this.requestParams,{headers:{Range:`bytes=${G.firstByte}-${G.lastByte}`}}),W=o.br(X,N);this._fetchQueue.push(()=>{W.cancel(),P.cancel()})}else g(null)}updateNeeded(r,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,u){if(!this._mrt)return;const g=this._mrt.getLayer(r);if(!g||!g.hasBand(u)||!g.hasDataForBand(u))return;const{bytes:w,tileSize:S,buffer:P,offset:R,scale:N}=g.getBandView(u),V=S+2*P,G=new o.r({width:V,height:V},w),X=this.texture;X&&X instanceof o.T&&X.update(G,{premultiply:!1}),this.textureDescriptor={layer:r,band:u,img:G,buffer:P,offset:R,tileSize:S,format:g.pixelFormat,mix:[N,256*N,65536*N,16777216*N]}}}class ic{constructor(r,u){this.max=r,this.onRemove=u,this.reset()}reset(){for(const r in this.data)for(const u of this.data[r])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(r,u,g){const w=r.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const S={value:u,timeout:void 0};if(g!==void 0&&(S.timeout=setTimeout(()=>{this.remove(r,S)},g)),this.data[w].push(S),this.order.push(w),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const u=this.data[r].shift();return u.timeout&&clearTimeout(u.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),u.value}getByKey(r){const u=this.data[r];return u?u[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,u){if(!this.has(r))return this;const g=r.wrapped().key,w=u===void 0?0:this.data[g].indexOf(u),S=this.data[g][w];return this.data[g].splice(w,1),S.timeout&&clearTimeout(S.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(S.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(r){const u=[];for(const g in this.data)for(const w of this.data[g])r(w.value)||u.push(w);for(const g of u)this.remove(g.value.tileID,g)}}class St{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,u,g){const w=String(u);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][w]=this.stateChanges[r][w]||{},o.h(this.stateChanges[r][w],g),this.deletedStates[r]===null){this.deletedStates[r]={};for(const S in this.state[r])S!==w&&(this.deletedStates[r][S]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][w]===null){this.deletedStates[r][w]={};for(const S in this.state[r][w])g[S]||(this.deletedStates[r][w][S]=null)}else for(const S in g)this.deletedStates[r]&&this.deletedStates[r][w]&&this.deletedStates[r][w][S]===null&&delete this.deletedStates[r][w][S]}removeFeatureState(r,u,g){if(this.deletedStates[r]===null)return;const w=String(u);if(this.deletedStates[r]=this.deletedStates[r]||{},g&&u!==void 0)this.deletedStates[r][w]!==null&&(this.deletedStates[r][w]=this.deletedStates[r][w]||{},this.deletedStates[r][w][g]=null);else if(u!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][w])for(g in this.deletedStates[r][w]={},this.stateChanges[r][w])this.deletedStates[r][w][g]=null;else this.deletedStates[r][w]=null;else this.deletedStates[r]=null}getState(r,u){const g=this.state[r]||{},w=this.stateChanges[r]||{},S=this.deletedStates[r];if(S===null)return{};if(u!==void 0){const R=String(u),N=o.h({},g[R],w[R]);if(S){const V=S[u];if(V===null)return{};for(const G in V)delete N[G]}return N}const P=o.h({},g,w);if(S)for(const R in S)delete P[R];return P}initializeTileState(r,u){r.refreshFeatureState(u)}coalesceChanges(r,u){const g={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const S={};for(const P in this.stateChanges[w])this.state[w][P]||(this.state[w][P]={}),o.h(this.state[w][P],this.stateChanges[w][P]),S[P]=this.state[w][P];g[w]=S}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const S={};if(this.deletedStates[w]===null)for(const P in this.state[w])S[P]={},this.state[w][P]={};else for(const P in this.deletedStates[w]){if(this.deletedStates[w][P]===null)this.state[w][P]={};else if(this.state[w][P])for(const R of Object.keys(this.deletedStates[w][P]))delete this.state[w][P][R];S[P]=this.state[w][P]}g[w]=g[w]||{},o.h(g[w],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const w in r)r[w].refreshFeatureState(u)}}class en extends o.E{constructor(r,u,g){super(),this.id=r,this._onlySymbols=g,u.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new ic(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new St,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles)if(!this._tiles[r].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,u){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,u)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(r),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(Vn).map(r=>r.key)}getRenderableIds(r,u){const g=[];for(const w in this._tiles)this._isIdRenderable(+w,r,u)&&g.push(this._tiles[w]);return r?g.sort((w,S)=>{const P=w.tileID,R=S.tileID,N=new o.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),V=new o.P(R.canonical.x,R.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-R.overscaledZ||V.y-N.y||V.x-N.x}).map(w=>w.tileID.key):g.map(w=>w.tileID).sort(Vn).map(w=>w.key)}hasRenderableParent(r){const u=this.findLoadedParent(r,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(r,u,g){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(u||!this._tiles[r].holdingForFade())&&(g||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,u){const g=this._tiles[r];g&&(g.state!=="loading"&&(g.state=u),this._loadTile(g,this._tileLoaded.bind(this,g,r,u)))}_tileLoaded(r,u,g,w){if(w)if(r.state="errored",w.status!==404)this._source.fire(new o.z(w,{tile:r}));else{if(this._source.fire(new o.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const S=this.map.painter.terrain;this.update(this.transform,S.getScaledDemTileSize(),!0),S.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=o.q.now(),g==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(u,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new o.A("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const u=this.getRenderableIds();for(let w=0;w<u.length;w++){const S=u[w];if(r.neighboringTiles&&r.neighboringTiles[S]){const P=this.getTileByID(S);g(r,P),g(P,r)}}function g(w,S){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let P=S.tileID.canonical.x-w.tileID.canonical.x;const R=S.tileID.canonical.y-w.tileID.canonical.y,N=Math.pow(2,w.tileID.canonical.z),V=S.tileID.key;P===0&&R===0||Math.abs(R)>1||(Math.abs(P)>1&&(Math.abs(P+N)===1?P+=N:Math.abs(P-N)===1&&(P-=N)),S.dem&&w.dem&&(w.dem.backfillBorder(S.dem,P,R),w.neighboringTiles&&w.neighboringTiles[V]&&(w.neighboringTiles[V].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,u,g,w){for(const S in this._tiles){let P=this._tiles[S];if(w[S]||!P.hasData()||P.tileID.overscaledZ<=u||P.tileID.overscaledZ>g)continue;let R=P.tileID;for(;P&&P.tileID.overscaledZ>u+1;){const V=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[V.key],P&&P.hasData()&&(R=V)}let N=R;for(;N.overscaledZ>u;)if(N=N.scaledTo(N.overscaledZ-1),r[N.key]){w[R.key]=R;break}}}findLoadedParent(r,u){if(r.key in this._loadedParentTiles){const g=this._loadedParentTiles[r.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=r.overscaledZ-1;g>=u;g--){const w=r.scaledTo(g),S=this._getLoadedTile(w);if(S)return S}}_getLoadedTile(r){const u=this._tiles[r.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,u){u=u||this._source.tileSize;const g=Math.ceil(r.width/u)+1,w=Math.ceil(r.height/u)+1,S=Math.floor(g*w*5),P=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(R)}handleWrapJump(r){const u=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,u){const g={};for(const w in this._tiles){const S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),g[S.tileID.key]=S}this._tiles=g;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(r,u,g,w,S){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(r,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let R,N=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const W=V.attenuationRange()[0],Q=Math.floor(W)-Math.log2(V.getDemUpscale());N>Q&&(N=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)R=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new o.aM(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y));else if(this.tileCoverLift!==0){const W=r.clone();W.tileCoverLift=this.tileCoverLift,R=W.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&r.projection.name==="globe"&&(R.push(new o.aM(1,0,1,0,0)),R.push(new o.aM(1,0,1,1,0)),R.push(new o.aM(1,0,1,0,1)),R.push(new o.aM(1,0,1,1,1)))}else if(R=r.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const W=this._source.hasTile.bind(this._source);R=R.filter(Q=>W(Q))}}else R=[];if(R.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Zi(this._source.type)){const W=r.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),Q=Math.min(W,this._source.maxzoom);if(P){const fe=r.extendTileCover(R,Q);for(const se of fe)R.push(se)}else if(S){const fe=r.extendTileCover(R,Q,this.transform._camera.forward());for(const se of fe)R.push(se)}else if(this.castsShadows&&w){const fe=r.extendTileCover(R,Q,w);for(const se of fe)this._shadowCasterTiles[se.key]=!0,R.push(se)}}const G=this._updateRetainedTiles(R);if(Zi(this._source.type)&&R.length!==0){const W={},Q={},fe=Object.keys(G);for(const pe of fe){const ye=G[pe],we=this._tiles[pe];if(!we||we.fadeEndTime&&we.fadeEndTime<=o.q.now())continue;const De=this.findLoadedParent(ye,Math.max(ye.overscaledZ-en.maxOverzooming,this._source.minzoom));De&&(this._addTile(De.tileID),W[De.tileID.key]=De.tileID),Q[pe]=ye}const se=R[R.length-1].overscaledZ;for(const pe in this._tiles){const ye=this._tiles[pe];if(G[pe]||!ye.hasData())continue;let we=ye.tileID;for(;we.overscaledZ>se;){we=we.scaledTo(we.overscaledZ-1);const De=this._tiles[we.key];if(De&&De.hasData()&&Q[we.key]){G[pe]=ye.tileID;break}}}for(const pe in W)G[pe]||(this._coveredTiles[pe]=!0,G[pe]=W[pe])}for(const W in G)this._tiles[W].clearFadeHold();const X=o.bs(this._tiles,G);for(const W of X){const Q=this._tiles[W];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const u={};if(r.length===0)return u;const g={},w=r.reduce((V,G)=>Math.min(V,G.overscaledZ),1/0),S=r[0].overscaledZ,P=Math.max(S-en.maxOverzooming,this._source.minzoom),R=Math.max(S+en.maxUnderzooming,this._source.minzoom),N={};for(const V of r){const G=this._addTile(V);u[V.key]=V,G.hasData()||w<this._source.maxzoom&&(N[V.key]=V)}this._retainLoadedChildren(N,w,R,u);for(const V of r){let G=this._tiles[V.key];if(G.hasData())continue;if(V.canonical.z>=this._source.maxzoom){const W=V.children(this._source.maxzoom)[0],Q=this.getTile(W);if(Q&&Q.hasData()){u[W.key]=W;continue}}else{const W=V.children(this._source.maxzoom);if(u[W[0].key]&&u[W[1].key]&&u[W[2].key]&&u[W[3].key])continue}let X=G.wasRequested();for(let W=V.overscaledZ-1;W>=P;--W){const Q=V.scaledTo(W);if(g[Q.key]||(g[Q.key]=!0,G=this.getTile(Q),!G&&X&&(G=this._addTile(Q)),G&&(u[Q.key]=Q,X=G.wasRequested(),G.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const u=[];let g,w=this._tiles[r].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){g=this._loadedParentTiles[w.key];break}u.push(w.key);const S=w.scaledTo(w.overscaledZ-1);if(g=this._getLoadedTile(S),g)break;w=S}for(const S of u)this._loadedParentTiles[S]=g}}_addTile(r){let u=this._tiles[r.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),u;u=this._cache.getAndRemove(r),u&&(this._setTileReloadTimer(r.key,u),u.tileID=r,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,u)));const g=!!u;if(!g){const w=this.map?this.map.painter:null,S=this._source.tileSize*r.overscaleFactor();u=this._source.type==="raster-array"?new us(r,S,this.transform.tileZoom,w,this._isRaster):new cs(r,S,this.transform.tileZoom,w,this._isRaster,this._source.worldview),this._loadTile(u,this._tileLoaded.bind(this,u,r.key,u.state))}return u.uses++,this._tiles[r.key]=u,g||this._source.fire(new o.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(r,u){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const g=u.getExpiryTimeout();g&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},g))}_removeTile(r){const u=this._tiles[r];u&&(u.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,u,g){const w=[],S=this.transform;if(!S)return w;const P=S.projection.name==="globe",R=o.aD(S.center.lng);for(const N in this._tiles){const V=this._tiles[N];if(g&&V.clearQueryDebugViz(),V.holdingForFade())continue;let G;if(P){const X=V.tileID.canonical;if(X.z===0){const W=[Math.abs(o.ay(R,...yr(X,-1))-R),Math.abs(o.ay(R,...yr(X,1))-R)];G=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(o.ay(R,...yr(X,-1))-R),Math.abs(o.ay(R,...yr(X,0))-R),Math.abs(o.ay(R,...yr(X,1))-R)];G=[W.indexOf(Math.min(...W))-1]}}else G=[0];for(const X of G){const W=r.containsTile(V,S,u,X);W&&w.push(W)}}return w}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,u){const g=this.getRenderableIds(r,u).map(S=>this._tiles[S].tileID),w=this.transform.projection.name==="globe";for(const S of g)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=w?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return g}sortCoordinatesByDistance(r){const u=r.slice(),g=this.transform._camera.position,w=this.transform._camera.forward(),S={};for(const P of u){const R=1/(1<<P.canonical.z);S[P.key]=((P.canonical.x+.5)*R+P.wrap-g[0])*w[0]+((P.canonical.y+.5)*R-g[1])*w[1]-g[2]*w[2]}return u.sort((P,R)=>S[P.key]-S[R.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(Zi(this._source.type))for(const r in this._tiles){const u=this._tiles[r];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(r,u,g){this._state.updateState(r=r||"_geojsonTileLayer",u,g)}removeFeatureState(r,u,g){this._state.removeFeatureState(r=r||"_geojsonTileLayer",u,g)}getFeatureState(r,u){return this._state.getState(r=r||"_geojsonTileLayer",u)}setDependencies(r,u,g){const w=this._tiles[r];w&&w.setDependencies(u,g)}reloadTilesForDependencies(r,u){for(const g in this._tiles)this._tiles[g].hasDependency(r,u)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(r,u))}_preloadTiles(r,u){if(!this._sourceLoaded){const N=()=>{this._sourceLoaded&&(this._source.off("data",N),this._preloadTiles(r,u))};return void this._source.on("data",N)}const g=new Map,w=Array.isArray(r)?r:[r],S=this.map.painter.terrain,P=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const N of w){const V=N.coveringTiles({tileSize:P,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const G of V)g.set(G.key,G);this.usedForTerrain&&N.updateElevation(!1)}const R=Array.from(g.values());o.bt(R,(N,V)=>{const G=new cs(N,this._source.tileSize*N.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(G,X=>{this._source.type==="raster-dem"&&G.dem&&this._backfillDEM(G),V(X,G)})},u)}}function Vn(m,r){const u=Math.abs(2*m.wrap)-+(m.wrap<0),g=Math.abs(2*r.wrap)-+(r.wrap<0);return m.overscaledZ-r.overscaledZ||g-u||r.canonical.y-m.canonical.y||r.canonical.x-m.canonical.x}function Zi(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function yr(m,r){const u=1<<m.z;return[m.x/u+r,(m.x+1)/u+r]}en.maxOverzooming=10,en.maxUnderzooming=3;class na{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,u=!1;for(const g in this.style._mergedLayers){const w=this.style._mergedLayers[g];if(w.type==="fill-extrusion"||w.type==="building")this.layers.push({layer:w,visible:r,visibilityChanged:u});else if(w.type==="model"){const S=this.style.getLayerSource(w);S&&S.type==="batched-model"&&this.layers.push({layer:w,visible:r,visibilityChanged:u})}}}onNewFrame(r){this.layersGotHidden=!1;for(const u of this.layers){const g=u.layer;let w=!1;g.type==="fill-extrusion"?w=!g.isHidden(r)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="building"?w=!g.isHidden(r)&&g.paint.get("building-opacity")>0:g.type==="model"&&(w=!g.isHidden(r)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!w&&u.visible,u.visible=w}}updateZOffset(r,u){this.currentBuildingBuckets=[];for(const w of this.layers){const S=w.layer,P=this.style.getLayerSourceCache(S);let R=1;S.type==="fill-extrusion"?R=w.visible?S.paint.get("fill-extrusion-vertical-scale"):0:S.type==="building"&&(R=w.visible?S.paint.get("building-vertical-scale"):0);let N=P?P.getTile(u):null;if(!N&&P&&u.canonical.z>P.getSource().minzoom){let V=u.scaledTo(Math.min(P.getSource().maxzoom,u.overscaledZ-1));for(;V.overscaledZ>=P.getSource().minzoom&&(N=P.getTile(V),!N&&V.overscaledZ!==0);)V=V.scaledTo(V.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:N?N.getBucket(S):null,tileID:N?N.tileID:u,verticalScale:R})}r.hasAnyZOffset=!1;let g=!1;for(let w=0;w<r.symbolInstances.length;w++){const S=r.symbolInstances.get(w),P=S.zOffset,R=this._getHeightAtTileOffset(u,S.tileAnchorX,S.tileAnchorY);S.zOffset=R!==Number.NEGATIVE_INFINITY?R:P,g||P===S.zOffset||(g=!0),r.hasAnyZOffset||S.zOffset===0||(r.hasAnyZOffset=!0)}g&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,u,g,w){let S=u,P=g;if(r.canonical.z!==w.canonical.z){const R=w.canonical,N=1/(1<<r.canonical.z-R.z);S=(u+r.canonical.x*o.aj)*N-R.x*o.aj|0,P=(g+r.canonical.y*o.aj)*N-R.y*o.aj|0}return{tileX:S,tileY:P}}_getHeightAtTileOffset(r,u,g){let w,S;for(let P=0;P<this.layers.length;++P){const R=this.layers[P].layer;if(R.type!=="fill-extrusion"&&R.type!=="building")continue;const{bucket:N,tileID:V,verticalScale:G}=this.currentBuildingBuckets[P];if(!N)continue;const{tileX:X,tileY:W}=this._mapCoordToOverlappingTile(r,u,g,V),Q=N.getHeightAtTileCoord(X,W);Q&&Q.height!==void 0&&(Q.hidden?w=Q.height:S=Math.max(Q.height*G,S||0))}if(S!==void 0)return S;for(let P=0;P<this.layers.length;++P){const R=this.layers[P];if(R.layer.type!=="model"||!R.visible)continue;const{bucket:N,tileID:V}=this.currentBuildingBuckets[P];if(!N)continue;const{tileX:G,tileY:X}=this._mapCoordToOverlappingTile(r,u,g,V),W=N.getHeightAtTileCoord(G,X);if(W&&!W.hidden)return W.height===void 0&&w!==void 0?Math.min(W.maxHeight,w)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Ni(m,r){const u={};for(const g in m)g!=="ref"&&(u[g]=m[g]);return o.bu.forEach(g=>{g in r&&(u[g]=r[g])}),u}function Sr(m){m=m.slice();const r=Object.create(null);for(let u=0;u<m.length;u++)r[m[u].id]=m[u];for(let u=0;u<m.length;u++)"ref"in m[u]&&(m[u]=Ni(m[u],r[m[u].ref]));return m}const ri={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function zo(m,r,u){u.push({command:ri.addSource,args:[m,r[m]]})}function hs(m,r,u){r.push({command:ri.removeSource,args:[m]}),u[m]=!0}function ko(m,r,u,g){hs(m,u,g),zo(m,r,u)}function Rs(m,r,u){let g;for(g in m[u])if(m[u].hasOwnProperty(g)&&g!=="data"&&!o.bv(m[u][g],r[u][g]))return!1;for(g in r[u])if(r[u].hasOwnProperty(g)&&g!=="data"&&!o.bv(m[u][g],r[u][g]))return!1;return!0}function ws(m,r,u,g,w,S){let P;for(P in r=r||{},m=m||{})m.hasOwnProperty(P)&&(o.bv(m[P],r[P])||u.push({command:S,args:[g,P,r[P],w]}));for(P in r)r.hasOwnProperty(P)&&!m.hasOwnProperty(P)&&(o.bv(m[P],r[P])||u.push({command:S,args:[g,P,r[P],w]}))}function Qa(m){return m.id}function Ma(m,r){return m[r.id]=r,m}class No{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ay(r,0,1);let u=1,g=this._distances[u];const w=r*this.paddedLength+this.padding;for(;g<w&&u<this._distances.length;)g=this._distances[++u];const S=u-1,P=this._distances[S],R=g-P,N=R>0?(w-P)/R:0;return this.points[S].mult(1-N).add(this.points[u].mult(N))}}class Oa{constructor(r,u,g){const w=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(r/g),this.yCellCount=Math.ceil(u/g);for(let P=0;P<this.xCellCount*this.yCellCount;P++)w.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,g,w,S){this._forEachCell(u,g,w,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(S)}insertCircle(r,u,g,w){this._forEachCell(u-w,g-w,u+w,g+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(g),this.circles.push(w)}_insertBoxCell(r,u,g,w,S,P){this.boxCells[S].push(P)}_insertCircleCell(r,u,g,w,S,P){this.circleCells[S].push(P)}_query(r,u,g,w,S,P){if(g<0||r>this.width||w<0||u>this.height)return!S&&[];const R=[];if(r<=0&&u<=0&&this.width<=g&&this.height<=w){if(S)return!0;for(let N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const V=this.circles[3*N],G=this.circles[3*N+1],X=this.circles[3*N+2];R.push({key:this.circleKeys[N],x1:V-X,y1:G-X,x2:V+X,y2:G+X})}return P?R.filter(P):R}return this._forEachCell(r,u,g,w,this._queryCell,R,{hitTest:S,seenUids:{box:{},circle:{}}},P),S?R.length>0:R}_queryCircle(r,u,g,w,S){const P=r-g,R=r+g,N=u-g,V=u+g;if(R<0||P>this.width||V<0||N>this.height)return!w&&[];const G=[];return this._forEachCell(P,N,R,V,this._queryCellCircle,G,{hitTest:w,circle:{x:r,y:u,radius:g},seenUids:{box:{},circle:{}}},S),w?G.length>0:G}query(r,u,g,w,S){return this._query(r,u,g,w,!1,S)}hitTest(r,u,g,w,S){return this._query(r,u,g,w,!0,S)}hitTestCircle(r,u,g,w){return this._queryCircle(r,u,g,!0,w)}_queryCell(r,u,g,w,S,P,R,N){const V=R.seenUids,G=this.boxCells[S];if(G!==null){const W=this.bboxes;for(const Q of G)if(!V.box[Q]){V.box[Q]=!0;const fe=4*Q;if(r<=W[fe+2]&&u<=W[fe+3]&&g>=W[fe+0]&&w>=W[fe+1]&&(!N||N(this.boxKeys[Q]))){if(R.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[Q],x1:W[fe],y1:W[fe+1],x2:W[fe+2],y2:W[fe+3]})}}}const X=this.circleCells[S];if(X!==null){const W=this.circles;for(const Q of X)if(!V.circle[Q]){V.circle[Q]=!0;const fe=3*Q;if(this._circleAndRectCollide(W[fe],W[fe+1],W[fe+2],r,u,g,w)&&(!N||N(this.circleKeys[Q]))){if(R.hitTest)return P.push(!0),!0;{const se=W[fe],pe=W[fe+1],ye=W[fe+2];P.push({key:this.circleKeys[Q],x1:se-ye,y1:pe-ye,x2:se+ye,y2:pe+ye})}}}}}_queryCellCircle(r,u,g,w,S,P,R,N){const V=R.circle,G=R.seenUids,X=this.boxCells[S];if(X!==null){const Q=this.bboxes;for(const fe of X)if(!G.box[fe]){G.box[fe]=!0;const se=4*fe;if(this._circleAndRectCollide(V.x,V.y,V.radius,Q[se+0],Q[se+1],Q[se+2],Q[se+3])&&(!N||N(this.boxKeys[fe])))return P.push(!0),!0}}const W=this.circleCells[S];if(W!==null){const Q=this.circles;for(const fe of W)if(!G.circle[fe]){G.circle[fe]=!0;const se=3*fe;if(this._circlesCollide(Q[se],Q[se+1],Q[se+2],V.x,V.y,V.radius)&&(!N||N(this.circleKeys[fe])))return P.push(!0),!0}}}_forEachCell(r,u,g,w,S,P,R,N){const V=this._convertToXCellCoord(r),G=this._convertToYCellCoord(u),X=this._convertToXCellCoord(g),W=this._convertToYCellCoord(w);for(let Q=V;Q<=X;Q++)for(let fe=G;fe<=W;fe++)if(S.call(this,r,u,g,w,this.xCellCount*fe+Q,P,R,N))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,g,w,S,P){const R=w-r,N=S-u,V=g+P;return V*V>R*R+N*N}_circleAndRectCollide(r,u,g,w,S,P,R){const N=(P-w)/2,V=Math.abs(r-(w+N));if(V>N+g)return!1;const G=(R-S)/2,X=Math.abs(u-(S+G));if(X>G+g)return!1;if(V<=N||X<=G)return!0;const W=V-N,Q=X-G;return W*W+Q*Q<=g*g}}const Ts={unknown:0,flipRequired:1,flipNotRequired:2},Va=Math.tan(85*Math.PI/180);function $a(m,r,u,g,w,S,P){const R=o.bz();if(u)if(S.name==="globe"){const N=o.bA(w,r);o.az(R,R,N)}else{const N=o.bB([],P);R[0]=N[0],R[1]=N[1],R[4]=N[2],R[5]=N[3],g||o.by(R,R,w.angle)}else o.az(R,w.labelPlaneMatrix,m);return R}function Tl(m,r,u,g,w,S,P){const R=$a(m,r,u,g,w,S,P);return S.name==="globe"&&u||(R[2]=R[6]=R[10]=R[14]=0),R}function st(m,r,u,g,w,S,P){if(u){if(S.name==="globe"){const R=$a(m,r,u,g,w,S,P);return o.bi(R,R),o.az(R,m,R),R}{const R=o.bw(m),N=o.bx([]);return N[0]=P[0],N[1]=P[1],N[4]=P[2],N[5]=P[3],o.az(R,R,N),g||o.by(R,R,-w.angle),R}}return w.glCoordMatrix}function Ut(m,r,u,g){const w=[m,r,u,1];u?o.aA(w,w,g):Di(w,w,g);const S=w[3];return w[0]/=S,w[1]/=S,w[2]/=S,w}function kn(m,r){return Math.min(.5+m/r*.5,1.5)}function qn(m,r){const u=m[0]/m[3],g=m[1]/m[3];return u>=-r[0]&&u<=r[0]&&g>=-r[1]&&g<=r[1]}function oo(m,r,u,g,w,S,P,R,N,V){const G=u.transform,X=g?m.textSizeData:m.iconSizeData,W=o.bH(X,u.transform.zoom),Q=G.projection.name==="globe",fe=[256/u.width*2+1,256/u.height*2+1],se=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;se.clear();let pe=null;Q&&(pe=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const ye=m.lineVertexArray,we=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,De=u.transform.width/u.transform.height;let Le,Ze=!1;for(let Ue=0;Ue<we.length;Ue++){const Fe=we.get(Ue),{numGlyphs:ke,writingMode:qe}=Fe;if(qe!==o.bI.vertical||Ze||Le===o.bI.horizontal||(Ze=!0),Le=qe,(Fe.hidden||qe===o.bI.vertical)&&!Ze){qa(ke,se);continue}Ze=!1;const Ke=new o.P(Fe.tileAnchorX,Fe.tileAnchorY);let{x:pt,y:mt,z:It}=G.projection.projectTilePoint(Ke.x,Ke.y,V.canonical);if(N){const[Bn,Dn,On]=N(Ke);pt+=Bn,mt+=Dn,It+=On}const Nt=[pt,mt,It,1];if(o.aA(Nt,Nt,r),!qn(Nt,fe)){qa(ke,se);continue}const Xt=Nt[3],ut=kn(u.transform.getCameraToCenterDistance(G.projection),Xt),Et=o.bJ(X,W,Fe),at=P?Et/ut:Et*ut,jt=Ut(pt,mt,It,w);if(jt[3]<=0){qa(ke,se);continue}let wt={};const Ht=o.al(m.layers[0].layout.get("text-max-angle")),pn=Math.cos(Ht),Ft=P?null:N,rn=Fo(Fe,at,!1,R,r,w,S,m.glyphOffsetArray,ye,se,pe,jt,Ke,wt,De,Ft,G.projection,V,P,pn);Ze=rn.useVertical,Ft&&rn.needsFlipping&&(wt={}),(rn.notEnoughRoom||Ze||rn.needsFlipping&&Fo(Fe,at,!0,R,r,w,S,m.glyphOffsetArray,ye,se,pe,jt,Ke,wt,De,Ft,G.projection,V,P,pn).notEnoughRoom)&&qa(ke,se)}g?(m.text.dynamicLayoutVertexBuffer.updateData(se),pe&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(pe)):(m.icon.dynamicLayoutVertexBuffer.updateData(se),pe&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(pe))}function Ui(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe){const{lineStartIndex:ye,glyphStartIndex:we,segment:De}=R,Le=we+R.numGlyphs,Ze=ye+R.lineLength,Ue=r.getoffsetX(we),Fe=r.getoffsetX(Le-1),ke=xa(m*Ue,u,g,w,S,P,De,ye,Ze,N,V,G,X,W,!0,Q,fe,se,pe);if(!ke)return null;const qe=xa(m*Fe,u,g,w,S,P,De,ye,Ze,N,V,G,X,W,!0,Q,fe,se,pe);return qe?{first:ke,last:qe}:null}function _o(m,r,u,g){return m===o.bI.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:m===o.bI.vertical?g>0?{needsFlipping:!0}:null:r!==Ts.unknown&&function(w,S){return w===0||Math.abs(S/w)>Va}(u,g)?r===Ts.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function Fo(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye,we,De){const Le=r/24,Ze=m.lineOffsetX*Le,Ue=m.lineOffsetY*Le,{lineStartIndex:Fe,glyphStartIndex:ke,numGlyphs:qe,segment:Ke,writingMode:pt,flipState:mt}=m,It=Fe+m.lineLength,Nt=Xt=>{if(G){const[jt,wt,Ht]=Xt.up,pn=V.length;o.bK(G,pn+0,jt,wt,Ht),o.bK(G,pn+1,jt,wt,Ht),o.bK(G,pn+2,jt,wt,Ht),o.bK(G,pn+3,jt,wt,Ht)}const[ut,Et,at]=Xt.point;o.bL(V,ut,Et,at,Xt.angle)};if(qe>1){const Xt=Ui(Le,R,Ze,Ue,u,X,W,m,N,S,Q,se,!1,pe,ye,we,De);if(!Xt)return{notEnoughRoom:!0};if(g&&!u){let[ut,Et,at]=Xt.first.point,[jt,wt,Ht]=Xt.last.point;[ut,Et]=Ut(ut,Et,at,P),[jt,wt]=Ut(jt,wt,Ht,P);const pn=_o(pt,mt,(jt-ut)*fe,wt-Et);if(m.flipState=pn&&pn.needsFlipping?Ts.flipRequired:Ts.flipNotRequired,pn)return pn}Nt(Xt.first);for(let ut=ke+1;ut<ke+qe-1;ut++){const Et=xa(Le*R.getoffsetX(ut),Ze,Ue,u,X,W,Ke,Fe,It,N,S,Q,se,!1,!1,pe,ye,we,De);if(!Et)return V.length-=4*(ut-ke),{notEnoughRoom:!0};Nt(Et)}Nt(Xt.last)}else{if(g&&!u){const ut=Ut(W.x,W.y,0,w),Et=Fe+Ke+1,at=new o.P(N.getx(Et),N.gety(Et)),jt=Ut(at.x,at.y,0,w),wt=jt[3]>0?jt:Mo(W,at,ut,1,w,void 0,pe,ye.canonical),Ht=_o(pt,mt,(wt[0]-ut[0])*fe,wt[1]-ut[1]);if(m.flipState=Ht&&Ht.needsFlipping?Ts.flipRequired:Ts.flipNotRequired,Ht)return Ht}const Xt=xa(Le*R.getoffsetX(ke),Ze,Ue,u,X,W,Ke,Fe,It,N,S,Q,se,!1,!1,pe,ye,we,De);if(!Xt)return{notEnoughRoom:!0};Nt(Xt)}return{}}function yo(m,r,u,g,w){const{x:S,y:P,z:R}=g.projectTilePoint(m.x,m.y,r);if(!w)return Ut(S,P,R,u);const[N,V,G]=w(m);return Ut(S+N,P+V,R+G,u)}function Mo(m,r,u,g,w,S,P,R){const N=yo(m.sub(r)._unit()._add(m),R,w,P,S);return o.at(N,u,N),o.au(N,N),o.bE(N,u,N,g)}function xa(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye,we){const De=g?m-r:m+r;let Le=De>0?1:-1,Ze=0;g&&(Le*=-1,Ze=Math.PI),Le<0&&(Ze+=Math.PI);let Ue=R+P+(Le>0?0:1)|0,Fe=w,ke=w,qe=0,Ke=0;const pt=Math.abs(De),mt=[],It=[];let Nt=S,Xt=Nt,ut=o.bC([]);const Et=()=>Mo(Xt,Nt,ke,pt-qe+1,G,W,se,pe.canonical);for(;qe+Ke<=pt;){if(Ue+=Le,Ue<R||Ue>=N)return null;if(ke=Fe,Xt=Nt,mt.push(ke),Q&&It.push(Xt),Nt=new o.P(V.getx(Ue),V.gety(Ue)),Fe=X[Ue],!Fe){const On=yo(Nt,pe.canonical,G,se,W);Fe=On[3]>0?X[Ue]=On:Et()}qe+=Ke;const Bn=o.at([],Fe,ke),Dn=o.bD(ke,Fe);if(u&&Dn>0&&Ke>0&&o.bG(ut,Bn)/(Ke*Dn)<we)return null;Ke=Dn,ut=Bn}fe&&W&&(X[Ue]&&(Fe=Et(),Ke=o.bD(ke,Fe),ut=o.at([],Fe,ke)),X[Ue]=Fe);const at=(pt-qe)/Ke,jt=Nt.sub(Xt)._mult(at)._add(Xt),wt=o.bE([],ke,ut,at);let Ht=[0,0,1],pn=ut[0],Ft=ut[1];if(ye&&(Ht=se.upVector(pe.canonical,jt.x,jt.y),Ht[0]!==0||Ht[1]!==0||Ht[2]!==1)){const Bn=[Ht[2],0,-Ht[0]],Dn=o.bF([],Ht,Bn);o.au(Bn,Bn),o.au(Dn,Dn),pn=o.bG(ut,Bn),Ft=o.bG(ut,Dn)}if(u){const Bn=o.bF([],Ht,ut);o.au(Bn,Bn),o.bE(wt,wt,Bn,u*Le)}const rn=Ze+Math.atan2(Ft,pn);return mt.push(wt),Q&&It.push(jt),{point:wt,angle:rn,path:mt,tilePath:It,up:Ht}}function qa(m,r){const u=r.length,g=u+4*m;r.resize(g),r.float32.fill(-1/0,4*u,4*g)}function Di(m,r,u){const g=r[0],w=r[1];return m[0]=u[0]*g+u[4]*w+u[12],m[1]=u[1]*g+u[5]*w+u[13],m[3]=u[3]*g+u[7]*w+u[15],m}const sa=100;class Ls{constructor(r,u,g=new Oa(r.width+200,r.height+200,25),w=new Oa(r.width+200,r.height+200,25)){this.transform=r,this.grid=g,this.ignoredGrid=w,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+sa,this.screenBottomBoundary=r.height+sa,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=u}placeCollisionBox(r,u,g,w,S,P,R,N){let V=g.projectedAnchorX,G=g.projectedAnchorY,X=g.projectedAnchorZ;const W=g.elevation,Q=g.tileID,fe=r.getProjection();if(W&&Q){const[Ue,Fe,ke]=fe.upVector(Q.canonical,g.tileAnchorX,g.tileAnchorY),qe=fe.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;V+=Ue*W*qe,G+=Fe*W*qe,X+=ke*W*qe}const se=this.projectAndGetPerspectiveRatio(R,V,G,X,g.tileID,fe.name==="globe"||!!W||this.transform.pitch>0,fe),pe=P*se.perspectiveRatio,ye=(g.x1*u+w.x-g.padding)*pe+se.point.x,we=(g.y1*u+w.y-g.padding)*pe+se.point.y,De=(g.x2*u+w.x+g.padding)*pe+se.point.x,Le=(g.y2*u+w.y+g.padding)*pe+se.point.y,Ze=se.perspectiveRatio<=.55||se.occluded;return!this.isInsideGrid(ye,we,De,Le)||!S&&this.grid.hitTest(ye,we,De,Le,N)||Ze?{box:[],offscreen:!1,occluded:se.occluded}:{box:[ye,we,De,Le],offscreen:this.isOffscreen(ye,we,De,Le),occluded:!1}}placeCollisionCircles(r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se){const pe=[],ye=this.transform.elevation,we=r.getProjection(),De=ye?ye.getAtTileOffsetFunc(se,this.transform.center.lat,this.transform.worldSize,we):null,Le=new o.P(g.tileAnchorX,g.tileAnchorY);let{x:Ze,y:Ue,z:Fe}=we.projectTilePoint(Le.x,Le.y,se.canonical);if(De){const[Ht,pn,Ft]=De(Le);Ze+=Ht,Ue+=pn,Fe+=Ft}const ke=we.name==="globe",qe=this.projectAndGetPerspectiveRatio(R,Ze,Ue,Fe,se,ke||!!ye||this.transform.pitch>0,we),{perspectiveRatio:Ke}=qe,pt=(X?P/Ke:P*Ke)/o.bO,mt=Ut(Ze,Ue,Fe,N),It=g.lineOffsetX*pt,Nt=g.lineOffsetY*pt,Xt=o.al(r.layers[0].layout.get("text-max-angle")),ut=Math.cos(Xt),Et=qe.signedDistanceFromCamera>0?Ui(pt,S,It,Nt,!1,mt,Le,g,w,N,{},ye&&!X?De:null,X&&!!ye,we,se,X,ut):null;let at=!1,jt=!1,wt=!0;if(Et&&!qe.occluded){const Ht=.5*Q*Ke+fe,pn=new o.P(-100,-100),Ft=new o.P(this.screenRightBoundary,this.screenBottomBoundary),rn=new No,{first:Bn,last:Dn}=Et,On=Bn.path.length;let Yn=[];for(let Kn=On-1;Kn>=1;Kn--)Yn.push(Bn.path[Kn]);for(let Kn=1;Kn<Dn.path.length;Kn++)Yn.push(Dn.path[Kn]);const ni=2.5*Ht;V&&(Yn=Yn.map(([Kn,ei,_i],Pi)=>(De&&!ke&&(_i=De(Pi<On-1?Bn.tilePath[On-1-Pi]:Dn.tilePath[Pi-On+2])[2]),Ut(Kn,ei,_i,V))),Yn.some(Kn=>Kn[3]<=0)&&(Yn=[]));let Rn=[];if(Yn.length>0){let Kn=1/0,ei=-1/0,_i=1/0,Pi=-1/0;for(const Yi of Yn)Kn=Math.min(Kn,Yi[0]),_i=Math.min(_i,Yi[1]),ei=Math.max(ei,Yi[0]),Pi=Math.max(Pi,Yi[1]);ei>=pn.x&&Kn<=Ft.x&&Pi>=pn.y&&_i<=Ft.y&&(Rn=[Yn.map(Yi=>new o.P(Yi[0],Yi[1]))],(Kn<pn.x||ei>Ft.x||_i<pn.y||Pi>Ft.y)&&(Rn=o.bM(Rn,pn.x,pn.y,Ft.x,Ft.y)))}for(const Kn of Rn){rn.reset(Kn,.25*Ht);let ei=0;ei=rn.length<=.5*Ht?1:Math.ceil(rn.paddedLength/ni)+1;for(let _i=0;_i<ei;_i++){const Pi=_i/Math.max(ei-1,1),Yi=rn.lerp(Pi),fr=Yi.x+sa,ho=Yi.y+sa;pe.push(fr,ho,Ht,0);const wi=fr-Ht,xi=ho-Ht,fi=fr+Ht,Pr=ho+Ht;if(wt=wt&&this.isOffscreen(wi,xi,fi,Pr),jt=jt||this.isInsideGrid(wi,xi,fi,Pr),!u&&this.grid.hitTestCircle(fr,ho,Ht,W)&&(at=!0,!G))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!G&&at||!jt?[]:pe,offscreen:wt,collisionDetected:at,occluded:qe.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,w=1/0,S=-1/0,P=-1/0;for(const G of r){const X=new o.P(G.x+sa,G.y+sa);g=Math.min(g,X.x),w=Math.min(w,X.y),S=Math.max(S,X.x),P=Math.max(P,X.y),u.push(X)}const R=this.grid.query(g,w,S,P).concat(this.ignoredGrid.query(g,w,S,P)),N={},V={};for(const G of R){const X=G.key;if(N[X.bucketInstanceId]===void 0&&(N[X.bucketInstanceId]={}),N[X.bucketInstanceId][X.featureIndex])continue;const W=[new o.P(G.x1,G.y1),new o.P(G.x2,G.y1),new o.P(G.x2,G.y2),new o.P(G.x1,G.y2)];o.bN(u,W)&&(N[X.bucketInstanceId][X.featureIndex]=!0,V[X.bucketInstanceId]===void 0&&(V[X.bucketInstanceId]=[]),V[X.bucketInstanceId].push(X.featureIndex))}return V}insertCollisionBox(r,u,g,w,S){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:w,collisionGroupID:S},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,g,w,S){const P=u?this.ignoredGrid:this.grid,R={bucketInstanceId:g,featureIndex:w,collisionGroupID:S};for(let N=0;N<r.length;N+=4)P.insertCircle(R,r[N],r[N+1],r[N+2])}projectAndGetPerspectiveRatio(r,u,g,w,S,P,R){const N=[u,g,w,1];let V=!1;w||this.transform.pitch>0?(o.aA(N,N,r),this.fogState&&S&&R.name!=="globe"&&(V=function(W,Q,fe,se,pe,ye){const we=ye.calculateFogTileMatrix(pe),De=[Q,fe,se];return o.ad(De,De,we),Zt(W,o.ae(De),ye.pitch,ye._fov)}(this.fogState,u,g,w,S.toUnwrapped(),this.transform)>.9)):Di(N,N,r);const G=N[3];return{point:new o.P((N[0]/G+1)/2*this.transform.width+sa,(-N[1]/G+1)/2*this.transform.height+sa),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/G*.5,1.5),signedDistanceFromCamera:G,occluded:P&&N[2]>G||V}}isOffscreen(r,u,g,w){return g<sa||r>=this.screenRightBoundary||w<sa||u>this.screenBottomBoundary}isInsideGrid(r,u,g,w){return g>=0&&r<this.gridRightBoundary&&w>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=o.bx([]);return o.bo(r,r,[-100,-100,0]),r}}function Rl(m,r,u){const g=r.createTileMatrix(m,m.worldSize,u.toUnwrapped());return o.az(new Float32Array(16),m.projMatrix,g)}function Xn(m,r,u){if(r.projection.name===u.projection.name)return m.projMatrix;const g=u.clone();return g.setProjection(r.projection),Rl(g,r.getProjection(),m)}function Ll(m,r,u){return r.name===u.projection.name?m.projMatrix:Rl(u,r,m)}class kc{constructor(r,u,g,w){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):w&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class es{constructor(r,u,g,w,S,P=!1){this.text=new kc(r?r.text:null,u,g,S),this.icon=new kc(r?r.icon:null,u,w,S),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ts{constructor(r,u,g,w=!1){this.text=r,this.icon=u,this.skipFade=g,this.clipped=w}}class Oh{constructor(){this.invProjMatrix=o.bz(),this.viewportMatrix=o.bz(),this.circles=[]}}class cu{constructor(r,u,g,w,S){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=w,this.tileID=S}}class Jn{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[r]}}function Er(m,r,u,g,w){const{horizontalAlign:S,verticalAlign:P}=o.bT(m),R=-(S-.5)*r,N=-(P-.5)*u,V=o.bU(m,g);return new o.P(R+V[0]*w,N+V[1]*w)}function dr(m,r,u,g,w){const S=new o.P(m,r);return u&&S._rotate(g?w:-w),S}class cl{constructor(r,u,g,w,S,P){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Ls(this.transform,S),this.buildingIndex=P,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Jn(g),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,g,w,S=1){const P=g.getBucket(u),R=g.latestFeatureIndex;if(!P||!R||u.fqid!==P.layerIds[0])return;const N=P.layers[0].layout,V=P.layers[0].paint,G=g.collisionBoxArray,X=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),W=g.tileSize/o.aj,Q=g.tileID.toUnwrapped();this.transform.setProjection(P.projection);const fe=(se=g.tileID,pe=P.getProjection(),ye=this.transform,pe.name===this.projection?ye.calculateProjMatrix(se.toUnwrapped()):Rl(ye,pe,se));var se,pe,ye;const we=N.get("text-pitch-alignment")==="map",De=N.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const Le=u.dynamicFilter(),Ze=u.dynamicFilterNeedsFeature(),Ue=this.transform.calculatePixelsToTileUnitsMatrix(g),Fe=Tl(fe,g.tileID.canonical,we,De,this.transform,P.getProjection(),Ue);let ke=null;if(we){const Et=st(fe,g.tileID.canonical,we,De,this.transform,P.getProjection(),Ue);ke=o.az([],this.transform.labelPlaneMatrix,Et)}let qe=null;Le&&g.latestFeatureIndex&&(qe={unwrappedTileID:Q,dynamicFilter:Le,dynamicFilterNeedsFeature:Ze}),this.retainedQueryData[P.bucketInstanceId]=new cu(P.bucketInstanceId,R,P.sourceLayerIndex,P.index,g.tileID);const[Ke,pt]=P.layers[0].layout.get("text-size-scale-range"),mt=o.ay(S,Ke,pt),[It,Nt]=N.get("icon-size-scale-range"),Xt=o.ay(S,It,Nt),ut={bucket:P,layout:N,paint:V,posMatrix:fe,textLabelPlaneMatrix:Fe,labelToScreenMatrix:ke,clippingData:qe,scale:X,textPixelRatio:W,holdingForFade:g.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:o.bH(P.textSizeData,this.transform.zoom,mt),partiallyEvaluatedIconSize:o.bH(P.iconSizeData,this.transform.zoom,Xt),collisionGroup:this.collisionGroups.get(P.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(w)for(const Et of P.sortKeyRanges){const{sortKey:at,symbolInstanceStart:jt,symbolInstanceEnd:wt}=Et;r.push({sortKey:at,symbolInstanceStart:jt,symbolInstanceEnd:wt,parameters:ut})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:ut})}attemptAnchorPlacement(r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye,we){const{textOffset0:De,textOffset1:Le,crossTileID:Ze}=W,Ue=[De,Le],Fe=Er(r,g,w,Ue,S),ke=this.collisionIndex.placeCollisionBox(fe,S,u,dr(Fe.x,Fe.y,P,R,this.transform.angle),X,N,V,G.predicate);if(pe){const qe=fe.getSymbolInstanceIconSize(we,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(fe,qe,pe,dr(Fe.x,Fe.y,P,R,this.transform.angle),X,N,V,G.predicate).box.length===0)return}if(ke.box.length>0){let qe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ze]&&this.prevPlacement.placements[Ze]&&this.prevPlacement.placements[Ze].text&&(qe=this.prevPlacement.variableOffsets[Ze].anchor),this.variableOffsets[Ze]={textOffset:Ue,width:g,height:w,anchor:r,textScale:S,prevAnchor:qe},this.markUsedJustification(fe,r,W,se),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,se,W),this.placedOrientations[Ze]=se),{shift:Fe,placedGlyphBoxes:ke}}}placeLayerBucketPart(r,u,g,w,S=1){const{bucket:P,layout:R,paint:N,posMatrix:V,textLabelPlaneMatrix:G,labelToScreenMatrix:X,clippingData:W,textPixelRatio:Q,holdingForFade:fe,collisionBoxArray:se,partiallyEvaluatedTextSize:pe,partiallyEvaluatedIconSize:ye,collisionGroup:we,latestFeatureIndex:De}=r.parameters,Le=R.get("text-optional"),Ze=R.get("icon-optional"),Ue=R.get("text-allow-overlap"),Fe=R.get("icon-allow-overlap"),ke=R.get("text-rotation-alignment")==="map",qe=R.get("text-pitch-alignment")==="map",Ke=N.get("symbol-z-offset"),pt=R.get("symbol-elevation-reference")==="sea",[mt,It]=R.get("text-size-scale-range"),[Nt,Xt]=R.get("icon-size-scale-range"),ut=o.ay(S,mt,It),Et=o.ay(S,Nt,Xt);this.transform.setProjection(P.projection);let at=Ue&&(Fe||!P.hasIconData()||Ze),jt=Fe&&(Ue||!P.hasTextData()||Le);const wt=!Ke.isConstant();!P.collisionArrays&&se&&P.deserializeCollisionBoxes(se),g&&w&&P.updateCollisionDebugBuffers(this.transform.zoom,se,ut,Et);const Ht=(Ft,rn,Bn)=>{const{crossTileID:Dn,numVerticalGlyphVertices:On}=Ft;let Yn=null;if(W&&W.dynamicFilterNeedsFeature||wt){const Lr=this.retainedQueryData[P.bucketInstanceId];Yn=De.loadFeature({featureIndex:Ft.featureIndex,bucketIndex:Lr.bucketIndex,sourceLayerIndex:Lr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Yn,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new o.P(Ft.tileAnchorX,Ft.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[Dn]=new ts(!1,!1,!1,!0),void u.add(Dn);const ni=Ke.evaluate(Yn,{});if(u.has(Dn))return;if(fe)return void(this.placements[Dn]=new ts(!1,!1,!1));let Rn=!1,Kn=!1,ei=!0,_i=!1,Pi=!1,Yi=null,fr={box:null,offscreen:null,occluded:null},ho={box:null},wi=null,xi=null,fi=null,Pr=0,Io=0,Br=0;Bn.textFeatureIndex?Pr=Bn.textFeatureIndex:Ft.useRuntimeCollisionCircles&&(Pr=Ft.featureIndex),Bn.verticalTextFeatureIndex&&(Io=Bn.verticalTextFeatureIndex);const Gi=Lr=>{Lr.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const Fr=this.transform.elevation;Lr.elevation=pt?ni:ni+(Fr?Fr.getAtTileOffset(Lr.tileID,Lr.tileAnchorX,Lr.tileAnchorY):0),Lr.elevation+=Ft.zOffset},eo=Bn.textBox;if(eo){Gi(eo);const Lr=xr=>{let Gr=o.bI.horizontal;if(P.allowVerticalPlacement&&!xr&&this.prevPlacement){const fo=this.prevPlacement.placedOrientations[Dn];fo&&(this.placedOrientations[Dn]=fo,Gr=fo,this.markUsedOrientation(P,Gr,Ft))}return Gr},Fr=(xr,Gr)=>{if(P.allowVerticalPlacement&&On>0&&Bn.verticalTextBox){for(const fo of P.writingModes)if(fo===o.bI.vertical?(fr=Gr(),ho=fr):fr=xr(),fr&&fr.box&&fr.box.length)break}else fr=xr()};if(R.get("text-variable-anchor")){let xr=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Dn]){const Or=this.prevPlacement.variableOffsets[Dn];xr.indexOf(Or.anchor)>0&&(xr=xr.filter(sr=>sr!==Or.anchor),xr.unshift(Or.anchor))}const Gr=(Or,sr,Ps)=>{const Ys=P.getSymbolInstanceTextSize(pe,Ft,this.transform.zoom,rn),Ml=(Or.x2-Or.x1)*Ys+2*Or.padding,Tc=(Or.y2-Or.y1)*Ys+2*Or.padding,dl=Ft.hasIconTextFit&&!Fe?sr:null;dl&&Gi(dl);let Ks={box:[],offscreen:!1,occluded:!1};const fs=Ue?2*xr.length:xr.length;for(let Sc=0;Sc<fs;++Sc){const ps=this.attemptAnchorPlacement(xr[Sc%xr.length],Or,Ml,Tc,Ys,ke,qe,Q,V,we,Sc>=xr.length,Ft,rn,P,Ps,dl,pe,ye);if(ps&&(Ks=ps.placedGlyphBoxes,Ks&&Ks.box&&Ks.box.length)){Rn=!0,Yi=ps.shift;break}}return Ks};Fr(()=>Gr(eo,Bn.iconBox,o.bI.horizontal),()=>{const Or=Bn.verticalTextBox;return Or&&Gi(Or),P.allowVerticalPlacement&&!(fr&&fr.box&&fr.box.length)&&On>0&&Or?Gr(Or,Bn.verticalIconBox,o.bI.vertical):{box:null,offscreen:null,occluded:null}}),fr&&(Rn=fr.box,ei=fr.offscreen,_i=fr.occluded);const fo=Lr(!(!fr||!fr.box));if(!Rn&&this.prevPlacement){const Or=this.prevPlacement.variableOffsets[Dn];Or&&(this.variableOffsets[Dn]=Or,this.markUsedJustification(P,Or.anchor,Ft,fo))}}else{const xr=(Gr,fo)=>{const Or=P.getSymbolInstanceTextSize(pe,Ft,this.transform.zoom,rn,S),sr=this.collisionIndex.placeCollisionBox(P,Or,Gr,new o.P(0,0),Ue,Q,V,we.predicate);return sr&&sr.box&&sr.box.length&&(this.markUsedOrientation(P,fo,Ft),this.placedOrientations[Dn]=fo),sr};Fr(()=>xr(eo,o.bI.horizontal),()=>{const Gr=Bn.verticalTextBox;return P.allowVerticalPlacement&&On>0&&Gr?(Gi(Gr),xr(Gr,o.bI.vertical)):{box:null,offscreen:null,occluded:null}}),Lr(!!(fr&&fr.box&&fr.box.length))}}if(wi=fr,Rn=wi&&wi.box&&wi.box.length>0,ei=wi&&wi.offscreen,_i=wi&&wi.occluded,Ft.useRuntimeCollisionCircles){const Lr=P.text.placedSymbolArray.get(Ft.centerJustifiedTextSymbolIndex>=0?Ft.centerJustifiedTextSymbolIndex:Ft.verticalPlacedTextSymbolIndex),Fr=o.bJ(P.textSizeData,pe,Lr),xr=R.get("text-padding");xi=this.collisionIndex.placeCollisionCircles(P,Ue,Lr,P.lineVertexArray,P.glyphOffsetArray,Fr,V,G,X,g,qe,we.predicate,Ft.collisionCircleDiameter*Fr/o.bO,xr,this.retainedQueryData[P.bucketInstanceId].tileID),Rn=Ue||xi.circles.length>0&&!xi.collisionDetected,ei=ei&&xi.offscreen,_i=xi.occluded}if(Bn.iconFeatureIndex&&(Br=Bn.iconFeatureIndex),Bn.iconBox){const Lr=Fr=>{Gi(Fr);const xr=Ft.hasIconTextFit&&Yi?dr(Yi.x,Yi.y,ke,qe,this.transform.angle):new o.P(0,0),Gr=P.getSymbolInstanceIconSize(ye,this.transform.zoom,Ft.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,Gr,Fr,xr,Fe,Q,V,we.predicate)};ho&&ho.box&&ho.box.length&&Bn.verticalIconBox?(fi=Lr(Bn.verticalIconBox),Kn=fi.box.length>0):(fi=Lr(Bn.iconBox),Kn=fi.box.length>0),ei=ei&&fi.offscreen,Pi=fi.occluded}const Ki=Le||Ft.numHorizontalGlyphVertices===0&&On===0,jr=Ze||Ft.numIconVertices===0;if(Ki||jr?jr?Ki||(Kn=Kn&&Rn):Rn=Kn&&Rn:Kn=Rn=Kn&&Rn,Rn&&wi&&wi.box&&this.collisionIndex.insertCollisionBox(wi.box,R.get("text-ignore-placement"),P.bucketInstanceId,ho&&ho.box&&Io?Io:Pr,we.ID),Kn&&fi&&this.collisionIndex.insertCollisionBox(fi.box,R.get("icon-ignore-placement"),P.bucketInstanceId,Br,we.ID),xi&&(Rn&&this.collisionIndex.insertCollisionCircles(xi.circles,R.get("text-ignore-placement"),P.bucketInstanceId,Pr,we.ID),g)){const Lr=P.bucketInstanceId;let Fr=this.collisionCircleArrays[Lr];Fr===void 0&&(Fr=this.collisionCircleArrays[Lr]=new Oh);for(let xr=0;xr<xi.circles.length;xr+=4)Fr.circles.push(xi.circles[xr+0]),Fr.circles.push(xi.circles[xr+1]),Fr.circles.push(xi.circles[xr+2]),Fr.circles.push(xi.collisionDetected?1:0)}const qr=P.projection.name!=="globe";at=at&&(qr||!_i),jt=jt&&(qr||!Pi),this.placements[Dn]=new ts(Rn||at,Kn||jt,ei||P.justReloaded),u.add(Dn)},pn=this.retainedQueryData[P.bucketInstanceId].tileID;if(P.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(P,pn),P.elevationType==="road"&&P.updateRoadElevation(pn.canonical),P.updateZOffset(),P.sortFeaturesByY){const Ft=P.getSortedSymbolIndexes(this.transform.angle);for(let rn=Ft.length-1;rn>=0;--rn){const Bn=Ft[rn];Ht(P.symbolInstances.get(Bn),Bn,P.collisionArrays[Bn])}P.hasAnyZOffset&&o.w(`${P.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(P.hasAnyZOffset){const Ft=P.getSortedIndexesByZOffset();for(let rn=0;rn<Ft.length;++rn){const Bn=Ft[rn];Ht(P.symbolInstances.get(Bn),Bn,P.collisionArrays[Bn])}}else for(let Ft=r.symbolInstanceStart;Ft<r.symbolInstanceEnd;Ft++)Ht(P.symbolInstances.get(Ft),Ft,P.collisionArrays[Ft]);if(g&&P.bucketInstanceId in this.collisionCircleArrays){const Ft=this.collisionCircleArrays[P.bucketInstanceId];o.bi(Ft.invProjMatrix,V),Ft.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(r,u,g,w){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:N,crossTileID:V}=g,G=o.bV(u),X=w===o.bI.vertical?N:G==="left"?S:G==="center"?P:G==="right"?R:-1;S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=X>=0&&S!==X?0:V),P>=0&&(r.text.placedSymbolArray.get(P).crossTileID=X>=0&&P!==X?0:V),R>=0&&(r.text.placedSymbolArray.get(R).crossTileID=X>=0&&R!==X?0:V),N>=0&&(r.text.placedSymbolArray.get(N).crossTileID=X>=0&&N!==X?0:V)}markUsedOrientation(r,u,g){const w=u===o.bI.horizontal||u===o.bI.horizontalOnly?u:0,S=u===o.bI.vertical?u:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:V}=g,G=r.text.placedSymbolArray;P>=0&&(G.get(P).placedOrientation=w),R>=0&&(G.get(R).placedOrientation=w),N>=0&&(G.get(N).placedOrientation=w),V>=0&&(G.get(V).placedOrientation=S)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const w=u?u.symbolFadeChange(r):1,S=u?u.opacities:{},P=u?u.variableOffsets:{},R=u?u.placedOrientations:{};for(const N in this.placements){const V=this.placements[N],G=S[N];G?(this.opacities[N]=new es(G,w,V.text,V.icon,null,V.clipped),g=g||V.text!==G.text.placed||V.icon!==G.icon.placed):(this.opacities[N]=new es(null,w,V.text,V.icon,V.skipFade,V.clipped),g=g||V.text||V.icon)}for(const N in S){const V=S[N];if(!this.opacities[N]){const G=new es(V,w,!1,!1);G.isHidden()||(this.opacities[N]=G,g=g||V.text.placed||V.icon.placed)}}for(const N in P)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=P[N]);for(const N in R)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=R[N]);g?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u,g,w){const S=new Set;for(const P of u){const R=P.getBucket(r);R&&P.latestFeatureIndex&&r.fqid===R.layerIds[0]&&(this.updateBucketOpacities(R,S,P,P.collisionBoxArray,g,w,P.tileID,r.scope),R.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(R,P.tileID),R.elevationType==="road"&&R.updateRoadElevation(P.tileID.canonical),R.updateZOffset())}}updateBucketOpacities(r,u,g,w,S,P,R,N){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const V=r.layers[0].layout,G=r.layers[0].paint,X=!!r.layers[0].dynamicFilter(),W=new es(null,0,!1,!1,!0),Q=V.get("text-allow-overlap"),fe=V.get("icon-allow-overlap"),se=V.get("text-variable-anchor"),pe=V.get("text-rotation-alignment")==="map",ye=V.get("text-pitch-alignment")==="map",we=G.get("symbol-z-offset"),De=V.get("symbol-elevation-reference")==="sea",Le=!we.isConstant(),Ze=new es(null,0,Q&&(fe||!r.hasIconData()||V.get("icon-optional")),fe&&(Q||!r.hasTextData()||V.get("text-optional")),!0);!r.collisionArrays&&w&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(w);const Ue=(ke,qe,Ke)=>{for(let pt=0;pt<qe/4;pt++)ke.opacityVertexArray.emplaceBack(Ke)};let Fe=0;P&&r.updateReplacement(R,P);for(let ke=0;ke<r.symbolInstances.length;ke++){const qe=r.symbolInstances.get(ke),{numHorizontalGlyphVertices:Ke,numVerticalGlyphVertices:pt,crossTileID:mt,numIconVertices:It,tileAnchorX:Nt,tileAnchorY:Xt}=qe;let ut=null;const Et=this.retainedQueryData[r.bucketInstanceId];Le&&qe&&Et&&(ut=g.latestFeatureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:Et.bucketIndex,sourceLayerIndex:Et.sourceLayerIndex,layoutVertexArrayOffset:0}));const at=we.evaluate(ut,{}),jt=u.has(mt);let wt=this.opacities[mt];jt?wt=W:wt||(wt=Ze,this.opacities[mt]=wt),u.add(mt);const Ht=Ke>0||pt>0,pn=It>0,Ft=this.placedOrientations[mt],rn=Ft===o.bI.vertical,Bn=Ft===o.bI.horizontal||Ft===o.bI.horizontalOnly;!Ht&&!pn||wt.isHidden()||Fe++;let Dn=!1;if((Ht||pn)&&P)for(const On of r.activeReplacements){if(o.bP(On,S,o.bQ.Symbol,N)||On.min.x>Nt||Nt>On.max.x||On.min.y>Xt||Xt>On.max.y)continue;const Yn=o.bR(Nt,Xt,R.canonical,On.footprintTileId.canonical);if(Dn=o.bS(Yn,On.footprint),Dn)break}if(Ht){const On=Dn?fa:zl(wt.text);Ue(r.text,Ke,rn?fa:On),Ue(r.text,pt,Bn?fa:On);const Yn=wt.text.isHidden(),{leftJustifiedTextSymbolIndex:ni,centerJustifiedTextSymbolIndex:Rn,rightJustifiedTextSymbolIndex:Kn,verticalPlacedTextSymbolIndex:ei}=qe,_i=r.text.placedSymbolArray,Pi=Yn||rn?1:0;ni>=0&&(_i.get(ni).hidden=Pi),Rn>=0&&(_i.get(Rn).hidden=Pi),Kn>=0&&(_i.get(Kn).hidden=Pi),ei>=0&&(_i.get(ei).hidden=Yn||Bn?1:0);const Yi=this.variableOffsets[mt];Yi&&this.markUsedJustification(r,Yi.anchor,qe,Ft);const fr=this.placedOrientations[mt];fr&&(this.markUsedJustification(r,"left",qe,fr),this.markUsedOrientation(r,fr,qe))}if(pn){const On=Dn?fa:zl(wt.icon),{placedIconSymbolIndex:Yn,verticalPlacedIconSymbolIndex:ni}=qe,Rn=r.icon.placedSymbolArray,Kn=wt.icon.isHidden()?1:0;Yn>=0&&(Ue(r.icon,It,rn?fa:On),Rn.get(Yn).hidden=Kn),ni>=0&&(Ue(r.icon,qe.numVerticalIconVertices,Bn?fa:On),Rn.get(ni).hidden=Kn)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const On=r.collisionArrays[ke];if(On){let Yn=new o.P(0,0),ni=!0;if(On.textBox||On.verticalTextBox){if(se){const Kn=this.variableOffsets[mt];Kn?(Yn=Er(Kn.anchor,Kn.width,Kn.height,Kn.textOffset,Kn.textScale),pe&&Yn._rotate(ye?this.transform.angle:-this.transform.angle)):ni=!1}X&&(ni=!wt.clipped),On.textBox&&Nc(r.textCollisionBox.collisionVertexArray,wt.text.placed,!ni||rn,at,De,Yn.x,Yn.y),On.verticalTextBox&&Nc(r.textCollisionBox.collisionVertexArray,wt.text.placed,!ni||Bn,at,De,Yn.x,Yn.y)}const Rn=ni&&!!(!Bn&&On.verticalIconBox);On.iconBox&&Nc(r.iconCollisionBox.collisionVertexArray,wt.icon.placed,Rn,at,De,qe.hasIconTextFit?Yn.x:0,qe.hasIconTextFit?Yn.y:0),On.verticalIconBox&&Nc(r.iconCollisionBox.collisionVertexArray,wt.icon.placed,!Rn,at,De,qe.hasIconTextFit?Yn.x:0,qe.hasIconTextFit?Yn.y:0)}}}if(r.fullyClipped=Fe===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=ke.invProjMatrix,r.placementViewportMatrix=ke.viewportMatrix,r.collisionCircleArray=ke.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>r}setStale(){this.stale=!0}}function Nc(m,r,u,g,w,S,P){m.emplaceBack(r?1:0,u?1:0,S||0,P||0,g,w?1:0),m.emplaceBack(r?1:0,u?1:0,S||0,P||0,g,w?1:0),m.emplaceBack(r?1:0,u?1:0,S||0,P||0,g,w?1:0),m.emplaceBack(r?1:0,u?1:0,S||0,P||0,g,w?1:0)}const vr=Math.pow(2,25),_f=Math.pow(2,24),Ih=Math.pow(2,17),Dh=Math.pow(2,16),ns=Math.pow(2,9),Eo=Math.pow(2,8),Fg=Math.pow(2,1);function zl(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const r=m.placed?1:0,u=Math.floor(127*m.opacity);return u*vr+r*_f+u*Ih+r*Dh+u*ns+r*Eo+u*Fg+r}const fa=0;class Rh{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,u,g,w,S,P){const R=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(R,w,r[this._currentTileIndex],this._sortAcrossTiles,P),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((N,V)=>N.sortKey-V.sortKey));this._currentPartIndex<R.length;){const N=R[this._currentPartIndex];if(u.placeLayerBucketPart(N,this._seenCrossTileIDs,g,N.symbolInstanceStart===0,P),this._currentPartIndex++,S())return!0}return!1}}class Lh{constructor(r,u,g,w,S,P,R,N,V){this.placement=new cl(r,S,P,R,N,V),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(r,u,g,w,S){const P=o.q.now(),R=()=>{const N=o.q.now()-P;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=u[r[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=V)&&(!N.maxzoom||N.maxzoom>V)){const G=N,X=G.layout.get("symbol-z-elevate"),W=G.layout.get("symbol-sort-key").constantOr(1)!==void 0,Q=G.layout.get("symbol-z-order"),fe=Q==="viewport-y"||Q==="auto"&&!(Q!=="viewport-y"&&W),se=G.layout.get("text-allow-overlap")||G.layout.get("icon-allow-overlap")||G.layout.get("text-ignore-placement")||G.layout.get("icon-ignore-placement"),pe=fe&&se,ye=this._inProgressLayer=this._inProgressLayer||new Rh(G),we=o.C(N.source,N.scope);if(ye.continuePlacement(X||pe?w[we]:g[we],this.placement,this._showCollisionBoxes,N,R,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const zh=512/o.aj/2;class Yu{constructor(r,u,g){this.tileID=r,this.bucketInstanceId=g,this.index=new o.bW(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=r.canonical.x*o.aj,S=r.canonical.y*o.aj;for(let P=0;P<u.length;P++){const{key:R,crossTileID:N,tileAnchorX:V,tileAnchorY:G}=u.get(P),X=Math.floor((w+V)*zh),W=Math.floor((S+G)*zh);this.index.add(X,W),this.keys.push(R),this.crossTileIDs.push(N)}this.index.finish()}findMatches(r,u,g){const w=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),S=zh/Math.pow(2,u.canonical.z-this.tileID.canonical.z),P=u.canonical.x*o.aj,R=u.canonical.y*o.aj;for(let N=0;N<r.length;N++){const V=r.get(N);if(V.crossTileID)continue;const{key:G,tileAnchorX:X,tileAnchorY:W}=V,Q=Math.floor((P+X)*S),fe=Math.floor((R+W)*S),se=this.index.range(Q-w,fe-w,Q+w,fe+w).sort((pe,ye)=>pe-ye);for(const pe of se){const ye=this.crossTileIDs[pe];if(this.keys[pe]===G&&!g.has(ye)){g.add(ye),V.crossTileID=ye;break}}}}}class is{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(u!==0)for(const g in this.indexes){const w=this.indexes[g],S={};for(const P in w){const R=w[P];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+u),S[R.tileID.key]=R}this.indexes[g]=S}this.lng=r}addBucket(r,u,g){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let S=0;S<u.symbolInstances.length;S++)u.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const w=this.usedCrossTileIDs[r.overscaledZ];for(const S in this.indexes){const P=this.indexes[S];if(Number(S)>r.overscaledZ)for(const R in P){const N=P[R];N.tileID.isChildOf(r)&&N.findMatches(u.symbolInstances,r,w)}else{const R=P[r.scaledTo(Number(S)).key];R&&R.findMatches(u.symbolInstances,r,w)}}for(let S=0;S<u.symbolInstances.length;S++){const P=u.symbolInstances.get(S);P.crossTileID||(P.crossTileID=g.generate(),w.add(P.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Yu(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[r].delete(g)}removeStaleBuckets(r){let u=!1;for(const g in this.indexes){const w=this.indexes[g];for(const S in w)r[w[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,w[S]),delete w[S],u=!0)}return u}}class Ha{constructor(){this.layerIndexes={},this.crossTileIDs=new is,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,g,w){let S=this.layerIndexes[r.fqid];S===void 0&&(S=this.layerIndexes[r.fqid]=new rc);let P=!1;const R={};w.name!=="globe"&&S.handleWrapJump(g);for(const N of u){const V=N.getBucket(r);V&&r.fqid===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(N.tileID,V,this.crossTileIDs)&&(P=!0),R[V.bucketInstanceId]=!0)}return S.removeStaleBuckets(R)&&(P=!0),P}pruneUnusedLayers(r){const u={};r.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const uu=771;class Ri{constructor(r,u,g,w){this.blendFunction=r,this.blendColor=u.toNonPremultipliedRenderColor(null),this.mask=g,this.blendEquation=w}}Ri.Replace=[1,0,1,0],Ri.disabled=new Ri(Ri.Replace,o.am.transparent,[!1,!1,!1,!1]),Ri.unblended=new Ri(Ri.Replace,o.am.transparent,[!0,!0,!0,!0]),Ri.alphaBlended=new Ri([1,uu,1,uu],o.am.transparent,[!0,!0,!0,!0]),Ri.alphaBlendedNonPremultiplied=new Ri([770,uu,770,uu],o.am.transparent,[!0,!0,!0,!0]),Ri.multiply=new Ri([774,0,774,0],o.am.transparent,[!0,!0,!0,!0]);class Tn{constructor(r,u,g){this.func=r,this.mask=u,this.range=g}}Tn.ReadOnly=!1,Tn.ReadWrite=!0,Tn.disabled=new Tn(519,Tn.ReadOnly,[0,1]);const ds=7680;class di{constructor(r,u,g,w,S,P){this.test=r,this.ref=u,this.mask=g,this.fail=w,this.depthFail=S,this.pass=P}}di.disabled=new di({func:519,mask:0},0,0,ds,ds,ds);const Vr=1029,Bc=2305;class li{constructor(r,u,g){this.enable=r,this.mode=u,this.frontFace=g}}function jc(m,r){const u=o.c1(m,3);o.c3(m,r),o.c7(m,3,u)}function Zl(m,r){const u=o.b_([]);return o.b$(u,u,-r),o.c0(u,u,-m),u}function oc(m,r){const u=[m[0],m[1],0],g=[r[0],r[1],0];if(o.ae(u)>=1e-15){const P=o.au([],u);o.bY(g,P,o.bG(g,P)),r[0]=g[0],r[1]=g[1]}const w=o.bF([],r,m);if(o.bZ(w)<1e-15)return null;const S=Math.atan2(-w[1],w[0]);return Zl(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}li.disabled=new li(!1,Vr,Bc),li.backCCW=new li(!0,Vr,Bc),li.backCW=new li(!0,Vr,2304),li.frontCW=new li(!0,1028,2304),li.frontCCW=new li(!0,1028,Bc);class Ku{constructor(r,u){this.position=r,this.orientation=u}get position(){return this._position}set position(r){if(r){const u=r instanceof o.ac?r:new o.ac(r[0],r[1],r[2]);this._renderWorldCopies&&(u.x=o.bX(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(r,u){if(this.orientation=null,!this.position)return;const g=this.position,w=this._elevation?this._elevation.getAtPointOrZero(o.ac.fromLngLat(r)):0,S=o.ac.fromLngLat(r,w),P=[S.x-g.x,S.y-g.y,S.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=oc(P,u)}setPitchBearing(r,u){this.orientation=Zl(o.al(r),o.al(-u))}}class ul{constructor(r,u){this._transform=o.bx([]),this.orientation=u,this.position=r}get mercatorPosition(){const r=this.position;return new o.ac(r[0],r[1],r[2])}get position(){const r=o.c1(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var u;r&&o.c7(this._transform,3,[(u=r)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.b_([]),r&&jc(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,u){this._orientation=Zl(r,u),jc(this._transform,this._orientation)}forward(){const r=o.c1(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.c1(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.c1(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,u){const g=new Float64Array(16);return o.bi(g,this.getWorldToCamera(r,u)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,u,g){const w=this.position;o.bY(w,w,-r);const S=new Float64Array(16);return o.bn(S,[g,g,g]),o.bo(S,S,w),S[10]*=u,S}getWorldToCamera(r,u){const g=new Float64Array(16),w=new Float64Array(4),S=this.position;return o.c2(w,this._orientation),o.bY(S,S,-r),o.c3(g,w),o.bo(g,g,S),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(r,u,g,w){const S=new Float64Array(16);return o.c4(S,r,u,g,w),S}getCameraToClipOrthographic(r,u,g,w,S,P){const R=new Float64Array(16);return o.c5(R,r,u,g,w,S,P),R}getDistanceToElevation(r,u=!1){const g=r===0?0:o.c6(r,u?o.aY(this.position[1]):this.position[1]),w=this.forward();return(g-this.position[2])/w[2]}clone(){return new ul([...this.position],[...this.orientation])}}const la={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Fc{constructor(r=0,u=0,g=0,w=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=g,this.right=w}interpolate(r,u,g){return u.top!=null&&r.top!=null&&(this.top=o.ai(r.top,u.top,g)),u.bottom!=null&&r.bottom!=null&&(this.bottom=o.ai(r.bottom,u.bottom,g)),u.left!=null&&r.left!=null&&(this.left=o.ai(r.left,u.left,g)),u.right!=null&&r.right!=null&&(this.right=o.ai(r.right,u.right,g)),this}getCenter(r,u){const g=o.ay((this.left+r-this.right)/2,0,r),w=o.ay((this.top+u-this.bottom)/2,0,u);return new o.P(g,w)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Fc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ia=15;class Ad{constructor(r,u,g,w,S,P,R){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=w??60,this.setProjection(P),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new o.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Fc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ul,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const r=new Ad(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r._allowWorldUnderZoom=this._allowWorldUnderZoom,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Ia}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(r||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return o.aF(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=o.ce(this.projectionOptions);const g=this.getProjection(),w=!o.bv(u,g);return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.ce({name:"mercator"});const u=r!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bX(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const u=-r*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=o.cf(),o.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=o.ay(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.al(r),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const r=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(r)}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let w=0,S=0;for(let P=0;P<u.length;P++){const R=new o.P(u[P][0]*this.width,g+u[P][1]*(this.height-g)),N=r.pointCoordinate(R);if(!N)continue;const V=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);w+=N[3]*V,S+=V}return S===0?NaN:w/S}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,w=this._mercatorZfromZoom(r),S=this._mercatorZfromZoom(this._maxZoom),P=Math.max(w-g,S);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let g;g=r.z<this._camera.position[2]?[u.x,u.y,u.z]:[r.x,r.y,r.z];const w=o.ae(o.at([],this._camera.position,g));return o.ay(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let u=!1;if(r.orientation&&!o.ch(r.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(r.orientation)),r.position){const g=[r.position.x,r.position.y,r.position.z];o.ci(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,u=new Ku;return u.position=new o.ac(r[0],r[1],r[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(r){if(!o.cj(r))return!1;o.ck(r,r);const u=o.cl([],[0,0,-1],r),g=o.cl([],[0,-1,0],r);if(g[2]<0)return!1;const w=oc(u,g);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(r){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;r[2]=o.ay(r[2],w/g,w/u),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,g){this._unmodified=!1,this._edgeInsets.interpolate(r,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new o.cm(0,r)];if(this.renderWorldCopies){const g=this.pointCoordinate(new o.P(0,0)),w=this.pointCoordinate(new o.P(this.width,0)),S=this.pointCoordinate(new o.P(this.width,this.height)),P=this.pointCoordinate(new o.P(0,this.height)),R=Math.floor(Math.min(g.x,w.x,S.x,P.x)),N=Math.floor(Math.max(g.x,w.x,S.x,P.x)),V=1;for(let G=R-V;G<=N+V;G++)G!==0&&u.push(new o.cm(G,r))}return u}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,u,g){let w=[];const S=g!=null,P=!S;if(P&&this.zoom<u||S&&g[0]===0&&g[1]===0)return w;const R=new Set,N=(G,X,W,Q,fe)=>{const se=o.cK(X,G,W,Q,fe);R.has(se)||(w.push(new o.aM(G,X,W,Q,fe)),R.add(se))};for(let G=0;G<r.length;G++){const X=r[G];if(P&&X.canonical.z!==u)continue;const W=X.canonical,Q=X.overscaledZ,fe=X.wrap,se=1<<W.z,pe=W.x+1<se,ye=W.x>0,we=W.y+1<se,De=W.y>0,Le=X.wrap-(ye?0:1),Ze=X.wrap+(pe?0:1),Ue=ye?W.x-1:se-1,Fe=pe?W.x+1:0;if(S)g[0]<0?(N(Q,Ze,W.z,Fe,W.y),g[1]<0&&we&&(N(Q,fe,W.z,W.x,W.y+1),N(Q,Ze,W.z,Fe,W.y+1)),g[1]>0&&De&&(N(Q,fe,W.z,W.x,W.y-1),N(Q,Ze,W.z,Fe,W.y-1))):g[0]>0?(N(Q,Le,W.z,Ue,W.y),g[1]<0&&we&&(N(Q,fe,W.z,W.x,W.y+1),N(Q,Le,W.z,Ue,W.y+1)),g[1]>0&&De&&(N(Q,fe,W.z,W.x,W.y-1),N(Q,Le,W.z,Ue,W.y-1))):g[1]<0&&we?N(Q,fe,W.z,W.x,W.y+1):De&&N(Q,fe,W.z,W.x,W.y-1);else{const ke=X.visibleQuadrants;1&ke&&(N(Q,Le,W.z,Ue,W.y),De&&(N(Q,fe,W.z,W.x,W.y-1),N(Q,Le,W.z,Ue,W.y-1))),2&ke&&(N(Q,Ze,W.z,Fe,W.y),De&&(N(Q,fe,W.z,W.x,W.y-1),N(Q,Ze,W.z,Fe,W.y-1))),4&ke&&(N(Q,Le,W.z,Ue,W.y),we&&(N(Q,fe,W.z,W.x,W.y+1),N(Q,Le,W.z,Ue,W.y+1))),8&ke&&(N(Q,Ze,W.z,Fe,W.y),we&&(N(Q,fe,W.z,W.x,W.y+1),N(Q,Ze,W.z,Fe,W.y+1)))}}const V=[];for(const G of w)w.some(X=>G.isChildOf(X))||V.push(G);if(w=V.filter(G=>!r.some(X=>!!(G.overscaledZ<u&&X.isChildOf(G))||G.equals(X)||G.isChildOf(X))),P){const G=1<<u,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[G*X.x,G*X.y],Q=4,fe=Q*Q;w=w.filter(se=>{const pe=se.canonical.x+.5-W[0],ye=se.canonical.y+.5-W[1];return pe*pe+ye*ye<fe})}return w}coveringTiles(r){let u=this.coveringZoomLevel(r);const g=u,w=this.elevation&&this.elevation.exaggeration(),S=w&&!r.isTerrainDEM,P=this.projection.name==="mercator";if(r.minzoom!==void 0&&u<r.minzoom)return[];r.maxzoom!==void 0&&u>r.maxzoom&&(u=r.maxzoom);const R=this.locationCoordinate(this.center),N=this.center.lat,V=1<<u,G=[V*R.x,V*R.y,0],X=this.projection.name==="globe",W=!X,Q=o.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,W),fe=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),se=V*o.c6(1,this.center.lat),pe=this._camera.position[2]/o.c6(1,this.center.lat),ye=[V*fe.x,V*fe.y,pe*(W?1:se)],we=X||w,De=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Le=this.isLODDisabled(!0)?u:0;let Ze;if(this._elevation&&r.isTerrainDEM)Ze=1e4*this._elevation.exaggeration();else if(this._elevation){const at=this._elevation.getMinMaxForVisibleTiles();Ze=at?at.max:this._centerAltitude}else Ze=this._centerAltitude;const Ue=r.isTerrainDEM?-Ze:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?o.co(this):1,ke=at=>{const wt=new o.ac(at.x+25e-6,at.y,at.z),Ht=new o.ac(at.x,at.y+25e-6,at.z),pn=at.toLngLat(),Ft=wt.toLngLat(),rn=Ht.toLngLat(),Bn=this.locationCoordinate(pn),Dn=this.locationCoordinate(Ft),On=this.locationCoordinate(rn),Yn=Math.hypot(Dn.x-Bn.x,Dn.y-Bn.y),ni=Math.hypot(On.x-Bn.x,On.y-Bn.y);return Math.sqrt(Yn*ni)*Fe/25e-6},qe=at=>{const jt=Ze,wt=Ue;return{aabb:o.cr(this,V,0,0,0,at,wt,jt,this.projection),zoom:0,x:0,y:0,minZ:wt,maxZ:jt,wrap:at,fullyVisible:!1}},Ke=[];let pt=[];const mt=u,It=r.reparseOverscaled?g:u,Nt=(pe-this._centerAltitude)*se,Xt=at=>{if(!this._elevation||!at.tileID||!P)return;const jt=this._elevation.getMinMaxForTile(at.tileID),wt=at.aabb;jt?(wt.min[2]=jt.min,wt.max[2]=jt.max,wt.center[2]=(wt.min[2]+wt.max[2])/2):(at.shouldSplit=Et(at),at.shouldSplit||(wt.min[2]=wt.max[2]=wt.center[2]=this._centerAltitude))},ut=(at,jt)=>{if(.707*jt<at)return 1;const wt=jt/at;return wt/(1.4144271570014144+(Math.pow(1.1,wt-1.4144271570014144+1)-1)/(1.1-1)-1)},Et=at=>{if(at.zoom<Le)return!0;if(at.zoom===mt)return!1;if(at.shouldSplit!=null)return at.shouldSplit;const jt=at.aabb.distanceX(ye),wt=at.aabb.distanceY(ye);let Ht=Nt,pn=1;if(X){Ht=at.aabb.distanceZ(ye);const ni=Math.pow(2,at.zoom),Rn=o.aY((at.y+1)/ni),Kn=o.aY(at.y/ni),ei=Math.min(Math.max(N,Rn),Kn),_i=o.cO(ei)/o.cO(N);if(pn=ei===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,_i/this._mercatorScaleRatio),this.zoom<=o.cL&&at.zoom===mt-1&&_i>=.9)return!0}else if(S&&(Ht=at.aabb.distanceZ(ye)*se),this.projection.isReprojectedInTileSpace&&g<=5){const ni=Math.pow(2,at.zoom),Rn=ke(new o.ac((at.x+.5)/ni,(at.y+.5)/ni));pn=Rn>.85?1:Rn}if(!P){const ni=Math.sqrt(jt*jt+wt*wt+Ht*Ht);let Rn=(1<<mt-at.zoom)*De*pn;return Rn*=ut(Math.max(Ht,Nt),ni),ni<Rn}let Ft=Number.MAX_VALUE,rn=0;const Bn=at.aabb.getCorners(),Dn=[];for(const ni of Bn){o.at(Dn,ni,ye),X||(S?Dn[2]*=se:Dn[2]=Nt);const Rn=o.bG(Dn,this._camera.forward());Rn<Ft&&(Ft=Rn,rn=Math.abs(Dn[2]))}let On=(1<<mt-at.zoom)*De*pn;if(On*=ut(Math.max(rn,Nt),Ft),Ft<On)return!0;const Yn=at.aabb.closestPoint(G);return Yn[0]===G[0]&&Yn[1]===G[1]};if(this.renderWorldCopies)for(let at=1;at<=3;at++)Ke.push(qe(-at)),Ke.push(qe(at));for(Ke.push(qe(0));Ke.length>0;){const at=Ke.pop(),jt=at.x,wt=at.y;let Ht=at.fullyVisible;const pn=()=>this.projection.name==="globe"&&(at.y===0||at.y===(1<<at.zoom)-1);if(!Ht){let Ft=we?at.aabb.intersects(Q):at.aabb.intersectsFlat(Q);if(Ft===0&&pn()){const rn=new o.cp(at.zoom,jt,wt);Ft=o.cq(this,V,rn,!0).intersects(Q)}if(Ft===0)continue;Ht=Ft===2}if(at.zoom!==mt&&Et(at))for(let Ft=0;Ft<4;Ft++){const rn=(jt<<1)+Ft%2,Bn=(wt<<1)+(Ft>>1),Dn={aabb:P?at.aabb.quadrant(Ft):o.cr(this,V,at.zoom+1,rn,Bn,at.wrap,at.minZ,at.maxZ,this.projection),zoom:at.zoom+1,x:rn,y:Bn,wrap:at.wrap,fullyVisible:Ht,tileID:void 0,shouldSplit:void 0,minZ:at.minZ,maxZ:at.maxZ};S&&!X&&(Dn.tileID=new o.aM(at.zoom+1===mt?It:at.zoom+1,at.wrap,at.zoom+1,rn,Bn),Xt(Dn)),Ke.push(Dn)}else{const Ft=at.zoom===mt?It:at.zoom;if(r.minzoom&&r.minzoom>Ft)continue;let rn=0;if(!Ht){let Yn=we?at.aabb.intersectsPrecise(Q):at.aabb.intersectsPreciseFlat(Q);if(Yn===0&&pn()){const ni=new o.cp(at.zoom,jt,wt);Yn=o.cq(this,V,ni,!0).intersectsPrecise(Q)}if(Yn===0)continue;if(r.calculateQuadrantVisibility)if(Q.containsPoint(at.aabb.center))rn=15;else for(let ni=0;ni<4;ni++)at.aabb.quadrant(ni).intersects(Q)!==0&&(rn|=1<<ni)}const Bn=G[0]-(.5+jt+(at.wrap<<at.zoom))*(1<<u-at.zoom),Dn=G[1]-.5-wt,On=at.tileID?at.tileID:new o.aM(Ft,at.wrap,at.zoom,jt,wt);r.calculateQuadrantVisibility&&(On.visibleQuadrants=rn),pt.push({tileID:On,distanceSq:Bn*Bn+Dn*Dn})}}if(this.fogCullDistSq){const at=this.fogCullDistSq,jt=this.horizonLineFromTop();pt=pt.filter(wt=>{const Ht=[0,0,0,1],pn=[o.aj,o.aj,0,1],Ft=this.calculateFogTileMatrix(wt.tileID.toUnwrapped());o.aA(Ht,Ht,Ft),o.aA(pn,pn,Ft);const rn=o.cs([],Ht,pn),Bn=o.ct([],Ht,pn),Dn=o.cM(rn,Bn);if(Dn===0)return!0;let On=!1;const Yn=this._elevation;if(Yn&&Dn>at&&jt!==0){const ni=this.calculateProjMatrix(wt.tileID.toUnwrapped());let Rn;r.isTerrainDEM||(Rn=Yn.getMinMaxForTile(wt.tileID)),Rn||(Rn={min:Ue,max:Ze});const Kn=o.cu(this.rotation),ei=[Kn[0]*o.aj,Kn[1]*o.aj,Rn.max];o.ad(ei,ei,ni),On=(1-ei[1])*this.height*.5<jt}return Dn<at||On})}return pt.sort((at,jt)=>at.distanceSq-jt.distanceSq).map(at=>at.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=o.ay(r.lat,-85.051129,o.cv),g=this.projection.project(r.lng,u);return new o.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,u){let g,w;const S=this.centerPoint;if(this.projection.name==="globe"){const R=this.worldSize;g=(u.x-S.x)/R,w=(u.y-S.y)/R}else{const R=this.pointCoordinate(u),N=this.pointCoordinate(S);g=R.x-N.x,w=R.y-N.y}const P=this.locationCoordinate(r);this.setLocation(new o.ac(P.x-g,P.y-w))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r,u){return this.projection.locationPoint(this,r,u)}locationPoint3D(r,u){return this.projection.locationPoint(this,r,u,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r,u){return this.coordinateLocation(this.pointCoordinate3D(r,u))}locationCoordinate(r,u){const g=u?o.c6(u,r.lat):void 0,w=this.projection.project(r.lng,r.lat);return new o.ac(w.x,w.y,g)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,u){const g=u??this._centerAltitude,w=[r.x,r.y,0,1],S=[r.x,r.y,1,1];o.aA(w,w,this.pixelMatrixInverse),o.aA(S,S,this.pixelMatrixInverse);const P=S[3];o.cw(w,w,1/w[3]),o.cw(S,S,1/P);const R=w[2],N=S[2];return{p0:w,p1:S,t:R===N?0:(g-R)/(N-R)}}screenPointToMercatorRay(r){const u=[r.x,r.y,0,1],g=[r.x,r.y,1,1];return o.aA(u,u,this.pixelMatrixInverse),o.aA(g,g,this.pixelMatrixInverse),o.cw(u,u,1/u[3]),o.cw(g,g,1/g[3]),u[2]=o.c6(u[2],this._center.lat)*this.worldSize,g[2]=o.c6(g[2],this._center.lat)*this.worldSize,o.cw(u,u,1/this.worldSize),o.cw(g,g,1/this.worldSize),new o.av([u[0],u[1],u[2]],o.au([],o.at([],g,u)))}rayIntersectionCoordinate(r){const{p0:u,p1:g,t:w}=r,S=o.c6(u[2],this._center.lat),P=o.c6(g[2],this._center.lat);return new o.ac(o.ai(u[0],g[0],w)/this.worldSize,o.ai(u[1],g[1],w)/this.worldSize,o.ai(S,P,w))}pointCoordinate(r,u=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,u)}pointCoordinate3D(r,u){if(!this.elevation)return this.pointCoordinate(r,u);let g=this.projection.pointCoordinate3D(this,r.x,r.y);if(g)return new o.ac(g[0],g[1],g[2]);let w=0,S=this.horizonLineFromTop();if(r.y>S)return this.pointCoordinate(r,u);const P=.02*S,R=r.clone();for(let N=0;N<10&&S-w>P;N++){R.y=o.ai(w,S,.66);const V=this.projection.pointCoordinate3D(this,R.x,R.y);V?(S=R.y,g=V):w=R.y}return g?new o.ac(g[0],g[1],g[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.cx)return!this.isPointAboveHorizon(r);const u=this.pointCoordinate(r);return u.y>=0&&u.y<=1}_coordinatePoint(r,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,w=[r.x*this.worldSize,r.y*this.worldSize,g+r.toAltitude(),1];return o.aA(w,w,this.pixelMatrix),w[3]>0?new o.P(w[0]/w[3],w[1]/w[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,S=this.pointLocation3D(new o.P(u,r)),P=this.pointLocation3D(new o.P(w,r)),R=this.pointLocation3D(new o.P(w,g)),N=this.pointLocation3D(new o.P(u,g));let V=Math.min(S.lng,P.lng,R.lng,N.lng),G=Math.max(S.lng,P.lng,R.lng,N.lng),X=Math.min(S.lat,P.lat,R.lat,N.lat),W=Math.max(S.lat,P.lat,R.lat,N.lat);const Q=Math.pow(2,-this.zoom)/16*270,fe=this.projection.name==="globe"?1:4,se=(pe,ye,we,De,Le)=>{const Ze=(pe+we)/2,Ue=(ye+De)/2,Fe=new o.P(Ze,Ue),{lng:ke,lat:qe}=this.pointLocation3D(Fe),Ke=Math.max(0,V-ke,X-qe,ke-G,qe-W);V=Math.min(V,ke),G=Math.max(G,ke),X=Math.min(X,qe),W=Math.max(W,qe),(Le<fe||Ke>Q)&&(se(pe,ye,Ze,Ue,Le+1),se(Ze,Ue,we,De,Le+1))};if(se(u,r,w,r,1),se(w,r,w,g,1),se(w,g,u,g,1),se(u,g,u,r,1),this.projection.name==="globe"){const[pe,ye]=o.cy(this);pe?(W=90,G=180,V=-180):ye&&(X=-90,G=180,V=-180)}return new o.aG(new o.cd(V,X),new o.cd(G,W))}_getBoundsRectangular(r,u){const{top:g,left:w}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,R=new o.P(w,g),N=new o.P(P,g),V=new o.P(P,S),G=new o.P(w,S);let X=this.pointCoordinate(R,r),W=this.pointCoordinate(N,r);const Q=this.pointCoordinate(V,u),fe=this.pointCoordinate(G,u),se=(pe,ye)=>(ye.y-pe.y)/(ye.x-pe.x);return X.y>1&&W.y>=0?X=new o.ac((1-fe.y)/se(fe,X)+fe.x,1):X.y<0&&W.y<=1&&(X=new o.ac(-fe.y/se(fe,X)+fe.x,0)),W.y>1&&X.y>=0?W=new o.ac((1-Q.y)/se(Q,W)+Q.x,1):W.y<0&&X.y<=1&&(W=new o.ac(-Q.y/se(Q,W)+Q.x,0)),new o.aG().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=r.visibleDemTiles.reduce((g,w)=>{if(w.dem){const S=w.dem.tree;g.min=Math.min(g.min,S.minimums[0]),g.max=Math.max(g.max,S.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*r.exaggeration(),u.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return r?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-85.051129,this.maxLat=o.cv,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.aD(this.minLng)*this.tileSize,this.worldMaxX=o.aD(this.maxLng)*this.tileSize,this.worldMinY=o.aH(this.maxLat)*this.tileSize,this.worldMaxY=o.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,u){return this.projection.createTileMatrix(this,u,r)}calculateDistanceTileData(r){const u=r.key,g=this._distanceTileDataCache;if(g[u])return g[u];const w=r.canonical,S=1/this.height,P=this.cameraWorldSize,R=P/this.zoomScale(w.z),N=(w.x+Math.pow(2,w.z)*r.wrap)*R,V=w.y*R,G=this.point;G.x*=P/this.worldSize,G.y*=P/this.worldSize;const X=this.angle,W=Math.sin(-X),Q=-Math.cos(-X);return g[u]={bearing:[W,Q],center:[(G.x-N)*S,(G.y-V)*S],scale:R/o.aj*S},g[u]}calculateFogTileMatrix(r){const u=r.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.az(w,this.worldToFogMatrix,w),g[u]=new Float32Array(w),g[u]}calculateProjMatrix(r,u=!1,g=!1){const w=r.key;let S;if(S=g?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,S[w])return S[w];const P=this.calculatePosMatrix(r,this.worldSize);let R;return R=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,o.az(P,R,P),S[w]=new Float32Array(P),S[w]}calculatePixelsToTileUnitsMatrix(r){const u=r.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const w=o.cz(r,this);return g[u]=w,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,u=o.bn([],[r,r,r]);return o.az(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const u=o.c6(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),w=this._camera.forward(),S=o.c6(1,this._center.lat);g[2]/=S,w[2]/=S,o.au(w,w);const P=r.raycast(g,w,r.exaggeration());if(P){const R=o.bE([],g,w,P),N=new o.ac(R[0],R[1],o.c6(R[2],o.aY(R[1]))),V=(N.z+o.ae([N.x-g[0],N.y-g[1],N.z-g[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(V),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const u=this._elevation,g=o.c6(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(g),S=u.getAtPointOrZero(new o.ac(...w)),P=this.pixelsPerMeter/this.worldSize*S,R=this._minimumHeightOverTerrain(),N=w[2]-P;if(N<=R)if(N<0||r){const V=this.locationCoordinate(this._center,this._centerAltitude),G=[w[0],w[1],V.z-w[2]],X=o.ae(G);G[2]-=(R-N)/this._pixelsPerMercatorPixel;const W=o.ae(G);if(W===0)return;o.bY(G,G,X/W*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],V.z*this._pixelsPerMercatorPixel-G[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const W=this.center;return W.lat=o.ay(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(W.lng=o.ay(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:w}=this.point;let S=0,P=g,R=w;const N=this.width/2,V=this.height/2,G=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(w-V<G&&(R=G+V),w+V>X&&(R=X-V),X-G<this.height&&(S=Math.max(S,this.height/(X-G)),R=(X+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,fe=this.worldSize/2-(W+Q)/2;P=(g+fe+this.worldSize)%this.worldSize-fe,P-N<W&&(P=W+N),P+N>Q&&(P=Q-N),Q-W<this.width&&(S=Math.max(S,this.width/(Q-W)),P=(Q+W)/2)}P===g&&R===w||this._allowWorldUnderZoom||(this.center=this.unproject(new o.P(P,R))),S&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.c6(1,this.center.lat)/o.c6(1,o.cP));const w=o.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?g:1,P=this._camera.getWorldToCamera(this.worldSize,S);let R;const N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(N[8]=2*-r.x/this.width,N[9]=2*r.y/this.height,this.isOrthographic){let qe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ke=qe*this.aspect,pt=-Ke,mt=-qe;Ke-=r.x,pt-=r.x,qe+=r.y,mt+=r.y,R=this._camera.getCameraToClipOrthographic(pt,Ke,mt,qe,this._nearZ,this._farZ),((It,Nt,Xt,ut)=>{for(let Et=0;Et<16;Et++)It[Et]=o.ai(Nt[Et],Xt[Et],ut)})(R,R,N,o.cN(this.pitch>=Ia?1:this.pitch/Ia))}else R=N;const V=o.cB([],N,P);let G=o.cB([],R,P);if(this.projection.isReprojectedInTileSpace){const qe=this.locationCoordinate(this.center),Ke=o.bx([]);o.bo(Ke,Ke,[qe.x*this.worldSize,qe.y*this.worldSize,0]),o.az(Ke,Ke,o.cC(this)),o.bo(Ke,Ke,[-qe.x*this.worldSize,-qe.y*this.worldSize,0]),o.az(G,G,Ke),o.az(V,V,Ke),this.inverseAdjustmentMatrix=o.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.cE([],G,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=G,this.invProjMatrix=o.bi(new Float64Array(16),this.projMatrix),u){const qe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);qe[8]=2*-r.x/this.width,qe[9]=2*r.y/this.height,this.expandedFarZProjMatrix=o.cB([],qe,P)}else this.expandedFarZProjMatrix=this.projMatrix;const X=o.bi([],R);this.frustumCorners=o.cF.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const W=new Float32Array(16);o.bx(W),o.cE(W,W,[1,-1,1]),o.cG(W,W,this._pitch),o.by(W,W,this.angle);const Q=o.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.bw(Q);const fe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Q[8]=2*-r.x/this.width,Q[9]=2*(r.y+fe)/this.height,this.skyboxMatrix=o.az(W,Q,W);const se=this.point,pe=se.x,ye=se.y,we=this.width%2/2,De=this.height%2/2,Le=Math.cos(this.angle),Ze=Math.sin(this.angle),Ue=pe-Math.round(pe)+Le*we+Ze*De,Fe=ye-Math.round(ye)+Le*De+Ze*we,ke=new Float64Array(G);if(o.bo(ke,ke,[Ue>.5?Ue-1:Ue,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=ke,G=o.bz(),o.cE(G,G,[this.width/2,-this.height/2,1]),o.bo(G,G,[1,-1,0]),this.labelPlaneMatrix=G,G=o.bz(),o.cE(G,G,[1,-1,1]),o.bo(G,G,[-1,-1,0]),o.cE(G,G,[2/this.width,2/this.height,1]),this.glCoordMatrix=G,this.pixelMatrix=o.az(new Float64Array(16),this.labelPlaneMatrix,V),this._calcFogMatrices(),this._distanceTileDataCache={},G=o.bi(new Float64Array(16),this.pixelMatrix),!G)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=G,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.cH(this);const qe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.ad(qe,qe,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=G;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,S=[r,r,u];o.bY(S,S,w),o.bY(g,g,-1),o.cI(g,g,S);const P=o.bz();o.bo(P,P,g),o.cE(P,P,S),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,u,w)}_computeCameraPosition(r){const u=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),w=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-r/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-g[0]*S,w.y/this.worldSize-g[1]*S,r/this.worldSize*this._centerAltitude-g[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],w=r[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(S=Math.min((u-g)/w,1)),this._camera.position=o.bE([],this._camera.position,r,S),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:w}=this._camera.getPitchBearing(),S=o.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.al(this._maxPitch)),R=Math.max((r[2]-S)/Math.cos(g),P),N=this._zoomFromMercatorZ(R);o.bE(r,r,u,R),this._pitch=o.ay(g,o.al(this.minPitch),o.al(this.maxPitch)),this.angle=o.bX(w,-Math.PI,Math.PI),this._setZoom(o.ay(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.ac(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,r)*this.tileSize))}zoomFromMercatorZAdjusted(r){let u=0,g=o.cx,w=0,S=1/0;for(;g-u>1e-6&&g>u;){const P=u+.5*(g-u),R=this.tileSize*Math.pow(2,P),N=this.getCameraToCenterDistance(this.projection,P,R),V=this.scaleZoom(N/(Math.max(0,r)*this.tileSize)),G=Math.abs(P-V);G<S&&(S=G,w=P),P<V?u=P:g=P}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,u){const g=Math.min(r.x,u.x),w=Math.max(r.x,u.x),S=Math.min(r.y,u.y),P=Math.max(r.y,u.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const R=[new o.P(g,S),new o.P(w,P),new o.P(g,P),new o.P(w,S)],N=this.renderWorldCopies?-3:0,V=this.renderWorldCopies?4:1;for(const G of R){const X=this.pointRayIntersection(G);if(X.t<0)return!0;const W=this.rayIntersectionCoordinate(X);if(W.x<N||W.y<0||W.x>V||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(r,u){const g=o.ae(o.at([],this._camera.position,r)),w=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([u,g,w],S){const P=[u,g,w,1];o.aA(P,P,S);const R=P[3]=Math.max(P[3],1e-6);return P[0]/=R,P[1]/=R,P[2]/=R,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}}getCameraToCenterDistance(r,u=this.zoom,g=this.worldSize){const w=o.cA(r,u,this.width,this.height,1024),S=r.pixelSpaceConversion(this.center.lat,g,w);let P=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(P=o.ai(1,P,o.cN(this.pitch>=Ia?1:this.pitch/Ia))),P}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.az(r,r,this.globeMatrix),r}getFrustum(r){return o.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const ac=(m,r)=>{if(r>0&&m.terrain&&o.w("Cutoff is currently disabled on terrain"),r<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=m.transform,g=Math.max(Math.abs(u._zoom-(m.minCutoffZoom-1)),1),w=u.isLODDisabled(!1)?o.af(60,45,u.pitch):o.af(30,15,u.pitch),S=u._farZ-u._nearZ,P=r*u.height,R=((1-(N=w))*u.cameraToCenterDistance+N*(u._farZ+P))*g;var N;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(R-u._nearZ)/S,(R-P-u._nearZ)/S]}}},ia={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Pd{constructor(r,u){this.aabb=r,this.lastCascade=u}}class kh{add(r,u){const g=this.receivers[r.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],u.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],u.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],u.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],u.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],u.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],u.max[2])):this.receivers[r.key]=new Pd(u,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,u,g){const w=o.cW.fromPoints(r.points);let S=0;for(const P in this.receivers){const R=this.receivers[P];if(!R||!w.intersectsAabb(R.aabb))continue;R.aabb.min=w.closestPoint(R.aabb.min),R.aabb.max=w.closestPoint(R.aabb.max);const N=R.aabb.getCorners();for(let V=0;V<g.length;V++){let G=!0;for(const X of N){const W=[X[0]*u,X[1]*u,X[2]];if(o.ad(W,W,g[V].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){G=!1;break}}if(R.lastCascade=V,S=Math.max(S,V),G)break}}return S+1}}class Sl{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new kh,this._depthMode=new Tn(r.context.gl.LEQUAL,Tn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(ia,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(ia,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(ia,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,u){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const w=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||w<=0||(this._shadowLayerCount=g.style.order.reduce((fe,se)=>{const pe=g.style._mergedLayers[se];return fe+(pe.hasShadowPass()&&!pe.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=g.context,P=ia.shadowMapResolution,R=ia.shadowMapResolution;if(this._cascades.length===0||ia.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let fe=0;fe<ia.cascadeCount;++fe){const se=g._shadowMapDebug,pe=S.gl,ye=S.createFramebuffer(P,R,se,"texture"),we=new o.T(S,{width:P,height:R,data:null},pe.DEPTH_COMPONENT16);if(ye.depthAttachment.set(we.texture),se){const De=new o.T(S,{width:P,height:R,data:null},pe.RGBA8);ye.colorAttachment.set(De.texture)}this._cascades.push({framebuffer:ye,texture:we,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.cn,scale:0})}}this.shadowDirection=sc(u);let N=0;if(r.elevation){const fe=r.elevation,se=[1e4,-1e4];fe.visibleDemTiles.filter(pe=>pe.dem).forEach(pe=>{const ye=pe.dem.tree;se[0]=Math.min(se[0],ye.minimums[0]),se[1]=Math.max(se[1],ye.maximums[0])}),se[0]!==1e4&&(N=(se[1]-se[0])*fe.exaggeration())}const V=1.5*r.cameraToCenterDistance,G=3*V,X=new Float64Array(16);for(let fe=0;fe<this._cascades.length;++fe){const se=this._cascades[fe];let pe=r.height/50,ye=1;ia.cascadeCount===1?ye=G:fe===0?ye=V:(pe=V,ye=G);const[we,De]=Vc(r,this.shadowDirection,pe,ye,ia.shadowMapResolution,N);se.scale=r.scale,se.matrix=we,se.boundingSphereRadius=De,o.bi(X,se.matrix),se.frustum=o.cn.fromInvProjectionMatrix(X,1,0,!0),se.far=ye}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ia.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ia.shadowMapResolution,this._uniformValues.u_shadowmap_0=la.ShadowMap0,this._uniformValues.u_shadowmap_1=la.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Q=g.transform.elevation;for(const fe of this._groundShadowTiles){let se={min:0,max:0};if(Q){const pe=Q.getMinMaxForTile(fe);pe&&(se=pe)}this.addShadowReceiver(fe.toUnwrapped(),se.min,se.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,u){if(!this.enabled)return;const g=this.painter,w=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),w.viewport.set([0,0,ia.shadowMapResolution,ia.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){g.currentShadowCascade=S,w.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),w.clear({color:o.am.white,depth:1});for(const P of r.order){const R=r._mergedLayers[P];if(!R.hasShadowPass()||R.isHidden(g.transform.zoom))continue;const N=r.getLayerSourceCache(R),V=N?u[N.id]:void 0;(R.type==="model"||V&&V.length)&&g.renderLayer(g,N,R,V)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,u=r.style,g=r.context,w=g.gl,S=u.directionalLight,P=u.ambientLight;if(!S||!P)return;const R=[],N=ac(r,r.longestCutoffRange);N.shouldRenderCutoff&&R.push("RENDER_CUTOFF"),R.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&R.push("NORMAL_OFFSET");const V=Uc(u,S,P),G=new Tn(w.LEQUAL,Tn.ReadOnly,r.depthRangeFor3D),X=new di({func:w.EQUAL,mask:255},0,255,w.KEEP,w.KEEP,w.KEEP);for(const W of this._groundShadowTiles){const Q=W.toUnwrapped(),fe=r.isTileAffectedByFog(W),se=r.getOrCreateProgram("groundShadow",{defines:R,overrideFog:fe});this.setupShadows(Q,se),r.uploadCommonUniforms(g,se,Q,null,N);const pe={u_matrix:r.transform.calculateProjMatrix(Q),u_ground_shadow_factor:V};se.draw(r,w.TRIANGLES,G,X,Ri.multiply,li.disabled,pe,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,null,r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ri.unblended:Ri.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const u=this.painter.transform,g=u.calculatePosMatrix(r,u.worldSize);return o.az(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(r){return o.az(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,u,g,w=0){if(!this.enabled)return;const S=this.painter.transform,P=this.painter.context,R=P.gl,N=this._uniformValues,V=new Float64Array(16),G=S.calculatePosMatrix(r,S.worldSize);for(let X=0;X<this._cascades.length;X++)o.az(V,this._cascades[X].matrix,G),N[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(V),P.activeTexture.set(R.TEXTURE0+la.ShadowMap0+X),this._cascades[X].texture.bindExtraParam(R.LINEAR,R.LINEAR,R.CLAMP_TO_EDGE,R.CLAMP_TO_EDGE,R.GREATER);if(this.useNormalOffset=!!g,this.useNormalOffset){const X=o.cU(r.canonical),W=2/S.tileSize*o.aj/ia.shadowMapResolution,Q=W*this._cascades[0].boundingSphereRadius,fe=W*this._cascades[this._cascades.length-1].boundingSphereRadius,se=(g==="vector-tile"?1:3)/Math.pow(2,w-r.canonical.z-(1-S.zoom+Math.floor(S.zoom)));N.u_shadow_normal_offset=[X,Q*se,fe*se],N.u_shadow_bias=[6e-5,.0012,.012]}else N.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(P,N)}setupShadowsFromMatrix(r,u,g=!1){if(!this.enabled)return;const w=this.painter.context,S=w.gl,P=this._uniformValues,R=new Float64Array(16);for(let N=0;N<ia.cascadeCount;N++)o.az(R,this._cascades[N].matrix,r),P[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(R),w.activeTexture.set(S.TEXTURE0+la.ShadowMap0+N),this._cascades[N].texture.bindExtraParam(S.LINEAR,S.LINEAR,S.CLAMP_TO_EDGE,S.CLAMP_TO_EDGE,S.GREATER);if(this.useNormalOffset=g,g){const N=ia.normalOffset;P.u_shadow_normal_offset=[1,N,N],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(w,P)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,u,g,w){if(w[2]>=0)return{};const S=function(N,V,G){const X=G/(1<<N.canonical.z);return new o.cW([N.canonical.x*X+N.wrap*G,N.canonical.y*X+N.wrap*G,0],[(N.canonical.x+1)*X+N.wrap*G,(N.canonical.y+1)*X+N.wrap*G,V])}(r,u,g).getCorners(),P=u/-w[2];w[0]<0?(o.cV(S[0],S[0],[w[0]*P,0,0]),o.cV(S[3],S[3],[w[0]*P,0,0])):w[0]>0&&(o.cV(S[1],S[1],[w[0]*P,0,0]),o.cV(S[2],S[2],[w[0]*P,0,0])),w[1]<0?(o.cV(S[0],S[0],[0,w[1]*P,0]),o.cV(S[1],S[1],[0,w[1]*P,0])):w[1]>0&&(o.cV(S[2],S[2],[0,w[1]*P,0]),o.cV(S[3],S[3],[0,w[1]*P,0]));const R={};return R.vertices=S,R.planes=[Ga(S[1],S[0],S[4]),Ga(S[2],S[1],S[5]),Ga(S[3],S[2],S[6]),Ga(S[0],S[3],S[7])],R}addShadowReceiver(r,u,g){this._receivers.add(r,o.cW.fromTileIdAndHeight(r,u,g))}getMaxCascadeForTile(r){const u=this._receivers.get(r);return u&&u.lastCascade?u.lastCascade:0}}function Ga(m,r,u){const g=o.at([],u,r),w=o.at([],m,r),S=o.bF([],g,w),P=o.ae(S);return P===0?[0,0,1,0]:(o.bY(S,S,1/P),[S[0],S[1],S[2],-o.bG(S,r)])}function sc(m){const r=m.properties.get("direction"),u=o.cR(r.x,r.y,r.z);u[2]=o.ay(u[2],0,75);const g=o.cT([u[0],u[1],u[2]]);return o.cS(g.x,g.y,g.z)}function Uc(m,r,u){const g=r.properties.get("color-use-theme")==="none",w=r.properties.get("color"),S=r.properties.get("intensity"),P=r.properties.get("direction"),R=[P.x,P.y,P.z],N=u.properties.get("color-use-theme")==="none",V=u.properties.get("color"),G=u.properties.get("intensity"),X=Math.max(o.bG([0,0,1],R),0),W=[0,0,0];o.bY(W,V.toPremultipliedRenderColor(N?null:m.getLut(r.scope)).toArray01Linear().slice(0,3),G);const Q=[0,0,0];return o.bY(Q,w.toPremultipliedRenderColor(g?null:m.getLut(u.scope)).toArray01Linear().slice(0,3),X*S),o.cY([W[0]>0?W[0]/(W[0]+Q[0]):0,W[1]>0?W[1]/(W[1]+Q[1]):0,W[2]>0?W[2]/(W[2]+Q[2]):0])}function Vc(m,r,u,g,w,S){const P=m.zoom,R=m.scale,N=m.worldSize,V=1/N,G=m.aspect,X=Math.sqrt(1+G*G)*Math.tan(.5*m.fovX),W=X*X,Q=g-u,fe=g+u;let se,pe;W>Q/fe?(se=g,pe=g*X):(se=.5*fe*(1+W),pe=.5*Math.sqrt(Q*Q+2*(g*g+u*u)*W+fe*fe*W*W));const ye=m.projection.pixelsPerMeter(m.center.lat,N),we=m._camera.getCameraToWorldMercator(),De=[0,0,-se*V];o.ad(De,De,we);let Le=pe*V;const Ze=m._edgeInsets;if(!(Ze.left===0&&Ze.top===0&&Ze.right===0&&Ze.bottom===0||Ze.left===Ze.right&&Ze.top===Ze.bottom)){const Ht=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?ye:1),pn=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,u,g);pn[8]=2*-m.centerOffset.x/m.width,pn[9]=2*m.centerOffset.y/m.height;const Ft=new Float64Array(16);o.cB(Ft,pn,Ht);const rn=new Float64Array(16);o.bi(rn,Ft);const Bn=o.cn.fromInvProjectionMatrix(rn,N,P,!0);for(const Dn of Bn.points){const On=((Ue=Dn)[0]/=R,Ue[1]/=R,Ue[2]=o.c6(Ue[2],m._center.lat),Ue);Le=Math.max(Le,o.bZ(o.cX([],De,On)))}}var Ue;Le*=w/(w-1);const Fe=Math.acos(r[2]),ke=Math.atan2(-r[0],-r[1]),qe=new ul;qe.position=De,qe.setPitchBearing(Fe,ke);const Ke=qe.getWorldToCamera(N,ye),pt=Le*N,mt=Math.min(m._mercatorZfromZoom(17)*N*-2,-2*pt),It=qe.getCameraToClipOrthographic(-pt,pt,-pt,pt,mt,(pt+S*ye)/r[2]),Nt=new Float64Array(16);o.az(Nt,It,Ke);const Xt=o.cS(Math.floor(1e6*De[0])/1e6*N,Math.floor(1e6*De[1])/1e6*N,0),ut=.5*w,Et=[0,0,0];o.ad(Et,Xt,Nt),o.bY(Et,Et,ut);const at=[Math.floor(Et[0]),Math.floor(Et[1]),Math.floor(Et[2])],jt=[0,0,0];o.at(jt,Et,at),o.bY(jt,jt,-1/ut);const wt=new Float64Array(16);return o.bx(wt),o.bo(wt,wt,jt),o.az(Nt,wt,Nt),[Nt,pt]}class Nh extends o.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(r,u){return o.aS(this.requestManager.transformRequest(u,o.R.Model).url).then(g=>{if(!g)return;const w=o.aT(g),S=new o.aU(r,void 0,void 0,w);return S.computeBoundsAndApplyParent(),S}).catch(g=>{if(g&&g.status===404)return null;this.fire(new o.z(new Error(`Could not load model ${r} from ${u}: ${g.message}`)))})}load(r,u,g={forceReload:!1}){this.models[u]||(this.models[u]={});const w=Object.keys(r),S=[],P=[];for(const R of w){const N=r[R];this.hasURLBeenRequested(N)&&!g.forceReload||(this.modelByURL[N]={modelId:R,scope:u},S.push(this.loadModel(R,N)),P.push(R)),this.models[u][R]||(this.models[u][R]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+P.length,Promise.allSettled(S).then(R=>{for(let N=0;N<R.length;N++){const{status:V}=R[N];if(V==="rejected")continue;const{value:G}=R[N];this.models[u][P[N]]||(this.models[u][P[N]]={model:null,numReferences:1}),this.models[u][P[N]].model=G}this.numModelsLoading[u]-=P.length,this.fire(new o.A("data",{dataType:"style"}))}).catch(R=>{this.fire(new o.z(new Error(`Could not load models: ${R.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,u,g={exactIdMatch:!1}){return!!(g.exactIdMatch?this.getModel(r,u):this.getModelByURL(this.modelUris[u][r]))}getModel(r,u){return this.models[u]||(this.models[u]={}),this.models[u][r]?this.models[u][r].model:void 0}getModelByURL(r){if(!r)return null;const u=this.modelByURL[r];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(r,u){return this.models[u]&&this.models[u][r]!==void 0}getModelURIs(r){return this.modelUris[r]||{}}addModel(r,u,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={});const w=this.requestManager.normalizeModelURL(u);if((this.hasModel(r,g,{exactIdMatch:!0})||this.hasModelBeenAdded(r,g))&&this.modelUris[g][r]===w)this.models[g][r].numReferences++;else if(this.hasURLBeenRequested(w)){const{scope:S,modelId:P}=this.modelByURL[w];this.models[S][P].numReferences++}else this.modelUris[g][r]=w,this.load({[r]:this.modelUris[g][r]},g)}addModelURLs(r,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g=this.modelUris[u];for(const w in r)g[w]=this.requestManager.normalizeModelURL(r[w])}reloadModels(r){this.load(this.modelUris[r],r,{forceReload:!0})}addModelsFromBucket(r,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g={};for(const w of r)this.hasModel(w,u,{exactIdMatch:!0})||this.hasURLBeenRequested(w)?this.models[u][w].numReferences++:this.modelUris[u][w]&&!this.hasURLBeenRequested(w)?g[w]=this.modelUris[u][w]:!this.hasURLBeenRequested(w)&&o.cZ(w,!1)&&(this.modelUris[u][w]=this.requestManager.normalizeModelURL(w),g[w]=this.modelUris[u][w]);this.load(g,u)}hasURLBeenRequested(r){return this.modelByURL[r]!==void 0}removeModel(r,u,g=!1){if(this.models[u]&&this.models[u][r]&&(this.models[u][r].numReferences--,this.models[u][r].numReferences===0)){const w=this.modelUris[u][r];g||delete this.modelUris[u][r],delete this.modelByURL[w];const S=this.models[u][r].model;if(!S)return;delete this.models[u][r],S.destroy()}}destroy(){for(const r of Object.keys(this.models))for(const u of Object.keys(this.models[r])){const g=this.models[r][u].model;delete this.models[r][u],g&&g.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,u){this.models[u]||(this.models[u]={});for(const g in this.models[u])this.models[u][g].model&&this.models[u][g].model.upload(r.context)}}const hu=new o.a7({data:new o.a8(o.a5.colorTheme.data)}),Bh={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function rs(m){return m=m||{},Object.assign(m,Bh)}class jh extends o.E{constructor(r){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._floorplanStates={},o.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=r,this._checkFloorplanVisible(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(r=>{r.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new o.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=r.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=r.stylesheet.indoor.buildingFeaturesetId,this._scope=r.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:r=>(r.feature&&r.feature.properties.floorplan&&this.selectFloorplan(r.feature.properties.floorplan),!0)}),this._checkFloorplanVisible()}_onMove(){this._checkFloorplanVisible()}_checkFloorplanVisible(){if(!this._queryFeatureSetId||!this._map.isStyleLoaded())return;const r=()=>{this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new o.A("floorplangone"))};if(this._map.transform.zoom<13)return void r();const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=this._map.transform.width,w=this._map.transform.height,S=g*(2/3),P=w*(2/3),R=.5*(g-S),N=.5*(w-P),V=[new o.P(R,N),new o.P(R+S,N+P)],G=this._map.queryRenderedFeatures(V,u);G.length>0?this._selectedFloorplan&&G[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=G[0],this._floorplanSelected()):r()}_floorplanSelected(){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._floorplanStates[this._indoorData.id]=this._floorplanStates[this._indoorData.id]||{},this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[this._indoorData.id]]);const r=this._floorplanStates[this._indoorData.id].selectedBuilding,u=r?this._indoorData.buildings.find(R=>R.id===r):this._indoorData.buildings.length>0?this._indoorData.buildings[0]:null,g=this._floorplanStates[this._indoorData.id].selectedLevel,w=this._indoorData.levels.find(R=>R.id===g),S=this._indoorData.levels.find(R=>!(!u||!u.levels)&&Number(R.levelOrder)===0&&u.levels.includes(R.id)),P=w?w.id:S?S.id:void 0;this.fire(new o.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:P})),u&&this._buildingSelected(u,!1),P&&this._levelSelected(P)}_buildingSelected(r,u){if(!r||!r.id)return void console.warn("IndoorManager: Building or building id is undefined");u&&r.extent&&this._map.fitBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=r?r.id:void 0;const g=this._indoorData.levels.filter(w=>r.levels.includes(w.id));this.fire(new o.A("buildingselected",{buildingId:r.id,levels:g}))}_levelSelected(r){const u=this._indoorData.levels.find(g=>g.id===r);u?(this._updateLevels(u,!0),this.fire(new o.A("levelselected",{levelId:u.id}))):console.warn(`IndoorManager: Level with ID ${r} not found in the current floorplan.`)}_updateLevels(r,u){if(!r||!r.id)throw new Error("IndoorManager: Selected level or level ID is undefined");function g(V){const G=V.indexOf("/floor/");if(G===-1)return V;const X=G+7,W=V.indexOf("/",X);return W===-1?V.slice(X):V.slice(X,W)}this._floorplanStates[this._indoorData.id].selectedLevel=r.id;const w=[],S={},P={},R={},N={};for(const V of this._indoorData.levels){if(w.push(V.id),S[V.id]=V.levelOrder>=0?3*Math.abs(V.levelOrder+1):3*Math.abs(V.levelOrder),P[V.id]=V.levelOrder>=0?3*V.levelOrder:0,this.mergeFloors){const G=g(r.id),X=g(V.id);R[V.id]=X===G?"true":"false"}else R[V.id]=V.id===r.id?"true":"false";N[V.id]=V.levelOrder<r.levelOrder?"true":"false"}this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",R]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",N]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",r.levelOrder<0)}selectFloorplan(r){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new o.P(0,0),new o.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(g,u);if(w.length>0){for(const S of w)if(JSON.parse(S.properties["indoor-data"]).id===r){this._selectedFloorplan=S,this._floorplanSelected();break}}}selectBuilding(r){const u=this._indoorData.buildings.find(g=>g.id===r);this._buildingSelected(u,!0)}selectLevel(r){this._levelSelected(r)}}function Ju(m){if(!m.metadata||!m.metadata.content_area)return;const r=o.q.devicePixelRatio,{left:u,top:g,width:w,height:S}=m.metadata.content_area,P=u*r,R=g*r;return[P,R,P+w*r,R+S*r]}function Cd(m){if(m)return m.map(([r,u])=>[r*o.q.devicePixelRatio,u*o.q.devicePixelRatio])}class gp{constructor(r,u,g){this.id=r,this.scope=u,this.sourceCache=g,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(r){this.missingRequests.has(r.name)||this.pendingRequests.has(r.name)||this.pendingRequests.add(r.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const r=new Map;if(!this.sourceCache.loaded())return r;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return r;const g=this.sourceCache.getSource();if(!(g instanceof Lo))return r;const w=u.map(P=>this.sourceCache.getTile(P)),S=g.getImages(w,Array.from(this.pendingRequests));for(const[P,R]of S)r.set(o.I.from({name:P,iconsetId:this.id}),R),this.pendingRequests.delete(P);for(const P of this.pendingRequests)this.missingRequests.add(P);return this.pendingRequests.clear(),r}}const zs=(m,r)=>be(m,r&&r.filter(u=>u.identifier!=="source.canvas")),du=o.aF(ri,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Md=o.aF(ri,["setCenter","setZoom","setBearing","setPitch"]),Od=new Set(["background","sky","slot","custom"]),lc={version:8,layers:[],sources:{}},yf={duration:300,delay:0};class Uo extends o.E{constructor(r,u={}){super(),this.map=r,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=o.h({},yf),this._buildingIndex=new na(this),this.crossTileSymbolIndex=new Ha,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new ci,this.dispatcher=u.dispatcher?u.dispatcher:new o.D(o.c$(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new Mi(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new o.d0(r._requestManager,u.localFontFamily?o.d1.all:u.localIdeographFontFamily?o.d1.ideographs:o.d1.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new Nh(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",o.d2());const g=this;this._rtlTextPluginCallback=Uo.registerForPluginStateChange(w=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(S,P)=>{if(o.d3(S),P&&P.every(R=>R))for(const R in g._sourceCaches){const N=g._sourceCaches[R],V=N.getSource().type;V!=="vector"&&V!=="geojson"||N.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const S=this.getOwnSource(w.sourceId);if(S&&S.vectorLayerIds)for(const P in this._layers){const R=this._layers[P];R.source===S.id&&this._validateLayer(R)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(o.j(r))return r;const u=o.d4(r);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${o.d5(JSON.stringify(r))}`}_diffStyle(r,u,g){this.globalId=this._getGlobalId(r);const w=(S,P)=>{try{P(null,this.setState(S,g))}catch(R){P(R,!1)}};if(typeof r=="string"){const S=this.map._requestManager.normalizeStyleURL(r),P=this.map._requestManager.transformRequest(S,o.R.Style);o.n(P,(R,N)=>{R?this.fire(new o.z(R)):N&&w(N,u)})}else typeof r=="object"&&w(r,u)}loadURL(r,u={}){this.fire(new o.A("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!o.j(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,u.accessToken),this.resolvedImports.add(r);const w=this.importsCache.get(r);if(w)return this._load(w,g);const S=this.map._requestManager.transformRequest(r,o.R.Style);this._request=o.n(S,(P,R)=>{if(this._request=null,P)this.fire(new o.z(P));else if(R)return this.importsCache.set(r,R),this._load(R,g)})}loadJSON(r,u={}){this.fire(new o.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=o.q.frame(()=>{this._request=null,this._load(r,u.validate!==!1)})}loadEmpty(){this.fire(new o.A("dataloading",{dataType:"style"})),this._load(lc,!1)}_loadImports(r,u,g){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const S of r){const P=this._createFragmentStyle(S),R=new Promise(G=>{P.once("style.import.load",G),P.once("error",G)}).then(()=>this.mergeAll());if(w.push(R),this.resolvedImports.has(S.url)){P.loadEmpty();continue}const N=S.data||this.importsCache.get(S.url);N?(P.loadJSON(N,{validate:u}),this._isInternalStyle(N)&&(P.globalId=null)):S.url?P.loadURL(S.url,{validate:u}):P.loadEmpty();const V={style:P,id:S.id,config:S.config};if(g){const G=this.fragments.findIndex(({id:X})=>X===g);this.fragments=this.fragments.slice(0,G).concat(V).concat(this.fragments.slice(G))}else this.fragments.push(V)}return Promise.allSettled(w)}getImportGlobalIds(r=this,u=new Set){for(const g of r.fragments)g.style.globalId&&u.add(g.style.globalId),this.getImportGlobalIds(g.style,u);return[...u.values()]}_createFragmentStyle(r){const u=this.scope?o.C(r.id,this.scope):r.id;let g;const w=this._initialConfig&&this._initialConfig[u];(r.config||w)&&(g=o.h({},r.config,w));const S=new Uo(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:r["color-theme"],configDependentLayers:this._configDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,u){const g=r.indoor?rs(r.schema):r.schema;if(this._isInternalStyle(r)){const P=o.h({},lc,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(P,u)}if(this.updateConfig(this._config,g),u&&zs(this,ta(r)))return;this._loaded=!0,this.stylesheet=o.d6(r);const w=()=>{for(const V in r.sources)this.addSource(V,r.sources[V],{validate:!1,isInitialLoad:!0});if(r.iconsets)for(const V in r.iconsets)this.addIconset(V,r.iconsets[V]);r.sprite?this._loadIconset(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(r.glyphs);const P=Sr(this.stylesheet.layers);if(this._order=P.map(V=>V.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const V=this.stylesheet.lights[0];this.light=new nt(V.properties,V.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new nt(this.stylesheet.light)),this._layers={};for(const V of P){const G=o.db(V,this.scope,this._styleColorTheme.lut,this.options);G.configDependencies.size!==0&&this._configDependentLayers.add(G.fqid),G.setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=G;const X=this.getOwnLayerSourceCache(G),W=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&G.canCastShadows()&&W&&(X.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const R=this.stylesheet.terrain;R&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(R,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.A("data",{dataType:"style"}));const N=this.isRootStyle();r.imports?this._loadImports(r.imports,u).then(()=>{this._reloadImports(),this.fire(new o.A(N?"style.load":"style.import.load"))}).catch(V=>{this.fire(new o.z(new Error("Failed to load imports",V))),this.fire(new o.A(N?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.A(N?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const S=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(S){const P=this._evaluateColorThemeData(S);this._loadColorTheme(P).then(()=>{w()}).catch(R=>{o.w(`Couldn't load color theme from the stylesheet: ${R}`),w()})}else this._styleColorTheme.lut=null,w()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,u,g,w,S,P,R,N,V,G;const X={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(r=W.light),W.stylesheet.lights)for(const Q of W.stylesheet.lights)Q.type==="ambient"&&W.ambientLight!=null&&(u=W.ambientLight),Q.type==="directional"&&W.directionalLight!=null&&(g=W.directionalLight);w=this._prioritizeTerrain(w,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(S=W.fog),W.stylesheet.snow&&W.snow!=null&&(P=W.snow),W.stylesheet.rain&&W.rain!=null&&(R=W.rain),W.stylesheet.camera!=null&&(G=W.stylesheet.camera),W.stylesheet.projection!=null&&(N=W.stylesheet.projection),W.stylesheet.transition!=null&&(V=W.stylesheet.transition),X[W.scope]=W._styleColorTheme}}),this.light=r,this.ambientLight=u,this.directionalLight=g,this.fog=S,this.snow=P,this.rain=R,this._styleColorThemeForScope=X,w===null?delete this.terrain:this.terrain=w,this.camera=G||{"camera-projection":"perspective"},this.projection=N||{name:"mercator"},this.transition=o.h({},yf,V),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const u=g=>{for(const w of g.fragments)u(w.style);r(g)};u(this)}_prioritizeTerrain(r,u,g){const w=r&&r.drapeRenderMode===0;return g===null?u&&u.drapeRenderMode===0?u:w?r:null:u!=null&&(!r||w||u&&u.drapeRenderMode===1)?u:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{r=this._prioritizeTerrain(r,u.terrain,u.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(r=u.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},u={},g={};this.forEachFragmentStyle(w=>{for(const S in w._sourceCaches){const P=o.C(S,w.scope);r[P]=w._sourceCaches[S]}for(const S in w._otherSourceCaches){const P=o.C(S,w.scope);u[P]=w._otherSourceCaches[S]}for(const S in w._symbolSourceCaches){const P=o.C(S,w.scope);g[P]=w._symbolSourceCaches[S]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=g}mergeLayers(){const r={},u=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const P of S._order){const R=S._layers[P];if(R.type==="slot"){const N=o.d7(P);if(r[N])continue;r[N]=[]}R.slot&&r[R.slot]?r[R.slot].push(R):u.push(R)}}),this._mergedOrder=[];const w=(S=[])=>{for(const P of S)if(P.type==="slot"){const R=o.d7(P.id);r[R]&&w(r[R]),this._mergedSlots.push(R)}else{const R=o.C(P.id,P.scope);this._mergedOrder.push(R),g[R]=P,P.is3D(!!this.terrain)&&(this._has3DLayers=!0),P.type==="circle"&&(this._hasCircleLayers=!0),P.type==="symbol"&&(this._hasSymbolLayers=!0),P.type==="clip"&&(this._clipLayerPresent=!0)}};w(u),this._mergedOrder.sort((S,P)=>{const R=g[S],N=g[P];return R.hasInitialOcclusionOpacityProperties?N.is3D(!!this.terrain)?1:0:R.is3D(!!this.terrain)&&N.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=o.h({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(u,g,w,S){const P=o.h({},g);for(const N of Object.keys(o.a5.colorTheme))P[N]===void 0&&(P[N]=o.a5.colorTheme[N].default);const R=new o.a6(hu,u,new Map(w));return R.setTransitionOrValue(P,w),R.untransitioned().possiblyEvaluate(new o.aa(0,{worldview:void 0}))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,w)=>{const S="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let P=r;P.startsWith(S)||(P=S+P);const R=o.I.from("mapbox-reserved-lut"),N=new Image;N.src=P,N.onerror=()=>{this._styleColorTheme.lutLoading=!1,w(new Error("Failed to load image data"))},N.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void g();this._styleColorTheme.lutLoading=!1;const{width:V,height:G,data:X}=o.q.getImageData(N);if(G>32)return void w(new Error("The height of the image must be less than or equal to 32 pixels."));if(V!==G*G)return void w(new Error("The width of the image must be equal to the height squared."));this.getImage(R)&&this.removeImage(R),this.addImage(R,{data:new o.r({width:V,height:G},X),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(R,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:r},g()):w(new Error("Missing LUT image."))}})}getLut(r){const u=this._styleColorThemeForScope[r];return u?u.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(u,g,w){let S,P,R;const N=o.q.devicePixelRatio>1?"@2x":"";let V=o.n(g.transformRequest(g.normalizeSpriteURL(u,N,".json"),o.R.SpriteJSON),(W,Q)=>{V=null,R||(R=W,S=Q,X())}),G=o.o(g.transformRequest(g.normalizeSpriteURL(u,N,".png"),o.R.SpriteImage),(W,Q)=>{G=null,R||(R=W,P=Q,X())});function X(){if(R)w(R);else if(S&&P){const W=o.q.getImageData(P),Q={};for(const fe in S){const{width:se,height:pe,x:ye,y:we,sdf:De,pixelRatio:Le,stretchX:Ze,stretchY:Ue,content:Fe}=S[fe],ke=new o.r({width:se,height:pe});o.r.copy(W,ke,{x:ye,y:we},{x:0,y:0},{width:se,height:pe},null),Q[fe]={data:ke,pixelRatio:Le,sdf:De,stretchX:Ze,stretchY:Ue,content:Fe,usvg:!1}}w(null,Q)}}return{cancel(){V&&(V.cancel(),V=null),G&&(G.cancel(),G=null)}}}(r,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new o.z(u));else if(g){const w=new Map;for(const S in g)w.set(o.I.from(S),g[S]);this.addImages(w)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.A("data",{dataType:"style"}))})}addIconset(r,u){if(u.type==="sprite")return void this._loadSprite(u.url);const g=this.getOwnSourceCache(u.source);if(!g)return void this.fire(new o.z(new Error(`Source "${u.source}" as specified by iconset "${r}" does not exist and cannot be used as an iconset source`)));const w=g.getSource();if(w.type!=="raster-array")return void this.fire(new o.z(new Error(`Source "${u.source}" as specified by iconset "${r}" is not a "raster-array" source and cannot be used as an iconset source`)));w.partial=!1;const S=new gp(r,this.scope,g);this.imageManager.addImageProvider(S,this.scope)}removeIconset(r){this.imageManager.removeImageProvider(r,this.scope)}_loadIconset(r){if(!o.j(r)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(r);const u=this.map._spriteFormat==="auto";var g,w;this._spriteRequest=(w=(S,P)=>{if(this._spriteRequest=null,S)u?this._loadSprite(r):this.fire(new o.z(S));else if(P){const R=new Map;for(const N in P)R.set(o.I.from(N),P[N]);this.addImages(R)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.A("data",{dataType:"style"}))},o.br((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(r),o.R.Iconset),(S,P)=>{if(S)return void w(S);const R={},N=o.c_(new o.bq(P));for(const V of N.icons){const G={version:1,pixelRatio:o.q.devicePixelRatio,content:Ju(V),stretchX:V.metadata?Cd(V.metadata.stretch_x_areas):void 0,stretchY:V.metadata?Cd(V.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:V};R[V.name]=G}w(null,R)}))}_validateLayer(r){const u=this.getOwnSource(r.source);if(!u)return;const g=r.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.z(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,u)=>{const g=this.fragments[u];return g&&g.style&&(r.data=g.style.serialize()),r})}_serializeSources(){const r={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();r[g.id]||(r[g.id]=g.serialize())}return r}_serializeLayers(r){const u=[];for(const g of r){const w=this._layers[g];w&&w.type!=="custom"&&u.push(w.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const u=this.getOwnLayer(r);if(u)return u;this.fire(new o.z(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const u=this.getOwnSource(r);if(u)return u;this.fire(new o.z(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,u){const g=this.map.painter;if(g)for(let w=r.minzoom||0;w<(r.maxzoom||25.5);w++){const S=r.getProgramIds();if(S)for(const P of S){const R=r.getDefaultProgramParams(P,u.zoom,this._styleColorTheme.lut);R&&(g.style=this,this.fog&&(g._fogVisible=!0,R.overrideFog=!0,g.getOrCreateProgram(P,R)),g._fogVisible=!1,R.overrideFog=!1,g.getOrCreateProgram(P,R),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(R.overrideRtt=!0,g.getOrCreateProgram(P,R)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const u=this.calculateLightsBrightness();r.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u)),r.worldview!==this._worldview&&(this._worldview=r.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const g=this._changes.isDirty();let w=!1;if(this._changes.isDirty()){const R=this._changes.getLayerUpdatesByScope();for(const N in R){const{updatedIds:V,removedIds:G}=R[N];(V||G)&&(this._updateWorkerLayers(N,V,G),w=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this.snow&&this.snow.updateTransitions(r),this.rain&&this.rain.updateTransitions(r),this._changes.reset()}const S={};for(const R in this._mergedSourceCaches){const N=this._mergedSourceCaches[R];S[R]=N.used,N.used=!1,N.tileCoverLift=0}for(const R of this._mergedOrder){const N=this._mergedLayers[R];if(N.recalculate(r,this._availableImages),!N.isHidden(r.zoom)){const V=this.getLayerSourceCache(N);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,N.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(N,r)}):this.precompilePrograms(N,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&w&&this.mergeLayers();const P=this.imageManager.getPendingImageProviders();for(const R of P)R.sourceCache.used=!0;for(const R in S){const N=this._mergedSourceCaches[R];S[R]!==N.used&&N.getSource().fire(new o.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:N.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.snow&&this.snow.recalculate(r),this.rain&&this.rain.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new o.A("data",{dataType:"style"}))}updateImageProviders(){const r=this.imageManager.getPendingImageProviders();for(const u of r){const g=u.resolvePendingRequests(),w=this.getFragmentStyle(u.scope);w&&w.addImages(g)}}_updateTilesForChangedImages(){const r={};for(const u in this._mergedSourceCaches){const g=this._mergedSourceCaches[u].getSource().scope;r[g]=r[g]||this._changes.getUpdatedImages(g),r[g].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r[g])}for(const u in r)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(r,u,g){const w=this.getFragmentStyle(r);w&&this.dispatcher.broadcast("updateLayers",{layers:u?w._serializeLayers(u):[],scope:r,removedIds:g||[],options:w.options})}setState(r,u){if(this._checkLoaded(),zs(this,ta(r)))return!1;(r=o.d6(r)).layers=Sr(r.layers);const g=function(P,R){if(!P)return[{command:ri.setStyle,args:[R]}];let N=[];try{if(!o.bv(P.version,R.version))return[{command:ri.setStyle,args:[R]}];if(o.bv(P.center,R.center)||N.push({command:ri.setCenter,args:[R.center]}),o.bv(P.zoom,R.zoom)||N.push({command:ri.setZoom,args:[R.zoom]}),o.bv(P.bearing,R.bearing)||N.push({command:ri.setBearing,args:[R.bearing]}),o.bv(P.pitch,R.pitch)||N.push({command:ri.setPitch,args:[R.pitch]}),o.bv(P.sprite,R.sprite)||N.push({command:ri.setSprite,args:[R.sprite]}),o.bv(P.glyphs,R.glyphs)||N.push({command:ri.setGlyphs,args:[R.glyphs]}),o.bv(P.imports,R.imports)||function(Q=[],fe=[],se){fe=fe||[];const pe=(Q=Q||[]).map(Qa),ye=fe.map(Qa),we=Q.reduce(Ma,{}),De=fe.reduce(Ma,{}),Le=pe.slice();let Ze,Ue,Fe,ke;for(Ze=0,Ue=0;Ze<pe.length;Ze++)Fe=pe[Ze],De.hasOwnProperty(Fe)?Ue++:(se.push({command:ri.removeImport,args:[Fe]}),Le.splice(Le.indexOf(Fe,Ue),1));for(Ze=0,Ue=0;Ze<ye.length;Ze++)Fe=ye[ye.length-1-Ze],Le[Le.length-1-Ze]!==Fe&&(we.hasOwnProperty(Fe)?(se.push({command:ri.removeImport,args:[Fe]}),Le.splice(Le.lastIndexOf(Fe,Le.length-Ue),1)):Ue++,ke=Le[Le.length-Ze],se.push({command:ri.addImport,args:[De[Fe],ke]}),Le.splice(Le.length-Ze,0,Fe));for(const qe of fe){const Ke=we[qe.id];Ke&&(delete Ke.data,o.bv(Ke,qe)||se.push({command:ri.updateImport,args:[qe.id,qe]}))}}(P.imports,R.imports,N),o.bv(P.transition,R.transition)||N.push({command:ri.setTransition,args:[R.transition]}),o.bv(P.light,R.light)||N.push({command:ri.setLight,args:[R.light]}),o.bv(P.fog,R.fog)||N.push({command:ri.setFog,args:[R.fog]}),o.bv(P.snow,R.snow)||N.push({command:ri.setSnow,args:[R.snow]}),o.bv(P.rain,R.rain)||N.push({command:ri.setRain,args:[R.rain]}),o.bv(P.projection,R.projection)||N.push({command:ri.setProjection,args:[R.projection]}),o.bv(P.lights,R.lights)||N.push({command:ri.setLights,args:[R.lights]}),o.bv(P.camera,R.camera)||N.push({command:ri.setCamera,args:[R.camera]}),o.bv(P.iconsets,R.iconsets)||function(Q,fe,se){let pe;for(pe in fe=fe||{},Q=Q||{})Q.hasOwnProperty(pe)&&(fe.hasOwnProperty(pe)||se.push({command:ri.removeIconset,args:[pe]}));for(pe in fe){if(!fe.hasOwnProperty(pe))continue;const ye=fe[pe];Q.hasOwnProperty(pe)?o.bv(Q[pe],ye)||(se.push({command:ri.removeIconset,args:[pe]}),se.push({command:ri.addIconset,args:[pe,ye]})):se.push({command:ri.addIconset,args:[pe,ye]})}}(P.iconsets,R.iconsets,N),!o.bv(P["color-theme"],R["color-theme"]))return[{command:ri.setStyle,args:[R]}];const V={},G=[];(function(Q,fe,se,pe){let ye;for(ye in fe=fe||{},Q=Q||{})Q.hasOwnProperty(ye)&&(fe.hasOwnProperty(ye)||hs(ye,se,pe));for(ye in fe){if(!fe.hasOwnProperty(ye))continue;const we=fe[ye];Q.hasOwnProperty(ye)?o.bv(Q[ye],we)||(Q[ye].type==="geojson"&&we.type==="geojson"&&Rs(Q,fe,ye)?se.push({command:ri.setGeoJSONSourceData,args:[ye,we.data]}):ko(ye,fe,se,pe)):zo(ye,fe,se)}})(P.sources,R.sources,G,V);const X=[];P.layers&&P.layers.forEach(Q=>{Q.source&&V[Q.source]?N.push({command:ri.removeLayer,args:[Q.id]}):X.push(Q)});let W=P.terrain;W&&V[W.source]&&(N.push({command:ri.setTerrain,args:[void 0]}),W=void 0),N=N.concat(G),o.bv(W,R.terrain)||N.push({command:ri.setTerrain,args:[R.terrain]}),function(Q,fe,se){fe=fe||[];const pe=(Q=Q||[]).map(Qa),ye=fe.map(Qa),we=Q.reduce(Ma,{}),De=fe.reduce(Ma,{}),Le=pe.slice(),Ze=Object.create(null);let Ue,Fe,ke,qe,Ke,pt,mt;for(Ue=0,Fe=0;Ue<pe.length;Ue++)ke=pe[Ue],De.hasOwnProperty(ke)?Fe++:(se.push({command:ri.removeLayer,args:[ke]}),Le.splice(Le.indexOf(ke,Fe),1));for(Ue=0,Fe=0;Ue<ye.length;Ue++)ke=ye[ye.length-1-Ue],Le[Le.length-1-Ue]!==ke&&(we.hasOwnProperty(ke)?(se.push({command:ri.removeLayer,args:[ke]}),Le.splice(Le.lastIndexOf(ke,Le.length-Fe),1)):Fe++,pt=Le[Le.length-Ue],se.push({command:ri.addLayer,args:[De[ke],pt]}),Le.splice(Le.length-Ue,0,ke),Ze[ke]=!0);for(Ue=0;Ue<ye.length;Ue++)if(ke=ye[Ue],qe=we[ke],Ke=De[ke],!Ze[ke]&&!o.bv(qe,Ke))if(o.bv(qe.source,Ke.source)&&o.bv(qe["source-layer"],Ke["source-layer"])&&o.bv(qe.type,Ke.type)){for(mt in ws(qe.layout,Ke.layout,se,ke,null,ri.setLayoutProperty),ws(qe.paint,Ke.paint,se,ke,null,ri.setPaintProperty),o.bv(qe.slot,Ke.slot)||se.push({command:ri.setSlot,args:[ke,Ke.slot]}),o.bv(qe.filter,Ke.filter)||se.push({command:ri.setFilter,args:[ke,Ke.filter]}),o.bv(qe.minzoom,Ke.minzoom)&&o.bv(qe.maxzoom,Ke.maxzoom)||se.push({command:ri.setLayerZoomRange,args:[ke,Ke.minzoom,Ke.maxzoom]}),qe)qe.hasOwnProperty(mt)&&mt!=="layout"&&mt!=="paint"&&mt!=="filter"&&mt!=="metadata"&&mt!=="minzoom"&&mt!=="maxzoom"&&mt!=="slot"&&(mt.indexOf("paint.")===0?ws(qe[mt],Ke[mt],se,ke,mt.slice(6),ri.setPaintProperty):o.bv(qe[mt],Ke[mt])||se.push({command:ri.setLayerProperty,args:[ke,mt,Ke[mt]]}));for(mt in Ke)Ke.hasOwnProperty(mt)&&!qe.hasOwnProperty(mt)&&mt!=="layout"&&mt!=="paint"&&mt!=="filter"&&mt!=="metadata"&&mt!=="minzoom"&&mt!=="maxzoom"&&mt!=="slot"&&(mt.indexOf("paint.")===0?ws(qe[mt],Ke[mt],se,ke,mt.slice(6),ri.setPaintProperty):o.bv(qe[mt],Ke[mt])||se.push({command:ri.setLayerProperty,args:[ke,mt,Ke[mt]]}))}else se.push({command:ri.removeLayer,args:[ke]}),pt=Le[Le.lastIndexOf(ke)+1],se.push({command:ri.addLayer,args:[Ke,pt]})}(X,R.layers,N)}catch(V){console.warn("Unable to compute style diff:",V),N=[{command:ri.setStyle,args:[R]}]}return N}(this.serialize(),r).filter(P=>!(P.command in Md));if(g.length===0)return!1;const w=g.filter(P=>!(P.command in du));if(w.length>0)throw new Error(`Unimplemented: ${w.map(P=>P.command).join(", ")}.`);const S=[];return g.forEach(P=>{S.push(this[P.command](...P.args))}),u&&Promise.all(S).then(u).catch(u),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(r){for(const[u,g]of r.entries()){if(this.getImage(u))return this.fire(new o.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,g),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new o.A("data",{dataType:"style"})),this}addImage(r,u){return this.getImage(r)?this.fire(new o.z(new Error(`An image with the name "${r.name}" already exists.`))):(this.imageManager.addImage(r,this.scope,u),this._changes.updateImage(r,this.scope),this._updateWorkerImages(),this.fire(new o.A("data",{dataType:"style"})),this)}updateImage(r,u,g=!1){this.imageManager.updateImage(r,this.scope,u),g&&(this._changes.updateImage(r,this.scope),this._updateWorkerImages(),this.fire(new o.A("data",{dataType:"style"})))}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._changes.updateImage(r,this.scope),this._updateWorkerImages(),this.fire(new o.A("data",{dataType:"style"})),this):this.fire(new o.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(r){return this.modelManager.addModelURLs(r,this.scope),this._updateWorkerModels(),this.fire(new o.A("data",{dataType:"style"})),this}addModel(r,u,g={}){return this._checkLoaded(),this._validate(Ee,`models.${r}`,u,null,g)||(this.modelManager.addModel(r,u,this.scope),this.fire(new o.A("data",{dataType:"style"}))),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this.fire(new o.A("data",{dataType:"style"})),this):this.fire(new o.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,u,g={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(al,`sources.${r}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const w=Ds(r,u,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const S=P=>{const R=(P?"symbol:":"other:")+w.id,N=o.C(R,this.scope),V=this._sourceCaches[R]=new en(N,w,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=V,V.onAdd(this.map)};S(!1),u.type!=="vector"&&u.type!=="geojson"||S(!0),w.onAdd&&w.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const u=this.getOwnSource(r);if(!u)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===r)return this.fire(new o.z(new Error(`Source "${r}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new o.z(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const w=Object.entries(this.stylesheet.iconsets).find(([S,P])=>P.type==="source"&&P.source===r);if(w)return this.fire(new o.z(new Error(`Source "${r}" cannot be removed while iconset "${w[0]}" is using it.`)))}const g=this.getOwnSourceCaches(r);for(const w of g){const S=o.d7(w.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(w.id),w.fire(new o.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,u){this._checkLoaded(),this.getOwnSource(r).setData(u),this._changes.setDirty()}getOwnSource(r){const u=this.getOwnSourceCache(r);return u&&u.getSource()}getOwnSources(){const r=[];for(const u in this._otherSourceCaches){const g=this.getOwnSourceCache(u);g&&r.push(g.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const u in r){const g=r[u]._tiles;for(const w in g){const S=g[w];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const S of r){if(this._validate(Ca,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const P=this.ambientLight;P.set(S),P.updateTransitions(u)}else this.ambientLight=new ki(S,ui||(ui=new o.a7({color:new o.a8(o.a5.properties_light_ambient.color),"color-use-theme":new o.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new o.a8(o.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const P=this.directionalLight;P.set(S),P.updateTransitions(u)}else this.directionalLight=new ki(S,Wi||(Wi=new o.a7({direction:new o.an(o.a5.properties_light_directional.direction),color:new o.a8(o.a5.properties_light_directional.color),"color-use-theme":new o.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new o.a8(o.a5.properties_light_directional.intensity),"cast-shadows":new o.a8(o.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new o.a8(o.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new o.a8(o.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=Object.assign(u,{worldview:this.map.getWorldview()}),w=new o.aa(this.z||0,g);this.ambientLight&&this.ambientLight.recalculate(w),this.directionalLight&&this.directionalLight.recalculate(w),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,u=this.ambientLight;if(!r||!u)return;const g=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),w=r.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),S=r.properties.get("intensity"),P=r.properties.get("direction"),R=1-o.cR(P.x,P.y,P.z)[2]/90,N=g(w)*S*R,V=u.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),G=u.properties.get("intensity"),X=g(V)*G;return Number(((N+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(r==null||r===""&&this.isRootStyle())return this;if(o.d8(r)){const u=o.d9(r),g=this.fragments.find(({id:S})=>S===u);if(!g)return;const w=o.d7(r);return g.style.getFragmentStyle(w)}{const u=this.fragments.find(({id:g})=>g===r);return u?u.style:void 0}}setFeaturesetSelectors(r){if(!r)return;const u={},g=(w,S="")=>`${w}::${S}`;this._featuresetSelectors={};for(const w in r){const S=this._featuresetSelectors[w]=[];for(const P of r[w].selectors){if(P.featureNamespace){const N=this.getOwnLayer(P.layer);if(!N){o.w(`Layer is undefined for selector: ${P.layer}`);continue}const V=g(N.source,N.sourceLayer);if(V in u&&u[V]!==P.featureNamespace){o.w(`"featureNamespace ${P.featureNamespace} of featureset ${w}'s selector is not associated to the same source, skip this selector`);continue}u[V]=P.featureNamespace}let R;if(P.properties)for(const N in P.properties){const V=o.X(P.properties[N]);V.result==="success"&&(R=R||{},R[N]=V.value)}S.push({layerId:P.layer,namespace:P.featureNamespace,properties:R,uniqueFeatureID:P._uniqueFeatureID})}}}getFeaturesetDescriptors(r){const u=this.getFragmentStyle(r);if(!u||!u.stylesheet.featuresets)return[];const g=[];for(const w in u.stylesheet.featuresets)g.push({featuresetId:w,importId:u.scope?u.scope:void 0});return g}getFeaturesetLayers(r,u){const g=this.getFragmentStyle(u),w=g.stylesheet.featuresets;if(!w||!w[r])return this.fire(new o.z(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const S=[];for(const P of w[r].selectors){const R=g.getOwnLayer(P.layer);R&&S.push(R)}return S}getConfigProperty(r,u){const g=this.getFragmentStyle(r);if(!g)return null;const w=o.C(u,g.scope),S=g.options.get(w),P=S?S.value||S.default:null;return P?P.serialize():null}setConfigProperty(r,u,g){const w=this.getFragmentStyle(r);if(!w)return;const S=w.stylesheet.indoor?rs(w.stylesheet.schema):w.stylesheet.schema;if(!S||!S[u])return;const P=o.X(g);if(P.result!=="success")return void zs(this,P.value);const R=P.value.expression,N=o.C(u,w.scope),V=w.options.get(N);if(!V)return;let G;const{minValue:X,maxValue:W,stepValue:Q,type:fe,values:se}=S[u],pe=o.X(S[u].default);pe.result==="success"&&(G=pe.value.expression),G?(this.options.set(N,Object.assign({},V,{value:R,default:G,minValue:X,maxValue:W,stepValue:Q,type:fe,values:se})),this.updateConfigDependencies(u)):this.fire(new o.z(new Error(`No schema defined for the config option "${u}" in the "${r}" fragment.`)))}getConfig(r){const u=this.getFragmentStyle(r);if(!u)return null;const g=u.stylesheet.schema;if(!g)return null;const w={};for(const S in g){const P=o.C(S,u.scope),R=u.options.get(P),N=R?R.value||R.default:null;w[S]=N?N.serialize():null}return w}setConfig(r,u){const g=this.getFragmentStyle(r);g&&(g.updateConfig(u,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const u=this.getFragmentStyle(r);return u?u.stylesheet.schema:null}setSchema(r,u){const g=this.getFragmentStyle(r);g&&(g.stylesheet.schema=u,g.updateConfig(g._config,u),this.updateConfigDependencies())}updateConfig(r,u){if(this._config=r,r||u)if(u)for(const g in u){let w,S;const P=o.X(u[g].default);if(P.result==="success"&&(w=P.value.expression),r&&r[g]!==void 0){const W=o.X(r[g]);W.result==="success"&&(S=W.value.expression)}const{minValue:R,maxValue:N,stepValue:V,type:G,values:X}=u[g];if(w){const W=o.C(g,this.scope);this.options.set(W,{default:w,value:S,minValue:R,maxValue:N,stepValue:V,type:G,values:X})}else this.fire(new o.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new o.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const u of this._configDependentLayers){const g=this.getLayer(u);if(g){if(r&&!g.configDependencies.has(r))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const g=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(g){const w=u._evaluateColorThemeData(g);(!u._styleColorTheme.lut&&w!==""||u._styleColorTheme.lut&&w!==u._styleColorTheme.lut.data)&&u.setColorTheme(g)}}),this._changes.setDirty()}addLayer(r,u,g={}){this._checkLoaded();const w=r.id;if(this._layers[w])return void this.fire(new o.z(new Error(`Layer with id "${w}" already exists on this map`)));let S;if(r.type==="custom"){if(zs(this,o.da(r)))return;S=o.db(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(w,r.source),r=o.d6(r),r=o.h(r,{source:w})),this._validate(Tt,`layers.${w}`,r,{arrayIndex:-1},g))return;S=o.db(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}})}S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid);let P=this._order.length;if(u){const G=this._order.indexOf(u);if(G===-1)return void this.fire(new o.z(new Error(`Layer with id "${u}" does not exist on this map.`)));S.slot===this._layers[u].slot?P=G:o.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=S;const R=this.getOwnLayerSourceCache(S),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();R&&S.canCastShadows()&&N&&(R.castsShadows=!0);const V=this._changes.getRemovedLayer(S);if(V&&S.source&&R&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const G=o.C(S.source,S.scope);V.type!==S.type?this._changes.updateSourceCache(G,"clear"):(this._changes.updateSourceCache(G,"reload"),R.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(r,u){this._checkLoaded();const g=this._checkLayer(r);if(!g||r===u)return;const w=this._order.indexOf(r);this._order.splice(w,1);let S=this._order.length;if(u){const P=this._order.indexOf(u);if(P===-1)return void this.fire(new o.z(new Error(`Layer with id "${u}" does not exist on this map.`)));g.slot===this._layers[u].slot?S=P:o.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const u=this._checkLayer(r);if(!u)return;u.setEventedParent(null);const g=this._order.indexOf(r);this._order.splice(g,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const w=this.getOwnLayerSourceCache(u);if(w&&w.castsShadows){let S=!1;for(const P in this._layers)if(this._layers[P].source===u.source&&this._layers[P].canCastShadows()){S=!0;break}w.castsShadows=S}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const u in this._layers)if(this._layers[u].type===r)return!0;return!1}setLayerZoomRange(r,u,g){this._checkLoaded();const w=this._checkLayer(r);w&&(w.minzoom===u&&w.maxzoom===g||(u!=null&&(w.minzoom=u),g!=null&&(w.maxzoom=g),this._updateLayer(w)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,u){this._checkLoaded();const g=this._checkLayer(r);g&&g.slot!==u&&(g.slot=u,this._updateLayer(g))}setFilter(r,u,g={}){this._checkLoaded();const w=this._checkLayer(r);if(w&&!o.bv(w.filter,u))return u==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(je,`layers.${w.id}.filter`,u,{layerType:w.type},g)||(w.filter=o.d6(u),this._updateLayer(w)))}getFilter(r){const u=this._checkLayer(r);if(u)return o.d6(u.filter)}setLayoutProperty(r,u,g,w={}){this._checkLoaded();const S=this._checkLayer(r);if(S&&!o.bv(S.getLayoutProperty(u),g)){if(g!=null&&(!w||w.validate!==!1)&&zs(S,ge.call(ta,{key:`layers.${r}.layout.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:o.a5,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(u,g),S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)}}getLayoutProperty(r,u){const g=this._checkLayer(r);if(g)return g.getLayoutProperty(u)}setPaintProperty(r,u,g,w={}){this._checkLoaded();const S=this._checkLayer(r);if(!S||o.bv(S.getPaintProperty(u),g)||g!=null&&(!w||w.validate!==!1)&&zs(S,ae.call(ta,{key:`layers.${r}.paint.${u}`,layerType:S.type,objectKey:u,value:g,styleSpec:o.a5})))return;const P=S.setPaintProperty(u,g);S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),P&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(r,u){const g=this._checkLayer(r);if(g)return g.getPaintProperty(u)}setFeatureState(r,u){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:N,importId:V}=r.target,G=this.getFragmentStyle(V),X=G.getFeaturesetLayers(N);for(const{source:W,sourceLayer:Q}of X)G.setFeatureState({id:r.id,source:W,sourceLayer:Q},u)}else if("layerId"in r.target){const{layerId:N}=r.target,V=this.getLayer(N);this.setFeatureState({id:r.id,source:V.source,sourceLayer:V.sourceLayer},u)}return}const g=r.source,w=r.sourceLayer,S=this._checkSource(g);if(!S)return;const P=S.type;if(P==="geojson"&&w)return void this.fire(new o.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!w)return void this.fire(new o.z(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.z(new Error("The feature id parameter must be provided.")));const R=this.getOwnSourceCaches(g);for(const N of R)N.setFeatureState(w,r.id,u)}removeFeatureState(r,u){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:N,importId:V}=r.target,G=this.getFragmentStyle(V),X=G.getFeaturesetLayers(N);for(const{source:W,sourceLayer:Q}of X)G.removeFeatureState({id:r.id,source:W,sourceLayer:Q},u)}else if("layerId"in r.target){const{layerId:N}=r.target,V=this.getLayer(N);this.removeFeatureState({id:r.id,source:V.source,sourceLayer:V.sourceLayer},u)}return}const g=r.source,w=this._checkSource(g);if(!w)return;const S=w.type,P=S==="vector"?r.sourceLayer:void 0;if(S==="vector"&&!P)return void this.fire(new o.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.z(new Error("A feature id is required to remove its specific state property.")));const R=this.getOwnSourceCaches(g);for(const N of R)N.removeFeatureState(P,r.id,u)}getFeatureState(r){if(this._checkLoaded(),"target"in r){let S;if("featuresetId"in r.target){const{featuresetId:P,importId:R}=r.target,N=this.getFragmentStyle(R),V=N.getFeaturesetLayers(P);for(const{source:G,sourceLayer:X}of V){const W=N.getFeatureState({id:r.id,source:G,sourceLayer:X});if(W&&!S)S=W;else if(!o.bv(S,W))return void this.fire(new o.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r.target){const{layerId:P}=r.target,R=this.getLayer(P);S=this.getFeatureState({id:r.id,source:R.source,sourceLayer:R.sourceLayer})}return S}const u=r.source,g=r.sourceLayer,w=this._checkSource(u);if(w){if(w.type!=="vector"||g)return r.id===void 0&&this.fire(new o.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(g,r.id);this.fire(new o.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=o.h({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return o.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),u=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return o.dc({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(r){for(const u of Object.values(this._mergedLayers))r(u)&&this._updateLayer(u)}_updateLayer(r){this._changes.updateLayer(r);const u=this.getLayerSourceCache(r),g=o.C(r.source,r.scope),w=this._changes.getUpdatedSourceCaches();r.source&&!w[g]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),u.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const u=R=>this._mergedLayers[R].is3D(!!this.terrain),g=this.order,w={},S=[];for(let R=g.length-1;R>=0;R--){const N=g[R];if(u(N)){w[N]=R;for(const V of r){const G=V[N];if(G)for(const X of G)S.push(X)}}}S.sort((R,N)=>N.intersectionZ-R.intersectionZ);const P=[];for(let R=g.length-1;R>=0;R--){const N=g[R];if(u(N))for(let V=S.length-1;V>=0;V--){const G=S[V].feature;if(G.layer&&w[G.layer.id]<R)break;P.push(G),S.pop()}else for(const V of r){const G=V[N];if(G)for(const X of G)P.push(X.feature)}}return P}queryRenderedFeatures(r,u,g){let w;u&&!Array.isArray(u)&&u.filter&&(this._validate(je,"queryRenderedFeatures.filter",u.filter,null,u),w=o.b3(u.filter));const S={},P=G=>{if(Od.has(G.type))return;const X=this.getOwnLayerSourceCache(G),W=S[X.id]=S[X.id]||{sourceCache:X,layers:{},has3DLayers:!1};G.is3D(!!this.terrain)&&(W.has3DLayers=!0),W.layers[G.fqid]=W.layers[G.fqid]||{styleLayer:G,targets:[]},W.layers[G.fqid].targets.push({filter:w})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new o.z(new Error("parameters.layers must be an Array."))),[];for(const G of u.layers){const X=this._layers[G];if(!X)return this.fire(new o.z(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];P(X)}}else for(const G in this._layers)P(this._layers[G]);const R=this._queryRenderedFeatures(r,S,g),N=this._flattenAndSortRenderedFeatures(R),V=[];for(const G of N)o.dd(G.layer.id)===this.scope&&V.push(G);return V}queryRenderedFeatureset(r,u,g){let w;u&&!Array.isArray(u)&&u.filter&&(this._validate(je,"queryRenderedFeatures.filter",u.filter,null,u),w=o.b3(u.filter));const S="mock",P=[];if(u&&u.target)P.push(Object.assign({},u,{targetId:S,filter:w}));else{const G=this.getFeaturesetDescriptors();for(const X of G)P.push({targetId:S,filter:w,target:X});for(const{style:X}of this.fragments){const W=X.getFeaturesetDescriptors();for(const Q of W)P.push({targetId:S,filter:w,target:Q})}}const R=this.queryRenderedTargets(r,P,g),N=[],V=new Set;for(const G of R)for(const X of G.variants[S])cr(X,G,V)||N.push(new o.de(G,X));return N}queryRenderedTargets(r,u,g){const w={},S=(R,N,V,G)=>{const X=w[N.id]=w[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};if(X.layers[R.fqid]=X.layers[R.fqid]||{styleLayer:R,targets:[]},R.is3D(!!this.terrain)&&(X.has3DLayers=!0),!G)return V.uniqueFeatureID=!1,void X.layers[R.fqid].targets.push(V);X.layers[R.fqid].targets.push(Object.assign({},V,{namespace:G.namespace,properties:G.properties,uniqueFeatureID:G.uniqueFeatureID}))};for(const R of u)if("featuresetId"in R.target){const{featuresetId:N,importId:V}=R.target,G=this.getFragmentStyle(V);if(!G||!G._featuresetSelectors)continue;const X=G._featuresetSelectors[N];if(!X){this.fire(new o.z(new Error(`The featureset '${N}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of X){const Q=G.getOwnLayer(W.layerId);Q&&!Od.has(Q.type)&&S(Q,G.getOwnLayerSourceCache(Q),R,W)}}else if("layerId"in R.target){const{layerId:N}=R.target,V=this.getLayer(N);if(!V||Od.has(V.type))continue;S(V,this.getLayerSourceCache(V),R)}const P=this._queryRenderedFeatures(r,w,g);return this._flattenAndSortRenderedFeatures(P)}_queryRenderedFeatures(r,u,g){const w=[],S=!!this.map._showQueryGeometry,P=Fi.createFromScreenPoints(r,g);for(const R in u){const N=Kr(P,u[R],this._availableImages,g,S);Object.keys(N).length&&w.push(N)}if(this.placement)for(const R in u){if(!u[R].sourceCache._onlySymbols)continue;const N=ll(P.screenGeometry,u[R],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(N).length&&w.push(N)}return w}querySourceFeatures(r,u){const g=u&&u.filter;g&&this._validate(je,"querySourceFeatures.filter",g,null,u);let w=[];const S=this.getOwnSourceCaches(r);for(const P of S)w=w.concat(So(P,u));return w}addSourceType(r,u,g){return Uo.getSourceType(r)?g(new Error(`A source type called "${r}" already exists.`)):(Uo.setSourceType(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,u,g={}){this._checkLoaded();const w=this.light.getLight();let S=!1;for(const R in r)if(!o.bv(r[R],w[R])){S=!0;break}if(!S)return;const P=this._getTransitionParameters();this.light.setLight(r,u,g),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,u=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=r;const w=r.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const R="terrain-dem-src";this.addSource(R,g.source),g=o.d6(g),g=o.h(g,{source:R})}const S=o.h({},g),P={};if(this.terrain&&w){S.source=this.terrain.get().source;const R=this.terrain?this.getFragmentStyle(this.terrain.scope):null;R&&(P.style=R.serialize())}if(this._validate(hn,"terrain",S,P))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u),this.fire(new o.A("data",{dataType:"style"}))}else{const S=this.terrain,P=S.get();for(const R of Object.keys(o.a5.terrain))!g.hasOwnProperty(R)&&o.a5.terrain[R].default&&(g[R]=o.a5.terrain[R].default);for(const R in r)if(!o.bv(r[R],P[R])){S.set(r,this.options),this.stylesheet.terrain=r;const N=this._getTransitionParameters({duration:0});S.updateTransitions(N),this.fire(new o.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const u=this.fog=new ii(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createSnow(r){const u=this.snow=new _r(r,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createRain(r){const u=this.rain=new ir(r,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!o.bv(u.get(),r)){u.set(r,this.options),this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createFog(r);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(r){if(this._checkLoaded(),!r)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!o.bv(u.get(),r)){u.set(r,this.options),this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createSnow(r);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(r){if(this._checkLoaded(),!r)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!o.bv(u.get(),r)){u.set(r,this.options),this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createRain(r);this._markersNeedUpdate=!0}_reloadColorTheme(){const r=()=>{for(const w in this._layers)this._layers[w].lut=this._styleColorTheme.lut;for(const w in this._sourceCaches)this._sourceCaches[w].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void r();const g=this._evaluateColorThemeData(u);this._loadColorTheme(g).then(()=>{this.fire(new o.A("colorthemeset")),r()}).catch(w=>{o.w(`Couldn't set color theme: ${w}`)})}setColorTheme(r){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&o.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=r,this._reloadColorTheme()}setImportColorTheme(r,u){const g=this.getFragmentStyle(r);g&&(g._styleColorTheme.colorThemeOverride=u,g._reloadColorTheme())}_getTransitionParameters(r){return{now:o.q.now(),transition:o.h(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],u=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?r.push(g):u.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...u)}_createTerrain(r,u){const g=this.terrain=new Xe(r,u,this.scope,this.options,this.map.getWorldview());u===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});g.updateTransitions(w)}_force3DLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="symbol"&&this._updateLayer(u)}}_validate(r,u,g,w,S={}){if(S&&S.validate===!1)return!1;const P=o.h({},this.serialize());return zs(this,r.call(ta,o.h({key:u,style:P,value:g,styleSpec:o.a5},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.df.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(r){const u=this.getSourceCaches(r);for(const g of u)g.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const u=this.getSourceCaches(r);for(const g of u)g.resume(),g.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(r=>{r.modelManager.reloadModels(r.scope)})}updateSources(r){let u;this.directionalLight&&(u=sc(this.directionalLight));const g=new Set;for(const w in this._mergedLayers){const S=this._mergedLayers[w];S.hasElevation()&&!g.has(S.source)&&g.add(S.source)}for(const w in this._mergedSourceCaches){const S=this._mergedSourceCaches[w],P=g.has(S._source.id);S.update(r,void 0,void 0,u,P)}}_generateCollisionBoxes(){for(const r in this._sourceCaches){const u=this._sourceCaches[r];u.resume(),u.reload()}}_updatePlacement(r,u,g,w,S,P,R=!1){let N=!1,V=!1;const G={},X={};for(const W of this._mergedOrder){const Q=this._mergedLayers[W];if(Q.type!=="symbol")continue;const fe=o.C(Q.source,Q.scope);let se=G[fe];if(!se){const ye=this.getLayerSourceCache(Q);if(!ye)continue;const we=ye.getRenderableIds(!0).map(De=>ye.getTileByID(De));X[fe]=we.slice(),se=G[fe]=we.sort((De,Le)=>Le.tileID.overscaledZ-De.tileID.overscaledZ||(De.tileID.isLessThan(Le.tileID)?-1:1))}const pe=this.crossTileSymbolIndex.addLayer(Q,se,u.center.lng,u.projection);N=N||pe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),R=R||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new o.A("neworder")),(R||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),u.zoom))&&(this.pauseablePlacement=new Lh(u,this._mergedOrder,R,g,w,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,G,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),V=!0),N&&this.pauseablePlacement.placement.setStale()),V||N){this._buildingIndex.onNewFrame(u.zoom);for(let W=0;W<this._mergedOrder.length;W++){const Q=this._mergedLayers[this._mergedOrder[W]];if(Q.type!=="symbol")continue;const fe=this.isLayerClipped(Q);this.placement.updateLayerOpacities(Q,G[o.C(Q.source,Q.scope)],W,fe?P:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,u){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:S})=>S===r.id)!==-1)return void this.fire(new o.z(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!u)return g.push(r),this._loadImports([r],!0);const w=g.findIndex(({id:S})=>S===u);return w===-1&&this.fire(new o.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,w).concat(r).concat(g.slice(w)),this._loadImports([r],!0,u)}updateImport(r,u){this._checkLoaded();const g=this.stylesheet.imports||[],w=this.getImportIndex(r);return w===-1?this:typeof u=="string"?(this.setImportUrl(r,u),this):(u.url&&u.url!==g[w].url&&this.setImportUrl(r,u.url),o.bv(u.config,g[w].config)||this.setImportConfig(r,u.config,u.data.schema),o.bv(u.data,g[w].data)||this.setImportData(r,u.data),this)}moveImport(r,u){this._checkLoaded();let g=this.stylesheet.imports||[];const w=this.getImportIndex(r);if(w===-1)return this;const S=this.getImportIndex(u);if(S===-1)return this;const P=g[w],R=this.fragments[w];return g=g.filter(({id:N})=>N!==r),this.fragments=this.fragments.filter(({id:N})=>N!==r),this.stylesheet.imports=g.slice(0,S).concat(P).concat(g.slice(S)),this.fragments=this.fragments.slice(0,S).concat(R).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(r,u){this._checkLoaded();const g=this.stylesheet.imports||[],w=this.getImportIndex(r);if(w===-1)return this;g[w].url=u;const S=this.fragments[w];return S.style=this._createFragmentStyle(g[w]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(u),this}setImportData(r,u){this._checkLoaded();const g=this.getImportIndex(r),w=this.stylesheet.imports||[];return g===-1?this:u?(this.fragments[g].style.setState(u),this._reloadImports(),this):(delete w[g].data,this.setImportUrl(r,w[g].url))}setImportConfig(r,u,g){this._checkLoaded();const w=this.getImportIndex(r),S=this.stylesheet.imports||[];if(w===-1)return this;u?S[w].config=u:delete S[w].config;const P=this.fragments[w];g&&P.style.stylesheet&&(P.style.stylesheet.schema=g);const R=P.style.stylesheet&&P.style.stylesheet.schema;return P.config=u,P.style.updateConfig(u,R),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const u=this.stylesheet.imports||[],g=this.getImportIndex(r);g!==-1&&(u.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(r){const u=(this.stylesheet.imports||[]).findIndex(g=>g.id===r);return u===-1&&this.fire(new o.z(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),u}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const u in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[u];g&&r.push(g.getSource())}return r}getSource(r,u){const g=this.getSourceCache(r,u);return g&&g.getSource()}getLayerSource(r){const u=this.getLayerSourceCache(r);return u&&u.getSource()}getSourceCache(r,u){const g=o.C(r,u);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(r){const u=o.C(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[r]&&u.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&u.push(this._mergedSymbolSourceCaches[r]),u}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const u in r){const g=r[u];g==="reload"?this.reloadSource(u):g==="clear"&&this.clearSource(u)}}updateLayers(r){const u=this._changes.getUpdatedPaintProperties();for(const g of u){const w=this.getLayer(g);w&&w.updateTransitions(r)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(r){this.stylesheet.glyphs=r,this.glyphManager.setURL(r,this.scope)}getImages(r,u,g){this.imageManager.getImages(u.images,u.scope,g),this._updateTilesForChangedImages();const w=P=>{if(P){const R=u.images.map(N=>o.I.toString(N));P.setDependencies(u.tileID.key,u.type,R)}},S=o.C(u.source,u.scope);w(this._mergedOtherSourceCaches[S]),w(this._mergedSymbolSourceCaches[S])}rasterizeImages(r,u,g){this.imageManager.rasterizeImages(u,g)}getGlyphs(r,u,g){this.glyphManager.getGlyphs(u.stacks,u.scope,g)}getResource(r,u,g){return o.dg(u,g)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const u=[];return this._otherSourceCaches[r]&&u.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&u.push(this._symbolSourceCaches[r]),u}_isSourceCacheLoaded(r){const u=this.getOwnSourceCaches(r);return u.length===0?(this.fire(new o.z(new Error(`There is no source with ID '${r}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,u){if(!this._clipLayerPresent&&r.type!=="fill-extrusion"&&r.type!=="building")return!1;const g=r.type==="fill-extrusion"&&r.sourceLayer==="building",w=r.type==="building";if(r.is3D(!!this.terrain)){if(g||w||u&&u.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Uo.getSourceType=function(m){return Hs[m]},Uo.setSourceType=function(m,r){Hs[m]=r},Uo.registerForPluginStateChange=o.dh;var $c=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,_p=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Fh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Uh="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",fu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,vf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,cc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,pa=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,uc=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,fn=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Zs=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Wl=[];Bs($c,Wl),Bs(Fh,Wl),Bs(_p,Wl);const ks={"_prelude_fog.vertex.glsl":vf,"_prelude_terrain.vertex.glsl":fu,"_prelude_shadow.vertex.glsl":fn,"_prelude_fog.fragment.glsl":cc,"_prelude_shadow.fragment.glsl":Zs,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":pa,"_prelude_raster_particle.glsl":uc},qc={};Oi("",fu),Oi(cc,vf),Oi(Zs,fn),Oi(pa,""),Oi(uc,"");const Hc=Oi(_p,Fh),Ns=$c;var Gc={background:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:Oi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Oi("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Oi(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Oi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Oi("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Oi("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Oi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:Oi(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:Oi(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Oi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Oi(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Oi(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Oi(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Oi("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Oi("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Oi(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Oi(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Oi("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Oi(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Uh),skyboxGradient:Oi(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Uh),skyboxCapture:Oi(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Oi(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Oi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Oi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Oi(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Oi("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Oi("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Oi("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Oi("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Bs(m,r){const u=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=g.split(" ");for(const S of w)r.includes(S)||r.push(S)}}function Oi(m,r){const u=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(V=>{const G=V.split(" ");return G[G.length-1]}),w=[...new Set(w)]);const S={},P=[],R=[];if(m=m.replace(u,(V,G)=>(R.push(G),"")),(r=r.replace(u,(V,G)=>(P.push(G),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let N=[...Wl];Bs(m,N),Bs(r,N);for(const V of[...P,...R])ks[V]||console.error(`Undefined include: ${V}`),qc[V]||(qc[V]=[],Bs(ks[V],qc[V])),N=[...N,...qc[V]];return{fragmentSource:m=m.replace(g,(V,G,X,W,Q)=>(S[Q]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
in ${X} ${W} ${Q};
#else
uniform ${X} ${W} u_${Q};
#endif
`:G==="initialize"?`
#ifdef HAS_UNIFORM_u_${Q}
    ${X} ${W} ${Q} = u_${Q};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${X} ${W} ${Q};
#endif
`:G==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(g,(V,G,X,W,Q)=>{const fe=W==="float"?"vec2":W,se=Q.match(/color/)?"color":fe;return G==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
in ${X} ${W} a_${Q};
#endif
`:S[Q]?G==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${X} ${fe} a_${Q};
out ${X} ${W} ${Q};
#else
uniform ${X} ${W} u_${Q};
#endif
`:G==="initialize"?se==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${X} ${W} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${se}(a_${Q}, u_${Q}_t);
#else
    ${X} ${W} ${Q} = u_${Q};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${X} ${W} a_${Q};
    out ${X} ${W} ${Q};
#endif
`:G==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${Q} = a_${Q};
#endif
`:void 0:G==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${X} ${fe} a_${Q};
#else
uniform ${X} ${W} u_${Q};
#endif
`:G==="define-instanced"?se==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Q}0;
in vec4 a_${Q}1;
in vec4 a_${Q}2;
in vec4 a_${Q}3;
#else
uniform ${X} ${W} u_${Q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${fe} a_${Q};
#else
uniform ${X} ${W} u_${Q};
#endif
`:G==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${X} ${W} ${Q} = a_${Q};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${X} ${W} ${Q} = a_${Q};
#else
    ${X} ${W} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${X} ${W} ${Q} = unpack_mix_${se}(a_${Q}, u_${Q}_t);
#else
    ${X} ${W} ${Q} = u_${Q};
#endif
`}),staticAttributes:w,usedDefines:N,vertexIncludes:P,fragmentIncludes:R}}class kl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,u,g,w,S,P,R,N){this.context=r;let V=this.boundPaintVertexBuffers.length!==w.length;for(let X=0;!V&&X<w.length;X++)this.boundPaintVertexBuffers[X]!==w[X]&&(V=!0);let G=this.boundDynamicVertexBuffers.length!==R.length;for(let X=0;!G&&X<R.length;X++)this.boundDynamicVertexBuffers[X]!==R[X]&&(G=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||V||G||this.boundIndexBuffer!==S||this.boundVertexOffset!==P)this.freshBind(u,g,w,S,P,R,N);else{r.bindVertexArrayOES.set(this.vao);for(const X of R)X&&(X.bind(),N&&X.instanceCount&&X.setVertexAttribDivisor(r.gl,u,N));S&&S.dynamicDraw&&S.bind()}}freshBind(r,u,g,w,S,P,R){const N=r.numAttributes,V=this.context,G=V.gl;this.vao&&this.destroy(),this.vao=V.gl.createVertexArray(),V.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=w,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=P,u.enableAttributes(G,r),u.bind(),u.setVertexAttribPointers(G,r,S);for(const X of g)X.enableAttributes(G,r),X.bind(),X.setVertexAttribPointers(G,r,S);for(const X of P)X&&(X.enableAttributes(G,r),X.bind(),X.setVertexAttribPointers(G,r,S),R&&X.instanceCount&&X.setVertexAttribDivisor(G,r,R));w&&w.bind(),V.currentNumAttributes=N}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function bm(m,r){const u=Math.pow(2,r.canonical.z),g=r.canonical.y;return[new o.ac(0,g/u).toLngLat().lat,new o.ac(0,(g+1)/u).toLngLat().lat]}function El(m,r,u,g,w,S,P){const R=m.context,N=R.gl,V=u.hillshadeFBO;if(!V)return;m.prepareDrawTile();const G=m.isTileAffectedByFog(r),X=m.getOrCreateProgram("hillshade",{overrideFog:G});R.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,V.colorAttachment.get());const W=((pe,ye,we,De)=>{const Le=we.paint.get("hillshade-shadow-color"),Ze=we.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ue=we.paint.get("hillshade-highlight-color"),Fe=we.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",ke=we.paint.get("hillshade-accent-color"),qe=we.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ke=we.paint.get("hillshade-emissive-strength");let pt=o.al(we.paint.get("hillshade-illumination-direction"));if(we.paint.get("hillshade-illumination-anchor")==="viewport")pt-=pe.transform.angle;else if(pe.style&&pe.style.enable3dLights()&&pe.style.directionalLight){const It=pe.style.directionalLight.properties.get("direction"),Nt=o.cR(It.x,It.y,It.z);pt=o.al(Nt[1])}const mt=!pe.options.moving;return{u_matrix:De||pe.transform.calculateProjMatrix(ye.tileID.toUnwrapped(),mt),u_image:0,u_latrange:bm(0,ye.tileID),u_light:[we.paint.get("hillshade-exaggeration"),pt],u_shadow:Le.toPremultipliedRenderColor(Ze?null:we.lut),u_highlight:Ue.toPremultipliedRenderColor(Fe?null:we.lut),u_emissive_strength:Ke,u_accent:ke.toPremultipliedRenderColor(qe?null:we.lut)}})(m,u,g,m.terrain?r.projMatrix:null);m.uploadCommonUniforms(R,X,r.toUnwrapped());const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:fe,tileBoundsSegments:se}=m.getTileBoundsBuffers(u);X.draw(m,N.TRIANGLES,w,S,P,li.disabled,W,g.id,Q,fe,se)}function Qu(m,r,u){if(!r.needsDEMTextureUpload)return;const g=m.context,w=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||m.getTileTexture(u.stride);const S=u.getPixels();r.demTexture?r.demTexture.update(S,{premultiply:!1}):r.demTexture=new o.T(g,S,w.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function hc(m,r,u){const g=m.context,w=g.gl;if(!r.dem)return;const S=r.dem;if(g.activeTexture.set(w.TEXTURE1),Qu(m,r,S),!r.demTexture)return;r.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const P=S.dim;g.activeTexture.set(w.TEXTURE0);let R=r.hillshadeFBO;if(!R){const W=new o.T(g,{width:P,height:P,data:null},w.RGBA8);W.bind(w.LINEAR,w.CLAMP_TO_EDGE),R=r.hillshadeFBO=g.createFramebuffer(P,P,!0,"renderbuffer"),R.colorAttachment.set(W.texture)}g.bindFramebuffer.set(R.framebuffer),g.viewport.set([0,0,P,P]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:V,tileBoundsSegments:G}=m.getMercatorTileBoundsBuffers(),X=[];m.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(m,w.TRIANGLES,Tn.disabled,di.disabled,Ri.unblended,li.disabled,((W,Q)=>{const fe=Q.stride,se=o.bz();return o.c5(se,0,o.aj,-8192,0,0,1),o.bo(se,se,[0,-8192,0]),{u_matrix:se,u_image:1,u_dimension:[fe,fe],u_zoom:W.overscaledZ}})(r.tileID,S),u.id,N,V,G),r.needsHillshadePrepare=!1}class Jr{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Vh extends Jr{getDefault(){return o.am.transparent.toNonPremultipliedRenderColor(null)}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class dc extends Jr{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class yp extends Jr{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class xf extends Jr{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class eh extends Jr{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class $h extends Jr{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class b extends Jr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class z extends Jr{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class $ extends Jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class ne extends Jr{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ve extends Jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class Be extends Jr{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class _t extends Jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class Wt extends Jr{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ln extends Jr{getDefault(){return o.am.transparent.toNonPremultipliedRenderColor(null)}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Un extends Jr{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class yi extends Jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class Ti extends Jr{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Ai extends Jr{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let br=class extends Jr{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Wo extends Jr{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class ba extends Jr{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Da extends Jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Ws extends Jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Id extends Jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class bf extends Jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class pu extends Jr{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class fc extends Jr{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class vp extends Jr{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class th extends Jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class ma extends Jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ss extends Jr{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class pc extends Ss{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Zc extends Ss{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Wc extends Ss{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Dd extends Zc{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const qh=(m,r,u)=>({u_matrix:m,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:u}),mu=(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:w,u_merc_center:S,u_image0:0,u_frustum_tl:P,u_frustum_tr:R,u_frustum_br:N,u_frustum_bl:V,u_globe_pos:G,u_globe_radius:X,u_viewport:W,u_grid_matrix:se?Float32Array.from(se):new Float32Array(9),u_skirt_height:Q,u_far_z_cutoff:fe});function Rd(m,r){return m!=null&&r!=null&&!(!m.hasData()||!r.hasData())&&m.demTexture!=null&&r.demTexture!=null&&m.tileID.key!==r.tileID.key}const Nl=new class{constructor(){this.operations={}}newMorphing(m,r,u,g,w){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==u.tileID.key&&(S.queued=u)}else this.operations[m]={startTime:g,phase:0,duration:w,from:r,to:u,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const r=this.operations[m];return{from:r.from,to:r.to,phase:r.phase}}update(m){for(const r in this.operations){const u=this.operations[r];for(u.phase=(m-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,m)){delete this.operations[r];break}}}_nextOp(m,r){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=r,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},js={0:null,1:"TERRAIN_VERTEX_MORPHING"};function wf(m,r,u){if(r===0)return 0;const g=r<1&&u===514?.25/r:1;return 6*Math.pow(1.5,22-m)*Math.max(r,1)*g}function yy(m,r){const u=1<<m.z;return!r&&(m.x===0||m.x===u-1)||m.y===0||m.y===u-1}const Ld=m=>({u_matrix:m});function zd(m,r,u,g,w){if(w>0){const S=o.q.now(),P=(S-m.timeAdded)/w,R=r?(S-r.timeAdded)/w:-1,N=u.getSource(),V=g.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),G=!r||Math.abs(r.tileID.overscaledZ-V)>Math.abs(m.tileID.overscaledZ-V),X=G&&m.refreshedUponExpiration?1:o.ay(G?P:1-R,0,1);return m.refreshedUponExpiration&&P>=1&&(m.refreshedUponExpiration=!1),r?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class vy extends en{constructor(r){const u={type:"raster-dem",maxzoom:r.transform.maxZoom},g=new o.D(o.c$(),null),w=Ds("mock-dem",u,g,r.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,u){r.state="loaded",u(null)}}class Oo extends en{constructor(r){const u=Ds("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new o.D(o.c$(),null),r.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,u,g){if(r.freezeTileCoverage)return;this.transform=r;const w=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,P)=>{if(S[P.key]="",!this._tiles[P.key]){const R=new cs(P,this._source.tileSize*P.overscaleFactor(),r.tileZoom,void 0,void 0,this._source.worldview);R.state="loaded",this._tiles[P.key]=R}return S},{});for(const S in this._tiles)S in w||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(r){const u=this.proxyCachedFBO[r];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Tf extends o.aM{constructor(r,u,g){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class nh extends o.dt{constructor(r,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,w,S]=function(N){const V=new o.ba,G=new o.a_,X=131;V.reserve(17161),G.reserve(33800);const W=o.aj/128,Q=o.aj+W/2,fe=Q+W;for(let pe=-64;pe<fe;pe+=W)for(let ye=-64;ye<fe;ye+=W){const we=ye<0||ye>Q||pe<0||pe>Q?24575:0,De=o.ay(Math.round(ye),0,o.aj),Le=o.ay(Math.round(pe),0,o.aj);V.emplaceBack(De+we,Le)}const se=(pe,ye)=>{const we=ye*X+pe;G.emplaceBack(we+1,we,we+X),G.emplaceBack(we+X,we+X+1,we+1)};for(let pe=1;pe<129;pe++)for(let ye=1;ye<129;ye++)se(ye,pe);return[0,129].forEach(pe=>{for(let ye=0;ye<130;ye++)se(ye,pe),se(pe,ye)}),[V,G,32768]}(),P=r.context;this.gridBuffer=P.createVertexBuffer(g,o.bc.members),this.gridIndexBuffer=P.createIndexBuffer(w),this.gridSegments=o.bd.simpleSegment(0,0,g.length,w.length),this.gridNoSkirtSegments=o.bd.simpleSegment(0,0,g.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Oo(u.map),this.orthoMatrix=o.bz(),o.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.aj,0,o.aj,0,1);const R=P.gl;this._overlapStencilMode=new di({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new vy(u.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,u,g){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const w=r.terrain.properties,S=r.terrain.drapeRenderMode===0,P=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const R=r.terrain&&r.terrain.scope,N=w.get("source"),V=S?this._mockSourceCache:r.getSourceCache(N,R);if(!V)return void o.w(`Couldn't find terrain source "${N}".`);if(this.sourceCache=V,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=P?this.calculateExaggeration(u):w.get("exaggeration"),!u.projection.requiresDraping&&P&&this._exaggeration===0)return void this._disable();this.enabled=!0;const G=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(u,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,G(),this._initializing=!0),G(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const u=this._previousCameraAltitude,g=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=g;const w=u!=null?g-u:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const S=r.zoom,P=this._style.terrain;if(!this._previousUpdateTimestamp)return P.getExaggeration(S);let R=S-this._previousZoom;const N=this._previousUpdateTimestamp;let V=S;this._evaluationZoom!=null&&(V=this._evaluationZoom,Math.abs(S-V)>.5&&(R=.5*(S-V+R)),R*w<0&&(V+=R)),this._evaluationZoom=V;const G=P.getExaggeration(V),X=G===P.getExaggeration(Math.max(0,V-.1));if(X&&Math.abs(G-this._exaggeration)<.01)return G;let W=Math.min(.1,.00375*(this._updateTimestamp-N));return(X||G<.1||Math.abs(R)<1e-4)&&(W=Math.min(.2,4*W)),o.ai(this._exaggeration,G,W)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(o.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=u.getIds().map(N=>{const V=u.getTileByID(N).tileID;return V.projMatrix=g.calculateProjMatrix(V.toUnwrapped()),V});(function(N,V){const G=V.transform.pointCoordinate(V.transform.getCameraPoint()),X=new o.P(G.x,G.y);N.sort((W,Q)=>{if(Q.overscaledZ-W.overscaledZ)return Q.overscaledZ-W.overscaledZ;const fe=new o.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),se=new o.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),pe=X.mult(1<<W.canonical.z);return pe.x-=.5,pe.y-=.5,pe.distSqr(fe)-pe.distSqr(se)})})(w,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},w.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const P=this._style._mergedSourceCaches;for(const N in P){const V=P[N];if(!V.used||(V!==this.sourceCache&&this.resetTileLookupCache(V.id),this._setupProxiedCoordsForOrtho(V,r[N],S),V.usedForTerrain))continue;const G=r[N];V.getSource().reparseOverscaled&&this._assignTerrainTiles(G)}this.proxiedCoords[u.id]=w.map(N=>new Tf(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const R={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const V=this.terrainTileForTile[N.key];if(!V)continue;const G=V.tileID.key;G in R||(this._visibleDemTiles.push(V),R[G]=G)}}_assignTerrainTiles(r){this._initializing||r.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const r=this.painter.context,u=r.gl;for(const g in this.terrainTileForTile){const w=this.terrainTileForTile[g],S=w.dem;!S||w.demTexture&&!w.needsDEMTextureUpload||(r.activeTexture.set(u.TEXTURE1),Qu(this.painter,w,S))}}_prepareDemTileUniforms(r,u,g,w){if(!u||u.demTexture==null)return!1;const S=r.tileID.canonical,P=Math.pow(2,u.tileID.canonical.z-S.z),R=w||"";return g[`u_dem_tl${R}`]=[S.x*P%1,S.y*P%1],g[`u_dem_scale${R}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const u=this._visibleDemTiles.reduce((g,w)=>{if(!w.dem)return g;const S=w.dem.tree.minimums[0];return S>0&&r++,g+S},0);return r?u/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,u=r.gl;r.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),w=new o.du({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(w,{premultiply:!1}):S=this._emptyDEMTexture=new o.T(r,w,u.R32F,{premultiply:!1}),S}setupElevationDraw(r,u,g){const w=this.painter.context,S=w.gl,P={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};P.u_exaggeration=this.exaggeration();let R=null,N=null,V=1;if(g&&g.morphing&&this._useVertexMorphing){const Q=g.morphing.srcDemTile,fe=g.morphing.dstDemTile;V=g.morphing.phase,Q&&fe&&(this._prepareDemTileUniforms(r,Q,P,"_prev")&&(N=Q),this._prepareDemTileUniforms(r,fe,P)&&(R=fe))}const G=Q=>Q&&Q.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let X=null;var W;if(this.enabled?N&&R?(X=R.demTexture,w.activeTexture.set(S.TEXTURE4),N.demTexture.bind(G(N),S.CLAMP_TO_EDGE),P.u_dem_lerp=V):(R=this.terrainTileForTile[r.tileID.key],X=this._prepareDemTileUniforms(r,R,P)?R.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,w.activeTexture.set(S.TEXTURE2),X&&(P.u_dem_size=(W=X).size[0]===1?1:W.size[0]-2,X.bind(G(R),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,u,P),g&&g.useMeterToDem&&R){const Q=(1<<R.tileID.canonical.z)*o.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=Q}if(g&&g.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(w,P),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,r.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(w,Q)}}globeUniformValues(r,u,g){const w=r.projection;return{u_tile_tl_up:w.upVector(u,0,0),u_tile_tr_up:w.upVector(u,o.aj,0),u_tile_br_up:w.upVector(u,o.aj,o.aj),u_tile_bl_up:w.upVector(u,0,o.aj),u_tile_up_scale:g?o.dv(1):w.upVectorScale(u,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const u=this.painter,g=this.painter.context;r.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,S,P,R,N){if(w.transform.projection.name==="globe")(function(V,G,X,W,Q){const fe=V.context,se=fe.gl;let pe,ye;const we=V.transform,De=o.dl(V,fe,we),Le=(It,Nt)=>{if(ye===Nt)return;const Xt=[js[Nt],"PROJECTION_GLOBE_VIEW"];De&&Xt.push("CUSTOM_ANTIALIASING");const ut=V.isTileAffectedByFog(It);pe=V.getOrCreateProgram("globeRaster",{defines:Xt,overrideFog:ut}),ye=Nt},Ze=V.colorModeForRenderPass(),Ue=new Tn(se.LEQUAL,Tn.ReadWrite,V.depthRangeFor3D);Nl.update(Q);const Fe=o.dm(we),ke=[o.aD(we.center.lng),o.aH(we.center.lat)],qe=V.globeSharedBuffers,Ke=[we.width*o.q.devicePixelRatio,we.height*o.q.devicePixelRatio],pt=Float32Array.from(we.globeMatrix),mt={useDenormalizedUpVectorScale:!0};{const It=V.transform,Nt=wf(It.zoom,G.exaggeration(),G.sourceCache._source.tileSize);ye=-1;const Xt=se.TRIANGLES;for(const ut of W){const Et=X.getTile(ut),at=di.disabled,jt=G.prevTerrainTileForTile[ut.key],wt=G.terrainTileForTile[ut.key];Rd(jt,wt)&&Nl.newMorphing(ut.key,jt,wt,Q,250),fe.activeTexture.set(se.TEXTURE0),Et.texture&&Et.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Ht=Nl.getMorphValuesForProxy(ut.key),pn=Ht?1:0;Ht&&o.L(mt,{morphing:{srcDemTile:Ht.from,dstDemTile:Ht.to,phase:o.dk(Ht.phase)}});const Ft=o.dn(ut.canonical),rn=o.dp(Ft.getCenter().lat),Bn=o.dq(ut.canonical,Ft,rn,It.worldSize/It._pixelsPerMercatorPixel),Dn=o.bh(o.dr(ut.canonical)),On=mu(It.expandedFarZProjMatrix,pt,Fe,Dn,o.ah(It.zoom),ke,It.frustumCorners.TL,It.frustumCorners.TR,It.frustumCorners.BR,It.frustumCorners.BL,It.globeCenterInViewSpace,It.globeRadius,Ke,Nt,It._farZ,Bn);if(Le(ut,pn),pe&&(G.setupElevationDraw(Et,pe,mt),V.uploadCommonUniforms(fe,pe,ut.toUnwrapped()),qe)){const[Yn,ni,Rn]=qe.getGridBuffers(rn,Nt!==0);pe.draw(V,Xt,Ue,at,Ze,li.backCCW,On,"globe_raster",Yn,ni,Rn)}}}if(qe&&(V.renderDefaultNorthPole||V.renderDefaultSouthPole)){const It=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];De&&It.push("CUSTOM_ANTIALIASING"),pe=V.getOrCreateProgram("globeRaster",{defines:It});for(const Nt of W){const{x:Xt,y:ut,z:Et}=Nt.canonical,at=ut===0,jt=ut===(1<<Et)-1,[wt,Ht,pn,Ft]=qe.getPoleBuffers(Et,!1);if(Ft&&(at||jt)){const rn=X.getTile(Nt);fe.activeTexture.set(se.TEXTURE0),rn.texture&&rn.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);let Bn=o.ds(Et,Xt,we);const Dn=o.bh(o.dr(Nt.canonical)),On=(Yn,ni)=>Yn.draw(V,se.TRIANGLES,Ue,di.disabled,Ze,li.disabled,mu(we.expandedFarZProjMatrix,Bn,Bn,Dn,0,ke,we.frustumCorners.TL,we.frustumCorners.TR,we.frustumCorners.BR,we.frustumCorners.BL,we.globeCenterInViewSpace,we.globeRadius,Ke,0,we._farZ),"globe_pole_raster",ni,pn,Ft);G.setupElevationDraw(rn,pe,mt),V.uploadCommonUniforms(fe,pe,Nt.toUnwrapped()),at&&V.renderDefaultNorthPole&&On(pe,wt),jt&&V.renderDefaultSouthPole&&(Bn=o.cE(o.bz(),Bn,[1,-1,1]),On(pe,Ht))}}}})(w,S,P,R,N);else{const V=w.context,G=V.gl;let X,W;const Q=w.shadowRenderer,fe=ac(w,w.longestCutoffRange),se=Ze=>{if(W===Ze)return;const Ue=[];Ue.push(js[Ze]),fe.shouldRenderCutoff&&Ue.push("RENDER_CUTOFF"),Q&&(Ue.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Q.useNormalOffset&&Ue.push("NORMAL_OFFSET")),X=w.getOrCreateProgram("terrainRaster",{defines:Ue}),W=Ze},pe=w.colorModeForRenderPass(),ye=new Tn(G.LEQUAL,Tn.ReadWrite,w.depthRangeFor3D);Nl.update(N);const we=w.transform,De=wf(we.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let Le=[0,0,0];if(Q){const Ze=w.style.directionalLight,Ue=w.style.ambientLight;Ze&&Ue&&(Le=Uc(w.style,Ze,Ue))}{W=-1;const Ze=G.TRIANGLES,[Ue,Fe]=[S.gridIndexBuffer,S.gridSegments];for(const ke of R){const qe=P.getTile(ke),Ke=di.disabled,pt=S.prevTerrainTileForTile[ke.key],mt=S.terrainTileForTile[ke.key];Rd(pt,mt)&&Nl.newMorphing(ke.key,pt,mt,N,250),V.activeTexture.set(G.TEXTURE0),qe.texture&&qe.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const It=Nl.getMorphValuesForProxy(ke.key),Nt=It?1:0;let Xt;It&&(Xt={morphing:{srcDemTile:It.from,dstDemTile:It.to,phase:o.dk(It.phase)}});const ut=qh(ke.projMatrix,yy(ke.canonical,we.renderWorldCopies)?De/10:De,Le);if(se(Nt),!X)continue;S.setupElevationDraw(qe,X,Xt);const Et=ke.toUnwrapped();Q&&Q.setupShadows(Et,X),w.uploadCommonUniforms(V,X,Et,null,fe),X.draw(w,Ze,ye,Ke,pe,li.backCCW,ut,"terrain_raster",S.gridBuffer,Ue,Fe)}}}}(u,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,w=this.proxySourceCache,S=this.proxiedCoords[w.id],P=this._drapedRenderBatches.shift(),R=u.style.order,N=[];let V=0;for(const G of S){const X=w.getTileByID(G.proxyTileKey),W=w.proxyCachedFBO[G.key]?w.proxyCachedFBO[G.key][r]:void 0,Q=W!==void 0?w.renderCache[W]:this.pool[V++],fe=W!==void 0;if(X.texture=Q.tex,fe&&!Q.dirty){N.push(X.tileID);continue}let se;g.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(g.clear({color:o.am.transparent,stencil:0}),Q.dirty=!1);for(let pe=P.start;pe<=P.end;++pe){const ye=u.style._mergedLayers[R[pe]];if(ye.isHidden(u.transform.zoom))continue;const we=u.style.getLayerSourceCache(ye),De=we?this.proxyToSource[G.key][we.id]:[G];if(!De)continue;const Le=De;g.viewport.set([0,0,Q.fb.width,Q.fb.height]),se!==(we?we.id:null)&&(this._setupStencil(Q,De,ye,we),se=we?we.id:null),u.renderLayer(u,we,ye,Le)}if(this._drapedRenderBatches.length===0)for(const pe of this._pendingGroundEffectLayers){const ye=u.style._mergedLayers[R[pe]];if(ye.isHidden(u.transform.zoom))continue;const we=u.style.getLayerSourceCache(ye),De=we?this.proxyToSource[G.key][we.id]:[G];if(!De)continue;const Le=De;g.viewport.set([0,0,Q.fb.width,Q.fb.height]),se!==(we?we.id:null)&&(this._setupStencil(Q,De,ye,we),se=we?we.id:null),u.renderLayer(u,we,ye,Le)}this.renderedToTile?(Q.dirty=!0,N.push(X.tileID)):fe||--V,V===5&&(V=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),P.end+1}postRender(){}isLayerOrderingCorrect(r){const u=r.order.length;let g=-1,w=u;for(let S=0;S<u;++S)this._style.isLayerDraped(r._mergedLayers[r.order[S]])?g=Math.max(g,S):w=Math.min(w,S);return w>g}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{r=Math.min(r,u.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,u,g){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const P=S.tileID,R=1<<P.overscaledZ,{x:N,y:V}=P.canonical,G=N/R,X=(N+1)/R,W=V/R,Q=(V+1)/R;return{minx:G,miny:W,maxx:X,maxy:Q,t:S.dem.tree.raycastRoot(G,W,X,Q,r,u,g),tile:S}});w.sort((S,P)=>(S.t!==null?S.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const S of w){if(S.t==null)return null;const P=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,r,u,g);if(P!=null)return P}return null}_createFBO(){const r=this.painter.context,u=r.gl,g=this.drapeBufferSize;r.activeTexture.set(u.TEXTURE0);const w=new o.T(r,{width:g[0],height:g[1],data:null},u.RGBA8);w.bind(u.LINEAR,u.CLAMP_TO_EDGE);const S=r.createFramebuffer(g[0],g[1],!0,null);return S.colorAttachment.set(w.texture),S.depthAttachment=new Dd(r,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:S,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const u=this._style._mergedLayers[r],g=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const g of this._style.getSources())if(g instanceof Xi){r=!0;break}if(!r)return;const u={};for(let g=0;g<this._style.order.length;++g){const w=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(w);if(S&&!u[S.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof o.ab){u[S.id]=!0;for(const P of this.proxyCoords){const R=this.proxyToSource[P.key][S.id];if(R)for(const N of R)this._clearRenderCacheForTile(S.id,N)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof or){r=!0;break}if(!r)return;const u={};for(let g=0;g<this._style.order.length;++g){const w=this._style._mergedLayers[this._style.order[g]],S=this._style.getLayerSourceCache(w);if(!S||u[S.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const P=w.paint.get("raster-fade-duration");for(const R of this.proxyCoords){const N=this.proxyToSource[R.key][S.id];if(N)for(const V of N){const G=zd(S.getTile(V),S.findLoadedParent(V,0),S,this.painter.transform,P);(G.opacity!==1||G.mix!==0)&&this._clearRenderCacheForTile(S.id,V)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const r=this._style.order,u=r.length;if(u===0)return;const g=[];this._pendingGroundEffectLayers=[];let w,S=0,P=this._style._mergedLayers[r[S]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++S<u;)P=this._style._mergedLayers[r[S]];for(;S<u;++S){const R=this._style._mergedLayers[r[S]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?w===void 0&&(w=S):(R.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),w!==void 0&&(g.push({start:w,end:S-1}),w=void 0)))}if(w!==void 0&&g.push({start:w,end:S-1}),g.length!==0){const R=g[g.length-1];this._pendingGroundEffectLayers.every(N=>N>R.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(r){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const P=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let R=0;R<P.length;++R){const N=Object.values(P[R]);u.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,w=this._tilesDirty;for(let P=g.length-1;P>=0;P--){const R=g[P];if(u.getTileByID(R.key),u.proxyCachedFBO[R.key]!==void 0){const N=r[R.key],V=this.proxyToSource[R.key];let G=0;for(const X in V){const W=V[X],Q=N[X];if(!Q||Q.length!==W.length||W.some((fe,se)=>fe!==Q[se]||w[X]&&w[X].hasOwnProperty(fe.key))){G=-1;break}++G}for(const X in u.proxyCachedFBO[R.key])u.renderCache[u.proxyCachedFBO[R.key][X]].dirty=G<0||G!==Object.values(N).length}}const S=[...this._drapedRenderBatches];S.sort((P,R)=>R.end-R.start-(P.end-P.start));for(const P of S)for(const R of g){if(u.proxyCachedFBO[R.key])continue;let N=u.renderCachePool.pop();N===void 0&&u.renderCache.length<50&&(N=u.renderCache.length,u.renderCache.push(this._createFBO())),N!==void 0&&(u.proxyCachedFBO[R.key]={},u.proxyCachedFBO[R.key][P.start]=N,u.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(r,u,g,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,P=S.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let R;if(g.isTileClipped())R=u.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):di.disabled}_renderTileClippingMasks(r,u){const g=this.painter,w=this.painter.context,S=w.gl;g._tileClippingMaskIDs={},w.setColorMode(Ri.disabled),w.setDepthMode(Tn.disabled);const P=g.getOrCreateProgram("clippingMask");for(const R of r){const N=g._tileClippingMaskIDs[R.key]=--u;P.draw(g,S.TRIANGLES,Tn.disabled,new di({func:S.ALWAYS,mask:0},N,255,S.KEEP,S.KEEP,S.REPLACE),Ri.disabled,li.disabled,Ld(R.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(r){const u=this.painter.transform;if(r.x<0||r.x>u.width||r.y<0||r.y>u.height)return null;const g=[r.x,r.y,1,1];o.aA(g,g,u.pixelMatrixInverse),o.cw(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const w=u._camera.position,S=o.c6(1,u.center.lat),P=[w[0],w[1],w[2]/S,0],R=o.cX([],g.slice(0,3),P);o.au(R,R);const N=this.raycast(P,R,this._exaggeration);return N!==null&&N?(o.bE(P,P,R,N),P[3]=P[2],P[2]*=S,P):null}_setupProxiedCoordsForOrtho(r,u,g){if(r.getSource()instanceof o.aP)return this._setupProxiedCoordsForImageSource(r,u,g);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const w=this.proxiedCoords[r.id]=[],S=this.proxyCoords;for(let N=0;N<S.length;N++){const V=S[N],G=this._findTileCoveringTileID(V,r);if(G){const X=this._createProxiedId(V,G,g[V.key]&&g[V.key][r.id]);w.push(X),this.proxyToSource[V.key][r.id]=[X]}}let P=!1;const R=new Set;for(let N=0;N<u.length;N++){const V=r.getTile(u[N]);if(!V||!V.hasData())continue;const G=this._findTileCoveringTileID(V.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==V.tileID.canonical.z){const X=this.proxyToSource[G.tileID.key][r.id],W=this._createProxiedId(G.tileID,V,g[G.tileID.key]&&g[G.tileID.key][r.id]);X?X.splice(X.length-1,0,W):this.proxyToSource[G.tileID.key][r.id]=[W];const Q=this.proxyToSource[G.tileID.key][r.id];R.has(Q)||R.add(Q),w.push(W),P=!0}}if(this._sourceTilesOverlap[r.id]=P,P&&this._debugParams.sortTilesHiZFirst)for(const N of R)N.sort((V,G)=>G.overscaledZ-V.overscaledZ)}_setupProxiedCoordsForImageSource(r,u,g){if(!r.getSource().loaded())return;const w=this.proxiedCoords[r.id]=[],S=this.proxyCoords,P=r.getSource(),R=P.tileID;if(!R)return;const N=new o.P(R.x,R.y)._div(1<<R.z),V=P.coordinates.map(o.ac.fromLngLat).reduce((X,W)=>(X.min.x=Math.min(X.min.x,W.x-N.x),X.min.y=Math.min(X.min.y,W.y-N.y),X.max.x=Math.max(X.max.x,W.x-N.x),X.max.y=Math.max(X.max.y,W.y-N.y),X),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(X,W)=>{const Q=X.wrap+X.canonical.x/(1<<X.canonical.z),fe=X.canonical.y/(1<<X.canonical.z),se=o.aj/(1<<X.canonical.z),pe=W.wrap+W.canonical.x/(1<<W.canonical.z),ye=W.canonical.y/(1<<W.canonical.z);return Q+se<pe+V.min.x||Q>pe+V.max.x||fe+se<ye+V.min.y||fe>ye+V.max.y};for(let X=0;X<S.length;X++){const W=S[X];for(let Q=0;Q<u.length;Q++){const fe=r.getTile(u[Q]);if(!fe||!fe.hasData()||G(W,fe.tileID))continue;const se=this._createProxiedId(W,fe,g[W.key]&&g[W.key][r.id]),pe=this.proxyToSource[W.key][r.id];pe?pe.push(se):this.proxyToSource[W.key][r.id]=[se],w.push(se)}}}_createProxiedId(r,u,g){let w=this.orthoMatrix;if(g){const S=g.find(P=>P.key===u.tileID.key);if(S)return S}if(u.tileID.key!==r.key){const S=r.canonical.z-u.tileID.canonical.z;let P,R,N;w=o.bz();const V=u.tileID.wrap-r.wrap<<r.overscaledZ;S>0?(P=o.aj>>S,R=P*((u.tileID.canonical.x<<S)-r.canonical.x+V),N=P*((u.tileID.canonical.y<<S)-r.canonical.y)):(P=o.aj<<-S,R=o.aj*(u.tileID.canonical.x-(r.canonical.x+V<<-S)),N=o.aj*(u.tileID.canonical.y-(r.canonical.y<<-S))),o.c5(w,0,P,0,P,0,1),o.bo(w,w,[R,N,0])}return new Tf(u.tileID,r.key,w)}_findTileCoveringTileID(r,u){let g=u.getTile(r);if(g&&g.hasData())return g;const w=this._findCoveringTileCache[u.id],S=w[r.key];if(g=S?u.getTileByID(S):null,g&&g.hasData()||S===null)return g;let P=g?g.tileID:r,R=P.overscaledZ;const N=u.getSource().minzoom,V=[];if(!S){const X=u.getSource().maxzoom;if(r.canonical.z>=X){const W=r.canonical.z-X;u.getSource().reparseOverscaled?(R=Math.max(r.canonical.z+2,u.transform.tileZoom),P=new o.aM(R,r.wrap,X,r.canonical.x>>W,r.canonical.y>>W)):W!==0&&(R=X,P=new o.aM(R,r.wrap,X,r.canonical.x>>W,r.canonical.y>>W))}P.key!==r.key&&(V.push(P.key),g=u.getTile(P))}const G=X=>{V.forEach(W=>{w[W]=X}),V.length=0};for(R-=1;R>=N&&(!g||!g.hasData());R--){g&&G(g.tileID.key);const X=P.calculateScaledKey(R);if(g=u.getTileByID(X),g&&g.hasData())break;const W=w[X];if(W===null)break;W===void 0?V.push(X):g=u.getTileByID(W)}return G(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,u){let g=this._tilesDirty[r];g||(g=this._tilesDirty[r]={}),g[u.key]=!0}}function Hh(m,r,u){const g=function(R,N,V){const G=o.bG(N,R),X=o.bG(V,[.2126,.7152,.0722]),W=(fe,se,pe)=>(1-pe)*fe+pe*se,Q=W(1-.3*Math.min(X,1),1,Math.min(G+1,1));return W(.92,1,Math.asin(o.ay(N[2],-1,1))/Math.PI+.5)*Q}(m,[0,0,1],r),w=[0,0,0];o.bY(w,u.slice(0,3),g);const S=[0,0,0];o.bY(S,r.slice(0,3),m[2]);const P=[0,0,0];return o.cV(P,w,S),o.cY(P)}const xp=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Gh=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class ih{static cacheKey(r,u,g,w){let S=`${u}${w?w.cacheKey:""}`;for(const P of g)r.usedDefines.includes(P)&&(S+=`/${P}`);return S}constructor(r,u,g,w,S,P){const R=r.gl;this.program=R.createProgram(),this.configuration=w,this.name=u,this.fixedDefines=[...P];const N=w?w.getBinderAttributes():[],V=(g.staticAttributes||[]).concat(N);let G=w?w.defines():[];G=G.concat(P.map(pe=>`#define ${pe}`));const X=`#version 300 es
`;let W=X+G.concat("precision mediump float;",Ns,Hc.fragmentSource).join(`
`);for(const pe of g.fragmentIncludes)W+=`
${ks[pe]}`;W+=`
${g.fragmentSource}`;let Q=X+G.concat("precision highp float;",Ns,Hc.vertexSource).join(`
`);for(const pe of g.vertexIncludes)Q+=`
${ks[pe]}`;this.forceManualRenderingForInstanceIDShaders=r.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(Q+=`
uniform int u_instanceID;
`),Q+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(Q=Q.replaceAll("gl_InstanceID","u_instanceID"));const fe=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(fe,W),R.compileShader(fe),R.attachShader(this.program,fe);const se=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(se,Q),R.compileShader(se),R.attachShader(this.program,se),this.attributes={},this.numAttributes=V.length;for(let pe=0;pe<this.numAttributes;pe++)if(V[pe]){const ye=V[pe].startsWith("a_")?V[pe]:`a_${V[pe]}`;R.bindAttribLocation(this.program,pe,ye),this.attributes[ye]=pe}R.linkProgram(this.program),R.deleteShader(se),R.deleteShader(fe),this.fixedUniforms=S(r),this.binderUniforms=w?w.getUniforms(r):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(pe=>({u_instanceID:new o.c8(pe)}))(r)),(P.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(pe=>({u_dem:new o.c8(pe),u_dem_prev:new o.c8(pe),u_dem_tl:new o.cb(pe),u_dem_scale:new o.ca(pe),u_dem_tl_prev:new o.cb(pe),u_dem_scale_prev:new o.ca(pe),u_dem_size:new o.ca(pe),u_dem_lerp:new o.ca(pe),u_exaggeration:new o.ca(pe),u_depth:new o.c8(pe),u_depth_size_inv:new o.cb(pe),u_depth_range_unpack:new o.cb(pe),u_occluder_half_size:new o.ca(pe),u_occlusion_depth_offset:new o.ca(pe),u_meter_to_dem:new o.ca(pe),u_label_plane_matrix_inv:new o.cc(pe)}))(r)),P.includes("GLOBE")&&(this.globeUniforms=(pe=>({u_tile_tl_up:new o.c9(pe),u_tile_tr_up:new o.c9(pe),u_tile_br_up:new o.c9(pe),u_tile_bl_up:new o.c9(pe),u_tile_up_scale:new o.ca(pe)}))(r)),P.includes("FOG")&&(this.fogUniforms=(pe=>({u_fog_matrix:new o.cc(pe),u_fog_range:new o.cb(pe),u_fog_color:new o.cQ(pe),u_fog_horizon_blend:new o.ca(pe),u_fog_vertical_limit:new o.cb(pe),u_fog_temporal_offset:new o.ca(pe),u_frustum_tl:new o.c9(pe),u_frustum_tr:new o.c9(pe),u_frustum_br:new o.c9(pe),u_frustum_bl:new o.c9(pe),u_globe_pos:new o.c9(pe),u_globe_radius:new o.ca(pe),u_globe_transition:new o.ca(pe),u_is_globe:new o.c8(pe),u_viewport:new o.cb(pe)}))(r)),P.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(pe=>({u_cutoff_params:new o.cQ(pe)}))(r)),P.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(pe=>({u_lighting_ambient_color:new o.c9(pe),u_lighting_directional_dir:new o.c9(pe),u_lighting_directional_color:new o.c9(pe),u_ground_radiance:new o.c9(pe)}))(r)),P.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(pe=>({u_light_matrix_0:new o.cc(pe),u_light_matrix_1:new o.cc(pe),u_fade_range:new o.cb(pe),u_shadow_normal_offset:new o.c9(pe),u_shadow_intensity:new o.ca(pe),u_shadow_texel_size:new o.ca(pe),u_shadow_map_resolution:new o.ca(pe),u_shadow_direction:new o.c9(pe),u_shadow_bias:new o.c9(pe),u_shadowmap_0:new o.c8(pe),u_shadowmap_1:new o.c8(pe)}))(r))}}setTerrainUniformValues(r,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in u)g[w]&&g[w].set(this.program,w,u[w])}}setGlobeUniformValues(r,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in u)g[w]&&g[w].set(this.program,w,u[w])}}setFogUniformValues(r,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in u)g[w].set(this.program,w,u[w])}}setCutoffUniformValues(r,u){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in u)g[w].set(this.program,w,u[w])}}setLightsUniformValues(r,u){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const w in u)g[w].set(this.program,w,u[w])}}setShadowUniformValues(r,u){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;r.program.set(this.program);for(const w in u)g[w].set(this.program,w,u[w])}_drawDebugWireframe(r,u,g,w,S,P,R,N,V,G){const X=r.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const W=r.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||r._terrain&&r._terrain.renderingToTexture||!xp.includes(this.name))||!(!X.layers3D||!Gh.includes(this.name))))return;const Q=W.gl,fe=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,S,W);if(!fe)return;const se=[...this.fixedDefines];se.push("DEBUG_WIREFRAME");const pe=r.getOrCreateProgram(this.name,{config:this.configuration,defines:se});W.program.set(pe.program);const ye=(Le,Ze,Ue)=>{if(Ze[Le]&&Ue[Le])for(const Fe in Ze[Le])Ue[Le][Fe]&&Ue[Le][Fe].set(Ue.program,Fe,Ze[Le][Fe].current)};V&&V.setUniforms(pe.program,W,pe.binderUniforms,R,{zoom:N}),ye("fixedUniforms",this,pe),ye("terrainUniforms",this,pe),ye("globeUniforms",this,pe),ye("fogUniforms",this,pe),ye("lightsUniforms",this,pe),ye("shadowUniforms",this,pe),fe.bind(),W.setColorMode(new Ri([Q.ONE,Q.ONE_MINUS_SRC_ALPHA,Q.ZERO,Q.ONE],o.am.transparent,[!0,!0,!0,!1])),W.setDepthMode(new Tn(u.func===Q.LESS?Q.LEQUAL:u.func,Tn.ReadOnly,u.range)),W.setStencilMode(di.disabled);const we=3*P.primitiveLength*2,De=3*P.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Le=G||1;for(let Ze=0;Ze<Le;++Ze)pe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ze),Q.drawElements(Q.LINES,we,Q.UNSIGNED_SHORT,De)}else G&&G>1?Q.drawElementsInstanced(Q.LINES,we,Q.UNSIGNED_SHORT,De,G):Q.drawElements(Q.LINES,we,Q.UNSIGNED_SHORT,De);S.bind(),W.program.set(this.program),W.setDepthMode(u),W.setStencilMode(g),W.setColorMode(w)}checkUniforms(r,u,g){if(this.fixedDefines.includes(u)){for(const w of Object.keys(g))if(!g[w].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${w} not set but required by ${u} being defined`)}}draw(r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe){const ye=r.context,we=ye.gl;if(this.failedToCreate)return;ye.program.set(this.program),ye.setDepthMode(g),ye.setStencilMode(w),ye.setColorMode(S),ye.setCullFace(P);for(const Ze of Object.keys(this.fixedUniforms))this.fixedUniforms[Ze].set(this.program,Ze,R[Ze]);fe&&fe.setUniforms(this.program,ye,this.binderUniforms,W,{zoom:Q});const De={[we.POINTS]:1,[we.LINES]:2,[we.TRIANGLES]:3,[we.LINE_STRIP]:1}[u];this.checkUniforms(N,"RENDER_SHADOWS",this.shadowUniforms);const Le=pe&&pe>0?1:void 0;for(const Ze of X.get()){const Ue=Ze.vaos||(Ze.vaos={});if((Ue[N]||(Ue[N]=new kl)).bind(ye,this,V,fe?fe.getPaintVertexBuffers():[],G,Ze.vertexOffset,se||[],Le),this.forceManualRenderingForInstanceIDShaders){const Fe=pe||1;for(let ke=0;ke<Fe;++ke)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ke),G?we.drawElements(u,Ze.primitiveLength*De,we.UNSIGNED_SHORT,Ze.primitiveOffset*De*2):we.drawArrays(u,Ze.vertexOffset,Ze.vertexLength)}else pe&&pe>1?we.drawElementsInstanced(u,Ze.primitiveLength*De,we.UNSIGNED_SHORT,Ze.primitiveOffset*De*2,pe):G?we.drawElements(u,Ze.primitiveLength*De,we.UNSIGNED_SHORT,Ze.primitiveOffset*De*2):we.drawArrays(u,Ze.vertexOffset,Ze.vertexLength);u===we.TRIANGLES&&G&&this._drawDebugWireframe(r,g,w,S,G,Ze,W,Q,fe,pe)}}}function bp(m,r,u=0){const g=Math.pow(2,r.tileID.overscaledZ),w=r.tileSize*Math.pow(2,m.transform.tileZoom)/g,S=w*(r.tileID.canonical.x+r.tileID.wrap*g),P=w*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.aw(r,1,m.transform.tileZoom),u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P],u_pattern_transition:u}}const kd={terrain:0,flat:1},Ug=o.bz(),Sf=(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye)=>{const we=r.style.light,De=we.properties.get("position"),Le=[De.x,De.y,De.z],Ze=o.dx();we.properties.get("anchor")==="viewport"&&(o.dy(Ze,-r.transform.angle),o.dz(Le,Le,Ze));const Ue=we.properties.get("color").toPremultipliedRenderColor(null),Fe=r.transform,ke={u_matrix:m,u_lightpos:Le,u_lightintensity:we.properties.get("intensity"),u_lightcolor:[Ue.r,Ue.g,Ue.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ug,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:kd[V],u_base_type:kd[G],u_ao:w,u_edge_radius:S,u_width_scale:P,u_flood_light_color:fe,u_vertical_scale:se,u_flood_light_intensity:pe,u_ground_shadow_factor:ye};return Fe.projection.name==="globe"&&(ke.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],ke.u_zoom_transition=X,ke.u_inv_rot_matrix=Q,ke.u_merc_center=W,ke.u_up_dir=Fe.projection.upVector(new o.cp(0,0,0),W[0]*o.aj,W[1]*o.aj),ke.u_height_lift=N),ke},Zh=(m,r,u,g,w,S)=>({u_matrix:m,u_edge_radius:r,u_width_scale:u,u_vertical_scale:g,u_height_type:kd[w],u_base_type:kd[S]}),wm=(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye)=>{const we=Sf(m,r,u,g,w,S,P,R,V,G,X,W,Q,fe,se,pe,1,[0,0,0]),De={u_height_factor:-Math.pow(2,R.overscaledZ)/N.tileSize/8};return o.h(we,bp(r,N,ye),De)},gu=(m,r,u)=>({u_matrix:m,u_emissive_strength:r,u_ground_shadow_factor:u}),Vg=(m,r,u,g,w,S=0)=>o.h(gu(m,r,w),bp(u,g,S)),wp=(m,r,u,g)=>({u_matrix:m,u_world:u,u_emissive_strength:r,u_ground_shadow_factor:g}),xy=(m,r,u,g,w,S,P=0)=>o.h(Vg(m,r,u,g,S,P),{u_world:w}),Tm=(m,r)=>({u_matrix:m,u_ground_shadow_factor:r}),Ef=(m,r,u,g,w)=>({u_matrix:m,u_camera_pos:[r[0],r[1],r[2]],u_depth_bias:u,u_height_scale:g,u_reset_depth:w}),by=(m,r,u,g)=>{const w=o.aj/u.tileSize;return{u_matrix:m,u_camera_to_center_distance:r.getCameraToCenterDistance(g),u_extrude_scale:[r.pixelsToGLUnits[0]/w,r.pixelsToGLUnits[1]/w]}},Nd=(m,r,u=1)=>({u_matrix:m,u_color:r,u_overlay:0,u_overlay_scale:u}),Sm=o.bz(),Af=(m,r,u,g,w,S,P)=>{const R=m.transform,N=R.projection.name==="globe",V=N?o.dA(R.zoom,r.canonical)*R._pixelsPerMercatorPixel:o.aw(u,1,S),G={u_matrix:r.projMatrix,u_extrude_scale:V,u_intensity:P,u_inv_rot_matrix:Sm,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){G.u_inv_rot_matrix=g,G.u_merc_center=w,G.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],G.u_zoom_transition=o.ah(R.zoom);const X=w[0]*o.aj,W=w[1]*o.aj;G.u_up_dir=R.projection.upVector(new o.cp(0,0,0),X,W)}return G};function Wh(m,[r,u,g,w],[S,P]){if(S===P)return[0,0,0,0];const R=255*(m-1)/(m*(P-S));return[r*R,u*R,g*R,w*R]}function Em(m,r,[u,g]){return u===g?0:.5/m+(r-u)*(m-1)/(m*(g-u))}const _u=(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye,we,De,Le)=>({u_matrix:m,u_normalize_matrix:r,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:w,u_tl_parent:S,u_scale_parent:V,u_fade_t:G.mix,u_opacity:G.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:o.dC(X.paint.get("raster-saturation")),u_contrast_factor:o.dB(X.paint.get("raster-contrast")),u_spin_weights:Am(X.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:Q,u_zoom_transition:P,u_merc_center:R,u_cutoff_params:N,u_colorization_mix:Wh(o.dD,se,ye),u_colorization_offset:Em(o.dD,pe,ye),u_color_ramp:fe,u_texture_offset:[De/(we+2*De),we/(we+2*De)],u_texture_res:[we+2*De,we+2*De],u_emissive_strength:Le});function Am(m){m*=Math.PI/180;const r=Math.sin(m),u=Math.cos(m);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const yu=.05,Bl=(m,r,u,g,w,S,P,R,N,V,G,X)=>({u_matrix:m,u_normalize_matrix:r,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:w,u_tl_parent:S,u_scale_parent:V,u_fade_t:G.mix,u_opacity:G.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:P,u_merc_center:R,u_cutoff_params:N}),rh=(m,r,u,g,w,S,P,R,N,V)=>({u_particle_texture:m,u_particle_texture_side_len:r,u_tile_offset:u,u_velocity:g,u_color_ramp:S,u_velocity_res:w,u_max_speed:P,u_uv_offset:R,u_data_scale:[255*N[0],255*N[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[yu,yu]}),mc=(m,r,u,g,w,S,P,R,N,V)=>({u_particle_texture:m,u_particle_texture_side_len:r,u_velocity:u,u_velocity_res:g,u_max_speed:w,u_speed_factor:S,u_reset_rate:P,u_rand_seed:Math.random(),u_uv_offset:R,u_data_scale:[255*N[0],255*N[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[yu,yu]}),Pf=o.bz(),Bd=(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye,we,De,Le,Ze,Ue,Fe)=>{const ke=w.transform,qe={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:ke.getCameraToCenterDistance(we),u_rotate_symbol:+u,u_aspect_ratio:ke.width/ke.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:P,u_coord_matrix:R,u_is_text:+V,u_elevation_from_sea:N?1:0,u_pitch_with_map:+g,u_texsize:G,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Pf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Pf,u_up_vector:[0,-1,0],u_color_adj_mat:Ze,u_icon_transition:Ue||0,u_gamma_scale:g?w.transform.getCameraToCenterDistance(we)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Fe||1,u_ground_shadow_factor:De,u_inv_matrix:o.bi(o.bz(),P),u_normal_scale:Le};return we.name==="globe"&&(qe.u_tile_id=[Q.canonical.x,Q.canonical.y,1<<Q.canonical.z],qe.u_zoom_transition=fe,qe.u_inv_rot_matrix=pe,qe.u_merc_center=se,qe.u_camera_forward=ke._camera.forward(),qe.u_ecef_origin=o.dE(ke.globeMatrix,Q.toUnwrapped()),qe.u_tile_matrix=Float32Array.from(ke.globeMatrix),qe.u_up_vector=ye),qe},jd=(m,r,u,g)=>({u_matrix:m,u_emissive_strength:r,u_opacity:u,u_color:g}),Fd=(m,r,u,g,w,S,P,R,N)=>o.h(function(V,G,X,W,Q,fe){const{width:se,height:pe}=W.imageManager.getPixelSize(G),ye=Math.pow(2,fe.tileID.overscaledZ),we=fe.tileSize*Math.pow(2,W.transform.tileZoom)/ye,De=we*(fe.tileID.canonical.x+fe.tileID.wrap*ye),Le=we*fe.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[se,pe],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:Q?[W.transform.width,-1*W.transform.height]:[1/o.aw(fe,1,W.transform.tileZoom),1/o.aw(fe,1,W.transform.tileZoom)],u_pixel_coord_upper:[De>>16,Le>>16],u_pixel_coord_lower:[65535&De,65535&Le]}}(0,S,P,g,R,N),{u_matrix:m,u_emissive_strength:r,u_opacity:u}),Cf=new Float32Array(o.bx([])),Mf=(m,r,u,g,w,S,P,R,N,V,G,X,W,Q=[0,0,0],fe)=>{const se=w.style.light,pe=se.properties.get("position"),ye=[-pe.x,-pe.y,pe.z],we=o.dx();se.properties.get("anchor")==="viewport"&&(o.dy(we,-w.transform.angle),o.dz(ye,ye,we));const De=G.alphaMode==="MASK",Le=se.properties.get("color").toNonPremultipliedRenderColor(null),Ze=W.paint.get("model-ambient-occlusion-intensity"),Ue=W.paint.get("model-color").constantOr(o.am.white).toNonPremultipliedRenderColor(null);return Ue.a=W.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:m,u_lighting_matrix:r,u_normal_matrix:u,u_node_matrix:g||Cf,u_lightpos:ye,u_lightintensity:se.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_camera_pos:Q,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+De,u_alphaCutoff:G.alphaCutoff,u_baseColorFactor:P.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:R.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:N,u_roughnessFactor:V,u_baseColorTexture:la.BaseColor,u_metallicRoughnessTexture:la.MetallicRoughness,u_normalTexture:la.Normal,u_occlusionTexture:la.Occlusion,u_emissionTexture:la.Emission,u_lutTexture:la.LUT,u_color_mix:Ue.toArray01(),u_aoIntensity:Ze,u_emissive_strength:X,u_occlusionTextureTransform:fe||[0,0,0,0]}},Ud=(m,r=Cf,u=Cf)=>({u_matrix:m,u_instance:r,u_node_matrix:u}),Tp={fillExtrusion:m=>({u_matrix:new o.cc(m),u_lightpos:new o.c9(m),u_lightintensity:new o.ca(m),u_lightcolor:new o.c9(m),u_vertical_gradient:new o.ca(m),u_opacity:new o.ca(m),u_edge_radius:new o.ca(m),u_width_scale:new o.ca(m),u_ao:new o.cb(m),u_height_type:new o.c8(m),u_base_type:new o.c8(m),u_tile_id:new o.c9(m),u_zoom_transition:new o.ca(m),u_inv_rot_matrix:new o.cc(m),u_merc_center:new o.cb(m),u_up_dir:new o.c9(m),u_height_lift:new o.ca(m),u_flood_light_color:new o.c9(m),u_vertical_scale:new o.ca(m),u_flood_light_intensity:new o.ca(m),u_ground_shadow_factor:new o.c9(m)}),fillExtrusionDepth:m=>({u_matrix:new o.cc(m),u_edge_radius:new o.ca(m),u_width_scale:new o.ca(m),u_vertical_scale:new o.ca(m),u_height_type:new o.c8(m),u_base_type:new o.c8(m)}),fillExtrusionPattern:m=>({u_matrix:new o.cc(m),u_lightpos:new o.c9(m),u_lightintensity:new o.ca(m),u_lightcolor:new o.c9(m),u_vertical_gradient:new o.ca(m),u_height_factor:new o.ca(m),u_edge_radius:new o.ca(m),u_width_scale:new o.ca(m),u_ao:new o.cb(m),u_height_type:new o.c8(m),u_base_type:new o.c8(m),u_tile_id:new o.c9(m),u_zoom_transition:new o.ca(m),u_inv_rot_matrix:new o.cc(m),u_merc_center:new o.cb(m),u_up_dir:new o.c9(m),u_height_lift:new o.ca(m),u_image:new o.c8(m),u_texsize:new o.cb(m),u_pixel_coord_upper:new o.cb(m),u_pixel_coord_lower:new o.cb(m),u_tile_units_to_pixels:new o.ca(m),u_opacity:new o.ca(m),u_pattern_transition:new o.ca(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new o.cc(m),u_opacity:new o.ca(m),u_ao_pass:new o.ca(m),u_meter_to_tile:new o.ca(m),u_ao:new o.cb(m),u_flood_light_intensity:new o.ca(m),u_flood_light_color:new o.c9(m),u_attenuation:new o.ca(m),u_edge_radius:new o.ca(m),u_fb:new o.c8(m),u_fb_size:new o.ca(m),u_dynamic_offset:new o.ca(m)}),fill:m=>({u_matrix:new o.cc(m),u_emissive_strength:new o.ca(m),u_ground_shadow_factor:new o.c9(m)}),fillPattern:m=>({u_matrix:new o.cc(m),u_emissive_strength:new o.ca(m),u_image:new o.c8(m),u_texsize:new o.cb(m),u_pixel_coord_upper:new o.cb(m),u_pixel_coord_lower:new o.cb(m),u_tile_units_to_pixels:new o.ca(m),u_ground_shadow_factor:new o.c9(m),u_pattern_transition:new o.ca(m)}),fillOutline:m=>({u_matrix:new o.cc(m),u_emissive_strength:new o.ca(m),u_world:new o.cb(m),u_ground_shadow_factor:new o.c9(m)}),fillOutlinePattern:m=>({u_matrix:new o.cc(m),u_emissive_strength:new o.ca(m),u_world:new o.cb(m),u_image:new o.c8(m),u_texsize:new o.cb(m),u_pixel_coord_upper:new o.cb(m),u_pixel_coord_lower:new o.cb(m),u_tile_units_to_pixels:new o.ca(m),u_ground_shadow_factor:new o.c9(m),u_pattern_transition:new o.ca(m)}),building:m=>({u_matrix:new o.cc(m),u_normal_matrix:new o.cc(m),u_opacity:new o.ca(m)}),buildingDepth:m=>({u_matrix:new o.cc(m)}),elevatedStructuresDepth:m=>({u_matrix:new o.cc(m),u_depth_bias:new o.ca(m)}),elevatedStructures:m=>({u_matrix:new o.cc(m),u_ground_shadow_factor:new o.c9(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new o.cc(m),u_camera_pos:new o.c9(m),u_depth_bias:new o.ca(m),u_height_scale:new o.ca(m),u_reset_depth:new o.ca(m)}),circle:o.dH,collisionBox:m=>({u_matrix:new o.cc(m),u_camera_to_center_distance:new o.ca(m),u_extrude_scale:new o.cb(m)}),collisionCircle:m=>({u_matrix:new o.cc(m),u_inv_matrix:new o.cc(m),u_camera_to_center_distance:new o.ca(m),u_viewport_size:new o.cb(m)}),debug:m=>({u_color:new o.di(m),u_matrix:new o.cc(m),u_overlay:new o.c8(m),u_overlay_scale:new o.ca(m)}),clippingMask:m=>({u_matrix:new o.cc(m)}),heatmap:m=>({u_extrude_scale:new o.ca(m),u_intensity:new o.ca(m),u_matrix:new o.cc(m),u_inv_rot_matrix:new o.cc(m),u_merc_center:new o.cb(m),u_tile_id:new o.c9(m),u_zoom_transition:new o.ca(m),u_up_dir:new o.c9(m)}),heatmapTexture:m=>({u_image:new o.c8(m),u_color_ramp:new o.c8(m),u_opacity:new o.ca(m)}),hillshade:m=>({u_matrix:new o.cc(m),u_image:new o.c8(m),u_latrange:new o.cb(m),u_light:new o.cb(m),u_shadow:new o.di(m),u_highlight:new o.di(m),u_emissive_strength:new o.ca(m),u_accent:new o.di(m)}),hillshadePrepare:m=>({u_matrix:new o.cc(m),u_image:new o.c8(m),u_dimension:new o.cb(m),u_zoom:new o.ca(m)}),line:o.dG,linePattern:o.dF,raster:m=>({u_matrix:new o.cc(m),u_normalize_matrix:new o.cc(m),u_globe_matrix:new o.cc(m),u_merc_matrix:new o.cc(m),u_grid_matrix:new o.dj(m),u_tl_parent:new o.cb(m),u_scale_parent:new o.ca(m),u_fade_t:new o.ca(m),u_opacity:new o.ca(m),u_image0:new o.c8(m),u_image1:new o.c8(m),u_brightness_low:new o.ca(m),u_brightness_high:new o.ca(m),u_saturation_factor:new o.ca(m),u_contrast_factor:new o.ca(m),u_spin_weights:new o.c9(m),u_perspective_transform:new o.cb(m),u_raster_elevation:new o.ca(m),u_zoom_transition:new o.ca(m),u_merc_center:new o.cb(m),u_cutoff_params:new o.cQ(m),u_colorization_mix:new o.cQ(m),u_colorization_offset:new o.ca(m),u_color_ramp:new o.c8(m),u_texture_offset:new o.cb(m),u_texture_res:new o.cb(m),u_emissive_strength:new o.ca(m)}),rasterParticle:m=>({u_matrix:new o.cc(m),u_normalize_matrix:new o.cc(m),u_globe_matrix:new o.cc(m),u_merc_matrix:new o.cc(m),u_grid_matrix:new o.dj(m),u_tl_parent:new o.cb(m),u_scale_parent:new o.ca(m),u_fade_t:new o.ca(m),u_opacity:new o.ca(m),u_image0:new o.c8(m),u_image1:new o.c8(m),u_raster_elevation:new o.ca(m),u_zoom_transition:new o.ca(m),u_merc_center:new o.cb(m),u_cutoff_params:new o.cQ(m)}),rasterParticleTexture:m=>({u_texture:new o.c8(m),u_opacity:new o.ca(m)}),rasterParticleDraw:m=>({u_particle_texture:new o.c8(m),u_particle_texture_side_len:new o.ca(m),u_tile_offset:new o.cb(m),u_velocity:new o.c8(m),u_color_ramp:new o.c8(m),u_velocity_res:new o.cb(m),u_max_speed:new o.ca(m),u_uv_offset:new o.cb(m),u_data_scale:new o.cb(m),u_data_offset:new o.ca(m),u_particle_pos_scale:new o.ca(m),u_particle_pos_offset:new o.cb(m)}),rasterParticleUpdate:m=>({u_particle_texture:new o.c8(m),u_particle_texture_side_len:new o.ca(m),u_velocity:new o.c8(m),u_velocity_res:new o.cb(m),u_max_speed:new o.ca(m),u_speed_factor:new o.ca(m),u_reset_rate:new o.ca(m),u_rand_seed:new o.ca(m),u_uv_offset:new o.cb(m),u_data_scale:new o.cb(m),u_data_offset:new o.ca(m),u_particle_pos_scale:new o.ca(m),u_particle_pos_offset:new o.cb(m)}),symbol:m=>({u_is_size_zoom_constant:new o.c8(m),u_is_size_feature_constant:new o.c8(m),u_size_t:new o.ca(m),u_size:new o.ca(m),u_camera_to_center_distance:new o.ca(m),u_rotate_symbol:new o.c8(m),u_aspect_ratio:new o.ca(m),u_fade_change:new o.ca(m),u_matrix:new o.cc(m),u_label_plane_matrix:new o.cc(m),u_coord_matrix:new o.cc(m),u_is_text:new o.c8(m),u_elevation_from_sea:new o.c8(m),u_pitch_with_map:new o.c8(m),u_texsize:new o.cb(m),u_texsize_icon:new o.cb(m),u_texture:new o.c8(m),u_texture_icon:new o.c8(m),u_gamma_scale:new o.ca(m),u_device_pixel_ratio:new o.ca(m),u_tile_id:new o.c9(m),u_zoom_transition:new o.ca(m),u_inv_rot_matrix:new o.cc(m),u_merc_center:new o.cb(m),u_camera_forward:new o.c9(m),u_tile_matrix:new o.cc(m),u_up_vector:new o.c9(m),u_ecef_origin:new o.c9(m),u_is_halo:new o.c8(m),u_icon_transition:new o.ca(m),u_color_adj_mat:new o.cc(m),u_scale_factor:new o.ca(m),u_ground_shadow_factor:new o.c9(m),u_inv_matrix:new o.cc(m),u_normal_scale:new o.ca(m)}),background:m=>({u_matrix:new o.cc(m),u_emissive_strength:new o.ca(m),u_opacity:new o.ca(m),u_color:new o.di(m)}),backgroundPattern:m=>({u_matrix:new o.cc(m),u_emissive_strength:new o.ca(m),u_opacity:new o.ca(m),u_image:new o.c8(m),u_pattern_tl:new o.cb(m),u_pattern_br:new o.cb(m),u_texsize:new o.cb(m),u_pattern_size:new o.cb(m),u_pixel_coord_upper:new o.cb(m),u_pixel_coord_lower:new o.cb(m),u_pattern_units_to_pixels:new o.cb(m)}),terrainRaster:m=>({u_matrix:new o.cc(m),u_image0:new o.c8(m),u_skirt_height:new o.ca(m),u_ground_shadow_factor:new o.c9(m)}),skybox:m=>({u_matrix:new o.cc(m),u_sun_direction:new o.c9(m),u_cubemap:new o.c8(m),u_opacity:new o.ca(m),u_temporal_offset:new o.ca(m)}),skyboxGradient:m=>({u_matrix:new o.cc(m),u_color_ramp:new o.c8(m),u_center_direction:new o.c9(m),u_radius:new o.ca(m),u_opacity:new o.ca(m),u_temporal_offset:new o.ca(m)}),skyboxCapture:m=>({u_matrix_3f:new o.dj(m),u_sun_direction:new o.c9(m),u_sun_intensity:new o.ca(m),u_color_tint_r:new o.cQ(m),u_color_tint_m:new o.cQ(m),u_luminance:new o.ca(m)}),globeRaster:m=>({u_proj_matrix:new o.cc(m),u_globe_matrix:new o.cc(m),u_normalize_matrix:new o.cc(m),u_merc_matrix:new o.cc(m),u_zoom_transition:new o.ca(m),u_merc_center:new o.cb(m),u_image0:new o.c8(m),u_grid_matrix:new o.dj(m),u_skirt_height:new o.ca(m),u_far_z_cutoff:new o.ca(m),u_frustum_tl:new o.c9(m),u_frustum_tr:new o.c9(m),u_frustum_br:new o.c9(m),u_frustum_bl:new o.c9(m),u_globe_pos:new o.c9(m),u_globe_radius:new o.ca(m),u_viewport:new o.cb(m)}),globeAtmosphere:m=>({u_frustum_tl:new o.c9(m),u_frustum_tr:new o.c9(m),u_frustum_br:new o.c9(m),u_frustum_bl:new o.c9(m),u_horizon:new o.ca(m),u_transition:new o.ca(m),u_fadeout_range:new o.ca(m),u_color:new o.cQ(m),u_high_color:new o.cQ(m),u_space_color:new o.cQ(m),u_temporal_offset:new o.ca(m),u_horizon_angle:new o.ca(m)}),model:m=>({u_matrix:new o.cc(m),u_lighting_matrix:new o.cc(m),u_normal_matrix:new o.cc(m),u_node_matrix:new o.cc(m),u_lightpos:new o.c9(m),u_lightintensity:new o.ca(m),u_lightcolor:new o.c9(m),u_camera_pos:new o.c9(m),u_opacity:new o.ca(m),u_baseColorFactor:new o.cQ(m),u_emissiveFactor:new o.cQ(m),u_metallicFactor:new o.ca(m),u_roughnessFactor:new o.ca(m),u_baseTextureIsAlpha:new o.c8(m),u_alphaMask:new o.c8(m),u_alphaCutoff:new o.ca(m),u_baseColorTexture:new o.c8(m),u_metallicRoughnessTexture:new o.c8(m),u_normalTexture:new o.c8(m),u_occlusionTexture:new o.c8(m),u_emissionTexture:new o.c8(m),u_lutTexture:new o.c8(m),u_color_mix:new o.cQ(m),u_aoIntensity:new o.ca(m),u_emissive_strength:new o.ca(m),u_occlusionTextureTransform:new o.cQ(m)}),modelDepth:m=>({u_matrix:new o.cc(m),u_instance:new o.cc(m),u_node_matrix:new o.cc(m)}),groundShadow:m=>({u_matrix:new o.cc(m),u_ground_shadow_factor:new o.c9(m)}),stars:m=>({u_matrix:new o.cc(m),u_up:new o.c9(m),u_right:new o.c9(m),u_intensity_multiplier:new o.ca(m)}),snowParticle:m=>({u_modelview:new o.cc(m),u_projection:new o.cc(m),u_time:new o.ca(m),u_cam_pos:new o.c9(m),u_velocityConeAperture:new o.ca(m),u_velocity:new o.ca(m),u_horizontalOscillationRadius:new o.ca(m),u_horizontalOscillationRate:new o.ca(m),u_boxSize:new o.ca(m),u_billboardSize:new o.ca(m),u_simpleShapeParameters:new o.cb(m),u_screenSize:new o.cb(m),u_thinningCenterPos:new o.cb(m),u_thinningShape:new o.c9(m),u_thinningAffectedRatio:new o.ca(m),u_thinningParticleOffset:new o.ca(m),u_particleColor:new o.cQ(m),u_direction:new o.c9(m)}),rainParticle:m=>({u_modelview:new o.cc(m),u_projection:new o.cc(m),u_time:new o.ca(m),u_cam_pos:new o.c9(m),u_texScreen:new o.c8(m),u_velocityConeAperture:new o.ca(m),u_velocity:new o.ca(m),u_boxSize:new o.ca(m),u_rainDropletSize:new o.cb(m),u_distortionStrength:new o.ca(m),u_rainDirection:new o.c9(m),u_color:new o.cQ(m),u_screenSize:new o.cb(m),u_thinningCenterPos:new o.cb(m),u_thinningShape:new o.c9(m),u_thinningAffectedRatio:new o.ca(m),u_thinningParticleOffset:new o.ca(m),u_shapeDirectionalPower:new o.ca(m),u_shapeNormalPower:new o.ca(m),u_mode:new o.ca(m)}),vignette:m=>({u_vignetteShape:new o.c9(m),u_vignetteColor:new o.cQ(m)}),occlusion:m=>({u_matrix:new o.cc(m),u_anchorPos:new o.c9(m),u_screenSizePx:new o.cb(m),u_occluderSizePx:new o.cb(m),u_color:new o.cQ(m)})};class Xl{constructor(r,u,g,w){this.id=Xl.uniqueIdxCounter,Xl.uniqueIdxCounter++,this.context=r;const S=r.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||w||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=Xl.uniqueIdxCounter,Xl.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Xl.uniqueIdxCounter=0;const $g={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class qg{constructor(r,u,g,w,S,P){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=w,this.instanceCount=P,this.context=r;const R=r.gl;this.buffer=R.createBuffer(),r.bindVertexBuffer.set(this.buffer),R.bufferData(R.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?R.DYNAMIC_DRAW:R.STATIC_DRAW),this.dynamicDraw||S||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let g=0;g<this.attributes.length;g++){const w=u.attributes[this.attributes[g].name];w!==void 0&&r.enableVertexAttribArray(w)}}setVertexAttribPointers(r,u,g){for(let w=0;w<this.attributes.length;w++){const S=this.attributes[w],P=u.attributes[S.name];P!==void 0&&r.vertexAttribPointer(P,S.components,r[$g[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(r,u,g){for(let w=0;w<this.attributes.length;w++){const S=u.attributes[this.attributes[w].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(S,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class vu{constructor(r,u,g,w,S){this.context=r,this.width=u,this.height=g;const P=this.framebuffer=r.gl.createFramebuffer();w&&(this.colorAttachment=new pc(r,P)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new Zc(r,P):new Wc(r,P))}destroy(){const r=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&r.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&r.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&r.deleteTexture(u)}r.deleteFramebuffer(this.framebuffer)}}class $r{constructor(r,u){this.gl=r,this.clearColor=new Vh(this),this.clearDepth=new dc(this),this.clearStencil=new yp(this),this.colorMask=new xf(this),this.depthMask=new eh(this),this.stencilMask=new $h(this),this.stencilFunc=new b(this),this.stencilOp=new z(this),this.stencilTest=new $(this),this.depthRange=new ne(this),this.depthTest=new ve(this),this.depthFunc=new Be(this),this.blend=new _t(this),this.blendFunc=new Wt(this),this.blendColor=new ln(this),this.blendEquation=new Un(this),this.cullFace=new yi(this),this.cullFaceSide=new Ti(this),this.frontFace=new Ai(this),this.program=new br(this),this.activeTexture=new Wo(this),this.viewport=new ba(this),this.bindFramebuffer=new Da(this),this.bindRenderbuffer=new Ws(this),this.bindTexture=new Id(this),this.bindVertexBuffer=new bf(this),this.bindElementBuffer=new pu(this),this.bindVertexArrayOES=new fc(this),this.pixelStoreUnpack=new vp(this),this.pixelStoreUnpackPremultiplyAlpha=new th(this),this.pixelStoreUnpackFlipY=new ma(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u,g){return new Xl(this,r,u,g)}createVertexBuffer(r,u,g,w,S){return new qg(this,r,u,g,w,S)}createRenderbuffer(r,u,g){const w=this.gl,S=w.createRenderbuffer();return this.bindRenderbuffer.set(S),w.renderbufferStorage(w.RENDERBUFFER,r,u,g),this.bindRenderbuffer.set(null),S}createFramebuffer(r,u,g,w){return new vu(this,r,u,g,w)}clear({color:r,depth:u,stencil:g,colorMask:w}){const S=this.gl;let P=0;r&&(P|=S.COLOR_BUFFER_BIT,this.clearColor.set(r.toNonPremultipliedRenderColor(null)),this.colorMask.set(w||[!0,!0,!0,!0])),u!==void 0&&(P|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(P|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),S.clear(P)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bv(r.blendFunction,Ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let xo;function Ra(m,r,u,g,w,S,P){const R=m.context,N=R.gl,V=m.transform,G=m.getOrCreateProgram("collisionBox"),X=[];let W=0,Q=0;for(let Le=0;Le<g.length;Le++){const Ze=g[Le],Ue=r.getTile(Ze),Fe=Ue.getBucket(u);if(!Fe)continue;const ke=Xn(Ze,Fe,V);let qe=ke;w[0]===0&&w[1]===0||(qe=m.translatePosMatrix(ke,Ue,w,S));const Ke=P?Fe.textCollisionBox:Fe.iconCollisionBox,pt=Fe.collisionCircleArray;if(pt.length>0){const mt=o.bz(),It=qe;o.cB(mt,Fe.placementInvProjMatrix,V.glCoordMatrix),o.cB(mt,mt,Fe.placementViewportMatrix),X.push({circleArray:pt,circleOffset:Q,transform:It,invTransform:mt,projection:Fe.getProjection()}),W+=pt.length/4,Q=W}Ke&&(m.terrain&&m.terrain.setupElevationDraw(Ue,G),G.draw(m,N.LINES,Tn.disabled,di.disabled,m.colorModeForRenderPass(),li.disabled,by(qe,V,Ue,Fe.getProjection()),u.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,null,V.zoom,null,[Ke.collisionVertexBuffer,Ke.collisionVertexBufferExt]))}if(!P||!X.length)return;const fe=m.getOrCreateProgram("collisionCircle"),se=new o.dI;se.resize(4*W),se._trim();let pe=0;for(const Le of X)for(let Ze=0;Ze<Le.circleArray.length/4;Ze++){const Ue=4*Ze,Fe=Le.circleArray[Ue+0],ke=Le.circleArray[Ue+1],qe=Le.circleArray[Ue+2],Ke=Le.circleArray[Ue+3];se.emplace(pe++,Fe,ke,qe,Ke,0),se.emplace(pe++,Fe,ke,qe,Ke,1),se.emplace(pe++,Fe,ke,qe,Ke,2),se.emplace(pe++,Fe,ke,qe,Ke,3)}(!xo||xo.length<2*W)&&(xo=function(Le){const Ze=2*Le,Ue=new o.a_;Ue.resize(Ze),Ue._trim();for(let Fe=0;Fe<Ze;Fe++){const ke=6*Fe;Ue.uint16[ke+0]=4*Fe+0,Ue.uint16[ke+1]=4*Fe+1,Ue.uint16[ke+2]=4*Fe+2,Ue.uint16[ke+3]=4*Fe+2,Ue.uint16[ke+4]=4*Fe+3,Ue.uint16[ke+5]=4*Fe+0}return Ue}(W));const ye=R.createIndexBuffer(xo,!0),we=R.createVertexBuffer(se,o.dJ.members,!0);for(const Le of X){const Ze={u_matrix:Le.transform,u_inv_matrix:Le.invTransform,u_camera_to_center_distance:(De=V).getCameraToCenterDistance(Le.projection),u_viewport_size:[De.width,De.height]};fe.draw(m,N.TRIANGLES,Tn.disabled,di.disabled,m.colorModeForRenderPass(),li.disabled,Ze,u.id,we,ye,o.bd.simpleSegment(0,2*Le.circleOffset,Le.circleArray.length,Le.circleArray.length/2),null,V.zoom)}var De;we.destroy(),ye.destroy()}const gc=o.bz();function xu(m){const r=m._camera.getWorldToCamera(m.worldSize,1),u=o.az([],r,m.globeMatrix);o.bi(u,u);const g=[0,0,0],w=[0,1,0,0];return o.aA(w,w,u),g[0]=w[0],g[1]=w[1],g[2]=w[2],o.au(g,g),g}function Xc({width:m,height:r,anchor:u,textOffset:g,textScale:w},S){const{horizontalAlign:P,verticalAlign:R}=o.bT(u),N=-(P-.5)*m,V=-(R-.5)*r,G=o.bU(u,g);return new o.P((N/w+G[0])*S,(V/w+G[1])*S)}function Sp(m,r,u,g,w,S,P,R,N,V){const G=m.text.placedSymbolArray,X=m.text.dynamicLayoutVertexArray,W=m.icon.dynamicLayoutVertexArray,Q={},fe=m.getProjection(),se=Ll(P,fe,w),pe=w.elevation,ye=fe.upVectorScale(P.canonical,w.center.lat,w.worldSize).metersToTile;X.clear();for(let we=0;we<G.length;we++){const De=G.get(we),{tileAnchorX:Le,tileAnchorY:Ze,numGlyphs:Ue}=De,Fe=De.hidden||!De.crossTileID||m.allowVerticalPlacement&&!De.placedOrientation?null:g[De.crossTileID];if(Fe){let ke=0,qe=0,Ke=0;if(pe){const jt=pe?pe.getAtTileOffset(P,Le,Ze):0,[wt,Ht,pn]=fe.upVector(P.canonical,Le,Ze);ke=jt*wt*ye,qe=jt*Ht*ye,Ke=jt*pn*ye}let[pt,mt,It,Nt]=Ut(De.projectedAnchorX+ke,De.projectedAnchorY+qe,De.projectedAnchorZ+Ke,u?se:S);const Xt=kn(w.getCameraToCenterDistance(fe),Nt);let ut=o.bJ(m.textSizeData,N,De)*Xt/o.bO;u&&(ut*=m.tilePixelRatio/R);const Et=Xc(Fe,ut);u?({x:pt,y:mt,z:It}=fe.projectTilePoint(Le+Et.x,Ze+Et.y,P.canonical),[pt,mt,It]=Ut(pt+ke,mt+qe,It+Ke,S)):(r&&Et._rotate(-w.angle),pt+=Et.x,mt+=Et.y,It=0);const at=m.allowVerticalPlacement&&De.placedOrientation===o.bI.vertical?Math.PI/2:0;for(let jt=0;jt<Ue;jt++)o.bL(X,pt,mt,It,at);V&&De.associatedIconIndex>=0&&(Q[De.associatedIconIndex]={x:pt,y:mt,z:It,angle:at})}else qa(Ue,X)}if(V){W.clear();const we=m.icon.placedSymbolArray;for(let De=0;De<we.length;De++){const Le=we.get(De),{numGlyphs:Ze}=Le,Ue=Q[De];if(Le.hidden||!Ue)qa(Ze,W);else{const{x:Fe,y:ke,z:qe,angle:Ke}=Ue;for(let pt=0;pt<Ze;pt++)o.bL(W,Fe,ke,qe,Ke)}}m.icon.dynamicLayoutVertexBuffer.updateData(W)}m.text.dynamicLayoutVertexBuffer.updateData(X)}function bu(m,r,u,g,w,S,P={}){const R=u.paint.get("icon-translate"),N=u.paint.get("text-translate"),V=u.paint.get("icon-translate-anchor"),G=u.paint.get("text-translate-anchor"),X=u.layout.get("icon-rotation-alignment"),W=u.layout.get("text-rotation-alignment"),Q=u.layout.get("icon-pitch-alignment"),fe=u.layout.get("text-pitch-alignment"),se=u.layout.get("icon-keep-upright"),pe=u.layout.get("text-keep-upright"),ye=u.paint.get("icon-color-saturation"),we=u.paint.get("icon-color-contrast"),De=u.paint.get("icon-color-brightness-min"),Le=u.paint.get("icon-color-brightness-max"),Ze=u.layout.get("symbol-elevation-reference")==="sea",Ue=m.context,Fe=Ue.gl,ke=m.transform,qe=X==="map",Ke=W==="map",pt=Q==="map",mt=fe==="map",It=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Nt=!1;const Xt=m.depthModeForSublayer(0,Tn.ReadOnly),ut=new Tn(m.context.gl.LEQUAL,Tn.ReadOnly,m.depthRangeFor3D),Et=[o.aD(ke.center.lng),o.aH(ke.center.lat)],at=u.layout.get("text-variable-anchor"),jt=ke.projection.name==="globe",wt=[],Ht=[0,-1,0];for(const pn of g){const Ft=r.getTile(pn),rn=Ft.getBucket(u);if(!rn||rn.projection.name==="mercator"&&jt||rn.fullyClipped)continue;const Bn=rn.projection.name==="globe",Dn=Bn?o.ah(ke.zoom):0,On=Ll(pn,rn.getProjection(),ke),Yn=ke.calculatePixelsToTileUnitsMatrix(Ft),ni=at&&rn.hasTextData(),Rn=rn.hasIconTextFit()&&ni&&rn.hasIconData(),Kn=rn.getProjection().createInversionMatrix(ke,pn.canonical),ei=(1<<Ft.tileID.canonical.z)*o.aj/m.transform.worldSize,_i=Br=>{let Gi=[0,0,0];if(Br){const eo=m.style.directionalLight,Ki=m.style.ambientLight;eo&&Ki&&(Gi=Uc(m.style,eo,Ki))}return Gi},Pi=Br=>{ke.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||m.terrain)&&(Br.push("DEPTH_D24"),Br.push("DEPTH_OCCLUSION"))},Yi=()=>{const Br=qe&&u.layout.get("symbol-placement")!=="point",Gi=[];Pi(Gi);const eo=Br||Rn,Ki=rn.elevationType==="road"&&pt,jr=m.shadowRenderer,qr=Ki&&!!jr&&jr.enabled,Lr=_i(qr),Fr=Ki?ut:Xt,xr=u.paint.get("icon-image-cross-fade");m.terrainRenderModeElevated()&&pt&&Gi.push("PITCH_WITH_MAP_TERRAIN"),Bn&&(Gi.push("PROJECTION_GLOBE_VIEW"),eo&&Gi.push("PROJECTED_POS_ON_VIEWPORT")),xr>0&&Gi.push("ICON_TRANSITION"),rn.icon.zOffsetVertexBuffer&&Gi.push("Z_OFFSET"),ye===0&&we===0&&De===0&&Le===1||Gi.push("COLOR_ADJUSTMENT"),rn.sdfIcons&&Gi.push("RENDER_SDF"),qr&&Gi.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ki&&rn.icon.orientationVertexBuffer&&Gi.push("ELEVATED_ROADS");const Gr=rn.icon.programConfigurations.get(u.id),fo=m.getOrCreateProgram("symbol",{config:Gr,defines:Gi}),Or=Ft.imageAtlasTexture?Ft.imageAtlasTexture.size:[0,0],sr=rn.iconSizeData,Ps=o.bH(sr,ke.zoom),Ys=pt||!ke.isOrthographic,Ml=$a(On,Ft.tileID.canonical,pt,qe,ke,rn.getProjection(),Yn),Tc=st(On,Ft.tileID.canonical,pt,qe,ke,rn.getProjection(),Yn),dl=m.translatePosMatrix(Tc,Ft,R,V,!0),Ks=m.translatePosMatrix(On,Ft,R,V),fs=eo?gc:Ml,Sc=qe&&!pt&&!Br;let ps=Ht;!jt&&!ke.mercatorFromTransition||qe||(ps=xu(ke));const qf=Bn?ps:Ht,Gm=u.getColorAdjustmentMatrix(ye,we,De,Le),Hf=Bd(sr.kind,Ps,Sc,pt,m,Ks,fs,dl,Ze,!1,Or,[0,0],0,pn,Dn,Et,Kn,qf,rn.getProjection(),Lr,ei,Gm,xr,null),Nu=Ft.imageAtlasTexture?Ft.imageAtlasTexture:null,ed=u.layout.get("icon-size").constantOr(0)!==1||rn.iconsNeedLinear,Gf=rn.sdfIcons||m.options.rotating||m.options.zooming||ed||Ys?Fe.LINEAR:Fe.NEAREST,ch=rn.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,tu=m.terrain&&pt&&Br?o.bi(o.bz(),Ml):gc;if(Br&&rn.icon){const Qd=ke.elevation,td=Qd?Qd.getAtTileOffsetFunc(pn,ke.center.lat,ke.worldSize,rn.getProjection()):null,Bu=Tl(On,Ft.tileID.canonical,pt,qe,ke,rn.getProjection(),Yn);oo(rn,On,m,!1,Bu,Tc,pt,se,td,pn)}return{program:fo,buffers:rn.icon,uniformValues:Hf,atlasTexture:Nu,atlasTextureIcon:null,atlasInterpolation:Gf,atlasInterpolationIcon:null,isSDF:rn.sdfIcons,hasHalo:ch,depthMode:Fr,tile:Ft,renderWithShadows:qr,labelPlaneMatrixInv:tu}},fr=()=>{const Br=Ke&&u.layout.get("symbol-placement")!=="point",Gi=[],eo=Br||at||Rn,Ki=rn.elevationType==="road"&&mt,jr=m.shadowRenderer,qr=Ki&&!!jr&&jr.enabled,Lr=_i(qr),Fr=Ki?ut:Xt;m.terrainRenderModeElevated()&&mt&&Gi.push("PITCH_WITH_MAP_TERRAIN"),Bn&&(Gi.push("PROJECTION_GLOBE_VIEW"),eo&&Gi.push("PROJECTED_POS_ON_VIEWPORT")),rn.text.zOffsetVertexBuffer&&Gi.push("Z_OFFSET"),rn.iconsInText&&Gi.push("RENDER_TEXT_AND_SYMBOL"),Gi.push("RENDER_SDF"),qr&&Gi.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ki&&rn.text.orientationVertexBuffer&&Gi.push("ELEVATED_ROADS"),Pi(Gi);const xr=rn.text.programConfigurations.get(u.id),Gr=m.getOrCreateProgram("symbol",{config:xr,defines:Gi});let fo,Or=[0,0],sr=null;const Ps=rn.textSizeData;rn.iconsInText&&(Or=Ft.imageAtlasTexture?Ft.imageAtlasTexture.size:[0,0],sr=Ft.imageAtlasTexture?Ft.imageAtlasTexture:null,fo=mt||!ke.isOrthographic||m.options.rotating||m.options.zooming||Ps.kind==="composite"||Ps.kind==="camera"?Fe.LINEAR:Fe.NEAREST);const Ys=Ft.glyphAtlasTexture?Ft.glyphAtlasTexture.size:[0,0],Ml=u.layout.get("text-size-scale-range"),Tc=o.ay(m.scaleFactor,Ml[0],Ml[1]),dl=o.bH(Ps,ke.zoom,Tc),Ks=$a(On,Ft.tileID.canonical,mt,Ke,ke,rn.getProjection(),Yn),fs=st(On,Ft.tileID.canonical,mt,Ke,ke,rn.getProjection(),Yn),Sc=m.translatePosMatrix(fs,Ft,N,G,!0),ps=m.translatePosMatrix(On,Ft,N,G),qf=eo?gc:Ks,Gm=Ke&&!mt&&!Br;let Hf=Ht;!jt&&!ke.mercatorFromTransition||Ke||(Hf=xu(ke));const Nu=Bd(Ps.kind,dl,Gm,mt,m,ps,qf,Sc,Ze,!0,Ys,Or,0,pn,Dn,Et,Kn,Bn?Hf:Ht,rn.getProjection(),Lr,ei,null,null,Tc),ed=Ft.glyphAtlasTexture?Ft.glyphAtlasTexture:null,Gf=Fe.LINEAR,ch=u.paint.get("text-halo-width").constantOr(1)!==0,tu=m.terrain&&mt&&Br?o.bi(o.bz(),Ks):gc;if(Br&&rn.text){const Qd=ke.elevation,td=Qd?Qd.getAtTileOffsetFunc(pn,ke.center.lat,ke.worldSize,rn.getProjection()):null,Bu=Tl(On,Ft.tileID.canonical,mt,Ke,ke,rn.getProjection(),Yn);oo(rn,On,m,!0,Bu,fs,mt,pe,td,pn)}return{program:Gr,buffers:rn.text,uniformValues:Nu,atlasTexture:ed,atlasTextureIcon:sr,atlasInterpolation:Gf,atlasInterpolationIcon:fo,isSDF:!0,hasHalo:ch,depthMode:Fr,tile:Ft,renderWithShadows:qr,labelPlaneMatrixInv:tu}},ho=rn.icon.segments.get().length,wi=rn.text.segments.get().length,xi=ho&&!P.onlyText?Yi():null,fi=wi&&!P.onlyIcons?fr():null,Pr=u.paint.get("icon-opacity").constantOr(1),Io=u.paint.get("text-opacity").constantOr(1);if(It&&rn.canOverlap){Nt=!0;const Br=Pr&&!P.onlyText?rn.icon.segments.get():[],Gi=Io&&!P.onlyIcons?rn.text.segments.get():[];for(const eo of Br)wt.push({segments:new o.bd([eo]),sortKey:eo.sortKey,state:xi});for(const eo of Gi)wt.push({segments:new o.bd([eo]),sortKey:eo.sortKey,state:fi})}else P.onlyText||wt.push({segments:Pr?rn.icon.segments:new o.bd([]),sortKey:0,state:xi}),P.onlyIcons||wt.push({segments:Io?rn.text.segments:new o.bd([]),sortKey:0,state:fi})}Nt&&wt.sort((pn,Ft)=>pn.sortKey-Ft.sortKey);for(const pn of wt){const Ft=pn.state;if(Ft)if(m.terrain?m.terrain.setupElevationDraw(Ft.tile,Ft.program,{useDepthForOcclusion:ke.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ft.labelPlaneMatrixInv}):m.setupDepthForOcclusion(ke.depthOcclusionForSymbolsAndCircles,Ft.program),Ue.activeTexture.set(Fe.TEXTURE0),Ft.atlasTexture&&Ft.atlasTexture.bind(Ft.atlasInterpolation,Fe.CLAMP_TO_EDGE,!0),Ft.atlasTextureIcon&&(Ue.activeTexture.set(Fe.TEXTURE1),Ft.atlasTextureIcon&&Ft.atlasTextureIcon.bind(Ft.atlasInterpolationIcon,Fe.CLAMP_TO_EDGE,!0)),Ft.renderWithShadows&&m.shadowRenderer.setupShadows(Ft.tile.tileID.toUnwrapped(),Ft.program,"vector-tile",Ft.tile.tileID.overscaledZ),m.uploadCommonLightUniforms(m.context,Ft.program),Ft.hasHalo){const rn=Ft.uniformValues;rn.u_is_halo=1,Yc(Ft.buffers,pn.segments,u,m,Ft.program,Ft.depthMode,w,S,rn,2),rn.u_is_halo=0}else{if(Ft.isSDF){const rn=Ft.uniformValues;Ft.hasHalo&&(rn.u_is_halo=1,Yc(Ft.buffers,pn.segments,u,m,Ft.program,Ft.depthMode,w,S,rn,1)),rn.u_is_halo=0}Yc(Ft.buffers,pn.segments,u,m,Ft.program,Ft.depthMode,w,S,Ft.uniformValues,1)}}}function Yc(m,r,u,g,w,S,P,R,N,V){const G=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer,m.orientationVertexBuffer];w.draw(g,g.context.gl.TRIANGLES,S,P,R,li.disabled,N,u.id,m.layoutVertexBuffer,m.indexBuffer,r,u.paint,g.transform.zoom,m.programConfigurations.get(u.id),G,V)}function Pm(m,r){const u=1<<m.canonical.z,g=(r.x*u-m.canonical.x-m.wrap*u)*o.aj,w=(r.y*u-m.canonical.y)*o.aj,S=o.dS(r.z,r.y);return o.cS(g,w,S)}function La(m,r,u,g,w){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const S=m.context.gl,P=new Tn(m.context.gl.LEQUAL,Tn.ReadWrite,m.depthRangeFor3D),R=new Tn(m.context.gl.GREATER,Tn.ReadWrite,m.depthRangeFor3D),N=function(Q){const fe=o.cJ(Q.pitch);let se=.01;return Q.isOrthographic&&(se=o.ai(1e-4,se,o.cN(fe>=Ia?1:fe/Ia))),2*se}(m.transform),V=m.transform.getFreeCameraOptions().position,G="elevatedStructuresDepthReconstruct",X=m.getOrCreateProgram(G,{defines:["DEPTH_RECONSTRUCTION"]}),W=m.getOrCreateProgram(G);for(const Q of g){const fe=r.getTile(Q),se=fe.getBucket(u);if(!se)continue;const pe=se.elevatedStructures;if(!pe)continue;const ye=se.elevationBufferData.heightRange,we=Pm(Q.toUnwrapped(),V),De=m.translatePosMatrix(Q.projMatrix,fe,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let Le,Ze,Ue,Fe;if(w==="initialize"){if(!ye||ye.min>=1||pe.depthSegments.segments[0].primitiveLength===0)continue;Le=Ef(De,we,N,1,0),Ze=P,Ue=pe.depthSegments,Fe=X}else if(w==="reset"){if(!ye||ye.min>=0||pe.maskSegments.segments[0].primitiveLength===0)continue;Le=Ef(De,we,0,0,1),Ze=R,Ue=pe.maskSegments,Fe=X}else if(w==="geometry"){if(pe.depthSegments.segments[0].primitiveLength===0)continue;Le=Ef(De,we,N,1,0),Ze=P,Ue=pe.depthSegments,Fe=W}Fe.draw(m,S.TRIANGLES,Ze,di.disabled,Ri.disabled,li.disabled,Le,u.id,pe.vertexBuffer,pe.indexBuffer,Ue,u.paint,m.transform.zoom)}}function Ep(m,r,u){const{painter:g,sourceCache:w,layer:S,coords:P,colorMode:R,elevationType:N,terrainEnabled:V,pass:G}=m,X=g.context.gl,W=S.paint.get("fill-pattern"),Q=S.paint.get("fill-pattern-cross-fade"),fe=W.constantOr(null);let se=N;N!=="road"||r&&!V||(se="none");const pe=se==="road",ye=m.painter.shadowRenderer,we=pe&&!!ye&&ye.enabled,De=new Tn(g.context.gl.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D);let Le=[0,0,0];if(we){const Fe=g.style.directionalLight,ke=g.style.ambientLight;Fe&&ke&&(Le=Uc(g.style,Fe,ke))}const Ze=W&&W.constantOr(1),Ue=(Fe,ke)=>{let qe,Ke,pt,mt,It;ke?(qe=Ze&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",pt=X.LINES):(qe=Ze?"fillPattern":"fill",pt=X.TRIANGLES);for(const Nt of P){const Xt=w.getTile(Nt);if(Ze&&!Xt.patternsLoaded())continue;const ut=Xt.getBucket(S);if(!ut)continue;const Et=r?ut.elevationBufferData:ut.bufferData;if(Et.isEmpty())continue;g.prepareDrawTile();const at=Et.programConfigurations.get(S.id),jt=g.isTileAffectedByFog(Nt),wt=[],Ht=[];pe&&(wt.push("ELEVATED_ROADS"),Ht.push(Et.elevatedLayoutVertexBuffer)),we&&wt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ze&&(g.context.activeTexture.set(X.TEXTURE0),Xt.imageAtlasTexture&&Xt.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),at.updatePaintBuffers());let pn=!1;if(fe&&Xt.imageAtlas){const On=Xt.imageAtlas,Yn=o.dN.from(fe),ni=Yn.getPrimary().scaleSelf(o.q.devicePixelRatio).toString(),Rn=Yn.getSecondary(),Kn=On.patternPositions.get(ni),ei=Rn?On.patternPositions.get(Rn.scaleSelf(o.q.devicePixelRatio).toString()):null;pn=!!Kn&&!!ei,Kn&&at.setConstantPatternPositions(Kn,ei)}Q>0&&(pn||at.getPatternTransitionVertexBuffer("fill-pattern"))&&wt.push("FILL_PATTERN_TRANSITION");const Ft=g.getOrCreateProgram(qe,{config:at,overrideFog:jt,defines:wt}),rn=g.translatePosMatrix(Nt.projMatrix,Xt,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));we&&ye.setupShadows(Xt.tileID.toUnwrapped(),Ft,"vector-tile",Xt.tileID.overscaledZ);const Bn=S.paint.get("fill-emissive-strength");if(ke){mt=Et.lineIndexBuffer,It=Et.lineSegments;const On=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[X.drawingBufferWidth,X.drawingBufferHeight];Ke=qe==="fillOutlinePattern"&&Ze?xy(rn,Bn,g,Xt,On,Le,Q):wp(rn,Bn,On,Le)}else mt=Et.indexBuffer,It=Et.triangleSegments,Ke=Ze?Vg(rn,Bn,g,Xt,Le,Q):gu(rn,Bn,Le);g.uploadCommonUniforms(g.context,Ft,Nt.toUnwrapped());let Dn=Fe;(N==="road"&&!V||N==="offset")&&(Dn=De),Ft.draw(g,pt,Dn,u||g.stencilModeForClipping(Nt),R,li.disabled,Ke,S.id,Et.layoutVertexBuffer,mt,It,S.paint,g.transform.zoom,at,Ht)}};g.renderPass===G&&Ue(g.depthModeForSublayer(1,g.renderPass==="opaque"?Tn.ReadWrite:Tn.ReadOnly),!1),se==="none"&&g.renderPass==="translucent"&&S.paint.get("fill-antialias")&&Ue(g.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Tn.ReadOnly),!0)}function Kc(m,r,u,g,w,S,P,R){u.resetLayerRenderingStats(m);const N=m.context,V=N.gl,G=m.transform,X=u.paint.get("fill-extrusion-pattern"),W=u.paint.get("fill-extrusion-pattern-cross-fade"),Q=X.constantOr(null),fe=X.constantOr(1),se=u.paint.get("fill-extrusion-opacity"),pe=m.style.enable3dLights(),ye=u.paint.get(pe&&!fe?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),we=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ye],De=u.layout.get("fill-extrusion-edge-radius"),Le=De>0&&!u.paint.get("fill-extrusion-rounded-roof"),Ze=Le?0:De,Ue=G.projection.name==="globe"?o.dV():0,Fe=G.projection.name==="globe",ke=Fe?o.ah(G.zoom):0,qe=[o.aD(G.center.lng),o.aH(G.center.lat)],Ke=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",pt=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Ke?null:u.lut).toArray01().slice(0,3),mt=u.paint.get("fill-extrusion-flood-light-intensity"),It=u.paint.get("fill-extrusion-vertical-scale"),Nt=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Xt=u.paint.get("fill-extrusion-height-alignment"),ut=u.paint.get("fill-extrusion-base-alignment"),Et=ac(m,u.paint.get("fill-extrusion-cutoff-fade-range")),at=[];let jt;Fe&&at.push("PROJECTION_GLOBE_VIEW"),we[0]>0&&at.push("FAUX_AO"),Le&&at.push("ZERO_ROOF_RADIUS"),R&&at.push("HAS_CENTROID"),mt>0&&at.push("FLOOD_LIGHT"),Et.shouldRenderCutoff&&at.push("RENDER_CUTOFF"),Nt&&at.push("RENDER_WALL_MODE");const wt=m.renderPass==="shadow",Ht=m.shadowRenderer,pn=wt&&!!Ht,Ft=wt?li.disabled:li.backCCW;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let rn=[0,0,0];if(Ht){const On=m.style.directionalLight,Yn=m.style.ambientLight;On&&Yn&&(rn=Uc(m.style,On,Yn)),wt||(at.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Ht.useNormalOffset&&at.push("NORMAL_OFFSET")),jt=at.concat(["SHADOWS_SINGLE_CASCADE"])}const Bn=pn?"fillExtrusionDepth":fe?"fillExtrusionPattern":"fillExtrusion",Dn=u.getLayerRenderingStats();for(const On of g){const Yn=r.getTile(On),ni=Yn.getBucket(u);if(!ni||ni.projection.name!==G.projection.name)continue;let Rn=!1;Ht&&(Rn=Ht.getMaxCascadeForTile(On.toUnwrapped())===0);const Kn=m.isTileAffectedByFog(On),ei=ni.programConfigurations.get(u.id);let _i=!1;if(Q&&Yn.imageAtlas){const fi=Yn.imageAtlas,Pr=o.dN.from(Q),Io=Pr.getPrimary().scaleSelf(o.q.devicePixelRatio).toString(),Br=Pr.getSecondary(),Gi=fi.patternPositions.get(Io),eo=Br?fi.patternPositions.get(Br.scaleSelf(o.q.devicePixelRatio).toString()):null;_i=!!Gi&&!!eo,Gi&&ei.setConstantPatternPositions(Gi,eo)}W>0&&(_i||ei.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&at.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Pi=m.getOrCreateProgram(Bn,{config:ei,defines:Rn?jt:at,overrideFog:Kn});if(m.terrain&&m.terrain.setupElevationDraw(Yn,Pi,{useMeterToDem:!0}),!ni.centroidVertexBuffer){const fi=Pi.attributes.a_centroid_pos;fi!==void 0&&V.vertexAttrib2f(fi,0,0)}!wt&&Ht&&Ht.setupShadows(Yn.tileID.toUnwrapped(),Pi,"vector-tile",Yn.tileID.overscaledZ),fe&&(m.context.activeTexture.set(V.TEXTURE0),Yn.imageAtlasTexture&&Yn.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),ei.updatePaintBuffers());const Yi=u.paint.get("fill-extrusion-vertical-gradient"),fr=1/ni.tileToMeter;let ho;if(wt&&Ht){if(Su(Yn.tileID,ni,m))continue;const fi=Ht.calculateShadowPassMatrixFromTile(Yn.tileID.toUnwrapped());ho=Zh(fi,Ze,fr,It,Xt,ut)}else{const fi=m.translatePosMatrix(On.expandedProjMatrix,Yn,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Pr=G.projection.createInversionMatrix(G,On.canonical);ho=fe?wm(fi,m,Yi,se,we,Ze,fr,On,Yn,Ue,Xt,ut,ke,qe,Pr,pt,It,W):Sf(fi,m,Yi,se,we,Ze,fr,On,Ue,Xt,ut,ke,qe,Pr,pt,It,mt,rn)}m.uploadCommonUniforms(N,Pi,On.toUnwrapped(),null,Et);let wi=ni.segments;if(G.projection.name==="mercator"&&!wt&&(wi=ni.getVisibleSegments(Yn.tileID,m.terrain,m.transform.getFrustum(0)),!wi.get().length))continue;if(Dn)if(wt)for(const fi of wi.get())Dn.numRenderedVerticesInShadowPass+=fi.primitiveLength;else for(const fi of wi.get())Dn.numRenderedVerticesInTransparentPass+=fi.primitiveLength;const xi=[];(m.terrain||R)&&xi.push(ni.centroidVertexBuffer),Fe&&xi.push(ni.layoutVertexExtBuffer),Nt&&xi.push(ni.wallVertexBuffer),Pi.draw(m,N.gl.TRIANGLES,w,S,P,Ft,ho,u.id,ni.layoutVertexBuffer,ni.indexBuffer,wi,u.paint,m.transform.zoom,ei,xi)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function wu(m,r,u,g,w,S,P,R,N,V,G,X,W,Q,fe,se,pe,ye,we){const De=m.context,Le=De.gl,Ze=m.transform,Ue=m.transform.zoom,Fe=[],ke=ac(m,u.paint.get("fill-extrusion-cutoff-fade-range"));V==="clear"?(Fe.push("CLEAR_SUBPASS"),we&&(Fe.push("CLEAR_FROM_TEXTURE"),De.activeTexture.set(Le.TEXTURE0),we.bind(Le.LINEAR,Le.CLAMP_TO_EDGE))):V==="sdf"&&Fe.push("SDF_SUBPASS"),pe&&Fe.push("HAS_CENTROID"),ke.shouldRenderCutoff&&Fe.push("RENDER_CUTOFF");const qe=u.layout.get("fill-extrusion-edge-radius"),Ke=(pt,mt,It,Nt,Xt)=>{const ut=mt.programConfigurations.get(u.id),Et=m.isTileAffectedByFog(pt),at=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:ut,defines:Fe,overrideFog:Et}),jt=((Ht,pn,Ft,rn,Bn,Dn,On,Yn,ni,Rn,Kn)=>({u_matrix:pn,u_opacity:Ft,u_ao_pass:rn?1:0,u_meter_to_tile:Bn,u_ao:Dn,u_flood_light_intensity:On,u_flood_light_color:Yn,u_attenuation:ni,u_edge_radius:Rn,u_fb:0,u_fb_size:Kn,u_dynamic_offset:1}))(0,Nt,G,N,Xt,[X,W*Xt],Q,fe,se,Ue>=17?0:qe*Xt,we?we.size[0]:0),wt=[];pe&&wt.push(mt.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(De,at,pt.toUnwrapped(),null,ke),at.draw(m,De.gl.TRIANGLES,w,S,P,R,jt,u.id,mt.vertexBuffer,mt.indexBuffer,It,u.paint,Ue,ut,wt)};for(const pt of g){const mt=r.getTile(pt),It=mt.getBucket(u);if(!It||It.projection.name!==Ze.projection.name||!It.groundEffect||It.groundEffect&&!It.groundEffect.hasData())continue;const Nt=It.groundEffect,Xt=1/It.tileToMeter;{const ut=m.translatePosMatrix(pt.projMatrix,mt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Et=Nt.getDefaultSegment();Ke(pt,Nt,Et,ut,Xt)}if(ye)for(let ut=0;ut<4;ut++){const Et=o.dT[ut](pt),at=r.getTile(Et);if(!at)continue;const jt=at.getBucket(u);if(!jt||jt.projection.name!==Ze.projection.name||!jt.groundEffect||jt.groundEffect&&!jt.groundEffect.hasData())continue;const wt=jt.groundEffect;let Ht,pn;ut===0?(Ht=[-8192,0,0],pn=1):ut===1?(Ht=[o.aj,0,0],pn=0):ut===2?(Ht=[0,-8192,0],pn=3):(Ht=[0,o.aj,0],pn=2);const Ft=wt.regionSegments[pn];if(!Ft)continue;const rn=new Float32Array(16);o.bo(rn,pt.projMatrix,Ht),Ke(pt,wt,Ft,m.translatePosMatrix(rn,mt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Xt)}}}function Nn(m,r,u,g,w,S,P){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const R=S?S.findDEMTileFor(u):null;if(!(R&&R.dem||P))return;S&&R&&R.dem&&g.selfDEMTileTimestamp!==R.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=R.dem._timestamp);const N=ye=>new o.P(Math.ceil((ye+o.dX)*o.dY),0),V=ye=>{const we=r.getSource().minzoom,De=Ze=>{const Ue=r.getTileByID(Ze);if(Ue&&Ue.hasData())return Ue.getBucket(w)},Le=[0,-1,1];for(const Ze of Le){if(ye.overscaledZ+Ze<we)continue;const Ue=De(ye.calculateScaledKey(ye.overscaledZ+Ze));if(Ue)return Ue}},G=[0,0,0],X=(ye,we)=>(G[0]=Math.min(ye.min.y,we.min.y),G[1]=Math.max(ye.max.y,we.max.y),G[2]=o.aj-we.min.x>ye.max.x?we.min.x-o.aj:ye.max.x,G),W=(ye,we)=>(G[0]=Math.min(ye.min.x,we.min.x),G[1]=Math.max(ye.max.x,we.max.x),G[2]=o.aj-we.min.y>ye.max.y?we.min.y-o.aj:ye.max.y,G),Q=[(ye,we)=>X(ye,we),(ye,we)=>X(we,ye),(ye,we)=>W(ye,we),(ye,we)=>W(we,ye)],fe=(ye,we,De,Le,Ze,Ue,Fe)=>{if(!S)return 0;const ke=[[Ue?De:ye,Ue?ye:De,0],[Ue?De:we,Ue?we:De,0]],qe=Fe<0?o.aj+Fe:Fe,Ke=[Ue?qe:(ye+we)/2,Ue?(ye+we)/2:qe,0];return De===0&&Fe<0||De!==0&&Fe>0?S.getForTilePoints(Ze,[Ke],!0,Le):ke.push(Ke),S.getForTilePoints(u,ke,!0,R),Math.max(ke[0][2],ke[1][2],Ke[2])/S.exaggeration()};for(let ye=0;ye<4;ye++){const we=g.borderFeatureIndices[ye];if(we.length===0)continue;const De=o.dT[ye](u),Le=V(De);if(!(Le&&Le instanceof o.dU))continue;const Ze=S?S.findDEMTileFor(De):null;if(!(Ze&&Ze.dem||P)||(S&&Ze&&Ze.dem&&g.borderDEMTileTimestamp[ye]!==Ze.dem._timestamp&&(g.borderDoneWithNeighborZ[ye]=-1,g.borderDEMTileTimestamp[ye]=Ze.dem._timestamp),g.borderDoneWithNeighborZ[ye]===Le.canonical.z))continue;Le.centroidVertexArray.length===0&&Le.createCentroidsBuffer();const Ue=(ye<2?1:5)-ye,Fe=Le.borderDoneWithNeighborZ[Ue]!==g.canonical.z,ke=Le.borderFeatureIndices[Ue];let qe=0;if(g.canonical.z!==Le.canonical.z){for(const Ke of we)g.showCentroid(g.featuresOnBorder[Ke]);if(Fe)for(const Ke of ke)Le.showCentroid(Le.featuresOnBorder[Ke]);g.borderDoneWithNeighborZ[ye]=Le.canonical.z,Le.borderDoneWithNeighborZ[Ue]=g.canonical.z}for(const Ke of we){const pt=g.featuresOnBorder[Ke],mt=g.centroidData[pt.centroidDataIndex],It=pt.borders[ye];let Nt;for(;qe<ke.length;){Nt=Le.featuresOnBorder[ke[qe]];const Xt=Nt.borders[Ue];if(Xt[1]>It[0]+3||Xt[0]>It[0]-3)break;Le.showCentroid(Nt),qe++}if(Nt&&qe<ke.length){const Xt=qe;let ut=0;for(;!(Nt.borders[Ue][0]>It[1]-3)&&(ut++,++qe!==ke.length);)Nt=Le.featuresOnBorder[ke[qe]];Nt=Le.featuresOnBorder[ke[Xt]];let Et=!1;if(ut>=1){const wt=Nt.borders[Ue];Math.abs(It[0]-wt[0])<3&&Math.abs(It[1]-wt[1])<3&&(ut=1,Et=!0,qe=Xt+1)}else if(ut===0){g.showCentroid(pt);continue}const at=Le.centroidData[Nt.centroidDataIndex];P&&Et&&(((se=mt).flags|(pe=at).flags)&o.dW?(se.flags|=o.dW,pe.flags|=o.dW):(se.flags&=2147483647,pe.flags&=2147483647));const jt=pt.intersectsCount()>1||Nt.intersectsCount()>1;if(ut>1)qe=Xt,mt.centroidXY=at.centroidXY=new o.P(0,0);else if(Ze&&Ze.dem&&!jt){const wt=Q[ye](mt,at),Ht=ye%2?o.aj-1:0,pn=fe(wt[0],Math.min(o.aj-1,wt[1]),Ht,Ze,De,ye<2,wt[2]);mt.centroidXY=at.centroidXY=N(pn)}else jt?mt.centroidXY=at.centroidXY=new o.P(0,0):(mt.centroidXY=g.encodeBorderCentroid(pt),at.centroidXY=Le.encodeBorderCentroid(Nt));g.writeCentroidToBuffer(mt),Le.writeCentroidToBuffer(at)}else g.showCentroid(pt)}g.borderDoneWithNeighborZ[ye]=Le.canonical.z,Le.borderDoneWithNeighborZ[Ue]=g.canonical.z}var se,pe;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}const wy=[1,0,0],Cm=[0,1,0],Tu=[0,0,1];function Su(m,r,u){const g=u.transform,w=u.shadowRenderer;if(!w)return!0;const S=m.toUnwrapped(),P=g.tileSize*w._cascades[u.currentShadowCascade].scale;let R=r.maxHeight;if(g.elevation){const se=g.elevation.getMinMaxForTile(m);se&&(R+=se.max)}const N=[...w.shadowDirection];N[2]=-N[2];const V=w.computeSimplifiedTileShadowVolume(S,R,P,N);if(!V)return!1;const G=[wy,Cm,Tu,N,[N[0],0,N[2]],[0,N[1],N[2]]],X=g.projection.name==="globe",W=g.scaleZoom(P),Q=o.cn.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,W,!X),fe=w.getCurrentCascadeFrustum();return Q.intersectsPrecise(V.vertices,V.planes,G)===0||fe.intersectsPrecise(V.vertices,V.planes,G)===0}function Qn(m){return[m[0]*o.dZ,m[1]*o.dZ,m[2]*o.dZ,0]}function wa(m,r,u,g,w,S,P,R,N){const V=g.getSource(),G=u.globeSharedBuffers;if(!G)return;let X,W,Q;if(r&&(X=g.getTile(r)),V instanceof o.aP?(W=V.texture,Q=o.ds(0,0,u.transform)):X&&r&&(W=X.texture,Q=o.ds(r.canonical.z,r.canonical.x,u.transform)),!W||!Q)return;m||(Q=o.cE(o.bz(),Q,[1,-1,1]));const fe=u.context,se=fe.gl,pe=w.paint.get("raster-resampling")==="nearest"?se.NEAREST:se.LINEAR,ye=u.colorModeForDrapableLayerRenderPass(S),we=P.defines;we.push("GLOBE_POLES");const De=new Tn(se.LEQUAL,Tn.ReadWrite,u.depthRangeFor3D),Le=Float32Array.from(u.transform.expandedFarZProjMatrix),Ze=Float32Array.from(o.bh(o.dr(new o.cp(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),fe.activeTexture.set(se.TEXTURE0),W.bind(pe,se.CLAMP_TO_EDGE),fe.activeTexture.set(se.TEXTURE1),W.bind(pe,se.CLAMP_TO_EDGE),"useMipmap"in W&&fe.extTextureFilterAnisotropic&&u.transform.pitch>20&&se.texParameterf(se.TEXTURE_2D,fe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,fe.extTextureFilterAnisotropicMax);const[Ue,Fe,ke,qe]=r?G.getPoleBuffers(r.canonical.z,!1):G.getPoleBuffers(0,!0),Ke=w.paint.get("raster-elevation");let pt;m?(pt=Ue,u.renderDefaultNorthPole=Ke!==0):(pt=Fe,u.renderDefaultSouthPole=Ke!==0);const mt=Qn(P.mix),It=((Xt,ut,Et,at,jt,wt,Ht,pn,Ft,rn,Bn,Dn,On)=>_u(Xt,ut,Et,new Float32Array(16),new Float32Array(9),[0,0],at,[0,0],[0,0,0,0],1,{opacity:1,mix:0},wt,[0,0],pn,2,rn,Bn,Dn,1,0,On))(Le,Ze,Q,o.ah(u.transform.zoom),0,w,0,Ke,0,mt,P.offset,P.range,S),Nt=u.getOrCreateProgram("raster",{defines:we});u.uploadCommonUniforms(fe,Nt,null),Nt.draw(u,se.TRIANGLES,De,N,ye,R,It,w.id,pt,ke,qe)}function Hg(m){const r=m._nearZ,u=m.projection.farthestPixelDistance(m),g=u-r,w=.2*m.height,S=r+w;return[r,u,(S-w-r)/g,(S-r)/g]}function Ap(m,r,u,g){if(m)return r instanceof Lo&&m instanceof us?r.getTextureDescriptor(m,u,!0):{texture:m.texture,mix:Qn(g.mix),offset:g.offset,buffer:0,tileSize:1}}var Of=o.d_([{name:"a_index",type:"Int16",components:1}]);class Mm{constructor(r,u,g,w){const S={width:g[0],height:g[1],data:null},P=r.gl;this.targetColorTexture=new o.T(r,S,P.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(r,S,P.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(u,w),this.lastInvalidatedAt=0}updateParticleTexture(r,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,w=u.width*u.height;this.particleTexture0=new o.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1});const S=new o.d$;S.reserve(w);for(let P=0;P<w;P++)S.emplaceBack(P);this.particleIndexBuffer=this.context.createVertexBuffer(S,Of.members,!0),this.particleSegment=o.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function oh(m,r,u){if(!m)return null;const g=r.getTextureDescriptor(m,u,!0);if(!g)return null;let{texture:w,mix:S,offset:P,tileSize:R,buffer:N,format:V}=g;if(!w||!V)return null;let G=!1;return V==="uint32"&&(G=!0,S[3]=0,S=Wh(o.e0,S,[0,u.paint.get("raster-particle-max-speed")]),P=Em(o.e0,P,[0,u.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[N/(R+2*N),R/(R+2*N)],tileSize:R,scalarData:G,scale:S,offset:P,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[V]]}}function Pp(m){const r=m._nearZ,u=m.projection.farthestPixelDistance(m),g=u-r,w=.2*m.height,S=r+w;return[r,u,(S-w-r)/g,(S-r)/g]}const Gg=new o.am(1,0,0,1),Zg=new o.am(0,1,0,1),Al=new o.am(0,0,1,1),Om=new o.am(1,0,1,1),Xs=new o.am(0,1,1,1);function Eu(m,r,u,g,w,S){for(let P=0;P<u.length;P++)if(w){const V=new o.am(g.r*.8,g.g*.8,g.b*.8,1);Xh(m,r,u[P],g,-1,-1,S),Xh(m,r,u[P],g,-1,1,S),Xh(m,r,u[P],g,1,1,S),Xh(m,r,u[P],g,1,-1,S),Xh(m,r,u[P],V,0,0,S)}else Xh(m,r,u[P],g,0,0,S)}function Xh(m,r,u,g,w,S,P){const R=m.context,N=m.transform,V=R.gl,G=N.projection.name==="globe",X=G?["PROJECTION_GLOBE_VIEW"]:[];let W=o.bw(u.projMatrix);if(G&&o.ah(N.zoom)>0){const mt=o.bg(u.canonical,N),It=o.e1(mt);W=o.az(new Float32Array(16),N.globeMatrix,It),o.az(W,N.projMatrix,W)}const Q=o.bz();Q[12]+=2*w/(o.q.devicePixelRatio*N.width),Q[13]+=2*S/(o.q.devicePixelRatio*N.height),o.az(W,Q,W);const fe=m.getOrCreateProgram("debug",{defines:X}),se=r.getTileByID(u.key);m.terrain&&m.terrain.setupElevationDraw(se,fe);const pe=Tn.disabled,ye=di.disabled,we=m.colorModeForRenderPass(),De="$debug";R.activeTexture.set(V.TEXTURE0),m.emptyTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),G?se._makeGlobeTileDebugBuffers(m.context,N):se._makeDebugTileBoundsBuffers(m.context,N.projection);const Le=se._tileDebugBuffer||m.debugBuffer,Ze=se._tileDebugIndexBuffer||m.debugIndexBuffer,Ue=se._tileDebugSegments||m.debugSegments;if(fe.draw(m,V.LINE_STRIP,pe,ye,we,li.disabled,Nd(W,g.toPremultipliedRenderColor(null)),De,Le,Ze,Ue,null,null,null,[se._globeTileDebugBorderBuffer]),P){const mt=se.latestRawTileData,It=Math.floor((mt&&mt.byteLength||0)/1024);let Nt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Nt+=` => ${u.overscaledZ}`),Nt+=` ${se.state}`,Nt+=` ${It}kb`,function(Xt,ut){Xt.initDebugOverlayCanvas();const Et=Xt.debugOverlayCanvas,at=Xt.context.gl,jt=Xt.debugOverlayCanvas.getContext("2d");jt.clearRect(0,0,Et.width,Et.height),jt.shadowColor="white",jt.shadowBlur=2,jt.lineWidth=1.5,jt.strokeStyle="white",jt.textBaseline="top",jt.font="bold 36px Open Sans, sans-serif",jt.fillText(ut,5,5),jt.strokeText(ut,5,5),Xt.debugOverlayTexture.update(Et),Xt.debugOverlayTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE)}(m,Nt)}const Fe=r.getTile(u).tileSize,ke=512/Math.min(Fe,512)*(u.overscaledZ/N.zoom)*.5,qe=se._tileDebugTextBuffer||m.debugBuffer,Ke=se._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,pt=se._tileDebugTextSegments||m.debugSegments;fe.draw(m,V.TRIANGLES,pe,ye,Ri.alphaBlended,li.disabled,Nd(W,o.am.transparent.toPremultipliedRenderColor(null),ke),De,qe,Ke,pt,null,null,null,[se._globeTileDebugTextBuffer])}function Cp(m,r,u,g){Vd(m,0,r+u/2,m.transform.width,u,g)}function If(m,r,u,g){Vd(m,r-u/2,0,u,m.transform.height,g)}function Vd(m,r,u,g,w,S){const P=m.context,R=P.gl;R.enable(R.SCISSOR_TEST),R.scissor(r*o.q.devicePixelRatio,u*o.q.devicePixelRatio,g*o.q.devicePixelRatio,w*o.q.devicePixelRatio),P.clear({color:S}),R.disable(R.SCISSOR_TEST)}const Ty=o.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Au}=Ty;function Mr(m,r,u,g){m.emplaceBack(r,u,g)}class Df{constructor(r){this.vertexArray=new o.e2,this.indices=new o.a_,Mr(this.vertexArray,-1,-1,1),Mr(this.vertexArray,1,-1,1),Mr(this.vertexArray,-1,1,1),Mr(this.vertexArray,1,1,1),Mr(this.vertexArray,-1,-1,-1),Mr(this.vertexArray,1,-1,-1),Mr(this.vertexArray,-1,1,-1),Mr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Au),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.bd.simpleSegment(0,0,36,12)}}function Pu(m,r,u,g,w,S){const P=m.context.gl,R=r.paint.get("sky-atmosphere-color"),N=r.paint.get("sky-atmosphere-halo-color"),V=r.paint.get("sky-atmosphere-sun-intensity"),G=((X,W,Q,fe,se)=>({u_matrix_3f:X,u_sun_direction:W,u_sun_intensity:Q,u_color_tint_r:[fe.r,fe.g,fe.b,fe.a],u_color_tint_m:[se.r,se.g,se.b,se.a],u_luminance:5e-5}))(o.e4(o.dx(),g),w,V,R.toPremultipliedRenderColor(null),N.toPremultipliedRenderColor(null));P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+S,r.skyboxTexture,0),u.draw(m,P.TRIANGLES,Tn.disabled,di.disabled,Ri.unblended,li.frontCW,G,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Wg=o.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Xg{constructor(r){const u=new o.e5;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new o.a_;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(u,Wg.members),this.indexBuffer=r.createIndexBuffer(g),this.segments=o.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Yg=o.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Sy{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class $d{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Ri([1,uu,1,uu],o.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ri([1,0,1,0],o.am.transparent,[!1,!1,!1,!0]),this.params=new Sy,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const u=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Xg(u);const g=this.params.sizeRange,w=this.params.intensityRange,S=function(G){const X=o.e7(30),W=[];for(let Q=0;Q<G;++Q){const fe=2*Math.PI*X(),se=Math.acos(1-2*X())-.5*Math.PI;W.push(o.cS(Math.cos(se)*Math.cos(fe),Math.cos(se)*Math.sin(fe),Math.sin(se)))}return W}(this.params.starsCount),P=o.e7(300),R=new o.e6,N=new o.a_;let V=0;for(let G=0;G<S.length;++G){const X=o.bY([],S[G],200),W=Math.max(0,1+.01*g*(1*P()-.5)),Q=Math.max(0,1+.01*w*(1*P()-.5));R.emplaceBack(X[0],X[1],X[2],-1,-1,W,Q),R.emplaceBack(X[0],X[1],X[2],1,-1,W,Q),R.emplaceBack(X[0],X[1],X[2],1,1,W,Q),R.emplaceBack(X[0],X[1],X[2],-1,1,W,Q),N.emplaceBack(V+0,V+1,V+2),N.emplaceBack(V+0,V+2,V+3),V+=4}this.starsVx=u.createVertexBuffer(R,Yg.members),this.starsIdx=u.createIndexBuffer(N),this.starsSegments=o.bd.simpleSegment(0,0,R.length,N.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,u){const g=r.context,w=g.gl,S=r.transform,P=new Tn(w.LEQUAL,Tn.ReadOnly,[0,1]),R=o.ah(S.zoom),N=r.style.getLut(u.scope),V=u.properties.get("color-use-theme")==="none",G=u.properties.get("color").toNonPremultipliedRenderColor(V?null:N).toArray01(),X=u.properties.get("high-color-use-theme")==="none",W=u.properties.get("high-color").toNonPremultipliedRenderColor(X?null:N).toArray01(),Q=u.properties.get("space-color-use-theme")==="none",fe=u.properties.get("space-color").toNonPremultipliedRenderColor(Q?null:N).toArray01(),se=5e-4,pe=o.e8(u.properties.get("horizon-blend"),0,1,se,.25),ye=o.dl(r,g,S)&&pe===se?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,we=r.frameCounter/1e3%1,De=o.ae(S.globeCenterInViewSpace),Le=Math.sqrt(Math.pow(De,2)-Math.pow(ye,2)),Ze=Math.acos(Le/De),Ue=Fe=>{const ke=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Fe&&ke.push("ALPHA_PASS");const qe=r.getOrCreateProgram("globeAtmosphere",{defines:ke}),Ke=((mt,It,Nt,Xt,ut,Et,at,jt,wt,Ht,pn,Ft)=>({u_frustum_tl:mt,u_frustum_tr:It,u_frustum_br:Nt,u_frustum_bl:Xt,u_horizon:ut,u_transition:Et,u_fadeout_range:at,u_color:jt,u_high_color:wt,u_space_color:Ht,u_temporal_offset:pn,u_horizon_angle:Ft}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,R,pe,G,W,fe,we,Ze);r.uploadCommonUniforms(g,qe);const pt=this.atmosphereBuffer;pt&&qe.draw(r,w.TRIANGLES,P,di.disabled,Fe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,li.backCW,Ke,Fe?"atmosphere_glow_alpha":"atmosphere_glow",pt.vertexBuffer,pt.indexBuffer,pt.segments)};Ue(!1),Ue(!0)}drawStars(r,u){const g=o.ay(u.properties.get("star-intensity"),0,1);if(g===0)return;const w=r.context,S=w.gl,P=r.transform,R=r.getOrCreateProgram("stars"),N=o.b_([]);o.c0(N,N,-P._pitch),o.b$(N,N,-P.angle),o.c0(N,N,o.al(P._center.lat)),o.e9(N,N,-o.al(P._center.lng));const V=o.c3(new Float32Array(16),N),G=o.az([],P.starsProjMatrix,V),X=o.e4([],V),W=o.ea([],X),Q=[0,1,0];o.dz(Q,Q,W),o.bY(Q,Q,this.params.sizeMultiplier);const fe=[1,0,0];o.dz(fe,fe,W),o.bY(fe,fe,this.params.sizeMultiplier);const se=(pe=Q,ye=fe,we=g,{u_matrix:Float32Array.from(G),u_up:pe,u_right:ye,u_intensity_multiplier:we});var pe,ye,we;r.uploadCommonUniforms(w,R),this.starsVx&&this.starsIdx&&R.draw(r,S.TRIANGLES,Tn.disabled,di.disabled,this.colorModeAlphaBlendedWriteRGB,li.disabled,se,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function qd(m,r){const u=[...m],g=r.cameraWorldSizeForFog/r.worldSize,w=o.bx([]);return o.cE(w,w,[g,g,1]),o.az(u,w,u),o.az(u,r.worldToFogMatrix,u),u}function an(m,r,u,g,w){const S=u.material,P=g.context,{baseColorTexture:R,metallicRoughnessTexture:N}=S.pbrMetallicRoughness,{normalTexture:V,occlusionTexture:G,emissionTexture:X}=S;function W(fe,se,pe){if(fe&&(m.push(se),P.activeTexture.set(P.gl.TEXTURE0+pe),fe.gfxTexture)){const{minFilter:ye,magFilter:we,wrapS:De,wrapT:Le}=fe.sampler;fe.gfxTexture.bindExtraParam(ye,we,De,Le)}}W(R,"HAS_TEXTURE_u_baseColorTexture",la.BaseColor),W(N,"HAS_TEXTURE_u_metallicRoughnessTexture",la.MetallicRoughness),W(V,"HAS_TEXTURE_u_normalTexture",la.Normal),W(G,"HAS_TEXTURE_u_occlusionTexture",la.Occlusion),W(X,"HAS_TEXTURE_u_emissionTexture",la.Emission),w&&(w.texture||(w.texture=new o.eh(g.context,w.image,[w.image.height,w.image.height,w.image.height],P.gl.RGBA8)),P.activeTexture.set(P.gl.TEXTURE0+la.LUT),w.texture&&w.texture.bind(P.gl.LINEAR,P.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(u.texcoordBuffer)),u.colorBuffer&&(m.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(u.colorBuffer)),u.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(u.normalBuffer)),u.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(u.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||m.push("DIFFUSE_SHADED");const Q=g.shadowRenderer;Q&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Q.useNormalOffset&&m.push("NORMAL_OFFSET"))}function bn(m,r,u,g,w,S){const P=u.paint.get("model-opacity").constantOr(1),R=r.context,N=new Tn(r.context.gl.LEQUAL,Tn.ReadWrite,r.depthRangeFor3D),V=r.transform,G=m.mesh,X=G.material,W=X.pbrMetallicRoughness,Q=r.style.fog;let fe;fe=r.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:o.az([],g.zScaleMatrix,m.nodeModelMatrix),o.az(fe,g.negCameraPosMatrix,fe);const se=o.bi([],fe);o.ee(se,se);const pe=u.paint.get("model-color-use-theme").constantOr("default")==="none",ye=u.paint.get("model-emissive-strength").constantOr(0),we=Mf(new Float32Array(m.worldViewProjection),new Float32Array(fe),new Float32Array(se),null,r,P,W.baseColorFactor,X.emissiveFactor,W.metallicFactor,W.roughnessFactor,X,ye,u),De={defines:[]},Le=[],Ze=r.shadowRenderer;Ze&&(Ze.useNormalOffset=!1),an(De.defines,Le,G,r,pe?null:u.lut);let Ue=null;if(Q){const qe=qd(m.nodeModelMatrix,r.transform);if(Ue=new Float32Array(qe),V.projection.name!=="globe"){const Ke=G.aabb.min,pt=G.aabb.max,[mt,It]=Q.getOpacityForBounds(qe,Ke[0],Ke[1],pt[0],pt[1]);De.overrideFog=mt>=ht||It>=ht}}const Fe=ac(r,u.paint.get("model-cutoff-fade-range"));Fe.shouldRenderCutoff&&De.defines.push("RENDER_CUTOFF");const ke=r.getOrCreateProgram("model",De);r.uploadCommonUniforms(R,ke,null,Ue,Fe),r.renderPass!=="shadow"&&Ze&&Ze.setupShadowsFromMatrix(m.nodeModelMatrix,ke),ke.draw(r,R.gl.TRIANGLES,N,w,S,G.material.doubleSided?li.disabled:li.backCCW,we,u.id,G.vertexBuffer,G.indexBuffer,G.segments,u.paint,r.transform.zoom,void 0,Le)}function Cu(m,r,u,g,w,S,P){let R;R=m.projection.name==="globe"?o.ed(u,m):[...u],o.az(R,R,r.matrix);const N=o.az([],g,R);if(r.meshes)for(const V of r.meshes){if(V.material.alphaMode!=="BLEND"){P.push({mesh:V,depth:0,modelIndex:w,worldViewProjection:N,nodeModelMatrix:R});continue}const G=o.ad([],V.centroid,N);!m.isOrthographic&&G[2]<=0||S.push({mesh:V,depth:G[2],modelIndex:w,worldViewProjection:N,nodeModelMatrix:R})}if(r.children)for(const V of r.children)Cu(m,V,u,g,w,S,P)}function bo(m,r,u,g){const w=u.shadowRenderer;if(!w)return;const S=w.getShadowPassDepthMode(),P=w.getShadowPassColorMode(),R=w.calculateShadowPassMatrixFromMatrix(r),N=Ud(R);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,S,di.disabled,P,li.backCCW,N,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,u.transform.zoom,void 0,void 0)}function ft(m,r,u){const g=r.updateZoomBasedPaintProperties(),w=function(S,P,R){let N,V,G,X=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&X>0){const W=S.terrain,Q=W.findDEMTileFor(R);Q&&Q.dem?N=o.ei.create(W,R,Q):X=0}if(X===0&&(P.terrainElevationMin=0,P.terrainElevationMax=0),X===P.validForExaggeration&&(X===0||N&&N._demTile&&N._demTile.tileID===P.validForDEMTile.id&&N._dem._timestamp===P.validForDEMTile.timestamp))return!1;for(const W in P.instancesPerModel){const Q=P.instancesPerModel[W];for(let fe=0;fe<Q.instancedDataArray.length;++fe){const se=(N?X*N.getElevationAt(0|Q.instancedDataArray.float32[16*fe],0|Q.instancedDataArray.float32[16*fe+1],!0,!0):0)+Q.instancesEvaluatedElevation[fe];Q.instancedDataArray.float32[16*fe+6]=se,V=V?Math.min(P.terrainElevationMin,se):se,G=G?Math.max(P.terrainElevationMax,se):se}}return P.terrainElevationMin=V||0,P.terrainElevationMax=G||0,P.validForExaggeration=X,P.validForDEMTile=N&&N._demTile?{id:N._demTile.tileID,timestamp:N._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,r,u);(g||w)&&(r.uploaded=!1,r.upload(m.context))}const Pl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.cW([0,0,0],[o.aj,o.aj,0])};function Mp(m,r){const u=1<<m.canonical.z,g=r.getFreeCameraOptions().position,w=r.elevation,S=m.canonical.x/u,P=(m.canonical.x+1)/u,R=m.canonical.y/u,N=(m.canonical.y+1)/u;let V=r._centerAltitude;if(w){const Q=w.getMinMaxForTile(m);Q&&Q.max>V&&(V=Q.max)}const G=o.ay(g.x,S,P)-g.x,X=o.ay(g.y,R,N)-g.y,W=o.c6(V,r.center.lat)-g.z;return r._zoomFromMercatorZ(Math.sqrt(G*G+X*X+W*W))}function Op(m,r,u,g,w,S,P){const R=m.context,N=m.renderPass==="shadow",V=m.shadowRenderer,G=N&&V?V.getShadowPassDepthMode():new Tn(R.gl.LEQUAL,Tn.ReadWrite,m.depthRangeFor3D),X=m.isTileAffectedByFog(S);if(u.meshes)for(const W of u.meshes){const Q=["MODEL_POSITION_ON_GPU"],fe=[];let se,pe,ye;g.instancedDataArray.length>20&&Q.push("INSTANCED_ARRAYS");const we=ac(m,r.paint.get("model-cutoff-fade-range"));if(we.shouldRenderCutoff&&Q.push("RENDER_CUTOFF"),N&&V)se=m.getOrCreateProgram("modelDepth",{defines:Q}),pe=Ud(P.shadowTileMatrix,P.shadowTileMatrix,Float32Array.from(u.matrix)),ye=V.getShadowPassColorMode();else{an(Q,fe,W,m,r.paint.get("model-color-use-theme").constantOr("default")==="none"?null:r.lut),se=m.getOrCreateProgram("model",{defines:Q,overrideFog:X});const Le=W.material,Ze=Le.pbrMetallicRoughness,Ue=r.paint.get("model-opacity").constantOr(1),Fe=r.paint.get("model-emissive-strength").constantOr(0);pe=Mf(S.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,m,Ue,Ze.baseColorFactor,Le.emissiveFactor,Ze.metallicFactor,Ze.roughnessFactor,Le,Fe,r,w),V&&(P.shadowUniformsInitialized?se.setShadowUniformValues(R,V.getShadowUniformValues()):(V.setupShadows(S.toUnwrapped(),se,"model-tile",S.overscaledZ),P.shadowUniformsInitialized=!0)),ye=we.shouldRenderCutoff||Ue<1||Le.alphaMode!=="OPAQUE"?Ri.alphaBlended:Ri.unblended}m.uploadCommonUniforms(R,se,S.toUnwrapped(),null,we);const De=W.material.doubleSided?li.disabled:li.backCCW;if(g.instancedDataArray.length>20)fe.push(g.instancedDataBuffer),se.draw(m,R.gl.TRIANGLES,G,di.disabled,ye,De,pe,r.id,W.vertexBuffer,W.indexBuffer,W.segments,r.paint,m.transform.zoom,void 0,fe,g.instancedDataArray.length);else{const Le=N?"u_instance":"u_normal_matrix";for(let Ze=0;Ze<g.instancedDataArray.length;++Ze)pe[Le]=new Float32Array(g.instancedDataArray.arrayBuffer,64*Ze,16),se.draw(m,R.gl.TRIANGLES,G,di.disabled,ye,De,pe,r.id,W.vertexBuffer,W.indexBuffer,W.segments,r.paint,m.transform.zoom,void 0,fe)}}if(u.children)for(const W of u.children)Op(m,r,W,g,w,S,P)}const Im=[1,-1,1];function Kg(m,r,u,g){if(!u.modelManager)return!0;const w=u.modelManager;if(!u.shadowRenderer)return!0;const S=u.shadowRenderer,P=r.aabb;let R=!0,N=m.maxHeight;if(N===0){let G=0;for(const X in m.instancesPerModel){const W=w.getModel(X,g);W?G=Math.max(G,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):R=!1}N=m.maxScale*G*1.41+m.maxVerticalOffset,R&&(m.maxHeight=N)}P.max[2]=N,P.min[2]+=m.terrainElevationMin,P.max[2]+=m.terrainElevationMax,o.ad(P.min,P.min,r.tileMatrix),o.ad(P.max,P.max,r.tileMatrix);const V=P.intersects(S.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=V===2),V===0}function Jg(m,r){const u=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],w=m.uniformValues.u_cutoff_params[2],S=m.uniformValues.u_cutoff_params[3];return g===u||S===w?1:o.ay(((r-u)/(g-u)-w)/(S-w),0,1)}function Hd(m,r,u,g){if(r.pitch<20)return 1;const w=r.getWorldToCameraMatrix();o.az(w,w,m);const S=o.ej(u.min[0],u.min[1],u.min[2],1);let P=o.aA(o.ek(),S,w),R=P,N=P;S[1]=u.max[1],P=o.aA(o.ek(),S,w),R=P[1]<R[1]?P:R,N=P[1]>N[1]?P:N,S[0]=u.max[0],P=o.aA(o.ek(),S,w),R=P[1]<R[1]?P:R,N=P[1]>N[1]?P:N,S[1]=u.min[1],P=o.aA(o.ek(),S,w),R=P[1]<R[1]?P:R,N=P[1]>N[1]?P:N;const V=o.ay(g[0],0,1),G=100*r.pixelsPerMeter*o.ay(g[1],0,1),X=o.ay(g[2],0,1),W=o.el(o.ek(),R,N,V),Q=Math.tan(.5*r.fovX),fe=-W[2]*Q;if(G===0)return W[1]<-Math.abs(fe)?X:1;const se=(-Math.abs(fe)-W[1])/G,pe=(we,De,Le)=>(1-Le)*we+Le*De,ye=o.ay(pe(1,X,se),X,1);return pe(1,ye,o.ay((r.pitch-20)/20,0,1))}class Qg{}class Ey{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,u,g){{const X=this._storage.get(u.id);if(X)return X.lastUsedFrameIdx=r,X.buf}const w=g.gl,S=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),P=new ArrayBuffer(S),R=new Int16Array(P);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(P));const N=new o.en;for(let X=0;X<S/2;X+=3){const W=R[X],Q=R[X+1],fe=R[X+2];N.emplaceBack(W,Q),N.emplaceBack(Q,fe),N.emplaceBack(fe,W)}const V=g.bindVertexArrayOES.current,G=new Qg;return G.buf=new Xl(g,N),G.lastUsedFrameIdx=r,this._storage.set(u.id,G),g.bindVertexArrayOES.set(V),G.buf}update(r){for(const[u,g]of this._storage)r-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(u))}destroy(){for(const[r,u]of this._storage)u.buf.destroy(),this._storage.delete(r)}}class e_{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Rf=o.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Dm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Rm{constructor(r,u){this.revealStart=11,this.revealRange=2,r.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),r.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Ay=o.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class Lf{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(r,u){const g=r.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const P=new o.eo,R=new o.a_;P.emplaceBack(-1,-1),P.emplaceBack(1,-1),P.emplaceBack(1,1),P.emplaceBack(-1,1),R.emplaceBack(0,1,2),R.emplaceBack(0,2,3),this.vignetteVx=r.context.createVertexBuffer(P,Ay.members),this.vignetteIdx=r.context.createIndexBuffer(R)}const w=o.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){r.uploadCommonUniforms(r.context,g);const P={u_vignetteShape:(S={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:S.vignetteColor};g.draw(r,r.context.gl.TRIANGLES,Tn.disabled,di.disabled,Ri.alphaBlended,li.disabled,P,"vignette",this.vignetteVx,this.vignetteIdx,w)}var S}}class zf{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(r,u){const g=r.getFreeCameraOptions().position,w=g.toAltitude(),S=g.toLngLat(),P=o.al(S.lng),R=o.al(S.lat),N=r.pixelsPerMeter/u,V=P*o.eq,G=o.eq*Math.log(Math.tan(Math.PI/4+R/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const X=-this._offsetYPrev+G,W=-this._elevationPrev+w;this._accumulatedOffsetX+=(-this._offsetXPrev+V)*N,this._accumulatedOffsetY+=X*N,this._accumulatedElevation+=W*N,this._offsetXPrev=V,this._offsetYPrev=G,this._elevationPrev=w}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Yh(m,r){return[-(m[0]-Math.floor(m[0]/r)*r),-(m[1]-Math.floor(m[1]/r)*r),-(m[2]-Math.floor(m[2]/r)*r)]}function Ip(m){const r=o.e7(1323123451230),u=[];for(let g=0;g<m;++g){const w=2*r()-1,S=2*r()-1,P=2*r()-1;u.push(o.cS(w,S,P))}return u}function ah(m,r,u,g,w){const S=o.ay((w-u)/(g-u),0,1);return(1-S)*m+S*r}class Fs{constructor(r){this._movement=new zf,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Lf,this._ppmScaleFactor=r}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(r,u){const g=r.transform;this._movement.update(g,this._ppmScaleFactor);const w=g.starsProjMatrix,S=o.b_([]);o.c0(S,S,o.al(90)-g._pitch),o.b$(S,S,-g.angle);const P=o.c3(new Float32Array(16),S),R=o.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),N=o.ee([],R),V=o.az([],N,P),G=Date.now()/1e3;return this._accumulatedTimeFromStart+=(G-this._prevTime)*u,this._prevTime=G,{projectionMatrix:w,modelviewMatrix:V}}}class i0 extends Fs{constructor(r){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Rm(r.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(r){const u=r.context;if(!this.particlesVx){const g=Ip(this.particlesCount),w=new o.er,S=new o.a_;let P=0;const R=o.e7(1323123451230);for(let N=0;N<g.length;++N){const V=g[N],G=[2*R()-1,R(),R(),R()];w.emplaceBack(V[0],V[1],V[2],-1,-1,...G),w.emplaceBack(V[0],V[1],V[2],1,-1,...G),w.emplaceBack(V[0],V[1],V[2],1,1,...G),w.emplaceBack(V[0],V[1],V[2],-1,1,...G),S.emplaceBack(P+0,P+1,P+2),S.emplaceBack(P+0,P+2,P+3),P+=4}this.particlesVx=u.createVertexBuffer(w,Rf.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=r.transform.zoom;if(u.revealStart>g)return;const w=ah(0,1,u.revealStart,u.revealStart+u.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const S=structuredClone(this._params);let P=[-S.direction.x,S.direction.y,-100];o.au(P,P);const R=structuredClone(this._vignetteParams);R.strength*=w,S.overrideStyleParameters||(S.intensity=r.style.rain.state.density,S.timeFactor=r.style.rain.state.intensity,S.color=structuredClone(r.style.rain.state.color),P=structuredClone(r.style.rain.state.direction),S.screenThinning.intensity=r.style.rain.state.centerThinning,S.dropletSizeX=r.style.rain.state.dropletSize[0],S.dropletSizeYScale=r.style.rain.state.dropletSize[1]/r.style.rain.state.dropletSize[0],S.distortionStrength=100*r.style.rain.state.distortionStrength,R.strength=1,R.color=structuredClone(r.style.rain.state.vignetteColor));const N=this.updateOnRender(r,S.timeFactor),V=r.context,G=V.gl,X=r.transform;this.screenTexture&&this.screenTexture.size[0]===r.width&&this.screenTexture.size[1]===r.height||(this.screenTexture=new o.T(V,{width:r.width,height:r.height,data:null},G.RGBA8)),S.distortionStrength>0&&(V.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.copyTexSubImage2D(G.TEXTURE_2D,0,0,0,0,0,r.width,r.height));const W=r.getOrCreateProgram("rainParticle");r.uploadCommonUniforms(V,W),V.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const Q=[S.color.r,S.color.g,S.color.b,S.color.a],fe=(se,pe)=>{const ye=Yh(this._movement.getPosition(),se),we=S.dropletSizeX,De=S.dropletSizeX*S.dropletSizeYScale,Le=r.width/2,Ze=r.height/2,Ue=ah(0,S.screenThinning.start,0,1,S.screenThinning.intensity),Fe=ah(.001,S.screenThinning.range,0,1,S.screenThinning.intensity),ke=ah(0,S.screenThinning.particleOffset,0,1,S.screenThinning.intensity),qe=(Ke={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ye,velocityConeAperture:S.velocityConeAperture,velocity:S.velocity,boxSize:se,rainDropletSize:[we,De],distortionStrength:S.distortionStrength,rainDirection:P,color:Q,screenSize:[X.width,X.height],thinningCenterPos:[Le,Ze],thinningShape:[Ue,Fe,Math.pow(10,S.screenThinning.fadePower)],thinningAffectedRatio:S.screenThinning.affectedRatio,thinningParticleOffset:ke,shapeDirectionalPower:S.shapeDirPower,shapeNormalPower:S.shapeNormalPower,mode:pe?0:1},{u_modelview:Float32Array.from(Ke.modelview),u_projection:Float32Array.from(Ke.projection),u_time:Ke.time,u_cam_pos:Ke.camPos,u_texScreen:0,u_velocityConeAperture:Ke.velocityConeAperture,u_velocity:Ke.velocity,u_boxSize:Ke.boxSize,u_rainDropletSize:Ke.rainDropletSize,u_distortionStrength:Ke.distortionStrength,u_rainDirection:Ke.rainDirection,u_color:Ke.color,u_screenSize:Ke.screenSize,u_thinningCenterPos:Ke.thinningCenterPos,u_thinningShape:Ke.thinningShape,u_thinningAffectedRatio:Ke.thinningAffectedRatio,u_thinningParticleOffset:Ke.thinningParticleOffset,u_shapeDirectionalPower:Ke.shapeDirectionalPower,u_shapeNormalPower:Ke.shapeNormalPower,u_mode:Ke.mode});var Ke;const pt=Math.round(S.intensity*this.particlesCount),mt=o.bd.simpleSegment(0,0,4*pt,2*pt);W.draw(r,G.TRIANGLES,Tn.disabled,di.disabled,Ri.alphaBlended,li.disabled,qe,"rain_particles",this.particlesVx,this.particlesIdx,mt)};S.distortionStrength>0&&fe(S.boxSize,!0),fe(S.boxSize,!1),this._vignette.draw(r,R)}}const Dp=o.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Qr extends Fs{constructor(r){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Rm(r.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(r){const u=r.context;if(!this.particlesVx){const g=Ip(this.particlesCount),w=new o.es,S=new o.a_;let P=0;const R=o.e7(1323123451230);for(let N=0;N<g.length;++N){const V=g[N],G=R(),X=R(),W=R(),Q=[N/g.length,G,X,W],fe=[R(),R()];w.emplaceBack(V[0],V[1],V[2],-1,-1,...Q,...fe),w.emplaceBack(V[0],V[1],V[2],1,-1,...Q,...fe),w.emplaceBack(V[0],V[1],V[2],1,1,...Q,...fe),w.emplaceBack(V[0],V[1],V[2],-1,1,...Q,...fe),S.emplaceBack(P+0,P+1,P+2),S.emplaceBack(P+0,P+2,P+3),P+=4}this.particlesVx=u.createVertexBuffer(w,Dp.members),this.particlesIdx=u.createIndexBuffer(S)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.snow)return;const u=structuredClone(this._params);let g=[-u.direction.x,u.direction.y,-100];o.au(g,g);const w=structuredClone(this._vignetteParams),S=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},P=r.transform.zoom;if(S.revealStart>P)return;const R=ah(0,1,S.revealStart,S.revealStart+S.revealRange,P);w.strength*=R,u.overrideStyleParameters||(u.intensity=r.style.snow.state.density,u.timeFactor=r.style.snow.state.intensity,u.color=structuredClone(r.style.snow.state.color),g=structuredClone(r.style.snow.state.direction),u.screenThinning.intensity=r.style.snow.state.centerThinning,u.billboardSize=2.79*r.style.snow.state.flakeSize,w.strength=1,w.color=structuredClone(r.style.snow.state.vignetteColor));const N=this.updateOnRender(r,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const V=r.context,G=V.gl,X=r.transform,W=r.getOrCreateProgram("snowParticle");r.uploadCommonUniforms(V,W),((Q,fe,se)=>{const pe=Yh(this._movement.getPosition(),Q),ye=X.width/2,we=X.height/2,De=ah(0,se.screenThinning.start,0,1,se.screenThinning.intensity),Le=ah(.001,se.screenThinning.range,0,1,se.screenThinning.intensity),Ze=ah(0,se.screenThinning.particleOffset,0,1,se.screenThinning.intensity),Ue=(Fe={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:pe,velocityConeAperture:se.velocityConeAperture,velocity:se.velocity,horizontalOscillationRadius:se.horizontalOscillationRadius,horizontalOscillationRate:se.horizontalOscillationRate,boxSize:Q,billboardSize:1*se.billboardSize,simpleShapeParameters:[se.shapeFadeStart,se.shapeFadePower],screenSize:[X.width,X.height],thinningCenterPos:[ye,we],thinningShape:[De,Le,Math.pow(10,se.screenThinning.fadePower)],thinningAffectedRatio:se.screenThinning.affectedRatio,thinningParticleOffset:Ze,color:[se.color.r,se.color.g,se.color.b,se.color.a],direction:g},{u_modelview:Float32Array.from(Fe.modelview),u_projection:Float32Array.from(Fe.projection),u_time:Fe.time,u_cam_pos:Fe.camPos,u_velocityConeAperture:Fe.velocityConeAperture,u_velocity:Fe.velocity,u_horizontalOscillationRadius:Fe.horizontalOscillationRadius,u_horizontalOscillationRate:Fe.horizontalOscillationRate,u_boxSize:Fe.boxSize,u_billboardSize:Fe.billboardSize,u_simpleShapeParameters:Fe.simpleShapeParameters,u_screenSize:Fe.screenSize,u_thinningCenterPos:Fe.thinningCenterPos,u_thinningShape:Fe.thinningShape,u_thinningAffectedRatio:Fe.thinningAffectedRatio,u_thinningParticleOffset:Fe.thinningParticleOffset,u_particleColor:Fe.color,u_direction:Fe.direction});var Fe;const ke=Math.round(se.intensity*this.particlesCount),qe=o.bd.simpleSegment(0,0,4*ke,2*ke);this.particlesVx&&this.particlesIdx&&W.draw(r,G.TRIANGLES,Tn.disabled,di.disabled,Ri.alphaBlended,li.disabled,Ue,"snow_particles",this.particlesVx,this.particlesIdx,qe)})(u.boxSize,0,u),this._vignette.draw(r,w)}}const ar={symbol:function(m,r,u,g,w){if(m.renderPass!=="translucent")return;const S=di.disabled,P=m.colorModeForRenderPass(),R=u.layout.get("text-variable-anchor"),N=u.layout.get("text-size-scale-range"),V=o.ay(m.scaleFactor,N[0],N[1]);R&&function(W,Q,fe,se,pe,ye,we,De){const Le=Q.transform,Ze=pe==="map",Ue=ye==="map";for(const Fe of W){const ke=se.getTile(Fe),qe=ke.getBucket(fe);if(!qe||!qe.text||!qe.text.segments.get().length)continue;const Ke=o.bH(qe.textSizeData,Le.zoom,De),pt=Ll(Fe,qe.getProjection(),Le),mt=Le.calculatePixelsToTileUnitsMatrix(ke),It=$a(pt,ke.tileID.canonical,Ue,Ze,Le,qe.getProjection(),mt),Nt=qe.hasIconTextFit()&&qe.hasIconData();Ke&&Sp(qe,Ze,Ue,we,Le,It,Fe,Math.pow(2,Le.zoom-ke.tileID.overscaledZ),Ke,Nt)}}(g,m,u,r,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),w,V);const G=u.paint.get("icon-opacity").constantOr(1)!==0,X=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(G||X)?bu(m,r,u,g,S,P):(G&&bu(m,r,u,g,S,P,{onlyIcons:!0}),X&&bu(m,r,u,g,S,P,{onlyText:!0})),r.map.showCollisionBoxes&&(Ra(m,r,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Ra(m,r,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(m,r,u,g){if(m.renderPass!=="translucent")return;const w=u.paint.get("circle-opacity"),S=u.paint.get("circle-stroke-width"),P=u.paint.get("circle-stroke-opacity"),R=u.layout.get("circle-sort-key").constantOr(1)!==void 0,N=u.paint.get("circle-emissive-strength");if(w.constantOr(1)===0&&(S.constantOr(1)===0||P.constantOr(1)===0))return;const V=m.context,G=V.gl,X=m.transform,W=!(!m.terrain||!m.terrain.enabled),Q=u.layout.get("circle-elevation-reference"),fe=m.depthModeForSublayer(0,Tn.ReadOnly),se=new Tn(m.context.gl.LEQUAL,Tn.ReadOnly,m.depthRangeFor3D),pe=Q==="none"||W?fe:se,ye=di.disabled,we=m.colorModeForDrapableLayerRenderPass(N),De=X.projection.name==="globe",Le=[o.aD(X.center.lng),o.aH(X.center.lat)],Ze=[];for(let Fe=0;Fe<g.length;Fe++){const ke=g[Fe],qe=r.getTile(ke),Ke=qe.getBucket(u);if(!Ke||Ke.projection.name!==X.projection.name)continue;const pt=Ke.programConfigurations.get(u.id),mt=Ke.layoutVertexBuffer,It=Ke.globeExtVertexBuffer,Nt=Ke.indexBuffer,Xt=o.dK(u),ut=[It],Et=m.isTileAffectedByFog(ke);De&&Xt.push("PROJECTION_GLOBE_VIEW"),Xt.push("DEPTH_D24"),m.terrain&&X.depthOcclusionForSymbolsAndCircles&&Xt.push("DEPTH_OCCLUSION"),Ke.hasElevation&&(Xt.push("ELEVATED_ROADS"),ut.push(Ke.elevatedLayoutVertexBuffer));const at=m.getOrCreateProgram("circle",{config:pt,defines:Xt,overrideFog:Et}),jt=X.projection.createInversionMatrix(X,ke.canonical),wt={programConfiguration:pt,program:at,layoutVertexBuffer:mt,dynamicBuffers:ut,indexBuffer:Nt,uniformValues:o.dL(m,ke,qe,jt,Le,u),tile:qe};if(R){const Ht=Ke.segments.get();for(const pn of Ht)Ze.push({segments:new o.bd([pn]),sortKey:pn.sortKey,state:wt})}else Ze.push({segments:Ke.segments,sortKey:0,state:wt})}R&&Ze.sort((Fe,ke)=>Fe.sortKey-ke.sortKey);const Ue={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const Fe of Ze){const{programConfiguration:ke,program:qe,layoutVertexBuffer:Ke,dynamicBuffers:pt,indexBuffer:mt,uniformValues:It,tile:Nt}=Fe.state,Xt=Fe.segments;m.terrain&&m.terrain.setupElevationDraw(Nt,qe,Ue),m.uploadCommonUniforms(V,qe,Nt.tileID.toUnwrapped()),qe.draw(m,G.TRIANGLES,pe,ye,we,li.disabled,It,u.id,Ke,mt,Xt,u.paint,X.zoom,ke,pt)}},heatmap:function(m,r,u,g){if(u.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const w=m.context,S=w.gl,P=di.disabled,R=new Ri([S.ONE,S.ONE,S.ONE,S.ONE],o.am.transparent,[!0,!0,!0,!0]);(function(Q,fe,se,pe){const ye=Q.gl,we=fe.width*pe,De=fe.height*pe;Q.activeTexture.set(ye.TEXTURE1),Q.viewport.set([0,0,we,De]);let Le=se.heatmapFbo;if(!Le||Le&&(Le.width!==we||Le.height!==De)){Le&&Le.destroy();const Ze=ye.createTexture();ye.bindTexture(ye.TEXTURE_2D,Ze),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MIN_FILTER,ye.LINEAR),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MAG_FILTER,ye.LINEAR),Le=se.heatmapFbo=Q.createFramebuffer(we,De,!0,null),function(Ue,Fe,ke,qe,Ke,pt){const mt=Ue.gl;mt.texImage2D(mt.TEXTURE_2D,0,Ue.extRenderToTextureHalfFloat?mt.RGBA16F:mt.RGBA,Ke,pt,0,mt.RGBA,Ue.extRenderToTextureHalfFloat?mt.HALF_FLOAT:mt.UNSIGNED_BYTE,null),qe.colorAttachment.set(ke)}(Q,0,Ze,Le,we,De)}else ye.bindTexture(ye.TEXTURE_2D,Le.colorAttachment.get()),Q.bindFramebuffer.set(Le.framebuffer)})(w,m,u,m.transform.projection.name==="globe"?.5:.25),w.clear({color:o.am.transparent});const N=m.transform,V=N.projection.name==="globe",G=V?["PROJECTION_GLOBE_VIEW"]:[],X=V?li.frontCCW:li.disabled,W=[o.aD(N.center.lng),o.aH(N.center.lat)];for(let Q=0;Q<g.length;Q++){const fe=g[Q];if(r.hasRenderableParent(fe))continue;const se=r.getTile(fe),pe=se.getBucket(u);if(!pe||pe.projection.name!==N.projection.name)continue;const ye=m.isTileAffectedByFog(fe),we=pe.programConfigurations.get(u.id),De=m.getOrCreateProgram("heatmap",{config:we,defines:G,overrideFog:ye}),{zoom:Le}=m.transform;m.terrain&&m.terrain.setupElevationDraw(se,De),m.uploadCommonUniforms(w,De,fe.toUnwrapped());const Ze=N.projection.createInversionMatrix(N,fe.canonical);De.draw(m,S.TRIANGLES,Tn.disabled,P,R,X,Af(m,fe,se,Ze,W,Le,u.paint.get("heatmap-intensity")),u.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,u.paint,m.transform.zoom,we,V?[pe.globeExtVertexBuffer]:null)}w.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(w,S){const P=w.context,R=P.gl,N=S.heatmapFbo;if(!N)return;P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,N.colorAttachment.get()),P.activeTexture.set(R.TEXTURE1);let V=S.colorRampTexture;V||(V=S.colorRampTexture=new o.T(P,S.colorRamp,R.RGBA8)),V.bind(R.LINEAR,R.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,R.TRIANGLES,Tn.disabled,di.disabled,w.colorModeForRenderPass(),li.disabled,((G,X,W,Q)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,S),S.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,S.paint,w.transform.zoom)}(m,u))},line:function(m,r,u,g){if(m.renderPass!=="translucent")return;const w=u.paint.get("line-opacity"),S=u.paint.get("line-width");if(w.constantOr(1)===0||S.constantOr(1)===0)return;const P=u.paint.get("line-emissive-strength"),R=u.paint.get("line-occlusion-opacity"),N=u.layout.get("line-elevation-reference"),V=u.layout.get("line-width-unit")==="meters",G=N==="sea",X=!(!m.terrain||!m.terrain.enabled),W=m.context,Q=W.gl;if(u.hasElevatedBuckets&&m.transform.projection.name==="globe")return;const fe=u.layout.get("line-cross-slope"),se=fe!==void 0,pe=fe<1,ye=m.colorModeForDrapableLayerRenderPass(P),we=m.terrain&&m.terrain.renderingToTexture,De=we?1:o.q.devicePixelRatio,Le=u.paint.get("line-dasharray"),Ze=Le.constantOr(1),Ue=u.layout.get("line-cap"),Fe=Le.constantOr(null),ke=Ue.constantOr(null),qe=u.paint.get("line-pattern"),Ke=qe.constantOr(1),pt=u.paint.get("line-pattern-cross-fade"),mt=qe.constantOr(null),It=u.paint.get("line-opacity").constantOr(1);let Nt=!Ke&&It!==1||m.depthOcclusion&&R>0&&R<1;const Xt=u.paint.get("line-gradient"),ut=Ke?"linePattern":"line",Et=o.dM(u);let at;if(we&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Nt=!1),R!==0&&m.depthOcclusion){const pn=u.paint._values["line-opacity"];pn&&pn.value&&pn.value.kind==="constant"?at=pn.value:o.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}S.value.kind!=="constant"&&S.value.isLineProgressConstant===!1&&Et.push("VARIABLE_LINE_WIDTH");const jt=(pn,Ft,rn,Bn,Dn,On)=>{for(const Yn of pn){const ni=r.getTile(Yn);if(Ke&&!ni.patternsLoaded())continue;const Rn=ni.getBucket(u);if(!Rn||Rn.elevationType!=="none"&&!Dn||Rn.elevationType==="none"&&Dn)continue;m.prepareDrawTile();const Kn=[...Ft],ei=m.shadowRenderer,_i=Rn.elevationType==="road"&&!!ei&&ei.enabled;let Pi=[0,0,0];if(_i){const Ki=m.style.directionalLight,jr=m.style.ambientLight;Ki&&jr&&(Pi=Uc(m.style,Ki,jr)),Kn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Yi=Rn.programConfigurations.get(u.id);let fr=!1;if(mt&&ni.imageAtlas){const Ki=o.dN.from(mt),jr=Ki.getPrimary().scaleSelf(De).toString(),qr=ni.imageAtlas.patternPositions.get(jr),Lr=Ki.getSecondary(),Fr=Lr?ni.imageAtlas.patternPositions.get(Lr.scaleSelf(De).toString()):null;fr=!!qr&&!!Fr,qr&&Yi.setConstantPatternPositions(qr,Fr)}pt>0&&(fr||Yi.getPatternTransitionVertexBuffer("line-pattern"))&&Kn.push("LINE_PATTERN_TRANSITION");const ho=m.isTileAffectedByFog(Yn),wi=m.getOrCreateProgram(ut,{config:Yi,defines:Kn,overrideFog:ho,overrideRtt:!Dn&&void 0});if(!Ke&&Fe&&ke&&ni.lineAtlas){const Ki=ni.lineAtlas.getDash(Fe,ke);Ki&&Yi.setConstantPatternPositions(Ki)}_i&&ei.setupShadows(ni.tileID.toUnwrapped(),wi,"vector-tile",ni.tileID.overscaledZ);let[xi,fi]=u.paint.get("line-trim-offset");(ke==="round"||ke==="square")&&xi!==fi&&(xi===0&&(xi-=1),fi===1&&(fi+=1));const Pr=we?Yn.projMatrix:null,Io=V?1/Rn.tileToMeter/o.aw(ni,1,m.transform.zoom):1,Br=V?1/Rn.tileToMeter/o.aw(ni,1,Math.floor(m.transform.zoom)):1,Gi=Ke?o.dO(m,ni,u,Pr,De,Io,Br,[xi,fi],Pi,pt):o.dP(m,ni,u,Pr,Rn.lineClipsArray.length,De,Io,Br,[xi,fi],Pi);if(Xt){const Ki=Rn.gradients[u.id];let jr=Ki.texture;if(u.gradientVersion!==Ki.version){let qr=256;if(u.stepInterpolant){const Lr=r.getSource().maxzoom,Fr=Yn.canonical.z===Lr?Math.ceil(1<<m.transform.maxZoom-Yn.canonical.z):1;qr=o.ay(o.dQ(Rn.maxLineLength/o.aj*1024*Fr),256,W.maxTextureSize)}Ki.gradient=o.dR({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:qr,image:Ki.gradient||void 0,clips:Rn.lineClipsArray}),Ki.texture?Ki.texture.update(Ki.gradient):Ki.texture=new o.T(W,Ki.gradient,Q.RGBA8),Ki.version=u.gradientVersion,jr=Ki.texture}W.activeTexture.set(Q.TEXTURE1),jr.bind(u.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}Ze&&(W.activeTexture.set(Q.TEXTURE0),ni.lineAtlasTexture&&ni.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),Yi.updatePaintBuffers()),Ke&&(W.activeTexture.set(Q.TEXTURE0),ni.imageAtlasTexture&&ni.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Yi.updatePaintBuffers()),Dn&&!G&&m.terrain.setupElevationDraw(ni,wi),m.uploadCommonUniforms(W,wi,Yn.toUnwrapped());const eo=Ki=>{at!=null&&(at.value=It*R),wi.draw(m,Q.TRIANGLES,rn,Ki,ye,li.disabled,Gi,u.id,Rn.layoutVertexBuffer,Rn.indexBuffer,Rn.segments,u.paint,m.transform.zoom,Yi,[Rn.layoutVertexBuffer2,Rn.patternVertexBuffer,Rn.zOffsetVertexBuffer]),at!=null&&(at.value=It)};if(Nt&&!Dn){const Ki=m.stencilModeForClipping(Yn).ref;Ki===0&&we&&W.clear({stencil:0});const jr={func:Q.EQUAL,mask:255};Gi.u_alpha_discard_threshold=.8,eo(new di(jr,Ki,255,Q.KEEP,Q.KEEP,Q.INVERT)),Gi.u_alpha_discard_threshold=0,eo(new di(jr,Ki,255,Q.KEEP,Q.KEEP,Q.KEEP))}else Gi.u_alpha_discard_threshold=Nt&&Dn&&On?.8:0,eo(Dn?Bn:m.stencilModeForClipping(Yn))}};let wt=m.depthModeForSublayer(0,Tn.ReadOnly);const Ht=new Tn(m.depthOcclusion?Q.GREATER:Q.LEQUAL,Tn.ReadOnly,m.depthRangeFor3D);if(u.hasNonElevatedBuckets){const pn=!we&&m.terrain;R!==0&&pn?o.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):pn?o.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):jt(g,Et,wt,di.disabled,!1,!0)}if(u.hasElevatedBuckets){N==="hd-road-markup"?X||(wt=Ht,Et.push("ELEVATED_ROADS")):(Et.push("ELEVATED"),wt=Ht,se&&Et.push(pe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),G&&Et.push("ELEVATION_REFERENCE_SEA"));const pn=Nt?m.stencilModeFor3D():di.disabled;m.forceTerrainMode=!0,jt(g,Et,wt,pn,!0,!0),Nt&&jt(g,Et,wt,pn,!0,!1),m.forceTerrainMode=!1}Nt&&(m.resetStencilClippingMasks(),we&&W.clear({stencil:0})),R===0||m.depthOcclusion||we||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,r,u,g){const w=u.paint.get("fill-color"),S=u.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const P=u.paint.get("fill-emissive-strength"),R=m.colorModeForDrapableLayerRenderPass(P),N=u.paint.get("fill-pattern"),V=m.opaquePassEnabledForLayer()&&!N.constantOr(1)&&w.constantOr(o.am.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";let G="none";u.layout.get("fill-elevation-reference")!=="none"?G="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(G="offset");const X=!(!m.terrain||!m.terrain.enabled),W={painter:m,sourceCache:r,layer:u,coords:g,colorMode:R,elevationType:G,terrainEnabled:X,pass:V};if(m.renderPass!=="shadow")if(G!=="offset"){if(Ep(W,!1),G==="road"){const Q=!X&&m.renderPass==="translucent";Q&&La(m,r,u,g,"geometry"),Ep(W,!0,di.disabled),Q&&function(fe){const{painter:se,sourceCache:pe,layer:ye,coords:we,colorMode:De}=fe,Le=se.context.gl,Ze=fe.painter.shadowRenderer,Ue=!!Ze&&Ze.enabled,Fe=new Tn(se.context.gl.LEQUAL,Tn.ReadOnly,se.depthRangeFor3D);let ke=[0,0,0];if(Ue){const Ke=se.style.directionalLight,pt=se.style.ambientLight;Ke&&pt&&(ke=Uc(se.style,Ke,pt))}const qe=Ke=>{for(const pt of we){const mt=pe.getTile(pt),It=mt.getBucket(ye);if(!It)continue;const Nt=It.elevatedStructures;if(!Nt)continue;let Xt,ut;if(Ke?(Xt=Nt.renderableBridgeSegments,ut=Nt.bridgeProgramConfigurations.get(ye.id)):(Xt=Nt.renderableTunnelSegments,ut=Nt.tunnelProgramConfigurations.get(ye.id)),!Xt||Xt.segments[0].primitiveLength===0)continue;ut.updatePaintBuffers(),se.prepareDrawTile();const Et=se.isTileAffectedByFog(pt),at=[];Ue&&at.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const jt=se.getOrCreateProgram("elevatedStructures",{config:ut,overrideFog:Et,defines:at}),wt=se.translatePosMatrix(pt.projMatrix,mt,ye.paint.get("fill-translate"),ye.paint.get("fill-translate-anchor"));Ue&&Ze.setupShadows(mt.tileID.toUnwrapped(),jt,"vector-tile",mt.tileID.overscaledZ);const Ht=Tm(wt,ke);se.uploadCommonUniforms(se.context,jt,pt.toUnwrapped()),jt.draw(se,Le.TRIANGLES,Fe,di.disabled,De,li.backCCW,Ht,ye.id,Nt.vertexBuffer,Nt.indexBuffer,Xt,ye.paint,se.transform.zoom,ut,[Nt.vertexBufferNormal])}};qe(!0),qe(!1)}(W)}}else Ep(W,!1,m.stencilModeFor3D());else m.shadowRenderer&&G==="road"&&!X&&function(Q){const{painter:fe,sourceCache:se,layer:pe,coords:ye}=Q,we=fe.context.gl,De=Q.painter.shadowRenderer;for(const Le of ye){const Ze=se.getTile(Le),Ue=Ze.getBucket(pe);if(!Ue)continue;const Fe=Ue.elevatedStructures;if(!Fe||!Fe.shadowCasterSegments||Fe.shadowCasterSegments.segments[0].primitiveLength===0)continue;fe.prepareDrawTile();const ke=Ue.bufferData.programConfigurations.get(pe.id),qe=fe.isTileAffectedByFog(Le),Ke=fe.getOrCreateProgram("elevatedStructuresDepth",{config:ke,overrideFog:qe}),pt=De.calculateShadowPassMatrixFromTile(Ze.tileID.toUnwrapped());fe.uploadCommonUniforms(fe.context,Ke,Le.toUnwrapped());const mt={u_matrix:pt,u_depth_bias:.001};Ke.draw(fe,we.TRIANGLES,De.getShadowPassDepthMode(),di.disabled,De.getShadowPassColorMode(),li.disabled,mt,pe.id,Fe.vertexBuffer,Fe.indexBuffer,Fe.shadowCasterSegments,pe.paint,fe.transform.zoom,ke)}}(W)},"fill-extrusion":function(m,r,u,g){const w=u.paint.get("fill-extrusion-opacity"),S=m.context,P=S.gl,R=m.terrain,N=R&&R.renderingToTexture;if(w===0)return;const V=m.conflationActive&&m.style.isLayerClipped(u,r.getSource()),G=m.style.order.indexOf(u.fqid);if(V&&function(X,W,Q,fe,se){for(const pe of fe){const ye=W.getTile(pe).getBucket(Q);ye&&(ye.updateReplacement(pe,X.replacementSource,se),ye.uploadCentroid(X.context))}}(m,r,u,g,G),R||V)for(const X of g){const W=r.getTile(X).getBucket(u);W&&Nn(m.context,r,X,W,u,R,V)}if(m.renderPass==="shadow"&&m.shadowRenderer){const X=m.shadowRenderer;if(R&&w<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.ab)return;const W=X.getShadowPassDepthMode(),Q=X.getShadowPassColorMode();Kc(m,r,u,g,W,di.disabled,Q,V)}else if(m.renderPass==="translucent"){const X=!u.paint.get("fill-extrusion-pattern").constantOr(1),W=u.paint.get("fill-extrusion-color").constantOr(o.am.white);if(!N&&W.a!==0){const Q=new Tn(m.context.gl.LEQUAL,Tn.ReadWrite,m.depthRangeFor3D);w===1&&X?Kc(m,r,u,g,Q,di.disabled,Ri.unblended,V):(Kc(m,r,u,g,Q,di.disabled,Ri.disabled,V),Kc(m,r,u,g,Q,m.stencilModeFor3D(),m.colorModeForRenderPass(),V),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&X&&(!R&&m.transform.projection.name!=="globe"||N)){const Q=u.paint.get("fill-extrusion-opacity"),fe=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),se=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),pe=u.paint.get("fill-extrusion-flood-light-intensity"),ye=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",we=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(ye?null:u.lut).toArray01().slice(0,3),De=fe>0&&se>0,Le=pe>0,Ze=(Fe,ke,qe)=>(1-qe)*Fe+qe*ke,Ue=Fe=>{const ke=m.depthModeForSublayer(1,Tn.ReadOnly,P.LEQUAL,!0),qe=u.paint.get(Fe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ke=Ze(.1,3,qe),pt=m._showOverdrawInspector;if(!pt){const mt=new di({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),It=new Ri([P.ONE,P.ONE,P.ONE,P.ONE],o.am.transparent,[!1,!1,!1,!0],P.MIN);wu(m,r,u,g,ke,mt,It,li.disabled,Fe,"sdf",Q,fe,se,pe,we,Ke,V,!1)}{const mt=pt?di.disabled:new di({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),It=pt?m.colorModeForRenderPass():new Ri([P.ONE_MINUS_DST_ALPHA,P.DST_ALPHA,P.ONE,P.ONE],o.am.transparent,[!0,!0,!0,!0]);wu(m,r,u,g,ke,mt,It,li.disabled,Fe,"color",Q,fe,se,pe,we,Ke,V,!1)}};if(N){const Fe=(ke,qe,Ke)=>{const pt=m.depthModeForSublayer(1,Tn.ReadOnly,P.LEQUAL,!1),mt=u.paint.get(ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),It=Ze(.1,3,mt);{const Nt=new Ri([P.ONE,P.ONE,P.ONE,P.ONE],o.am.transparent,[!1,!1,!1,!0]);wu(m,r,u,g,pt,di.disabled,Nt,li.disabled,ke,"clear",Q,fe,se,pe,we,It,V,qe)}{const Nt=new di({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),Xt=new Ri([P.ONE,P.ONE,P.ONE,P.ONE],o.am.transparent,[!1,!1,!1,!0],P.MIN);wu(m,r,u,g,pt,Nt,Xt,li.disabled,ke,"sdf",Q,fe,se,pe,we,It,V,qe)}{const Nt=ke?P.ZERO:P.ONE_MINUS_DST_ALPHA,Xt=new di({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),ut=new Ri([Nt,P.DST_ALPHA,P.ONE_MINUS_DST_ALPHA,P.ZERO],o.am.transparent,[!0,!0,!0,!0]);wu(m,r,u,g,pt,Xt,ut,li.disabled,ke,"color",Q,fe,se,pe,we,It,V,qe)}{const Nt=new Ri([P.ONE,P.ONE,P.ONE,ke?P.ZERO:P.ONE],o.am.transparent,[!1,!1,!1,!0],ke?P.FUNC_ADD:P.MAX);wu(m,r,u,g,pt,di.disabled,Nt,li.disabled,ke,"clear",Q,fe,se,pe,we,It,V,qe,Ke)}};if(De||Le){let ke;if(m.prepareDrawTile(),R){const qe=R.drapeBufferSize[0],Ke=R.drapeBufferSize[1];ke=R.framebufferCopyTexture,ke&&(!ke||ke.size[0]===qe&&ke.size[1]===Ke)||(ke&&ke.destroy(),ke=R.framebufferCopyTexture=new o.T(S,new o.r({width:qe,height:Ke}),P.RGBA8)),ke.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.copyTexSubImage2D(P.TEXTURE_2D,0,0,0,0,0,qe,Ke)}De&&Fe(!0,!1,ke),Le&&Fe(!1,!0,ke)}}else De&&Ue(!0),Le&&Ue(!1),(De||Le)&&m.resetStencilClippingMasks()}}},building:function(m,r,u,g){},hillshade:function(m,r,u,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;const w=m.context,S=m.terrain&&m.terrain.renderingToTexture,[P,R]=m.renderPass!=="translucent"||S?[{},g]:m.stencilConfigForOverlap(g);for(const N of R){const V=r.getTile(N);if(V.needsHillshadePrepare&&m.renderPass==="offscreen")hc(m,V,u);else if(m.renderPass==="translucent"){const G=m.depthModeForSublayer(0,Tn.ReadOnly),X=u.paint.get("hillshade-emissive-strength"),W=m.colorModeForDrapableLayerRenderPass(X),Q=S&&m.terrain?m.terrain.stencilModeForRTTOverlap(N):P[N.overscaledZ];El(m,N,V,u,G,Q,W)}}w.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,r,u,g,w,S){if(m.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const P=m.transform.projection.name==="globe",R=u.paint.get("raster-elevation")!==0,N=R&&P;if(m.renderElevatedRasterBackface&&!N)return;const V=m.context,G=V.gl,X=r.getSource(),W=function(Ue,Fe,ke,qe){const Ke=Fe.paint.get("raster-color"),pt=Ue.type==="raster-array",mt=[],It=Fe.paint.get("raster-resampling"),Nt=Fe.paint.get("raster-color-mix");let Xt=Fe.paint.get("raster-color-range");const ut=[Nt[0],Nt[1],Nt[2],0],Et=Nt[3];let at=It==="nearest"?qe.NEAREST:qe.LINEAR;if(pt&&(mt.push("RASTER_ARRAY"),Ke||mt.push("RASTER_COLOR"),It==="linear"&&mt.push("RASTER_ARRAY_LINEAR"),at=qe.NEAREST,!Xt&&Ue.rasterLayers)){const jt=Ue.rasterLayers.find(({id:wt})=>wt===Fe.sourceLayer);jt&&jt.fields&&jt.fields.range&&(Xt=jt.fields.range)}if(Xt=Xt||[0,1],Ke){mt.push("RASTER_COLOR"),ke.activeTexture.set(qe.TEXTURE2),Fe.updateColorRamp(Xt);let jt=Fe.colorRampTexture;jt||(jt=Fe.colorRampTexture=new o.T(ke,Fe.colorRamp,qe.RGBA8)),jt.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)}return{mix:ut,range:Xt,offset:Et,defines:mt,resampling:at}}(X,u,V,G);if(X instanceof o.aP&&!g.length&&!P)return;const Q=u.paint.get("raster-emissive-strength"),fe=m.colorModeForDrapableLayerRenderPass(Q),se=m.terrain&&m.terrain.renderingToTexture,pe=!m.options.moving,ye=u.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;if(X instanceof o.aP&&!g.length&&(X.onNorthPole||X.onSouthPole)){const Ue=R?m.stencilModeFor3D():di.disabled;return void wa(!!X.onNorthPole,null,m,r,u,Q,W,li.disabled,Ue)}if(!g.length)return;const[we,De]=X instanceof o.aP||se?[{},g]:m.stencilConfigForOverlap(g),Le=De[De.length-1].overscaledZ;N&&W.defines.push("PROJECTION_GLOBE_VIEW"),R&&W.defines.push("RENDER_CUTOFF");const Ze=(Ue,Fe,ke)=>{for(const qe of Ue){const Ke=qe.toUnwrapped(),pt=r.getTile(qe);if(se&&(!pt||!pt.hasData()))continue;V.activeTexture.set(G.TEXTURE0);const mt=Ap(pt,X,u,W);if(!mt||!mt.texture)continue;const{texture:It,mix:Nt,offset:Xt,tileSize:ut,buffer:Et}=mt;let at,jt;se?(at=Tn.disabled,jt=qe.projMatrix):R?(at=new Tn(G.LEQUAL,Tn.ReadWrite,m.depthRangeFor3D),jt=P?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(Ke,pe)):(at=m.depthModeForSublayer(qe.overscaledZ-Le,u.paint.get("raster-opacity")===1?Tn.ReadWrite:Tn.ReadOnly,G.LESS),jt=m.transform.calculateProjMatrix(Ke,pe));const wt=m.terrain&&se?m.terrain.stencilModeForRTTOverlap(qe):we[qe.overscaledZ],Ht=S?0:u.paint.get("raster-fade-duration");pt.registerFadeDuration(Ht);const pn=r.findLoadedParent(qe,0),Ft=zd(pt,pn,r,m.transform,Ht);let rn,Bn;m.terrain&&m.terrain.prepareDrawTile(),V.activeTexture.set(G.TEXTURE0),It.bind(ye,G.CLAMP_TO_EDGE),V.activeTexture.set(G.TEXTURE1),pn?(pn.texture&&pn.texture.bind(ye,G.CLAMP_TO_EDGE),rn=Math.pow(2,pn.tileID.overscaledZ-pt.tileID.overscaledZ),Bn=[pt.tileID.canonical.x*rn%1,pt.tileID.canonical.y*rn%1]):It.bind(ye,G.CLAMP_TO_EDGE),"useMipmap"in It&&V.extTextureFilterAnisotropic&&m.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const Dn=m.transform;let On;const Yn=R?Hg(Dn):[0,0,0,0];let ni,Rn,Kn,ei,_i,Pi=0;if(N&&X instanceof o.aP&&X.coordinates.length>3)ni=Float32Array.from(o.bh(o.dr(new o.cp(0,0,0)))),Rn=Float32Array.from(Dn.globeMatrix),Kn=Float32Array.from(o.dm(Dn)),ei=[o.aD(Dn.center.lng),o.aH(Dn.center.lat)],On=X.elevatedGlobePerspectiveTransform,_i=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(N){const wi=o.dn(qe.canonical);Pi=o.dp(wi.getCenter().lat),ni=Float32Array.from(o.bh(o.dr(qe.canonical))),Rn=Float32Array.from(Dn.globeMatrix),Kn=Float32Array.from(o.dm(Dn)),ei=[o.aD(Dn.center.lng),o.aH(Dn.center.lat)],On=[0,0],_i=Float32Array.from(o.dq(qe.canonical,wi,Pi,Dn.worldSize/Dn._pixelsPerMercatorPixel))}else On=X instanceof o.aP?X.perspectiveTransform:[0,0],ni=new Float32Array(16),Rn=new Float32Array(9),Kn=new Float32Array(16),ei=[0,0],_i=new Float32Array(9);const Yi=_u(jt,ni,Rn,Kn,_i,Bn||[0,0],o.ah(m.transform.zoom),ei,Yn,rn||1,Ft,u,On,R?u.paint.get("raster-elevation"):0,2,Nt,Xt,W.range,ut,Et,Q),fr=m.isTileAffectedByFog(qe),ho=m.getOrCreateProgram("raster",{defines:W.defines,overrideFog:fr});if(m.uploadCommonUniforms(V,ho,Ke),X instanceof o.aP){const wi=X.elevatedGlobeVertexBuffer,xi=X.elevatedGlobeIndexBuffer;if(se||!P)X.boundsBuffer&&X.boundsSegments&&ho.draw(m,G.TRIANGLES,at,di.disabled,fe,li.disabled,Yi,u.id,X.boundsBuffer,m.quadTriangleIndexBuffer,X.boundsSegments);else if(wi&&xi){const fi=Dn.zoom<=o.cL?X.elevatedGlobeSegments:X.getSegmentsForLongitude(Dn.center.lng);fi&&ho.draw(m,G.TRIANGLES,at,di.disabled,fe,Fe,Yi,u.id,wi,xi,fi)}}else if(N){at=new Tn(G.LEQUAL,Tn.ReadOnly,m.depthRangeFor3D);const wi=m.globeSharedBuffers;if(wi){const[xi,fi,Pr]=wi.getGridBuffers(Pi,!1);ho.draw(m,G.TRIANGLES,at,ke||wt,m.colorModeForRenderPass(),Fe,Yi,u.id,xi,fi,Pr)}}else{const{tileBoundsBuffer:wi,tileBoundsIndexBuffer:xi,tileBoundsSegments:fi}=m.getTileBoundsBuffers(pt);ho.draw(m,G.TRIANGLES,at,wt,fe,li.disabled,Yi,u.id,wi,xi,fi)}}if(!(X instanceof o.aP)&&N)for(const qe of Ue){const Ke=qe.canonical.y===(1<<qe.canonical.z)-1;qe.canonical.y===0&&wa(!0,qe,m,r,u,Q,W,Fe,ke||di.disabled),Ke&&wa(!1,qe,m,r,u,Q,W,Fe===li.frontCW?li.backCW:li.frontCW,ke||di.disabled)}};N?Ze(De,m.renderElevatedRasterBackface?li.backCW:li.frontCW,m.stencilModeFor3D()):Ze(De,li.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,r,u,g,w,S){m.renderPass==="offscreen"&&function(P,R,N,V){if(!V.length)return;const G=P.context,X=G.gl,W=R.getSource();if(!(W instanceof Lo))return;const Q=Math.ceil(Math.sqrt(N.paint.get("raster-particle-count")));let fe=N.particlePositionRGBAImage;if(!fe||fe.width!==Q){const De=function(Le){const Ze=Le*Le,Ue=new Uint8Array(4*Ze),Fe=function(qe){return qe|=0,qe=Math.imul(2747636419^qe,2654435769),qe=Math.imul(qe^qe>>>16,2654435769),((qe=Math.imul(qe^qe>>>16,2654435769))>>>0)/4294967296},ke=1/1.1;for(let qe=0;qe<Ze;qe++){const Ke=ke*(Fe(2*qe+0)+yu),pt=ke*(Fe(2*qe+1)+yu),mt=255*Ke%1,It=255*pt%1,Nt=mt,Xt=pt-It/255,ut=It;Ue[4*qe+0]=255*(Ke-mt/255),Ue[4*qe+1]=255*Nt,Ue[4*qe+2]=255*Xt,Ue[4*qe+3]=255*ut}return Ue}(Q);fe=N.particlePositionRGBAImage=new o.r({width:Q,height:Q},De)}let se=N.particleFramebuffer;se?se.width!==Q&&(se.destroy(),se=N.particleFramebuffer=G.createFramebuffer(Q,Q,!0,null)):se=N.particleFramebuffer=G.createFramebuffer(Q,Q,!0,null);const pe=[];for(const De of V){const Le=R.getTile(De);if(!(Le instanceof us))continue;const Ze=oh(Le,W,N);if(!Ze)continue;const Ue=[Le.tileSize,Le.tileSize];let Fe=N.tileFramebuffer;Fe||(Fe=N.tileFramebuffer=G.createFramebuffer(Ue[0],Ue[1],!0,null));let ke=Le.rasterParticleState;ke||(ke=Le.rasterParticleState=new Mm(G,De,Ue,fe));const qe=ke.update(N.lastInvalidatedAt);ke.particleTextureDimension!==Q&&ke.updateParticleTexture(De,fe);const Ke=ke.targetColorTexture;ke.targetColorTexture=ke.backgroundColorTexture,ke.backgroundColorTexture=Ke;const pt=ke.particleTexture0;ke.particleTexture0=ke.particleTexture1,ke.particleTexture1=pt,pe.push([De,Ze,ke,qe])}if(pe.length===0)return;const ye=o.q.now(),we=N.previousDrawTimestamp?.001*(ye-N.previousDrawTimestamp):.0167;if(N.previousDrawTimestamp=ye,N.hasColorMap()){G.activeTexture.set(X.TEXTURE0+2);let De=N.colorRampTexture;De||(De=N.colorRampTexture=new o.T(G,N.colorRamp,X.RGBA8)),De.bind(X.LINEAR,X.CLAMP_TO_EDGE)}G.bindFramebuffer.set(N.tileFramebuffer.framebuffer),function(De,Le,Ze){const Ue=De.context,Fe=Ue.gl,ke=Le.tileFramebuffer;Ue.activeTexture.set(Fe.TEXTURE0);const qe={u_texture:0,u_opacity:1.05*(pt=Le.paint.get("raster-particle-fade-opacity-factor"))/(pt+.05)},Ke=De.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var pt;for(const mt of Ze){const[,,It,Nt]=mt;ke.colorAttachment.set(It.targetColorTexture.texture),Ue.viewport.set([0,0,ke.width,ke.height]),Ue.clear({color:o.am.transparent}),Nt&&(It.backgroundColorTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE),Ke.draw(De,Fe.TRIANGLES,Tn.disabled,di.disabled,Ri.alphaBlended,li.disabled,qe,Le.id,De.viewportBuffer,De.quadTriangleIndexBuffer,De.viewportSegments))}}(P,N,pe),function(De,Le,Ze,Ue){const Fe=De.context,ke=Fe.gl,qe=Ze.tileFramebuffer,Ke=De.transform.projection.name==="globe",pt=Ze.paint.get("raster-particle-max-speed");for(const mt of Ue){const[It,Nt,Xt]=mt;Fe.activeTexture.set(ke.TEXTURE0+0),Nt.texture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),qe.colorAttachment.set(Xt.targetColorTexture.texture);const ut=De.getOrCreateProgram("rasterParticleDraw",{defines:Nt.defines,overrideFog:!1});Fe.activeTexture.set(ke.TEXTURE0+1);const Et=Nt.scalarData?[]:[0,1,2,3].map(wt=>o.dT[wt](It));Et.push(It);const at=It.canonical.x,jt=It.canonical.y;for(const wt of Et){const Ht=Le.getTile(Ke?wt.wrapped():wt);if(!Ht)continue;const pn=Ht.rasterParticleState;if(!pn)continue;const Ft=wt.canonical.x+(1<<wt.canonical.z)*(wt.wrap-It.wrap),rn=wt.canonical.y;pn.particleTexture0.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);const Bn=rh(1,pn.particleTexture0.size[0],[Ft-at,rn-jt],0,Nt.texture.size,2,pt,Nt.textureOffset,Nt.scale,Nt.offset);ut.draw(De,ke.POINTS,Tn.disabled,di.disabled,Ri.alphaBlended,li.disabled,Bn,Ze.id,pn.particleIndexBuffer,void 0,pn.particleSegment)}}}(P,R,N,pe),G.bindFramebuffer.set(N.particleFramebuffer.framebuffer),function(De,Le,Ze,Ue){const Fe=De.context,ke=Fe.gl,qe=Le.paint.get("raster-particle-max-speed"),Ke=Ue*Le.paint.get("raster-particle-speed-factor")*.15,pt=function(It){return Math.pow(It,6)}(.01+1*Le.paint.get("raster-particle-reset-rate-factor")),mt=Le.particleFramebuffer;Fe.viewport.set([0,0,mt.width,mt.height]);for(const It of Ze){const[,Nt,Xt]=It;Fe.activeTexture.set(ke.TEXTURE0+0),Nt.texture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),Fe.activeTexture.set(ke.TEXTURE0+1);const ut=Xt.particleTexture0;ut.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);const Et=mc(1,ut.size[0],0,Nt.texture.size,qe,Ke,pt,Nt.textureOffset,Nt.scale,Nt.offset);mt.colorAttachment.set(Xt.particleTexture1.texture),Fe.clear({color:o.am.transparent}),De.getOrCreateProgram("rasterParticleUpdate",{defines:Nt.defines}).draw(De,ke.TRIANGLES,Tn.disabled,di.disabled,Ri.unblended,li.disabled,Et,Le.id,De.viewportBuffer,De.quadTriangleIndexBuffer,De.viewportSegments)}}(P,N,pe,we)}(m,r,u,g),m.renderPass==="translucent"&&(function(P,R,N,V,G){const X=P.context,W=X.gl,Q=R.getSource().tileSize,fe=5*(1-o.af(o.cx,o.cx+1,P.transform.zoom))*Q+N.paint.get("raster-particle-elevation"),se=!P.options.moving,pe=P.transform.projection.name==="globe";if(!V.length)return;const[ye,we]=P.stencilConfigForOverlap(V),De=[];pe&&De.push("PROJECTION_GLOBE_VIEW");const Le=P.stencilModeFor3D();for(const Ze of we){const Ue=Ze.toUnwrapped(),Fe=R.getTile(Ze);if(!Fe.rasterParticleState)continue;const ke=Fe.rasterParticleState,qe=100;Fe.registerFadeDuration(qe);const Ke=R.findLoadedParent(Ze,0),pt=zd(Fe,Ke,R,P.transform,qe);let mt,It;P.terrain&&P.terrain.prepareDrawTile(),X.activeTexture.set(W.TEXTURE0),ke.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),X.activeTexture.set(W.TEXTURE1),Ke&&Ke.rasterParticleState?(Ke.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),mt=Math.pow(2,Ke.tileID.overscaledZ-Fe.tileID.overscaledZ),It=[Fe.tileID.canonical.x*mt%1,Fe.tileID.canonical.y*mt%1]):ke.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const Nt=pe?Float32Array.from(P.transform.expandedFarZProjMatrix):P.transform.calculateProjMatrix(Ue,se),Xt=P.transform,ut=Pp(Xt),Et=o.dn(Ze.canonical),at=o.dp(Et.getCenter().lat);let jt,wt,Ht,pn,Ft;pe?(jt=Float32Array.from(o.bh(o.dr(Ze.canonical))),wt=Float32Array.from(Xt.globeMatrix),Ht=Float32Array.from(o.dm(Xt)),pn=[o.aD(Xt.center.lng),o.aH(Xt.center.lat)],Ft=Float32Array.from(o.dq(Ze.canonical,Et,at,Xt.worldSize/Xt._pixelsPerMercatorPixel))):(jt=new Float32Array(16),wt=new Float32Array(9),Ht=new Float32Array(16),pn=[0,0],Ft=new Float32Array(9));const rn=Bl(Nt,jt,wt,Ht,Ft,It||[0,0],o.ah(P.transform.zoom),pn,ut,mt||1,pt,fe),Bn=P.isTileAffectedByFog(Ze),Dn=P.getOrCreateProgram("rasterParticle",{defines:De,overrideFog:Bn});if(P.uploadCommonUniforms(X,Dn,Ue),pe){const On=new Tn(W.LEQUAL,Tn.ReadOnly,P.depthRangeFor3D),Yn=0,ni=P.globeSharedBuffers;if(ni){const[Rn,Kn,ei]=ni.getGridBuffers(at,Yn!==0);Dn.draw(P,W.TRIANGLES,On,Le,Ri.alphaBlended,P.renderElevatedRasterBackface?li.frontCCW:li.backCCW,rn,N.id,Rn,Kn,ei)}}else{const On=P.depthModeForSublayer(0,Tn.ReadOnly),Yn=ye[Ze.overscaledZ],{tileBoundsBuffer:ni,tileBoundsIndexBuffer:Rn,tileBoundsSegments:Kn}=P.getTileBoundsBuffers(Fe);Dn.draw(P,W.TRIANGLES,On,Yn,Ri.alphaBlended,li.disabled,rn,N.id,ni,Rn,Kn)}}P.resetStencilClippingMasks()}(m,r,u,g),m.style.map.triggerRepaint())},background:function(m,r,u,g){const w=u.paint.get("background-color"),S=u.paint.get("background-color-use-theme").constantOr("default")==="none",P=u.paint.get("background-opacity"),R=u.paint.get("background-emissive-strength"),N=u.paint.get("background-pitch-alignment")==="viewport";if(P===0)return;const V=m.context,G=V.gl,X=m.transform,W=X.tileSize,Q=u.paint.get("background-pattern");let fe;if(Q!==void 0&&(Q===null||(fe=m.imageManager.getPattern(o.I.from(Q.toString()),u.scope,m.style.getLut(u.scope)),!fe)))return;const se=!Q&&w.a===1&&P===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==se)return;const pe=di.disabled,ye=m.depthModeForSublayer(0,se==="opaque"?Tn.ReadWrite:Tn.ReadOnly),we=m.colorModeForDrapableLayerRenderPass(R),De=Q?"backgroundPattern":"background";let Le,Ze=g;if(Ze||(Le=m.getBackgroundTiles(),Ze=Object.values(Le).map(Ue=>Ue.tileID)),Q&&(V.activeTexture.set(G.TEXTURE0),m.imageManager.bind(m.context,u.scope)),N){const Ue=m.getOrCreateProgram(De,{overrideFog:!1,overrideRtt:!0}),Fe=new Float32Array(o.bx([])),ke=new o.aM(0,0,0,0,0),qe=Q?Fd(Fe,R,P,m,0,u.scope,fe,N,{tileID:ke,tileSize:W}):jd(Fe,R,P,w.toPremultipliedRenderColor(S?null:u.lut));Ue.draw(m,G.TRIANGLES,ye,pe,we,li.disabled,qe,u.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(const Ue of Ze){const Fe=m.isTileAffectedByFog(Ue),ke=m.getOrCreateProgram(De,{overrideFog:Fe}),qe=Ue.toUnwrapped(),Ke=g?Ue.projMatrix:m.transform.calculateProjMatrix(qe);m.prepareDrawTile();const pt=r?r.getTile(Ue):Le?Le[Ue.key]:new cs(Ue,W,X.zoom,m),mt=Q?Fd(Ke,R,P,m,0,u.scope,fe,N,{tileID:Ue,tileSize:W}):jd(Ke,R,P,w.toPremultipliedRenderColor(S?null:u.lut));m.uploadCommonUniforms(V,ke,qe);const{tileBoundsBuffer:It,tileBoundsIndexBuffer:Nt,tileBoundsSegments:Xt}=m.getTileBoundsBuffers(pt);ke.draw(m,G.TRIANGLES,ye,pe,we,li.disabled,mt,u.id,It,Nt,Xt)}},sky:function(m,r,u){const g=m._atmosphere?o.ah(m.transform.zoom):1,w=u.paint.get("sky-opacity")*g;if(w===0)return;const S=m.context,P=u.paint.get("sky-type"),R=new Tn(S.gl.LEQUAL,Tn.ReadOnly,[0,1]),N=m.frameCounter/1e3%1;P==="atmosphere"?m.renderPass==="offscreen"?u.needsSkyboxCapture(m)&&(function(V,G,X,W){const Q=V.context,fe=Q.gl;let se=G.skyboxFbo;if(!se){se=G.skyboxFbo=Q.createFramebuffer(32,32,!0,null),G.skyboxGeometry=new Df(Q),G.skyboxTexture=Q.gl.createTexture(),fe.bindTexture(fe.TEXTURE_CUBE_MAP,G.skyboxTexture),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MAG_FILTER,fe.LINEAR);for(let De=0;De<6;++De)fe.texImage2D(fe.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,fe.RGBA,32,32,0,fe.RGBA,fe.UNSIGNED_BYTE,null)}Q.bindFramebuffer.set(se.framebuffer),Q.viewport.set([0,0,32,32]);const pe=G.getCenter(V,!0),ye=V.getOrCreateProgram("skyboxCapture"),we=new Float64Array(16);o.bx(we),o.e3(we,we,.5*-Math.PI),Pu(V,G,ye,we,pe,0),o.bx(we),o.e3(we,we,.5*Math.PI),Pu(V,G,ye,we,pe,1),o.bx(we),o.cG(we,we,.5*-Math.PI),Pu(V,G,ye,we,pe,2),o.bx(we),o.cG(we,we,.5*Math.PI),Pu(V,G,ye,we,pe,3),o.bx(we),Pu(V,G,ye,we,pe,4),o.bx(we),o.e3(we,we,Math.PI),Pu(V,G,ye,we,pe,5),Q.viewport.set([0,0,V.width,V.height])}(m,u),u.markSkyboxValid(m)):m.renderPass==="sky"&&function(V,G,X,W,Q){const fe=V.context,se=fe.gl,pe=V.transform,ye=V.getOrCreateProgram("skybox");fe.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,G.skyboxTexture);const we=((De,Le,Ze,Ue,Fe)=>({u_matrix:De,u_sun_direction:Le,u_cubemap:0,u_opacity:Ue,u_temporal_offset:Fe}))(pe.skyboxMatrix,G.getCenter(V,!1),0,W,Q);V.uploadCommonUniforms(fe,ye),ye.draw(V,se.TRIANGLES,X,di.disabled,V.colorModeForRenderPass(),li.backCW,we,"skybox",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(m,u,R,w,N):P==="gradient"&&m.renderPass==="sky"&&function(V,G,X,W,Q){const fe=V.context,se=fe.gl,pe=V.transform,ye=V.getOrCreateProgram("skyboxGradient");G.skyboxGeometry||(G.skyboxGeometry=new Df(fe)),fe.activeTexture.set(se.TEXTURE0);let we=G.colorRampTexture;we||(we=G.colorRampTexture=new o.T(fe,G.colorRamp,se.RGBA8)),we.bind(se.LINEAR,se.CLAMP_TO_EDGE);const De=((Le,Ze,Ue,Fe,ke)=>({u_matrix:Le,u_color_ramp:0,u_center_direction:Ze,u_radius:o.al(Ue),u_opacity:Fe,u_temporal_offset:ke}))(pe.skyboxMatrix,G.getCenter(V,!1),G.paint.get("sky-gradient-radius"),W,Q);V.uploadCommonUniforms(fe,ye),ye.draw(V,se.TRIANGLES,X,di.disabled,V.colorModeForRenderPass(),li.backCW,De,"skyboxGradient",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(m,u,R,w,N)},custom:function(m,r,u,g){const w=m.context,S=u.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&u.isDraped(r)){if(m.renderPass==="offscreen"){const P=S.prerender;if(P){if(m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const R=m.transform.pointMerc;P.call(S,w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.ah(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else P.call(S,w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const R=S.renderToTile;if(R){const N=g[0].canonical,V={x:N.x+g[0].wrap*(S.wrapTileId?0:1<<N.z),y:N.y,z:N.z};w.setDepthMode(Tn.disabled),w.setStencilMode(di.disabled),w.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),R.call(S,w.gl,V),w.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),w.setStencilMode(di.disabled);const P=S.renderingMode==="3d"?new Tn(m.context.gl.LEQUAL,Tn.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Tn.ReadOnly);if(w.setDepthMode(P),m.transform.projection.name==="globe"){const R=m.transform.pointMerc;S.render(w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.ah(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else S.render(w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState(),w.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,r,u,g){if(m.renderPass==="opaque")return;const w=u.paint.get("model-opacity").constantOr(1);if(w===0)return;const S=u.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!S||m.terrain&&w<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof o.ab))return;const P=m.shadowRenderer,R=u.paint.get("model-receive-shadows");P&&(P.useNormalOffset=!0,R||(P.enabled=!1));const N=()=>{P&&(P.useNormalOffset=!0,R||(P.enabled=!0))},V=r.getSource();if(m.renderPass==="light-beam"&&V.type!=="batched-model")return;if(V.type==="vector"||V.type==="geojson")return function(ye,we,De,Le,Ze){const Ue=ye.transform;if(Ue.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${Ue.projection.name} projection is not yet implemented`);const Fe=Ue.getFreeCameraOptions().position;if(!ye.modelManager)return;const ke=ye.modelManager;De.modelManager=ke;const qe=ye.shadowRenderer;if(!De._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ke=De._unevaluatedLayout._values["model-id"],pt=Object.assign({},De.layout.get("model-id").parameters),mt=ye.style.order.indexOf(De.fqid);for(const It of Le){const Nt=we.getTile(It).getBucket(De);if(!Nt||Nt.projection.name!==Ue.projection.name)continue;const Xt=Nt.getModelUris();Xt&&!Nt.modelsRequested&&(ke.addModelsFromBucket(Xt,Ze),Nt.modelsRequested=!0);const ut=Mp(It,Ue);pt.zoom=ut;const Et=Ke.possiblyEvaluate(pt);if(ft(ye,Nt,It),Pl.shadowUniformsInitialized=!1,Pl.useSingleShadowCascade=!!qe&&qe.getMaxCascadeForTile(It.toUnwrapped())===0,ye.renderPass==="shadow"&&qe){if(ye.currentShadowCascade===1&&Nt.isInsideFirstShadowMapFrustum)continue;const wt=Ue.calculatePosMatrix(It.toUnwrapped(),Ue.worldSize);if(Pl.tileMatrix.set(wt),Pl.shadowTileMatrix=Float32Array.from(qe.calculateShadowPassMatrixFromMatrix(wt)),Pl.aabb.min.fill(0),Pl.aabb.max[0]=Pl.aabb.max[1]=o.aj,Pl.aabb.max[2]=0,Kg(Nt,Pl,ye,De.scope))continue}const at=1<<It.canonical.z,jt=[((Fe.x-It.wrap)*at-It.canonical.x)*o.aj,(Fe.y*at-It.canonical.y)*o.aj,Fe.z*at*o.aj];ye.conflationActive&&Object.keys(Nt.instancesPerModel).length>0&&ye.style.isLayerClipped(De,we.getSource())&&Nt.updateReplacement(It,ye.replacementSource,mt,Ze)&&(Nt.uploaded=!1,Nt.upload(ye.context));for(let wt in Nt.instancesPerModel){const Ht=Nt.instancesPerModel[wt];Ht.features.length>0&&(wt=Et.evaluate(Ht.features[0].feature,{}));const pn=ke.getModel(wt,Ze);if(pn||ke.hasURLBeenRequested(wt)||Nt.modelUris.includes(wt)||(Nt.modelUris.push(wt),Nt.modelsRequested=!1),pn&&pn.uploaded)for(const Ft of pn.nodes)Op(ye,De,Ft,Ht,jt,It,Pl)}}}(m,r,u,g,V.type==="vector"?u.scope:""),void N();if(!V.loaded())return;if(V.type==="batched-model")return function(ye,we,De,Le){De.resetLayerRenderingStats(ye);const Ze=ye.context,Ue=ye.transform,Fe=ye.style.fog,ke=ye.shadowRenderer;if(Ue.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${Ue.projection.name} projection is not yet implemented`);const qe=ye.transform.getFreeCameraOptions().position,Ke=o.bY([],[qe.x,qe.y,qe.z],ye.transform.worldSize),pt=o.eb([],Ke),mt=o.bx([]),It=o.ec(Ue.center.lat,Ue.zoom),Nt=o.bn([],[1,1,1/It]);o.bo(mt,mt,pt);const Xt=De.paint.get("model-opacity").constantOr(1),ut=new Tn(Ze.gl.LEQUAL,Tn.ReadWrite,ye.depthRangeFor3D),Et=new Tn(Ze.gl.LEQUAL,Tn.ReadOnly,ye.depthRangeFor3D),at=new o.cW([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),jt=ye.renderPass==="shadow",wt=jt&&ke?ke.getCurrentCascadeFrustum():Ue.getFrustum(Ue.scaleZoom(Ue.worldSize)),Ht=De.paint.get("model-front-cutoff"),pn=Ht[2]<1,Ft=ac(ye,De.paint.get("model-cutoff-fade-range")),rn=De.getLayerRenderingStats();(function(Bn,Dn,On,Yn){const ni=Bn.terrain?Bn.terrain.exaggeration():0,Rn=Bn.transform.zoom;for(const Kn of Yn){const ei=Dn.getTile(Kn).getBucket(On);ei&&(ei.setFilter(On.filter),Bn.conflationActive&&ei.updateReplacement(Kn,Bn.replacementSource),ei.evaluateTransform(Bn,On),Bn.terrain&&ni>0&&ei.elevationUpdate(Bn.terrain,ni,Kn,On.source),ei.needsReEvaluation(Bn,Rn,On)&&ei.evaluate(On))}})(ye,we,De,Le),function(){let Bn,Dn,On;pn?(Bn=Le.length-1,Dn=-1,On=-1):(Bn=0,Dn=Le.length,On=1);const Yn=new Float64Array(16),ni=o.ef(),Rn=new o.P(0,0);for(let Kn=Bn;Kn!==Dn;Kn+=On){const ei=Le[Kn],_i=we.getTile(ei).getBucket(De);if(!_i||!_i.uploaded)continue;let Pi=!1;ke&&(Pi=ke.getMaxCascadeForTile(ei.toUnwrapped())===0);const Yi=Ue.calculatePosMatrix(ei.toUnwrapped(),Ue.worldSize),fr=_i.modelTraits;!jt&&pn&&(o.bi(Yn,Yi),o.ad(ni,Ke,Yn),Rn.x=ni[0],Rn.y=ni[1]);const ho=[];_i.setFilter(De.filter);for(const wi of _i.getNodesInfo()){if(wi.hiddenByReplacement||!wi.node.meshes)continue;const xi=wi.node;let fi=0;ye.terrain&&xi.elevation&&(fi=xi.elevation*ye.terrain.exaggeration());const Pr=(()=>{const Gr=wi.aabb;return at.min=[...Gr.min],at.max=[...Gr.max],at.min[2]+=fi,at.max[2]+=fi,o.ad(at.min,at.min,Yi),o.ad(at.max,at.max,Yi),at})(),Io=wi.evaluatedScale;if(Io[0]<=1&&Io[1]<=1&&Io[2]<=1&&Pr.intersects(wt)===0)continue;if(!jt&&pn){const Gr=.16666666666666666;wi.cameraCollisionOpacity=Ke[0]>Pr.min[0]&&Ke[0]<Pr.max[0]&&Ke[1]>Pr.min[1]&&Ke[1]<Pr.max[1]&&Ke[2]*It<Pr.max[2]&&xi.footprint&&o.bS(Rn,xi.footprint)?Math.max(wi.cameraCollisionOpacity-Gr,0):Math.min(1,wi.cameraCollisionOpacity+Gr)}const Br=[...Yi],Gi=1/o.cU(ei.canonical),eo=xi.anchor?xi.anchor[0]:0,Ki=xi.anchor?xi.anchor[1]:0;o.bo(Br,Br,[eo*(Io[0]-1)+wi.evaluatedTranslation[0]*Gi,Ki*(Io[1]-1)+wi.evaluatedTranslation[1]*Gi,fi+wi.evaluatedTranslation[2]]),o.ci(Io,o.eg)||o.cE(Br,Br,Io);const jr=o.az([],Br,xi.matrix),qr=o.az([],Ue.expandedFarZProjMatrix,jr),Lr=o.az([],Ue.expandedFarZProjMatrix,Br),Fr=o.aA([],[eo,Ki,fi,1],qr)[2];xi.hidden=!1;let xr=Xt;jt||(pn&&(xr*=wi.cameraCollisionOpacity,xr*=Hd(Br,Ue,wi.aabb,Ht)),xr*=Jg(Ft,Fr)),xr!==0?ho.push({nodeInfo:wi,depth:Fr,opacity:xr,wvpForNode:qr,wvpForTile:Lr,nodeModelMatrix:jr,tileModelMatrix:Br}):xi.hidden=!0}jt||ho.sort((wi,xi)=>!pn||wi.opacity===1&&xi.opacity===1?wi.depth<xi.depth?-1:1:wi.opacity===1?-1:xi.opacity===1?1:wi.depth>xi.depth?-1:1);for(const wi of ho){const xi=wi.nodeInfo,fi=xi.node;let Pr=o.az([],Nt,wi.tileModelMatrix);o.az(Pr,mt,Pr);const Io=o.bi([],Pr);o.ee(Io,Io),o.cE(Io,Io,Im),Pr=o.az(Pr,Pr,fi.matrix);const Br=ye.renderPass==="light-beam",Gi=De.paint.get("model-color-use-theme").constantOr("default")==="none",eo=fr&o.em.HasMapboxMeshFeatures,Ki=eo?0:xi.evaluatedRMEA[0][2];for(let jr=0;jr<fi.meshes.length;++jr){const qr=fi.meshes[jr],Lr=jr===fi.lightMeshIndex;let Fr=wi.wvpForNode;if(Lr){if(!Br&&!ye.terrain&&ye.shadowRenderer){ye.currentLayer<ye.firstLightBeamLayer&&(ye.firstLightBeamLayer=ye.currentLayer);continue}Fr=wi.wvpForTile}else if(Br)continue;const xr={defines:[]},Gr=[];if(!jt&&ke&&(ke.useNormalOffset=!!qr.normalBuffer),an(xr.defines,Gr,qr,ye,Gi?null:De.lut),eo||xr.defines.push("DIFFUSE_SHADED"),Pi&&xr.defines.push("SHADOWS_SINGLE_CASCADE"),rn&&(jt?rn.numRenderedVerticesInShadowPass+=qr.vertexArray.length:rn.numRenderedVerticesInTransparentPass+=qr.vertexArray.length),jt){bo(qr,wi.nodeModelMatrix,ye,De);continue}let fo=null;if(Fe){const Tc=qd(wi.nodeModelMatrix,ye.transform);if(fo=new Float32Array(Tc),Ue.projection.name!=="globe"){const dl=qr.aabb.min,Ks=qr.aabb.max,[fs,Sc]=Fe.getOpacityForBounds(Tc,dl[0],dl[1],Ks[0],Ks[1]);xr.overrideFog=fs>=ht||Sc>=ht}}const Or=qr.material;let sr;Or.occlusionTexture&&Or.occlusionTexture.offsetScale&&(sr=Or.occlusionTexture.offsetScale,xr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Ps=ye.getOrCreateProgram("model",xr);!jt&&ke&&ke.setupShadowsFromMatrix(wi.tileModelMatrix,Ps,ke.useNormalOffset),ye.uploadCommonUniforms(Ze,Ps,null,fo);const Ys=Or.pbrMetallicRoughness;Ys.metallicFactor=.9,Ys.roughnessFactor=.5;const Ml=Mf(new Float32Array(Fr),new Float32Array(Pr),new Float32Array(Io),new Float32Array(fi.matrix),ye,wi.opacity,Ys.baseColorFactor,Or.emissiveFactor,Ys.metallicFactor,Ys.roughnessFactor,Or,Ki,De,[0,0,0],sr);!Lr&&(xi.hasTranslucentParts||wi.opacity<1)&&Ps.draw(ye,Ze.gl.TRIANGLES,ut,di.disabled,Ri.disabled,li.backCCW,Ml,De.id,qr.vertexBuffer,qr.indexBuffer,qr.segments,De.paint,ye.transform.zoom,void 0,Gr),Ps.draw(ye,Ze.gl.TRIANGLES,Lr?Et:ut,di.disabled,Lr||wi.opacity<1||xi.hasTranslucentParts?Ri.alphaBlended:Ri.unblended,li.backCCW,Ml,De.id,qr.vertexBuffer,qr.indexBuffer,qr.segments,De.paint,ye.transform.zoom,void 0,Gr)}}}}()}(m,r,u,g),void N();if(V.type!=="model")return;const G=V.getModels(),X=[],W=m.transform.getFreeCameraOptions().position,Q=o.bY([],[W.x,W.y,W.z],m.transform.worldSize);o.eb(Q,Q);const fe=[],se=[];let pe=0;for(const ye of G){const we=u.paint.get("model-rotation").constantOr(null),De=u.paint.get("model-scale").constantOr(null),Le=u.paint.get("model-translation").constantOr(null);ye.computeModelMatrix(m,we,De,Le,!0,!0,!1);const Ze=o.bx([]),Ue=o.ec(ye.position.lat,m.transform.zoom),Fe=o.bn([],[1,1,1/Ue]);o.bo(Ze,Ze,Q),X.push({zScaleMatrix:Fe,negCameraPosMatrix:Ze});for(const ke of ye.nodes)Cu(m.transform,ke,ye.matrix,m.transform.expandedFarZProjMatrix,pe,fe,se);pe++}if(fe.sort((ye,we)=>we.depth-ye.depth),m.renderPass!=="shadow"){if(w===1)for(const ye of se)bn(ye,m,u,X[ye.modelIndex],di.disabled,m.colorModeForRenderPass());else{for(const ye of se)bn(ye,m,u,X[ye.modelIndex],di.disabled,Ri.disabled);for(const ye of se)bn(ye,m,u,X[ye.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(const ye of fe)bn(ye,m,u,X[ye.modelIndex],di.disabled,m.colorModeForRenderPass());N()}else{for(const ye of se)bo(ye.mesh,ye.nodeModelMatrix,m,u);for(const ye of fe)bo(ye.mesh,ye.nodeModelMatrix,m,u);N()}}},Rp={line:function(m,r,u){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(r){const g=r.getVisibleCoordinates();for(const w of g){const S=r.getTile(w).getBucket(m);if(S&&(S.elevationType!=="none"?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,r,u){const g=r.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,g.type==="vector"?m.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const w=g.getModels();for(const S of w)S.upload(u.context)},raster:function(m,r,u){const g=r.getSource();if(!(g instanceof Lo&&g.loaded()))return;const w=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!w)return;const S=m.paint.get("raster-array-band")||g.getInitialBand(w);if(S==null)return;const P=r.getIds().map(R=>r.getTileByID(R));for(const R of P)R.updateNeeded(w,S)&&g.prepareTile(R,w,S)},"raster-particle":function(m,r,u){const g=r.getSource();if(!(g instanceof Lo&&g.loaded()))return;const w=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!w)return;const S=m.paint.get("raster-particle-array-band")||g.getInitialBand(w);if(S==null)return;const P=r.getIds().map(R=>r.getTileByID(R));for(const R of P)R.updateNeeded(w,S)&&g.prepareTile(R,w,S)}},_c={fill:La},kf={fill:function(m,r,u,g){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const w=m.context.gl,S=new Tn(w.LEQUAL,Tn.ReadOnly,m.depthRangeFor3D),P=new di({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),R=m.transform.getFreeCameraOptions().position,N=m.getOrCreateProgram("elevatedStructuresDepthReconstruct",{defines:["DEPTH_RECONSTRUCTION"]});for(const V of g){const G=r.getTile(V),X=G.getBucket(u);if(!X)continue;const W=X.elevatedStructures;if(!W||W.maskSegments.segments[0].primitiveLength===0)continue;const Q=Pm(V.toUnwrapped(),R),fe=m.translatePosMatrix(V.projMatrix,G,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),se=Ef(fe,Q,0,0,0);N.draw(m,w.TRIANGLES,S,P,Ri.disabled,li.disabled,se,u.id,W.vertexBuffer,W.indexBuffer,W.maskSegments,u.paint,m.transform.zoom)}}};class Gd{constructor(r,u,g,w,S,P){this.context=new $r(r,u),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const R=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const V of R)this._debugParams.enabledLayers[V]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of R)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new e_(S),this.setup(),this.numSublayers=en.maxUnderzooming+en.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Sl(this),this._wireframeDebugCache=new Ey,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const N=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,N,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=w,this.worldview=P}updateTerrain(r,u){const g=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new nh(this,r));const w=this._terrain;this.transform.elevation=g?w:null,w.update(r,this.transform,u),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(r){const u=r.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,w]=u.getFovAdjustedRange(this.transform._fov);if(g>w)return void(this.transform.fogCullDistSq=null);const S=g+.78*(w-g);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new nh(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,u){if(this.width=r*o.q.devicePixelRatio,this.height=u*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const r=this.context,u=new o.ba;u.emplaceBack(0,0),u.emplaceBack(o.aj,0),u.emplaceBack(0,o.aj),u.emplaceBack(o.aj,o.aj),this.tileExtentBuffer=r.createVertexBuffer(u,o.bc.members),this.tileExtentSegments=o.bd.simpleSegment(0,0,4,2);const g=new o.ba;g.emplaceBack(0,0),g.emplaceBack(o.aj,0),g.emplaceBack(0,o.aj),g.emplaceBack(o.aj,o.aj),this.debugBuffer=r.createVertexBuffer(g,o.bc.members),this.debugSegments=o.bd.simpleSegment(0,0,4,5);const w=new o.ba;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(w,o.bc.members),this.viewportSegments=o.bd.simpleSegment(0,0,4,2);const S=new o.aZ;S.emplaceBack(0,0,0,0),S.emplaceBack(o.aj,0,o.aj,0),S.emplaceBack(0,o.aj,0,o.aj),S.emplaceBack(o.aj,o.aj,o.aj,o.aj),this.mercatorBoundsBuffer=r.createVertexBuffer(S,o.bf.members),this.mercatorBoundsSegments=o.bd.simpleSegment(0,0,4,2);const P=new o.a_;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(P);const R=new o.bb;for(const V of[0,1,3,2,0])R.emplaceBack(V);this.debugIndexBuffer=r.createIndexBuffer(R),this.emptyTexture=new o.T(r,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=o.bz();const N=this.context.gl;this.stencilClearMode=new di({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,Tn.disabled,this.stencilClearMode,Ri.disabled,li.disabled,Ld(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,u,g){if(!u||this.currentStencilSource===u.id||!r.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(const N of g)if(this._tileClippingMaskIDs[N.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=u.id;const w=this.context,S=w.gl;this.nextStencilID+g.length>256&&this.clearStencil(),w.setColorMode(Ri.disabled),w.setDepthMode(Tn.disabled);const P=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of g){const N=u.getTile(R),V=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:G,tileBoundsIndexBuffer:X,tileBoundsSegments:W}=this.getTileBoundsBuffers(N);P.draw(this,S.TRIANGLES,Tn.disabled,new di({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),Ri.disabled,li.disabled,Ld(R.projMatrix),"$clipping",G,X,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new di({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const u=this.context.gl;return new di({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,g=r.sort((P,R)=>R.overscaledZ-P.overscaledZ),w=g[g.length-1].overscaledZ,S=g[0].overscaledZ-w+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const P={};for(let R=0;R<S;R++)P[R+w]=new di({func:u.GEQUAL,mask:255},R+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=S,[P,g]}return[{[w]:di.disabled},g]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Ri([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new o.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ri.unblended:Ri.alphaBlended}colorModeForDrapableLayerRenderPass(r){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Ri([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new o.am(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,u,g,w=!1){if(this.depthOcclusion)return new Tn(this.context.gl.GREATER,Tn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!w)return Tn.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Tn(g||this.context.gl.LEQUAL,u,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,u=Math.ceil(this.width),g=Math.ceil(this.height),w=this.context.bindFramebuffer.get(),S=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&g!==0&&(this.depthFBO=new vu(this.context,u,g,!1,"texture"),this.depthTexture=new o.T(this.context,{width:u,height:g,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(w),r.bindTexture(r.TEXTURE_2D,S),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,u,g,0,0,u,g,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,u)=>r+u/this._fpsHistory.length,0))}render(r,u){const g=o.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=u;const w=this.style._mergedLayers,S=!(!this.terrain||!this.terrain.enabled),P=()=>this.style._getOrder(S).filter(ut=>{const Et=w[ut];return!(Et.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Et.type]});let R=P(),N=!1,V=!1;for(const ut of R){const Et=w[ut];Et.type==="circle"&&(N=!0),Et.type==="symbol"&&(Et.hasInitialOcclusionOpacityProperties?V=!0:N=!0)}let G=R.map(ut=>w[ut]);const X=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let W=0,Q=!1;for(const ut in X){const Et=X[ut];Et.used&&(Et.prepare(this.context),Et.getSource().usedInConflation&&++W)}let fe=!1;for(const ut of G)ut.isHidden(this.transform.zoom)||(ut.type==="clip"&&(fe=!0),this.prepareLayer(ut));const se={},pe={},ye={},we={},De={};for(const ut in X){const Et=X[ut];se[ut]=Et.getVisibleCoordinates(),pe[ut]=se[ut].slice().reverse(),ye[ut]=Et.getVisibleCoordinates(!0).reverse(),we[ut]=Et.getShadowCasterCoordinates(),De[ut]=Et.sortCoordinatesByDistance(se[ut])}const Le=ut=>{const Et=this.style.getLayerSourceCache(ut);return Et&&Et.used?Et.getSource():null};if(W||fe||this._clippingActiveLastFrame){const ut=[],Et=[];let at=0;for(const jt of G)this.isSourceForClippingOrConflation(jt,Le(jt))&&(ut.push(jt),Et.push(at)),at++;if(ut&&(fe||ut.length>1)||this._clippingActiveLastFrame){fe=!1;const jt=[];for(let wt=0;wt<ut.length;wt++){const Ht=ut[wt],pn=Et[wt],Ft=this.style.getLayerSourceCache(Ht);if(!Ft||!Ft.used||!Ft.getSource().usedInConflation&&Ht.type!=="clip")continue;let rn=o.eu,Bn=o.bQ.None;const Dn=[];let On=!0;if(Ht.type==="clip"){rn=pn;for(const Yn of Ht.layout.get("clip-layer-types"))Bn|=Yn==="model"?o.bQ.Model:Yn==="symbol"?o.bQ.Symbol:o.bQ.FillExtrusion;for(const Yn of Ht.layout.get("clip-layer-scope"))Dn.push(Yn);Ht.isHidden(this.transform.zoom)?On=!1:fe=!0}On&&jt.push({layer:Ht.fqid,cache:Ft,order:rn,clipMask:Bn,clipScope:Dn})}this.replacementSource.setSources(jt),Q=!0}}this._clippingActiveLastFrame=fe,Q||this.replacementSource.clear(),this.conflationActive=Q,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ut=0;ut<G.length;ut++){const Et=G[ut],at=Et.cutoffRange();if(this.longestCutoffRange=Math.max(at,this.longestCutoffRange),at>0){const jt=Le(Et);jt&&(this.minCutoffZoom=Math.max(jt.minzoom,this.minCutoffZoom)),Et.minzoom&&(this.minCutoffZoom=Math.max(Et.minzoom,this.minCutoffZoom))}Et.is3D(S)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ut),this._lastOcclusionLayer=ut)}const Ze=this.style&&this.style.fog;Ze?(this._fogVisible=Ze.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ze.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ye),this.opaquePassCutoff=0,R=P(),G=R.map(ut=>w[ut]));const Ue=this._shadowRenderer;if(Ue){Ue.updateShadowParameters(this.transform,this.style.directionalLight);for(const ut in X)for(const Et of se[ut]){let at={min:0,max:0};this.terrain&&(at=this.terrain.getMinMaxForTile(Et)||at),Ue.addShadowReceiver(Et.toUnwrapped(),at.min,at.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.ev(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new $d(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Fe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),ke=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Fe&&!this._snow&&(this._snow=new Qr(this)),!Fe&&this._snow&&(this._snow.destroy(),delete this._snow),ke&&!this._rain&&(this._rain=new i0(this)),!ke&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!ai.has(this.context.gl))return;this.renderPass="offscreen";for(const ut of G){const Et=r.getLayerSourceCache(ut);if(!ut.hasOffscreenPass()||ut.isHidden(this.transform.zoom))continue;const at=Et?pe[Et.id]:void 0;(ut.type==="custom"||ut.type==="raster"||ut.type==="raster-particle"||ut.isSky()||at&&at.length)&&this.renderLayer(this,Et,ut,at)}this.depthRangeFor3D=[0,1-(G.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,we)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const qe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ke=(()=>{if(u.showOverdrawInspector)return o.am.black;const ut=this.style.fog;if(ut&&this.transform.projection.supportsFog){const Et=this.style.getLut(ut.scope);if(!qe){const at=ut.properties.get("color-use-theme")==="none",jt=ut.properties.get("color").toNonPremultipliedRenderColor(at?null:Et).toArray01();return new o.am(...jt)}if(qe){const at=ut.properties.get("space-color-use-theme")==="none",jt=ut.properties.get("space-color").toNonPremultipliedRenderColor(at?null:Et).toArray01();return new o.am(...jt)}}return o.am.transparent})();if(this.context.clear({color:Ke,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&qe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=R.length-1;this.currentLayer>=0;this.currentLayer--){const ut=G[this.currentLayer],Et=r.getLayerSourceCache(ut);if(ut.isSky())continue;const at=Et?(ut.is3D(S)?De:pe)[Et.id]:void 0;this._renderTileClippingMasks(ut,Et,at),this.renderLayer(this,Et,ut,at)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&qe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<R.length;this.currentLayer++){const ut=G[this.currentLayer],Et=r.getLayerSourceCache(ut);ut.isSky()&&this.renderLayer(this,Et,ut,Et?pe[Et.id]:void 0)}function pt(ut,Et){let at;return Et&&(at=(ut.type==="symbol"?ye:ut.is3D(S)?De:pe)[Et.id]),at}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<R.length;){const ut=G[this.currentLayer];if(ut.type==="raster"||ut.type==="raster-particle"){const Et=r.getLayerSourceCache(ut);this.renderLayer(this,Et,ut,pt(ut,Et))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let mt=0;Ue&&(mt=Ue.getShadowCastingLayerCount());let It=!1,Nt=-1;for(let ut=0;ut<R.length;++ut){const Et=G[ut];Et.isHidden(this.transform.zoom)||Et.is3D(S)&&(Nt=ut)}V&&Nt===-1&&(N=!0);let Xt=!1;for(;this.currentLayer<R.length;){const ut=G[this.currentLayer],Et=r.getLayerSourceCache(ut);if(ut.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ut)){if(ut.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Xt&&ut.is3D(S)&&!S){const at=this.currentLayer,jt=wt=>{for(this.currentLayer=0;this.currentLayer<G.length;this.currentLayer++){const Ht=G[this.currentLayer];if(_c[Ht.type]){const pn=this.style.getLayerSourceCache(Ht);_c[Ht.type](this,pn,Ht,pt(Ht,pn),wt)}}};jt("initialize"),jt("reset"),this.currentLayer=at,Xt=!0}if(N&&!It&&this.terrain&&!this.transform.isOrthographic&&(It=!0,this.blitDepth()),V&&Nt!==-1&&this.currentLayer===Nt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(ut,Et,Et?se[Et.id]:void 0),this.renderLayer(this,Et,ut,pt(ut,Et)),!this.terrain&&Ue&&mt>0&&ut.hasShadowPass()&&--mt==0){{this.clearStencil();const at=this.currentLayer;for(this.currentLayer=0;this.currentLayer<G.length;this.currentLayer++){const jt=G[this.currentLayer];if(kf[jt.type]){const wt=this.style.getLayerSourceCache(jt);kf[jt.type](this,wt,jt,pt(jt,wt))}}this.currentLayer=at}if(Ue.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const at=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=at;this.currentLayer++){const jt=G[this.currentLayer];if(!jt.hasLightBeamPass())continue;const wt=r.getLayerSourceCache(jt);this.renderLayer(this,wt,jt,wt?pe[wt.id]:void 0)}this.currentLayer=at,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const at=this.currentLayer;this.depthOcclusion=!0;for(const jt of this.layersWithOcclusionOpacity){this.currentLayer=jt;const wt=G[this.currentLayer],Ht=r.getLayerSourceCache(wt),pn=Ht?pe[Ht.id]:void 0;this.terrain||this._renderTileClippingMasks(wt,Ht,Ht?se[Ht.id]:void 0),this.renderLayer(this,Ht,wt,pn)}this.depthOcclusion=!1,this.currentLayer=at,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ut=null;G.forEach(Et=>{const at=r.getLayerSourceCache(Et);at&&!Et.isHidden(this.transform.zoom)&&at.getVisibleCoordinates().length&&(!ut||ut.getSource().maxzoom<at.getSource().maxzoom)&&(ut=at)}),ut&&this.options.showTileBoundaries&&Eu(this,ut,ut.getVisibleCoordinates(),o.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Eu(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ut){const Et=ut.transform.padding;Cp(ut,ut.transform.height-(Et.top||0),3,Gg),Cp(ut,Et.bottom||0,3,Zg),If(ut,Et.left||0,3,Al),If(ut,ut.transform.width-(Et.right||0),3,Om);const at=ut.transform.centerPoint;(function(jt,wt,Ht,pn){Vd(jt,wt-1,Ht-10,2,20,pn),Vd(jt,wt-10,Ht-1,20,2,pn)})(ut,at.x,ut.transform.height-at.y,Xs)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Q||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:u}=this.transform.projection,g=!u||!u.includes(r.type);if(Rp[r.type]&&(g||this.terrain&&r.type==="custom")){const w=this.style.getLayerSourceCache(r);Rp[r.type](r,w,this)}this.gpuTimingEnd()}renderLayer(r,u,g,w){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||w&&w.length)&&(this.id=g.id,this.gpuTimingStart(g),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(g.type)&&(!r.terrain||g.type!=="custom")||g.type==="clip"||ar[g.type](r,u,g,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,g=this.context.gl;let w=this.gpuTimers[r.id];w||(w=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:g.createQuery()}),w.calls++,g.beginQuery(u.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,u=this.context.gl,g=u.createQuery();this.deferredRenderGpuTimeQueries.push(g),u.beginQuery(r.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const u={};for(const g in r){const w=r[g],S=this.context.extTimerQuery,P=S.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(w.query),u[g]=P}return u}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let g=0;for(const w of r)g+=u.getQueryParameter(w,u.QUERY_RESULT)/1e6,u.deleteQuery(w);return g}translatePosMatrix(r,u,g,w,S){if(!g[0]&&!g[1])return r;const P=S?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(P){const V=Math.sin(P),G=Math.cos(P);g=[g[0]*G-g[1]*V,g[0]*V+g[1]*G]}const R=[S?g[0]:o.aw(u,g[0],this.transform.zoom),S?g[1]:o.aw(u,g[1],this.transform.zoom),0],N=new Float32Array(16);return o.bo(N,r,R),N}saveTileTexture(r){const u=r.size[0],g=this._tileTextures[u];g?g.push(r):this._tileTextures[u]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,u,g){const w=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,S=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||S.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||w||u!==void 0&&!u||S.push("FOG","FOG_DITHERING"),w&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(r,u){this.cache=this.cache||{};const g=u&&u.defines||[],w=u&&u.config,S=this.currentGlobalDefines(r,u&&u.overrideFog,u&&u.overrideRtt).concat(g),P=ih.cacheKey(Gc[r],r,S,w);return this.cache[P]||(this.cache[P]=new ih(this.context,r,Gc[r],w,Tp[r],S)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,u){if(this.style.enable3dLights()){const g=this.style.directionalLight,w=this.style.ambientLight;if(g&&w){const S=((P,R,N)=>{const V=P.properties.get("direction"),G=P.properties.get("color-use-theme")==="none",X=P.properties.get("color").toNonPremultipliedRenderColor(G?null:N.getLut(P.scope)).toArray01(),W=P.properties.get("intensity"),Q=R.properties.get("color-use-theme")==="none",fe=R.properties.get("color").toNonPremultipliedRenderColor(Q?null:N.getLut(R.scope)).toArray01(),se=R.properties.get("intensity"),pe=[V.x,V.y,V.z],ye=o.dw(fe,se),we=o.dw(X,W);return{u_lighting_ambient_color:ye,u_lighting_directional_dir:pe,u_lighting_directional_color:we,u_ground_radiance:Hh(pe,we,ye)}})(g,w,this.style);u.setLightsUniformValues(r,S)}}}uploadCommonUniforms(r,u,g,w,S){if(this.uploadCommonLightUniforms(r,u),this.terrain&&this.terrain.renderingToTexture)return;const P=this.style.fog;if(P){const R=P.getOpacity(this.transform.pitch),N=((V,G,X,W,Q,fe,se,pe,ye,we,De,Le)=>{const Ze=V.transform,Ue=G.properties.get("color-use-theme")==="none",Fe=G.properties.get("color").toNonPremultipliedRenderColor(Ue?null:V.style.getLut(G.scope)).toArray01();Fe[3]=W;const ke=V.frameCounter/1e3%1,[qe,Ke]=G.properties.get("vertical-range");return{u_fog_matrix:X?Ze.calculateFogTileMatrix(X):Le||V.identityMat,u_fog_range:G.getFovAdjustedRange(Ze._fov),u_fog_color:Fe,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(qe,Ke),Ke],u_fog_temporal_offset:ke,u_frustum_tl:Q,u_frustum_tr:fe,u_frustum_br:se,u_frustum_bl:pe,u_globe_pos:ye,u_globe_radius:we,u_viewport:De,u_globe_transition:o.ah(Ze.zoom),u_is_globe:+(Ze.projection.name==="globe")}})(this,P,g,R,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],w);u.setFogUniformValues(r,N)}S&&u.setCutoffUniformValues(r,S.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,u=r.createTexture();return r.bindTexture(r.TEXTURE_2D,u),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const w of g)u[w.key]=r[w.key]||new cs(w,512,this.transform.tileZoom,this,void 0,this.worldview);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,u){return!(!r.is3D(!(!this.terrain||!this.terrain.enabled))||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[r.key];return u||(this._cachedTileFogOpacities[r.key]=u=this.style.fog.getOpacityForTile(r)),u[0]>=ht||u[1]>=ht}setupDepthForOcclusion(r,u,g){const w=this.context,S=w.gl,P=!!g;var R;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),w.activeTexture.set(S.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((R=this.depthRangeFor3D)[1]-R[0]),-1-2*R[0]/(R[1]-R[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),w.activeTexture.set(S.TEXTURE0),P||u.setTerrainUniformValues(w,g)}}function Jc(m,r){let u=!1,g=null;const w=()=>{g=null,u&&(m(),g=setTimeout(w,r),u=!1)};return()=>(u=!0,g||w(),g)}class Lm{constructor(r){this._hashName=r&&encodeURIComponent(r),o.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Jc(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const u=Lp(r);if(this._hashName){const g=this._hashName;let w=!1;const S=location.hash.slice(1).split("&").map(P=>{const R=P.split("=")[0];return R===g?(w=!0,`${R}=${u}`):P}).filter(P=>P);return w||S.push(`${g}=${u}`),`#${S.join("&")}`}return`#${u}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(Number(g)))){const g=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(u[3]||0):r.getBearing();return r.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Lp(m,r){const u=m.getCenter(),g=Math.round(100*m.getZoom())/100,w=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,w),P=Math.round(u.lng*S)/S,R=Math.round(u.lat*S)/S,N=m.getBearing(),V=m.getPitch();let G=r?`/${P}/${R}/${g}`:`${g}/${R}/${P}`;return(N||V)&&(G+="/"+Math.round(10*N)/10),V&&(G+=`/${Math.round(V)}`),G}const Nf={linearity:.3,easing:o.ew(0,0,.3,1)},Kh=o.h({deceleration:2500,maxSpeed:1400},Nf),jl=o.h({deceleration:20,maxSpeed:1400},Nf),Qc=o.h({deceleration:1e3,maxSpeed:360},Nf),sh=o.h({deceleration:1e3,maxSpeed:90},Nf);class Zd{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=o.q.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)u.zoom+=S.zoomDelta||0,u.bearing+=S.bearingDelta||0,u.pitch+=S.pitchDelta||0,S.panDelta&&u.pan._add(S.panDelta),S.around&&(u.around=S.around),S.pinchAround&&(u.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(u.pan.mag()){const S=Xd(u.pan.mag(),g,o.h({},Kh,r||{}));w.offset=u.pan.mult(S.amount/u.pan.mag()),w.center=this._map.transform.center,Wd(w,S)}if(u.zoom){const S=Xd(u.zoom,g,jl);w.zoom=this._map.transform.zoom+S.amount,Wd(w,S)}if(u.bearing){const S=Xd(u.bearing,g,Qc);w.bearing=this._map.transform.bearing+o.ay(S.amount,-179,179),Wd(w,S)}if(u.pitch){const S=Xd(u.pitch,g,sh);w.pitch=this._map.transform.pitch+S.amount,Wd(w,S)}if(w.zoom||w.bearing){const S=u.pinchAround===void 0?u.around:u.pinchAround;w.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Wd(m,r){(!m.duration||m.duration<r.duration)&&(m.duration=r.duration,m.easing=r.easing)}function Xd(m,r,u){const{maxSpeed:g,linearity:w,deceleration:S}=u,P=o.ay(m*w/(r/1e3),-g,g),R=Math.abs(P)/(S*w);return{easing:u.easing,duration:1e3*R,amount:P*(R/2)}}class Ta extends o.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g,w={}){const S=tt(u.getCanvasContainer(),g),P=u.unproject(S);super(r,o.h({point:S,lngLat:P,originalEvent:g},w)),this._defaultPrevented=!1,this.target=u}}class Yd extends o.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g){const w=r==="touchend"?g.changedTouches:g.touches,S=Ge(u.getCanvasContainer(),w),P=S.map(N=>u.unproject(N)),R=S.reduce((N,V,G,X)=>N.add(V.div(X.length)),new o.P(0,0));super(r,{points:S,point:R,lngLats:P,lngLat:u.unproject(R),originalEvent:g}),this._defaultPrevented=!1}}class Es extends o.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class yc{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Es(this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new Ta(r.type,this._map,r))}mouseup(r){this._map.fire(new Ta(r.type,this._map,r))}preclick(r){const u=o.h({},r);u.type="preclick",this._map.fire(new Ta(u.type,this._map,u))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Ta(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Ta(r.type,this._map,r))}mouseover(r){this._map.fire(new Ta(r.type,this._map,r))}mouseout(r){this._map.fire(new Ta(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Yd(r.type,this._map,r))}touchmove(r){this._map.fire(new Yd(r.type,this._map,r))}touchend(r){this._map.fire(new Yd(r.type,this._map,r))}touchcancel(r){this._map.fire(new Yd(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class eu{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Ta(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ta("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Ta(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zm{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(Pe(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const g=u,w=this._startPos,S=this._lastPos;if(!w||!S||S.equals(g)||!this._box&&g.dist(w)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=te("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const P=Math.min(w.x,g.x),R=Math.max(w.x,g.x),N=Math.min(w.y,g.y),V=Math.max(w.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${N}px)`,this._box.style.width=R-P+"px",this._box.style.height=V-N+"px")})}mouseupWindow(r,u){if(!this._active)return;const g=this._startPos,w=u;if(g&&r.button===0){if(this.reset(),Qe(),g.x!==w.x||g.y!==w.y)return this._map.fire(new o.A("boxzoomend",{originalEvent:r})),{cameraAnimation:S=>S.fitScreenCoordinates(g,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Oe(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new o.A(r,{originalEvent:u}))}}function vc(m,r){const u={};for(let g=0;g<m.length;g++)u[m[g].identifier]=r[g];return u}class ra{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),g.length===this.numTouches&&(this.centroid=function(w){const S=new o.P(0,0);for(const P of w)S._add(P);return S.div(w.length)}(u),this.touches=vc(g,u)))}touchmove(r,u,g){if(this.aborted||!this.centroid)return;const w=vc(g,u);for(const S in this.touches){const P=w[S];(!P||P.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(r,u,g){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class za{constructor(r){this.singleTap=new ra(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,u,g){this.singleTap.touchstart(r,u,g)}touchmove(r,u,g){this.singleTap.touchmove(r,u,g)}touchend(r,u,g){const w=this.singleTap.touchend(r,u,g);if(w){const S=r.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(w)<30;if(S&&P||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Bf{constructor(){this._zoomIn=new za({numTouches:1,numTaps:2}),this._zoomOut=new za({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,g){this._zoomIn.touchstart(r,u,g),this._zoomOut.touchstart(r,u,g)}touchmove(r,u,g){this._zoomIn.touchmove(r,u,g),this._zoomOut.touchmove(r,u,g)}touchend(r,u,g){const w=this._zoomIn.touchend(r,u,g),S=this._zoomOut.touchend(r,u,g);return w?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(w)},{originalEvent:r})}):S?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(S)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const zp={0:1,2:2},Mu={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class jf{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,u){return!1}_move(r,u){return{}}mousedown(r,u){if(this._lastPoint)return;const g=Je(r);this._correctButton(r,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(r,u){const g=this._lastPoint;if(g){if(r.preventDefault(),this._eventButton!=null&&function(w,S){const P=zp[S];return w.buttons===void 0||(w.buttons&P)!==P}(r,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(r){this._lastPoint&&Je(r)===this._eventButton&&(this._moved&&Qe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class km extends jf{mousedown(r,u){super.mousedown(r,u),this._lastPoint&&(this._active=!0)}_correctButton(r,u){return u===0&&!r.ctrlKey}_move(r,u){return{around:u,panDelta:u.sub(r)}}}class Ou extends jf{constructor(r){super(r),this._pitchRotateKey=r.pitchRotateKey?Mu[r.pitchRotateKey]:void 0}_correctButton(r,u){return this._pitchRotateKey?u===0&&r[this._pitchRotateKey]:u===0&&r.ctrlKey||u===2}_move(r,u){const g=.8*(u.x-r.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(r){this._pitchRotateKey||r.preventDefault()}}class Iu extends jf{constructor(r){super(r),this._pitchRotateKey=r.pitchRotateKey?Mu[r.pitchRotateKey]:void 0}_correctButton(r,u){return this._pitchRotateKey?u===0&&r[this._pitchRotateKey]:u===0&&r.ctrlKey||u===2}_move(r,u){const g=-.5*(u.y-r.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(r){this._pitchRotateKey||r.preventDefault()}}class Nm{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),o.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(r,u,g){return this._calculateTransform(r,u,g)}touchmove(r,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!o.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,u,g)}}touchend(r,u,g){this._calculateTransform(r,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,g){g.length>0&&(this._active=!0);const w=vc(g,u),S=new o.P(0,0),P=new o.P(0,0);let R=0;for(const V in w){const G=w[V],X=this._touches[V];X&&(S._add(G),P._add(G.sub(X)),R++,w[V]=G)}if(this._touches=w,R<this._minTouches||!P.mag())return;const N=P.div(R);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(R),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=te("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Ff{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,u,g){return{}}touchstart(r,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,g){const w=this._firstTwoTouches;if(!w)return;r.preventDefault();const[S,P]=w,R=Kd(g,u,S),N=Kd(g,u,P);if(!R||!N)return;const V=this._aroundCenter?null:R.add(N).div(2);return this._move([R,N],V,r)}touchend(r,u,g){if(!this._firstTwoTouches)return;const[w,S]=this._firstTwoTouches,P=Kd(g,u,w),R=Kd(g,u,S);P&&R||(this._active&&Qe(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kd(m,r,u){for(let g=0;g<m.length;g++)if(m[g].identifier===u)return r[g]}function Jh(m,r){return Math.log(m/r)/Math.LN2}class Bm extends Ff{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const g=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Jh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Jh(this._distance,g),pinchAround:u}}}function Uf(m,r){return 180*m.angleWith(r)/Math.PI}class t_ extends Ff{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const g=this._vector;if(this._vector=r[0].sub(r[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Uf(this._vector,g),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const w=Uf(r,g);return Math.abs(w)<u}}function kp(m){return Math.abs(m.y)>Math.abs(m.x)}class Py extends Ff{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,kp(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,g){const w=this._lastPoints;if(!w)return;const S=r[0].sub(w[0]),P=r[1].sub(w[1]);return this._map._cooperativeGestures&&!o.ex()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(S,P,g.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(S.y+P.y)/2*-.5})}gestureBeginsVertically(r,u,g){if(this._valid!==void 0)return this._valid;const w=r.mag()>=2,S=u.mag()>=2;if(!w&&!S)return;if(!w||!S)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const P=r.y>0==u.y>0;return kp(r)&&kp(u)&&P}}const n_={panStep:100,bearingStep:15,pitchStep:10};class As{constructor(){const r=n_;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,g=0,w=0,S=0,P=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?g=-1:(r.preventDefault(),S=-1);break;case 39:r.shiftKey?g=1:(r.preventDefault(),S=1);break;case 38:r.shiftKey?w=1:(r.preventDefault(),P=-1);break;case 40:r.shiftKey?w=-1:(r.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(g=0,w=0),{cameraAnimation:R=>{const N=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:Us,zoom:u?Math.round(N)+u*(r.shiftKey?2:1):N,bearing:R.getBearing()+g*this._bearingStep,pitch:R.getPitch()+w*this._pitchStep,offset:[-S*this._panStep,-P*this._panStep],center:R.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Us(m){return m*(2-m)}const jm=4.000244140625,i_=1/450;class r_{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=i_,o.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const g=o.q.now(),w=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%jm==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(w*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=tt(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const V=this._type==="wheel"&&Math.abs(this._delta)>jm?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&G!==0&&(G=1/G);const X=u(),W=Math.pow(2,X),Q=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(Q*G))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),w=this._startZoom,S=this._easing;let P,R=!1;if(this._type==="wheel"&&w&&S){const V=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),G=S(V);P=o.ai(w,g,G),V<1?this._frameId||(this._frameId=!0):R=!0}else P=g,R=!0;this._active=!0,R&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let N=P-u();return N*this._lastDelta<0&&(N=0),{noInertia:!0,needsRenderFrame:!R,zoomDelta:N,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=o.ey;if(this._prevEase){const g=this._prevEase,w=(o.q.now()-g.start)/g.duration,S=g.easing(w+.01)-g.easing(w),P=.27/Math.sqrt(S*S+1e-4)*.01,R=Math.sqrt(.0729-P*P);u=o.ew(P,R,.25,1)}return this._prevEase={start:o.q.now(),duration:r,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=te("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class o_{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class a_{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,u){return r.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(r.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Np{constructor(){this._tap=new za({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,u,g){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(r,u,g))}touchmove(r,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const w=u[0],S=w.y-this._swipePoint.y;return this._swipePoint=w,r.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(r,u,g)}touchend(r,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(r,u,g)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fm{constructor(r,u,g){this._el=r,this._mousePan=u,this._touchPan=g}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Cy{constructor(r,u,g){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class My{constructor(r,u,g,w){this._el=r,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Bp=m=>m.zoom||m.drag||m.pitch||m.rotate;class wo extends o.A{}class Um{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,u){const g=o.at([],u,r);this.radius=o.ae(g[2]<0?o.eA([],g,this.constants):[g[0],g[1],0])}projectRay(r){o.eA(r,r,this.constants),o.au(r,r),o.eB(r,r,this.constants);const u=o.bY([],r,this.radius);if(u[2]>0){const g=o.bY([],[0,0,1],o.bG(u,[0,0,1])),w=o.bY([],o.au([],[u[0],u[1],0]),this.radius),S=o.cV([],u,o.bY([],o.at([],o.cV([],w,g),u),2));u[0]=S[0],u[1]=S[1]}return u}}function Vf(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Vm{constructor(r,u){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zd(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Um,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),o.aV(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,S,P]of this._listeners){const R=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(S,R,P)}}destroy(){for(const[r,u,g]of this._listeners){const w=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(u,w,g)}}_addDefaultHandlers(r){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new yc(u,r));const w=u.boxZoom=new zm(u,r);this._add("boxZoom",w);const S=new Bf,P=new a_;u.doubleClickZoom=new o_(P,S),this._add("tapZoom",S),this._add("clickZoom",P);const R=new Np;this._add("tapDragZoom",R);const N=u.touchPitch=new Py(u);this._add("touchPitch",N);const V=new Ou(r),G=new Iu(r);u.dragRotate=new Cy(r,V,G),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const X=new km(r),W=new Nm(u,r);u.dragPan=new Fm(g,X,W),this._add("mousePan",X),this._add("touchPan",W,["touchZoom","touchRotate"]);const Q=new t_,fe=new Bm;u.touchZoomRotate=new My(g,fe,Q,R),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new eu(u));const se=u.scrollZoom=new r_(u,this);this._add("scrollZoom",se,["mousePan"]);const pe=u.keyboard=new As;this._add("keyboard",pe);for(const ye of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[ye]&&u[ye].enable(r[ye])}_add(r,u,g){this._handlers.push({handlerName:r,handler:u,allowed:g}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Bp(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,u,g){for(const w in r)if(w!==g&&(!u||u.indexOf(w)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const u=[];for(const g of r)this._el.contains(g.target)&&u.push(g);return u}handleEvent(r,u){this._updatingCamera=!0;const g=r.type==="renderFrame",w=g?void 0:r,S={needsRenderFrame:!1},P={},R={},N=r.touches?this._getMapTouches(r.touches):void 0,V=N?Ge(this._el,N):g?void 0:tt(this._el,r);for(const{handlerName:W,handler:Q,allowed:fe}of this._handlers){if(!Q.isEnabled())continue;let se;this._blockedByActive(R,fe,W)?Q.reset():Q[u||r.type]&&(se=Q[u||r.type](r,V,N),this.mergeHandlerResult(S,P,se,W,w),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||Q.isActive())&&(R[W]=Q)}const G={};for(const W in this._previousActiveHandlers)R[W]||(G[W]=w);this._previousActiveHandlers=R,(Object.keys(G).length||Vf(S))&&(this._changes.push([S,P,G]),this._triggerRenderFrame()),(Object.keys(R).length||Vf(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=S;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(r,u,g,w,S){if(!g)return;o.h(r,g);const P={handlerName:w,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(u.zoom=P),g.panDelta!==void 0&&(u.drag=P),g.pitchDelta!==void 0&&(u.pitch=P),g.bearingDelta!==void 0&&(u.rotate=P)}_applyChanges(){const r={},u={},g={};for(const[w,S,P]of this._changes)w.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(w.panDelta)),w.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(r.around=w.around),w.aroundCoord!==void 0&&(r.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(r.pinchAround=w.pinchAround),w.noInertia&&(r.noInertia=w.noInertia),o.h(u,S),o.h(g,P);this._updateMapTransform(r,u,g),this._changes=[]}_updateMapTransform(r,u,g){const w=this._map,S=w.transform,P=we=>[we.x,we.y,we.z];if((we=>{const De=this._eventsInProgress.drag;return De&&!this._handlersById[De.handlerName].isActive()})()&&!Vf(r)){const we=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),we!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&w._stop(!0),!Vf(r))return void this._fireEvents(u,g,!0);let{panDelta:R,zoomDelta:N,bearingDelta:V,pitchDelta:G,around:X,aroundCoord:W,pinchAround:Q}=r;S._isCameraConstrained&&(N>0&&(N=0),S._isCameraConstrained=!1),Q!==void 0&&(X=Q),(N||(we=>u[we]&&!this._eventsInProgress[we])("drag"))&&X&&(this._dragOrigin=P(S.pointCoordinate3D(X)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",w._stop(!0),X=X||w.transform.centerPoint,V&&(S.bearing+=V),G&&(S.pitch+=G),S._updateCameraState();const fe=[0,0,0];if(R)if(S.projection.name==="mercator"){const we=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X).dir),De=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X.sub(R)).dir);fe[0]=De[0]-we[0],fe[1]=De[1]-we[1]}else{const we=S.pointCoordinate(X);if(S.projection.name==="globe"){R=R.rotate(-S.angle);const De=S._pixelsPerMercatorPixel/S.worldSize;fe[0]=-R.x*o.ez(o.aY(we.y))*De,fe[1]=-R.y*o.ez(S.center.lat)*De}else{const De=S.pointCoordinate(X.sub(R));we&&De&&(fe[0]=De.x-we.x,fe[1]=De.y-we.y)}}const se=S.zoom,pe=[0,0,0];if(N){const we=P(W||S.pointCoordinate3D(X)),De={dir:o.au([],o.at([],we,S._camera.position))};if(De.dir[2]<0){const Le=S.zoomDeltaToMovement(we,N);o.bY(pe,De.dir,Le)}}const ye=o.cV(fe,fe,pe);S._translateCameraConstrained(ye),N&&Math.abs(S.zoom-se)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,g,!0)}_fireEvents(r,u,g){const w=Bp(this._eventsInProgress),S=Bp(r),P={};for(const G in r){const{originalEvent:X}=r[G];this._eventsInProgress[G]||(P[`${G}start`]=X),this._eventsInProgress[G]=r[G]}!w&&S&&this._fireEvent("movestart",S.originalEvent);for(const G in P)this._fireEvent(G,P[G]);S&&this._fireEvent("move",S.originalEvent);for(const G in r){const{originalEvent:X}=r[G];this._fireEvent(G,X)}const R={};let N;for(const G in this._eventsInProgress){const{handlerName:X,originalEvent:W}=this._eventsInProgress[G];this._handlersById[X].isActive()||(delete this._eventsInProgress[G],N=u[X]||W,R[`${G}end`]=N)}for(const G in R)this._fireEvent(G,R[G]);const V=Bp(this._eventsInProgress);if(g&&(w||S)&&!V){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;G?(X(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:N})):(this._map.fire(new o.A("moveend",{originalEvent:N})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new o.A(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new wo("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const $m="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Qh extends o.E{constructor(r,u){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,o.aV(["_renderFrameCallback"],this)}getCenter(){return new o.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,g){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.h({offset:r},u),g)}panTo(r,u,g){return this.easeTo(o.h({center:r},u),g)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,g){return this.easeTo(o.h({zoom:r},u),g)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,g){return this.easeTo(o.h({bearing:r},u),g)}resetNorth(r,u){return this.rotateTo(0,o.h({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(o.h({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=o.aG.convert(r);const g=u&&u.bearing||0,w=u&&u.pitch||0,S=r.getNorthWest(),P=r.getSouthEast();return this._cameraForBounds(this.transform,S,P,g,w,u)}_extendPadding(r){const u={top:0,right:0,bottom:0,left:0};return r==null?o.h({},u,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:o.h({},u,r)}_extendCameraOptions(r){return(r=o.h({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,u){const g=u.max[0]-u.min[0],w=u.max[1]-u.min[1];return g/w>r.aspect?g/(2*Math.tan(.5*r.fovX)*r.aspect):w/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,u,g,w,S,P){const R=r.clone(),N=this._extendCameraOptions(P);R.bearing=w,R.pitch=S;const V=o.cd.convert(u),G=o.cd.convert(g),X=.5*(V.lat+G.lat),W=.5*(V.lng+G.lng),Q=o.eC(X,W),fe=o.au([],Q),se=o.au([],o.bF([],fe,[0,1,0])),pe=o.bF([],se,fe),ye=[se[0],se[1],se[2],0,pe[0],pe[1],pe[2],0,fe[0],fe[1],fe[2],0,0,0,0,1],we=[Q,o.eC(V.lat,V.lng),o.eC(G.lat,V.lng),o.eC(G.lat,G.lng),o.eC(V.lat,G.lng),o.eC(X,V.lng),o.eC(X,G.lng),o.eC(V.lat,W),o.eC(G.lat,W)];let De=o.cW.fromPoints(we.map(wt=>[o.bG(se,wt),o.bG(pe,wt),o.bG(fe,wt)]));const Le=o.ad([],De.center,ye);o.eD(Le)===0&&o.eE(Le,0,0,1),o.au(Le,Le),o.bY(Le,Le,o.aB),R.center=o.eF(Le);const Ze=R.getWorldToCameraMatrix(),Ue=o.bi(new Float64Array(16),Ze);De=o.cW.applyTransform(De,o.az([],Ze,ye));const Fe=this._extendAABB(De,R,N,w);if(!Fe)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");De=Fe,o.ad(Le,Le,Ze);const ke=.5*(De.max[2]-De.min[2]),qe=this._minimumAABBFrustumDistance(R,De),Ke=o.bY([],[0,0,1],ke),pt=o.cV(Ke,Le,Ke),mt=qe+(R.pitch===0?0:o.bD(Le,pt)),It=R.globeCenterInViewSpace,Nt=o.at([],Le,[It[0],It[1],It[2]]);o.au(Nt,Nt),o.bY(Nt,Nt,mt);const Xt=o.cV([],Le,Nt);o.ad(Xt,Xt,Ue);const ut=o.eq/o.aB,Et=o.ae(Xt),at=o.c6(Math.max(Et*ut-o.eq,Number.EPSILON),0),jt=Math.min(R.zoomFromMercatorZAdjusted(at),N.maxZoom);return jt>.5*(o.cL+o.cx)?(R.setProjection({name:"mercator"}),R.zoom=jt,this._cameraForBounds(R,u,g,w,S,P)):{center:R.center,zoom:jt,bearing:w,pitch:S}}_extendAABB(r,u,g,w){const S=.5*((g.padding.left||0)+(g.padding.right||0)),P=.5*((g.padding.top||0)+(g.padding.bottom||0)),R=P,N=S,V=S,G=P,X=u.width-(N+V),W=u.height-(R+G),Q=o.at([],r.max,r.min),fe=Math.min(X/Q[0],W/Q[1]),se=Math.min(u.scaleZoom(u.scale*fe),g.maxZoom);if(isNaN(se))return null;const pe=u.scale/u.zoomScale(se),ye=new o.cW([r.min[0]-N*pe,r.min[1]-G*pe,r.min[2]],[r.max[0]+V*pe,r.max[1]+R*pe,r.max[2]]),we=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new o.P(g.offset.x,g.offset.y):o.P.convert(g.offset)).rotate(-o.al(w));return ye.center[0]-=we.x*pe,ye.center[1]+=we.y*pe,ye}queryTerrainElevation(r,u){const g=this.transform.elevation;return g?(u=o.h({},{exaggerated:!0},u),g.getAtPoint(o.ac.fromLngLat(r),null,u.exaggerated)):null}_cameraForBounds(r,u,g,w,S,P){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,u,g,w,S,P);const R=r.clone(),N=this._extendCameraOptions(P);R.bearing=w,R.pitch=S;const V=o.cd.convert(u),G=o.cd.convert(g),X=new o.cd(V.lng,G.lat),W=new o.cd(G.lng,V.lat),Q=R.project(V),fe=R.project(G),se=this.queryTerrainElevation(V),pe=this.queryTerrainElevation(G),ye=this.queryTerrainElevation(X),we=this.queryTerrainElevation(W),De=[[Q.x,Q.y,Math.min(se||0,pe||0,ye||0,we||0)],[fe.x,fe.y,Math.max(se||0,pe||0,ye||0,we||0)]];let Le=o.cW.fromPoints(De);const Ze=R.getWorldToCameraMatrix(),Ue=o.bi(new Float64Array(16),Ze);Le=o.cW.applyTransform(Le,Ze);const Fe=this._extendAABB(Le,R,N,w);if(!Fe)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Le=Fe;const ke=.5*o.at([],Le.max,Le.min)[2],qe=this._minimumAABBFrustumDistance(R,Le),Ke=[0,0,1,0];o.aA(Ke,Ke,Ze),o.eG(Ke,Ke);const pt=o.bY([],Ke,qe+ke),mt=o.cV([],Le.center,pt);o.ad(Le.center,Le.center,Ue),o.ad(mt,mt,Ue);const It=R.unproject(new o.P(Le.center[0],Le.center[1])),Nt=o.eH(R.projection,It),Xt=Math.pow(2,Nt),ut=Math.min(R._zoomFromMercatorZ(mt[2]*R.pixelsPerMeter*Xt/R.worldSize),N.maxZoom);return R.mercatorFromTransition&&ut<.5*(o.cL+o.cx)?(R.setProjection({name:"globe"}),R.zoom=ut,this._cameraForBounds(R,u,g,w,S,P)):{center:It,zoom:ut,bearing:w,pitch:S}}fitBounds(r,u,g){const w=this.cameraForBounds(r,u);return this._fitInternal(w,u,g)}fitScreenCoordinates(r,u,g,w,S){const P=o.P.convert(r),R=o.P.convert(u),N=new o.P(Math.min(P.x,R.x),Math.min(P.y,R.y)),V=new o.P(Math.max(P.x,R.x),Math.max(P.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,R))return this;const G=this.transform.pointLocation3D(N),X=this.transform.pointLocation3D(V),W=this.transform.pointLocation3D(new o.P(N.x,V.y)),Q=this.transform.pointLocation3D(new o.P(V.x,N.y)),fe=[Math.min(G.lng,X.lng,W.lng,Q.lng),Math.min(G.lat,X.lat,W.lat,Q.lat)],se=[Math.max(G.lng,X.lng,W.lng,Q.lng),Math.max(G.lat,X.lat,W.lat,Q.lat)],pe=w&&w.pitch?w.pitch:this.getPitch(),ye=this._cameraForBounds(this.transform,fe,se,g,pe,w);return this._fitInternal(ye,w,S)}_fitInternal(r,u,g){return r?(u=o.h(r,u)).linear?this.easeTo(u,g):this.flyTo(u,g):this}jumpTo(r,u){this.stop();const g=r.preloadOnly?this.transform.clone():this.transform;let w=!1,S=!1,P=!1;"zoom"in r&&g.zoom!==+r.zoom&&(w=!0,g.zoom=+r.zoom),r.center!==void 0&&(g.center=o.cd.convert(r.center)),"bearing"in r&&g.bearing!==+r.bearing&&(S=!0,g.bearing=+r.bearing),"pitch"in r&&g.pitch!==+r.pitch&&(P=!0,g.pitch=+r.pitch);const R=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!g.isPaddingEqual(R))if(r.retainPadding===!1){const N=g.clone();N.padding=R,g.setLocationAtPoint(g.center,N.centerPoint)}else g.padding=R;return r.preloadOnly?(this._preloadTiles(g),this):(this.fire(new o.A("movestart",u)).fire(new o.A("move",u)),w&&this.fire(new o.A("zoomstart",u)).fire(new o.A("zoom",u)).fire(new o.A("zoomend",u)),S&&this.fire(new o.A("rotatestart",u)).fire(new o.A("rotate",u)).fire(new o.A("rotateend",u)),P&&this.fire(new o.A("pitchstart",u)).fire(new o.A("pitch",u)).fire(new o.A("pitchend",u)),this.fire(new o.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w($m),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return o.w($m),this;this.stop();const w=g.zoom,S=g.pitch,P=g.bearing;g.setFreeCameraOptions(r);const R=w!==g.zoom,N=S!==g.pitch,V=P!==g.bearing;return this.fire(new o.A("movestart",u)).fire(new o.A("move",u)),R&&this.fire(new o.A("zoomstart",u)).fire(new o.A("zoom",u)).fire(new o.A("zoomend",u)),V&&this.fire(new o.A("rotatestart",u)).fire(new o.A("rotate",u)).fire(new o.A("rotateend",u)),N&&this.fire(new o.A("pitchstart",u)).fire(new o.A("pitch",u)).fire(new o.A("pitchend",u)),this.fire(new o.A("moveend",u)),this}easeTo(r,u){this._stop(!1,r.easeId),((r=o.h({offset:[0,0],duration:500,easing:o.ey},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const g=this.transform,w=this.getZoom(),S=this.getBearing(),P=this.getPitch(),R=this.getPadding(),N="zoom"in r?+r.zoom:w,V="bearing"in r?this._normalizeBearing(r.bearing,S):S,G="pitch"in r?+r.pitch:P,X=this._extendPadding(r.padding),W=o.P.convert(r.offset);let Q,fe,se;if(g.projection.name==="globe"){const Ke=o.ac.fromLngLat(g.center),pt=W.rotate(-g.angle);Ke.x+=pt.x/g.worldSize,Ke.y+=pt.y/g.worldSize;const mt=Ke.toLngLat(),It=o.cd.convert(r.center||mt);this._normalizeCenter(It),Q=g.centerPoint.add(pt),fe=new o.P(Ke.x,Ke.y).mult(g.worldSize),se=new o.P(o.aD(It.lng),o.aH(It.lat)).mult(g.worldSize).sub(fe)}else{Q=g.centerPoint.add(W);const Ke=g.pointLocation(Q),pt=o.cd.convert(r.center||Ke);this._normalizeCenter(pt),fe=g.project(Ke),se=g.project(pt).sub(fe)}const pe=g.zoomScale(N-w);let ye,we;r.around&&(ye=o.cd.convert(r.around),we=g.locationPoint(ye));const De=this._zooming||N!==w,Le=this._rotating||S!==V,Ze=this._pitching||G!==P,Ue=!g.isPaddingEqual(X),Fe=r.retainPadding===!1?g.clone():g,ke=Ke=>pt=>{if(De&&(Ke.zoom=o.ai(w,N,pt)),Le&&(Ke.bearing=o.ai(S,V,pt)),Ze&&(Ke.pitch=o.ai(P,G,pt)),Ue&&(Fe.interpolatePadding(R,X,pt),Q=Fe.centerPoint.add(W)),ye)Ke.setLocationAtPoint(ye,we);else{const mt=Ke.zoomScale(Ke.zoom-w),It=N>w?Math.min(2,pe):Math.max(.5,pe),Nt=Math.pow(It,1-pt),Xt=Ke.unproject(fe.add(se.mult(pt*Nt)).mult(mt));Ke.setLocationAtPoint(Ke.renderWorldCopies?Xt.wrap():Xt,Q)}return r.preloadOnly||this._fireMoveEvents(u),Ke};if(r.preloadOnly){const Ke=this._emulate(ke,r.duration,g);return this._preloadTiles(Ke),this}const qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=De,this._rotating=Le,this._pitching=Ze,this._padding=Ue,this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,qe),this._ease(ke(g),Ke=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(u,Ke)},r),this}_prepareEase(r,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||g.moving||this.fire(new o.A("movestart",r)),this._zooming&&!g.zooming&&this.fire(new o.A("zoomstart",r)),this._rotating&&!g.rotating&&this.fire(new o.A("rotatestart",r)),this._pitching&&!g.pitching&&this.fire(new o.A("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.A("move",r)),this._zooming&&this.fire(new o.A("zoom",r)),this._rotating&&this.fire(new o.A("rotate",r)),this._pitching&&this.fire(new o.A("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new o.A("zoomend",r)),w&&this.fire(new o.A("rotateend",r)),S&&this.fire(new o.A("pitchend",r)),this.fire(new o.A("moveend",r))}flyTo(r,u){if(this._prefersReducedMotion(r)){const wt=o.aF(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(wt,u)}this.stop(),r=o.h({offset:[0,0],speed:1.2,curve:1.42,easing:o.ey},r);const g=this.transform,w=this.getZoom(),S=this.getBearing(),P=this.getPitch(),R=this.getPadding(),N="zoom"in r?o.ay(+r.zoom,g.minZoom,g.maxZoom):w,V="bearing"in r?this._normalizeBearing(r.bearing,S):S,G="pitch"in r?+r.pitch:P,X=this._extendPadding(r.padding),W=g.zoomScale(N-w),Q=o.P.convert(r.offset);let fe=g.centerPoint.add(Q);const se=g.pointLocation(fe),pe=o.cd.convert(r.center||se);this._normalizeCenter(pe);const ye=g.project(se),we=g.project(pe).sub(ye);let De=r.curve;const Le=Math.max(g.width,g.height),Ze=Le/W,Ue=we.mag();if("minZoom"in r){const wt=o.ay(Math.min(r.minZoom,w,N),g.minZoom,g.maxZoom),Ht=Le/g.zoomScale(wt-w);De=Math.sqrt(Ht/Ue*2)}const Fe=De*De;function ke(wt){const Ht=(Ze*Ze-Le*Le+(wt?-1:1)*Fe*Fe*Ue*Ue)/(2*(wt?Ze:Le)*Fe*Ue);return Math.log(Math.sqrt(Ht*Ht+1)-Ht)}function qe(wt){return(Math.exp(wt)-Math.exp(-wt))/2}function Ke(wt){return(Math.exp(wt)+Math.exp(-wt))/2}const pt=ke(0);let mt=function(wt){return Ke(pt)/Ke(pt+De*wt)},It=function(wt){return Le*((Ke(pt)*(qe(Ht=pt+De*wt)/Ke(Ht))-qe(pt))/Fe)/Ue;var Ht},Nt=(ke(1)-pt)/De;if(Math.abs(Ue)<1e-6||!isFinite(Nt)){if(Math.abs(Le-Ze)<1e-6)return this.easeTo(r,u);const wt=Ze<Le?-1:1;Nt=Math.abs(Math.log(Ze/Le))/De,It=function(){return 0},mt=function(Ht){return Math.exp(wt*De*Ht)}}r.duration="duration"in r?+r.duration:1e3*Nt/("screenSpeed"in r?+r.screenSpeed/De:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const Xt=S!==V,ut=G!==P,Et=!g.isPaddingEqual(X),at=r.retainPadding===!1?g.clone():g,jt=wt=>Ht=>{const pn=Ht*Nt,Ft=1/mt(pn);wt.zoom=Ht===1?N:w+wt.scaleZoom(Ft),Xt&&(wt.bearing=o.ai(S,V,Ht)),ut&&(wt.pitch=o.ai(P,G,Ht)),Et&&(at.interpolatePadding(R,X,Ht),fe=at.centerPoint.add(Q));const rn=Ht===1?pe:wt.unproject(ye.add(we.mult(It(pn))).mult(Ft));return wt.setLocationAtPoint(wt.renderWorldCopies?rn.wrap():rn,fe),wt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(u),wt};if(r.preloadOnly){const wt=this._emulate(jt,r.duration,g);return this._preloadTiles(wt),this}return this._zooming=!0,this._rotating=Xt,this._pitching=ut,this._padding=Et,this._prepareEase(u,!1),this._ease(jt(g),()=>this._afterEase(u),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!r){const g=this.handlers;g&&g.stop(!1)}return this}_ease(r,u,g){g.animate===!1||g.duration===0?(r(1),u()):(this._easeStart=o.q.now(),this._easeOptions=g,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,u){r=o.bX(r,-180,180);const g=Math.abs(r-u);return Math.abs(r-360-u)<g&&(r-=360),Math.abs(r+360-u)<g&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const g=r.lng-u.center.lng;r.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,u,g){const w=Math.ceil(15*u/1e3),S=[],P=r(g.clone());for(let R=0;R<=w;R++){const N=P(R/w);S.push(N.clone())}return S}_preloadTiles(r,u){}}class jp{constructor(r={}){this.options=r,o.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const u=this.options&&this.options.compact,g=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=te("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=te("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const w=te("span","mapboxgl-ctrl-icon",this._compactButton);return w.setAttribute("aria-hidden","true"),w.setAttribute("title",g),this._innerContainer=te("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(r){const g=u.reduce((w,S,P)=>(S.value&&(w+=`${S.key}=${S.value}${P<u.length-1?"&":""}`),w),"?");r.href=`${o.e.FEEDBACK_URL}/${g}#${Lp(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const u=this._map.style._mergedSourceCaches;for(const w in u){const S=u[w];if(S.used){const P=S.getSource();P.attribution&&r.indexOf(P.attribution)<0&&r.push(P.attribution)}}r.sort((w,S)=>w.length-S.length),r=r.filter((w,S)=>{for(let P=S+1;P<r.length;P++)if(r[P].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const g=r.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,r.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Fp{constructor(){o.aV(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=te("div","mapboxgl-ctrl");const u=te("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const u in r){const g=r[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Jd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const w of g)if(w.id===r)return void(w.cancelled=!0)}run(r=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Du{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const u=o.dk((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,u,g){this._start=this.getValue(u),this._end=r,this._startTime=u,this._endTime=u+g}}const xc={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Vo extends o.A{constructor(r,u,g,w){const{point:S,lngLat:P,originalEvent:R,target:N}=r;super(r.type,{point:S,lngLat:P,originalEvent:R,target:N}),this.preventDefault=()=>{r.preventDefault()},this.id=u,this.interaction=g,this.feature=w}}class Ru{constructor(r){this.map=r,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(r,u){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const g=u.filter;let w=u.type;g&&this.filters.set(r,o.b3(g)),w==="mouseover"&&(w="mouseenter"),w==="mouseout"&&(w="mouseleave");const S=this.interactionsByType.get(w)||new Map;w==="mouseenter"||w==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(r,u)):S.size===0&&this.map.on(w,this.handleType),S.size===0&&this.interactionsByType.set(w,S),S.set(r,u),this.typeById.set(r,w)}get(r){const u=this.typeById.get(r);if(!u)return;const g=this.interactionsByType.get(u);return g?g.get(r):void 0}remove(r){const u=this.typeById.get(r);if(!u)return;this.typeById.delete(r),this.filters.delete(r);const g=this.interactionsByType.get(u);g&&(g.delete(r),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(r),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(u,this.handleType))}queryTargets(r,u){const g=[];for(const[w,S]of u)S.target&&g.push({targetId:w,target:S.target,filter:this.filters.get(w)});return this.map.style.queryRenderedTargets(r,g,this.map.transform)}handleMove(r){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(r.point,Array.from(this.delegatedInteractions).reverse());u.length&&(r.type="mouseenter",this.handleType(r,u));const g=new Map;for(const[w,{feature:S}]of this.prevHoveredFeatures)this.hoveredFeatures.has(w)||g.set(S.id,S);g.size&&(r.type="mouseleave",this.handleType(r,Array.from(g.values())))}handleOut(r){const u=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);u.length&&(r.type="mouseleave",this.handleType(r,u)),this.hoveredFeatures.clear()}handleType(r,u){const g=r.type==="mouseenter";if(g&&!this.interactionsByType.has(r.type))return void o.w("mouseenter interaction required for mouseleave to work.");const w=Array.from(this.interactionsByType.get(r.type)).reverse(),S=!!u;u=u||this.queryTargets(r.point,w);let P=!1;const R=new Set;for(const N of u){for(const[V,G]of w){if(!G.target)continue;const X=N.variants?N.variants[V]:null;if(X){for(const W of X){if(cr(W,N,R,V))continue;const Q=new o.de(N,W),fe=sl(W,N,V);S&&(Q.state=this.map.getFeatureState(Q));const se=g?this.prevHoveredFeatures.get(fe):null,pe=new Vo(r,V,G,Q),ye=se?se.stop:G.handler(pe);if(g&&this.hoveredFeatures.set(fe,{feature:N,stop:ye}),ye!==!1){P=!0;break}}if(P)break}}if(P)break}if(!P)for(const[N,V]of w){const{handler:G,target:X}=V;if(!X&&G(new Vo(r,N,V,null))!==!1)break}}}function $f(m,r){if(Array.isArray(m)&&Array.isArray(r)){const u=new Set(m),g=new Set(r);return u.size===g.size&&m.every(w=>g.has(w))}return o.bv(m,r)}const bc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},s_={showCompass:!0,showZoom:!0,visualizePitch:!1};class qm{constructor(r,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Ou({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,g&&(this.mousePitch=new Iu({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(r,u){this.mouseRotate.mousedown(r,u),this.mousePitch&&this.mousePitch.mousedown(r,u),Pe()}move(r,u){const g=this.map,w=this.mouseRotate.mousemoveWindow(r,u),S=w&&w.bearingDelta;if(S&&g.setBearing(g.getBearing()+S),this.mousePitch){const P=this.mousePitch.mousemoveWindow(r,u),R=P&&P.pitchDelta;R&&g.setPitch(g.getPitch()+R)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Oe(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.h({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),tt(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,tt(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ge(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Ge(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Lu(m,r,u){if(m=new o.cd(m.lng,m.lat),r){const g=new o.cd(m.lng-360,m.lat),w=new o.cd(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-u.center.lng)/360),P=u.locationPoint3D(m).distSqr(r),R=r.x<0||r.y<0||r.x>u.width||r.y>u.height;u.locationPoint3D(g).distSqr(r)<P&&(R||Math.abs(g.lng-u.center.lng)<S)?m=g:u.locationPoint3D(w).distSqr(r)<P&&(R||Math.abs(w.lng-u.center.lng)<S)&&(m=w)}for(;Math.abs(m.lng-u.center.lng)>180;){const g=u.locationPoint3D(m);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;m.lng>u.center.lng?m.lng-=360:m.lng+=360}return m}const ga={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},zu={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Up extends o.E{constructor(r,u){super(),(r instanceof HTMLElement||u)&&(r=o.h({element:r},u)),o.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:g="center",color:w="#3FB1CE",scale:S=1,draggable:P=!1,clickTolerance:R=0,rotation:N=zu.rotation,rotationAlignment:V=zu.rotationAlignment,pitchAlignment:G=zu.pitchAlignment,occludedOpacity:X=zu.occludedOpacity,altitude:W=zu.altitude}=r||{};this._anchor=g,this._color=w,this._scale=S,this._draggable=P,this._clickTolerance=R,this._rotation=N,this._rotationAlignment=V,this._pitchAlignment=G,this._occludedOpacity=X,this._altitude=W,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),r&&r.element?(this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=o.P.convert(r&&r.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",se=>{se.preventDefault()}),this._element.addEventListener("mousedown",se=>{se.preventDefault()});const Q=this._element.classList;for(const se in ga)Q.remove(`mapboxgl-marker-anchor-${se}`);Q.add(`mapboxgl-marker-anchor-${this._anchor}`);const fe=r&&r.className?r.className.trim().split(/\s+/):[];Q.add(...fe),this._popup=null}_createDefaultMarker(){const r=te("div"),u=oe("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},r);if(this._altitude===0){const g=oe("radialGradient",{id:"shadowGradient"},oe("defs",{},u));oe("stop",{offset:"10%","stop-opacity":.4},g),oe("stop",{offset:"100%","stop-opacity":.05},g),oe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return oe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),oe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),oe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),r}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.cd.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(r){return r===this._altitude||(this._defaultMarker&&(this._altitude===0&&r!==0||this._altitude!==0&&r===0)&&(this._element=this._createDefaultMarker()),this._altitude=r||zu.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,r._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const u=r.code,g=r.charCode||r.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(r){const u=r.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,u=this._pos;if(!r||!u)return!1;const g=r.unproject(u,this._altitude),w=r.getFreeCameraOptions();if(!w.position)return!1;const S=w.position.toLngLat();return S.distanceTo(g)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const u=this._pos;if(!u||u.x<0||u.x>r.transform.width||u.y<0||u.y>r.transform.height)return void this._clearFadeTimer();const g=r.unproject(u,this._altitude);let w;r._showingGlobe()&&o.eK(r.transform,this._lngLat)?w=0:(w=1-r._queryFogOpacity(g),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${ga[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const r=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!r||g!=="map")return"";if(!u._showingGlobe()){const N=u.getPitch();return N?`rotateX(${N}deg)`:""}const w=o.cJ(o.eL(u.transform,this._lngLat)),S=r.sub(o.eM(u.transform)),P=Math.abs(S.x)+Math.abs(S.y);if(P===0)return"";const R=w/P;return`rotateX(${-S.y*R}deg) rotateY(${S.x*R}deg)`}_calculateZTransform(){const r=this._pos,u=this._map;if(!u||!r)return"";let g=0;const w=this.getRotationAlignment();if(w==="map")if(u._showingGlobe()){const S=u.project(new o.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),P=u.project(new o.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(S);g=o.cJ(Math.atan2(P.y,P.x))-90}else g=-u.getBearing();else if(w==="horizon"){const S=o.af(4,6,u.getZoom()),P=o.eM(u.transform);P.y+=S*u.transform.height;const R=r.sub(P),N=o.cJ(Math.atan2(R.y,R.x));g=(N>90?N-270:N+90)*(1-S)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Lu(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const u=this._map;if(!u)return;const g=this._pointerdownPos,w=this._positionDelta;if(g&&w){if(!this._isDragging){const S=this._clickTolerance||u._clickTolerance;if(r.point.dist(g)<S)return;this._isDragging=!0}this._pos=r.point.sub(w),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.A("dragstart"))),this.fire(new o.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.A("dragend")),this._state="inactive"}_addDragHandler(r){const u=this._map,g=this._pos;u&&g&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(g),this._pointerdownPos=r.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const u=this._map;return u&&(r?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||zu.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||zu.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||zu.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||zu.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Hm={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},lh={maxWidth:100,unit:"metric"},Yl={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ku={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},wc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function hl(m=new o.P(0,0),r="bottom"){if(typeof m=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(r){case"top":return new o.P(0,m);case"top-left":return new o.P(u,u);case"top-right":return new o.P(-u,u);case"bottom":return new o.P(0,-m);case"bottom-left":return new o.P(u,-u);case"bottom-right":return new o.P(-u,-u);case"left":return new o.P(m,0);case"right":return new o.P(-m,0)}return new o.P(0,0)}return m instanceof o.P||Array.isArray(m)?o.P.convert(m):o.P.convert(m[r]||[0,0])}return{version:C,supported:J.supported,setRTLTextPlugin:o.eQ,getRTLTextPluginStatus:o.eP,Map:class extends Qh{constructor(m){I.mark(M.create);const r=m;if((m=o.h({},bc,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&o.eI(window)&&(m.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ad(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Jd,this._domRenderTaskQueue=new Jd,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.a$(),this._locale=o.h({},xc,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Du(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new ot(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){const u=document.getElementById(m.container);if(!u)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=u}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,o.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Dm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Vm(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||o.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new jh(this),m.hash&&(this._hash=new Lm(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const u=m.bounds;u&&(this.resize(),this.fitBounds(u,o.h({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new jp({customAttribution:m.customAttribution})),this._logoControl=new Fp,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new o.A(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new o.A(`${u.dataType}dataloading`,u))}),this._interactions=new Ru(this)}_getMapId(){return this._mapId}addControl(m,r){if(r===void 0&&(r=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=m.onAdd(this);this._controls.push(m);const g=this._controlPositions[r];return r.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(m);return r>-1&&this._controls.splice(r,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.A("movestart",m)).fire(new o.A("move",m)),this.fire(new o.A("resize",m)),r&&this.fire(new o.A("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(o.aG.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new o.A("zoomstart")).fire(new o.A("zoom")).fire(new o.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new o.A("zoomstart")).fire(new o.A("zoom")).fire(new o.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new o.A("pitchstart")).fire(new o.A("pitch")).fire(new o.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new o.A("pitchstart")).fire(new o.A("pitch")).fire(new o.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(r=>r==="auto"?navigator.language:r):m}setLanguage(m){const r=this._parseLanguage(m);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,r=m.projection.name;let u;r==="globe"&&m.zoom>=o.cx?(m.setMercatorFromTransition(),u=!0):r==="mercator"&&m.zoom<o.cx&&(m.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(m,r){return this._updateProjection(m||r||{name:"mercator"})}_updateProjection(m){let r;return r=m.name==="globe"&&this.transform.zoom>=o.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,r){return this.transform.locationPoint3D(o.cd.convert(m),r)}unproject(m,r){return this.transform.pointLocation3D(o.P.convert(m),r)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,r,u){const g=w=>{let S=[];if(Array.isArray(r)){const P=r.filter(R=>this.getLayer(R));S=P.length?this.queryRenderedFeatures(w,{layers:P}):[]}else S=this.queryRenderedFeatures(w,{target:r});return S};if(m==="mouseenter"||m==="mouseover"){let w=!1;return{listener:u,targets:r,delegates:{mousemove:P=>{const R=g(P.point);R.length?w||(w=!0,u.call(this,new Ta(m,this,P.originalEvent,{features:R}))):w=!1},mouseout:()=>{w=!1}}}}if(m==="mouseleave"||m==="mouseout"){let w=!1;return{listener:u,targets:r,delegates:{mousemove:R=>{g(R.point).length?w=!0:w&&(w=!1,u.call(this,new Ta(m,this,R.originalEvent)))},mouseout:R=>{w&&(w=!1,u.call(this,new Ta(m,this,R.originalEvent)))}}}}{const w=S=>{const P=g(S.point);P.length&&(S.features=P,u.call(this,S),delete S.features)};return{listener:u,targets:r,delegates:{[m]:w}}}}on(m,r,u){if(typeof r=="function"||u===void 0)return super.on(m,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const g=this._createDelegatedListener(m,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(const w in g.delegates)this.on(w,g.delegates[w]);return this}once(m,r,u){if(typeof r=="function"||u===void 0)return super.once(m,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const g=this._createDelegatedListener(m,r,u);for(const w in g.delegates)this.once(w,g.delegates[w]);return this}off(m,r,u){if(typeof r=="function"||u===void 0)return super.off(m,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const g=this._delegatedListeners?this._delegatedListeners[m]:void 0;return g&&(w=>{for(let S=0;S<w.length;S++){const P=w[S];if(P.listener===u&&$f(P.targets,r)){for(const R in P.delegates)this.off(R,P.delegates[R]);return w.splice(S,1),this}}})(g),this}queryRenderedFeatures(m,r){if(!this.style)return[];if(m===void 0||m instanceof o.P||Array.isArray(m)||r!==void 0||(r=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!r){const S=this.style.queryRenderedFeatures(m,void 0,this.transform),P=this.style.queryRenderedFeatureset(m,void 0,this.transform);return S.concat(P)}let u=!0;if(r.target&&(u=this._isTargetValid(r.target),u&&!r.layers))return this.style.queryRenderedFeatureset(m,r,this.transform);let g=!0;if(r.layers&&Array.isArray(r.layers)){for(const S of r.layers)if(!this._isValidId(S)){g=!1;break}if(g&&!r.target)return this.style.queryRenderedFeatures(m,r,this.transform)}let w=[];return g&&(w=w.concat(this.style.queryRenderedFeatures(m,r,this.transform))),u&&(w=w.concat(this.style.queryRenderedFeatureset(m,r,this.transform))),w}querySourceFeatures(m,r){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,r)}isPointOnSurface(m){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(m))}addInteraction(m,r){return this._interactions.add(m,r),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,r){return r=o.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&m&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(m,(u,g)=>{if(u){const w=typeof u=="string"?u:u instanceof Error?u.message:u.error;o.w(`Unable to perform style diff: ${w}. Rebuilding the style from scratch.`),this._updateStyle(m,r)}else g&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(m,r))}_getUIString(m){const r=this._locale[m];if(r==null)throw new Error(`Missing UI string '${m}'`);return r}_updateStyle(m,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){const u=o.h({},r);r&&r.config&&(u.initialConfig=r.config,delete u.config),this.style=new Uo(this,u).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Uo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new o.z(new Error("IDs can't be empty."))),!1):!o.d8(m)||(this.fire(new o.z(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(const r of m)if(!this._isValidId(r))return!1;return!0}return this._isTargetValid(m)}addSource(m,r){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,r),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,r,u){this._lazyInitEmptyStyle(),this.style.addSourceType(m,r,u)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,r,{pixelRatio:u=1,sdf:g=!1,stretchX:w,stretchY:S,content:P}={}){this._lazyInitEmptyStyle();const R=o.I.from(m);if(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:N,height:V,data:G}=o.q.getImageData(r);this.style.addImage(R,{data:new o.r({width:N,height:V},G),pixelRatio:u,stretchX:w,stretchY:S,content:P,sdf:g,version:0,usvg:!1})}else if(r.width===void 0||r.height===void 0)this.fire(new o.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:V}=r,G=r;this.style.addImage(R,{data:new o.r({width:N,height:V},new Uint8Array(G.data)),pixelRatio:u,stretchX:w,stretchY:S,content:P,sdf:g,usvg:!1,version:0,userImage:G}),G.onAdd&&G.onAdd(this,m)}}updateImage(m,r){this._lazyInitEmptyStyle();const u=o.I.from(m),g=this.style.getImage(u);if(!g)return void this.fire(new o.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?o.q.getImageData(r):r,{width:S,height:P,data:R}=w;if(S===void 0||P===void 0)return void this.fire(new o.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||P!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new o.z(new Error(`The width and height of the updated image (${S}, ${P})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const N=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);let V=!1;g.usvg?(g.data=new o.r({width:S,height:P},new Uint8Array(R)),g.usvg=!1,g.icon=void 0,V=!0):g.data.replace(R,N),this.style.updateImage(u,g,V)}hasImage(m){return m?!!this.style&&!!this.style.getImage(o.I.from(m)):(this.fire(new o.z(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(o.I.from(m))}loadImage(m,r){o.o(this._requestManager.transformRequest(m,o.R.Image),(u,g)=>{r(u,g instanceof HTMLImageElement?o.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(m=>m.name)}addModel(m,r){this._lazyInitEmptyStyle(),this.style.addModel(m,r)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new o.z(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,r){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,r),this._update(!0)):this}getSlot(m){const r=this.getLayer(m);return r&&r.slot||null}setSlot(m,r){return this.style.setSlot(m,r),this.style.mergeLayers(),this._update(!0)}addImport(m,r){return this.style.addImport(m,r).catch(u=>this.fire(new o.z(new Error("Failed to add import",u)))),this}updateImport(m,r){return typeof r!="string"&&r.id!==m?(this.removeImport(m),this.addImport(r)):(this.style.updateImport(m,r),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,r){return this.style.moveImport(m,r),this._update(!0)}moveLayer(m,r){return this._isValidId(m)?(this.style.moveLayer(m,r),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;const r=this.style.getOwnLayer(m);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,r,u){return this._isValidId(m)?(this.style.setLayerZoomRange(m,r,u),this._update(!0)):this}setFilter(m,r,u={}){return this._isValidId(m)?(this.style.setFilter(m,r,u),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,r,u,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,r,u,g),this._update(!0)):this}getPaintProperty(m,r){return this._isValidId(m)?this.style.getPaintProperty(m,r):null}setLayoutProperty(m,r,u,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,r,u,g),this._update(!0)):this}getLayoutProperty(m,r){return this._isValidId(m)?this.style.getLayoutProperty(m,r):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,r){return this.style.setSchema(m,r),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,r){return this.style.setConfig(m,r),this._update(!0)}getConfigProperty(m,r){return this.style.getConfigProperty(m,r)}setConfigProperty(m,r,u){return this.style.setConfigProperty(m,r,u),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){const r=m[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,r){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,r),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.cd.convert(m),this.transform):0}setFeatureState(m,r){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,r),this._update())}removeFeatureState(m,r){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,r),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let u,g,w,S=this._container;for(;S&&(!g||!w);){const P=window.getComputedStyle(S).transform;P&&P!=="none"&&(u=P.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(w=u[3])),S=S.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=w?Math.abs(r/w):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=te("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=te("div","mapboxgl-canvas-container",m);this._canvas=te("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=te("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(w=>{g[w]=te("div",`mapboxgl-ctrl-${w}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,r){const u=o.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(m),this._canvas.height=u*Math.ceil(r),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${r}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const r=this._markers.indexOf(m);r!==-1&&this._markers.splice(r,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const r=this._popups.indexOf(m);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const m=o.h({},J.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",m);r?(mn(r,!0),this.painter=new Gd(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.l.testSupport(r)):this.fire(new o.z(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.A("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new o.A("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let r;this.fire(new o.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,g=o.q.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=w.createQuery(),w.beginQuery(u.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,G=this.transform.pitch,X=o.q.now(),W=new o.aa(V,{now:X,fadeDuration:S,pitch:G,transition:this.style.transition,worldview:this._worldview});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(g);const R=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),R&&(this._placementDirty=R.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,I.mark(M.load),this.fire(new o.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const V=o.q.now()-g;w.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const G=w.getQueryParameter(r,w.QUERY_RESULT)/1e6;w.deleteQuery(r),this.fire(new o.A("gpu-timing-frame",{cpuTime:V,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){const V=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(V);this.fire(new o.A("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const V=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(V);this.fire(new o.A("gpu-timing-deferred-render",{gpuTime:G}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(N||this._repaint)this.triggerRepaint();else{const V=this.idle();if(V&&(P=this._updateAverageElevation(g,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),V&&(this.fire(new o.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new o.A("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,I.mark(M.fullLoad),this._performanceMetricsCollection&&ti(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const r of this._markers)m&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!m||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(m,r=!1){const u=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(r||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const w=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=m;const P=Math.abs(w-S);if(P>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(S),u(S);this._averageElevation.easeTo(S,m,300)}else if(P>1e-4)return this._averageElevation.jumpTo(S),u(S)}return!!this._averageElevation.isEasing(m)&&u(this._averageElevation.getValue(m))}_authenticate(){jn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===yt||m.status===401)){const r=this.painter.context.gl;mn(r,!1),this._logoControl instanceof Fp&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),An(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&kt(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function w(S){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,S,0);const P=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,P),P}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(w(m),r.canvasCopies.map(w),r.timeStamps)}_canvasPixelComparison(m,r,u){let g=u[1]-u[0];const w=m.length/4;for(let S=0;S<r.length;S++){const P=r[S];let R=0;for(let N=0;N<P.length;N+=4)P[N]===m[N]&&P[N+1]===m[N+1]&&P[N+2]===m[N+2]&&P[N+3]===m[N+3]&&(R+=1);g+=(u[S+2]-u[S+1])*(1-R/w)}return g}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),ai.delete(this.painter.context.gl),Dt.remove(),on.remove(),this._removed=!0,this.fire(new o.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=o.q.frame(r=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(r)}))}_preloadTiles(m){const r=this.style?this.style.getSourceCaches():[];return o.bt(r,(u,g)=>u._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,r){o.eJ(m,r)}get version(){return C}},NavigationControl:class{constructor(m={}){this.options=o.h({},s_,m),this._container=te("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),te("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),te("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:r}):u.resetNorth({},{originalEvent:r}))}),this._compassIcon=te("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const r=m.getZoom(),u=r===m.getMaxZoom(),g=r===m.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qm(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,r){const u=te("button",m,this._container);return u.type="button",u.addEventListener("click",r),u}_setButtonTitle(m,r){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${r}`);m.setAttribute("aria-label",u),m.firstElementChild&&m.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends o.E{constructor(m={}){super();const r=navigator.geolocation;this.options=o.h({geolocation:r},Hm,m),o.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Jc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=te("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const r=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,m(u)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>r(u.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(m){const r=this._map.getMaxBounds(),u=m.coords;return!!r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new o.A("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.A("geolocate",m)),this._finish()}}_updateCamera(m){const r=new o.cd(m.coords.longitude,m.coords.latitude),u=m.coords.accuracy,g=this._map.getBearing(),w=o.h({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(u),w,{geolocateSource:!0})}_updateMarker(m){if(m){const r=new o.cd(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,r=o.c6(1,m._center.lat)*m.worldSize,u=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.A("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=te("button","mapboxgl-ctrl-geolocate",this._container),te("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=te("div","mapboxgl-user-location"),this._dotElement.appendChild(te("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(te("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Up({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=te("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Up({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.A("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:jp,ScaleControl:class{constructor(m={}){this.options=o.h({},lh,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,r=this._map,u=r._containerHeight/2,g=r._containerWidth/2-m/2,w=r.unproject([g,u]),S=r.unproject([g+m,u]),P=w.distanceTo(S);if(this.options.unit==="imperial"){const R=3.2808*P;R>5280?this._setScale(m,R/5280,"mile"):this._setScale(m,R,"foot")}else this.options.unit==="nautical"?this._setScale(m,P/1852,"nautical-mile"):P>=1e3?this._setScale(m,P/1e3,"kilometer"):this._setScale(m,P,"meter")}_setScale(m,r,u){this._map._requestDomTask(()=>{const g=function(S){const P=Math.pow(10,`${Math.floor(S)}`.length-1);let R=S/P;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(N){const V=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*V)/V}(R),P*R}(r),w=g/r;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${Yl[u]}`,this._container.style.width=m*w+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=te("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:o.w("Full screen control 'container' must be a DOM element.")),o.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=te("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=te("button","mapboxgl-ctrl-fullscreen",this._controlContainer);te("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(m){super(),this.options=o.h(Object.create(ku),m),this._altitude=this.options.altitude,o.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new o.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new o.A("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=o.cd.convert(m),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const r=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=m;g=u.firstChild,g;)r.appendChild(g);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=te("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(m),this.options.closeButton){const u=this._closeButton=te("button","mapboxgl-popup-close-button",r);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let r;return this._classList.delete(m)?r=!1:(this._classList.add(m),r=!0),this._updateClassList(),r}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const r=this._map,u=this._container,g=this._pos;if(!r||!u||!g)return"bottom";const w=u.offsetWidth,S=u.offsetHeight,P=g.x<w/2,R=g.x>r.transform.width-w/2;if(g.y+m<S)return P?"top-left":R?"top-right":"top";if(g.y>r.transform.height-S){if(P)return"bottom-left";if(R)return"bottom-right"}return P?"left":R?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),m.className=r.join(" ")}_update(m){const r=this._map,u=this._content;if(!r||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=te("div","mapboxgl-popup",r.getContainer()),this._tip=te("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Lu(this._lngLat,this._pos,r.transform)),!this._trackPointer||m){const w=this._pos=this._trackPointer&&m instanceof o.P?m:r.project(this._lngLat,this._altitude),S=hl(this.options.offset),P=this._anchor=this._getAnchor(S.y),R=hl(this.options.offset,P),N=w.add(R).round();r._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${ga[P]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&r._showingGlobe()){const w=o.eK(r.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(wc);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Up,Style:Uo,LngLat:o.cd,LngLatBounds:o.aG,Point:o.P,MercatorCoordinate:o.ac,FreeCameraOptions:Ku,Evented:o.E,config:o.e,prewarm:o.eO,clearPrewarmedResources:o.eN,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(m){o.e.ACCESS_TOKEN=m},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(m){o.e.API_URL=m},get workerCount(){return o.eX.workerCount},set workerCount(m){o.eX.workerCount=m},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){o.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){o.eW(m)},get workerUrl(){return o.eV.workerUrl},set workerUrl(m){o.eV.workerUrl=m},get workerClass(){return o.eV.workerClass},set workerClass(m){o.eV.workerClass=m},get workerParams(){return o.eV.workerParams},set workerParams(m){o.eV.workerParams=m},get dracoUrl(){return o.eU()},set dracoUrl(m){o.eT(m)},get meshoptUrl(){return o.eS()},set meshoptUrl(m){o.eR(m)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var T=f;return T})}(d1)),d1.exports}var Hfe=qfe();const pd=Zu(Hfe);function t1(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var MA={exports:{}},wB;function Gfe(){return wB||(wB=1,function(e,t){(function(i){e.exports=i()})(function(){return function(){function i(s,f,y){function T(M,I){if(!f[M]){if(!s[M]){var j=typeof t1=="function"&&t1;if(!I&&j)return j(M,!0);if(o)return o(M,!0);var q=new Error("Cannot find module '"+M+"'");throw q.code="MODULE_NOT_FOUND",q}var K=f[M]={exports:{}};s[M][0].call(K.exports,function(J){var te=s[M][1][J];return T(te||J)},K,K.exports,i,s,f,y)}return f[M].exports}for(var o=typeof t1=="function"&&t1,C=0;C<y.length;C++)T(y[C]);return T}return i}()({1:[function(i,s,f){var y=i("./toPropertyKey.js");function T(o,C,M){return C=y(C),C in o?Object.defineProperty(o,C,{value:M,enumerable:!0,configurable:!0,writable:!0}):o[C]=M,o}s.exports=T,s.exports.__esModule=!0,s.exports.default=s.exports},{"./toPropertyKey.js":4}],2:[function(i,s,f){var y=i("./defineProperty.js");function T(C,M){var I=Object.keys(C);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(C);M&&(j=j.filter(function(q){return Object.getOwnPropertyDescriptor(C,q).enumerable})),I.push.apply(I,j)}return I}function o(C){for(var M=1;M<arguments.length;M++){var I=arguments[M]!=null?arguments[M]:{};M%2?T(Object(I),!0).forEach(function(j){y(C,j,I[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(I)):T(Object(I)).forEach(function(j){Object.defineProperty(C,j,Object.getOwnPropertyDescriptor(I,j))})}return C}s.exports=o,s.exports.__esModule=!0,s.exports.default=s.exports},{"./defineProperty.js":1}],3:[function(i,s,f){var y=i("./typeof.js").default;function T(o,C){if(y(o)!=="object"||o===null)return o;var M=o[Symbol.toPrimitive];if(M!==void 0){var I=M.call(o,C||"default");if(y(I)!=="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(o)}s.exports=T,s.exports.__esModule=!0,s.exports.default=s.exports},{"./typeof.js":5}],4:[function(i,s,f){var y=i("./typeof.js").default,T=i("./toPrimitive.js");function o(C){var M=T(C,"string");return y(M)==="symbol"?M:String(M)}s.exports=o,s.exports.__esModule=!0,s.exports.default=s.exports},{"./toPrimitive.js":3,"./typeof.js":5}],5:[function(i,s,f){function y(T){"@babel/helpers - typeof";return s.exports=y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},s.exports.__esModule=!0,s.exports.default=s.exports,y(T)}s.exports=y,s.exports.__esModule=!0,s.exports.default=s.exports},{}],6:[function(i,s,f){var y={};function T(M){return Math.floor(Math.abs(M)+.5)*(M>=0?1:-1)}function o(M,I,j){M=T(M*j),I=T(I*j);var q=M-I;q<<=1,M-I<0&&(q=~q);for(var K="";q>=32;)K+=String.fromCharCode((32|q&31)+63),q>>=5;return K+=String.fromCharCode(q+63),K}y.decode=function(M,I){for(var j=0,q=0,K=0,J=[],te=0,oe=0,ce=null,de,ue,Pe=Math.pow(10,Number.isInteger(I)?I:5);j<M.length;){ce=null,te=0,oe=0;do ce=M.charCodeAt(j++)-63,oe|=(ce&31)<<te,te+=5;while(ce>=32);de=oe&1?~(oe>>1):oe>>1,te=oe=0;do ce=M.charCodeAt(j++)-63,oe|=(ce&31)<<te,te+=5;while(ce>=32);ue=oe&1?~(oe>>1):oe>>1,q+=de,K+=ue,J.push([q/Pe,K/Pe])}return J},y.encode=function(M,I){if(!M.length)return"";for(var j=Math.pow(10,Number.isInteger(I)?I:5),q=o(M[0][0],0,j)+o(M[0][1],0,j),K=1;K<M.length;K++){var J=M[K],te=M[K-1];q+=o(J[0],te[0],j),q+=o(J[1],te[1],j)}return q};function C(M){for(var I=[],j=0;j<M.length;j++){var q=M[j].slice();I.push([q[1],q[0]])}return I}y.fromGeoJSON=function(M,I){if(M&&M.type==="Feature"&&(M=M.geometry),!M||M.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return y.encode(C(M.coordinates),I)},y.toGeoJSON=function(M,I){var j=y.decode(M,I);return{type:"LineString",coordinates:C(j)}},typeof s=="object"&&s.exports&&(s.exports=y)},{}],7:[function(i,s,f){var y=typeof Reflect=="object"?Reflect:null,T=y&&typeof y.apply=="function"?y.apply:function(Je,Ve,xt){return Function.prototype.apply.call(Je,Ve,xt)},o;y&&typeof y.ownKeys=="function"?o=y.ownKeys:Object.getOwnPropertySymbols?o=function(Je){return Object.getOwnPropertyNames(Je).concat(Object.getOwnPropertySymbols(Je))}:o=function(Je){return Object.getOwnPropertyNames(Je)};function C(Ge){console&&console.warn&&console.warn(Ge)}var M=Number.isNaN||function(Je){return Je!==Je};function I(){I.init.call(this)}s.exports=I,s.exports.once=xe,I.EventEmitter=I,I.prototype._events=void 0,I.prototype._eventsCount=0,I.prototype._maxListeners=void 0;var j=10;function q(Ge){if(typeof Ge!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Ge)}Object.defineProperty(I,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(Ge){if(typeof Ge!="number"||Ge<0||M(Ge))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Ge+".");j=Ge}}),I.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},I.prototype.setMaxListeners=function(Je){if(typeof Je!="number"||Je<0||M(Je))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Je+".");return this._maxListeners=Je,this};function K(Ge){return Ge._maxListeners===void 0?I.defaultMaxListeners:Ge._maxListeners}I.prototype.getMaxListeners=function(){return K(this)},I.prototype.emit=function(Je){for(var Ve=[],xt=1;xt<arguments.length;xt++)Ve.push(arguments[xt]);var yt=Je==="error",ot=this._events;if(ot!==void 0)yt=yt&&ot.error===void 0;else if(!yt)return!1;if(yt){var zt;if(Ve.length>0&&(zt=Ve[0]),zt instanceof Error)throw zt;var rt=new Error("Unhandled error."+(zt?" ("+zt.message+")":""));throw rt.context=zt,rt}var Bt=ot[Je];if(Bt===void 0)return!1;if(typeof Bt=="function")T(Bt,this,Ve);else for(var Vt=Bt.length,Ln=ue(Bt,Vt),xt=0;xt<Vt;++xt)T(Ln[xt],this,Ve);return!0};function J(Ge,Je,Ve,xt){var yt,ot,zt;if(q(Ve),ot=Ge._events,ot===void 0?(ot=Ge._events=Object.create(null),Ge._eventsCount=0):(ot.newListener!==void 0&&(Ge.emit("newListener",Je,Ve.listener?Ve.listener:Ve),ot=Ge._events),zt=ot[Je]),zt===void 0)zt=ot[Je]=Ve,++Ge._eventsCount;else if(typeof zt=="function"?zt=ot[Je]=xt?[Ve,zt]:[zt,Ve]:xt?zt.unshift(Ve):zt.push(Ve),yt=K(Ge),yt>0&&zt.length>yt&&!zt.warned){zt.warned=!0;var rt=new Error("Possible EventEmitter memory leak detected. "+zt.length+" "+String(Je)+" listeners added. Use emitter.setMaxListeners() to increase limit");rt.name="MaxListenersExceededWarning",rt.emitter=Ge,rt.type=Je,rt.count=zt.length,C(rt)}return Ge}I.prototype.addListener=function(Je,Ve){return J(this,Je,Ve,!1)},I.prototype.on=I.prototype.addListener,I.prototype.prependListener=function(Je,Ve){return J(this,Je,Ve,!0)};function te(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function oe(Ge,Je,Ve){var xt={fired:!1,wrapFn:void 0,target:Ge,type:Je,listener:Ve},yt=te.bind(xt);return yt.listener=Ve,xt.wrapFn=yt,yt}I.prototype.once=function(Je,Ve){return q(Ve),this.on(Je,oe(this,Je,Ve)),this},I.prototype.prependOnceListener=function(Je,Ve){return q(Ve),this.prependListener(Je,oe(this,Je,Ve)),this},I.prototype.removeListener=function(Je,Ve){var xt,yt,ot,zt,rt;if(q(Ve),yt=this._events,yt===void 0)return this;if(xt=yt[Je],xt===void 0)return this;if(xt===Ve||xt.listener===Ve)--this._eventsCount===0?this._events=Object.create(null):(delete yt[Je],yt.removeListener&&this.emit("removeListener",Je,xt.listener||Ve));else if(typeof xt!="function"){for(ot=-1,zt=xt.length-1;zt>=0;zt--)if(xt[zt]===Ve||xt[zt].listener===Ve){rt=xt[zt].listener,ot=zt;break}if(ot<0)return this;ot===0?xt.shift():Pe(xt,ot),xt.length===1&&(yt[Je]=xt[0]),yt.removeListener!==void 0&&this.emit("removeListener",Je,rt||Ve)}return this},I.prototype.off=I.prototype.removeListener,I.prototype.removeAllListeners=function(Je){var Ve,xt,yt;if(xt=this._events,xt===void 0)return this;if(xt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xt[Je]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete xt[Je]),this;if(arguments.length===0){var ot=Object.keys(xt),zt;for(yt=0;yt<ot.length;++yt)zt=ot[yt],zt!=="removeListener"&&this.removeAllListeners(zt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Ve=xt[Je],typeof Ve=="function")this.removeListener(Je,Ve);else if(Ve!==void 0)for(yt=Ve.length-1;yt>=0;yt--)this.removeListener(Je,Ve[yt]);return this};function ce(Ge,Je,Ve){var xt=Ge._events;if(xt===void 0)return[];var yt=xt[Je];return yt===void 0?[]:typeof yt=="function"?Ve?[yt.listener||yt]:[yt]:Ve?Oe(yt):ue(yt,yt.length)}I.prototype.listeners=function(Je){return ce(this,Je,!0)},I.prototype.rawListeners=function(Je){return ce(this,Je,!1)},I.listenerCount=function(Ge,Je){return typeof Ge.listenerCount=="function"?Ge.listenerCount(Je):de.call(Ge,Je)},I.prototype.listenerCount=de;function de(Ge){var Je=this._events;if(Je!==void 0){var Ve=Je[Ge];if(typeof Ve=="function")return 1;if(Ve!==void 0)return Ve.length}return 0}I.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]};function ue(Ge,Je){for(var Ve=new Array(Je),xt=0;xt<Je;++xt)Ve[xt]=Ge[xt];return Ve}function Pe(Ge,Je){for(;Je+1<Ge.length;Je++)Ge[Je]=Ge[Je+1];Ge.pop()}function Oe(Ge){for(var Je=new Array(Ge.length),Ve=0;Ve<Je.length;++Ve)Je[Ve]=Ge[Ve].listener||Ge[Ve];return Je}function xe(Ge,Je){return new Promise(function(Ve,xt){function yt(zt){Ge.removeListener(Je,ot),xt(zt)}function ot(){typeof Ge.removeListener=="function"&&Ge.removeListener("error",yt),Ve([].slice.call(arguments))}tt(Ge,Je,ot,{once:!0}),Je!=="error"&&Qe(Ge,yt,{once:!0})})}function Qe(Ge,Je,Ve){typeof Ge.on=="function"&&tt(Ge,"error",Je,Ve)}function tt(Ge,Je,Ve,xt){if(typeof Ge.on=="function")xt.once?Ge.once(Je,Ve):Ge.on(Je,Ve);else if(typeof Ge.addEventListener=="function")Ge.addEventListener(Je,function yt(ot){xt.once&&Ge.removeEventListener(Je,yt),Ve(ot)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Ge)}},{}],8:[function(i,s,f){(function(){var y=this,T={};typeof f<"u"?s.exports=T:y.fuzzy=T,T.simpleFilter=function(o,C){return C.filter(function(M){return T.test(o,M)})},T.test=function(o,C){return T.match(o,C)!==null},T.match=function(o,C,M){M=M||{};var I=0,j=[],q=C.length,K=0,J=0,te=M.pre||"",oe=M.post||"",ce=M.caseSensitive&&C||C.toLowerCase(),de;o=M.caseSensitive&&o||o.toLowerCase();for(var ue=0;ue<q;ue++)de=C[ue],ce[ue]===o[I]?(de=te+de+oe,I+=1,J+=1+J):J=0,K+=J,j[j.length]=de;return I===o.length?(K=ce===o?1/0:K,{rendered:j.join(""),score:K}):null},T.filter=function(o,C,M){return!C||C.length===0?[]:typeof o!="string"?C:(M=M||{},C.reduce(function(I,j,q,K){var J=j;M.extract&&(J=M.extract(j));var te=T.match(o,J,M);return te!=null&&(I[I.length]={string:te.rendered,score:te.score,index:q,original:j}),I},[]).sort(function(I,j){var q=j.score-I.score;return q||I.index-j.index}))}})()},{}],9:[function(i,s,f){var y=/<%=([\s\S]+?)%>/g;s.exports=y},{}],10:[function(i,s,f){(function(y){(function(){var T="Expected a function",o=NaN,C="[object Symbol]",M=/^\s+|\s+$/g,I=/^[-+]0x[0-9a-f]+$/i,j=/^0b[01]+$/i,q=/^0o[0-7]+$/i,K=parseInt,J=typeof y=="object"&&y&&y.Object===Object&&y,te=typeof self=="object"&&self&&self.Object===Object&&self,oe=J||te||Function("return this")(),ce=Object.prototype,de=ce.toString,ue=Math.max,Pe=Math.min,Oe=function(){return oe.Date.now()};function xe(Ve,xt,yt){var ot,zt,rt,Bt,Vt,Ln,$e=0,Pt=!1,$t=!1,on=!0;if(typeof Ve!="function")throw new TypeError(T);xt=Je(xt)||0,Qe(yt)&&(Pt=!!yt.leading,$t="maxWait"in yt,rt=$t?ue(Je(yt.maxWait)||0,xt):rt,on="trailing"in yt?!!yt.trailing:on);function An(ci){var Ii=ot,Mi=zt;return ot=zt=void 0,$e=ci,Bt=Ve.apply(Mi,Ii),Bt}function ct(ci){return $e=ci,Vt=setTimeout(ti,xt),Pt?An(ci):Bt}function kt(ci){var Ii=ci-Ln,Mi=ci-$e,Tr=xt-Ii;return $t?Pe(Tr,rt-Mi):Tr}function In(ci){var Ii=ci-Ln,Mi=ci-$e;return Ln===void 0||Ii>=xt||Ii<0||$t&&Mi>=rt}function ti(){var ci=Oe();if(In(ci))return Dt(ci);Vt=setTimeout(ti,kt(ci))}function Dt(ci){return Vt=void 0,on&&ot?An(ci):(ot=zt=void 0,Bt)}function jn(){Vt!==void 0&&clearTimeout(Vt),$e=0,ot=Ln=zt=Vt=void 0}function ai(){return Vt===void 0?Bt:Dt(Oe())}function mn(){var ci=Oe(),Ii=In(ci);if(ot=arguments,zt=this,Ln=ci,Ii){if(Vt===void 0)return ct(Ln);if($t)return Vt=setTimeout(ti,xt),An(Ln)}return Vt===void 0&&(Vt=setTimeout(ti,xt)),Bt}return mn.cancel=jn,mn.flush=ai,mn}function Qe(Ve){var xt=typeof Ve;return!!Ve&&(xt=="object"||xt=="function")}function tt(Ve){return!!Ve&&typeof Ve=="object"}function Ge(Ve){return typeof Ve=="symbol"||tt(Ve)&&de.call(Ve)==C}function Je(Ve){if(typeof Ve=="number")return Ve;if(Ge(Ve))return o;if(Qe(Ve)){var xt=typeof Ve.valueOf=="function"?Ve.valueOf():Ve;Ve=Qe(xt)?xt+"":xt}if(typeof Ve!="string")return Ve===0?Ve:+Ve;Ve=Ve.replace(M,"");var yt=j.test(Ve);return yt||q.test(Ve)?K(Ve.slice(2),yt?2:8):I.test(Ve)?o:+Ve}s.exports=xe}).call(this)}).call(this,typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{})},{}],11:[function(i,s,f){(function(y){(function(){var T=200,o="__lodash_hash_undefined__",C=1,M=2,I=9007199254740991,j="[object Arguments]",q="[object Array]",K="[object AsyncFunction]",J="[object Boolean]",te="[object Date]",oe="[object Error]",ce="[object Function]",de="[object GeneratorFunction]",ue="[object Map]",Pe="[object Number]",Oe="[object Null]",xe="[object Object]",Qe="[object Promise]",tt="[object Proxy]",Ge="[object RegExp]",Je="[object Set]",Ve="[object String]",xt="[object Symbol]",yt="[object Undefined]",ot="[object WeakMap]",zt="[object ArrayBuffer]",rt="[object DataView]",Bt="[object Float32Array]",Vt="[object Float64Array]",Ln="[object Int8Array]",$e="[object Int16Array]",Pt="[object Int32Array]",$t="[object Uint8Array]",on="[object Uint8ClampedArray]",An="[object Uint16Array]",ct="[object Uint32Array]",kt=/[\\^$.*+?()[\]{}|]/g,In=/^\[object .+?Constructor\]$/,ti=/^(?:0|[1-9]\d*)$/,Dt={};Dt[Bt]=Dt[Vt]=Dt[Ln]=Dt[$e]=Dt[Pt]=Dt[$t]=Dt[on]=Dt[An]=Dt[ct]=!0,Dt[j]=Dt[q]=Dt[zt]=Dt[J]=Dt[rt]=Dt[te]=Dt[oe]=Dt[ce]=Dt[ue]=Dt[Pe]=Dt[xe]=Dt[Ge]=Dt[Je]=Dt[Ve]=Dt[ot]=!1;var jn=typeof y=="object"&&y&&y.Object===Object&&y,ai=typeof self=="object"&&self&&self.Object===Object&&self,mn=jn||ai||Function("return this")(),ci=typeof f=="object"&&f&&!f.nodeType&&f,Ii=ci&&typeof s=="object"&&s&&!s.nodeType&&s,Mi=Ii&&Ii.exports===ci,Tr=Mi&&jn.process,kr=function(){try{return Tr&&Tr.binding&&Tr.binding("util")}catch{}}(),ja=kr&&kr.isTypedArray;function Xr(st,Ut){for(var kn=-1,qn=st==null?0:st.length,oo=0,Ui=[];++kn<qn;){var _o=st[kn];Ut(_o,kn,st)&&(Ui[oo++]=_o)}return Ui}function Yr(st,Ut){for(var kn=-1,qn=Ut.length,oo=st.length;++kn<qn;)st[oo+kn]=Ut[kn];return st}function go(st,Ut){for(var kn=-1,qn=st==null?0:st.length;++kn<qn;)if(Ut(st[kn],kn,st))return!0;return!1}function _a(st,Ut){for(var kn=-1,qn=Array(st);++kn<st;)qn[kn]=Ut(kn);return qn}function ya(st){return function(Ut){return st(Ut)}}function aa(st,Ut){return st.has(Ut)}function qs(st,Ut){return st?.[Ut]}function Ho(st){var Ut=-1,kn=Array(st.size);return st.forEach(function(qn,oo){kn[++Ut]=[oo,qn]}),kn}function Ar(st,Ut){return function(kn){return st(Ut(kn))}}function Fa(st){var Ut=-1,kn=Array(st.size);return st.forEach(function(qn){kn[++Ut]=qn}),kn}var Po=Array.prototype,bl=Function.prototype,ro=Object.prototype,Ea=mn["__core-js_shared__"],Ua=bl.toString,Co=ro.hasOwnProperty,ea=function(){var st=/[^.]+$/.exec(Ea&&Ea.keys&&Ea.keys.IE_PROTO||"");return st?"Symbol(src)_1."+st:""}(),Aa=ro.toString,Go=RegExp("^"+Ua.call(Co).replace(kt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tr=Mi?mn.Buffer:void 0,Pa=mn.Symbol,Is=mn.Uint8Array,ta=ro.propertyIsEnumerable,al=Po.splice,ls=Pa?Pa.toStringTag:void 0,Ca=Object.getOwnPropertySymbols,hn=tr?tr.isBuffer:void 0,vs=Ar(Object.keys,Object),Ja=us(mn,"DataView"),bt=us(mn,"Map"),Tt=us(mn,"Promise"),je=us(mn,"Set"),ae=us(mn,"WeakMap"),ge=us(Object,"create"),Ee=Sr(Ja),Ne=Sr(bt),be=Sr(Tt),We=Sr(je),nt=Sr(ae),Xe=Pa?Pa.prototype:void 0,lt=Xe?Xe.valueOf:void 0;function gt(st){var Ut=-1,kn=st==null?0:st.length;for(this.clear();++Ut<kn;){var qn=st[Ut];this.set(qn[0],qn[1])}}function ht(){this.__data__=ge?ge(null):{},this.size=0}function Zt(st){var Ut=this.has(st)&&delete this.__data__[st];return this.size-=Ut?1:0,Ut}function vn(st){var Ut=this.__data__;if(ge){var kn=Ut[st];return kn===o?void 0:kn}return Co.call(Ut,st)?Ut[st]:void 0}function _n(st){var Ut=this.__data__;return ge?Ut[st]!==void 0:Co.call(Ut,st)}function zn(st,Ut){var kn=this.__data__;return this.size+=this.has(st)?0:1,kn[st]=ge&&Ut===void 0?o:Ut,this}gt.prototype.clear=ht,gt.prototype.delete=Zt,gt.prototype.get=vn,gt.prototype.has=_n,gt.prototype.set=zn;function ii(st){var Ut=-1,kn=st==null?0:st.length;for(this.clear();++Ut<kn;){var qn=st[Ut];this.set(qn[0],qn[1])}}function si(){this.__data__=[],this.size=0}function gi(st){var Ut=this.__data__,kn=Kr(Ut,st);if(kn<0)return!1;var qn=Ut.length-1;return kn==qn?Ut.pop():al.call(Ut,kn,1),--this.size,!0}function ui(st){var Ut=this.__data__,kn=Kr(Ut,st);return kn<0?void 0:Ut[kn][1]}function Wi(st){return Kr(this.__data__,st)>-1}function _r(st,Ut){var kn=this.__data__,qn=Kr(kn,st);return qn<0?(++this.size,kn.push([st,Ut])):kn[qn][1]=Ut,this}ii.prototype.clear=si,ii.prototype.delete=gi,ii.prototype.get=ui,ii.prototype.has=Wi,ii.prototype.set=_r;function ir(st){var Ut=-1,kn=st==null?0:st.length;for(this.clear();++Ut<kn;){var qn=st[Ut];this.set(qn[0],qn[1])}}function ki(){this.size=0,this.__data__={hash:new gt,map:new(bt||ii),string:new gt}}function Fi(st){var Ut=cs(this,st).delete(st);return this.size-=Ut?1:0,Ut}function vi(st){return cs(this,st).get(st)}function nr(st){return cs(this,st).has(st)}function rr(st,Ut){var kn=cs(this,st),qn=kn.size;return kn.set(st,Ut),this.size+=kn.size==qn?0:1,this}ir.prototype.clear=ki,ir.prototype.delete=Fi,ir.prototype.get=vi,ir.prototype.has=nr,ir.prototype.set=rr;function Nr(st){var Ut=-1,kn=st==null?0:st.length;for(this.__data__=new ir;++Ut<kn;)this.add(st[Ut])}function Zo(st){return this.__data__.set(st,o),this}function hr(st){return this.__data__.has(st)}Nr.prototype.add=Nr.prototype.push=Zo,Nr.prototype.has=hr;function Xi(st){var Ut=this.__data__=new ii(st);this.size=Ut.size}function or(){this.__data__=new ii,this.size=0}function Lo(st){var Ut=this.__data__,kn=Ut.delete(st);return this.size=Ut.size,kn}function Hs(st){return this.__data__.get(st)}function Ds(st){return this.__data__.has(st)}function sl(st,Ut){var kn=this.__data__;if(kn instanceof ii){var qn=kn.__data__;if(!bt||qn.length<T-1)return qn.push([st,Ut]),this.size=++kn.size,this;kn=this.__data__=new ir(qn)}return kn.set(st,Ut),this.size=kn.size,this}Xi.prototype.clear=or,Xi.prototype.delete=Lo,Xi.prototype.get=Hs,Xi.prototype.has=Ds,Xi.prototype.set=sl;function cr(st,Ut){var kn=hs(st),qn=!kn&&zo(st),oo=!kn&&!qn&&Rs(st),Ui=!kn&&!qn&&!oo&&Ts(st),_o=kn||qn||oo||Ui,Fo=_o?_a(st.length,String):[],yo=Fo.length;for(var Mo in st)Co.call(st,Mo)&&!(_o&&(Mo=="length"||oo&&(Mo=="offset"||Mo=="parent")||Ui&&(Mo=="buffer"||Mo=="byteLength"||Mo=="byteOffset")||Vn(Mo,yo)))&&Fo.push(Mo);return Fo}function Kr(st,Ut){for(var kn=st.length;kn--;)if(ri(st[kn][0],Ut))return kn;return-1}function ll(st,Ut,kn){var qn=Ut(st);return hs(st)?qn:Yr(qn,kn(st))}function So(st){return st==null?st===void 0?yt:Oe:ls&&ls in Object(st)?ic(st):Ni(st)}function Bo(st){return Oa(st)&&So(st)==j}function xs(st,Ut,kn,qn,oo){return st===Ut?!0:st==null||Ut==null||!Oa(st)&&!Oa(Ut)?st!==st&&Ut!==Ut:va(st,Ut,kn,qn,xs,oo)}function va(st,Ut,kn,qn,oo,Ui){var _o=hs(st),Fo=hs(Ut),yo=_o?q:en(st),Mo=Fo?q:en(Ut);yo=yo==j?xe:yo,Mo=Mo==j?xe:Mo;var xa=yo==xe,qa=Mo==xe,Di=yo==Mo;if(Di&&Rs(st)){if(!Rs(Ut))return!1;_o=!0,xa=!1}if(Di&&!xa)return Ui||(Ui=new Xi),_o||Ts(st)?da(st,Ut,kn,qn,oo,Ui):wl(st,Ut,yo,kn,qn,oo,Ui);if(!(kn&C)){var sa=xa&&Co.call(st,"__wrapped__"),Ls=qa&&Co.call(Ut,"__wrapped__");if(sa||Ls){var Rl=sa?st.value():st,Xn=Ls?Ut.value():Ut;return Ui||(Ui=new Xi),oo(Rl,Xn,kn,qn,Ui)}}return Di?(Ui||(Ui=new Xi),bs(st,Ut,kn,qn,oo,Ui)):!1}function jo(st){if(!No(st)||yr(st))return!1;var Ut=Qa(st)?Go:In;return Ut.test(Sr(st))}function uo(st){return Oa(st)&&Ma(st.length)&&!!Dt[So(st)]}function ha(st){if(!na(st))return vs(st);var Ut=[];for(var kn in Object(st))Co.call(st,kn)&&kn!="constructor"&&Ut.push(kn);return Ut}function da(st,Ut,kn,qn,oo,Ui){var _o=kn&C,Fo=st.length,yo=Ut.length;if(Fo!=yo&&!(_o&&yo>Fo))return!1;var Mo=Ui.get(st);if(Mo&&Ui.get(Ut))return Mo==Ut;var xa=-1,qa=!0,Di=kn&M?new Nr:void 0;for(Ui.set(st,Ut),Ui.set(Ut,st);++xa<Fo;){var sa=st[xa],Ls=Ut[xa];if(qn)var Rl=_o?qn(Ls,sa,xa,Ut,st,Ui):qn(sa,Ls,xa,st,Ut,Ui);if(Rl!==void 0){if(Rl)continue;qa=!1;break}if(Di){if(!go(Ut,function(Xn,Ll){if(!aa(Di,Ll)&&(sa===Xn||oo(sa,Xn,kn,qn,Ui)))return Di.push(Ll)})){qa=!1;break}}else if(!(sa===Ls||oo(sa,Ls,kn,qn,Ui))){qa=!1;break}}return Ui.delete(st),Ui.delete(Ut),qa}function wl(st,Ut,kn,qn,oo,Ui,_o){switch(kn){case rt:if(st.byteLength!=Ut.byteLength||st.byteOffset!=Ut.byteOffset)return!1;st=st.buffer,Ut=Ut.buffer;case zt:return!(st.byteLength!=Ut.byteLength||!Ui(new Is(st),new Is(Ut)));case J:case te:case Pe:return ri(+st,+Ut);case oe:return st.name==Ut.name&&st.message==Ut.message;case Ge:case Ve:return st==Ut+"";case ue:var Fo=Ho;case Je:var yo=qn&C;if(Fo||(Fo=Fa),st.size!=Ut.size&&!yo)return!1;var Mo=_o.get(st);if(Mo)return Mo==Ut;qn|=M,_o.set(st,Ut);var xa=da(Fo(st),Fo(Ut),qn,oo,Ui,_o);return _o.delete(st),xa;case xt:if(lt)return lt.call(st)==lt.call(Ut)}return!1}function bs(st,Ut,kn,qn,oo,Ui){var _o=kn&C,Fo=Gs(st),yo=Fo.length,Mo=Gs(Ut),xa=Mo.length;if(yo!=xa&&!_o)return!1;for(var qa=yo;qa--;){var Di=Fo[qa];if(!(_o?Di in Ut:Co.call(Ut,Di)))return!1}var sa=Ui.get(st);if(sa&&Ui.get(Ut))return sa==Ut;var Ls=!0;Ui.set(st,Ut),Ui.set(Ut,st);for(var Rl=_o;++qa<yo;){Di=Fo[qa];var Xn=st[Di],Ll=Ut[Di];if(qn)var kc=_o?qn(Ll,Xn,Di,Ut,st,Ui):qn(Xn,Ll,Di,st,Ut,Ui);if(!(kc===void 0?Xn===Ll||oo(Xn,Ll,kn,qn,Ui):kc)){Ls=!1;break}Rl||(Rl=Di=="constructor")}if(Ls&&!Rl){var es=st.constructor,ts=Ut.constructor;es!=ts&&"constructor"in st&&"constructor"in Ut&&!(typeof es=="function"&&es instanceof es&&typeof ts=="function"&&ts instanceof ts)&&(Ls=!1)}return Ui.delete(st),Ui.delete(Ut),Ls}function Gs(st){return ll(st,Va,St)}function cs(st,Ut){var kn=st.__data__;return Zi(Ut)?kn[typeof Ut=="string"?"string":"hash"]:kn.map}function us(st,Ut){var kn=qs(st,Ut);return jo(kn)?kn:void 0}function ic(st){var Ut=Co.call(st,ls),kn=st[ls];try{st[ls]=void 0;var qn=!0}catch{}var oo=Aa.call(st);return qn&&(Ut?st[ls]=kn:delete st[ls]),oo}var St=Ca?function(st){return st==null?[]:(st=Object(st),Xr(Ca(st),function(Ut){return ta.call(st,Ut)}))}:$a,en=So;(Ja&&en(new Ja(new ArrayBuffer(1)))!=rt||bt&&en(new bt)!=ue||Tt&&en(Tt.resolve())!=Qe||je&&en(new je)!=Je||ae&&en(new ae)!=ot)&&(en=function(st){var Ut=So(st),kn=Ut==xe?st.constructor:void 0,qn=kn?Sr(kn):"";if(qn)switch(qn){case Ee:return rt;case Ne:return ue;case be:return Qe;case We:return Je;case nt:return ot}return Ut});function Vn(st,Ut){return Ut=Ut??I,!!Ut&&(typeof st=="number"||ti.test(st))&&st>-1&&st%1==0&&st<Ut}function Zi(st){var Ut=typeof st;return Ut=="string"||Ut=="number"||Ut=="symbol"||Ut=="boolean"?st!=="__proto__":st===null}function yr(st){return!!ea&&ea in st}function na(st){var Ut=st&&st.constructor,kn=typeof Ut=="function"&&Ut.prototype||ro;return st===kn}function Ni(st){return Aa.call(st)}function Sr(st){if(st!=null){try{return Ua.call(st)}catch{}try{return st+""}catch{}}return""}function ri(st,Ut){return st===Ut||st!==st&&Ut!==Ut}var zo=Bo(function(){return arguments}())?Bo:function(st){return Oa(st)&&Co.call(st,"callee")&&!ta.call(st,"callee")},hs=Array.isArray;function ko(st){return st!=null&&Ma(st.length)&&!Qa(st)}var Rs=hn||Tl;function ws(st,Ut){return xs(st,Ut)}function Qa(st){if(!No(st))return!1;var Ut=So(st);return Ut==ce||Ut==de||Ut==K||Ut==tt}function Ma(st){return typeof st=="number"&&st>-1&&st%1==0&&st<=I}function No(st){var Ut=typeof st;return st!=null&&(Ut=="object"||Ut=="function")}function Oa(st){return st!=null&&typeof st=="object"}var Ts=ja?ya(ja):uo;function Va(st){return ko(st)?cr(st):ha(st)}function $a(){return[]}function Tl(){return!1}s.exports=ws}).call(this)}).call(this,typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{})},{}],12:[function(i,s,f){(function(y){(function(){var T=i("lodash._reinterpolate"),o=i("lodash.templatesettings"),C=800,M=16,I=9007199254740991,j="[object Arguments]",q="[object Array]",K="[object AsyncFunction]",J="[object Boolean]",te="[object Date]",oe="[object DOMException]",ce="[object Error]",de="[object Function]",ue="[object GeneratorFunction]",Pe="[object Map]",Oe="[object Number]",xe="[object Null]",Qe="[object Object]",tt="[object Proxy]",Ge="[object RegExp]",Je="[object Set]",Ve="[object String]",xt="[object Symbol]",yt="[object Undefined]",ot="[object WeakMap]",zt="[object ArrayBuffer]",rt="[object DataView]",Bt="[object Float32Array]",Vt="[object Float64Array]",Ln="[object Int8Array]",$e="[object Int16Array]",Pt="[object Int32Array]",$t="[object Uint8Array]",on="[object Uint8ClampedArray]",An="[object Uint16Array]",ct="[object Uint32Array]",kt=/\b__p \+= '';/g,In=/\b(__p \+=) '' \+/g,ti=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Dt=/[\\^$.*+?()[\]{}|]/g,jn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ai=/^\[object .+?Constructor\]$/,mn=/^(?:0|[1-9]\d*)$/,ci=/($^)/,Ii=/['\n\r\u2028\u2029\\]/g,Mi={};Mi[Bt]=Mi[Vt]=Mi[Ln]=Mi[$e]=Mi[Pt]=Mi[$t]=Mi[on]=Mi[An]=Mi[ct]=!0,Mi[j]=Mi[q]=Mi[zt]=Mi[J]=Mi[rt]=Mi[te]=Mi[ce]=Mi[de]=Mi[Pe]=Mi[Oe]=Mi[Qe]=Mi[Ge]=Mi[Je]=Mi[Ve]=Mi[ot]=!1;var Tr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kr=typeof y=="object"&&y&&y.Object===Object&&y,ja=typeof self=="object"&&self&&self.Object===Object&&self,Xr=kr||ja||Function("return this")(),Yr=typeof f=="object"&&f&&!f.nodeType&&f,go=Yr&&typeof s=="object"&&s&&!s.nodeType&&s,_a=go&&go.exports===Yr,ya=_a&&kr.process,aa=function(){try{var St=go&&go.require&&go.require("util").types;return St||ya&&ya.binding&&ya.binding("util")}catch{}}(),qs=aa&&aa.isTypedArray;function Ho(St,en,Vn){switch(Vn.length){case 0:return St.call(en);case 1:return St.call(en,Vn[0]);case 2:return St.call(en,Vn[0],Vn[1]);case 3:return St.call(en,Vn[0],Vn[1],Vn[2])}return St.apply(en,Vn)}function Ar(St,en){for(var Vn=-1,Zi=St==null?0:St.length,yr=Array(Zi);++Vn<Zi;)yr[Vn]=en(St[Vn],Vn,St);return yr}function Fa(St,en){for(var Vn=-1,Zi=Array(St);++Vn<St;)Zi[Vn]=en(Vn);return Zi}function Po(St){return function(en){return St(en)}}function bl(St,en){return Ar(en,function(Vn){return St[Vn]})}function ro(St){return"\\"+Tr[St]}function Ea(St,en){return St?.[en]}function Ua(St,en){return function(Vn){return St(en(Vn))}}var Co=Function.prototype,ea=Object.prototype,Aa=Xr["__core-js_shared__"],Go=Co.toString,tr=ea.hasOwnProperty,Pa=function(){var St=/[^.]+$/.exec(Aa&&Aa.keys&&Aa.keys.IE_PROTO||"");return St?"Symbol(src)_1."+St:""}(),Is=ea.toString,ta=Go.call(Object),al=RegExp("^"+Go.call(tr).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ls=_a?Xr.Buffer:void 0,Ca=Xr.Symbol,hn=Ua(Object.getPrototypeOf,Object),vs=ea.propertyIsEnumerable,Ja=Ca?Ca.toStringTag:void 0,bt=function(){try{var St=Wi(Object,"defineProperty");return St({},"",{}),St}catch{}}(),Tt=ls?ls.isBuffer:void 0,je=Ua(Object.keys,Object),ae=Math.max,ge=Date.now,Ee=Ca?Ca.prototype:void 0,Ne=Ee?Ee.toString:void 0;function be(St,en){var Vn=Hs(St),Zi=!Vn&&Lo(St),yr=!Vn&&!Zi&&sl(St),na=!Vn&&!Zi&&!yr&&jo(St),Ni=Vn||Zi||yr||na,Sr=Ni?Fa(St.length,String):[],ri=Sr.length;for(var zo in St)(en||tr.call(St,zo))&&!(Ni&&(zo=="length"||yr&&(zo=="offset"||zo=="parent")||na&&(zo=="buffer"||zo=="byteLength"||zo=="byteOffset")||ir(zo,ri)))&&Sr.push(zo);return Sr}function We(St,en,Vn){var Zi=St[en];(!(tr.call(St,en)&&or(Zi,Vn))||Vn===void 0&&!(en in St))&&nt(St,en,Vn)}function nt(St,en,Vn){en=="__proto__"&&bt?bt(St,en,{configurable:!0,enumerable:!0,value:Vn,writable:!0}):St[en]=Vn}function Xe(St){return St==null?St===void 0?yt:xe:Ja&&Ja in Object(St)?_r(St):rr(St)}function lt(St){return Bo(St)&&Xe(St)==j}function gt(St){if(!So(St)||Fi(St))return!1;var en=Kr(St)?al:ai;return en.test(Xi(St))}function ht(St){return Bo(St)&&ll(St.length)&&!!Mi[Xe(St)]}function Zt(St){if(!vi(St))return je(St);var en=[];for(var Vn in Object(St))tr.call(St,Vn)&&Vn!="constructor"&&en.push(Vn);return en}function vn(St){if(!So(St))return nr(St);var en=vi(St),Vn=[];for(var Zi in St)Zi=="constructor"&&(en||!tr.call(St,Zi))||Vn.push(Zi);return Vn}function _n(St,en){return Zo(Nr(St,en,us),St+"")}var zn=bt?function(St,en){return bt(St,"toString",{configurable:!0,enumerable:!1,value:cs(en),writable:!0})}:us;function ii(St){if(typeof St=="string")return St;if(Hs(St))return Ar(St,ii)+"";if(va(St))return Ne?Ne.call(St):"";var en=St+"";return en=="0"&&1/St==-1/0?"-0":en}function si(St,en,Vn,Zi){var yr=!Vn;Vn||(Vn={});for(var na=-1,Ni=en.length;++na<Ni;){var Sr=en[na],ri=Zi?Zi(Vn[Sr],St[Sr],Sr,Vn,St):void 0;ri===void 0&&(ri=St[Sr]),yr?nt(Vn,Sr,ri):We(Vn,Sr,ri)}return Vn}function gi(St){return _n(function(en,Vn){var Zi=-1,yr=Vn.length,na=yr>1?Vn[yr-1]:void 0,Ni=yr>2?Vn[2]:void 0;for(na=St.length>3&&typeof na=="function"?(yr--,na):void 0,Ni&&ki(Vn[0],Vn[1],Ni)&&(na=yr<3?void 0:na,yr=1),en=Object(en);++Zi<yr;){var Sr=Vn[Zi];Sr&&St(en,Sr,Zi,na)}return en})}function ui(St,en,Vn,Zi){return St===void 0||or(St,ea[Vn])&&!tr.call(Zi,Vn)?en:St}function Wi(St,en){var Vn=Ea(St,en);return gt(Vn)?Vn:void 0}function _r(St){var en=tr.call(St,Ja),Vn=St[Ja];try{St[Ja]=void 0;var Zi=!0}catch{}var yr=Is.call(St);return Zi&&(en?St[Ja]=Vn:delete St[Ja]),yr}function ir(St,en){var Vn=typeof St;return en=en??I,!!en&&(Vn=="number"||Vn!="symbol"&&mn.test(St))&&St>-1&&St%1==0&&St<en}function ki(St,en,Vn){if(!So(Vn))return!1;var Zi=typeof en;return(Zi=="number"?Ds(Vn)&&ir(en,Vn.length):Zi=="string"&&en in Vn)?or(Vn[en],St):!1}function Fi(St){return!!Pa&&Pa in St}function vi(St){var en=St&&St.constructor,Vn=typeof en=="function"&&en.prototype||ea;return St===Vn}function nr(St){var en=[];if(St!=null)for(var Vn in Object(St))en.push(Vn);return en}function rr(St){return Is.call(St)}function Nr(St,en,Vn){return en=ae(en===void 0?St.length-1:en,0),function(){for(var Zi=arguments,yr=-1,na=ae(Zi.length-en,0),Ni=Array(na);++yr<na;)Ni[yr]=Zi[en+yr];yr=-1;for(var Sr=Array(en+1);++yr<en;)Sr[yr]=Zi[yr];return Sr[en]=Vn(Ni),Ho(St,this,Sr)}}var Zo=hr(zn);function hr(St){var en=0,Vn=0;return function(){var Zi=ge(),yr=M-(Zi-Vn);if(Vn=Zi,yr>0){if(++en>=C)return arguments[0]}else en=0;return St.apply(void 0,arguments)}}function Xi(St){if(St!=null){try{return Go.call(St)}catch{}try{return St+""}catch{}}return""}function or(St,en){return St===en||St!==St&&en!==en}var Lo=lt(function(){return arguments}())?lt:function(St){return Bo(St)&&tr.call(St,"callee")&&!vs.call(St,"callee")},Hs=Array.isArray;function Ds(St){return St!=null&&ll(St.length)&&!Kr(St)}var sl=Tt||ic;function cr(St){if(!Bo(St))return!1;var en=Xe(St);return en==ce||en==oe||typeof St.message=="string"&&typeof St.name=="string"&&!xs(St)}function Kr(St){if(!So(St))return!1;var en=Xe(St);return en==de||en==ue||en==K||en==tt}function ll(St){return typeof St=="number"&&St>-1&&St%1==0&&St<=I}function So(St){var en=typeof St;return St!=null&&(en=="object"||en=="function")}function Bo(St){return St!=null&&typeof St=="object"}function xs(St){if(!Bo(St)||Xe(St)!=Qe)return!1;var en=hn(St);if(en===null)return!0;var Vn=tr.call(en,"constructor")&&en.constructor;return typeof Vn=="function"&&Vn instanceof Vn&&Go.call(Vn)==ta}function va(St){return typeof St=="symbol"||Bo(St)&&Xe(St)==xt}var jo=qs?Po(qs):ht;function uo(St){return St==null?"":ii(St)}var ha=gi(function(St,en,Vn,Zi){si(en,wl(en),St,Zi)});function da(St){return Ds(St)?be(St):Zt(St)}function wl(St){return Ds(St)?be(St,!0):vn(St)}function bs(St,en,Vn){var Zi=o.imports._.templateSettings||o;Vn&&ki(St,en,Vn)&&(en=void 0),St=uo(St),en=ha({},en,Zi,ui);var yr=ha({},en.imports,Zi.imports,ui),na=da(yr),Ni=bl(yr,na),Sr,ri,zo=0,hs=en.interpolate||ci,ko="__p += '",Rs=RegExp((en.escape||ci).source+"|"+hs.source+"|"+(hs===T?jn:ci).source+"|"+(en.evaluate||ci).source+"|$","g"),ws=tr.call(en,"sourceURL")?"//# sourceURL="+(en.sourceURL+"").replace(/[\r\n]/g," ")+`
`:"";St.replace(Rs,function(No,Oa,Ts,Va,$a,Tl){return Ts||(Ts=Va),ko+=St.slice(zo,Tl).replace(Ii,ro),Oa&&(Sr=!0,ko+=`' +
__e(`+Oa+`) +
'`),$a&&(ri=!0,ko+=`';
`+$a+`;
__p += '`),Ts&&(ko+=`' +
((__t = (`+Ts+`)) == null ? '' : __t) +
'`),zo=Tl+No.length,No}),ko+=`';
`;var Qa=tr.call(en,"variable")&&en.variable;Qa||(ko=`with (obj) {
`+ko+`
}
`),ko=(ri?ko.replace(kt,""):ko).replace(In,"$1").replace(ti,"$1;"),ko="function("+(Qa||"obj")+`) {
`+(Qa?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Sr?", __e = _.escape":"")+(ri?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ko+`return __p
}`;var Ma=Gs(function(){return Function(na,ws+"return "+ko).apply(void 0,Ni)});if(Ma.source=ko,cr(Ma))throw Ma;return Ma}var Gs=_n(function(St,en){try{return Ho(St,void 0,en)}catch(Vn){return cr(Vn)?Vn:new Error(Vn)}});function cs(St){return function(){return St}}function us(St){return St}function ic(){return!1}s.exports=bs}).call(this)}).call(this,typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":9,"lodash.templatesettings":13}],13:[function(i,s,f){(function(y){(function(){var T=i("lodash._reinterpolate"),o="[object Symbol]",C=/[&<>"'`]/g,M=RegExp(C.source),I=/<%-([\s\S]+?)%>/g,j=/<%([\s\S]+?)%>/g,q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},K=typeof y=="object"&&y&&y.Object===Object&&y,J=typeof self=="object"&&self&&self.Object===Object&&self,te=K||J||Function("return this")();function oe(yt){return function(ot){return yt?.[ot]}}var ce=oe(q),de=Object.prototype,ue=de.toString,Pe=te.Symbol,Oe=Pe?Pe.prototype:void 0,xe=Oe?Oe.toString:void 0,Qe={escape:I,evaluate:j,interpolate:T,variable:"",imports:{_:{escape:xt}}};function tt(yt){if(typeof yt=="string")return yt;if(Je(yt))return xe?xe.call(yt):"";var ot=yt+"";return ot=="0"&&1/yt==-1/0?"-0":ot}function Ge(yt){return!!yt&&typeof yt=="object"}function Je(yt){return typeof yt=="symbol"||Ge(yt)&&ue.call(yt)==o}function Ve(yt){return yt==null?"":tt(yt)}function xt(yt){return yt=Ve(yt),yt&&M.test(yt)?yt.replace(C,ce):yt}s.exports=Qe}).call(this)}).call(this,typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":9}],14:[function(i,s,f){const y=i("is-plain-obj"),{hasOwnProperty:T}=Object.prototype,{propertyIsEnumerable:o}=Object,C=(de,ue,Pe)=>Object.defineProperty(de,ue,{value:Pe,writable:!0,enumerable:!0,configurable:!0}),M=this,I={concatArrays:!1,ignoreUndefined:!1},j=de=>{const ue=[];for(const Pe in de)T.call(de,Pe)&&ue.push(Pe);if(Object.getOwnPropertySymbols){const Pe=Object.getOwnPropertySymbols(de);for(const Oe of Pe)o.call(de,Oe)&&ue.push(Oe)}return ue};function q(de){return Array.isArray(de)?K(de):y(de)?J(de):de}function K(de){const ue=de.slice(0,0);return j(de).forEach(Pe=>{C(ue,Pe,q(de[Pe]))}),ue}function J(de){const ue=Object.getPrototypeOf(de)===null?Object.create(null):{};return j(de).forEach(Pe=>{C(ue,Pe,q(de[Pe]))}),ue}const te=(de,ue,Pe,Oe)=>(Pe.forEach(xe=>{typeof ue[xe]>"u"&&Oe.ignoreUndefined||(xe in de&&de[xe]!==Object.getPrototypeOf(de)?C(de,xe,ce(de[xe],ue[xe],Oe)):C(de,xe,q(ue[xe])))}),de),oe=(de,ue,Pe)=>{let Oe=de.slice(0,0),xe=0;return[de,ue].forEach(Qe=>{const tt=[];for(let Ge=0;Ge<Qe.length;Ge++)T.call(Qe,Ge)&&(tt.push(String(Ge)),Qe===de?C(Oe,xe++,Qe[Ge]):C(Oe,xe++,q(Qe[Ge])));Oe=te(Oe,Qe,j(Qe).filter(Ge=>!tt.includes(Ge)),Pe)}),Oe};function ce(de,ue,Pe){return Pe.concatArrays&&Array.isArray(de)&&Array.isArray(ue)?oe(de,ue,Pe):!y(ue)||!y(de)?q(ue):te(de,ue,j(ue),Pe)}s.exports=function(...de){const ue=ce(q(I),this!==M&&this||{},I);let Pe={_:{}};for(const Oe of de)if(Oe!==void 0){if(!y(Oe))throw new TypeError("`"+Oe+"` is not an Option Object");Pe=ce(Pe,{_:Oe},ue)}return Pe._}},{"is-plain-obj":15}],15:[function(i,s,f){s.exports=y=>{if(Object.prototype.toString.call(y)!=="[object Object]")return!1;const T=Object.getPrototypeOf(y);return T===null||T===Object.prototype}},{}],16:[function(i,s,f){var y=s.exports={},T,o;function C(){throw new Error("setTimeout has not been defined")}function M(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?T=setTimeout:T=C}catch{T=C}try{typeof clearTimeout=="function"?o=clearTimeout:o=M}catch{o=M}})();function I(Pe){if(T===setTimeout)return setTimeout(Pe,0);if((T===C||!T)&&setTimeout)return T=setTimeout,setTimeout(Pe,0);try{return T(Pe,0)}catch{try{return T.call(null,Pe,0)}catch{return T.call(this,Pe,0)}}}function j(Pe){if(o===clearTimeout)return clearTimeout(Pe);if((o===M||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(Pe);try{return o(Pe)}catch{try{return o.call(null,Pe)}catch{return o.call(this,Pe)}}}var q=[],K=!1,J,te=-1;function oe(){!K||!J||(K=!1,J.length?q=J.concat(q):te=-1,q.length&&ce())}function ce(){if(!K){var Pe=I(oe);K=!0;for(var Oe=q.length;Oe;){for(J=q,q=[];++te<Oe;)J&&J[te].run();te=-1,Oe=q.length}J=null,K=!1,j(Pe)}}y.nextTick=function(Pe){var Oe=new Array(arguments.length-1);if(arguments.length>1)for(var xe=1;xe<arguments.length;xe++)Oe[xe-1]=arguments[xe];q.push(new de(Pe,Oe)),q.length===1&&!K&&I(ce)};function de(Pe,Oe){this.fun=Pe,this.array=Oe}de.prototype.run=function(){this.fun.apply(null,this.array)},y.title="browser",y.browser=!0,y.env={},y.argv=[],y.version="",y.versions={};function ue(){}y.on=ue,y.addListener=ue,y.once=ue,y.off=ue,y.removeListener=ue,y.removeAllListeners=ue,y.emit=ue,y.prependListener=ue,y.prependOnceListener=ue,y.listeners=function(Pe){return[]},y.binding=function(Pe){throw new Error("process.binding is not supported")},y.cwd=function(){return"/"},y.chdir=function(Pe){throw new Error("process.chdir is not supported")},y.umask=function(){return 0}},{}],17:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;function y(C){var M=function(j){var q=j.dispatch,K=j.getState;return function(J){return function(te){return typeof te=="function"?te(q,K,C):J(te)}}};return M}var T=y();T.withExtraArgument=y;var o=T;f.default=o},{}],18:[function(i,s,f){(function(y){(function(){Object.defineProperty(f,"__esModule",{value:!0});var T=i("@babel/runtime/helpers/objectSpread2");function o(ot){return ot&&typeof ot=="object"&&"default"in ot?ot:{default:ot}}var C=o(T);function M(ot){return"Minified Redux error #"+ot+"; visit https://redux.js.org/Errors?code="+ot+" for the full message or use the non-minified dev environment for full errors. "}var I=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),j=function(){return Math.random().toString(36).substring(7).split("").join(".")},q={INIT:"@@redux/INIT"+j(),REPLACE:"@@redux/REPLACE"+j(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+j()}};function K(ot){if(typeof ot!="object"||ot===null)return!1;for(var zt=ot;Object.getPrototypeOf(zt)!==null;)zt=Object.getPrototypeOf(zt);return Object.getPrototypeOf(ot)===zt}function J(ot){if(ot===void 0)return"undefined";if(ot===null)return"null";var zt=typeof ot;switch(zt){case"boolean":case"string":case"number":case"symbol":case"function":return zt}if(Array.isArray(ot))return"array";if(ce(ot))return"date";if(oe(ot))return"error";var rt=te(ot);switch(rt){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return rt}return zt.slice(8,-1).toLowerCase().replace(/\s/g,"")}function te(ot){return typeof ot.constructor=="function"?ot.constructor.name:null}function oe(ot){return ot instanceof Error||typeof ot.message=="string"&&ot.constructor&&typeof ot.constructor.stackTraceLimit=="number"}function ce(ot){return ot instanceof Date?!0:typeof ot.toDateString=="function"&&typeof ot.getDate=="function"&&typeof ot.setDate=="function"}function de(ot){var zt=typeof ot;return y.env.NODE_ENV!=="production"&&(zt=J(ot)),zt}function ue(ot,zt,rt){var Bt;if(typeof zt=="function"&&typeof rt=="function"||typeof rt=="function"&&typeof arguments[3]=="function")throw new Error(y.env.NODE_ENV==="production"?M(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if(typeof zt=="function"&&typeof rt>"u"&&(rt=zt,zt=void 0),typeof rt<"u"){if(typeof rt!="function")throw new Error(y.env.NODE_ENV==="production"?M(1):"Expected the enhancer to be a function. Instead, received: '"+de(rt)+"'");return rt(ue)(ot,zt)}if(typeof ot!="function")throw new Error(y.env.NODE_ENV==="production"?M(2):"Expected the root reducer to be a function. Instead, received: '"+de(ot)+"'");var Vt=ot,Ln=zt,$e=[],Pt=$e,$t=!1;function on(){Pt===$e&&(Pt=$e.slice())}function An(){if($t)throw new Error(y.env.NODE_ENV==="production"?M(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return Ln}function ct(Dt){if(typeof Dt!="function")throw new Error(y.env.NODE_ENV==="production"?M(4):"Expected the listener to be a function. Instead, received: '"+de(Dt)+"'");if($t)throw new Error(y.env.NODE_ENV==="production"?M(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");var jn=!0;return on(),Pt.push(Dt),function(){if(jn){if($t)throw new Error(y.env.NODE_ENV==="production"?M(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");jn=!1,on();var mn=Pt.indexOf(Dt);Pt.splice(mn,1),$e=null}}}function kt(Dt){if(!K(Dt))throw new Error(y.env.NODE_ENV==="production"?M(7):"Actions must be plain objects. Instead, the actual type was: '"+de(Dt)+"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.");if(typeof Dt.type>"u")throw new Error(y.env.NODE_ENV==="production"?M(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if($t)throw new Error(y.env.NODE_ENV==="production"?M(9):"Reducers may not dispatch actions.");try{$t=!0,Ln=Vt(Ln,Dt)}finally{$t=!1}for(var jn=$e=Pt,ai=0;ai<jn.length;ai++){var mn=jn[ai];mn()}return Dt}function In(Dt){if(typeof Dt!="function")throw new Error(y.env.NODE_ENV==="production"?M(10):"Expected the nextReducer to be a function. Instead, received: '"+de(Dt));Vt=Dt,kt({type:q.REPLACE})}function ti(){var Dt,jn=ct;return Dt={subscribe:function(mn){if(typeof mn!="object"||mn===null)throw new Error(y.env.NODE_ENV==="production"?M(11):"Expected the observer to be an object. Instead, received: '"+de(mn)+"'");function ci(){mn.next&&mn.next(An())}ci();var Ii=jn(ci);return{unsubscribe:Ii}}},Dt[I]=function(){return this},Dt}return kt({type:q.INIT}),Bt={dispatch:kt,subscribe:ct,getState:An,replaceReducer:In},Bt[I]=ti,Bt}var Pe=ue;function Oe(ot){typeof console<"u"&&typeof console.error=="function"&&console.error(ot);try{throw new Error(ot)}catch{}}function xe(ot,zt,rt,Bt){var Vt=Object.keys(zt),Ln=rt&&rt.type===q.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(Vt.length===0)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!K(ot))return"The "+Ln+' has unexpected type of "'+de(ot)+'". Expected argument to be an object with the following '+('keys: "'+Vt.join('", "')+'"');var $e=Object.keys(ot).filter(function(Pt){return!zt.hasOwnProperty(Pt)&&!Bt[Pt]});if($e.forEach(function(Pt){Bt[Pt]=!0}),!(rt&&rt.type===q.REPLACE)&&$e.length>0)return"Unexpected "+($e.length>1?"keys":"key")+" "+('"'+$e.join('", "')+'" found in '+Ln+". ")+"Expected to find one of the known reducer keys instead: "+('"'+Vt.join('", "')+'". Unexpected keys will be ignored.')}function Qe(ot){Object.keys(ot).forEach(function(zt){var rt=ot[zt],Bt=rt(void 0,{type:q.INIT});if(typeof Bt>"u")throw new Error(y.env.NODE_ENV==="production"?M(12):'The slice reducer for key "'+zt+`" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);if(typeof rt(void 0,{type:q.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(y.env.NODE_ENV==="production"?M(13):'The slice reducer for key "'+zt+'" returned undefined when probed with a random type. '+("Don't try to handle '"+q.INIT+`' or other actions in "redux/*" `)+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.")})}function tt(ot){for(var zt=Object.keys(ot),rt={},Bt=0;Bt<zt.length;Bt++){var Vt=zt[Bt];y.env.NODE_ENV!=="production"&&typeof ot[Vt]>"u"&&Oe('No reducer provided for key "'+Vt+'"'),typeof ot[Vt]=="function"&&(rt[Vt]=ot[Vt])}var Ln=Object.keys(rt),$e;y.env.NODE_ENV!=="production"&&($e={});var Pt;try{Qe(rt)}catch($t){Pt=$t}return function(on,An){if(on===void 0&&(on={}),Pt)throw Pt;if(y.env.NODE_ENV!=="production"){var ct=xe(on,rt,An,$e);ct&&Oe(ct)}for(var kt=!1,In={},ti=0;ti<Ln.length;ti++){var Dt=Ln[ti],jn=rt[Dt],ai=on[Dt],mn=jn(ai,An);if(typeof mn>"u"){var ci=An&&An.type;throw new Error(y.env.NODE_ENV==="production"?M(14):"When called with an action of type "+(ci?'"'+String(ci)+'"':"(unknown type)")+', the slice reducer for key "'+Dt+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.')}In[Dt]=mn,kt=kt||mn!==ai}return kt=kt||Ln.length!==Object.keys(on).length,kt?In:on}}function Ge(ot,zt){return function(){return zt(ot.apply(this,arguments))}}function Je(ot,zt){if(typeof ot=="function")return Ge(ot,zt);if(typeof ot!="object"||ot===null)throw new Error(y.env.NODE_ENV==="production"?M(16):"bindActionCreators expected an object or a function, but instead received: '"+de(ot)+`'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?`);var rt={};for(var Bt in ot){var Vt=ot[Bt];typeof Vt=="function"&&(rt[Bt]=Ge(Vt,zt))}return rt}function Ve(){for(var ot=arguments.length,zt=new Array(ot),rt=0;rt<ot;rt++)zt[rt]=arguments[rt];return zt.length===0?function(Bt){return Bt}:zt.length===1?zt[0]:zt.reduce(function(Bt,Vt){return function(){return Bt(Vt.apply(void 0,arguments))}})}function xt(){for(var ot=arguments.length,zt=new Array(ot),rt=0;rt<ot;rt++)zt[rt]=arguments[rt];return function(Bt){return function(){var Vt=Bt.apply(void 0,arguments),Ln=function(){throw new Error(y.env.NODE_ENV==="production"?M(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},$e={getState:Vt.getState,dispatch:function(){return Ln.apply(void 0,arguments)}},Pt=zt.map(function($t){return $t($e)});return Ln=Ve.apply(void 0,Pt)(Vt.dispatch),C.default(C.default({},Vt),{},{dispatch:Ln})}}}function yt(){}y.env.NODE_ENV!=="production"&&typeof yt.name=="string"&&yt.name!=="isCrushed"&&Oe('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.'),f.__DO_NOT_USE__ActionTypes=q,f.applyMiddleware=xt,f.bindActionCreators=Je,f.combineReducers=tt,f.compose=Ve,f.createStore=ue,f.legacy_createStore=Pe}).call(this)}).call(this,i("_process"))},{"@babel/runtime/helpers/objectSpread2":2,_process:16}],19:[function(i,s,f){var y=i("./src/suggestions");s.exports=y,typeof window<"u"&&(window.Suggestions=y)},{"./src/suggestions":21}],20:[function(i,s,f){var y=function(T){return this.component=T,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,T.el.parentNode.insertBefore(this.wrapper,T.el.nextSibling),this};y.prototype.show=function(){this.element.style.display="block"},y.prototype.hide=function(){this.element.style.display="none"},y.prototype.add=function(T){this.items.push(T)},y.prototype.clear=function(){this.items=[],this.active=0},y.prototype.isEmpty=function(){return!this.items.length},y.prototype.isVisible=function(){return this.element.style.display==="block"},y.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var T=0;T<this.items.length;T++)this.drawItem(this.items[T],this.active===T);this.show()},y.prototype.drawItem=function(T,o){var C=document.createElement("li"),M=document.createElement("a");o&&(C.className+=" active"),M.innerHTML=T.string,C.appendChild(M),this.element.appendChild(C),C.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),C.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,T)}).bind(this))},y.prototype.handleMouseUp=function(T){this.selectingListItem=!1,this.component.value(T.original),this.clear(),this.draw()},y.prototype.move=function(T){this.active=T,this.draw()},y.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)},y.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},y.prototype.drawError=function(T){var o=document.createElement("li");o.innerHTML=T,this.element.appendChild(o),this.show()},s.exports=y},{}],21:[function(i,s,f){var y=i("xtend"),T=i("fuzzy"),o=i("./list"),C=function(M,I,j){return j=j||{},this.options=y({minLength:2,limit:5,filter:!0,hideOnBlur:!0},j),this.el=M,this.data=I||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(q){this.handleKeyUp(q.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(q){this.handleKeyDown(q)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(q){this.handlePaste(q)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};C.prototype.handleKeyUp=function(M){M===40||M===38||M===27||M===13||M===9||this.handleInputChange(this.el.value)},C.prototype.handleKeyDown=function(M){switch(M.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&M.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},C.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},C.prototype.handlePaste=function(M){if(M.clipboardData)this.handleInputChange(M.clipboardData.getData("Text"));else{var I=this;setTimeout(function(){I.handleInputChange(M.target.value)},100)}},C.prototype.handleInputChange=function(M){if(this.query=this.normalize(M),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(I){for(var j=0;j<I.length&&(this.list.add(I[j]),j!==this.options.limit-1);j++);this.list.draw()}).bind(this))},C.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},C.prototype.update=function(M){this.data=M,this.handleKeyUp()},C.prototype.clear=function(){this.data=[],this.list.clear()},C.prototype.normalize=function(M){return M=M.toLowerCase(),M},C.prototype.match=function(M,I){return M.indexOf(I)>-1},C.prototype.value=function(M){if(this.selected=M,this.el.value=this.getItemValue(M),document.createEvent){var I=document.createEvent("HTMLEvents");I.initEvent("change",!0,!1),this.el.dispatchEvent(I)}else this.el.fireEvent("onchange")},C.prototype.getCandidates=function(M){var I={pre:"<strong>",post:"</strong>",extract:(function(q){return this.getItemValue(q)}).bind(this)},j;this.options.filter?(j=T.filter(this.query,this.data,I),j=j.map((function(q){return{original:q.original,string:this.render(q.original,q.string)}}).bind(this))):j=this.data.map((function(q){var K=this.render(q);return{original:q,string:K}}).bind(this)),M(j)},C.prototype.getItemValue=function(M){return M},C.prototype.render=function(M,I){if(I)return I;for(var j=M.original?this.getItemValue(M.original):this.getItemValue(M),q=this.normalize(j),K=q.lastIndexOf(this.query);K>-1;){var J=K+this.query.length;j=j.slice(0,K)+"<strong>"+j.slice(K,J)+"</strong>"+j.slice(J),K=q.slice(0,K).lastIndexOf(this.query)}return j},C.prototype.renderError=function(M){this.list.drawError(M)},s.exports=C},{"./list":20,fuzzy:8,xtend:24}],22:[function(i,s,f){var y=i("turf-meta").coordEach;s.exports=function(T){var o=[1/0,1/0,-1/0,-1/0];return y(T,function(C){o[0]>C[0]&&(o[0]=C[0]),o[1]>C[1]&&(o[1]=C[1]),o[2]<C[0]&&(o[2]=C[0]),o[3]<C[1]&&(o[3]=C[1])}),o}},{"turf-meta":23}],23:[function(i,s,f){function y(M,I,j){var q,K,J,te,oe,ce,de,ue,Pe=0,Oe,xe=M.type==="FeatureCollection",Qe=M.type==="Feature",tt=xe?M.features.length:1;for(q=0;q<tt;q++)for(ue=xe?M.features[q].geometry:Qe?M.geometry:M,Oe=ue.type==="GeometryCollection",ce=Oe?ue.geometries.length:1,te=0;te<ce;te++)if(oe=Oe?ue.geometries[te]:ue,de=oe.coordinates,Pe=j&&(oe.type==="Polygon"||oe.type==="MultiPolygon")?1:0,oe.type==="Point")I(de);else if(oe.type==="LineString"||oe.type==="MultiPoint")for(K=0;K<de.length;K++)I(de[K]);else if(oe.type==="Polygon"||oe.type==="MultiLineString")for(K=0;K<de.length;K++)for(J=0;J<de[K].length-Pe;J++)I(de[K][J]);else if(oe.type==="MultiPolygon")for(K=0;K<de.length;K++)for(J=0;J<de[K].length;J++)for(l=0;l<de[K][J].length-Pe;l++)I(de[K][J][l]);else throw new Error("Unknown Geometry Type")}s.exports.coordEach=y;function T(M,I,j,q){return y(M,function(K){j=I(j,K)},q),j}s.exports.coordReduce=T;function o(M,I){var j;switch(M.type){case"FeatureCollection":for(features=M.features,j=0;j<M.features.length;j++)I(M.features[j].properties);break;case"Feature":I(M.properties);break}}s.exports.propEach=o;function C(M,I,j){return o(M,function(q){j=I(j,q)}),j}s.exports.propReduce=C},{}],24:[function(i,s,f){s.exports=T;var y=Object.prototype.hasOwnProperty;function T(){for(var o={},C=0;C<arguments.length;C++){var M=arguments[C];for(var I in M)y.call(M,I)&&(o[I]=M[I])}return o}},{}],25:[function(i,s,f){function y(ct){"@babel/helpers - typeof";return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(kt){return typeof kt}:function(kt){return kt&&typeof Symbol=="function"&&kt.constructor===Symbol&&kt!==Symbol.prototype?"symbol":typeof kt},y(ct)}Object.defineProperty(f,"__esModule",{value:!0}),f.addWaypoint=$e,f.clearDestination=Je,f.clearOrigin=Ge,f.createDestination=zt,f.createOrigin=ot,f.eventEmit=An,f.eventSubscribe=on,f.hoverMarker=xt,f.queryDestination=xe,f.queryDestinationCoordinates=tt,f.queryOrigin=Oe,f.queryOriginCoordinates=Qe,f.removeWaypoint=$t,f.reverse=Bt,f.setDestinationFromCoordinates=Ln,f.setOptions=Ve,f.setOriginFromCoordinates=Vt,f.setProfile=rt,f.setRouteIndex=yt,f.setWaypoint=Pt;var T=I(i("../constants/action_types")),o=C(i("../utils"));function C(ct){return ct&&ct.__esModule?ct:{default:ct}}function M(ct){if(typeof WeakMap!="function")return null;var kt=new WeakMap,In=new WeakMap;return(M=function(Dt){return Dt?In:kt})(ct)}function I(ct,kt){if(ct&&ct.__esModule)return ct;if(ct===null||y(ct)!=="object"&&typeof ct!="function")return{default:ct};var In=M(kt);if(In&&In.has(ct))return In.get(ct);var ti={},Dt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var jn in ct)if(jn!=="default"&&Object.prototype.hasOwnProperty.call(ct,jn)){var ai=Dt?Object.getOwnPropertyDescriptor(ct,jn):null;ai&&(ai.get||ai.set)?Object.defineProperty(ti,jn,ai):ti[jn]=ct[jn]}return ti.default=ct,In&&In.set(ct,ti),ti}function j(ct){return function(kt){var In=o.default.createPoint(ct,{id:"origin","marker-symbol":"A"});kt({type:T.ORIGIN,origin:In}),kt(An("origin",{feature:In}))}}function q(ct){return function(kt){var In=o.default.createPoint(ct,{id:"destination","marker-symbol":"B"});kt({type:T.DESTINATION,destination:In}),kt(An("destination",{feature:In}))}}function K(ct){return function(kt){kt({type:T.DIRECTIONS_REQUEST_START,request:ct})}}function J(ct){return function(kt){kt({type:T.DIRECTIONS,directions:ct}),kt(An("route",{route:ct}))}}function te(ct){return{type:T.WAYPOINTS,waypoints:ct}}function oe(ct){return{type:T.HOVER_MARKER,hoverMarker:ct}}function ce(){return function(ct,kt){var In=kt(),ti=In.api,Dt=In.accessToken,jn=In.routeIndex,ai=In.profile,mn=In.alternatives,ci=In.congestion,Ii=In.destination,Mi=In.language,Tr=In.exclude,kr=In.fetchDirectionsRequest;if(Ii&&Ii.geometry){kr&&kr.abort();var ja=de(kt),Xr=[];Xr.push("geometries=polyline"),mn&&Xr.push("alternatives=true"),ci&&Xr.push("annotations=congestion"),Xr.push("steps=true"),Xr.push("overview=full"),Mi&&Xr.push("language="+Mi),Tr&&Xr.push("exclude="+Tr),Dt&&Xr.push("access_token="+Dt);var Yr=new XMLHttpRequest;Yr.open("GET","".concat(ti).concat(ai,"/").concat(ja,".json?").concat(Xr.join("&")),!0),ct(K(Yr)),Yr.onload=function(){if(Yr.status>=200&&Yr.status<400){var go=JSON.parse(Yr.responseText);if(go.error)return ct(J([])),ct(Pe(go.error));if(go.message==="No route found")return ct(Pe("No route found"));ct(Pe(null)),go.routes[jn]||ct(yt(0)),ct(J(go.routes)),ct(j(go.waypoints[0].location)),ct(q(go.waypoints[go.waypoints.length-1].location))}else return ct(J([])),ct(Pe(JSON.parse(Yr.responseText).message))},Yr.onerror=function(){return ct(J([])),Yr.responseText?ct(Pe(JSON.parse(Yr.responseText).message)):ct(Pe("Error"))},Yr.send()}}}function de(ct){var kt=ct(),In=kt.origin,ti=kt.destination,Dt=kt.waypoints,jn=[];return jn.push(In.geometry.coordinates.join(",")),jn.push(";"),Dt.length&&Dt.forEach(function(ai){jn.push(ai.geometry.coordinates.join(",")),jn.push(";")}),jn.push(ti.geometry.coordinates.join(",")),encodeURIComponent(jn.join(""))}function ue(ct){var kt={id:"waypoint"};return Object.assign(ct,{properties:ct.properties?Object.assign(ct.properties,kt):kt})}function Pe(ct){return function(kt){kt({type:"ERROR",error:ct}),ct&&kt(An("error",{error:ct}))}}function Oe(ct){return{type:T.ORIGIN_QUERY,query:ct}}function xe(ct){return{type:T.DESTINATION_QUERY,query:ct}}function Qe(ct){return{type:T.ORIGIN_FROM_COORDINATES,coordinates:ct}}function tt(ct){return{type:T.DESTINATION_FROM_COORDINATES,coordinates:ct}}function Ge(){return function(ct){ct({type:T.ORIGIN_CLEAR}),ct(An("clear",{type:"origin"})),ct(Pe(null))}}function Je(){return function(ct,kt){var In=kt(),ti=In.fetchDirectionsRequest;ti&&ti.abort(),ct({type:T.DESTINATION_CLEAR}),ct(An("clear",{type:"destination"})),ct(Pe(null))}}function Ve(ct){return{type:T.SET_OPTIONS,options:ct}}function xt(ct){return function(kt){var In=ct?o.default.createPoint(ct,{id:"hover"}):{};kt(oe(In))}}function yt(ct){return{type:T.ROUTE_INDEX,routeIndex:ct}}function ot(ct){return function(kt,In){var ti=In(),Dt=ti.destination;kt(j(ct)),Dt.geometry&&kt(ce())}}function zt(ct){return function(kt,In){var ti=In(),Dt=ti.origin;kt(q(ct)),Dt.geometry&&kt(ce())}}function rt(ct){return function(kt,In){var ti=In(),Dt=ti.origin,jn=ti.destination;kt({type:T.DIRECTIONS_PROFILE,profile:ct}),kt(An("profile",{profile:ct})),Dt.geometry&&jn.geometry&&kt(ce())}}function Bt(){return function(ct,kt){var In=kt();In.destination.geometry&&ct(j(In.destination.geometry.coordinates)),In.origin.geometry&&ct(q(In.origin.geometry.coordinates)),In.origin.geometry&&In.destination.geometry&&ct(ce());for(var ti=document.getElementsByClassName("suggestions"),Dt=0;Dt<ti.length;Dt++)ti[Dt].style.visibility="hidden"}}function Vt(ct){return function(kt){if(o.default.validCoords(ct)||(ct=[o.default.wrap(ct[0]),o.default.wrap(ct[1])]),isNaN(ct[0])&&isNaN(ct[1]))return kt(Pe(new Error("Coordinates are not valid")));kt(Qe(ct)),kt(ot(ct))}}function Ln(ct){return function(kt){if(o.default.validCoords(ct)||(ct=[o.default.wrap(ct[0]),o.default.wrap(ct[1])]),isNaN(ct[0])&&isNaN(ct[1]))return kt(Pe(new Error("Coordinates are not valid")));kt(zt(ct)),kt(tt(ct))}}function $e(ct,kt){return function(In,ti){var Dt=ti(),jn=Dt.destination,ai=Dt.waypoints;ai.splice(ct,0,ue(kt)),In(te(ai)),jn.geometry&&In(ce())}}function Pt(ct,kt){return function(In,ti){var Dt=ti(),jn=Dt.destination,ai=Dt.waypoints;ai[ct]=ue(kt),In(te(ai)),jn.geometry&&In(ce())}}function $t(ct){return function(kt,In){var ti=In(),Dt=ti.destination,jn=ti.waypoints;jn=jn.filter(function(ai){return!o.default.coordinateMatch(ai,ct)}),kt(te(jn)),Dt.geometry&&kt(ce())}}function on(ct,kt){return function(In,ti){var Dt=ti(),jn=Dt.events;return jn[ct]=jn[ct]||[],jn[ct].push(kt),{type:T.EVENTS,events:jn}}}function An(ct,kt){var In=this;return function(ti,Dt){var jn=Dt(),ai=jn.events;if(!ai[ct])return{type:T.EVENTS,events:ai};for(var mn=ai[ct].slice(),ci=0;ci<mn.length;ci++)mn[ci].call(In,kt)}}},{"../constants/action_types":26,"../utils":34}],26:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.WAYPOINTS=f.SET_OPTIONS=f.ROUTE_INDEX=f.ORIGIN_QUERY=f.ORIGIN_FROM_COORDINATES=f.ORIGIN_CLEAR=f.ORIGIN=f.HOVER_MARKER=f.EVENTS=f.ERROR=f.DIRECTIONS_REQUEST_START=f.DIRECTIONS_PROFILE=f.DIRECTIONS=f.DESTINATION_QUERY=f.DESTINATION_FROM_COORDINATES=f.DESTINATION_CLEAR=f.DESTINATION=void 0;var y="DESTINATION";f.DESTINATION=y;var T="DESTINATION_CLEAR";f.DESTINATION_CLEAR=T;var o="DESTINATION_QUERY";f.DESTINATION_QUERY=o;var C="DESTINATION_FROM_COORDINATES";f.DESTINATION_FROM_COORDINATES=C;var M="DIRECTIONS";f.DIRECTIONS=M;var I="DIRECTIONS_REQUEST_START";f.DIRECTIONS_REQUEST_START=I;var j="DIRECTIONS_PROFILE";f.DIRECTIONS_PROFILE=j;var q="EVENTS";f.EVENTS=q;var K="ERROR";f.ERROR=K;var J="HOVER_MARKER";f.HOVER_MARKER=J;var te="ORIGIN";f.ORIGIN=te;var oe="ORIGIN_CLEAR";f.ORIGIN_CLEAR=oe;var ce="ORIGIN_QUERY";f.ORIGIN_QUERY=ce;var de="ORIGIN_FROM_COORDINATES";f.ORIGIN_FROM_COORDINATES=de;var ue="ROUTE_INDEX";f.ROUTE_INDEX=ue;var Pe="SET_OPTIONS";f.SET_OPTIONS=Pe;var Oe="WAYPOINTS";f.WAYPOINTS=Oe},{}],27:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var y=M(i("suggestions")),T=M(i("lodash.debounce")),o=i("events"),C=M(i("../utils"));function M(ce){return ce&&ce.__esModule?ce:{default:ce}}function I(ce){"@babel/helpers - typeof";return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},I(ce)}function j(ce,de){if(!(ce instanceof de))throw new TypeError("Cannot call a class as a function")}function q(ce,de){for(var ue=0;ue<de.length;ue++){var Pe=de[ue];Pe.enumerable=Pe.enumerable||!1,Pe.configurable=!0,"value"in Pe&&(Pe.writable=!0),Object.defineProperty(ce,J(Pe.key),Pe)}}function K(ce,de,ue){return de&&q(ce.prototype,de),Object.defineProperty(ce,"prototype",{writable:!1}),ce}function J(ce){var de=te(ce,"string");return I(de)==="symbol"?de:String(de)}function te(ce,de){if(I(ce)!=="object"||ce===null)return ce;var ue=ce[Symbol.toPrimitive];if(ue!==void 0){var Pe=ue.call(ce,de);if(I(Pe)!=="object")return Pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ce)}var oe=function(){function ce(de){j(this,ce),this._ev=new o.EventEmitter,this.options=de,this.api=de&&de.api||"https://api.mapbox.com/geocoding/v5/mapbox.places/"}return K(ce,[{key:"onAdd",value:function(ue){this._map=ue,this.request=new XMLHttpRequest;var Pe=document.createElement("div");Pe.className="mapboxgl-ctrl-geocoder";var Oe=document.createElement("span");Oe.className="geocoder-icon geocoder-icon-search";var xe=this._inputEl=document.createElement("input");xe.type="text",xe.placeholder=this.options.placeholder,xe.addEventListener("keydown",(0,T.default)((function(Je){if(!Je.target.value)return this._clearEl.classList.remove("active");Je.metaKey||[9,27,37,39,13,38,40].indexOf(Je.keyCode)!==-1||this._queryFromInput(Je.target.value)}).bind(this)),200),xe.addEventListener("change",(function(Je){Je.target.value&&this._clearEl.classList.add("active");var Ve=this._typeahead.selected;if(Ve){if(this.options.flyTo)if(Ve.bbox&&Ve.context&&Ve.context.length<=3||Ve.bbox&&!Ve.context){var xt=Ve.bbox;ue.fitBounds([[xt[0],xt[1]],[xt[2],xt[3]]])}else ue.flyTo({center:Ve.center,zoom:this.options.zoom});this._input=Ve,this.fire("result",{result:Ve})}}).bind(this));var Qe=document.createElement("div");Qe.classList.add("geocoder-pin-right");var tt=this._clearEl=document.createElement("button");tt.className="geocoder-icon geocoder-icon-close",tt.addEventListener("click",this._clear.bind(this));var Ge=this._loadingEl=document.createElement("span");return Ge.className="geocoder-icon geocoder-icon-loading",Qe.appendChild(tt),Qe.appendChild(Ge),Pe.appendChild(Oe),Pe.appendChild(xe),Pe.appendChild(Qe),this.options.container&&(this.options.position=!1),this._typeahead=new y.default(xe,[],{filter:!1}),this._typeahead.getItemValue=function(Je){return Je.place_name},Pe}},{key:"_geocode",value:function(ue,Pe){this._loadingEl.classList.add("active"),this.fire("loading");var Oe=this.options,xe=["placeholder","zoom","flyTo","accessToken","api"],Qe=Object.keys(this.options).filter(function(Ge){return xe.indexOf(Ge)===-1}).map(function(Ge){return Ge+"="+Oe[Ge]}),tt=this.options.accessToken?this.options.accessToken:mapboxgl.accessToken;Qe.push("access_token="+tt),this.request.abort(),this.request.open("GET",this.api+encodeURIComponent(ue.trim())+".json?"+Qe.join("&"),!0),this.request.onload=(function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var Ge=JSON.parse(this.request.responseText);return Ge.features.length?this._clearEl.classList.add("active"):(this._clearEl.classList.remove("active"),this._typeahead.selected=null),this.fire("results",{results:Ge.features}),this._typeahead.update(Ge.features),Pe(Ge.features)}else this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.onerror=(function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.send()}},{key:"_queryFromInput",value:function(ue){ue=ue.trim(),ue||this._clear(),ue.length>2&&this._geocode(ue,(function(Pe){this._results=Pe}).bind(this))}},{key:"_change",value:function(){var ue=document.createEvent("HTMLEvents");ue.initEvent("change",!0,!1),this._inputEl.dispatchEvent(ue)}},{key:"_query",value:function(ue){ue&&(I(ue)==="object"&&ue.length&&(ue=[C.default.wrap(ue[0]),C.default.wrap(ue[1])].join()),this._geocode(ue,(function(Pe){if(Pe.length){var Oe=Pe[0];this._results=Pe,this._typeahead.selected=Oe,this._inputEl.value=Oe.place_name,this._change()}}).bind(this)))}},{key:"_setInput",value:function(ue){ue&&(I(ue)==="object"&&ue.length&&(ue=[C.default.roundWithOriginalPrecision(C.default.wrap(ue[0]),ue[0]),C.default.roundWithOriginalPrecision(C.default.wrap(ue[1]),ue[1])].join()),this._inputEl.value=ue,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())}},{key:"_clear",value:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")}},{key:"getResult",value:function(){return this._input}},{key:"query",value:function(ue){return this._query(ue),this}},{key:"setInput",value:function(ue){return this._setInput(ue),this}},{key:"on",value:function(ue,Pe){return this._ev.on(ue,Pe),this._ev.on("error",function(Oe){console.log(Oe)}),this}},{key:"fire",value:function(ue,Pe){return this._ev.emit(ue,Pe),this}},{key:"off",value:function(ue,Pe){return this._ev.removeListener(ue,Pe),this}}]),ce}();f.default=oe},{"../utils":34,events:7,"lodash.debounce":10,suggestions:19}],28:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var y=M(i("./geocoder")),T=M(i("lodash.template")),o=M(i("lodash.isequal")),C=M(i("turf-extent"));function M(de){return de&&de.__esModule?de:{default:de}}function I(de){"@babel/helpers - typeof";return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},I(de)}function j(de,ue){if(!(de instanceof ue))throw new TypeError("Cannot call a class as a function")}function q(de,ue){for(var Pe=0;Pe<ue.length;Pe++){var Oe=ue[Pe];Oe.enumerable=Oe.enumerable||!1,Oe.configurable=!0,"value"in Oe&&(Oe.writable=!0),Object.defineProperty(de,J(Oe.key),Oe)}}function K(de,ue,Pe){return ue&&q(de.prototype,ue),Object.defineProperty(de,"prototype",{writable:!1}),de}function J(de){var ue=te(de,"string");return I(ue)==="symbol"?ue:String(ue)}function te(de,ue){if(I(de)!=="object"||de===null)return de;var Pe=de[Symbol.toPrimitive];if(Pe!==void 0){var Oe=Pe.call(de,ue);if(I(Oe)!=="object")return Oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(de)}var oe=(0,T.default)(`<div class='mapbox-directions-component mapbox-directions-inputs'>
  <div class='mapbox-directions-component-keyline'>
    <div class='mapbox-directions-origin'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-depart'></span>
      </label>
      <div id='mapbox-directions-origin-input'></div>
    </div>

    <button
      class='directions-icon directions-icon-reverse directions-reverse js-reverse-inputs'
      title='Reverse origin &amp; destination'>
    </button>

    <div class='mapbox-directions-destination'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-arrive'></span>
      </label>
      <div id='mapbox-directions-destination-input'></div>
    </div>
  </div>

  <% if (controls.profileSwitcher) { %>
  <div class='mapbox-directions-profile mapbox-directions-component-keyline mapbox-directions-clearfix'><input
      id='mapbox-directions-profile-driving-traffic'
      type='radio'
      name='profile'
      value='mapbox/driving-traffic'
      <% if (profile === 'mapbox/driving-traffic') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving-traffic'>Traffic</label>
    <input
      id='mapbox-directions-profile-driving'
      type='radio'
      name='profile'
      value='mapbox/driving'
      <% if (profile === 'mapbox/driving') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving'>Driving</label>
    <input
      id='mapbox-directions-profile-walking'
      type='radio'
      name='profile'
      value='mapbox/walking'
      <% if (profile === 'mapbox/walking') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-walking'>Walking</label>
    <input
      id='mapbox-directions-profile-cycling'
      type='radio'
      name='profile'
      value='mapbox/cycling'
      <% if (profile === 'mapbox/cycling') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-cycling'>Cycling</label>
  </div>
  <% } %>
</div>
`),ce=function(){function de(ue,Pe,Oe,xe){j(this,de);var Qe=Pe.getState(),tt=Qe.originQuery,Ge=Qe.destinationQuery,Je=Qe.profile,Ve=Qe.controls;ue.innerHTML=oe({originQuery:tt,destinationQuery:Ge,profile:Je,controls:Ve}),this.container=ue,this.actions=Oe,this.store=Pe,this._map=xe,this.onAdd(),this.render()}return K(de,[{key:"animateToCoordinates",value:function(Pe,Oe){var xe=this.store.getState(),Qe=xe.origin,tt=xe.destination,Ge=xe.routePadding;if(Qe.geometry&&tt.geometry&&!(0,o.default)(Qe.geometry,tt.geometry)){var Je=(0,C.default)({type:"FeatureCollection",features:[Qe,tt]});this._map.fitBounds([[Je[0],Je[1]],[Je[2],Je[3]]],{padding:Ge})}else this._map.flyTo({center:Oe})}},{key:"onAdd",value:function(){var Pe=this,Oe=this.actions,xe=Oe.clearOrigin,Qe=Oe.clearDestination,tt=Oe.createOrigin,Ge=Oe.createDestination,Je=Oe.setProfile,Ve=Oe.reverse,xt=this.store.getState(),yt=xt.geocoder,ot=xt.accessToken,zt=xt.flyTo,rt=xt.placeholderOrigin,Bt=xt.placeholderDestination,Vt=xt.zoom;this.originInput=new y.default(Object.assign({},{accessToken:ot},yt,{flyTo:zt,placeholder:rt,zoom:Vt}));var Ln=this.originInput.onAdd(this._map),$e=this.container.querySelector("#mapbox-directions-origin-input");$e.appendChild(Ln),this.destinationInput=new y.default(Object.assign({},{accessToken:ot},yt,{flyTo:zt,placeholder:Bt,zoom:Vt}));var Pt=this.destinationInput.onAdd(this._map);this.container.querySelector("#mapbox-directions-destination-input").appendChild(Pt),this.originInput.on("result",function(on){var An=on.result.center;tt(An),Pe.animateToCoordinates("origin",An)}),this.originInput.on("clear",xe),this.destinationInput.on("result",function(on){var An=on.result.center;Ge(An),Pe.animateToCoordinates("destination",An)}),this.destinationInput.on("clear",Qe);var $t=this.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call($t,function(on){on.addEventListener("change",function(){Je(on.value)})}),this.container.querySelector(".js-reverse-inputs").addEventListener("click",function(){var on=Pe.store.getState(),An=on.origin,ct=on.destination;An&&Pe.actions.queryDestination(An.geometry.coordinates),ct&&Pe.actions.queryOrigin(ct.geometry.coordinates),Ve()})}},{key:"render",value:function(){var Pe=this;this.store.subscribe(function(){var Oe=Pe.store.getState(),xe=Oe.originQuery,Qe=Oe.destinationQuery,tt=Oe.originQueryCoordinates,Ge=Oe.destinationQueryCoordinates;xe&&(Pe.originInput.query(xe),Pe.actions.queryOrigin(null)),Qe&&(Pe.destinationInput.query(Qe),Pe.actions.queryDestination(null)),tt&&(Pe.originInput.setInput(tt),Pe.animateToCoordinates("origin",tt),Pe.actions.queryOriginCoordinates(null)),Ge&&(Pe.destinationInput.setInput(Ge),Pe.animateToCoordinates("destination",Ge),Pe.actions.queryDestinationCoordinates(null))})}}]),de}();f.default=ce},{"./geocoder":27,"lodash.isequal":11,"lodash.template":12,"turf-extent":22}],29:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var y=C(i("../utils")),T=C(i("lodash.template")),o=C(i("lodash.isequal"));function C(de){return de&&de.__esModule?de:{default:de}}function M(de){"@babel/helpers - typeof";return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},M(de)}function I(de,ue){if(!(de instanceof ue))throw new TypeError("Cannot call a class as a function")}function j(de,ue){for(var Pe=0;Pe<ue.length;Pe++){var Oe=ue[Pe];Oe.enumerable=Oe.enumerable||!1,Oe.configurable=!0,"value"in Oe&&(Oe.writable=!0),Object.defineProperty(de,K(Oe.key),Oe)}}function q(de,ue,Pe){return ue&&j(de.prototype,ue),Object.defineProperty(de,"prototype",{writable:!1}),de}function K(de){var ue=J(de,"string");return M(ue)==="symbol"?ue:String(ue)}function J(de,ue){if(M(de)!=="object"||de===null)return de;var Pe=de[Symbol.toPrimitive];if(Pe!==void 0){var Oe=Pe.call(de,ue);if(M(Oe)!=="object")return Oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(de)}var te=(0,T.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-component mapbox-directions-route-summary<% if (routes > 1) { %> mapbox-directions-multiple<% } %>'>
    <% if (routes > 1) { %>
    <div class='mapbox-directions-routes mapbox-directions-clearfix'>
      <% for (var i = 0; i < routes; i++) { %>
        <input type='radio' name='routes' id='<%= i %>' <% if (i === routeIndex) { %>checked<% } %>>
        <label for='<%= i %>' class='mapbox-directions-route'><%= i + 1 %></label>
      <% } %>
    </div>
    <% } %>
    <h1><%- duration %></h1>
    <span><%- distance %></span>
  </div>

  <div class='mapbox-directions-instructions'>
    <div class='mapbox-directions-instructions-wrapper'>
      <ol class='mapbox-directions-steps'>
        <% steps.forEach(function(step) { %>
          <%
            var distance = step.distance ? format(step.distance) : false;
            var icon = step.maneuver.modifier ? step.maneuver.modifier.replace(/\\s+/g, '-').toLowerCase() : step.maneuver.type.replace(/\\s+/g, '-').toLowerCase();

            if (['arrive', 'depart', 'waypoint'].includes(step.maneuver.type)) {
              icon = step.maneuver.type;
            }

            if (step.maneuver.type === 'roundabout' || step.maneuver.type === 'rotary') {
              icon = 'roundabout';
            }

            var lng = step.maneuver.location[0];
            var lat = step.maneuver.location[1];
          %>
          <li
            data-lat='<%= lat %>'
            data-lng='<%= lng %>'
            class='mapbox-directions-step'>
            <span class='directions-icon directions-icon-<%= icon %>'></span>
            <div class='mapbox-directions-step-maneuver'>
              <%= step.maneuver.instruction %>
            </div>
            <% if (distance) { %>
              <div class='mapbox-directions-step-distance'>
                <%= distance %>
              </div>
            <% } %>
          </li>
        <% }); %>
      </ol>
    </div>
  </div>
</div>
`),oe=(0,T.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-error'>
    <%= error %>
  </div>
</div>
`),ce=function(){function de(ue,Pe,Oe,xe){I(this,de),this.container=ue,this.actions=Oe,this.store=Pe,this._map=xe,this.directions={},this.render()}return q(de,[{key:"render",value:function(){var Pe=this;this.store.subscribe(function(){var Oe=Pe.actions,xe=Oe.hoverMarker,Qe=Oe.setRouteIndex,tt=Pe.store.getState(),Ge=tt.routeIndex,Je=tt.unit,Ve=tt.directions,xt=tt.error,yt=tt.compile,ot=tt.instructions,zt=!(0,o.default)(Ve[Ge],Pe.directions);if(xt){Pe.container.innerHTML=oe({error:xt});return}var rt=ot.showWaypointInstructions?void 0:function(Pt){return Pt.maneuver.type!=="waypoint"};if(Ve.length&&zt){var Bt=Pe.directions=Ve[Ge],Vt=y.default.getAllSteps(Bt,rt);yt&&Bt.legs.forEach(function(Pt){Pt.steps.forEach(function($t){$t.maneuver.instruction=yt("en",$t)})}),Pe.container.innerHTML=te({routeIndex:Ge,routes:Ve.length,steps:Vt,format:y.default.format[Je],duration:y.default.format.duration(Bt.duration),distance:y.default.format[Je](Bt.distance)});var Ln=Pe.container.querySelectorAll(".mapbox-directions-step");Array.prototype.forEach.call(Ln,function(Pt){var $t=Pt.getAttribute("data-lng"),on=Pt.getAttribute("data-lat");Pt.addEventListener("mouseover",function(){xe([$t,on])}),Pt.addEventListener("mouseout",function(){xe(null)}),Pt.addEventListener("click",function(){Pe._map.flyTo({center:[$t,on],zoom:16})})});var $e=Pe.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call($e,function(Pt){Pt.addEventListener("change",function($t){Qe(parseInt($t.target.id,10))})})}else Pe.container.innerHTML&&zt&&(Pe.container.innerHTML="")})}}]),de}();f.default=ce},{"../utils":34,"lodash.isequal":11,"lodash.template":12}],30:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var y=i("redux"),T=oe(i("redux-thunk")),o=i("@mapbox/polyline"),C=oe(i("./utils")),M=oe(i("./reducers")),I=te(i("./actions")),j=oe(i("./directions_style")),q=oe(i("./controls/inputs")),K=oe(i("./controls/instructions"));function J(tt){if(typeof WeakMap!="function")return null;var Ge=new WeakMap,Je=new WeakMap;return(J=function(xt){return xt?Je:Ge})(tt)}function te(tt,Ge){if(tt&&tt.__esModule)return tt;if(tt===null||ce(tt)!=="object"&&typeof tt!="function")return{default:tt};var Je=J(Ge);if(Je&&Je.has(tt))return Je.get(tt);var Ve={},xt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var yt in tt)if(yt!=="default"&&Object.prototype.hasOwnProperty.call(tt,yt)){var ot=xt?Object.getOwnPropertyDescriptor(tt,yt):null;ot&&(ot.get||ot.set)?Object.defineProperty(Ve,yt,ot):Ve[yt]=tt[yt]}return Ve.default=tt,Je&&Je.set(tt,Ve),Ve}function oe(tt){return tt&&tt.__esModule?tt:{default:tt}}function ce(tt){"@babel/helpers - typeof";return ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ge){return typeof Ge}:function(Ge){return Ge&&typeof Symbol=="function"&&Ge.constructor===Symbol&&Ge!==Symbol.prototype?"symbol":typeof Ge},ce(tt)}function de(tt,Ge){if(!(tt instanceof Ge))throw new TypeError("Cannot call a class as a function")}function ue(tt,Ge){for(var Je=0;Je<Ge.length;Je++){var Ve=Ge[Je];Ve.enumerable=Ve.enumerable||!1,Ve.configurable=!0,"value"in Ve&&(Ve.writable=!0),Object.defineProperty(tt,Oe(Ve.key),Ve)}}function Pe(tt,Ge,Je){return Ge&&ue(tt.prototype,Ge),Object.defineProperty(tt,"prototype",{writable:!1}),tt}function Oe(tt){var Ge=xe(tt,"string");return ce(Ge)==="symbol"?Ge:String(Ge)}function xe(tt,Ge){if(ce(tt)!=="object"||tt===null)return tt;var Je=tt[Symbol.toPrimitive];if(Je!==void 0){var Ve=Je.call(tt,Ge);if(ce(Ve)!=="object")return Ve;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(tt)}var Qe=function(){function tt(Ge){de(this,tt),this._directions=null,this._stateSnapshot=null,this._store=this._initStore(),this.actions=(0,y.bindActionCreators)(I,this._store.dispatch),this.actions.setOptions(Ge||{}),this.options=Ge||{},this.onDragDown=this._onDragDown.bind(this),this.onDragMove=this._onDragMove.bind(this),this.onDragUp=this._onDragUp.bind(this),this.move=this._move.bind(this),this.onClick=this._clickHandler().bind(this)}return Pe(tt,[{key:"onAdd",value:function(Je){var Ve=this;this._map=Je;var xt=this._store.getState(),yt=xt.controls,ot=this.container=document.createElement("div");ot.className="mapboxgl-ctrl-directions mapboxgl-ctrl";var zt=document.createElement("div");zt.className="directions-control directions-control-inputs",new q.default(zt,this._store,this.actions,this._map);var rt=document.createElement("div");return rt.className="directions-control directions-control-instructions",new K.default(rt,this._store,{hoverMarker:this.actions.hoverMarker,setRouteIndex:this.actions.setRouteIndex},this._map),yt.inputs&&ot.appendChild(zt),yt.instructions&&ot.appendChild(rt),this.subscribedActions(),this._map.loaded()?this.mapState():this._map.on("load",function(){return Ve.mapState()}),ot}},{key:"onRemove",value:function(Je){return this.container.parentNode.removeChild(this.container),this.removeRoutes(),Je.off("mousedown",this.onDragDown),Je.off("mousemove",this.move),Je.off("touchstart",this.onDragDown),Je.off("touchstart",this.move),Je.off("click",this.onClick),this.storeUnsubscribe&&(this.storeUnsubscribe(),delete this.storeUnsubscribe),j.default.forEach(function(Ve){Je.getLayer(Ve.id)&&Je.removeLayer(Ve.id)}),Je.getSource("directions")&&Je.removeSource("directions"),Je.getSource("directions:markers")&&Je.removeSource("directions:markers"),this._map=null,this}},{key:"mapState",value:function(){var Je=this,Ve=this._store.getState(),xt=Ve.profile;Ve.alternatives,Ve.congestion;var yt=Ve.styles,ot=Ve.interactive;Ve.compile,this.actions.eventEmit("profile",{profile:xt});var zt={type:"geojson",data:{type:"FeatureCollection",features:[]}};this._map.addSource("directions",zt),this._map.addSource("directions:markers",zt),yt&&yt.length&&yt.forEach(function(rt){return Je._map.addLayer(rt)}),j.default.forEach(function(rt){Je._map.getLayer(rt.id)||Je._map.addLayer(rt)}),ot&&(this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick),this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown))}},{key:"_areMarkersChangedOnly",value:function(Je){var Ve=this,xt=[];return this._stateSnapshot?(tt.SUBSCRIPTION_FIELDS.forEach(function(yt){Ve._stateSnapshot[yt]!==Je[yt]&&xt.push(yt)}),xt.length<=tt.MARKER_FIELDS.length&&xt.every(function(yt){return tt.MARKER_FIELDS.includes(yt)})):!1}},{key:"subscribedActions",value:function(){var Je=this;this.storeUnsubscribe=this._store.subscribe(function(){var Ve=Je._store.getState(),xt=Ve.origin,yt=Ve.destination,ot=Ve.hoverMarker,zt=Ve.directions,rt=Ve.routeIndex,Bt=Je._areMarkersChangedOnly(Ve);Je._stateSnapshot=Ve;var Vt={type:"FeatureCollection",features:[xt,yt,ot].filter(function($e){return $e.geometry})};if(Je._map.style&&Je._map.getSource("directions:markers")&&Je._map.getSource("directions:markers").setData(Vt),!Bt){var Ln={type:"FeatureCollection",features:[]};zt.length&&zt.forEach(function($e,Pt){var $t=[],on=(0,o.decode)($e.geometry,5).map(function(ct){return ct.reverse()}),An=C.default.getAllSteps($e);on.forEach(function(ct,kt){var In=$t[$t.length-1],ti=$e.legs[0].annotation&&$e.legs[0].annotation.congestion&&$e.legs[0].annotation.congestion[kt-1];if(In&&(!ti||In.properties.congestion===ti))In.geometry.coordinates.push(ct);else{var Dt={geometry:{type:"LineString",coordinates:[]},properties:{"route-index":Pt,route:Pt===rt?"selected":"alternate"}};In&&Dt.geometry.coordinates.push(In.geometry.coordinates[In.geometry.coordinates.length-1]),Dt.geometry.coordinates.push(ct),ti&&(Dt.properties.congestion=$e.legs[0].annotation.congestion[kt-1]),$t.push(Dt)}}),Ln.features=Ln.features.concat($t),Pt===rt&&An.forEach(function(ct){ct.maneuver.type==="waypoint"&&Ln.features.push({type:"Feature",geometry:{type:"Point",coordinates:ct.maneuver.location},properties:{id:"waypoint"}})})}),Je._map.style&&Je._map.getSource("directions")&&Je._map.getSource("directions").setData(Ln)}})}},{key:"_initStore",value:function(){var Je=(0,y.applyMiddleware)(T.default)(y.createStore);return Je(M.default)}},{key:"_clickHandler",value:function(){var Je=null,Ve=250;return function(xt){if(Je)clearTimeout(Je),Je=null,this._map.zoomIn();else{var yt=this._onSingleClick.bind(this);Je=setTimeout(function(){yt(xt),Je=null},Ve)}}}},{key:"_onSingleClick",value:function(Je){var Ve=this,xt=this._store.getState(),yt=xt.origin,ot=[Je.lngLat.lng,Je.lngLat.lat];if(!yt.geometry)this.actions.setOriginFromCoordinates(ot);else{var zt=this._map.queryRenderedFeatures(Je.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(zt.length){if(zt.forEach(function(Bt){Bt.layer.id==="directions-waypoint-point"&&Ve.actions.removeWaypoint(Bt)}),zt[0].properties.route==="alternate"){var rt=zt[0].properties["route-index"];this.actions.setRouteIndex(rt)}}else this.actions.setDestinationFromCoordinates(ot),this._map.flyTo({center:ot})}}},{key:"_move",value:function(Je){var Ve=this,xt=this._store.getState(),yt=xt.hoverMarker,ot=this._map.queryRenderedFeatures(Je.point,{layers:["directions-route-line-alt","directions-route-line","directions-origin-point","directions-destination-point","directions-hover-point"]});this._map.getCanvas().style.cursor=ot.length?"pointer":"",ot.length?(this.isCursorOverPoint=ot[0],this._map.dragPan.disable(),ot.forEach(function(zt){zt.layer.id==="directions-route-line"?Ve.actions.hoverMarker([Je.lngLat.lng,Je.lngLat.lat]):yt.geometry&&Ve.actions.hoverMarker(null)})):this.isCursorOverPoint&&(this.isCursorOverPoint=!1,this._map.dragPan.enable())}},{key:"_onDragDown",value:function(){this.isCursorOverPoint&&(this.isDragging=this.isCursorOverPoint,this._map.getCanvas().style.cursor="grab",this._map.on("mousemove",this.onDragMove),this._map.on("mouseup",this.onDragUp),this._map.on("touchmove",this.onDragMove),this._map.on("touchend",this.onDragUp))}},{key:"_onDragMove",value:function(Je){if(this.isDragging){var Ve=[Je.lngLat.lng,Je.lngLat.lat];switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.createOrigin(Ve);break;case"directions-destination-point":this.actions.createDestination(Ve);break;case"directions-hover-point":this.actions.hoverMarker(Ve);break}}}},{key:"_onDragUp",value:function(){if(this.isDragging){var Je=this._store.getState(),Ve=Je.hoverMarker,xt=Je.origin,yt=Je.destination;switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.setOriginFromCoordinates(xt.geometry.coordinates);break;case"directions-destination-point":this.actions.setDestinationFromCoordinates(yt.geometry.coordinates);break;case"directions-hover-point":Ve.geometry&&!C.default.coordinateMatch(this.isDragging,Ve)&&this.actions.addWaypoint(0,Ve);break}this.isDragging=!1,this._map.getCanvas().style.cursor="",this._map.off("touchmove",this.onDragMove),this._map.off("touchend",this.onDragUp),this._map.off("mousemove",this.onDragMove),this._map.off("mouseup",this.onDragUp)}}},{key:"interactive",value:function(Je){return Je?(this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown),this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick)):(this._map.off("touchstart",this.move),this._map.off("touchstart",this.onDragDown),this._map.off("mousedown",this.onDragDown),this._map.off("mousemove",this.move),this._map.off("click",this.onClick)),this}},{key:"getOrigin",value:function(){return this._store.getState().origin}},{key:"setOrigin",value:function(Je){return typeof Je=="string"?this.actions.queryOrigin(Je):this.actions.setOriginFromCoordinates(Je),this}},{key:"getDestination",value:function(){return this._store.getState().destination}},{key:"setDestination",value:function(Je){return typeof Je=="string"?this.actions.queryDestination(Je):this.actions.setDestinationFromCoordinates(Je),this}},{key:"reverse",value:function(){return this.actions.reverse(),this}},{key:"addWaypoint",value:function(Je,Ve){return Ve.type||(Ve=C.default.createPoint(Ve,{id:"waypoint"})),this.actions.addWaypoint(Je,Ve),this}},{key:"setWaypoint",value:function(Je,Ve){return Ve.type||(Ve=C.default.createPoint(Ve,{id:"waypoint"})),this.actions.setWaypoint(Je,Ve),this}},{key:"removeWaypoint",value:function(Je){var Ve=this._store.getState(),xt=Ve.waypoints;return this.actions.removeWaypoint(xt[Je]),this}},{key:"getWaypoints",value:function(){return this._store.getState().waypoints}},{key:"removeRoutes",value:function(){return this.actions.clearOrigin(),this.actions.clearDestination(),this}},{key:"on",value:function(Je,Ve){return this.actions.eventSubscribe(Je,Ve),this}}]),tt}();f.default=Qe,Qe.MARKER_FIELDS=["origin","destination","hoverMarker"],Qe.SUBSCRIPTION_FIELDS=["origin","destination","hovedMarker","directions","routeIndex"]},{"./actions":25,"./controls/inputs":28,"./controls/instructions":29,"./directions_style":31,"./reducers":33,"./utils":34,"@mapbox/polyline":6,redux:18,"redux-thunk":17}],31:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var y=[{id:"directions-route-line-alt",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#bbb","line-width":4},filter:["all",["in","$type","LineString"],["in","route","alternate"]]},{id:"directions-route-line-casing",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2d5f99","line-width":12},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-route-line",type:"line",source:"directions",layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":{property:"congestion",type:"categorical",default:"#4882c5",stops:[["unknown","#4882c5"],["low","#4882c5"],["moderate","#f09a46"],["heavy","#e34341"],["severe","#8b2342"]]},"line-width":7},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-hover-point-casing",type:"circle",source:"directions:markers",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-hover-point",type:"circle",source:"directions:markers",paint:{"circle-radius":6,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-waypoint-point-casing",type:"circle",source:"directions:markers",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-waypoint-point",type:"circle",source:"directions:markers",paint:{"circle-radius":6,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-origin-point",type:"circle",source:"directions:markers",paint:{"circle-radius":18,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-origin-label",type:"symbol",source:"directions:markers",layout:{"text-field":"A","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-destination-point",type:"circle",source:"directions:markers",paint:{"circle-radius":18,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]},{id:"directions-destination-label",type:"symbol",source:"directions:markers",layout:{"text-field":"B","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]}],T=y;f.default=T},{}],32:[function(i,s,f){var y=T(i("./directions"));function T(o){return o&&o.__esModule?o:{default:o}}s.exports=y.default},{"./directions":30}],33:[function(i,s,f){function y(J){"@babel/helpers - typeof";return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(te){return typeof te}:function(te){return te&&typeof Symbol=="function"&&te.constructor===Symbol&&te!==Symbol.prototype?"symbol":typeof te},y(J)}Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var T=I(i("../constants/action_types.js")),o=C(i("merge-options"));function C(J){return J&&J.__esModule?J:{default:J}}function M(J){if(typeof WeakMap!="function")return null;var te=new WeakMap,oe=new WeakMap;return(M=function(de){return de?oe:te})(J)}function I(J,te){if(J&&J.__esModule)return J;if(J===null||y(J)!=="object"&&typeof J!="function")return{default:J};var oe=M(te);if(oe&&oe.has(J))return oe.get(J);var ce={},de=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in J)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(J,ue)){var Pe=de?Object.getOwnPropertyDescriptor(J,ue):null;Pe&&(Pe.get||Pe.set)?Object.defineProperty(ce,ue,Pe):ce[ue]=J[ue]}return ce.default=J,oe&&oe.set(J,ce),ce}var j=function(){return{api:"https://api.mapbox.com/directions/v5/",profile:"mapbox/driving-traffic",alternatives:!1,congestion:!1,unit:"imperial",flyTo:!0,placeholderOrigin:"Choose a starting place",placeholderDestination:"Choose destination",zoom:16,language:"en",compile:null,proximity:!1,styles:[],controls:{profileSwitcher:!0,inputs:!0,instructions:!0},instructions:{showWaypointInstructions:!0},geocoder:{},interactive:!0,events:{},origin:{},destination:{},hoverMarker:{},waypoints:[],originQuery:null,destinationQuery:null,originQueryCoordinates:null,destinationQueryCoordinates:null,directions:[],fetchDirectionsRequest:null,routeIndex:0,routePadding:80}};function q(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j(),te=arguments.length>1?arguments[1]:void 0;switch(te.type){case T.SET_OPTIONS:return(0,o.default)({},J,te.options);case T.DIRECTIONS_PROFILE:return Object.assign({},J,{profile:te.profile});case T.ORIGIN:return Object.assign({},J,{origin:te.origin,hoverMarker:{}});case T.DESTINATION:return Object.assign({},J,{destination:te.destination,hoverMarker:{}});case T.HOVER_MARKER:return Object.assign({},J,{hoverMarker:te.hoverMarker});case T.WAYPOINTS:return Object.assign({},J,{waypoints:te.waypoints});case T.ORIGIN_QUERY:return Object.assign({},J,{originQuery:te.query});case T.DESTINATION_QUERY:return Object.assign({},J,{destinationQuery:te.query});case T.ORIGIN_FROM_COORDINATES:return Object.assign({},J,{originQueryCoordinates:te.coordinates});case T.DESTINATION_FROM_COORDINATES:return Object.assign({},J,{destinationQueryCoordinates:te.coordinates});case T.ORIGIN_CLEAR:return Object.assign({},J,{origin:{},originQuery:"",waypoints:[],directions:[]});case T.DESTINATION_CLEAR:return Object.assign({},J,{destination:{},destinationQuery:"",waypoints:[],directions:[]});case T.DIRECTIONS_REQUEST_START:return Object.assign({},J,{fetchDirectionsRequest:te.request});case T.DIRECTIONS:return Object.assign({},J,{directions:te.directions,fetchDirectionsRequest:null});case T.ROUTE_INDEX:return Object.assign({},J,{routeIndex:te.routeIndex});case T.ERROR:return Object.assign({},J,{error:te.error});default:return J}}var K=q;f.default=K},{"../constants/action_types.js":26,"merge-options":14}],34:[function(i,s,f){Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;function y(K){return K[0]>=-180&&K[0]<=180&&K[1]>=-90&&K[1]<=90}function T(K,J){return K=K.geometry.coordinates,J=J.geometry.coordinates,K.join()===J.join()||K[0].toFixed(3)===J[0].toFixed(3)&&K[1].toFixed(3)===J[1].toFixed(3)}function o(K){var J=360,te=((K- -180)%J+J)%J+-180;return te===-180?180:te}function C(K,J){var te=0;return Math.floor(J)!==J&&(te=J.toString().split(".")[1].length),K.toFixed(Math.min(te,5))}function M(K,J){return{type:"Feature",geometry:{type:"Point",coordinates:K},properties:J||{}}}function I(K,J){return K.legs.reduce(function(te,oe,ce){ce>0&&(te[te.length-1].maneuver.type="waypoint",oe.steps[0].maneuver.type="");var de=te.concat(oe.steps);return J?de.filter(J):de},[])}var j={duration:function(J){var te=Math.floor(J/60),oe=Math.floor(te/60);return J%=60,te%=60,oe===0&&te===0?J+"s":oe===0?te+"min":oe+"h "+te+"min"},imperial:function(J){var te=J/1609.344;return te>=100?te.toFixed(0)+"mi":te>=10?te.toFixed(1)+"mi":te>=.1?te.toFixed(2)+"mi":(te*5280).toFixed(0)+"ft"},metric:function(J){return J>=1e5?(J/1e3).toFixed(0)+"km":J>=1e4?(J/1e3).toFixed(1)+"km":J>=100?(J/1e3).toFixed(2)+"km":J.toFixed(0)+"m"}},q={format:j,coordinateMatch:T,createPoint:M,validCoords:y,wrap:o,roundWithOriginalPrecision:C,getAllSteps:I};f.default=q},{}]},{},[32])(32)})}(MA)),MA.exports}var Zfe=Gfe();const Wfe=Zu(Zfe);var b6={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},TB=yd.createContext&&yd.createContext(b6),Xfe=["attr","size","title"];function Yfe(e,t){if(e==null)return{};var i=Kfe(e,t),s,f;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(f=0;f<y.length;f++)s=y[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}function Kfe(e,t){if(e==null)return{};var i={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;i[s]=e[s]}return i}function hT(){return hT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},hT.apply(this,arguments)}function SB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),i.push.apply(i,s)}return i}function dT(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?SB(Object(i),!0).forEach(function(s){Jfe(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):SB(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Jfe(e,t,i){return t=Qfe(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Qfe(e){var t=epe(e,"string");return typeof t=="symbol"?t:t+""}function epe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w6(e){return e&&e.map((t,i)=>yd.createElement(t.tag,dT({key:i},t.attr),w6(t.child)))}function FO(e){return t=>yd.createElement(tpe,hT({attr:dT({},e.attr)},t),w6(e.child))}function tpe(e){var t=i=>{var{attr:s,size:f,title:y}=e,T=Yfe(e,Xfe),o=f||i.size||"1em",C;return i.className&&(C=i.className),e.className&&(C=(C?C+" ":"")+e.className),yd.createElement("svg",hT({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},i.attr,s,T,{className:C,style:dT(dT({color:e.color||i.color},i.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),y&&yd.createElement("title",null,y),e.children)};return TB!==void 0?yd.createElement(TB.Consumer,null,i=>t(i)):t(b6)}function npe(e){return FO({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function ipe(e){return FO({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M488 192H336v56c0 39.7-32.3 72-72 72s-72-32.3-72-72V126.4l-64.9 39C107.8 176.9 96 197.8 96 220.2v47.3l-80 46.2C.7 322.5-4.6 342.1 4.3 357.4l80 138.6c8.8 15.3 28.4 20.5 43.7 11.7L231.4 448H368c35.3 0 64-28.7 64-64h16c17.7 0 32-14.3 32-32v-64h8c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24zm147.7-37.4L555.7 16C546.9.7 527.3-4.5 512 4.3L408.6 64H306.4c-12 0-23.7 3.4-33.9 9.7L239 94.6c-9.4 5.8-15 16.1-15 27.1V248c0 22.1 17.9 40 40 40s40-17.9 40-40v-88h184c30.9 0 56 25.1 56 56v28.5l80-46.2c15.3-8.9 20.5-28.4 11.7-43.7z"},child:[]}]})(e)}function rpe(e){return FO({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C10.298 22 8.69525 21.5748 7.29229 20.8248L2 22L3.17629 16.7097C2.42562 15.3063 2 13.7028 2 12C2 6.47715 6.47715 2 12 2ZM13 7H11V14H17V12H13V7Z"},child:[]}]})(e)}function T6(e,t){return function(){return e.apply(t,arguments)}}const{toString:ope}=Object.prototype,{getPrototypeOf:UO}=Object,{iterator:c2,toStringTag:S6}=Symbol,u2=(e=>t=>{const i=ope.call(t);return e[i]||(e[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),gf=e=>(e=e.toLowerCase(),t=>u2(t)===e),h2=e=>t=>typeof t===e,{isArray:Kv}=Array,Yx=h2("undefined");function ape(e){return e!==null&&!Yx(e)&&e.constructor!==null&&!Yx(e.constructor)&&qu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const E6=gf("ArrayBuffer");function spe(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&E6(e.buffer),t}const lpe=h2("string"),qu=h2("function"),A6=h2("number"),d2=e=>e!==null&&typeof e=="object",cpe=e=>e===!0||e===!1,f1=e=>{if(u2(e)!=="object")return!1;const t=UO(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(S6 in e)&&!(c2 in e)},upe=gf("Date"),hpe=gf("File"),dpe=gf("Blob"),fpe=gf("FileList"),ppe=e=>d2(e)&&qu(e.pipe),mpe=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||qu(e.append)&&((t=u2(e))==="formdata"||t==="object"&&qu(e.toString)&&e.toString()==="[object FormData]"))},gpe=gf("URLSearchParams"),[_pe,ype,vpe,xpe]=["ReadableStream","Request","Response","Headers"].map(gf),bpe=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _b(e,t,{allOwnKeys:i=!1}={}){if(e===null||typeof e>"u")return;let s,f;if(typeof e!="object"&&(e=[e]),Kv(e))for(s=0,f=e.length;s<f;s++)t.call(null,e[s],s,e);else{const y=i?Object.getOwnPropertyNames(e):Object.keys(e),T=y.length;let o;for(s=0;s<T;s++)o=y[s],t.call(null,e[o],o,e)}}function P6(e,t){t=t.toLowerCase();const i=Object.keys(e);let s=i.length,f;for(;s-- >0;)if(f=i[s],t===f.toLowerCase())return f;return null}const Z_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,C6=e=>!Yx(e)&&e!==Z_;function tC(){const{caseless:e}=C6(this)&&this||{},t={},i=(s,f)=>{const y=e&&P6(t,f)||f;f1(t[y])&&f1(s)?t[y]=tC(t[y],s):f1(s)?t[y]=tC({},s):Kv(s)?t[y]=s.slice():t[y]=s};for(let s=0,f=arguments.length;s<f;s++)arguments[s]&&_b(arguments[s],i);return t}const wpe=(e,t,i,{allOwnKeys:s}={})=>(_b(t,(f,y)=>{i&&qu(f)?e[y]=T6(f,i):e[y]=f},{allOwnKeys:s}),e),Tpe=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Spe=(e,t,i,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),i&&Object.assign(e.prototype,i)},Epe=(e,t,i,s)=>{let f,y,T;const o={};if(t=t||{},e==null)return t;do{for(f=Object.getOwnPropertyNames(e),y=f.length;y-- >0;)T=f[y],(!s||s(T,e,t))&&!o[T]&&(t[T]=e[T],o[T]=!0);e=i!==!1&&UO(e)}while(e&&(!i||i(e,t))&&e!==Object.prototype);return t},Ape=(e,t,i)=>{e=String(e),(i===void 0||i>e.length)&&(i=e.length),i-=t.length;const s=e.indexOf(t,i);return s!==-1&&s===i},Ppe=e=>{if(!e)return null;if(Kv(e))return e;let t=e.length;if(!A6(t))return null;const i=new Array(t);for(;t-- >0;)i[t]=e[t];return i},Cpe=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&UO(Uint8Array)),Mpe=(e,t)=>{const s=(e&&e[c2]).call(e);let f;for(;(f=s.next())&&!f.done;){const y=f.value;t.call(e,y[0],y[1])}},Ope=(e,t)=>{let i;const s=[];for(;(i=e.exec(t))!==null;)s.push(i);return s},Ipe=gf("HTMLFormElement"),Dpe=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,s,f){return s.toUpperCase()+f}),EB=(({hasOwnProperty:e})=>(t,i)=>e.call(t,i))(Object.prototype),Rpe=gf("RegExp"),M6=(e,t)=>{const i=Object.getOwnPropertyDescriptors(e),s={};_b(i,(f,y)=>{let T;(T=t(f,y,e))!==!1&&(s[y]=T||f)}),Object.defineProperties(e,s)},Lpe=e=>{M6(e,(t,i)=>{if(qu(e)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const s=e[i];if(qu(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},zpe=(e,t)=>{const i={},s=f=>{f.forEach(y=>{i[y]=!0})};return Kv(e)?s(e):s(String(e).split(t)),i},kpe=()=>{},Npe=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Bpe(e){return!!(e&&qu(e.append)&&e[S6]==="FormData"&&e[c2])}const jpe=e=>{const t=new Array(10),i=(s,f)=>{if(d2(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[f]=s;const y=Kv(s)?[]:{};return _b(s,(T,o)=>{const C=i(T,f+1);!Yx(C)&&(y[o]=C)}),t[f]=void 0,y}}return s};return i(e,0)},Fpe=gf("AsyncFunction"),Upe=e=>e&&(d2(e)||qu(e))&&qu(e.then)&&qu(e.catch),O6=((e,t)=>e?setImmediate:t?((i,s)=>(Z_.addEventListener("message",({source:f,data:y})=>{f===Z_&&y===i&&s.length&&s.shift()()},!1),f=>{s.push(f),Z_.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",qu(Z_.postMessage)),Vpe=typeof queueMicrotask<"u"?queueMicrotask.bind(Z_):typeof process<"u"&&process.nextTick||O6,$pe=e=>e!=null&&qu(e[c2]),xn={isArray:Kv,isArrayBuffer:E6,isBuffer:ape,isFormData:mpe,isArrayBufferView:spe,isString:lpe,isNumber:A6,isBoolean:cpe,isObject:d2,isPlainObject:f1,isReadableStream:_pe,isRequest:ype,isResponse:vpe,isHeaders:xpe,isUndefined:Yx,isDate:upe,isFile:hpe,isBlob:dpe,isRegExp:Rpe,isFunction:qu,isStream:ppe,isURLSearchParams:gpe,isTypedArray:Cpe,isFileList:fpe,forEach:_b,merge:tC,extend:wpe,trim:bpe,stripBOM:Tpe,inherits:Spe,toFlatObject:Epe,kindOf:u2,kindOfTest:gf,endsWith:Ape,toArray:Ppe,forEachEntry:Mpe,matchAll:Ope,isHTMLForm:Ipe,hasOwnProperty:EB,hasOwnProp:EB,reduceDescriptors:M6,freezeMethods:Lpe,toObjectSet:zpe,toCamelCase:Dpe,noop:kpe,toFiniteNumber:Npe,findKey:P6,global:Z_,isContextDefined:C6,isSpecCompliantForm:Bpe,toJSONObject:jpe,isAsyncFn:Fpe,isThenable:Upe,setImmediate:O6,asap:Vpe,isIterable:$pe};function Wr(e,t,i,s,f){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),i&&(this.config=i),s&&(this.request=s),f&&(this.response=f,this.status=f.status?f.status:null)}xn.inherits(Wr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:xn.toJSONObject(this.config),code:this.code,status:this.status}}});const I6=Wr.prototype,D6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{D6[e]={value:e}});Object.defineProperties(Wr,D6);Object.defineProperty(I6,"isAxiosError",{value:!0});Wr.from=(e,t,i,s,f,y)=>{const T=Object.create(I6);return xn.toFlatObject(e,T,function(C){return C!==Error.prototype},o=>o!=="isAxiosError"),Wr.call(T,e.message,t,i,s,f),T.cause=e,T.name=e.name,y&&Object.assign(T,y),T};const qpe=null;function nC(e){return xn.isPlainObject(e)||xn.isArray(e)}function R6(e){return xn.endsWith(e,"[]")?e.slice(0,-2):e}function AB(e,t,i){return e?e.concat(t).map(function(f,y){return f=R6(f),!i&&y?"["+f+"]":f}).join(i?".":""):t}function Hpe(e){return xn.isArray(e)&&!e.some(nC)}const Gpe=xn.toFlatObject(xn,{},null,function(t){return/^is[A-Z]/.test(t)});function f2(e,t,i){if(!xn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,i=xn.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(te,oe){return!xn.isUndefined(oe[te])});const s=i.metaTokens,f=i.visitor||I,y=i.dots,T=i.indexes,C=(i.Blob||typeof Blob<"u"&&Blob)&&xn.isSpecCompliantForm(t);if(!xn.isFunction(f))throw new TypeError("visitor must be a function");function M(J){if(J===null)return"";if(xn.isDate(J))return J.toISOString();if(xn.isBoolean(J))return J.toString();if(!C&&xn.isBlob(J))throw new Wr("Blob is not supported. Use a Buffer instead.");return xn.isArrayBuffer(J)||xn.isTypedArray(J)?C&&typeof Blob=="function"?new Blob([J]):Buffer.from(J):J}function I(J,te,oe){let ce=J;if(J&&!oe&&typeof J=="object"){if(xn.endsWith(te,"{}"))te=s?te:te.slice(0,-2),J=JSON.stringify(J);else if(xn.isArray(J)&&Hpe(J)||(xn.isFileList(J)||xn.endsWith(te,"[]"))&&(ce=xn.toArray(J)))return te=R6(te),ce.forEach(function(ue,Pe){!(xn.isUndefined(ue)||ue===null)&&t.append(T===!0?AB([te],Pe,y):T===null?te:te+"[]",M(ue))}),!1}return nC(J)?!0:(t.append(AB(oe,te,y),M(J)),!1)}const j=[],q=Object.assign(Gpe,{defaultVisitor:I,convertValue:M,isVisitable:nC});function K(J,te){if(!xn.isUndefined(J)){if(j.indexOf(J)!==-1)throw Error("Circular reference detected in "+te.join("."));j.push(J),xn.forEach(J,function(ce,de){(!(xn.isUndefined(ce)||ce===null)&&f.call(t,ce,xn.isString(de)?de.trim():de,te,q))===!0&&K(ce,te?te.concat(de):[de])}),j.pop()}}if(!xn.isObject(e))throw new TypeError("data must be an object");return K(e),t}function PB(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function VO(e,t){this._pairs=[],e&&f2(e,this,t)}const L6=VO.prototype;L6.append=function(t,i){this._pairs.push([t,i])};L6.toString=function(t){const i=t?function(s){return t.call(this,s,PB)}:PB;return this._pairs.map(function(f){return i(f[0])+"="+i(f[1])},"").join("&")};function Zpe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function z6(e,t,i){if(!t)return e;const s=i&&i.encode||Zpe;xn.isFunction(i)&&(i={serialize:i});const f=i&&i.serialize;let y;if(f?y=f(t,i):y=xn.isURLSearchParams(t)?t.toString():new VO(t,i).toString(s),y){const T=e.indexOf("#");T!==-1&&(e=e.slice(0,T)),e+=(e.indexOf("?")===-1?"?":"&")+y}return e}class CB{constructor(){this.handlers=[]}use(t,i,s){return this.handlers.push({fulfilled:t,rejected:i,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){xn.forEach(this.handlers,function(s){s!==null&&t(s)})}}const k6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Wpe=typeof URLSearchParams<"u"?URLSearchParams:VO,Xpe=typeof FormData<"u"?FormData:null,Ype=typeof Blob<"u"?Blob:null,Kpe={isBrowser:!0,classes:{URLSearchParams:Wpe,FormData:Xpe,Blob:Ype},protocols:["http","https","file","blob","url","data"]},$O=typeof window<"u"&&typeof document<"u",iC=typeof navigator=="object"&&navigator||void 0,Jpe=$O&&(!iC||["ReactNative","NativeScript","NS"].indexOf(iC.product)<0),Qpe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",eme=$O&&window.location.href||"http://localhost",tme=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$O,hasStandardBrowserEnv:Jpe,hasStandardBrowserWebWorkerEnv:Qpe,navigator:iC,origin:eme},Symbol.toStringTag,{value:"Module"})),Dc={...tme,...Kpe};function nme(e,t){return f2(e,new Dc.classes.URLSearchParams,Object.assign({visitor:function(i,s,f,y){return Dc.isNode&&xn.isBuffer(i)?(this.append(s,i.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)}},t))}function ime(e){return xn.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function rme(e){const t={},i=Object.keys(e);let s;const f=i.length;let y;for(s=0;s<f;s++)y=i[s],t[y]=e[y];return t}function N6(e){function t(i,s,f,y){let T=i[y++];if(T==="__proto__")return!0;const o=Number.isFinite(+T),C=y>=i.length;return T=!T&&xn.isArray(f)?f.length:T,C?(xn.hasOwnProp(f,T)?f[T]=[f[T],s]:f[T]=s,!o):((!f[T]||!xn.isObject(f[T]))&&(f[T]=[]),t(i,s,f[T],y)&&xn.isArray(f[T])&&(f[T]=rme(f[T])),!o)}if(xn.isFormData(e)&&xn.isFunction(e.entries)){const i={};return xn.forEachEntry(e,(s,f)=>{t(ime(s),f,i,0)}),i}return null}function ome(e,t,i){if(xn.isString(e))try{return(t||JSON.parse)(e),xn.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(i||JSON.stringify)(e)}const yb={transitional:k6,adapter:["xhr","http","fetch"],transformRequest:[function(t,i){const s=i.getContentType()||"",f=s.indexOf("application/json")>-1,y=xn.isObject(t);if(y&&xn.isHTMLForm(t)&&(t=new FormData(t)),xn.isFormData(t))return f?JSON.stringify(N6(t)):t;if(xn.isArrayBuffer(t)||xn.isBuffer(t)||xn.isStream(t)||xn.isFile(t)||xn.isBlob(t)||xn.isReadableStream(t))return t;if(xn.isArrayBufferView(t))return t.buffer;if(xn.isURLSearchParams(t))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(y){if(s.indexOf("application/x-www-form-urlencoded")>-1)return nme(t,this.formSerializer).toString();if((o=xn.isFileList(t))||s.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return f2(o?{"files[]":t}:t,C&&new C,this.formSerializer)}}return y||f?(i.setContentType("application/json",!1),ome(t)):t}],transformResponse:[function(t){const i=this.transitional||yb.transitional,s=i&&i.forcedJSONParsing,f=this.responseType==="json";if(xn.isResponse(t)||xn.isReadableStream(t))return t;if(t&&xn.isString(t)&&(s&&!this.responseType||f)){const T=!(i&&i.silentJSONParsing)&&f;try{return JSON.parse(t)}catch(o){if(T)throw o.name==="SyntaxError"?Wr.from(o,Wr.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Dc.classes.FormData,Blob:Dc.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};xn.forEach(["delete","get","head","post","put","patch"],e=>{yb.headers[e]={}});const ame=xn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sme=e=>{const t={};let i,s,f;return e&&e.split(`
`).forEach(function(T){f=T.indexOf(":"),i=T.substring(0,f).trim().toLowerCase(),s=T.substring(f+1).trim(),!(!i||t[i]&&ame[i])&&(i==="set-cookie"?t[i]?t[i].push(s):t[i]=[s]:t[i]=t[i]?t[i]+", "+s:s)}),t},MB=Symbol("internals");function fx(e){return e&&String(e).trim().toLowerCase()}function p1(e){return e===!1||e==null?e:xn.isArray(e)?e.map(p1):String(e)}function lme(e){const t=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=i.exec(e);)t[s[1]]=s[2];return t}const cme=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function OA(e,t,i,s,f){if(xn.isFunction(s))return s.call(this,t,i);if(f&&(t=i),!!xn.isString(t)){if(xn.isString(s))return t.indexOf(s)!==-1;if(xn.isRegExp(s))return s.test(t)}}function ume(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,i,s)=>i.toUpperCase()+s)}function hme(e,t){const i=xn.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+i,{value:function(f,y,T){return this[s].call(this,t,f,y,T)},configurable:!0})})}let Hu=class{constructor(t){t&&this.set(t)}set(t,i,s){const f=this;function y(o,C,M){const I=fx(C);if(!I)throw new Error("header name must be a non-empty string");const j=xn.findKey(f,I);(!j||f[j]===void 0||M===!0||M===void 0&&f[j]!==!1)&&(f[j||C]=p1(o))}const T=(o,C)=>xn.forEach(o,(M,I)=>y(M,I,C));if(xn.isPlainObject(t)||t instanceof this.constructor)T(t,i);else if(xn.isString(t)&&(t=t.trim())&&!cme(t))T(sme(t),i);else if(xn.isObject(t)&&xn.isIterable(t)){let o={},C,M;for(const I of t){if(!xn.isArray(I))throw TypeError("Object iterator must return a key-value pair");o[M=I[0]]=(C=o[M])?xn.isArray(C)?[...C,I[1]]:[C,I[1]]:I[1]}T(o,i)}else t!=null&&y(i,t,s);return this}get(t,i){if(t=fx(t),t){const s=xn.findKey(this,t);if(s){const f=this[s];if(!i)return f;if(i===!0)return lme(f);if(xn.isFunction(i))return i.call(this,f,s);if(xn.isRegExp(i))return i.exec(f);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,i){if(t=fx(t),t){const s=xn.findKey(this,t);return!!(s&&this[s]!==void 0&&(!i||OA(this,this[s],s,i)))}return!1}delete(t,i){const s=this;let f=!1;function y(T){if(T=fx(T),T){const o=xn.findKey(s,T);o&&(!i||OA(s,s[o],o,i))&&(delete s[o],f=!0)}}return xn.isArray(t)?t.forEach(y):y(t),f}clear(t){const i=Object.keys(this);let s=i.length,f=!1;for(;s--;){const y=i[s];(!t||OA(this,this[y],y,t,!0))&&(delete this[y],f=!0)}return f}normalize(t){const i=this,s={};return xn.forEach(this,(f,y)=>{const T=xn.findKey(s,y);if(T){i[T]=p1(f),delete i[y];return}const o=t?ume(y):String(y).trim();o!==y&&delete i[y],i[o]=p1(f),s[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const i=Object.create(null);return xn.forEach(this,(s,f)=>{s!=null&&s!==!1&&(i[f]=t&&xn.isArray(s)?s.join(", "):s)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,i])=>t+": "+i).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...i){const s=new this(t);return i.forEach(f=>s.set(f)),s}static accessor(t){const s=(this[MB]=this[MB]={accessors:{}}).accessors,f=this.prototype;function y(T){const o=fx(T);s[o]||(hme(f,T),s[o]=!0)}return xn.isArray(t)?t.forEach(y):y(t),this}};Hu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);xn.reduceDescriptors(Hu.prototype,({value:e},t)=>{let i=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[i]=s}}});xn.freezeMethods(Hu);function IA(e,t){const i=this||yb,s=t||i,f=Hu.from(s.headers);let y=s.data;return xn.forEach(e,function(o){y=o.call(i,y,f.normalize(),t?t.status:void 0)}),f.normalize(),y}function B6(e){return!!(e&&e.__CANCEL__)}function Jv(e,t,i){Wr.call(this,e??"canceled",Wr.ERR_CANCELED,t,i),this.name="CanceledError"}xn.inherits(Jv,Wr,{__CANCEL__:!0});function j6(e,t,i){const s=i.config.validateStatus;!i.status||!s||s(i.status)?e(i):t(new Wr("Request failed with status code "+i.status,[Wr.ERR_BAD_REQUEST,Wr.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function dme(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function fme(e,t){e=e||10;const i=new Array(e),s=new Array(e);let f=0,y=0,T;return t=t!==void 0?t:1e3,function(C){const M=Date.now(),I=s[y];T||(T=M),i[f]=C,s[f]=M;let j=y,q=0;for(;j!==f;)q+=i[j++],j=j%e;if(f=(f+1)%e,f===y&&(y=(y+1)%e),M-T<t)return;const K=I&&M-I;return K?Math.round(q*1e3/K):void 0}}function pme(e,t){let i=0,s=1e3/t,f,y;const T=(M,I=Date.now())=>{i=I,f=null,y&&(clearTimeout(y),y=null),e.apply(null,M)};return[(...M)=>{const I=Date.now(),j=I-i;j>=s?T(M,I):(f=M,y||(y=setTimeout(()=>{y=null,T(f)},s-j)))},()=>f&&T(f)]}const fT=(e,t,i=3)=>{let s=0;const f=fme(50,250);return pme(y=>{const T=y.loaded,o=y.lengthComputable?y.total:void 0,C=T-s,M=f(C),I=T<=o;s=T;const j={loaded:T,total:o,progress:o?T/o:void 0,bytes:C,rate:M||void 0,estimated:M&&o&&I?(o-T)/M:void 0,event:y,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(j)},i)},OB=(e,t)=>{const i=e!=null;return[s=>t[0]({lengthComputable:i,total:e,loaded:s}),t[1]]},IB=e=>(...t)=>xn.asap(()=>e(...t)),mme=Dc.hasStandardBrowserEnv?((e,t)=>i=>(i=new URL(i,Dc.origin),e.protocol===i.protocol&&e.host===i.host&&(t||e.port===i.port)))(new URL(Dc.origin),Dc.navigator&&/(msie|trident)/i.test(Dc.navigator.userAgent)):()=>!0,gme=Dc.hasStandardBrowserEnv?{write(e,t,i,s,f,y){const T=[e+"="+encodeURIComponent(t)];xn.isNumber(i)&&T.push("expires="+new Date(i).toGMTString()),xn.isString(s)&&T.push("path="+s),xn.isString(f)&&T.push("domain="+f),y===!0&&T.push("secure"),document.cookie=T.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function _me(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function yme(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function F6(e,t,i){let s=!_me(t);return e&&(s||i==!1)?yme(e,t):t}const DB=e=>e instanceof Hu?{...e}:e;function ly(e,t){t=t||{};const i={};function s(M,I,j,q){return xn.isPlainObject(M)&&xn.isPlainObject(I)?xn.merge.call({caseless:q},M,I):xn.isPlainObject(I)?xn.merge({},I):xn.isArray(I)?I.slice():I}function f(M,I,j,q){if(xn.isUndefined(I)){if(!xn.isUndefined(M))return s(void 0,M,j,q)}else return s(M,I,j,q)}function y(M,I){if(!xn.isUndefined(I))return s(void 0,I)}function T(M,I){if(xn.isUndefined(I)){if(!xn.isUndefined(M))return s(void 0,M)}else return s(void 0,I)}function o(M,I,j){if(j in t)return s(M,I);if(j in e)return s(void 0,M)}const C={url:y,method:y,data:y,baseURL:T,transformRequest:T,transformResponse:T,paramsSerializer:T,timeout:T,timeoutMessage:T,withCredentials:T,withXSRFToken:T,adapter:T,responseType:T,xsrfCookieName:T,xsrfHeaderName:T,onUploadProgress:T,onDownloadProgress:T,decompress:T,maxContentLength:T,maxBodyLength:T,beforeRedirect:T,transport:T,httpAgent:T,httpsAgent:T,cancelToken:T,socketPath:T,responseEncoding:T,validateStatus:o,headers:(M,I,j)=>f(DB(M),DB(I),j,!0)};return xn.forEach(Object.keys(Object.assign({},e,t)),function(I){const j=C[I]||f,q=j(e[I],t[I],I);xn.isUndefined(q)&&j!==o||(i[I]=q)}),i}const U6=e=>{const t=ly({},e);let{data:i,withXSRFToken:s,xsrfHeaderName:f,xsrfCookieName:y,headers:T,auth:o}=t;t.headers=T=Hu.from(T),t.url=z6(F6(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&T.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let C;if(xn.isFormData(i)){if(Dc.hasStandardBrowserEnv||Dc.hasStandardBrowserWebWorkerEnv)T.setContentType(void 0);else if((C=T.getContentType())!==!1){const[M,...I]=C?C.split(";").map(j=>j.trim()).filter(Boolean):[];T.setContentType([M||"multipart/form-data",...I].join("; "))}}if(Dc.hasStandardBrowserEnv&&(s&&xn.isFunction(s)&&(s=s(t)),s||s!==!1&&mme(t.url))){const M=f&&y&&gme.read(y);M&&T.set(f,M)}return t},vme=typeof XMLHttpRequest<"u",xme=vme&&function(e){return new Promise(function(i,s){const f=U6(e);let y=f.data;const T=Hu.from(f.headers).normalize();let{responseType:o,onUploadProgress:C,onDownloadProgress:M}=f,I,j,q,K,J;function te(){K&&K(),J&&J(),f.cancelToken&&f.cancelToken.unsubscribe(I),f.signal&&f.signal.removeEventListener("abort",I)}let oe=new XMLHttpRequest;oe.open(f.method.toUpperCase(),f.url,!0),oe.timeout=f.timeout;function ce(){if(!oe)return;const ue=Hu.from("getAllResponseHeaders"in oe&&oe.getAllResponseHeaders()),Oe={data:!o||o==="text"||o==="json"?oe.responseText:oe.response,status:oe.status,statusText:oe.statusText,headers:ue,config:e,request:oe};j6(function(Qe){i(Qe),te()},function(Qe){s(Qe),te()},Oe),oe=null}"onloadend"in oe?oe.onloadend=ce:oe.onreadystatechange=function(){!oe||oe.readyState!==4||oe.status===0&&!(oe.responseURL&&oe.responseURL.indexOf("file:")===0)||setTimeout(ce)},oe.onabort=function(){oe&&(s(new Wr("Request aborted",Wr.ECONNABORTED,e,oe)),oe=null)},oe.onerror=function(){s(new Wr("Network Error",Wr.ERR_NETWORK,e,oe)),oe=null},oe.ontimeout=function(){let Pe=f.timeout?"timeout of "+f.timeout+"ms exceeded":"timeout exceeded";const Oe=f.transitional||k6;f.timeoutErrorMessage&&(Pe=f.timeoutErrorMessage),s(new Wr(Pe,Oe.clarifyTimeoutError?Wr.ETIMEDOUT:Wr.ECONNABORTED,e,oe)),oe=null},y===void 0&&T.setContentType(null),"setRequestHeader"in oe&&xn.forEach(T.toJSON(),function(Pe,Oe){oe.setRequestHeader(Oe,Pe)}),xn.isUndefined(f.withCredentials)||(oe.withCredentials=!!f.withCredentials),o&&o!=="json"&&(oe.responseType=f.responseType),M&&([q,J]=fT(M,!0),oe.addEventListener("progress",q)),C&&oe.upload&&([j,K]=fT(C),oe.upload.addEventListener("progress",j),oe.upload.addEventListener("loadend",K)),(f.cancelToken||f.signal)&&(I=ue=>{oe&&(s(!ue||ue.type?new Jv(null,e,oe):ue),oe.abort(),oe=null)},f.cancelToken&&f.cancelToken.subscribe(I),f.signal&&(f.signal.aborted?I():f.signal.addEventListener("abort",I)));const de=dme(f.url);if(de&&Dc.protocols.indexOf(de)===-1){s(new Wr("Unsupported protocol "+de+":",Wr.ERR_BAD_REQUEST,e));return}oe.send(y||null)})},bme=(e,t)=>{const{length:i}=e=e?e.filter(Boolean):[];if(t||i){let s=new AbortController,f;const y=function(M){if(!f){f=!0,o();const I=M instanceof Error?M:this.reason;s.abort(I instanceof Wr?I:new Jv(I instanceof Error?I.message:I))}};let T=t&&setTimeout(()=>{T=null,y(new Wr(`timeout ${t} of ms exceeded`,Wr.ETIMEDOUT))},t);const o=()=>{e&&(T&&clearTimeout(T),T=null,e.forEach(M=>{M.unsubscribe?M.unsubscribe(y):M.removeEventListener("abort",y)}),e=null)};e.forEach(M=>M.addEventListener("abort",y));const{signal:C}=s;return C.unsubscribe=()=>xn.asap(o),C}},wme=function*(e,t){let i=e.byteLength;if(i<t){yield e;return}let s=0,f;for(;s<i;)f=s+t,yield e.slice(s,f),s=f},Tme=async function*(e,t){for await(const i of Sme(e))yield*wme(i,t)},Sme=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:i,value:s}=await t.read();if(i)break;yield s}}finally{await t.cancel()}},RB=(e,t,i,s)=>{const f=Tme(e,t);let y=0,T,o=C=>{T||(T=!0,s&&s(C))};return new ReadableStream({async pull(C){try{const{done:M,value:I}=await f.next();if(M){o(),C.close();return}let j=I.byteLength;if(i){let q=y+=j;i(q)}C.enqueue(new Uint8Array(I))}catch(M){throw o(M),M}},cancel(C){return o(C),f.return()}},{highWaterMark:2})},p2=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",V6=p2&&typeof ReadableStream=="function",Eme=p2&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),$6=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Ame=V6&&$6(()=>{let e=!1;const t=new Request(Dc.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),LB=64*1024,rC=V6&&$6(()=>xn.isReadableStream(new Response("").body)),pT={stream:rC&&(e=>e.body)};p2&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!pT[t]&&(pT[t]=xn.isFunction(e[t])?i=>i[t]():(i,s)=>{throw new Wr(`Response type '${t}' is not supported`,Wr.ERR_NOT_SUPPORT,s)})})})(new Response);const Pme=async e=>{if(e==null)return 0;if(xn.isBlob(e))return e.size;if(xn.isSpecCompliantForm(e))return(await new Request(Dc.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(xn.isArrayBufferView(e)||xn.isArrayBuffer(e))return e.byteLength;if(xn.isURLSearchParams(e)&&(e=e+""),xn.isString(e))return(await Eme(e)).byteLength},Cme=async(e,t)=>{const i=xn.toFiniteNumber(e.getContentLength());return i??Pme(t)},Mme=p2&&(async e=>{let{url:t,method:i,data:s,signal:f,cancelToken:y,timeout:T,onDownloadProgress:o,onUploadProgress:C,responseType:M,headers:I,withCredentials:j="same-origin",fetchOptions:q}=U6(e);M=M?(M+"").toLowerCase():"text";let K=bme([f,y&&y.toAbortSignal()],T),J;const te=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let oe;try{if(C&&Ame&&i!=="get"&&i!=="head"&&(oe=await Cme(I,s))!==0){let Oe=new Request(t,{method:"POST",body:s,duplex:"half"}),xe;if(xn.isFormData(s)&&(xe=Oe.headers.get("content-type"))&&I.setContentType(xe),Oe.body){const[Qe,tt]=OB(oe,fT(IB(C)));s=RB(Oe.body,LB,Qe,tt)}}xn.isString(j)||(j=j?"include":"omit");const ce="credentials"in Request.prototype;J=new Request(t,{...q,signal:K,method:i.toUpperCase(),headers:I.normalize().toJSON(),body:s,duplex:"half",credentials:ce?j:void 0});let de=await fetch(J,q);const ue=rC&&(M==="stream"||M==="response");if(rC&&(o||ue&&te)){const Oe={};["status","statusText","headers"].forEach(Ge=>{Oe[Ge]=de[Ge]});const xe=xn.toFiniteNumber(de.headers.get("content-length")),[Qe,tt]=o&&OB(xe,fT(IB(o),!0))||[];de=new Response(RB(de.body,LB,Qe,()=>{tt&&tt(),te&&te()}),Oe)}M=M||"text";let Pe=await pT[xn.findKey(pT,M)||"text"](de,e);return!ue&&te&&te(),await new Promise((Oe,xe)=>{j6(Oe,xe,{data:Pe,headers:Hu.from(de.headers),status:de.status,statusText:de.statusText,config:e,request:J})})}catch(ce){throw te&&te(),ce&&ce.name==="TypeError"&&/Load failed|fetch/i.test(ce.message)?Object.assign(new Wr("Network Error",Wr.ERR_NETWORK,e,J),{cause:ce.cause||ce}):Wr.from(ce,ce&&ce.code,e,J)}}),oC={http:qpe,xhr:xme,fetch:Mme};xn.forEach(oC,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const zB=e=>`- ${e}`,Ome=e=>xn.isFunction(e)||e===null||e===!1,q6={getAdapter:e=>{e=xn.isArray(e)?e:[e];const{length:t}=e;let i,s;const f={};for(let y=0;y<t;y++){i=e[y];let T;if(s=i,!Ome(i)&&(s=oC[(T=String(i)).toLowerCase()],s===void 0))throw new Wr(`Unknown adapter '${T}'`);if(s)break;f[T||"#"+y]=s}if(!s){const y=Object.entries(f).map(([o,C])=>`adapter ${o} `+(C===!1?"is not supported by the environment":"is not available in the build"));let T=t?y.length>1?`since :
`+y.map(zB).join(`
`):" "+zB(y[0]):"as no adapter specified";throw new Wr("There is no suitable adapter to dispatch the request "+T,"ERR_NOT_SUPPORT")}return s},adapters:oC};function DA(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jv(null,e)}function kB(e){return DA(e),e.headers=Hu.from(e.headers),e.data=IA.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),q6.getAdapter(e.adapter||yb.adapter)(e).then(function(s){return DA(e),s.data=IA.call(e,e.transformResponse,s),s.headers=Hu.from(s.headers),s},function(s){return B6(s)||(DA(e),s&&s.response&&(s.response.data=IA.call(e,e.transformResponse,s.response),s.response.headers=Hu.from(s.response.headers))),Promise.reject(s)})}const H6="1.10.0",m2={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{m2[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const NB={};m2.transitional=function(t,i,s){function f(y,T){return"[Axios v"+H6+"] Transitional option '"+y+"'"+T+(s?". "+s:"")}return(y,T,o)=>{if(t===!1)throw new Wr(f(T," has been removed"+(i?" in "+i:"")),Wr.ERR_DEPRECATED);return i&&!NB[T]&&(NB[T]=!0,console.warn(f(T," has been deprecated since v"+i+" and will be removed in the near future"))),t?t(y,T,o):!0}};m2.spelling=function(t){return(i,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Ime(e,t,i){if(typeof e!="object")throw new Wr("options must be an object",Wr.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let f=s.length;for(;f-- >0;){const y=s[f],T=t[y];if(T){const o=e[y],C=o===void 0||T(o,y,e);if(C!==!0)throw new Wr("option "+y+" must be "+C,Wr.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new Wr("Unknown option "+y,Wr.ERR_BAD_OPTION)}}const m1={assertOptions:Ime,validators:m2},np=m1.validators;let ny=class{constructor(t){this.defaults=t||{},this.interceptors={request:new CB,response:new CB}}async request(t,i){try{return await this._request(t,i)}catch(s){if(s instanceof Error){let f={};Error.captureStackTrace?Error.captureStackTrace(f):f=new Error;const y=f.stack?f.stack.replace(/^.+\n/,""):"";try{s.stack?y&&!String(s.stack).endsWith(y.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+y):s.stack=y}catch{}}throw s}}_request(t,i){typeof t=="string"?(i=i||{},i.url=t):i=t||{},i=ly(this.defaults,i);const{transitional:s,paramsSerializer:f,headers:y}=i;s!==void 0&&m1.assertOptions(s,{silentJSONParsing:np.transitional(np.boolean),forcedJSONParsing:np.transitional(np.boolean),clarifyTimeoutError:np.transitional(np.boolean)},!1),f!=null&&(xn.isFunction(f)?i.paramsSerializer={serialize:f}:m1.assertOptions(f,{encode:np.function,serialize:np.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),m1.assertOptions(i,{baseUrl:np.spelling("baseURL"),withXsrfToken:np.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let T=y&&xn.merge(y.common,y[i.method]);y&&xn.forEach(["delete","get","head","post","put","patch","common"],J=>{delete y[J]}),i.headers=Hu.concat(T,y);const o=[];let C=!0;this.interceptors.request.forEach(function(te){typeof te.runWhen=="function"&&te.runWhen(i)===!1||(C=C&&te.synchronous,o.unshift(te.fulfilled,te.rejected))});const M=[];this.interceptors.response.forEach(function(te){M.push(te.fulfilled,te.rejected)});let I,j=0,q;if(!C){const J=[kB.bind(this),void 0];for(J.unshift.apply(J,o),J.push.apply(J,M),q=J.length,I=Promise.resolve(i);j<q;)I=I.then(J[j++],J[j++]);return I}q=o.length;let K=i;for(j=0;j<q;){const J=o[j++],te=o[j++];try{K=J(K)}catch(oe){te.call(this,oe);break}}try{I=kB.call(this,K)}catch(J){return Promise.reject(J)}for(j=0,q=M.length;j<q;)I=I.then(M[j++],M[j++]);return I}getUri(t){t=ly(this.defaults,t);const i=F6(t.baseURL,t.url,t.allowAbsoluteUrls);return z6(i,t.params,t.paramsSerializer)}};xn.forEach(["delete","get","head","options"],function(t){ny.prototype[t]=function(i,s){return this.request(ly(s||{},{method:t,url:i,data:(s||{}).data}))}});xn.forEach(["post","put","patch"],function(t){function i(s){return function(y,T,o){return this.request(ly(o||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:y,data:T}))}}ny.prototype[t]=i(),ny.prototype[t+"Form"]=i(!0)});let Dme=class G6{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(y){i=y});const s=this;this.promise.then(f=>{if(!s._listeners)return;let y=s._listeners.length;for(;y-- >0;)s._listeners[y](f);s._listeners=null}),this.promise.then=f=>{let y;const T=new Promise(o=>{s.subscribe(o),y=o}).then(f);return T.cancel=function(){s.unsubscribe(y)},T},t(function(y,T,o){s.reason||(s.reason=new Jv(y,T,o),i(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const i=this._listeners.indexOf(t);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const t=new AbortController,i=s=>{t.abort(s)};return this.subscribe(i),t.signal.unsubscribe=()=>this.unsubscribe(i),t.signal}static source(){let t;return{token:new G6(function(f){t=f}),cancel:t}}};function Rme(e){return function(i){return e.apply(null,i)}}function Lme(e){return xn.isObject(e)&&e.isAxiosError===!0}const aC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(aC).forEach(([e,t])=>{aC[t]=e});function Z6(e){const t=new ny(e),i=T6(ny.prototype.request,t);return xn.extend(i,ny.prototype,t,{allOwnKeys:!0}),xn.extend(i,t,null,{allOwnKeys:!0}),i.create=function(f){return Z6(ly(e,f))},i}const Os=Z6(yb);Os.Axios=ny;Os.CanceledError=Jv;Os.CancelToken=Dme;Os.isCancel=B6;Os.VERSION=H6;Os.toFormData=f2;Os.AxiosError=Wr;Os.Cancel=Os.CanceledError;Os.all=function(t){return Promise.all(t)};Os.spread=Rme;Os.isAxiosError=Lme;Os.mergeConfig=ly;Os.AxiosHeaders=Hu;Os.formToJSON=e=>N6(xn.isHTMLForm(e)?new FormData(e):e);Os.getAdapter=q6.getAdapter;Os.HttpStatusCode=aC;Os.default=Os;const{Axios:Qye,AxiosError:eve,CanceledError:tve,isCancel:nve,CancelToken:ive,VERSION:rve,all:ove,Cancel:ave,isAxiosError:sve,spread:lve,toFormData:cve,AxiosHeaders:uve,HttpStatusCode:hve,formToJSON:dve,getAdapter:fve,mergeConfig:pve}=Os,fh=ie.jsx("img",{src:"../assets/den3.png",alt:"تحذير جمال",style:{width:40,height:40}}),hd="src/assets/den2.png",Cc="src/assets/den1.png",zme="pk.eyJ1IjoiYWlzaGFoMTAxIiwiYSI6ImNtY2lvampibzE3cHUybHF2czJtY2swYWwifQ.rX3EFhb68jdKgbLqd2GUuA";pd.accessToken=zme;pd.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",()=>{console.log("RTL text plugin loaded")},!0);const kme=()=>{const e=me.useRef(null),t=me.useRef(null),i=me.useRef(null),s=me.useRef(null),f=me.useRef(null),y=me.useRef(null),[T,o]=me.useState(!1),[C,M]=me.useState(!1),[I,j]=me.useState([]),[q,K]=me.useState(!1),[J,te]=me.useState(!1);me.useEffect(()=>{if(!e.current)return;t.current=new pd.Map({container:e.current,style:"mapbox://styles/aishah101/cmck36kem000u01sj152a4sn3",center:[46.6753,24.7136],zoom:6});const xe=new Wfe({accessToken:pd.accessToken,unit:"metric",profile:"mapbox/driving",interactive:!0,language:"ar"},{flyTo:!1});t.current&&!t.current.hasControl(xe)&&t.current.addControl(xe,"top-left");const Qe=document.getElementsByClassName(".directions-icon ")[0];Qe&&(Qe.style.fill="#272343 ");const tt=document.getElementsByClassName("marker-a")[0],Ge=document.getElementsByClassName("marker-b")[0];console.log("marker a :",Ge),tt&&(tt.style.display="none"),Ge&&(Ge.style.display="none");const Je=document.querySelector(".mapboxgl-ctrl-top-left"),Ve=document.getElementById("directions-panel");if(Je&&Ve){const yt=Je.querySelector(".mapboxgl-ctrl-directions");yt&&Ve.appendChild(yt)}f.current=xe;const xt=[{coordinates:[46.5,24.7],message:"تحذير: عبور جمال",icon:fh},{coordinates:[46.48,24.71],message:"تحذير: عبور جمال",icon:fh},{coordinates:[46.49,24.68],message:"تحذير: عبور جمال",icon:fh},{coordinates:[46.51,24.72],message:"تحذير: عبور جمال",icon:fh},{coordinates:[46.52,24.69],message:"تحذير: عبور جمال",icon:fh},{coordinates:[46.47,24.7],message:"تحذير: عبور جمال",icon:fh},{coordinates:[50.1,18.3],message:"تحذير: عبور جمال",icon:fh},{coordinates:[42.7,19.5],message:"تحذير: عبور جمال",icon:fh},{coordinates:[39.5,21.5],message:"تحذير: عبور جمال",icon:fh},{coordinates:[45.4,25.1],message:"تحذير: عبور جمال",icon:fh},{coordinates:[41.8,17.5],message:"تحذير: عبور جمال",icon:fh},{coordinates:[49.8,26.3],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[38.5,24.8],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[41.2,27],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[43.9,22.3],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[44.7,20.2],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[46.6,24.8],message:"تحذير: حيوانات سائبة",icon:Cc},{coordinates:[46.55,24.75],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[46.53,24.74],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[46.57,24.76],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[46.56,24.73],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[46.54,24.76],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[46.58,24.75],message:"تحذير: منطقة خطرة",icon:Cc},{coordinates:[36.5,30],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[35.5,27.5],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[38.1,20],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[42,18.9],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.2,23.8],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.68,24.68],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.67,24.69],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.66,24.685],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.69,24.695],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.7,24.69],message:"تحذير: خطر انزلاق الصخور",icon:hd},{coordinates:[46.6753,24.7136],message:"تحذير: طريق غير ممهد",icon:Cc},{coordinates:[46.7,24.75],message:"تحذير: منطقة رمال متحركة",icon:hd},{coordinates:[46.65,24.68],message:"تحذير: عبور جمال",icon:fh},{coordinates:[46.62,24.73],message:"تحذير: منعطف خطير",icon:Cc},{coordinates:[46.68,24.72],message:"تحذير: مطب صناعي",icon:Cc}];return console.log(fh),xt.forEach(yt=>{const ot=document.createElement("div");ot.style.backgroundImage=`url(${yt.icon})`,ot.style.width="32px",ot.style.height="32px",ot.style.backgroundSize="contain",ot.style.backgroundRepeat="no-repeat",new pd.Marker(ot).setLngLat(yt.coordinates).setPopup(new pd.Popup().setText(yt.message)).addTo(t.current)}),y.current=new MutationObserver(()=>{const ot=document.getElementById("mapbox-directions-origin-input")?.querySelector("input"),rt=document.getElementById("mapbox-directions-destination-input")?.querySelector("input"),Bt=document.querySelector('label[for="mapbox-directions-profile-driving"]'),Vt=document.querySelector('label[for="mapbox-directions-profile-driving-traffic"]'),Ln=document.querySelector('label[for="mapbox-directions-profile-walking"]'),$e=document.querySelector('label[for="mapbox-directions-profile-cycling"]'),Pt=document.getElementsByClassName("directions-control-instructions");if(ot&&rt&&Bt&&Vt&&Ln&&$e&&Pt){ot.setAttribute("placeholder","اختر نقطة البداية"),rt.setAttribute("placeholder","اختر الوجهة"),Bt.textContent="القيادة",Vt.textContent="تفادى الازدحام",Ln.textContent="سيرًا ",$e.textContent="بالدراجة";const $t=document.querySelector(".mapboxgl-ctrl-directions-clear");$t&&($t.textContent="مسح"),y.current?.disconnect()}}),y.current.observe(document.body,{childList:!0,subtree:!0}),t.current.on("style.load",()=>{const yt=t.current?.getStyle().layers;yt&&yt.forEach(ot=>{ot.type==="symbol"&&ot.layout&&"text-field"in ot.layout&&(t.current?.setLayoutProperty(ot.id,"text-writing-mode",["horizontal","vertical"]),t.current?.setLayoutProperty(ot.id,"text-justify","right"),t.current?.setLayoutProperty(ot.id,"text-direction","rtl"))})}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(yt=>{const ot=[yt.coords.longitude,yt.coords.latitude];f.current?.setOrigin(ot),i.current?i.current.setLngLat(ot):i.current=new pd.Marker({color:"#F8D203"}).setLngLat(ot).addTo(t.current),J||(t.current?.flyTo({center:ot,zoom:14}),te(!0))},yt=>{console.error("Error getting initial position:",yt)}),f.current?.on("route",()=>{oe()}),()=>{t.current?.remove(),s.current!==null&&navigator.geolocation.clearWatch(s.current),y.current?.disconnect()}},[]);const oe=async()=>{if(!t.current||!f.current)return;const xe=f.current.getRoutes();if(!xe||xe.length===0){console.warn("No route available");return}const Qe=xe[0].geometry.coordinates;try{const{data:tt}=await Os.get("https://localhost:3000/api/danger-zones"),Ge=tt.filter(Je=>Qe.some(([Ve,xt])=>Math.abs(Je.location.lng-Ve)<.01&&Math.abs(Je.location.lat-xt)<.01));Ge.forEach(Je=>{const Ve=document.createElement("div");Ve.style.backgroundImage=`url(${ce(Je.name)})`,Ve.style.width="32px",Ve.style.height="32px",Ve.style.backgroundSize="contain",Ve.style.backgroundRepeat="no-repeat",new pd.Marker(Ve).setLngLat([Je.location.lng,Je.location.lat]).setPopup(new pd.Popup().setText(Je.name)).addTo(t.current)}),Ge.length===0&&alert("لا توجد تحذيرات على المسار المختار.")}catch(tt){console.error("Error fetching danger zones:",tt),alert("فشل تحميل بيانات التحذيرات.")}},ce=xe=>(xe.includes("جمال"),xe.includes("انزلاق")||xe.includes("صخور")?hd:Cc),de=xe=>{!navigator.geolocation||!t.current||navigator.geolocation.getCurrentPosition(Qe=>{const tt=[Qe.coords.longitude,Qe.coords.latitude];new pd.Marker({color:"red"}).setLngLat(tt).setPopup(new pd.Popup().setText(`بلاغ: ${xe}`)).addTo(t.current),j(Ge=>[...Ge,{type:"بلاغ",content:xe,coords:tt,timestamp:new Date().toLocaleString()}]),o(!1)})},ue=()=>{if(!navigator.geolocation||!t.current){alert("Geolocation غير مدعومة");return}s.current!==null&&navigator.geolocation.clearWatch(s.current),s.current=navigator.geolocation.watchPosition(xe=>{const Qe=[xe.coords.longitude,xe.coords.latitude];i.current?i.current.setLngLat(Qe):i.current=new pd.Marker({color:"#F8D203"}).setLngLat(Qe).addTo(t.current),t.current?.flyTo({center:Qe,zoom:16,speed:.8,essential:!0}),f.current?.setOrigin(Qe),Pe(Qe)},xe=>{console.error("خطأ في تتبع الموقع:",xe),Oe("تعذر تتبع الموقع")},{enableHighAccuracy:!0,maximumAge:0,timeout:2e4})},Pe=async xe=>{try{const{data:Qe}=await Os.get("https://localhost:3000/api/danger-zones");Qe.filter(Ge=>Math.abs(Ge.location.lng-xe[0])<.01&&Math.abs(Ge.location.lat-xe[1])<.01).forEach(Ge=>{Oe(`⚠️ منطقة خطرة قريبة: ${Ge.name}`)})}catch(Qe){console.error("فشل جلب بيانات المناطق الخطرة",Qe)}};function Oe(xe){const Qe=document.getElementById("notification-container");if(!Qe)return;const tt=document.createElement("div");tt.className="notification",tt.innerText=xe,Qe.appendChild(tt),setTimeout(()=>{tt.remove()},5e3)}return ie.jsx(yd.Fragment,{children:ie.jsxs("div",{className:"layout-container",children:[ie.jsx("div",{id:"notification-container",className:"notification-container"}),ie.jsx("div",{ref:e,className:"map-container"}),ie.jsx("button",{className:"panel-toggle",onClick:()=>{document.getElementById("directions-panel")?.classList.toggle("collapsed")},children:"☰ القائمة"}),ie.jsx("div",{id:"directions-panel",className:"panel",style:{padding:"10px",maxHeight:"100%",overflowY:"auto",color:"#000",fontFamily:"Arial, sans-serif",width:"30%"},children:ie.jsxs("div",{className:"buttonsDiv",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignContent:"center"},children:[ie.jsxs("div",{className:"FunctionBtns",style:{position:"absolute",bottom:100,zIndex:10,display:"flex",gap:"5px",justifyContent:"center",width:"90%",flexShrink:"0"},children:[ie.jsxs("button",{style:{border:"2px solid #e74c3c",cursor:"pointer",color:"#e74c3c",padding:"12px",borderRadius:"10px",fontSize:"15px",display:"flex",flexDirection:"row",gap:"5px",width:"25%",justifyContent:"center",alignItems:"center",fontWeight:"bold"},onClick:()=>o(!T),title:"بلّغ",children:["بلّغ",ie.jsx(npe,{})]}),ie.jsxs("button",{style:{color:"#27ae60",border:"2px solid #27ae60",cursor:"pointer",padding:"12px",borderRadius:"10px",fontSize:"15px",display:"flex",flexDirection:"row",gap:"5px",width:"35%",justifyContent:"center",alignItems:"center",fontWeight:"bold"},onClick:()=>M(!C),title:"اطلب مساعدة",children:["اطلب مساعدة",ie.jsx(ipe,{})]}),ie.jsxs("button",{style:{color:"#8e44ad",border:"2px solid #8e44ad",cursor:"pointer",padding:"12px",borderRadius:"10px",fontSize:"15px",display:"flex",flexDirection:"row",gap:"5px",width:"25%",height:"50px",justifyContent:"center",alignItems:"center",fontWeight:"bold"},onClick:()=>K(!q),title:"السجل",children:["السجل",ie.jsx(rpe,{})]})]}),ie.jsx("button",{style:{position:"absolute",bottom:20,right:20,zIndex:1,padding:"10px 20px",fontWeight:"bold",borderRadius:"8px",backgroundColor:"#F8D203",color:"#fff",border:"none",cursor:"pointer",fontSize:"20px",width:"320px"},className:"startBtn",onClick:ue,children:"أبدأ الرحلة"})]})}),C&&ie.jsx("div",{className:"modal-overlay",onClick:()=>M(!1),children:ie.jsxs("div",{onClick:xe=>xe.stopPropagation(),className:"modal-content",children:[ie.jsx("button",{className:"modal-close",onClick:()=>M(!1),children:"×"}),ie.jsx("h3",{style:{marginBottom:"15px"},children:"اطلب مساعدة:"}),["سطحة","مساعد شخصي","بطارية","بنشر","وقود"].map(xe=>ie.jsx("button",{style:{display:"block",width:"100%",marginBottom:10,background:"#27ae60",color:"#fff",borderRadius:"6px",padding:"10px",border:"none",fontSize:"16px",cursor:"pointer"},children:xe},xe))]})}),T&&ie.jsx("div",{className:"modal-overlay",onClick:()=>o(!1),children:ie.jsxs("div",{onClick:xe=>xe.stopPropagation(),className:"modal-content",children:[ie.jsx("button",{className:"modal-close",onClick:()=>o(!1),children:"×"}),ie.jsx("h3",{style:{marginBottom:"15px"},children:"اختر نوع البلاغ:"}),["حفرة","حادث","إغلاق طريق","مياه راكدة","عبور جمال","منحدرات","شيء آخر"].map(xe=>ie.jsx("button",{onClick:()=>de(xe),style:{display:"block",width:"100%",marginBottom:10,background:"#e74c3c",color:"#fff",borderRadius:"6px",padding:"10px",border:"none",fontSize:"16px",cursor:"pointer"},children:xe},xe))]})}),q&&ie.jsx("div",{className:"modal-overlay",onClick:()=>K(!1),children:ie.jsxs("div",{onClick:xe=>xe.stopPropagation(),className:"modal-content",children:[ie.jsx("button",{className:"modal-close",onClick:()=>K(!1),children:"×"}),ie.jsx("h3",{style:{marginBottom:"15px"},children:"سجل النشاط:"}),I.length===0?ie.jsx("p",{children:"لا يوجد بلاغات أو طلبات مساعدة"}):I.map((xe,Qe)=>ie.jsxs("div",{style:{marginBottom:10},children:[ie.jsxs("strong",{children:[xe.type,":"]})," ",xe.content,ie.jsx("br",{}),ie.jsx("small",{children:xe.timestamp})]},Qe))]})})]})})};function Nme(){const{serviceType:e}=AG(),[t,i]=me.useState([]),[s,f]=me.useState(null),[y,T]=me.useState(!0),o=jv();me.useEffect(()=>{fetch("https://683f24371cd60dca33de6ad4.mockapi.io/helper").then(I=>I.json()).then(I=>{const j=I.filter(q=>q.serviceType===e);i(j)})},[e]),me.useEffect(()=>{navigator.geolocation.getCurrentPosition(I=>{f({lat:I.coords.latitude,lng:I.coords.longitude}),T(!1)})},[]);const C=(I,j,q,K)=>{const J=ue=>ue*Math.PI/180,oe=J(q-I),ce=J(K-j),de=Math.sin(oe/2)**2+Math.cos(J(I))*Math.cos(J(q))*Math.sin(ce/2)**2;return 6371*(2*Math.atan2(Math.sqrt(de),Math.sqrt(1-de)))},M=async I=>{if(!s)return;const j=localStorage.getItem("normalUser");if(!j){alert("لم يتم العثور على بيانات المستخدم");return}const{name:q,phone:K}=JSON.parse(j);await fetch("https://6823a18e65ba0580339768c2.mockapi.io/ServiceList",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:q,phone:K,lat:s.lat,lng:s.lng,serviceType:e,helperId:I.id,status:"pending"})}),alert("تم إرسال الطلب للمساعد"),o("/map")};return ie.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[ie.jsx(gb,{}),ie.jsxs("main",{className:"flex-1 p-4 md:p-8",children:[ie.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-2",children:[ie.jsxs("div",{children:[ie.jsxs("h1",{className:"text-xl md:text-2xl font-semibold",children:["المساعدين لخدمة: ",e]}),ie.jsx("p",{className:"text-gray-500 text-sm",children:"اختر المساعد المناسب لك"})]}),ie.jsx("button",{className:"bg-yellow-400 hover:bg-yellow-500 text-black px-4 py-2 rounded font-medium w-full md:w-auto",children:"تحديث القائمة"})]}),ie.jsx("div",{className:"bg-white shadow rounded overflow-x-auto",children:ie.jsxs("table",{className:"min-w-full text-right text-sm",children:[ie.jsx("thead",{className:"border-b border-[#7a77777e] bg-gray-50",children:ie.jsxs("tr",{children:[ie.jsx("th",{className:"p-4 font-medium",children:"الاسم"}),ie.jsx("th",{className:"p-4 font-medium hidden sm:table-cell",children:"رقم الجوال"}),ie.jsx("th",{className:"p-4 font-medium hidden md:table-cell",children:"البريد الإلكتروني"}),ie.jsx("th",{className:"p-4 font-medium hidden lg:table-cell",children:"المسافة"}),ie.jsx("th",{className:"p-4 font-medium",children:"السعر"}),ie.jsx("th",{className:"p-4 font-medium"})]})}),ie.jsx("tbody",{children:t.map(I=>{const j=s?C(s.lat,s.lng,I.lat,I.lng):null;return ie.jsxs("tr",{className:"border-b border-[#c5c1c1a6] hover:bg-gray-50 transition-colors",children:[ie.jsx("td",{className:"p-4 font-medium",children:I.name}),ie.jsx("td",{className:"p-4 hidden sm:table-cell",children:I.phone}),ie.jsx("td",{className:"p-4 hidden md:table-cell",children:I.email}),ie.jsxs("td",{className:"p-4 hidden lg:table-cell",children:[j?.toFixed(2)," كم"]}),ie.jsxs("td",{className:"p-4",children:[I.price," ريال"]}),ie.jsx("td",{className:"p-4",children:ie.jsx("button",{onClick:()=>M(I),className:"text-blue-600 hover:underline",children:"طلب مساعدة"})})]},I.id)})})]})}),ie.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4 gap-2",children:[ie.jsx("button",{className:"flex items-center gap-1 text-gray-500 hover:text-gray-700",children:"⬅️ السابق"}),ie.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5,6].map(I=>ie.jsx("button",{className:`w-8 h-8 rounded ${I===1?"bg-yellow-400 text-black font-medium":"hover:bg-gray-200 text-gray-700"}`,children:I},I))}),ie.jsx("button",{className:"flex items-center gap-1 text-gray-500 hover:text-gray-700",children:"التالي ➡️"})]})]})]})}/*!
* sweetalert2 v11.22.2
* Released under the MIT License.
*/function W6(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}function Bme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BB(e,t){return e.get(W6(e,t))}function jme(e,t,i){Bme(e,t),t.set(e,i)}function Fme(e,t,i){return e.set(W6(e,t),i),i}const Ume=100,wr={},Vme=()=>{wr.previousActiveElement instanceof HTMLElement?(wr.previousActiveElement.focus(),wr.previousActiveElement=null):document.body&&document.body.focus()},$me=e=>new Promise(t=>{if(!e)return t();const i=window.scrollX,s=window.scrollY;wr.restoreFocusTimeout=setTimeout(()=>{Vme(),t()},Ume),window.scrollTo(i,s)}),X6="swal2-",qme=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],En=qme.reduce((e,t)=>(e[t]=X6+t,e),{}),Hme=["success","warning","info","question","error"],mT=Hme.reduce((e,t)=>(e[t]=X6+t,e),{}),Y6="SweetAlert2:",qO=e=>e.charAt(0).toUpperCase()+e.slice(1),su=e=>{console.warn(`${Y6} ${typeof e=="object"?e.join(" "):e}`)},gy=e=>{console.error(`${Y6} ${e}`)},jB=[],Gme=e=>{jB.includes(e)||(jB.push(e),su(e))},K6=(e,t=null)=>{Gme(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},g2=e=>typeof e=="function"?e():e,HO=e=>e&&typeof e.toPromise=="function",vb=e=>HO(e)?e.toPromise():Promise.resolve(e),GO=e=>e&&Promise.resolve(e)===e,lu=()=>document.body.querySelector(`.${En.container}`),xb=e=>{const t=lu();return t?t.querySelector(e):null},Ch=e=>xb(`.${e}`),Jo=()=>Ch(En.popup),Qv=()=>Ch(En.icon),Zme=()=>Ch(En["icon-content"]),J6=()=>Ch(En.title),ZO=()=>Ch(En["html-container"]),Q6=()=>Ch(En.image),WO=()=>Ch(En["progress-steps"]),_2=()=>Ch(En["validation-message"]),fp=()=>xb(`.${En.actions} .${En.confirm}`),e0=()=>xb(`.${En.actions} .${En.cancel}`),_y=()=>xb(`.${En.actions} .${En.deny}`),Wme=()=>Ch(En["input-label"]),t0=()=>xb(`.${En.loader}`),bb=()=>Ch(En.actions),e8=()=>Ch(En.footer),y2=()=>Ch(En["timer-progress-bar"]),XO=()=>Ch(En.close),Xme=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,YO=()=>{const e=Jo();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),i=Array.from(t).sort((y,T)=>{const o=parseInt(y.getAttribute("tabindex")||"0"),C=parseInt(T.getAttribute("tabindex")||"0");return o>C?1:o<C?-1:0}),s=e.querySelectorAll(Xme),f=Array.from(s).filter(y=>y.getAttribute("tabindex")!=="-1");return[...new Set(i.concat(f))].filter(y=>Gu(y))},KO=()=>hm(document.body,En.shown)&&!hm(document.body,En["toast-shown"])&&!hm(document.body,En["no-backdrop"]),v2=()=>{const e=Jo();return e?hm(e,En.toast):!1},Yme=()=>{const e=Jo();return e?e.hasAttribute("data-loading"):!1},Mh=(e,t)=>{if(e.textContent="",t){const s=new DOMParser().parseFromString(t,"text/html"),f=s.querySelector("head");f&&Array.from(f.childNodes).forEach(T=>{e.appendChild(T)});const y=s.querySelector("body");y&&Array.from(y.childNodes).forEach(T=>{T instanceof HTMLVideoElement||T instanceof HTMLAudioElement?e.appendChild(T.cloneNode(!0)):e.appendChild(T)})}},hm=(e,t)=>{if(!t)return!1;const i=t.split(/\s+/);for(let s=0;s<i.length;s++)if(!e.classList.contains(i[s]))return!1;return!0},Kme=(e,t)=>{Array.from(e.classList).forEach(i=>{!Object.values(En).includes(i)&&!Object.values(mT).includes(i)&&!Object.values(t.showClass||{}).includes(i)&&e.classList.remove(i)})},Ph=(e,t,i)=>{if(Kme(e,t),!t.customClass)return;const s=t.customClass[i];if(s){if(typeof s!="string"&&!s.forEach){su(`Invalid type of customClass.${i}! Expected string or iterable object, got "${typeof s}"`);return}oa(e,s)}},x2=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${En.popup} > .${En[t]}`);case"checkbox":return e.querySelector(`.${En.popup} > .${En.checkbox} input`);case"radio":return e.querySelector(`.${En.popup} > .${En.radio} input:checked`)||e.querySelector(`.${En.popup} > .${En.radio} input:first-child`);case"range":return e.querySelector(`.${En.popup} > .${En.range} input`);default:return e.querySelector(`.${En.popup} > .${En.input}`)}},t8=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},n8=(e,t,i)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(s=>{Array.isArray(e)?e.forEach(f=>{i?f.classList.add(s):f.classList.remove(s)}):i?e.classList.add(s):e.classList.remove(s)}))},oa=(e,t)=>{n8(e,t,!0)},Td=(e,t)=>{n8(e,t,!1)},wg=(e,t)=>{const i=Array.from(e.children);for(let s=0;s<i.length;s++){const f=i[s];if(f instanceof HTMLElement&&hm(f,t))return f}},iy=(e,t,i)=>{i===`${parseInt(i)}`&&(i=parseInt(i)),i||parseInt(i)===0?e.style.setProperty(t,typeof i=="number"?`${i}px`:i):e.style.removeProperty(t)},$l=(e,t="flex")=>{e&&(e.style.display=t)},Lc=e=>{e&&(e.style.display="none")},JO=(e,t="block")=>{e&&new MutationObserver(()=>{wb(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},FB=(e,t,i,s)=>{const f=e.querySelector(t);f&&f.style.setProperty(i,s)},wb=(e,t,i="flex")=>{t?$l(e,i):Lc(e)},Gu=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),Jme=()=>!Gu(fp())&&!Gu(_y())&&!Gu(e0()),sC=e=>e.scrollHeight>e.clientHeight,Qme=(e,t)=>{let i=e;for(;i&&i!==t;){if(sC(i))return!0;i=i.parentElement}return!1},i8=e=>{const t=window.getComputedStyle(e),i=parseFloat(t.getPropertyValue("animation-duration")||"0"),s=parseFloat(t.getPropertyValue("transition-duration")||"0");return i>0||s>0},QO=(e,t=!1)=>{const i=y2();i&&Gu(i)&&(t&&(i.style.transition="none",i.style.width="100%"),setTimeout(()=>{i.style.transition=`width ${e/1e3}s linear`,i.style.width="0%"},10))},ege=()=>{const e=y2();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const i=parseInt(window.getComputedStyle(e).width),s=t/i*100;e.style.width=`${s}%`},tge=()=>typeof window>"u"||typeof document>"u",nge=`
 <div aria-labelledby="${En.title}" aria-describedby="${En["html-container"]}" class="${En.popup}" tabindex="-1">
   <button type="button" class="${En.close}"></button>
   <ul class="${En["progress-steps"]}"></ul>
   <div class="${En.icon}"></div>
   <img class="${En.image}" />
   <h2 class="${En.title}" id="${En.title}"></h2>
   <div class="${En["html-container"]}" id="${En["html-container"]}"></div>
   <input class="${En.input}" id="${En.input}" />
   <input type="file" class="${En.file}" />
   <div class="${En.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${En.select}" id="${En.select}"></select>
   <div class="${En.radio}"></div>
   <label class="${En.checkbox}">
     <input type="checkbox" id="${En.checkbox}" />
     <span class="${En.label}"></span>
   </label>
   <textarea class="${En.textarea}" id="${En.textarea}"></textarea>
   <div class="${En["validation-message"]}" id="${En["validation-message"]}"></div>
   <div class="${En.actions}">
     <div class="${En.loader}"></div>
     <button type="button" class="${En.confirm}"></button>
     <button type="button" class="${En.deny}"></button>
     <button type="button" class="${En.cancel}"></button>
   </div>
   <div class="${En.footer}"></div>
   <div class="${En["timer-progress-bar-container"]}">
     <div class="${En["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),ige=()=>{const e=lu();return e?(e.remove(),Td([document.documentElement,document.body],[En["no-backdrop"],En["toast-shown"],En["has-column"]]),!0):!1},R_=()=>{wr.currentInstance.resetValidationMessage()},rge=()=>{const e=Jo(),t=wg(e,En.input),i=wg(e,En.file),s=e.querySelector(`.${En.range} input`),f=e.querySelector(`.${En.range} output`),y=wg(e,En.select),T=e.querySelector(`.${En.checkbox} input`),o=wg(e,En.textarea);t.oninput=R_,i.onchange=R_,y.onchange=R_,T.onchange=R_,o.oninput=R_,s.oninput=()=>{R_(),f.value=s.value},s.onchange=()=>{R_(),f.value=s.value}},oge=e=>typeof e=="string"?document.querySelector(e):e,age=e=>{const t=Jo();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},sge=e=>{window.getComputedStyle(e).direction==="rtl"&&oa(lu(),En.rtl)},lge=e=>{const t=ige();if(tge()){gy("SweetAlert2 requires document to initialize");return}const i=document.createElement("div");i.className=En.container,t&&oa(i,En["no-transition"]),Mh(i,nge),i.dataset.swal2Theme=e.theme;const s=oge(e.target);s.appendChild(i),e.topLayer&&(i.setAttribute("popover",""),i.showPopover()),age(e),sge(s),rge()},eI=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?cge(e,t):e&&Mh(t,e)},cge=(e,t)=>{e.jquery?uge(t,e):Mh(t,e.toString())},uge=(e,t)=>{if(e.textContent="",0 in t)for(let i=0;i in t;i++)e.appendChild(t[i].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},hge=(e,t)=>{const i=bb(),s=t0();!i||!s||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?Lc(i):$l(i),Ph(i,t,"actions"),dge(i,s,t),Mh(s,t.loaderHtml||""),Ph(s,t,"loader"))};function dge(e,t,i){const s=fp(),f=_y(),y=e0();!s||!f||!y||(LA(s,"confirm",i),LA(f,"deny",i),LA(y,"cancel",i),fge(s,f,y,i),i.reverseButtons&&(i.toast?(e.insertBefore(y,s),e.insertBefore(f,s)):(e.insertBefore(y,t),e.insertBefore(f,t),e.insertBefore(s,t))))}function fge(e,t,i,s){if(!s.buttonsStyling){Td([e,t,i],En.styled);return}oa([e,t,i],En.styled),s.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",s.confirmButtonColor),s.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",s.denyButtonColor),s.cancelButtonColor&&i.style.setProperty("--swal2-cancel-button-background-color",s.cancelButtonColor),RA(e),RA(t),RA(i)}function RA(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const i=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${i}`))}function LA(e,t,i){const s=qO(t);wb(e,i[`show${s}Button`],"inline-block"),Mh(e,i[`${t}ButtonText`]||""),e.setAttribute("aria-label",i[`${t}ButtonAriaLabel`]||""),e.className=En[t],Ph(e,i,`${t}Button`)}const pge=(e,t)=>{const i=XO();i&&(Mh(i,t.closeButtonHtml||""),Ph(i,t,"closeButton"),wb(i,t.showCloseButton),i.setAttribute("aria-label",t.closeButtonAriaLabel||""))},mge=(e,t)=>{const i=lu();i&&(gge(i,t.backdrop),_ge(i,t.position),yge(i,t.grow),Ph(i,t,"container"))};function gge(e,t){typeof t=="string"?e.style.background=t:t||oa([document.documentElement,document.body],En["no-backdrop"])}function _ge(e,t){t&&(t in En?oa(e,En[t]):(su('The "position" parameter is not valid, defaulting to "center"'),oa(e,En.center)))}function yge(e,t){t&&oa(e,En[`grow-${t}`])}var Ka={innerParams:new WeakMap,domCache:new WeakMap};const vge=["input","file","range","select","radio","checkbox","textarea"],xge=(e,t)=>{const i=Jo();if(!i)return;const s=Ka.innerParams.get(e),f=!s||t.input!==s.input;vge.forEach(y=>{const T=wg(i,En[y]);T&&(Tge(y,t.inputAttributes),T.className=En[y],f&&Lc(T))}),t.input&&(f&&bge(t),Sge(t))},bge=e=>{if(!e.input)return;if(!il[e.input]){gy(`Unexpected type of input! Expected ${Object.keys(il).join(" | ")}, got "${e.input}"`);return}const t=r8(e.input);if(!t)return;const i=il[e.input](t,e);$l(t),e.inputAutoFocus&&setTimeout(()=>{t8(i)})},wge=e=>{for(let t=0;t<e.attributes.length;t++){const i=e.attributes[t].name;["id","type","value","style"].includes(i)||e.removeAttribute(i)}},Tge=(e,t)=>{const i=Jo();if(!i)return;const s=x2(i,e);if(s){wge(s);for(const f in t)s.setAttribute(f,t[f])}},Sge=e=>{if(!e.input)return;const t=r8(e.input);t&&Ph(t,e,"input")},tI=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},Tb=(e,t,i)=>{if(i.inputLabel){const s=document.createElement("label"),f=En["input-label"];s.setAttribute("for",e.id),s.className=f,typeof i.customClass=="object"&&oa(s,i.customClass.inputLabel),s.innerText=i.inputLabel,t.insertAdjacentElement("beforebegin",s)}},r8=e=>{const t=Jo();if(t)return wg(t,En[e]||En.input)},gT=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:GO(t)||su(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},il={};il.text=il.email=il.password=il.number=il.tel=il.url=il.search=il.date=il["datetime-local"]=il.time=il.week=il.month=(e,t)=>(gT(e,t.inputValue),Tb(e,e,t),tI(e,t),e.type=t.input,e);il.file=(e,t)=>(Tb(e,e,t),tI(e,t),e);il.range=(e,t)=>{const i=e.querySelector("input"),s=e.querySelector("output");return gT(i,t.inputValue),i.type=t.input,gT(s,t.inputValue),Tb(i,e,t),e};il.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const i=document.createElement("option");Mh(i,t.inputPlaceholder),i.value="",i.disabled=!0,i.selected=!0,e.appendChild(i)}return Tb(e,e,t),e};il.radio=e=>(e.textContent="",e);il.checkbox=(e,t)=>{const i=x2(Jo(),"checkbox");i.value="1",i.checked=!!t.inputValue;const s=e.querySelector("span");return Mh(s,t.inputPlaceholder||t.inputLabel),i};il.textarea=(e,t)=>{gT(e,t.inputValue),tI(e,t),Tb(e,e,t);const i=s=>parseInt(window.getComputedStyle(s).marginLeft)+parseInt(window.getComputedStyle(s).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const s=parseInt(window.getComputedStyle(Jo()).width),f=()=>{if(!document.body.contains(e))return;const y=e.offsetWidth+i(e);y>s?Jo().style.width=`${y}px`:iy(Jo(),"width",t.width)};new MutationObserver(f).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const Ege=(e,t)=>{const i=ZO();i&&(JO(i),Ph(i,t,"htmlContainer"),t.html?(eI(t.html,i),$l(i,"block")):t.text?(i.textContent=t.text,$l(i,"block")):Lc(i),xge(e,t))},Age=(e,t)=>{const i=e8();i&&(JO(i),wb(i,t.footer,"block"),t.footer&&eI(t.footer,i),Ph(i,t,"footer"))},Pge=(e,t)=>{const i=Ka.innerParams.get(e),s=Qv();if(!s)return;if(i&&t.icon===i.icon){VB(s,t),UB(s,t);return}if(!t.icon&&!t.iconHtml){Lc(s);return}if(t.icon&&Object.keys(mT).indexOf(t.icon)===-1){gy(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),Lc(s);return}$l(s),VB(s,t),UB(s,t),oa(s,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o8)},UB=(e,t)=>{for(const[i,s]of Object.entries(mT))t.icon!==i&&Td(e,s);oa(e,t.icon&&mT[t.icon]),Oge(e,t),o8(),Ph(e,t,"icon")},o8=()=>{const e=Jo();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),i=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let s=0;s<i.length;s++)i[s].style.backgroundColor=t},Cge=e=>`
  ${e.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${e.animation?'<div class="swal2-success-fix"></div>':""}
  ${e.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,Mge=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,VB=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let i=e.innerHTML,s="";t.iconHtml?s=$B(t.iconHtml):t.icon==="success"?(s=Cge(t),i=i.replace(/ style=".*?"/g,"")):t.icon==="error"?s=Mge:t.icon&&(s=$B({question:"?",warning:"!",info:"i"}[t.icon])),i.trim()!==s.trim()&&Mh(e,s)},Oge=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const i of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])FB(e,i,"background-color",t.iconColor);FB(e,".swal2-success-ring","border-color",t.iconColor)}},$B=e=>`<div class="${En["icon-content"]}">${e}</div>`,Ige=(e,t)=>{const i=Q6();if(i){if(!t.imageUrl){Lc(i);return}$l(i,""),i.setAttribute("src",t.imageUrl),i.setAttribute("alt",t.imageAlt||""),iy(i,"width",t.imageWidth),iy(i,"height",t.imageHeight),i.className=En.image,Ph(i,t,"image")}};let nI=!1,a8=0,s8=0,l8=0,c8=0;const Dge=e=>{e.addEventListener("mousedown",_T),document.body.addEventListener("mousemove",yT),e.addEventListener("mouseup",vT),e.addEventListener("touchstart",_T),document.body.addEventListener("touchmove",yT),e.addEventListener("touchend",vT)},Rge=e=>{e.removeEventListener("mousedown",_T),document.body.removeEventListener("mousemove",yT),e.removeEventListener("mouseup",vT),e.removeEventListener("touchstart",_T),document.body.removeEventListener("touchmove",yT),e.removeEventListener("touchend",vT)},_T=e=>{const t=Jo();if(e.target===t||Qv().contains(e.target)){nI=!0;const i=u8(e);a8=i.clientX,s8=i.clientY,l8=parseInt(t.style.insetInlineStart)||0,c8=parseInt(t.style.insetBlockStart)||0,oa(t,"swal2-dragging")}},yT=e=>{const t=Jo();if(nI){let{clientX:i,clientY:s}=u8(e);t.style.insetInlineStart=`${l8+(i-a8)}px`,t.style.insetBlockStart=`${c8+(s-s8)}px`}},vT=()=>{const e=Jo();nI=!1,Td(e,"swal2-dragging")},u8=e=>{let t=0,i=0;return e.type.startsWith("mouse")?(t=e.clientX,i=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,i=e.touches[0].clientY),{clientX:t,clientY:i}},Lge=(e,t)=>{const i=lu(),s=Jo();if(!(!i||!s)){if(t.toast){iy(i,"width",t.width),s.style.width="100%";const f=t0();f&&s.insertBefore(f,Qv())}else iy(s,"width",t.width);iy(s,"padding",t.padding),t.color&&(s.style.color=t.color),t.background&&(s.style.background=t.background),Lc(_2()),zge(s,t),t.draggable&&!t.toast?(oa(s,En.draggable),Dge(s)):(Td(s,En.draggable),Rge(s))}},zge=(e,t)=>{const i=t.showClass||{};e.className=`${En.popup} ${Gu(e)?i.popup:""}`,t.toast?(oa([document.documentElement,document.body],En["toast-shown"]),oa(e,En.toast)):oa(e,En.modal),Ph(e,t,"popup"),typeof t.customClass=="string"&&oa(e,t.customClass),t.icon&&oa(e,En[`icon-${t.icon}`])},kge=(e,t)=>{const i=WO();if(!i)return;const{progressSteps:s,currentProgressStep:f}=t;if(!s||s.length===0||f===void 0){Lc(i);return}$l(i),i.textContent="",f>=s.length&&su("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),s.forEach((y,T)=>{const o=Nge(y);if(i.appendChild(o),T===f&&oa(o,En["active-progress-step"]),T!==s.length-1){const C=Bge(t);i.appendChild(C)}})},Nge=e=>{const t=document.createElement("li");return oa(t,En["progress-step"]),Mh(t,e),t},Bge=e=>{const t=document.createElement("li");return oa(t,En["progress-step-line"]),e.progressStepsDistance&&iy(t,"width",e.progressStepsDistance),t},jge=(e,t)=>{const i=J6();i&&(JO(i),wb(i,t.title||t.titleText,"block"),t.title&&eI(t.title,i),t.titleText&&(i.innerText=t.titleText),Ph(i,t,"title"))},h8=(e,t)=>{Lge(e,t),mge(e,t),kge(e,t),Pge(e,t),Ige(e,t),jge(e,t),pge(e,t),Ege(e,t),hge(e,t),Age(e,t);const i=Jo();typeof t.didRender=="function"&&i&&t.didRender(i),wr.eventEmitter.emit("didRender",i)},Fge=()=>Gu(Jo()),d8=()=>{var e;return(e=fp())===null||e===void 0?void 0:e.click()},Uge=()=>{var e;return(e=_y())===null||e===void 0?void 0:e.click()},Vge=()=>{var e;return(e=e0())===null||e===void 0?void 0:e.click()},n0=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),f8=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},$ge=(e,t,i)=>{f8(e),t.toast||(e.keydownHandler=s=>Hge(t,s,i),e.keydownTarget=t.keydownListenerCapture?window:Jo(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},lC=(e,t)=>{var i;const s=YO();if(s.length){e=e+t,e===-2&&(e=s.length-1),e===s.length?e=0:e===-1&&(e=s.length-1),s[e].focus();return}(i=Jo())===null||i===void 0||i.focus()},p8=["ArrowRight","ArrowDown"],qge=["ArrowLeft","ArrowUp"],Hge=(e,t,i)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?Gge(t,e):t.key==="Tab"?Zge(t):[...p8,...qge].includes(t.key)?Wge(t.key):t.key==="Escape"&&Xge(t,e,i)))},Gge=(e,t)=>{if(!g2(t.allowEnterKey))return;const i=x2(Jo(),t.input);if(e.target&&i&&e.target instanceof HTMLElement&&e.target.outerHTML===i.outerHTML){if(["textarea","file"].includes(t.input))return;d8(),e.preventDefault()}},Zge=e=>{const t=e.target,i=YO();let s=-1;for(let f=0;f<i.length;f++)if(t===i[f]){s=f;break}e.shiftKey?lC(s,-1):lC(s,1),e.stopPropagation(),e.preventDefault()},Wge=e=>{const t=bb(),i=fp(),s=_y(),f=e0();if(!t||!i||!s||!f)return;const y=[i,s,f];if(document.activeElement instanceof HTMLElement&&!y.includes(document.activeElement))return;const T=p8.includes(e)?"nextElementSibling":"previousElementSibling";let o=document.activeElement;if(o){for(let C=0;C<t.children.length;C++){if(o=o[T],!o)return;if(o instanceof HTMLButtonElement&&Gu(o))break}o instanceof HTMLButtonElement&&o.focus()}},Xge=(e,t,i)=>{e.preventDefault(),g2(t.allowEscapeKey)&&i(n0.esc)};var kv={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Yge=()=>{const e=lu();Array.from(document.body.children).forEach(i=>{i.contains(e)||(i.hasAttribute("aria-hidden")&&i.setAttribute("data-previous-aria-hidden",i.getAttribute("aria-hidden")||""),i.setAttribute("aria-hidden","true"))})},m8=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},g8=typeof window<"u"&&!!window.GestureEvent,Kge=()=>{if(g8&&!hm(document.body,En.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,oa(document.body,En.iosfix),Jge()}},Jge=()=>{const e=lu();if(!e)return;let t;e.ontouchstart=i=>{t=Qge(i)},e.ontouchmove=i=>{t&&(i.preventDefault(),i.stopPropagation())}},Qge=e=>{const t=e.target,i=lu(),s=ZO();return!i||!s||e_e(e)||t_e(e)?!1:t===i||!sC(i)&&t instanceof HTMLElement&&!Qme(t,s)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(sC(s)&&s.contains(t))},e_e=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",t_e=e=>e.touches&&e.touches.length>1,n_e=()=>{if(hm(document.body,En.iosfix)){const e=parseInt(document.body.style.top,10);Td(document.body,En.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},i_e=()=>{const e=document.createElement("div");e.className=En["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let Tv=null;const r_e=e=>{Tv===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(Tv=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Tv+i_e()}px`)},o_e=()=>{Tv!==null&&(document.body.style.paddingRight=`${Tv}px`,Tv=null)};function _8(e,t,i,s){v2()?qB(e,s):($me(i).then(()=>qB(e,s)),f8(wr)),g8?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),KO()&&(o_e(),n_e(),m8()),a_e()}function a_e(){Td([document.documentElement,document.body],[En.shown,En["height-auto"],En["no-backdrop"],En["toast-shown"]])}function Tg(e){e=l_e(e);const t=kv.swalPromiseResolve.get(this),i=s_e(this);this.isAwaitingPromise?e.isDismissed||(Sb(this),t(e)):i&&t(e)}const s_e=e=>{const t=Jo();if(!t)return!1;const i=Ka.innerParams.get(e);if(!i||hm(t,i.hideClass.popup))return!1;Td(t,i.showClass.popup),oa(t,i.hideClass.popup);const s=lu();return Td(s,i.showClass.backdrop),oa(s,i.hideClass.backdrop),c_e(e,t,i),!0};function y8(e){const t=kv.swalPromiseReject.get(this);Sb(this),t&&t(e)}const Sb=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,Ka.innerParams.get(e)||e._destroy())},l_e=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),c_e=(e,t,i)=>{var s;const f=lu(),y=i8(t);typeof i.willClose=="function"&&i.willClose(t),(s=wr.eventEmitter)===null||s===void 0||s.emit("willClose",t),y?u_e(e,t,f,i.returnFocus,i.didClose):_8(e,f,i.returnFocus,i.didClose)},u_e=(e,t,i,s,f)=>{wr.swalCloseEventFinishedCallback=_8.bind(null,e,i,s,f);const y=function(T){if(T.target===t){var o;(o=wr.swalCloseEventFinishedCallback)===null||o===void 0||o.call(wr),delete wr.swalCloseEventFinishedCallback,t.removeEventListener("animationend",y),t.removeEventListener("transitionend",y)}};t.addEventListener("animationend",y),t.addEventListener("transitionend",y)},qB=(e,t)=>{setTimeout(()=>{var i;typeof t=="function"&&t.bind(e.params)(),(i=wr.eventEmitter)===null||i===void 0||i.emit("didClose"),e._destroy&&e._destroy()})},Nv=e=>{let t=Jo();if(t||new om,t=Jo(),!t)return;const i=t0();v2()?Lc(Qv()):h_e(t,e),$l(i),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},h_e=(e,t)=>{const i=bb(),s=t0();!i||!s||(!t&&Gu(fp())&&(t=fp()),$l(i),t&&(Lc(t),s.setAttribute("data-button-to-replace",t.className),i.insertBefore(s,t)),oa([e,i],En.loading))},d_e=(e,t)=>{t.input==="select"||t.input==="radio"?__e(e,t):["text","email","number","tel","textarea"].some(i=>i===t.input)&&(HO(t.inputValue)||GO(t.inputValue))&&(Nv(fp()),y_e(e,t))},f_e=(e,t)=>{const i=e.getInput();if(!i)return null;switch(t.input){case"checkbox":return p_e(i);case"radio":return m_e(i);case"file":return g_e(i);default:return t.inputAutoTrim?i.value.trim():i.value}},p_e=e=>e.checked?1:0,m_e=e=>e.checked?e.value:null,g_e=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,__e=(e,t)=>{const i=Jo();if(!i)return;const s=f=>{t.input==="select"?v_e(i,xT(f),t):t.input==="radio"&&x_e(i,xT(f),t)};HO(t.inputOptions)||GO(t.inputOptions)?(Nv(fp()),vb(t.inputOptions).then(f=>{e.hideLoading(),s(f)})):typeof t.inputOptions=="object"?s(t.inputOptions):gy(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},y_e=(e,t)=>{const i=e.getInput();i&&(Lc(i),vb(t.inputValue).then(s=>{i.value=t.input==="number"?`${parseFloat(s)||0}`:`${s}`,$l(i),i.focus(),e.hideLoading()}).catch(s=>{gy(`Error in inputValue promise: ${s}`),i.value="",$l(i),i.focus(),e.hideLoading()}))};function v_e(e,t,i){const s=wg(e,En.select);if(!s)return;const f=(y,T,o)=>{const C=document.createElement("option");C.value=o,Mh(C,T),C.selected=v8(o,i.inputValue),y.appendChild(C)};t.forEach(y=>{const T=y[0],o=y[1];if(Array.isArray(o)){const C=document.createElement("optgroup");C.label=T,C.disabled=!1,s.appendChild(C),o.forEach(M=>f(C,M[1],M[0]))}else f(s,o,T)}),s.focus()}function x_e(e,t,i){const s=wg(e,En.radio);if(!s)return;t.forEach(y=>{const T=y[0],o=y[1],C=document.createElement("input"),M=document.createElement("label");C.type="radio",C.name=En.radio,C.value=T,v8(T,i.inputValue)&&(C.checked=!0);const I=document.createElement("span");Mh(I,o),I.className=En.label,M.appendChild(C),M.appendChild(I),s.appendChild(M)});const f=s.querySelectorAll("input");f.length&&f[0].focus()}const xT=e=>{const t=[];return e instanceof Map?e.forEach((i,s)=>{let f=i;typeof f=="object"&&(f=xT(f)),t.push([s,f])}):Object.keys(e).forEach(i=>{let s=e[i];typeof s=="object"&&(s=xT(s)),t.push([i,s])}),t},v8=(e,t)=>!!t&&t.toString()===e.toString(),b_e=e=>{const t=Ka.innerParams.get(e);e.disableButtons(),t.input?x8(e,"confirm"):rI(e,!0)},w_e=e=>{const t=Ka.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?x8(e,"deny"):iI(e,!1)},T_e=(e,t)=>{e.disableButtons(),t(n0.cancel)},x8=(e,t)=>{const i=Ka.innerParams.get(e);if(!i.input){gy(`The "input" parameter is needed to be set when using returnInputValueOn${qO(t)}`);return}const s=e.getInput(),f=f_e(e,i);i.inputValidator?S_e(e,f,t):s&&!s.checkValidity()?(e.enableButtons(),e.showValidationMessage(i.validationMessage||s.validationMessage)):t==="deny"?iI(e,f):rI(e,f)},S_e=(e,t,i)=>{const s=Ka.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>vb(s.inputValidator(t,s.validationMessage))).then(y=>{e.enableButtons(),e.enableInput(),y?e.showValidationMessage(y):i==="deny"?iI(e,t):rI(e,t)})},iI=(e,t)=>{const i=Ka.innerParams.get(e||void 0);i.showLoaderOnDeny&&Nv(_y()),i.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>vb(i.preDeny(t,i.validationMessage))).then(f=>{f===!1?(e.hideLoading(),Sb(e)):e.close({isDenied:!0,value:typeof f>"u"?t:f})}).catch(f=>b8(e||void 0,f))):e.close({isDenied:!0,value:t})},HB=(e,t)=>{e.close({isConfirmed:!0,value:t})},b8=(e,t)=>{e.rejectPromise(t)},rI=(e,t)=>{const i=Ka.innerParams.get(e||void 0);i.showLoaderOnConfirm&&Nv(),i.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>vb(i.preConfirm(t,i.validationMessage))).then(f=>{Gu(_2())||f===!1?(e.hideLoading(),Sb(e)):HB(e,typeof f>"u"?t:f)}).catch(f=>b8(e||void 0,f))):HB(e,t)};function bT(){const e=Ka.innerParams.get(this);if(!e)return;const t=Ka.domCache.get(this);Lc(t.loader),v2()?e.icon&&$l(Qv()):E_e(t),Td([t.popup,t.actions],En.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const E_e=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?$l(t[0],"inline-block"):Jme()&&Lc(e.actions)};function w8(){const e=Ka.innerParams.get(this),t=Ka.domCache.get(this);return t?x2(t.popup,e.input):null}function T8(e,t,i){const s=Ka.domCache.get(e);t.forEach(f=>{s[f].disabled=i})}function S8(e,t){const i=Jo();if(!(!i||!e))if(e.type==="radio"){const s=i.querySelectorAll(`[name="${En.radio}"]`);for(let f=0;f<s.length;f++)s[f].disabled=t}else e.disabled=t}function E8(){T8(this,["confirmButton","denyButton","cancelButton"],!1)}function A8(){T8(this,["confirmButton","denyButton","cancelButton"],!0)}function P8(){S8(this.getInput(),!1)}function C8(){S8(this.getInput(),!0)}function M8(e){const t=Ka.domCache.get(this),i=Ka.innerParams.get(this);Mh(t.validationMessage,e),t.validationMessage.className=En["validation-message"],i.customClass&&i.customClass.validationMessage&&oa(t.validationMessage,i.customClass.validationMessage),$l(t.validationMessage);const s=this.getInput();s&&(s.setAttribute("aria-invalid","true"),s.setAttribute("aria-describedby",En["validation-message"]),t8(s),oa(s,En.inputerror))}function O8(){const e=Ka.domCache.get(this);e.validationMessage&&Lc(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),Td(t,En.inputerror))}const Sv={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},A_e=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],P_e={allowEnterKey:void 0},C_e=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],I8=e=>Object.prototype.hasOwnProperty.call(Sv,e),D8=e=>A_e.indexOf(e)!==-1,R8=e=>P_e[e],M_e=e=>{I8(e)||su(`Unknown parameter "${e}"`)},O_e=e=>{C_e.includes(e)&&su(`The parameter "${e}" is incompatible with toasts`)},I_e=e=>{const t=R8(e);t&&K6(e,t)},L8=e=>{e.backdrop===!1&&e.allowOutsideClick&&su('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&su(`Invalid theme "${e.theme}"`);for(const t in e)M_e(t),e.toast&&O_e(t),I_e(t)};function z8(e){const t=lu(),i=Jo(),s=Ka.innerParams.get(this);if(!i||hm(i,s.hideClass.popup)){su("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const f=D_e(e),y=Object.assign({},s,f);L8(y),t.dataset.swal2Theme=y.theme,h8(this,y),Ka.innerParams.set(this,y),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const D_e=e=>{const t={};return Object.keys(e).forEach(i=>{D8(i)?t[i]=e[i]:su(`Invalid parameter to update: ${i}`)}),t};function k8(){const e=Ka.domCache.get(this),t=Ka.innerParams.get(this);if(!t){N8(this);return}e.popup&&wr.swalCloseEventFinishedCallback&&(wr.swalCloseEventFinishedCallback(),delete wr.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),wr.eventEmitter.emit("didDestroy"),R_e(this)}const R_e=e=>{N8(e),delete e.params,delete wr.keydownHandler,delete wr.keydownTarget,delete wr.currentInstance},N8=e=>{e.isAwaitingPromise?(zA(Ka,e),e.isAwaitingPromise=!0):(zA(kv,e),zA(Ka,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},zA=(e,t)=>{for(const i in e)e[i].delete(t)};var L_e=Object.freeze({__proto__:null,_destroy:k8,close:Tg,closeModal:Tg,closePopup:Tg,closeToast:Tg,disableButtons:A8,disableInput:C8,disableLoading:bT,enableButtons:E8,enableInput:P8,getInput:w8,handleAwaitingPromise:Sb,hideLoading:bT,rejectPromise:y8,resetValidationMessage:O8,showValidationMessage:M8,update:z8});const z_e=(e,t,i)=>{e.toast?k_e(e,t,i):(B_e(t),j_e(t),F_e(e,t,i))},k_e=(e,t,i)=>{t.popup.onclick=()=>{e&&(N_e(e)||e.timer||e.input)||i(n0.close)}},N_e=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let wT=!1;const B_e=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(wT=!0)}}},j_e=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(i){e.popup.onmouseup=()=>{},(i.target===e.popup||i.target instanceof HTMLElement&&e.popup.contains(i.target))&&(wT=!0)}}},F_e=(e,t,i)=>{t.container.onclick=s=>{if(wT){wT=!1;return}s.target===t.container&&g2(e.allowOutsideClick)&&i(n0.backdrop)}},U_e=e=>typeof e=="object"&&e.jquery,GB=e=>e instanceof Element||U_e(e),V_e=e=>{const t={};return typeof e[0]=="object"&&!GB(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((i,s)=>{const f=e[s];typeof f=="string"||GB(f)?t[i]=f:f!==void 0&&gy(`Unexpected type of ${i}! Expected "string" or "Element", got ${typeof f}`)}),t};function $_e(...e){return new this(...e)}function q_e(e){class t extends this{_main(s,f){return super._main(s,Object.assign({},e,f))}}return t}const H_e=()=>wr.timeout&&wr.timeout.getTimerLeft(),B8=()=>{if(wr.timeout)return ege(),wr.timeout.stop()},j8=()=>{if(wr.timeout){const e=wr.timeout.start();return QO(e),e}},G_e=()=>{const e=wr.timeout;return e&&(e.running?B8():j8())},Z_e=e=>{if(wr.timeout){const t=wr.timeout.increase(e);return QO(t,!0),t}},W_e=()=>!!(wr.timeout&&wr.timeout.isRunning());let ZB=!1;const cC={};function X_e(e="data-swal-template"){cC[e]=this,ZB||(document.body.addEventListener("click",Y_e),ZB=!0)}const Y_e=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const i in cC){const s=t.getAttribute(i);if(s){cC[i].fire({template:s});return}}};class K_e{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,i){const s=this._getHandlersByEventName(t);s.includes(i)||s.push(i)}once(t,i){const s=(...f)=>{this.removeListener(t,s),i.apply(this,f)};this.on(t,s)}emit(t,...i){this._getHandlersByEventName(t).forEach(s=>{try{s.apply(this,i)}catch(f){console.error(f)}})}removeListener(t,i){const s=this._getHandlersByEventName(t),f=s.indexOf(i);f>-1&&s.splice(f,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}wr.eventEmitter=new K_e;const J_e=(e,t)=>{wr.eventEmitter.on(e,t)},Q_e=(e,t)=>{wr.eventEmitter.once(e,t)},eye=(e,t)=>{if(!e){wr.eventEmitter.reset();return}t?wr.eventEmitter.removeListener(e,t):wr.eventEmitter.removeAllListeners(e)};var tye=Object.freeze({__proto__:null,argsToParams:V_e,bindClickHandler:X_e,clickCancel:Vge,clickConfirm:d8,clickDeny:Uge,enableLoading:Nv,fire:$_e,getActions:bb,getCancelButton:e0,getCloseButton:XO,getConfirmButton:fp,getContainer:lu,getDenyButton:_y,getFocusableElements:YO,getFooter:e8,getHtmlContainer:ZO,getIcon:Qv,getIconContent:Zme,getImage:Q6,getInputLabel:Wme,getLoader:t0,getPopup:Jo,getProgressSteps:WO,getTimerLeft:H_e,getTimerProgressBar:y2,getTitle:J6,getValidationMessage:_2,increaseTimer:Z_e,isDeprecatedParameter:R8,isLoading:Yme,isTimerRunning:W_e,isUpdatableParameter:D8,isValidParameter:I8,isVisible:Fge,mixin:q_e,off:eye,on:J_e,once:Q_e,resumeTimer:j8,showLoading:Nv,stopTimer:B8,toggleTimer:G_e});class nye{constructor(t,i){this.callback=t,this.remaining=i,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const i=this.running;return i&&this.stop(),this.remaining+=t,i&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const F8=["swal-title","swal-html","swal-footer"],iye=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const i=t.content;return hye(i),Object.assign(rye(i),oye(i),aye(i),sye(i),lye(i),cye(i),uye(i,F8))},rye=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(s=>{cy(s,["name","value"]);const f=s.getAttribute("name"),y=s.getAttribute("value");!f||!y||(typeof Sv[f]=="boolean"?t[f]=y!=="false":typeof Sv[f]=="object"?t[f]=JSON.parse(y):t[f]=y)}),t},oye=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(s=>{const f=s.getAttribute("name"),y=s.getAttribute("value");!f||!y||(t[f]=new Function(`return ${y}`)())}),t},aye=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(s=>{cy(s,["type","color","aria-label"]);const f=s.getAttribute("type");!f||!["confirm","cancel","deny"].includes(f)||(t[`${f}ButtonText`]=s.innerHTML,t[`show${qO(f)}Button`]=!0,s.hasAttribute("color")&&(t[`${f}ButtonColor`]=s.getAttribute("color")),s.hasAttribute("aria-label")&&(t[`${f}ButtonAriaLabel`]=s.getAttribute("aria-label")))}),t},sye=e=>{const t={},i=e.querySelector("swal-image");return i&&(cy(i,["src","width","height","alt"]),i.hasAttribute("src")&&(t.imageUrl=i.getAttribute("src")||void 0),i.hasAttribute("width")&&(t.imageWidth=i.getAttribute("width")||void 0),i.hasAttribute("height")&&(t.imageHeight=i.getAttribute("height")||void 0),i.hasAttribute("alt")&&(t.imageAlt=i.getAttribute("alt")||void 0)),t},lye=e=>{const t={},i=e.querySelector("swal-icon");return i&&(cy(i,["type","color"]),i.hasAttribute("type")&&(t.icon=i.getAttribute("type")),i.hasAttribute("color")&&(t.iconColor=i.getAttribute("color")),t.iconHtml=i.innerHTML),t},cye=e=>{const t={},i=e.querySelector("swal-input");i&&(cy(i,["type","label","placeholder","value"]),t.input=i.getAttribute("type")||"text",i.hasAttribute("label")&&(t.inputLabel=i.getAttribute("label")),i.hasAttribute("placeholder")&&(t.inputPlaceholder=i.getAttribute("placeholder")),i.hasAttribute("value")&&(t.inputValue=i.getAttribute("value")));const s=Array.from(e.querySelectorAll("swal-input-option"));return s.length&&(t.inputOptions={},s.forEach(f=>{cy(f,["value"]);const y=f.getAttribute("value");if(!y)return;const T=f.innerHTML;t.inputOptions[y]=T})),t},uye=(e,t)=>{const i={};for(const s in t){const f=t[s],y=e.querySelector(f);y&&(cy(y,[]),i[f.replace(/^swal-/,"")]=y.innerHTML.trim())}return i},hye=e=>{const t=F8.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(i=>{const s=i.tagName.toLowerCase();t.includes(s)||su(`Unrecognized element <${s}>`)})},cy=(e,t)=>{Array.from(e.attributes).forEach(i=>{t.indexOf(i.name)===-1&&su([`Unrecognized attribute "${i.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},U8=10,dye=e=>{const t=lu(),i=Jo();typeof e.willOpen=="function"&&e.willOpen(i),wr.eventEmitter.emit("willOpen",i);const f=window.getComputedStyle(document.body).overflowY;mye(t,i,e),setTimeout(()=>{fye(t,i)},U8),KO()&&(pye(t,e.scrollbarPadding,f),Yge()),!v2()&&!wr.previousActiveElement&&(wr.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(i)),wr.eventEmitter.emit("didOpen",i),Td(t,En["no-transition"])},TT=e=>{const t=Jo();if(e.target!==t)return;const i=lu();t.removeEventListener("animationend",TT),t.removeEventListener("transitionend",TT),i.style.overflowY="auto"},fye=(e,t)=>{i8(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",TT),t.addEventListener("transitionend",TT)):e.style.overflowY="auto"},pye=(e,t,i)=>{Kge(),t&&i!=="hidden"&&r_e(i),setTimeout(()=>{e.scrollTop=0})},mye=(e,t,i)=>{oa(e,i.showClass.backdrop),i.animation?(t.style.setProperty("opacity","0","important"),$l(t,"grid"),setTimeout(()=>{oa(t,i.showClass.popup),t.style.removeProperty("opacity")},U8)):$l(t,"grid"),oa([document.documentElement,document.body],En.shown),i.heightAuto&&i.backdrop&&!i.toast&&oa([document.documentElement,document.body],En["height-auto"])};var WB={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function gye(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=WB.email),e.input==="url"&&(e.inputValidator=WB.url))}function _ye(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(su('Target parameter is not valid, defaulting to "body"'),e.target="body")}function yye(e){gye(e),e.showLoaderOnConfirm&&!e.preConfirm&&su(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),_ye(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),lge(e)}let ip;var n1=new WeakMap;class ol{constructor(...t){if(jme(this,n1,void 0),typeof window>"u")return;ip=this;const i=Object.freeze(this.constructor.argsToParams(t));this.params=i,this.isAwaitingPromise=!1,Fme(n1,this,this._main(ip.params))}_main(t,i={}){if(L8(Object.assign({},i,t)),wr.currentInstance){const y=kv.swalPromiseResolve.get(wr.currentInstance),{isAwaitingPromise:T}=wr.currentInstance;wr.currentInstance._destroy(),T||y({isDismissed:!0}),KO()&&m8()}wr.currentInstance=ip;const s=xye(t,i);yye(s),Object.freeze(s),wr.timeout&&(wr.timeout.stop(),delete wr.timeout),clearTimeout(wr.restoreFocusTimeout);const f=bye(ip);return h8(ip,s),Ka.innerParams.set(ip,s),vye(ip,f,s)}then(t){return BB(n1,this).then(t)}finally(t){return BB(n1,this).finally(t)}}const vye=(e,t,i)=>new Promise((s,f)=>{const y=T=>{e.close({isDismissed:!0,dismiss:T})};kv.swalPromiseResolve.set(e,s),kv.swalPromiseReject.set(e,f),t.confirmButton.onclick=()=>{b_e(e)},t.denyButton.onclick=()=>{w_e(e)},t.cancelButton.onclick=()=>{T_e(e,y)},t.closeButton.onclick=()=>{y(n0.close)},z_e(i,t,y),$ge(wr,i,y),d_e(e,i),dye(i),wye(wr,i,y),Tye(t,i),setTimeout(()=>{t.container.scrollTop=0})}),xye=(e,t)=>{const i=iye(e),s=Object.assign({},Sv,t,i,e);return s.showClass=Object.assign({},Sv.showClass,s.showClass),s.hideClass=Object.assign({},Sv.hideClass,s.hideClass),s.animation===!1&&(s.showClass={backdrop:"swal2-noanimation"},s.hideClass={}),s},bye=e=>{const t={popup:Jo(),container:lu(),actions:bb(),confirmButton:fp(),denyButton:_y(),cancelButton:e0(),loader:t0(),closeButton:XO(),validationMessage:_2(),progressSteps:WO()};return Ka.domCache.set(e,t),t},wye=(e,t,i)=>{const s=y2();Lc(s),t.timer&&(e.timeout=new nye(()=>{i("timer"),delete e.timeout},t.timer),t.timerProgressBar&&($l(s),Ph(s,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&QO(t.timer)})))},Tye=(e,t)=>{if(!t.toast){if(!g2(t.allowEnterKey)){K6("allowEnterKey"),Aye();return}Sye(e)||Eye(e,t)||lC(-1,1)}},Sye=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const i of t)if(i instanceof HTMLElement&&Gu(i))return i.focus(),!0;return!1},Eye=(e,t)=>t.focusDeny&&Gu(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&Gu(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&Gu(e.confirmButton)?(e.confirmButton.focus(),!0):!1,Aye=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const i=document.createElement("audio");i.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",i.loop=!0,document.body.appendChild(i),setTimeout(()=>{i.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}ol.prototype.disableButtons=A8;ol.prototype.enableButtons=E8;ol.prototype.getInput=w8;ol.prototype.disableInput=C8;ol.prototype.enableInput=P8;ol.prototype.hideLoading=bT;ol.prototype.disableLoading=bT;ol.prototype.showValidationMessage=M8;ol.prototype.resetValidationMessage=O8;ol.prototype.close=Tg;ol.prototype.closePopup=Tg;ol.prototype.closeModal=Tg;ol.prototype.closeToast=Tg;ol.prototype.rejectPromise=y8;ol.prototype.update=z8;ol.prototype._destroy=k8;Object.assign(ol,tye);Object.keys(L_e).forEach(e=>{ol[e]=function(...t){return ip&&ip[e]?ip[e](...t):null}});ol.DismissReason=n0;ol.version="11.22.2";const om=ol;om.default=om;typeof document<"u"&&function(e,t){var i=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(i),i.styleSheet)i.styleSheet.disabled||(i.styleSheet.cssText=t);else try{i.innerHTML=t}catch{i.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');function Pye(){const e=jv(),[t,i]=me.useState(!1),[s,f]=me.useState({name:"",email:"",password:"",phone:"",serviceType:"",price:0}),y=()=>!s.name||!s.email||!s.password||!s.phone||!s.serviceType?(om.fire("خطأ","جميع الحقول مطلوبة","error"),!1):/\S+@\S+\.\S+/.test(s.email)?s.password.length<6?(om.fire("خطأ","كلمة المرور يجب أن تكون على الأقل 6 أحرف","error"),!1):s.price<=0?(om.fire("خطأ","السعر يجب أن يكون أكبر من 0","error"),!1):!0:(om.fire("خطأ","الإيميل غير صالح","error"),!1),T=async o=>{if(o.preventDefault(),!!y())try{const{data:C}=await Os.post("http://localhost:3000/api/users/register-helper",s);C.token&&localStorage.setItem("token",C.token),om.fire("تم","تم التسجيل بنجاح","success"),e("/helper")}catch(C){om.fire("خطأ",C.response?.data?.message||"فشل في التسجيل","error")}};return ie.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-r from-yellow-90 via-yellow-100 to-white-200 px-4",children:ie.jsxs("div",{className:"relative bg-white/60 backdrop-blur-xl border border-white/70 rounded-3xl shadow-xl w-full max-w-md p-8 md:p-10",children:[ie.jsxs("div",{className:"flex flex-col justify-center items-center",children:[ie.jsx("img",{src:"/assets/logo-remove.png",alt:"logo",className:"w-30"}),ie.jsx("h2",{className:"text-2xl md:text-3xl font-semibold text-gray-800 text-center",children:"بصّار"})]}),ie.jsx("p",{className:"text-[#272343] text-center mt-1 mb-6 text-sm",children:"لتكن على بصيرة"}),ie.jsxs("form",{className:"space-y-4",onSubmit:T,children:[ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"الإسم"}),ie.jsx("input",{type:"text",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",onChange:o=>f({...s,name:o.target.value}),required:!0})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"رقم الجوال"}),ie.jsx("input",{type:"tel",placeholder:"+966",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",onChange:o=>f({...s,phone:o.target.value}),required:!0})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"البريد الإلكتروني"}),ie.jsx("input",{type:"email",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",onChange:o=>f({...s,email:o.target.value}),required:!0})]}),ie.jsxs("div",{className:"relative",children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"كلمة السر"}),ie.jsx("input",{type:t?"text":"password",className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",onChange:o=>f({...s,password:o.target.value}),required:!0}),ie.jsx("button",{type:"button",onClick:()=>i(!t),className:"absolute left-3 top-9 text-[#272343] hover:text-gray-700",children:t?ie.jsx(A1,{className:"w-5 h-5 cursor-pointer"}):ie.jsx(E1,{className:"w-5 h-5 cursor-pointer"})})]}),ie.jsxs("div",{className:"relative",children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"الخدمة"}),ie.jsx("input",{className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",type:"text",onChange:o=>f({...s,serviceType:o.target.value}),required:!0})]}),ie.jsxs("div",{className:"relative",children:[ie.jsx("label",{className:"block text-sm font-medium text-[#272343] mb-1",children:"السعر"}),ie.jsx("input",{className:"w-full px-4 py-2 border border-[#F8D203] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F8D203] bg-white/80 placeholder-gray-500",type:"number",onChange:o=>f({...s,price:+o.target.value}),required:!0})]}),ie.jsx("button",{type:"submit",className:"w-full mt-5 bg-[#F8D203] hover:bg-[#f8d30381] text-[#272343] font-semibold py-2 rounded-xl transition",children:"تسجيل كمساعد"}),ie.jsxs("div",{className:"flex justify-center items-center",children:[ie.jsx("p",{className:"p-1 text-[#272343]",children:" لديك حساب ؟! "}),ie.jsx(ss,{className:"underline text-[#272343]",to:"/signin",children:"تسجيل الدخول"})]}),ie.jsxs("div",{className:"flex justify-center items-center",children:[ie.jsx("p",{className:"p-1 text-[#272343]",children:"   سجل كمستخدم    "}),ie.jsx(ss,{className:"underline text-[#272343]",to:"/signup",children:"تسجيل"})]})]})]})})}function Cye(){return ie.jsx(ie.Fragment,{children:ie.jsx("div",{className:"",children:ie.jsx("main",{className:"flex-grow",children:ie.jsx(HG,{})})})})}const Mye=g7([{path:"/",element:ie.jsx(Cye,{}),children:[{path:"/",element:ie.jsx(_K,{})},{path:"admin",element:ie.jsx(Mfe,{})},{path:"listuser",element:ie.jsx(vK,{})},{path:"listhelper",element:ie.jsx(Sz,{})},{path:"helper",element:ie.jsx(Dfe,{})},{path:"helphistory",element:ie.jsx(kfe,{})},{path:"helplist",element:ie.jsx(Sz,{})},{path:"user",element:ie.jsx(Lfe,{})},{path:"userhistory",element:ie.jsx(Ffe,{})},{path:"userlist",element:ie.jsx(Bfe,{})},{path:"dangerlist",element:ie.jsx(Vfe,{})},{path:"/service-list/:serviceType",element:ie.jsx(Nme,{})},{path:"signin",element:ie.jsx(SK,{})},{path:"signup",element:ie.jsx(Ofe,{})},{path:"signuphelper",element:ie.jsx(Pye,{})}]},{path:"/map",element:ie.jsx(kme,{})}]);function Oye(){return ie.jsx(ie.Fragment,{children:ie.jsx(VG,{router:Mye})})}function Iye(){return ie.jsx(Oye,{})}const XB=document.getElementById("root");XB?vH.createRoot(XB).render(ie.jsx(yd.StrictMode,{children:ie.jsx(Iye,{})})):console.error("Root element not found");
